!function(I){function g(A){if(C[A])return C[A].exports;var n=C[A]={exports:{},id:A,loaded:!1};return I[A].call(n.exports,n,n.exports,g),n.loaded=!0,n.exports}var C={};return g.m=I,g.c=C,g.p="",g(0)}([function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/6.\r\n */\r\n__webpack_require__(1);\r\n//模块\r\nwindow.QTopo = {};\r\nwindow.QTopo.instance=[];\r\nwindow.QTopo.util = __webpack_require__(2);\r\nvar Scene = __webpack_require__(3);\r\nwindow.QTopo.init = function (canvas, config) {\r\n    var QtopoInstance = {};\r\n    this.instance.push(QtopoInstance);\r\n    var stage = new JTopo.Stage(canvas);\r\n    var scene = new Scene(stage,config);\r\n    QtopoInstance.scene = scene;\r\n    QtopoInstance.setOption = setOption;\r\n    //test(scene);\r\n    scene.on("dbclick", function (target, e) {\r\n        console.info(target);\r\n    });\r\n    return QtopoInstance;\r\n};\r\nfunction setOption(option) {\r\n    var scene = this.scene;\r\n    createNode(scene, option.node);\r\n    createContainer(scene, option.container);\r\n    createLink(scene, option.link);\r\n    scene.center();\r\n}\r\nfunction test(scene) {\r\n    var text = scene.createNode({\r\n        type: "text",\r\n        position: [200, 200],\r\n        font: {\r\n            size: 30\r\n        }\r\n    });\r\n    var normal = scene.createNode({\r\n        type: "normal",\r\n        position: [200, 100],\r\n        font: {\r\n            size: 30\r\n        },\r\n        image: "img/mo/wlan_4.png",\r\n        name: "test1",\r\n        size: [100, 100]\r\n    });\r\n    normal.id = "avsa...";\r\n    var normal2 = scene.createNode({\r\n        type: "normal",\r\n        position: [200, 100],\r\n        font: {\r\n            size: 30\r\n        }\r\n    });\r\n    normal2.id = "avsa...";\r\n    var group = scene.createContainer({\r\n        name: "test Group",\r\n        font: {\r\n            size: 30\r\n        }\r\n    });\r\n    var link = scene.createLink({\r\n        type: "flexional",\r\n        start: text,\r\n        end: normal\r\n    });\r\n    link.id = "avsa...";\r\n    normal.set({\r\n        position: [500, 200]\r\n    });\r\n    setTimeout(function () {\r\n        text.set({\r\n            text: "aaaa"\r\n        });\r\n        normal.set({\r\n            name: "aaa",\r\n            textPosition: "hide"\r\n        });\r\n        group.add(normal);\r\n    }, 2000);\r\n    setTimeout(function () {\r\n        normal.set({\r\n            name: "bbb",\r\n            textPosition: "left"\r\n        });\r\n        group.add(text);\r\n    }, 3000);\r\n    setTimeout(function () {\r\n        normal.set({\r\n            name: "ccc",\r\n            textPosition: "top"\r\n        });\r\n        group.remove(text);\r\n        group.add(normal2);\r\n    }, 4000);\r\n}\r\nfunction createNode(scene, config) {\r\n    if (config) {\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, v) {\r\n                var node = scene.createNode(v);\r\n                if ($.isArray(config.exprop)) {\r\n                    $.each(config.exprop, function (j, key) {\r\n                        node[key] = v[key];\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nfunction createContainer(scene, config) {\r\n    if (config) {\r\n        var findChild;\r\n        if (config.children) {\r\n            findChild = config.children;\r\n        }\r\n        if ($.isArray(config.data)) {\r\n            //开始构造分组\r\n            $.each(config.data, function (i, cData) {\r\n                //无论是否有子元素，分组先创造出来\r\n                var container = scene.createContainer(cData);\r\n                if ($.isArray(config.exprop)) {\r\n                    $.each(config.exprop, function (j, key) {\r\n                        container[key] = cData[key];\r\n                    });\r\n                }\r\n                //确定查找子元素的标记\r\n                var findChild_exact = findChild;\r\n                if (cData.children) {\r\n                    findChild_exact = cData.children;\r\n                }\r\n                //查找子元素并塞入\r\n                if (findChild_exact) {\r\n                    $.each(cData.data, function (j, children) {\r\n                        var child = scene.find(findChild_exact + "=" + children);\r\n                        if (child && child.length > 0) {\r\n                            $.each(child, function (m, one) {\r\n                                container.add(one);\r\n                            });\r\n                        } else {\r\n                            console.error("some child not found : " + j, findChild_exact + "=" + children);\r\n                        }\r\n                    });\r\n                } else {\r\n                    console.error("can\'t find children,need config children");\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nfunction createLink(scene, config) {\r\n    if (config) {\r\n        var path = config.path;\r\n        if ($.isArray(path) && path.length > 0) {\r\n            var findStart;\r\n            var findEnd;\r\n            //path为数组，0为起点条件1为终点条件,确定搜索条件,起始点条件可不同\r\n            if (path.length == 1) {\r\n                findEnd = path[0];\r\n                findStart = findEnd;\r\n            } else {\r\n                findStart = path[0];\r\n                findEnd = path[1];\r\n            }\r\n            if ($.isArray(config.data)) {\r\n                $.each(config.data, function (i, v) {\r\n                    var link;\r\n                    //根据确定的条件进行搜索\r\n                    var start = scene.find(findStart + "=" + v.start)[0];\r\n                    var end = scene.find(findEnd + "=" + v.end)[0];\r\n                    if (start && end) {\r\n                        v.start = start;\r\n                        v.end = end;\r\n                        link = scene.createLink(v);\r\n                        if (link && $.isArray(config.exprop)) {\r\n                            $.each(config.exprop, function (j, key) {\r\n                                link[key] = v[key];\r\n                            });\r\n                        }\r\n                    } else {\r\n                        console.error("some link path invalid : "+ i, v);\r\n                        if(!start){\r\n                            console.error("start not found : ",v.start);\r\n                        }\r\n                        if(!end){\r\n                            console.error("end not found : ",v.end);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            console.error("can not draw link,need config \'path\' and \'path\' is Array and not empty, path used to find start and end");\r\n        }\r\n    }\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL21haW4uanM/NTk3NSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qix5QkFBeUI7QUFDekI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi82LlxyXG4gKi9cclxucmVxdWlyZShcIi4vanRvcG8vanRvcG8tbWluLmpzXCIpO1xyXG4vL+aooeWdl1xyXG53aW5kb3cuUVRvcG8gPSB7fTtcclxud2luZG93LlFUb3BvLmluc3RhbmNlPVtdO1xyXG53aW5kb3cuUVRvcG8udXRpbCA9IHJlcXVpcmUoJy4vdXRpbC5qcycpO1xyXG52YXIgU2NlbmUgPSByZXF1aXJlKCcuL1NjZW5lLmpzJyk7XHJcbndpbmRvdy5RVG9wby5pbml0ID0gZnVuY3Rpb24gKGNhbnZhcywgY29uZmlnKSB7XHJcbiAgICB2YXIgUXRvcG9JbnN0YW5jZSA9IHt9O1xyXG4gICAgdGhpcy5pbnN0YW5jZS5wdXNoKFF0b3BvSW5zdGFuY2UpO1xyXG4gICAgdmFyIHN0YWdlID0gbmV3IEpUb3BvLlN0YWdlKGNhbnZhcyk7XHJcbiAgICB2YXIgc2NlbmUgPSBuZXcgU2NlbmUoc3RhZ2UsY29uZmlnKTtcclxuICAgIFF0b3BvSW5zdGFuY2Uuc2NlbmUgPSBzY2VuZTtcclxuICAgIFF0b3BvSW5zdGFuY2Uuc2V0T3B0aW9uID0gc2V0T3B0aW9uO1xyXG4gICAgLy90ZXN0KHNjZW5lKTtcclxuICAgIHNjZW5lLm9uKFwiZGJjbGlja1wiLCBmdW5jdGlvbiAodGFyZ2V0LCBlKSB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKHRhcmdldCk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBRdG9wb0luc3RhbmNlO1xyXG59O1xyXG5mdW5jdGlvbiBzZXRPcHRpb24ob3B0aW9uKSB7XHJcbiAgICB2YXIgc2NlbmUgPSB0aGlzLnNjZW5lO1xyXG4gICAgY3JlYXRlTm9kZShzY2VuZSwgb3B0aW9uLm5vZGUpO1xyXG4gICAgY3JlYXRlQ29udGFpbmVyKHNjZW5lLCBvcHRpb24uY29udGFpbmVyKTtcclxuICAgIGNyZWF0ZUxpbmsoc2NlbmUsIG9wdGlvbi5saW5rKTtcclxuICAgIHNjZW5lLmNlbnRlcigpO1xyXG59XHJcbmZ1bmN0aW9uIHRlc3Qoc2NlbmUpIHtcclxuICAgIHZhciB0ZXh0ID0gc2NlbmUuY3JlYXRlTm9kZSh7XHJcbiAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXHJcbiAgICAgICAgcG9zaXRpb246IFsyMDAsIDIwMF0sXHJcbiAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICBzaXplOiAzMFxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdmFyIG5vcm1hbCA9IHNjZW5lLmNyZWF0ZU5vZGUoe1xyXG4gICAgICAgIHR5cGU6IFwibm9ybWFsXCIsXHJcbiAgICAgICAgcG9zaXRpb246IFsyMDAsIDEwMF0sXHJcbiAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICBzaXplOiAzMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW1hZ2U6IFwiaW1nL21vL3dsYW5fNC5wbmdcIixcclxuICAgICAgICBuYW1lOiBcInRlc3QxXCIsXHJcbiAgICAgICAgc2l6ZTogWzEwMCwgMTAwXVxyXG4gICAgfSk7XHJcbiAgICBub3JtYWwuaWQgPSBcImF2c2EuLi5cIjtcclxuICAgIHZhciBub3JtYWwyID0gc2NlbmUuY3JlYXRlTm9kZSh7XHJcbiAgICAgICAgdHlwZTogXCJub3JtYWxcIixcclxuICAgICAgICBwb3NpdGlvbjogWzIwMCwgMTAwXSxcclxuICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgIHNpemU6IDMwXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBub3JtYWwyLmlkID0gXCJhdnNhLi4uXCI7XHJcbiAgICB2YXIgZ3JvdXAgPSBzY2VuZS5jcmVhdGVDb250YWluZXIoe1xyXG4gICAgICAgIG5hbWU6IFwidGVzdCBHcm91cFwiLFxyXG4gICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgc2l6ZTogMzBcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHZhciBsaW5rID0gc2NlbmUuY3JlYXRlTGluayh7XHJcbiAgICAgICAgdHlwZTogXCJmbGV4aW9uYWxcIixcclxuICAgICAgICBzdGFydDogdGV4dCxcclxuICAgICAgICBlbmQ6IG5vcm1hbFxyXG4gICAgfSk7XHJcbiAgICBsaW5rLmlkID0gXCJhdnNhLi4uXCI7XHJcbiAgICBub3JtYWwuc2V0KHtcclxuICAgICAgICBwb3NpdGlvbjogWzUwMCwgMjAwXVxyXG4gICAgfSk7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0ZXh0LnNldCh7XHJcbiAgICAgICAgICAgIHRleHQ6IFwiYWFhYVwiXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbm9ybWFsLnNldCh7XHJcbiAgICAgICAgICAgIG5hbWU6IFwiYWFhXCIsXHJcbiAgICAgICAgICAgIHRleHRQb3NpdGlvbjogXCJoaWRlXCJcclxuICAgICAgICB9KTtcclxuICAgICAgICBncm91cC5hZGQobm9ybWFsKTtcclxuICAgIH0sIDIwMDApO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbm9ybWFsLnNldCh7XHJcbiAgICAgICAgICAgIG5hbWU6IFwiYmJiXCIsXHJcbiAgICAgICAgICAgIHRleHRQb3NpdGlvbjogXCJsZWZ0XCJcclxuICAgICAgICB9KTtcclxuICAgICAgICBncm91cC5hZGQodGV4dCk7XHJcbiAgICB9LCAzMDAwKTtcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIG5vcm1hbC5zZXQoe1xyXG4gICAgICAgICAgICBuYW1lOiBcImNjY1wiLFxyXG4gICAgICAgICAgICB0ZXh0UG9zaXRpb246IFwidG9wXCJcclxuICAgICAgICB9KTtcclxuICAgICAgICBncm91cC5yZW1vdmUodGV4dCk7XHJcbiAgICAgICAgZ3JvdXAuYWRkKG5vcm1hbDIpO1xyXG4gICAgfSwgNDAwMCk7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlTm9kZShzY2VuZSwgY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShjb25maWcuZGF0YSkpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGNvbmZpZy5kYXRhLCBmdW5jdGlvbiAoaSwgdikge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBzY2VuZS5jcmVhdGVOb2RlKHYpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShjb25maWcuZXhwcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChjb25maWcuZXhwcm9wLCBmdW5jdGlvbiAoaiwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVba2V5XSA9IHZba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUNvbnRhaW5lcihzY2VuZSwgY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIGZpbmRDaGlsZDtcclxuICAgICAgICBpZiAoY29uZmlnLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGZpbmRDaGlsZCA9IGNvbmZpZy5jaGlsZHJlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShjb25maWcuZGF0YSkpIHtcclxuICAgICAgICAgICAgLy/lvIDlp4vmnoTpgKDliIbnu4RcclxuICAgICAgICAgICAgJC5lYWNoKGNvbmZpZy5kYXRhLCBmdW5jdGlvbiAoaSwgY0RhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8v5peg6K665piv5ZCm5pyJ5a2Q5YWD57Sg77yM5YiG57uE5YWI5Yib6YCg5Ye65p2lXHJcbiAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gc2NlbmUuY3JlYXRlQ29udGFpbmVyKGNEYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmV4cHJvcCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goY29uZmlnLmV4cHJvcCwgZnVuY3Rpb24gKGosIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXJba2V5XSA9IGNEYXRhW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL+ehruWumuafpeaJvuWtkOWFg+e0oOeahOagh+iusFxyXG4gICAgICAgICAgICAgICAgdmFyIGZpbmRDaGlsZF9leGFjdCA9IGZpbmRDaGlsZDtcclxuICAgICAgICAgICAgICAgIGlmIChjRGF0YS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbmRDaGlsZF9leGFjdCA9IGNEYXRhLmNoaWxkcmVuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy/mn6Xmib7lrZDlhYPntKDlubbloZ7lhaVcclxuICAgICAgICAgICAgICAgIGlmIChmaW5kQ2hpbGRfZXhhY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goY0RhdGEuZGF0YSwgZnVuY3Rpb24gKGosIGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHNjZW5lLmZpbmQoZmluZENoaWxkX2V4YWN0ICsgXCI9XCIgKyBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZCAmJiBjaGlsZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goY2hpbGQsIGZ1bmN0aW9uIChtLCBvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYWRkKG9uZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJzb21lIGNoaWxkIG5vdCBmb3VuZCA6IFwiICsgaiwgZmluZENoaWxkX2V4YWN0ICsgXCI9XCIgKyBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImNhbid0IGZpbmQgY2hpbGRyZW4sbmVlZCBjb25maWcgY2hpbGRyZW5cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVMaW5rKHNjZW5lLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IGNvbmZpZy5wYXRoO1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkocGF0aCkgJiYgcGF0aC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBmaW5kU3RhcnQ7XHJcbiAgICAgICAgICAgIHZhciBmaW5kRW5kO1xyXG4gICAgICAgICAgICAvL3BhdGjkuLrmlbDnu4TvvIww5Li66LW354K55p2h5Lu2MeS4uue7iOeCueadoeS7tiznoa7lrprmkJzntKLmnaHku7Ys6LW35aeL54K55p2h5Lu25Y+v5LiN5ZCMXHJcbiAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5kRW5kID0gcGF0aFswXTtcclxuICAgICAgICAgICAgICAgIGZpbmRTdGFydCA9IGZpbmRFbmQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmaW5kU3RhcnQgPSBwYXRoWzBdO1xyXG4gICAgICAgICAgICAgICAgZmluZEVuZCA9IHBhdGhbMV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCQuaXNBcnJheShjb25maWcuZGF0YSkpIHtcclxuICAgICAgICAgICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGluaztcclxuICAgICAgICAgICAgICAgICAgICAvL+agueaNruehruWumueahOadoeS7tui/m+ihjOaQnOe0olxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IHNjZW5lLmZpbmQoZmluZFN0YXJ0ICsgXCI9XCIgKyB2LnN0YXJ0KVswXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gc2NlbmUuZmluZChmaW5kRW5kICsgXCI9XCIgKyB2LmVuZClbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnN0YXJ0ID0gc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYuZW5kID0gZW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rID0gc2NlbmUuY3JlYXRlTGluayh2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmsgJiYgJC5pc0FycmF5KGNvbmZpZy5leHByb3ApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goY29uZmlnLmV4cHJvcCwgZnVuY3Rpb24gKGosIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtba2V5XSA9IHZba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcInNvbWUgbGluayBwYXRoIGludmFsaWQgOiBcIisgaSwgdik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFzdGFydCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwic3RhcnQgbm90IGZvdW5kIDogXCIsdi5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWVuZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZW5kIG5vdCBmb3VuZCA6IFwiLHYuZW5kKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImNhbiBub3QgZHJhdyBsaW5rLG5lZWQgY29uZmlnICdwYXRoJyBhbmQgJ3BhdGgnIGlzIEFycmF5IGFuZCBub3QgZW1wdHksIHBhdGggdXNlZCB0byBmaW5kIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jb3JlL21haW4uanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('!function (window) {\r\n    function Element() {\r\n        this.initialize = function () {\r\n            this.elementType = "element", this.serializedProperties = ["elementType"], this.propertiesStack = [], this._id = "" + (new Date).getTime()\r\n        }, this.distroy = function () {\r\n        }, this.removeHandler = function () {\r\n        }, this.attr = function (a, b) {\r\n            if (null != a && null != b)this[a] = b; else if (null != a)return this[a];\r\n            return this\r\n        }, this.save = function () {\r\n            var a = this, b = {};\r\n            this.serializedProperties.forEach(function (c) {\r\n                b[c] = a[c]\r\n            }), this.propertiesStack.push(b)\r\n        }, this.restore = function () {\r\n            if (null != this.propertiesStack && 0 != this.propertiesStack.length) {\r\n                var a = this, b = this.propertiesStack.pop();\r\n                this.serializedProperties.forEach(function (c) {\r\n                    a[c] = b[c]\r\n                })\r\n            }\r\n        }, this.toJson = function () {\r\n            var a = this, b = "{", c = this.serializedProperties.length;\r\n            return this.serializedProperties.forEach(function (d, e) {\r\n                var f = a[d];\r\n                "string" == typeof f && (f = \'"\' + f + \'"\'), b += \'"\' + d + \'":\' + f, c > e + 1 && (b += ",")\r\n            }), b += "}"\r\n        }\r\n    }\r\n\r\n    CanvasRenderingContext2D.prototype.JTopoRoundRect = function (a, b, c, d, e) {\r\n        "undefined" == typeof e && (e = 5), this.beginPath(), this.moveTo(a + e, b), this.lineTo(a + c - e, b), this.quadraticCurveTo(a + c, b, a + c, b + e), this.lineTo(a + c, b + d - e), this.quadraticCurveTo(a + c, b + d, a + c - e, b + d), this.lineTo(a + e, b + d), this.quadraticCurveTo(a, b + d, a, b + d - e), this.lineTo(a, b + e), this.quadraticCurveTo(a, b, a + e, b), this.closePath()\r\n    }, CanvasRenderingContext2D.prototype.JTopoDashedLineTo = function (a, b, c, d, e) {\r\n        "undefined" == typeof e && (e = 5);\r\n        var f = c - a, g = d - b, h = Math.floor(Math.sqrt(f * f + g * g)), i = 0 >= e ? h : h / e, j = g / h * e, k = f / h * e;\r\n        this.beginPath();\r\n        for (var l = 0; i > l; l++)l % 2 ? this.lineTo(a + l * k, b + l * j) : this.moveTo(a + l * k, b + l * j);\r\n        this.stroke()\r\n    }, JTopo = {\r\n        version: "0.4.8_01",\r\n        zIndex_Container: 1,\r\n        zIndex_Link: 2,\r\n        zIndex_Node: 3,\r\n        SceneMode: {normal: "normal", drag: "drag", edit: "edit", select: "select"},\r\n        MouseCursor: {\r\n            normal: "default",\r\n            pointer: "pointer",\r\n            top_left: "nw-resize",\r\n            top_center: "n-resize",\r\n            top_right: "ne-resize",\r\n            middle_left: "e-resize",\r\n            middle_right: "e-resize",\r\n            bottom_left: "ne-resize",\r\n            bottom_center: "n-resize",\r\n            bottom_right: "nw-resize",\r\n            move: "move",\r\n            open_hand: "url(./img/cur/openhand.cur) 8 8, default",\r\n            closed_hand: "url(./img/cur/closedhand.cur) 8 8, default"\r\n        },\r\n        createStageFromJson: function (jsonStr, canvas) {\r\n            eval("var jsonObj = " + jsonStr);\r\n            var stage = new JTopo.Stage(canvas);\r\n            for (var k in jsonObj)"childs" != k && (stage[k] = jsonObj[k]);\r\n            var scenes = jsonObj.childs;\r\n            return scenes.forEach(function (a) {\r\n                var b = new JTopo.Scene(stage);\r\n                for (var c in a)"childs" != c && (b[c] = a[c]), "background" == c && (b.background = a[c]);\r\n                var d = a.childs;\r\n                d.forEach(function (a) {\r\n                    var c = null, d = a.elementType;\r\n                    "node" == d ? c = new JTopo.Node : "CircleNode" == d && (c = new JTopo.CircleNode);\r\n                    for (var e in a)c[e] = a[e];\r\n                    b.add(c)\r\n                })\r\n            }), stage\r\n        }\r\n    }, JTopo.Element = Element, window.JTopo = JTopo\r\n}(window), function (JTopo) {\r\n    function MessageBus(a) {\r\n        var b = this;\r\n        this.name = a, this.messageMap = {}, this.messageCount = 0, this.subscribe = function (a, c) {\r\n            var d = b.messageMap[a];\r\n            null == d && (b.messageMap[a] = []), b.messageMap[a].push(c), b.messageCount++\r\n        }, this.unsubscribe = function (a) {\r\n            var c = b.messageMap[a];\r\n            null != c && (b.messageMap[a] = null, delete b.messageMap[a], b.messageCount--)\r\n        }, this.publish = function (a, c, d) {\r\n            var e = b.messageMap[a];\r\n            if (null != e)for (var f = 0; f < e.length; f++)d ? !function (a, b) {\r\n                setTimeout(function () {\r\n                    a(b)\r\n                }, 10)\r\n            }(e[f], c) : e[f](c)\r\n        }\r\n    }\r\n\r\n    function getDistance(a, b, c, d) {\r\n        var e, f;\r\n        return null == c && null == d ? (e = b.x - a.x, f = b.y - a.y) : (e = c - a, f = d - b), Math.sqrt(e * e + f * f)\r\n    }\r\n\r\n    function getElementsBound(a) {\r\n        for (var b = {left: Number.MAX_VALUE, right: Number.MIN_VALUE, top: Number.MAX_VALUE, bottom: Number.MIN_VALUE}, c = 0; c < a.length; c++) {\r\n            var d = a[c];\r\n            d instanceof JTopo.Link || (b.left > d.x && (b.left = d.x, b.leftNode = d), b.right < d.x + d.width && (b.right = d.x + d.width, b.rightNode = d), b.top > d.y && (b.top = d.y, b.topNode = d), b.bottom < d.y + d.height && (b.bottom = d.y + d.height, b.bottomNode = d))\r\n        }\r\n        return b.width = b.right - b.left, b.height = b.bottom - b.top, b\r\n    }\r\n\r\n    function mouseCoords(a) {\r\n        return a = cloneEvent(a), a.pageX || (a.pageX = a.clientX + document.body.scrollLeft - document.body.clientLeft, a.pageY = a.clientY + document.body.scrollTop - document.body.clientTop), a\r\n    }\r\n\r\n    function getEventPosition(a) {\r\n        return a = mouseCoords(a)\r\n    }\r\n\r\n    function rotatePoint(a, b, c, d, e) {\r\n        var f = c - a, g = d - b, h = Math.sqrt(f * f + g * g), i = Math.atan2(g, f) + e;\r\n        return {x: a + Math.cos(i) * h, y: b + Math.sin(i) * h}\r\n    }\r\n\r\n    function rotatePoints(a, b, c) {\r\n        for (var d = [], e = 0; e < b.length; e++) {\r\n            var f = rotatePoint(a.x, a.y, b[e].x, b[e].y, c);\r\n            d.push(f)\r\n        }\r\n        return d\r\n    }\r\n\r\n    function $foreach(a, b, c) {\r\n        function d(e) {\r\n            e != a.length && (b(a[e]), setTimeout(function () {\r\n                d(++e)\r\n            }, c))\r\n        }\r\n\r\n        if (0 != a.length) {\r\n            var e = 0;\r\n            d(e)\r\n        }\r\n    }\r\n\r\n    function $for(a, b, c, d) {\r\n        function e(a) {\r\n            a != b && (c(b), setTimeout(function () {\r\n                e(++a)\r\n            }, d))\r\n        }\r\n\r\n        if (!(a > b)) {\r\n            var f = 0;\r\n            e(f)\r\n        }\r\n    }\r\n\r\n    function cloneEvent(a) {\r\n        var b = {};\r\n        for (var c in a)"returnValue" != c && "keyLocation" != c && (b[c] = a[c]);\r\n        return b\r\n    }\r\n\r\n    function clone(a) {\r\n        var b = {};\r\n        for (var c in a)b[c] = a[c];\r\n        return b\r\n    }\r\n\r\n    function isPointInRect(a, b) {\r\n        var c = b.x, d = b.y, e = b.width, f = b.height;\r\n        return a.x > c && a.x < c + e && a.y > d && a.y < d + f\r\n    }\r\n\r\n    function isPointInLine(a, b, c) {\r\n        var d = JTopo.util.getDistance(b, c), e = JTopo.util.getDistance(b, a), f = JTopo.util.getDistance(c, a), g = Math.abs(e + f - d) <= .5;\r\n        return g\r\n    }\r\n\r\n    function removeFromArray(a, b) {\r\n        for (var c = 0; c < a.length; c++) {\r\n            var d = a[c];\r\n            if (d === b) {\r\n                a = a.del(c);\r\n                break\r\n            }\r\n        }\r\n        return a\r\n    }\r\n\r\n    function randomColor() {\r\n        return Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random())\r\n    }\r\n\r\n    function isIntsect() {\r\n    }\r\n\r\n    function getProperties(a, b) {\r\n        for (var c = "", d = 0; d < b.length; d++) {\r\n            d > 0 && (c += ",");\r\n            var e = a[b[d]];\r\n            "string" == typeof e ? e = \'"\' + e + \'"\' : void 0 == e && (e = null), c += b[d] + ":" + e\r\n        }\r\n        return c\r\n    }\r\n\r\n    function loadStageFromJson(json, canvas) {\r\n        var obj = eval(json), stage = new JTopo.Stage(canvas);\r\n        for (var k in stageObj)if ("scenes" != k)stage[k] = obj[k]; else for (var scenes = obj.scenes, i = 0; i < scenes.length; i++) {\r\n            var sceneObj = scenes[i], scene = new JTopo.Scene(stage);\r\n            for (var p in sceneObj)if ("elements" != p)scene[p] = sceneObj[p]; else for (var nodeMap = {}, elements = sceneObj.elements, m = 0; m < elements.length; m++) {\r\n                var elementObj = elements[m], type = elementObj.elementType, element;\r\n                "Node" == type && (element = new JTopo.Node);\r\n                for (var mk in elementObj)element[mk] = elementObj[mk];\r\n                nodeMap[element.text] = element, scene.add(element)\r\n            }\r\n        }\r\n        return console.log(stage), stage\r\n    }\r\n\r\n    function toJson(a) {\r\n        var b = "backgroundColor,visible,mode,rotate,alpha,scaleX,scaleY,shadow,translateX,translateY,areaSelect,paintAll".split(","), c = "text,elementType,x,y,width,height,visible,alpha,rotate,scaleX,scaleY,fillColor,shadow,transformAble,zIndex,dragable,selected,showSelected,font,fontColor,textPosition,textOffsetX,textOffsetY".split(","), d = "{";\r\n        d += "frames:" + a.frames, d += ", scenes:[";\r\n        for (var e = 0; e < a.childs.length; e++) {\r\n            var f = a.childs[e];\r\n            d += "{", d += getProperties(f, b), d += ", elements:[";\r\n            for (var g = 0; g < f.childs.length; g++) {\r\n                var h = f.childs[g];\r\n                g > 0 && (d += ","), d += "{", d += getProperties(h, c), d += "}"\r\n            }\r\n            d += "]}"\r\n        }\r\n        return d += "]", d += "}"\r\n    }\r\n\r\n    function changeColor(a, b, c) {\r\n        var d = c.split(","), e = parseInt(d[0]), f = parseInt(d[1]), g = parseInt(d[2]), h = canvas.width = b.width, i = canvas.height = b.height;\r\n        a.clearRect(0, 0, canvas.width, canvas.height), a.drawImage(b, 0, 0);\r\n        for (var j = a.getImageData(0, 0, b.width, b.height), k = j.data, l = 0; h > l; l++)for (var m = 0; i > m; m++) {\r\n            var n = 4 * (l + m * h);\r\n            0 != k[n + 3] && (null != e && (k[n + 0] += e), null != f && (k[n + 1] += f), null != g && (k[n + 2] += g))\r\n        }\r\n        a.putImageData(j, 0, 0, 0, 0, b.width, b.height);\r\n        var o = canvas.toDataURL();\r\n        return o\r\n    }\r\n\r\n    function genImageAlarm(a, b) {\r\n        var c = a.src + b;\r\n        if (alarmImageCache[c])return alarmImageCache[c];\r\n        var d = new Image;\r\n        return d.src = changeColor(graphics, a, b), alarmImageCache[c] = d, d\r\n    }\r\n\r\n    function getOffsetPosition(a) {\r\n        if (!a)return {left: 0, top: 0};\r\n        var b = 0, c = 0;\r\n        if ("getBoundingClientRect" in document.documentElement)var d = a.getBoundingClientRect(), e = a.ownerDocument, f = e.body, g = e.documentElement, h = g.clientTop || f.clientTop || 0, i = g.clientLeft || f.clientLeft || 0, b = d.top + (self.pageYOffset || g && g.scrollTop || f.scrollTop) - h, c = d.left + (self.pageXOffset || g && g.scrollLeft || f.scrollLeft) - i; else do b += a.offsetTop || 0, c += a.offsetLeft || 0, a = a.offsetParent; while (a);\r\n        return {left: c, top: b}\r\n    }\r\n\r\n    function lineF(a, b, c, d) {\r\n        function e(a) {\r\n            return a * f + g\r\n        }\r\n\r\n        var f = (d - b) / (c - a), g = b - a * f;\r\n        return e.k = f, e.b = g, e.x1 = a, e.x2 = c, e.y1 = b, e.y2 = d, e\r\n    }\r\n\r\n    function inRange(a, b, c) {\r\n        var d = Math.abs(b - c), e = Math.abs(b - a), f = Math.abs(c - a), g = Math.abs(d - (e + f));\r\n        return 1e-6 > g ? !0 : !1\r\n    }\r\n\r\n    function isPointInLineSeg(a, b, c) {\r\n        return inRange(a, c.x1, c.x2) && inRange(b, c.y1, c.y2)\r\n    }\r\n\r\n    function intersection(a, b) {\r\n        var c, d;\r\n        return a.k == b.k ? null : (1 / 0 == a.k || a.k == -1 / 0 ? (c = a.x1, d = b(a.x1)) : 1 / 0 == b.k || b.k == -1 / 0 ? (c = b.x1, d = a(b.x1)) : (c = (b.b - a.b) / (a.k - b.k), d = a(c)), 0 == isPointInLineSeg(c, d, a) ? null : 0 == isPointInLineSeg(c, d, b) ? null : {\r\n            x: c,\r\n            y: d\r\n        })\r\n    }\r\n\r\n    function intersectionLineBound(a, b) {\r\n        var c = JTopo.util.lineF(b.left, b.top, b.left, b.bottom), d = JTopo.util.intersection(a, c);\r\n        return null == d && (c = JTopo.util.lineF(b.left, b.top, b.right, b.top), d = JTopo.util.intersection(a, c), null == d && (c = JTopo.util.lineF(b.right, b.top, b.right, b.bottom), d = JTopo.util.intersection(a, c), null == d && (c = JTopo.util.lineF(b.left, b.bottom, b.right, b.bottom), d = JTopo.util.intersection(a, c)))), d\r\n    }\r\n\r\n    requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function (a) {\r\n            setTimeout(a, 1e3 / 24)\r\n        }, Array.prototype.del = function (a) {\r\n        if ("number" != typeof a) {\r\n            for (var b = 0; b < this.length; b++)if (this[b] === a)return this.slice(0, b).concat(this.slice(b + 1, this.length));\r\n            return this\r\n        }\r\n        return 0 > a ? this : this.slice(0, a).concat(this.slice(a + 1, this.length))\r\n    }, [].indexOf || (Array.prototype.indexOf = function (a) {\r\n        for (var b = 0; b < this.length; b++)if (this[b] === a)return b;\r\n        return -1\r\n    }), window.console || (window.console = {\r\n        log: function () {\r\n        }, info: function () {\r\n        }, debug: function () {\r\n        }, warn: function () {\r\n        }, error: function () {\r\n        }\r\n    });\r\n    var canvas = document.createElement("canvas"), graphics = canvas.getContext("2d"), alarmImageCache = {};\r\n    JTopo.util = {\r\n        rotatePoint: rotatePoint,\r\n        rotatePoints: rotatePoints,\r\n        getDistance: getDistance,\r\n        getEventPosition: getEventPosition,\r\n        mouseCoords: mouseCoords,\r\n        MessageBus: MessageBus,\r\n        isFirefox: navigator.userAgent.indexOf("Firefox") > 0,\r\n        isIE: !(!window.attachEvent || -1 !== navigator.userAgent.indexOf("Opera")),\r\n        isChrome: null != navigator.userAgent.toLowerCase().match(/chrome/),\r\n        clone: clone,\r\n        isPointInRect: isPointInRect,\r\n        isPointInLine: isPointInLine,\r\n        removeFromArray: removeFromArray,\r\n        cloneEvent: cloneEvent,\r\n        randomColor: randomColor,\r\n        isIntsect: isIntsect,\r\n        toJson: toJson,\r\n        loadStageFromJson: loadStageFromJson,\r\n        getElementsBound: getElementsBound,\r\n        genImageAlarm: genImageAlarm,\r\n        getOffsetPosition: getOffsetPosition,\r\n        lineF: lineF,\r\n        intersection: intersection,\r\n        intersectionLineBound: intersectionLineBound\r\n    }, window.$for = $for, window.$foreach = $foreach\r\n}(JTopo), function (a) {\r\n    function b(a) {\r\n        return {\r\n            hgap: 16, visible: !1, exportCanvas: document.createElement("canvas"), getImage: function (b, c) {\r\n                var d = a.getBound(), e = 1, f = 1;\r\n                this.exportCanvas.width = a.canvas.width, this.exportCanvas.height = a.canvas.height, null != b && null != c ? (this.exportCanvas.width = b, this.exportCanvas.height = c, e = b / d.width, f = c / d.height) : (d.width > a.canvas.width && (this.exportCanvas.width = d.width), d.height > a.canvas.height && (this.exportCanvas.height = d.height));\r\n                var g = this.exportCanvas.getContext("2d");\r\n                return a.childs.length > 0 && (g.save(), g.clearRect(0, 0, this.exportCanvas.width, this.exportCanvas.height), a.childs.forEach(function (a) {\r\n                    1 == a.visible && (a.save(), a.translateX = 0, a.translateY = 0, a.scaleX = 1, a.scaleY = 1, g.scale(e, f), d.left < 0 && (a.translateX = Math.abs(d.left)), d.top < 0 && (a.translateY = Math.abs(d.top)), a.paintAll = !0, a.repaint(g), a.paintAll = !1, a.restore())\r\n                }), g.restore()), this.exportCanvas.toDataURL("image/png")\r\n            }, canvas: document.createElement("canvas"), update: function () {\r\n                this.eagleImageDatas = this.getData(a)\r\n            }, setSize: function (a, b) {\r\n                this.width = this.canvas.width = a, this.height = this.canvas.height = b\r\n            }, getData: function (b, c) {\r\n                function d(a) {\r\n                    var b = a.stage.canvas.width, c = a.stage.canvas.height, d = b / a.scaleX / 2, e = c / a.scaleY / 2;\r\n                    return {translateX: a.translateX + d - d * a.scaleX, translateY: a.translateY + e - e * a.scaleY}\r\n                }\r\n\r\n                null != j && null != k ? this.setSize(b, c) : this.setSize(200, 160);\r\n                var e = this.canvas.getContext("2d");\r\n                if (a.childs.length > 0) {\r\n                    e.save(), e.clearRect(0, 0, this.canvas.width, this.canvas.height), a.childs.forEach(function (a) {\r\n                        1 == a.visible && (a.save(), a.centerAndZoom(null, null, e), a.repaint(e), a.restore())\r\n                    });\r\n                    var f = d(a.childs[0]), g = f.translateX * (this.canvas.width / a.canvas.width) * a.childs[0].scaleX, h = f.translateY * (this.canvas.height / a.canvas.height) * a.childs[0].scaleY, i = a.getBound(), j = a.canvas.width / a.childs[0].scaleX / i.width, k = a.canvas.height / a.childs[0].scaleY / i.height;\r\n                    j > 1 && (j = 1), k > 1 && (j = 1), g *= j, h *= k, i.left < 0 && (g -= Math.abs(i.left) * (this.width / i.width)), i.top < 0 && (h -= Math.abs(i.top) * (this.height / i.height)), e.save(), e.lineWidth = 1, e.strokeStyle = "rgba(255,0,0,1)", e.strokeRect(-g, -h, e.canvas.width * j, e.canvas.height * k), e.restore();\r\n                    var l = null;\r\n                    try {\r\n                        l = e.getImageData(0, 0, e.canvas.width, e.canvas.height)\r\n                    } catch (m) {\r\n                    }\r\n                    return l\r\n                }\r\n                return null\r\n            }, paint: function () {\r\n                if (null != this.eagleImageDatas) {\r\n                    var b = a.graphics;\r\n                    b.save(), b.fillStyle = "rgba(211,211,211,0.3)", b.fillRect(a.canvas.width - this.canvas.width - 2 * this.hgap, a.canvas.height - this.canvas.height - 1, a.canvas.width - this.canvas.width, this.canvas.height + 1), b.fill(), b.save(), b.lineWidth = 1, b.strokeStyle = "rgba(0,0,0,1)", b.rect(a.canvas.width - this.canvas.width - 2 * this.hgap, a.canvas.height - this.canvas.height - 1, a.canvas.width - this.canvas.width, this.canvas.height + 1), b.stroke(), b.restore(), b.putImageData(this.eagleImageDatas, a.canvas.width - this.canvas.width - this.hgap, a.canvas.height - this.canvas.height), b.restore()\r\n                } else this.eagleImageDatas = this.getData(a)\r\n            }, eventHandler: function (a, b, c) {\r\n                var d = b.x, e = b.y;\r\n                if (d > c.canvas.width - this.canvas.width && e > c.canvas.height - this.canvas.height) {\r\n                    if (d = b.x - this.canvas.width, e = b.y - this.canvas.height, "mousedown" == a && (this.lastTranslateX = c.childs[0].translateX, this.lastTranslateY = c.childs[0].translateY), "mousedrag" == a && c.childs.length > 0) {\r\n                        var f = b.dx, g = b.dy, h = c.getBound(), i = this.canvas.width / c.childs[0].scaleX / h.width, j = this.canvas.height / c.childs[0].scaleY / h.height;\r\n                        c.childs[0].translateX = this.lastTranslateX - f / i, c.childs[0].translateY = this.lastTranslateY - g / j\r\n                    }\r\n                } else;\r\n            }\r\n        }\r\n    }\r\n\r\n    function c(c) {\r\n        function d(b) {\r\n            var c = a.util.getEventPosition(b), d = a.util.getOffsetPosition(n.canvas);\r\n            return c.offsetLeft = c.pageX - d.left, c.offsetTop = c.pageY - d.top, c.x = c.offsetLeft, c.y = c.offsetTop, c.target = null, c\r\n        }\r\n\r\n        function e(a) {\r\n            document.onselectstart = function () {\r\n                return !1\r\n            }, this.mouseOver = !0;\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mouseover", b), n.dispatchEvent("mouseover", b)\r\n        }\r\n\r\n        function f(a) {\r\n            p = setTimeout(function () {\r\n                o = !0\r\n            }, 500), document.onselectstart = function () {\r\n                return !0\r\n            };\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mouseout", b), n.dispatchEvent("mouseout", b), n.needRepaint = 0 == n.animate ? !1 : !0\r\n        }\r\n\r\n        function g(a) {\r\n            var b = d(a);\r\n            n.mouseDown = !0, n.mouseDownX = b.x, n.mouseDownY = b.y, n.dispatchEventToScenes("mousedown", b), n.dispatchEvent("mousedown", b)\r\n        }\r\n\r\n        function h(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mouseup", b), n.dispatchEvent("mouseup", b), n.mouseDown = !1, n.needRepaint = 0 == n.animate ? !1 : !0\r\n        }\r\n\r\n        function i(a) {\r\n            p && (window.clearTimeout(p), p = null), o = !1;\r\n            var b = d(a);\r\n            n.mouseDown ? 0 == a.button && (b.dx = b.x - n.mouseDownX, b.dy = b.y - n.mouseDownY, n.dispatchEventToScenes("mousedrag", b), n.dispatchEvent("mousedrag", b), 1 == n.eagleEye.visible && n.eagleEye.update()) : (n.dispatchEventToScenes("mousemove", b), n.dispatchEvent("mousemove", b))\r\n        }\r\n\r\n        function j(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("click", b), n.dispatchEvent("click", b)\r\n        }\r\n\r\n        function k(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("dbclick", b), n.dispatchEvent("dbclick", b)\r\n        }\r\n\r\n        function l(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mousewheel", b), n.dispatchEvent("mousewheel", b), null != n.wheelZoom && (a.preventDefault ? a.preventDefault() : (a = a || window.event, a.returnValue = !1), 1 == n.eagleEye.visible && n.eagleEye.update())\r\n        }\r\n\r\n        function m(b) {\r\n            a.util.isIE || !window.addEventListener ? (b.onmouseout = f, b.onmouseover = e, b.onmousedown = g, b.onmouseup = h, b.onmousemove = i, b.onclick = j, b.ondblclick = k, b.onmousewheel = l, b.touchstart = g, b.touchmove = i, b.touchend = h) : (b.addEventListener("mouseout", f), b.addEventListener("mouseover", e), b.addEventListener("mousedown", g), b.addEventListener("mouseup", h), b.addEventListener("mousemove", i), b.addEventListener("click", j), b.addEventListener("dblclick", k), a.util.isFirefox ? b.addEventListener("DOMMouseScroll", l) : b.addEventListener("mousewheel", l)), window.addEventListener && (window.addEventListener("keydown", function (b) {\r\n                n.dispatchEventToScenes("keydown", a.util.cloneEvent(b));\r\n                var c = b.keyCode;\r\n                (37 == c || 38 == c || 39 == c || 40 == c) && (b.preventDefault ? b.preventDefault() : (b = b || window.event, b.returnValue = !1))\r\n            }, !0), window.addEventListener("keyup", function (b) {\r\n                n.dispatchEventToScenes("keyup", a.util.cloneEvent(b));\r\n                var c = b.keyCode;\r\n                (37 == c || 38 == c || 39 == c || 40 == c) && (b.preventDefault ? b.preventDefault() : (b = b || window.event, b.returnValue = !1))\r\n            }, !0))\r\n        }\r\n\r\n        a.stage = this;\r\n        var n = this;\r\n        this.initialize = function (c) {\r\n            m(c), this.canvas = c, this.graphics = c.getContext("2d"), this.childs = [], this.frames = 24, this.messageBus = new a.util.MessageBus, this.eagleEye = b(this), this.wheelZoom = null, this.mouseDownX = 0, this.mouseDownY = 0, this.mouseDown = !1, this.mouseOver = !1, this.needRepaint = !0, this.serializedProperties = ["frames", "wheelZoom"]\r\n        }, null != c && this.initialize(c);\r\n        var o = !0, p = null;\r\n        document.oncontextmenu = function () {\r\n            return o\r\n        }, this.dispatchEventToScenes = function (a, b) {\r\n            if (0 != this.frames && (this.needRepaint = !0), 1 == this.eagleEye.visible && -1 != a.indexOf("mouse")) {\r\n                var c = b.x, d = b.y;\r\n                if (c > this.width - this.eagleEye.width && d > this.height - this.eagleEye.height)return void this.eagleEye.eventHandler(a, b, this)\r\n            }\r\n            this.childs.forEach(function (c) {\r\n                if (1 == c.visible) {\r\n                    var d = c[a + "Handler"];\r\n                    if (null == d)throw new Error("Function not found:" + a + "Handler");\r\n                    d.call(c, b)\r\n                }\r\n            })\r\n        }, this.add = function (a) {\r\n            for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a)return;\r\n            a.addTo(this), this.childs.push(a)\r\n        }, this.remove = function (a) {\r\n            if (null == a)throw new Error("Stage.remove出错: 参数为null!");\r\n            for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a)return a.stage = null, this.childs = this.childs.del(b), this;\r\n            return this\r\n        }, this.clear = function () {\r\n            this.childs = []\r\n        }, this.addEventListener = function (a, b) {\r\n            var c = this, d = function (a) {\r\n                b.call(c, a)\r\n            };\r\n            return this.messageBus.subscribe(a, d), this\r\n        }, this.removeEventListener = function (a) {\r\n            this.messageBus.unsubscribe(a)\r\n        }, this.removeAllEventListener = function () {\r\n            this.messageBus = new a.util.MessageBus\r\n        }, this.dispatchEvent = function (a, b) {\r\n            return this.messageBus.publish(a, b), this\r\n        };\r\n        var q = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), r = this;\r\n        q.forEach(function (a) {\r\n            r[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        }), this.saveImageInfo = function (a, b) {\r\n            var c = this.eagleEye.getImage(a, b), d = window.open("about:blank");\r\n            return d.document.write("<img src=\'" + c + "\' alt=\'from canvas\'/>"), this\r\n        }, this.saveAsLocalImage = function (a, b) {\r\n            var c = this.eagleEye.getImage(a, b);\r\n            return c.replace("image/png", "image/octet-stream"), window.location.href = c, this\r\n        }, this.paint = function () {\r\n            null != this.canvas && (this.graphics.save(), this.graphics.clearRect(0, 0, this.width, this.height), this.childs.forEach(function (a) {\r\n                1 == a.visible && a.repaint(n.graphics)\r\n            }), 1 == this.eagleEye.visible && this.eagleEye.paint(this), this.graphics.restore())\r\n        }, this.repaint = function () {\r\n            0 != this.frames && (this.frames < 0 && 0 == this.needRepaint || (this.paint(), this.frames < 0 && (this.needRepaint = !1)))\r\n        }, this.zoom = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoom(a)\r\n            })\r\n        }, this.zoomOut = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoomOut(a)\r\n            })\r\n        }, this.zoomIn = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoomIn(a)\r\n            })\r\n        }, this.centerAndZoom = function () {\r\n            this.childs.forEach(function (a) {\r\n                0 != a.visible && a.centerAndZoom()\r\n            })\r\n        }, this.setCenter = function (a, b) {\r\n            var c = this;\r\n            this.childs.forEach(function (d) {\r\n                var e = a - c.canvas.width / 2, f = b - c.canvas.height / 2;\r\n                d.translateX = -e, d.translateY = -f\r\n            })\r\n        }, this.getBound = function () {\r\n            var a = {left: Number.MAX_VALUE, right: Number.MIN_VALUE, top: Number.MAX_VALUE, bottom: Number.MIN_VALUE};\r\n            return this.childs.forEach(function (b) {\r\n                var c = b.getElementsBound();\r\n                c.left < a.left && (a.left = c.left, a.leftNode = c.leftNode), c.top < a.top && (a.top = c.top, a.topNode = c.topNode), c.right > a.right && (a.right = c.right, a.rightNode = c.rightNode), c.bottom > a.bottom && (a.bottom = c.bottom, a.bottomNode = c.bottomNode)\r\n            }), a.width = a.right - a.left, a.height = a.bottom - a.top, a\r\n        }, this.toJson = function () {\r\n            {\r\n                var b = this, c = \'{"version":"\' + a.version + \'",\';\r\n                this.serializedProperties.length\r\n            }\r\n            return this.serializedProperties.forEach(function (a) {\r\n                var d = b[a];\r\n                "string" == typeof d && (d = \'"\' + d + \'"\'), c += \'"\' + a + \'":\' + d + ","\r\n            }), c += \'"childs":[\', this.childs.forEach(function (a) {\r\n                c += a.toJson()\r\n            }), c += "]", c += "}"\r\n        }, function () {\r\n            0 == n.frames ? setTimeout(arguments.callee, 100) : n.frames < 0 ? (n.repaint(), setTimeout(arguments.callee, 1e3 / -n.frames)) : (n.repaint(), setTimeout(arguments.callee, 1e3 / n.frames))\r\n        }(), setTimeout(function () {\r\n            n.mousewheel(function (a) {\r\n                var b = null == a.wheelDelta ? a.detail : a.wheelDelta;\r\n                null != this.wheelZoom && (b > 0 ? this.zoomIn(this.wheelZoom) : this.zoomOut(this.wheelZoom))\r\n            }), n.paint()\r\n        }, 300), setTimeout(function () {\r\n            n.paint()\r\n        }, 1e3), setTimeout(function () {\r\n            n.paint()\r\n        }, 3e3)\r\n    }\r\n\r\n    c.prototype = {\r\n        get width() {\r\n            return this.canvas.width\r\n        }, get height() {\r\n            return this.canvas.height\r\n        }, set cursor(a) {\r\n            this.canvas.style.cursor = a\r\n        }, get cursor() {\r\n            return this.canvas.style.cursor\r\n        }, set mode(a) {\r\n            this.childs.forEach(function (b) {\r\n                b.mode = a\r\n            })\r\n        }\r\n    }, a.Stage = c\r\n}(JTopo), function (a) {\r\n    function b(c) {\r\n        function d(a, b, c, d) {\r\n            return function (e) {\r\n                e.beginPath(), e.strokeStyle = "rgba(0,0,236,0.5)", e.fillStyle = "rgba(0,0,236,0.1)", e.rect(a, b, c, d), e.fill(), e.stroke(), e.closePath()\r\n            }\r\n        }\r\n\r\n        var e = this;\r\n        this.initialize = function () {\r\n            b.prototype.initialize.apply(this, arguments), this.messageBus = new a.util.MessageBus, this.elementType = "scene", this.childs = [], this.zIndexMap = {}, this.zIndexArray = [], this.backgroundColor = "255,255,255", this.visible = !0, this.alpha = 0, this.scaleX = 1, this.scaleY = 1, this.mode = a.SceneMode.normal, this.translate = !0, this.translateX = 0, this.translateY = 0, this.lastTranslateX = 0, this.lastTranslateY = 0, this.mouseDown = !1, this.mouseDownX = null, this.mouseDownY = null, this.mouseDownEvent = null, this.areaSelect = !0, this.operations = [], this.selectedElements = [], this.paintAll = !1;\r\n            var c = "background,backgroundColor,mode,paintAll,areaSelect,translate,translateX,translateY,lastTranslatedX,lastTranslatedY,alpha,visible,scaleX,scaleY".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(c)\r\n        }, this.initialize(), this.setBackground = function (a) {\r\n            this.background = a\r\n        }, this.addTo = function (a) {\r\n            this.stage !== a && null != a && (this.stage = a)\r\n        }, null != c && (c.add(this), this.addTo(c)), this.show = function () {\r\n            this.visible = !0\r\n        }, this.hide = function () {\r\n            this.visible = !1\r\n        }, this.paint = function (a) {\r\n            if (0 != this.visible && null != this.stage) {\r\n                if (a.save(), this.paintBackgroud(a), a.restore(), a.save(), a.scale(this.scaleX, this.scaleY), 1 == this.translate) {\r\n                    var b = this.getOffsetTranslate(a);\r\n                    a.translate(b.translateX, b.translateY)\r\n                }\r\n                this.paintChilds(a), a.restore(), a.save(), this.paintOperations(a, this.operations), a.restore()\r\n            }\r\n        }, this.repaint = function (a) {\r\n            0 != this.visible && this.paint(a)\r\n        }, this.paintBackgroud = function (a) {\r\n            null != this.background ? a.drawImage(this.background, 0, 0, a.canvas.width, a.canvas.height) : (a.beginPath(), a.fillStyle = "rgba(" + this.backgroundColor + "," + this.alpha + ")", a.fillRect(0, 0, a.canvas.width, a.canvas.height), a.closePath())\r\n        }, this.getDisplayedElements = function () {\r\n            for (var a = [], b = 0; b < this.zIndexArray.length; b++)for (var c = this.zIndexArray[b], d = this.zIndexMap[c], e = 0; e < d.length; e++) {\r\n                var f = d[e];\r\n                this.isVisiable(f) && a.push(f)\r\n            }\r\n            return a\r\n        }, this.getDisplayedNodes = function () {\r\n            for (var b = [], c = 0; c < this.childs.length; c++) {\r\n                var d = this.childs[c];\r\n                d instanceof a.Node && this.isVisiable(d) && b.push(d)\r\n            }\r\n            return b\r\n        }, this.paintChilds = function (b) {\r\n            for (var c = 0; c < this.zIndexArray.length; c++)for (var d = this.zIndexArray[c], e = this.zIndexMap[d], f = 0; f < e.length; f++) {\r\n                var g = e[f];\r\n                if (1 == this.paintAll || this.isVisiable(g)) {\r\n                    if (b.save(), 1 == g.transformAble) {\r\n                        var h = g.getCenterLocation();\r\n                        b.translate(h.x, h.y), g.rotate && b.rotate(g.rotate), g.scaleX && g.scaleY ? b.scale(g.scaleX, g.scaleY) : g.scaleX ? b.scale(g.scaleX, 1) : g.scaleY && b.scale(1, g.scaleY)\r\n                    }\r\n                    1 == g.shadow && (b.shadowBlur = g.shadowBlur, b.shadowColor = g.shadowColor, b.shadowOffsetX = g.shadowOffsetX, b.shadowOffsetY = g.shadowOffsetY), g instanceof a.InteractiveElement && (g.selected && 1 == g.showSelected && g.paintSelected(b), 1 == g.isMouseOver && g.paintMouseover(b)), g.paint(b), b.restore()\r\n                }\r\n            }\r\n        }, this.getOffsetTranslate = function (a) {\r\n            var b = this.stage.canvas.width, c = this.stage.canvas.height;\r\n            null != a && "move" != a && (b = a.canvas.width, c = a.canvas.height);\r\n            var d = b / this.scaleX / 2, e = c / this.scaleY / 2, f = {translateX: this.translateX + (d - d * this.scaleX), translateY: this.translateY + (e - e * this.scaleY)};\r\n            return f\r\n        }, this.isVisiable = function (b) {\r\n            if (1 != b.visible)return !1;\r\n            if (b instanceof a.Link)return !0;\r\n            var c = this.getOffsetTranslate(), d = b.x + c.translateX, e = b.y + c.translateY;\r\n            d *= this.scaleX, e *= this.scaleY;\r\n            var f = d + b.width * this.scaleX, g = e + b.height * this.scaleY;\r\n            return d > this.stage.canvas.width || e > this.stage.canvas.height || 0 > f || 0 > g ? !1 : !0\r\n        }, this.paintOperations = function (a, b) {\r\n            for (var c = 0; c < b.length; c++)b[c](a)\r\n        }, this.findElements = function (a) {\r\n            for (var b = [], c = 0; c < this.childs.length; c++)1 == a(this.childs[c]) && b.push(this.childs[c]);\r\n            return b\r\n        }, this.getElementsByClass = function (a) {\r\n            return this.findElements(function (b) {\r\n                return b instanceof a\r\n            })\r\n        }, this.addOperation = function (a) {\r\n            return this.operations.push(a), this\r\n        }, this.clearOperations = function () {\r\n            return this.operations = [], this\r\n        }, this.getElementByXY = function (b, c) {\r\n            for (var d = null, e = this.zIndexArray.length - 1; e >= 0; e--)for (var f = this.zIndexArray[e], g = this.zIndexMap[f], h = g.length - 1; h >= 0; h--) {\r\n                var i = g[h];\r\n                if (i instanceof a.InteractiveElement && this.isVisiable(i) && i.isInBound(b, c))return d = i\r\n            }\r\n            return d\r\n        }, this.add = function (a) {\r\n            this.childs.push(a), null == this.zIndexMap[a.zIndex] && (this.zIndexMap[a.zIndex] = [], this.zIndexArray.push(a.zIndex), this.zIndexArray.sort(function (a, b) {\r\n                return a - b\r\n            })), this.zIndexMap["" + a.zIndex].push(a)\r\n        }, this.remove = function (b) {\r\n            this.childs = a.util.removeFromArray(this.childs, b);\r\n            var c = this.zIndexMap[b.zIndex];\r\n            c && (this.zIndexMap[b.zIndex] = a.util.removeFromArray(c, b)), b.removeHandler(this)\r\n        }, this.clear = function () {\r\n            var a = this;\r\n            this.childs.forEach(function (b) {\r\n                b.removeHandler(a)\r\n            }), this.childs = [], this.operations = [], this.zIndexArray = [], this.zIndexMap = {}\r\n        }, this.addToSelected = function (a) {\r\n            this.selectedElements.push(a)\r\n        }, this.cancleAllSelected = function (a) {\r\n            for (var b = 0; b < this.selectedElements.length; b++)this.selectedElements[b].unselectedHandler(a);\r\n            this.selectedElements = []\r\n        }, this.notInSelectedNodes = function (a) {\r\n            for (var b = 0; b < this.selectedElements.length; b++)if (a === this.selectedElements[b])return !1;\r\n            return !0\r\n        }, this.removeFromSelected = function (a) {\r\n            for (var b = 0; b < this.selectedElements.length; b++) {\r\n                var c = this.selectedElements[b];\r\n                a === c && (this.selectedElements = this.selectedElements.del(b))\r\n            }\r\n        }, this.toSceneEvent = function (b) {\r\n            var c = a.util.clone(b);\r\n            if (c.x /= this.scaleX, c.y /= this.scaleY, 1 == this.translate) {\r\n                var d = this.getOffsetTranslate();\r\n                c.x -= d.translateX, c.y -= d.translateY\r\n            }\r\n            return null != c.dx && (c.dx /= this.scaleX, c.dy /= this.scaleY), null != this.currentElement && (c.target = this.currentElement), c.scene = this, c\r\n        }, this.selectElement = function (a) {\r\n            var b = e.getElementByXY(a.x, a.y);\r\n            if (null != b)if (a.target = b, b.mousedownHander(a), b.selectedHandler(a), e.notInSelectedNodes(b))a.ctrlKey || e.cancleAllSelected(), e.addToSelected(b); else {\r\n                1 == a.ctrlKey && (b.unselectedHandler(), this.removeFromSelected(b));\r\n                for (var c = 0; c < this.selectedElements.length; c++) {\r\n                    var d = this.selectedElements[c];\r\n                    d.selectedHandler(a)\r\n                }\r\n            } else a.ctrlKey || e.cancleAllSelected();\r\n            this.currentElement = b\r\n        }, this.mousedownHandler = function (b) {\r\n            var c = this.toSceneEvent(b);\r\n            if (this.mouseDown = !0, this.mouseDownX = c.x, this.mouseDownY = c.y, this.mouseDownEvent = c, this.mode == a.SceneMode.normal)this.selectElement(c), (null == this.currentElement || this.currentElement instanceof a.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX, this.lastTranslateY = this.translateY); else {\r\n                if (this.mode == a.SceneMode.drag && 1 == this.translate)return this.lastTranslateX = this.translateX, void(this.lastTranslateY = this.translateY);\r\n                this.mode == a.SceneMode.select ? this.selectElement(c) : this.mode == a.SceneMode.edit && (this.selectElement(c), (null == this.currentElement || this.currentElement instanceof a.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX, this.lastTranslateY = this.translateY))\r\n            }\r\n            e.dispatchEvent("mousedown", c)\r\n        }, this.mouseupHandler = function (b) {\r\n            this.stage.cursor != a.MouseCursor.normal && (this.stage.cursor = a.MouseCursor.normal), e.clearOperations();\r\n            var c = this.toSceneEvent(b);\r\n            null != this.currentElement && (c.target = e.currentElement, this.currentElement.mouseupHandler(c)), this.dispatchEvent("mouseup", c), this.mouseDown = !1\r\n        }, this.dragElements = function (b) {\r\n            if (null != this.currentElement && 1 == this.currentElement.dragable)for (var c = 0; c < this.selectedElements.length; c++) {\r\n                var d = this.selectedElements[c];\r\n                if (0 != d.dragable) {\r\n                    var e = a.util.clone(b);\r\n                    e.target = d, d.mousedragHandler(e)\r\n                }\r\n            }\r\n        }, this.mousedragHandler = function (b) {\r\n            var c = this.toSceneEvent(b);\r\n            this.mode == a.SceneMode.normal ? null == this.currentElement || this.currentElement instanceof a.Link ? 1 == this.translate && (this.stage.cursor = a.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c) : this.mode == a.SceneMode.drag ? 1 == this.translate && (this.stage.cursor = a.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.mode == a.SceneMode.select ? null != this.currentElement ? 1 == this.currentElement.dragable && this.dragElements(c) : 1 == this.areaSelect && this.areaSelectHandle(c) : this.mode == a.SceneMode.edit && (null == this.currentElement || this.currentElement instanceof a.Link ? 1 == this.translate && (this.stage.cursor = a.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c)), this.dispatchEvent("mousedrag", c)\r\n        }, this.areaSelectHandle = function (a) {\r\n            var b = a.offsetLeft, c = a.offsetTop, f = this.mouseDownEvent.offsetLeft, g = this.mouseDownEvent.offsetTop, h = b >= f ? f : b, i = c >= g ? g : c, j = Math.abs(a.dx) * this.scaleX, k = Math.abs(a.dy) * this.scaleY, l = new d(h, i, j, k);\r\n            e.clearOperations().addOperation(l), b = a.x, c = a.y, f = this.mouseDownEvent.x, g = this.mouseDownEvent.y, h = b >= f ? f : b, i = c >= g ? g : c, j = Math.abs(a.dx), k = Math.abs(a.dy);\r\n            for (var m = h + j, n = i + k, o = 0; o < e.childs.length; o++) {\r\n                var p = e.childs[o];\r\n                p.x > h && p.x + p.width < m && p.y > i && p.y + p.height < n && e.notInSelectedNodes(p) && (p.selectedHandler(a), e.addToSelected(p))\r\n            }\r\n        }, this.mousemoveHandler = function (b) {\r\n            this.mousecoord = {x: b.x, y: b.y};\r\n            var c = this.toSceneEvent(b);\r\n            if (this.mode == a.SceneMode.drag)return void(this.stage.cursor = a.MouseCursor.open_hand);\r\n            this.mode == a.SceneMode.normal ? this.stage.cursor = a.MouseCursor.normal : this.mode == a.SceneMode.select && (this.stage.cursor = a.MouseCursor.normal);\r\n            var d = e.getElementByXY(c.x, c.y);\r\n            null != d ? (e.mouseOverelement && e.mouseOverelement !== d && (c.target = d, e.mouseOverelement.mouseoutHandler(c)), e.mouseOverelement = d, 0 == d.isMouseOver ? (c.target = d, d.mouseoverHandler(c), e.dispatchEvent("mouseover", c)) : (c.target = d, d.mousemoveHandler(c), e.dispatchEvent("mousemove", c))) : e.mouseOverelement ? (c.target = d, e.mouseOverelement.mouseoutHandler(c), e.mouseOverelement = null, e.dispatchEvent("mouseout", c)) : (c.target = null, e.dispatchEvent("mousemove", c))\r\n        }, this.mouseoverHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mouseover", b)\r\n        }, this.mouseoutHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mouseout", b)\r\n        }, this.clickHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.currentElement && (b.target = this.currentElement, this.currentElement.clickHandler(b)), this.dispatchEvent("click", b)\r\n        }, this.dbclickHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.currentElement ? (b.target = this.currentElement, this.currentElement.dbclickHandler(b)) : e.cancleAllSelected(), this.dispatchEvent("dbclick", b)\r\n        }, this.mousewheelHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mousewheel", b)\r\n        }, this.touchstart = this.mousedownHander, this.touchmove = this.mousedragHandler, this.touchend = this.mousedownHander, this.keydownHandler = function (a) {\r\n            this.dispatchEvent("keydown", a)\r\n        }, this.keyupHandler = function (a) {\r\n            this.dispatchEvent("keyup", a)\r\n        }, this.addEventListener = function (a, b) {\r\n            var c = this, d = function (a) {\r\n                b.call(c, a)\r\n            };\r\n            return this.messageBus.subscribe(a, d), this\r\n        }, this.removeEventListener = function (a) {\r\n            this.messageBus.unsubscribe(a)\r\n        }, this.removeAllEventListener = function () {\r\n            this.messageBus = new a.util.MessageBus\r\n        }, this.dispatchEvent = function (a, b) {\r\n            return this.messageBus.publish(a, b), this\r\n        };\r\n        var f = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), g = this;\r\n        return f.forEach(function (a) {\r\n            g[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        }), this.zoom = function (a, b) {\r\n            null != a && 0 != a && (this.scaleX = a), null != b && 0 != b && (this.scaleY = b)\r\n        }, this.zoomOut = function (a) {\r\n            0 != a && (null == a && (a = .8), this.scaleX /= a, this.scaleY /= a)\r\n        }, this.zoomIn = function (a) {\r\n            0 != a && (null == a && (a = .8), this.scaleX *= a, this.scaleY *= a)\r\n        }, this.getBound = function () {\r\n            return {left: 0, top: 0, right: this.stage.canvas.width, bottom: this.stage.canvas.height, width: this.stage.canvas.width, height: this.stage.canvas.height}\r\n        }, this.getElementsBound = function () {\r\n            return a.util.getElementsBound(this.childs)\r\n        }, this.translateToCenter = function (a) {\r\n            var b = this.getElementsBound(), c = this.stage.canvas.width / 2 - (b.left + b.right) / 2, d = this.stage.canvas.height / 2 - (b.top + b.bottom) / 2;\r\n            a && (c = a.canvas.width / 2 - (b.left + b.right) / 2, d = a.canvas.height / 2 - (b.top + b.bottom) / 2), this.translateX = c, this.translateY = d\r\n        }, this.setCenter = function (a, b) {\r\n            var c = a - this.stage.canvas.width / 2, d = b - this.stage.canvas.height / 2;\r\n            this.translateX = -c, this.translateY = -d\r\n        }, this.centerAndZoom = function (a, b, c) {\r\n            if (this.translateToCenter(c), null == a || null == b) {\r\n                var d = this.getElementsBound(), e = d.right - d.left, f = d.bottom - d.top, g = this.stage.canvas.width / e, h = this.stage.canvas.height / f;\r\n                c && (g = c.canvas.width / e, h = c.canvas.height / f);\r\n                var i = Math.min(g, h);\r\n                if (i > 1)return;\r\n                this.zoom(i, i)\r\n            }\r\n            this.zoom(a, b)\r\n        }, this.getCenterLocation = function () {\r\n            return {x: e.stage.canvas.width / 2, y: e.stage.canvas.height / 2}\r\n        }, this.doLayout = function (a) {\r\n            a && a(this, this.childs)\r\n        }, this.toJson = function () {\r\n            {\r\n                var a = this, b = "{";\r\n                this.serializedProperties.length\r\n            }\r\n            this.serializedProperties.forEach(function (c) {\r\n                var d = a[c];\r\n                "background" == c && (d = a._background.src), "string" == typeof d && (d = \'"\' + d + \'"\'), b += \'"\' + c + \'":\' + d + ","\r\n            }), b += \'"childs":[\';\r\n            var c = this.childs.length;\r\n            return this.childs.forEach(function (a, d) {\r\n                b += a.toJson(), c > d + 1 && (b += ",")\r\n            }), b += "]", b += "}"\r\n        }, e\r\n    }\r\n\r\n    b.prototype = new a.Element;\r\n    var c = {};\r\n    Object.defineProperties(b.prototype, {\r\n        background: {\r\n            get: function () {\r\n                return this._background\r\n            }, set: function (a) {\r\n                if ("string" == typeof a) {\r\n                    var b = c[a];\r\n                    null == b && (b = new Image, b.src = a, b.onload = function () {\r\n                        c[a] = b\r\n                    }), this._background = b\r\n                } else this._background = a\r\n            }\r\n        }\r\n    }), a.Scene = b\r\n}(JTopo), function (a) {\r\n    function b() {\r\n        this.initialize = function () {\r\n            b.prototype.initialize.apply(this, arguments), this.elementType = "displayElement", this.x = 0, this.y = 0, this.width = 32, this.height = 32, this.visible = !0, this.alpha = 1, this.rotate = 0, this.scaleX = 1, this.scaleY = 1, this.strokeColor = "22,124,255", this.borderColor = "22,124,255", this.fillColor = "22,124,255", this.shadow = !1, this.shadowBlur = 5, this.shadowColor = "rgba(0,0,0,0.5)", this.shadowOffsetX = 3, this.shadowOffsetY = 6, this.transformAble = !1, this.zIndex = 0;\r\n            var a = "x,y,width,height,visible,alpha,rotate,scaleX,scaleY,strokeColor,fillColor,shadow,shadowColor,shadowOffsetX,shadowOffsetY,transformAble,zIndex".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(a)\r\n        }, this.initialize(), this.paint = function (a) {\r\n            a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", a.rect(-this.width / 2, -this.height / 2, this.width, this.height), a.fill(), a.stroke(), a.closePath()\r\n        }, this.getLocation = function () {\r\n            return {x: this.x, y: this.y}\r\n        }, this.setLocation = function (a, b) {\r\n            return this.x = a, this.y = b, this\r\n        }, this.getCenterLocation = function () {\r\n            return {x: this.x + this.width / 2, y: this.y + this.height / 2}\r\n        }, this.setCenterLocation = function (a, b) {\r\n            return this.x = a - this.width / 2, this.y = b - this.height / 2, this\r\n        }, this.getSize = function () {\r\n            return {width: this.width, height: this.heith}\r\n        }, this.setSize = function (a, b) {\r\n            return this.width = a, this.height = b, this\r\n        }, this.getBound = function () {\r\n            return {left: this.x, top: this.y, right: this.x + this.width, bottom: this.y + this.height, width: this.width, height: this.height}\r\n        }, this.setBound = function (a, b, c, d) {\r\n            return this.setLocation(a, b), this.setSize(c, d), this\r\n        }, this.getDisplayBound = function () {\r\n            return {left: this.x, top: this.y, right: this.x + this.width * this.scaleX, bottom: this.y + this.height * this.scaleY}\r\n        }, this.getDisplaySize = function () {\r\n            return {width: this.width * this.scaleX, height: this.height * this.scaleY}\r\n        }, this.getPosition = function (a) {\r\n            var b, c = this.getBound();\r\n            return "Top_Left" == a ? b = {x: c.left, y: c.top} : "Top_Center" == a ? b = {x: this.cx, y: c.top} : "Top_Right" == a ? b = {x: c.right, y: c.top} : "Middle_Left" == a ? b = {\r\n                x: c.left,\r\n                y: this.cy\r\n            } : "Middle_Center" == a ? b = {x: this.cx, y: this.cy} : "Middle_Right" == a ? b = {x: c.right, y: this.cy} : "Bottom_Left" == a ? b = {\r\n                x: c.left,\r\n                y: c.bottom\r\n            } : "Bottom_Center" == a ? b = {x: this.cx, y: c.bottom} : "Bottom_Right" == a && (b = {x: c.right, y: c.bottom}), b\r\n        }\r\n    }\r\n\r\n    function c() {\r\n        this.initialize = function () {\r\n            c.prototype.initialize.apply(this, arguments), this.elementType = "interactiveElement", this.dragable = !1, this.selected = !1, this.showSelected = !0, this.selectedLocation = null, this.isMouseOver = !1;\r\n            var a = "dragable,selected,showSelected,isMouseOver".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(a)\r\n        }, this.initialize(), this.paintSelected = function (a) {\r\n            0 != this.showSelected && (a.save(), a.beginPath(), a.strokeStyle = "rgba(168,202,255, 0.9)", a.fillStyle = "rgba(168,202,236,0.7)", a.rect(-this.width / 2 - 3, -this.height / 2 - 3, this.width + 6, this.height + 6), a.fill(), a.stroke(), a.closePath(), a.restore())\r\n        }, this.paintMouseover = function (a) {\r\n            return this.paintSelected(a)\r\n        }, this.isInBound = function (a, b) {\r\n            return a > this.x && a < this.x + this.width * Math.abs(this.scaleX) && b > this.y && b < this.y + this.height * Math.abs(this.scaleY)\r\n        }, this.selectedHandler = function () {\r\n            this.selected = !0, this.selectedLocation = {x: this.x, y: this.y}\r\n        }, this.unselectedHandler = function () {\r\n            this.selected = !1, this.selectedLocation = null\r\n        }, this.dbclickHandler = function (a) {\r\n            this.dispatchEvent("dbclick", a)\r\n        }, this.clickHandler = function (a) {\r\n            this.dispatchEvent("click", a)\r\n        }, this.mousedownHander = function (a) {\r\n            this.dispatchEvent("mousedown", a)\r\n        }, this.mouseupHandler = function (a) {\r\n            this.dispatchEvent("mouseup", a)\r\n        }, this.mouseoverHandler = function (a) {\r\n            this.isMouseOver = !0, this.dispatchEvent("mouseover", a)\r\n        }, this.mousemoveHandler = function (a) {\r\n            this.dispatchEvent("mousemove", a)\r\n        }, this.mouseoutHandler = function (a) {\r\n            this.isMouseOver = !1, this.dispatchEvent("mouseout", a)\r\n        }, this.mousedragHandler = function (a) {\r\n            var b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n            this.setLocation(b, c), this.dispatchEvent("mousedrag", a)\r\n        }, this.addEventListener = function (b, c) {\r\n            var d = this, e = function (a) {\r\n                c.call(d, a)\r\n            };\r\n            return this.messageBus || (this.messageBus = new a.util.MessageBus), this.messageBus.subscribe(b, e), this\r\n        }, this.dispatchEvent = function (a, b) {\r\n            return this.messageBus ? (this.messageBus.publish(a, b), this) : null\r\n        }, this.removeEventListener = function (a) {\r\n            this.messageBus.unsubscribe(a)\r\n        }, this.removeAllEventListener = function () {\r\n            this.messageBus = new a.util.MessageBus\r\n        };\r\n        var b = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,touchstart,touchmove,touchend".split(","), d = this;\r\n        b.forEach(function (a) {\r\n            d[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        })\r\n    }\r\n\r\n    function d() {\r\n        this.initialize = function () {\r\n            d.prototype.initialize.apply(this, arguments), this.editAble = !1, this.selectedPoint = null\r\n        }, this.getCtrlPosition = function (a) {\r\n            var b = 5, c = 5, d = this.getPosition(a);\r\n            return {left: d.x - b, top: d.y - c, right: d.x + b, bottom: d.y + c}\r\n        }, this.selectedHandler = function (b) {\r\n            d.prototype.selectedHandler.apply(this, arguments), this.selectedSize = {width: this.width, height: this.height}, b.scene.mode == a.SceneMode.edit && (this.editAble = !0)\r\n        }, this.unselectedHandler = function () {\r\n            d.prototype.unselectedHandler.apply(this, arguments), this.selectedSize = null, this.editAble = !1\r\n        };\r\n        var b = ["Top_Left", "Top_Center", "Top_Right", "Middle_Left", "Middle_Right", "Bottom_Left", "Bottom_Center", "Bottom_Right"];\r\n        this.paintCtrl = function (a) {\r\n            if (0 != this.editAble) {\r\n                a.save();\r\n                for (var c = 0; c < b.length; c++) {\r\n                    var d = this.getCtrlPosition(b[c]);\r\n                    d.left -= this.cx, d.right -= this.cx, d.top -= this.cy, d.bottom -= this.cy;\r\n                    var e = d.right - d.left, f = d.bottom - d.top;\r\n                    a.beginPath(), a.strokeStyle = "rgba(0,0,0,0.8)", a.rect(d.left, d.top, e, f), a.stroke(), a.closePath(), a.beginPath(), a.strokeStyle = "rgba(255,255,255,0.3)", a.rect(d.left + 1, d.top + 1, e - 2, f - 2), a.stroke(), a.closePath()\r\n                }\r\n                a.restore()\r\n            }\r\n        }, this.isInBound = function (a, c) {\r\n            if (this.selectedPoint = null, 1 == this.editAble)for (var e = 0; e < b.length; e++) {\r\n                var f = this.getCtrlPosition(b[e]);\r\n                if (a > f.left && a < f.right && c > f.top && c < f.bottom)return this.selectedPoint = b[e], !0\r\n            }\r\n            return d.prototype.isInBound.apply(this, arguments)\r\n        }, this.mousedragHandler = function (a) {\r\n            if (null == this.selectedPoint) {\r\n                var b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                this.setLocation(b, c), this.dispatchEvent("mousedrag", a)\r\n            } else {\r\n                if ("Top_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, e = this.selectedSize.height - a.dy, b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                    b < this.x + this.width && (this.x = b, this.width = d), c < this.y + this.height && (this.y = c, this.height = e)\r\n                } else if ("Top_Center" == this.selectedPoint) {\r\n                    var e = this.selectedSize.height - a.dy, c = this.selectedLocation.y + a.dy;\r\n                    c < this.y + this.height && (this.y = c, this.height = e)\r\n                } else if ("Top_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx, c = this.selectedLocation.y + a.dy;\r\n                    c < this.y + this.height && (this.y = c, this.height = this.selectedSize.height - a.dy), d > 1 && (this.width = d)\r\n                } else if ("Middle_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                    b < this.x + this.width && (this.x = b), d > 1 && (this.width = d)\r\n                } else if ("Middle_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx;\r\n                    d > 1 && (this.width = d)\r\n                } else if ("Bottom_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                    d > 1 && (this.x = b, this.width = d);\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                } else if ("Bottom_Center" == this.selectedPoint) {\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                } else if ("Bottom_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx;\r\n                    d > 1 && (this.width = d);\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                }\r\n                this.dispatchEvent("resize", a)\r\n            }\r\n        }\r\n    }\r\n\r\n    b.prototype = new a.Element, Object.defineProperties(b.prototype, {\r\n        cx: {\r\n            get: function () {\r\n                return this.x + this.width / 2\r\n            }, set: function (a) {\r\n                this.x = a - this.width / 2\r\n            }\r\n        }, cy: {\r\n            get: function () {\r\n                return this.y + this.height / 2\r\n            }, set: function (a) {\r\n                this.y = a - this.height / 2\r\n            }\r\n        }\r\n    }), c.prototype = new b, d.prototype = new c, a.DisplayElement = b, a.InteractiveElement = c, a.EditableElement = d\r\n}(JTopo), function (a) {\r\n    function b(c) {\r\n        this.initialize = function (c) {\r\n            b.prototype.initialize.apply(this, arguments), this.elementType = "node", this.zIndex = a.zIndex_Node, this.text = c, this.font = "12px Consolas", this.fontColor = "255,255,255", this.borderWidth = 0, this.borderColor = "255,255,255", this.borderRadius = null, this.dragable = !0, this.textPosition = "Bottom_Center", this.textOffsetX = 0, this.textOffsetY = 0, this.transformAble = !0, this.inLinks = null, this.outLinks = null;\r\n            var d = "text,font,fontColor,textPosition,textOffsetX,textOffsetY,borderRadius".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(d)\r\n        }, this.initialize(c), this.paint = function (a) {\r\n            if (this.image) {\r\n                var b = a.globalAlpha;\r\n                a.globalAlpha = this.alpha, null != this.alarmImage && null != this.alarm ? a.drawImage(this.alarmImage, -this.width / 2, -this.height / 2, this.width, this.height) : a.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height), a.globalAlpha = b\r\n            } else a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", null == this.borderRadius || 0 == this.borderRadius ? a.rect(-this.width / 2, -this.height / 2, this.width, this.height) : a.JTopoRoundRect(-this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius), a.fill(), a.closePath();\r\n            this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }, this.paintAlarmText = function (a) {\r\n            if (null != this.alarm && "" != this.alarm) {\r\n                var b = this.alarmColor || "255,0,0", c = this.alarmAlpha || .5;\r\n                a.beginPath(), a.font = this.alarmFont || "10px 微软雅黑";\r\n                var d = a.measureText(this.alarm).width + 6, e = a.measureText("田").width + 6, f = this.width / 2 - d / 2, g = -this.height / 2 - e - 8;\r\n                a.strokeStyle = "rgba(" + b + ", " + c + ")", a.fillStyle = "rgba(" + b + ", " + c + ")", a.lineCap = "round", a.lineWidth = 1, a.moveTo(f, g), a.lineTo(f + d, g), a.lineTo(f + d, g + e), a.lineTo(f + d / 2 + 6, g + e), a.lineTo(f + d / 2, g + e + 8), a.lineTo(f + d / 2 - 6, g + e), a.lineTo(f, g + e), a.lineTo(f, g), a.fill(), a.stroke(), a.closePath(), a.beginPath(), a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.alarm, f + 2, g + e - 4), a.closePath()\r\n            }\r\n        }, this.paintText = function (a) {\r\n            var b = this.text;\r\n            if (null != b && "" != b) {\r\n                a.beginPath(), a.font = this.font;\r\n                var c = a.measureText(b).width, d = a.measureText("田").width;\r\n                a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                var e = this.getTextPostion(this.textPosition, c, d);\r\n                a.fillText(b, e.x, e.y), a.closePath()\r\n            }\r\n        }, this.paintBorder = function (a) {\r\n            if (0 != this.borderWidth) {\r\n                a.beginPath(), a.lineWidth = this.borderWidth, a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                var b = this.borderWidth / 2;\r\n                null == this.borderRadius || 0 == this.borderRadius ? a.rect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth) : a.JTopoRoundRect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius), a.stroke(), a.closePath()\r\n            }\r\n        }, this.getTextPostion = function (a, b, c) {\r\n            var d = null;\r\n            return null == a || "Bottom_Center" == a ? d = {x: -this.width / 2 + (this.width - b) / 2, y: this.height / 2 + c} : "Top_Center" == a ? d = {\r\n                x: -this.width / 2 + (this.width - b) / 2,\r\n                y: -this.height / 2 - c / 2\r\n            } : "Top_Right" == a ? d = {x: this.width / 2, y: -this.height / 2 - c / 2} : "Top_Left" == a ? d = {\r\n                x: -this.width / 2 - b,\r\n                y: -this.height / 2 - c / 2\r\n            } : "Bottom_Right" == a ? d = {x: this.width / 2, y: this.height / 2 + c} : "Bottom_Left" == a ? d = {\r\n                x: -this.width / 2 - b,\r\n                y: this.height / 2 + c\r\n            } : "Middle_Center" == a ? d = {x: -this.width / 2 + (this.width - b) / 2, y: c / 2} : "Middle_Right" == a ? d = {\r\n                x: this.width / 2,\r\n                y: c / 2\r\n            } : "Middle_Left" == a && (d = {x: -this.width / 2 - b, y: c / 2}), null != this.textOffsetX && (d.x += this.textOffsetX), null != this.textOffsetY && (d.y += this.textOffsetY), d\r\n        }, this.setImage = function (a, b) {\r\n            if (null == a)throw new Error("Node.setImage(): 参数Image对象为空!");\r\n            var c = this;\r\n            if ("string" == typeof a) {\r\n                var d = j[a];\r\n                null == d ? (d = new Image, d.src = a, d.onload = function () {\r\n                    j[a] = d, 1 == b && c.setSize(d.width, d.height), c.image = d, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor\r\n                }) : (b && this.setSize(d.width, d.height), c.image = d, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor)\r\n            } else this.image = a, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor, 1 == b && this.setSize(a.width, a.height)\r\n        }, this.removeHandler = function (a) {\r\n            var b = this;\r\n            this.outLinks && (this.outLinks.forEach(function (c) {\r\n                c.nodeA === b && a.remove(c)\r\n            }), this.outLinks = null), this.inLinks && (this.inLinks.forEach(function (c) {\r\n                c.nodeZ === b && a.remove(c)\r\n            }), this.inLinks = null)\r\n        }\r\n    }\r\n\r\n    function c() {\r\n        c.prototype.initialize.apply(this, arguments)\r\n    }\r\n\r\n    function d(a) {\r\n        this.initialize(), this.text = a, this.elementType = "TextNode", this.paint = function (a) {\r\n            a.beginPath(), a.font = this.font, this.width = a.measureText(this.text).width, this.height = a.measureText("田").width, a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.text, -this.width / 2, this.height / 2), a.closePath(), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }\r\n    }\r\n\r\n    function e(a, b, c) {\r\n        this.initialize(), this.text = a, this.href = b, this.target = c, this.elementType = "LinkNode", this.isVisited = !1, this.visitedColor = null, this.paint = function (a) {\r\n            a.beginPath(), a.font = this.font, this.width = a.measureText(this.text).width, this.height = a.measureText("田").width, this.isVisited && null != this.visitedColor ? (a.strokeStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")") : (a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")"), a.fillText(this.text, -this.width / 2, this.height / 2), this.isMouseOver && (a.moveTo(-this.width / 2, this.height), a.lineTo(this.width / 2, this.height), a.stroke()), a.closePath(), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }, this.mousemove(function () {\r\n            var a = document.getElementsByTagName("canvas");\r\n            if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "pointer"\r\n        }), this.mouseout(function () {\r\n            var a = document.getElementsByTagName("canvas");\r\n            if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "default"\r\n        }), this.click(function () {\r\n            "_blank" == this.target ? window.open(this.href) : location = this.href, this.isVisited = !0\r\n        })\r\n    }\r\n\r\n    function f(a) {\r\n        this.initialize(arguments), this._radius = 20, this.beginDegree = 0, this.endDegree = 2 * Math.PI, this.text = a, this.paint = function (a) {\r\n            a.save(), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", a.arc(0, 0, this.radius, this.beginDegree, this.endDegree, !0), a.fill(), a.closePath(), a.restore(), this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }, this.paintSelected = function (a) {\r\n            a.save(), a.beginPath(), a.strokeStyle = "rgba(168,202,255, 0.9)", a.fillStyle = "rgba(168,202,236,0.7)", a.arc(0, 0, this.radius + 3, this.beginDegree, this.endDegree, !0), a.fill(), a.stroke(), a.closePath(), a.restore()\r\n        }\r\n    }\r\n\r\n    function g(a, b, c) {\r\n        this.initialize(), this.frameImages = a || [], this.frameIndex = 0, this.isStop = !0;\r\n        var d = b || 1e3;\r\n        this.repeatPlay = !1;\r\n        var e = this;\r\n        this.nextFrame = function () {\r\n            if (!this.isStop && null != this.frameImages.length) {\r\n                if (this.frameIndex++, this.frameIndex >= this.frameImages.length) {\r\n                    if (!this.repeatPlay)return;\r\n                    this.frameIndex = 0\r\n                }\r\n                this.setImage(this.frameImages[this.frameIndex], c), setTimeout(function () {\r\n                    e.nextFrame()\r\n                }, d / a.length)\r\n            }\r\n        }\r\n    }\r\n\r\n    function h(a, b, c, d, e) {\r\n        this.initialize();\r\n        var f = this;\r\n        this.setImage(a), this.frameIndex = 0, this.isPause = !0, this.repeatPlay = !1;\r\n        var g = d || 1e3;\r\n        e = e || 0, this.paint = function (a) {\r\n            if (this.image) {\r\n                var b = this.width, d = this.height;\r\n                a.save(), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                var f = (Math.floor(this.frameIndex / c) + e) * d, g = Math.floor(this.frameIndex % c) * b;\r\n                a.drawImage(this.image, g, f, b, d, -b / 2, -d / 2, b, d), a.fill(), a.closePath(), a.restore(), this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n            }\r\n        }, this.nextFrame = function () {\r\n            if (!this.isStop) {\r\n                if (this.frameIndex++, this.frameIndex >= b * c) {\r\n                    if (!this.repeatPlay)return;\r\n                    this.frameIndex = 0\r\n                }\r\n                setTimeout(function () {\r\n                    f.isStop || f.nextFrame()\r\n                }, g / (b * c))\r\n            }\r\n        }\r\n    }\r\n\r\n    function i() {\r\n        var a = null;\r\n        return a = arguments.length <= 3 ? new g(arguments[0], arguments[1], arguments[2]) : new h(arguments[0], arguments[1], arguments[2], arguments[3], arguments[4], arguments[5]), a.stop = function () {\r\n            a.isStop = !0\r\n        }, a.play = function () {\r\n            a.isStop = !1, a.frameIndex = 0, a.nextFrame()\r\n        }, a\r\n    }\r\n\r\n    var j = {};\r\n    b.prototype = new a.EditableElement, c.prototype = new b, Object.defineProperties(c.prototype, {\r\n        alarmColor: {\r\n            get: function () {\r\n                return this._alarmColor\r\n            }, set: function (b) {\r\n                if (this._alarmColor = b, null != this.image) {\r\n                    var c = a.util.genImageAlarm(this.image, b);\r\n                    c && (this.alarmImage = c)\r\n                }\r\n            }\r\n        }\r\n    }), d.prototype = new c, e.prototype = new d, f.prototype = new c, Object.defineProperties(f.prototype, {\r\n        radius: {\r\n            get: function () {\r\n                return this._radius\r\n            }, set: function (a) {\r\n                this._radius = a;\r\n                var b = 2 * this.radius, c = 2 * this.radius;\r\n                this.width = b, this.height = c\r\n            }\r\n        }, width: {\r\n            get: function () {\r\n                return this._width\r\n            }, set: function (a) {\r\n                this._radius = a / 2, this._width = a\r\n            }\r\n        }, height: {\r\n            get: function () {\r\n                return this._height\r\n            }, set: function (a) {\r\n                this._radius = a / 2, this._height = a\r\n            }\r\n        }\r\n    }), g.prototype = new c, h.prototype = new c, i.prototype = new c, a.Node = c, a.TextNode = d, a.LinkNode = e, a.CircleNode = f, a.AnimateNode = i\r\n}(JTopo), function (a) {\r\n    function b(a, b) {\r\n        var c = [];\r\n        if (null == a || null == b)return c;\r\n        if (a && b && a.outLinks && b.inLinks)for (var d = 0; d < a.outLinks.length; d++)for (var e = a.outLinks[d], f = 0; f < b.inLinks.length; f++) {\r\n            var g = b.inLinks[f];\r\n            e === g && c.push(g)\r\n        }\r\n        return c\r\n    }\r\n\r\n    function c(a, c) {\r\n        var d = b(a, c), e = b(c, a), f = d.concat(e);\r\n        return f\r\n    }\r\n\r\n    function d(a) {\r\n        var b = c(a.nodeA, a.nodeZ);\r\n        return b = b.filter(function (b) {\r\n            return a !== b\r\n        })\r\n    }\r\n\r\n    function e(a, b) {\r\n        return c(a, b).length\r\n    }\r\n\r\n    function f(b, c, g) {\r\n        function h(b, c) {\r\n            var d = a.util.lineF(b.cx, b.cy, c.cx, c.cy), e = b.getBound(), f = a.util.intersectionLineBound(d, e);\r\n            return f\r\n        }\r\n\r\n        this.initialize = function (b, c, d) {\r\n            if (f.prototype.initialize.apply(this, arguments), this.elementType = "link", this.zIndex = a.zIndex_Link, 0 != arguments.length) {\r\n                this.text = d, this.nodeA = b, this.nodeZ = c, this.nodeA && null == this.nodeA.outLinks && (this.nodeA.outLinks = []), this.nodeA && null == this.nodeA.inLinks && (this.nodeA.inLinks = []), this.nodeZ && null == this.nodeZ.inLinks && (this.nodeZ.inLinks = []), this.nodeZ && null == this.nodeZ.outLinks && (this.nodeZ.outLinks = []), null != this.nodeA && this.nodeA.outLinks.push(this), null != this.nodeZ && this.nodeZ.inLinks.push(this), this.caculateIndex(), this.font = "12px Consolas", this.fontColor = "255,255,255", this.lineWidth = 2, this.lineJoin = "miter", this.transformAble = !1, this.bundleOffset = 20, this.bundleGap = 12, this.textOffsetX = 0, this.textOffsetY = 0, this.arrowsRadius = null, this.arrowsOffset = 0, this.dashedPattern = null, this.path = [];\r\n                var e = "text,font,fontColor,lineWidth,lineJoin".split(",");\r\n                this.serializedProperties = this.serializedProperties.concat(e)\r\n            }\r\n        }, this.caculateIndex = function () {\r\n            var a = e(this.nodeA, this.nodeZ);\r\n            a > 0 && (this.nodeIndex = a - 1)\r\n        }, this.initialize(b, c, g), this.removeHandler = function () {\r\n            var a = this;\r\n            this.nodeA && this.nodeA.outLinks && (this.nodeA.outLinks = this.nodeA.outLinks.filter(function (b) {\r\n                return b !== a\r\n            })), this.nodeZ && this.nodeZ.inLinks && (this.nodeZ.inLinks = this.nodeZ.inLinks.filter(function (b) {\r\n                return b !== a\r\n            }));\r\n            var b = d(this);\r\n            b.forEach(function (a, b) {\r\n                a.nodeIndex = b\r\n            })\r\n        }, this.getStartPosition = function () {\r\n            var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n            return a\r\n        }, this.getEndPosition = function () {\r\n            var a;\r\n            return null != this.arrowsRadius && (a = h(this.nodeZ, this.nodeA)), null == a && (a = {x: this.nodeZ.cx, y: this.nodeZ.cy}), a\r\n        }, this.getPath = function () {\r\n            var a = [], b = this.getStartPosition(), c = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ)return [b, c];\r\n            var d = e(this.nodeA, this.nodeZ);\r\n            if (1 == d)return [b, c];\r\n            var f = Math.atan2(c.y - b.y, c.x - b.x), g = {x: b.x + this.bundleOffset * Math.cos(f), y: b.y + this.bundleOffset * Math.sin(f)}, h = {\r\n                x: c.x + this.bundleOffset * Math.cos(f - Math.PI),\r\n                y: c.y + this.bundleOffset * Math.sin(f - Math.PI)\r\n            }, i = f - Math.PI / 2, j = f - Math.PI / 2, k = d * this.bundleGap / 2 - this.bundleGap / 2, l = this.bundleGap * this.nodeIndex, m = {\r\n                x: g.x + l * Math.cos(i),\r\n                y: g.y + l * Math.sin(i)\r\n            }, n = {x: h.x + l * Math.cos(j), y: h.y + l * Math.sin(j)};\r\n            return m = {x: m.x + k * Math.cos(i - Math.PI), y: m.y + k * Math.sin(i - Math.PI)}, n = {x: n.x + k * Math.cos(j - Math.PI), y: n.y + k * Math.sin(j - Math.PI)}, a.push({\r\n                x: b.x,\r\n                y: b.y\r\n            }), a.push({x: m.x, y: m.y}), a.push({x: n.x, y: n.y}), a.push({x: c.x, y: c.y}), a\r\n        }, this.paintPath = function (a, b) {\r\n            if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n            a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n            for (var c = 1; c < b.length; c++)null == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);\r\n            if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n                var d = b[b.length - 2], e = b[b.length - 1];\r\n                this.paintArrow(a, d, e)\r\n            }\r\n        }, this.paintLoop = function (a) {\r\n            a.beginPath();\r\n            {\r\n                var b = this.bundleGap * (this.nodeIndex + 1) / 2;\r\n                Math.PI + Math.PI / 2\r\n            }\r\n            a.arc(this.nodeA.x, this.nodeA.y, b, Math.PI / 2, 2 * Math.PI), a.stroke(), a.closePath()\r\n        }, this.paintArrow = function (b, c, d) {\r\n            var e = this.arrowsOffset, f = this.arrowsRadius / 2, g = c, h = d, i = Math.atan2(h.y - g.y, h.x - g.x), j = a.util.getDistance(g, h) - this.arrowsRadius, k = g.x + (j + e) * Math.cos(i), l = g.y + (j + e) * Math.sin(i), m = h.x + e * Math.cos(i), n = h.y + e * Math.sin(i);\r\n            i -= Math.PI / 2;\r\n            var o = {x: k + f * Math.cos(i), y: l + f * Math.sin(i)}, p = {x: k + f * Math.cos(i - Math.PI), y: l + f * Math.sin(i - Math.PI)};\r\n            b.beginPath(), b.fillStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", b.moveTo(o.x, o.y), b.lineTo(m, n), b.lineTo(p.x, p.y), b.stroke(), b.closePath()\r\n        }, this.paint = function (a) {\r\n            if (null != this.nodeA && null != !this.nodeZ) {\r\n                var b = this.getPath(this.nodeIndex);\r\n                this.path = b, a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", a.lineWidth = this.lineWidth, this.paintPath(a, b), b && b.length > 0 && this.paintText(a, b)\r\n            }\r\n        };\r\n        var i = -(Math.PI / 2 + Math.PI / 4);\r\n        this.paintText = function (a, b) {\r\n            var c = b[0], d = b[b.length - 1];\r\n            if (4 == b.length && (c = b[1], d = b[2]), this.text && this.text.length > 0) {\r\n                var e = (d.x + c.x) / 2 + this.textOffsetX, f = (d.y + c.y) / 2 + this.textOffsetY;\r\n                a.save(), a.beginPath(), a.font = this.font;\r\n                var g = a.measureText(this.text).width, h = a.measureText("田").width;\r\n                if (a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", this.nodeA === this.nodeZ) {\r\n                    var j = this.bundleGap * (this.nodeIndex + 1) / 2, e = this.nodeA.x + j * Math.cos(i), f = this.nodeA.y + j * Math.sin(i);\r\n                    a.fillText(this.text, e, f)\r\n                } else a.fillText(this.text, e - g / 2, f - h / 2);\r\n                a.stroke(), a.closePath(), a.restore()\r\n            }\r\n        }, this.paintSelected = function (a) {\r\n            a.shadowBlur = 10, a.shadowColor = "rgba(0,0,0,1)", a.shadowOffsetX = 0, a.shadowOffsetY = 0\r\n        }, this.isInBound = function (b, c) {\r\n            if (this.nodeA === this.nodeZ) {\r\n                var d = this.bundleGap * (this.nodeIndex + 1) / 2, e = a.util.getDistance(this.nodeA, {x: b, y: c}) - d;\r\n                return Math.abs(e) <= 3\r\n            }\r\n            for (var f = !1, g = 1; g < this.path.length; g++) {\r\n                var h = this.path[g - 1], i = this.path[g];\r\n                if (1 == a.util.isPointInLine({x: b, y: c}, h, i)) {\r\n                    f = !0;\r\n                    break\r\n                }\r\n            }\r\n            return f\r\n        }\r\n    }\r\n\r\n    function g(a, b, c) {\r\n        this.initialize = function () {\r\n            g.prototype.initialize.apply(this, arguments), this.direction = "horizontal"\r\n        }, this.initialize(a, b, c), this.getStartPosition = function () {\r\n            var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n            return "horizontal" == this.direction ? this.nodeZ.cx > a.x ? a.x += this.nodeA.width / 2 : a.x -= this.nodeA.width / 2 : this.nodeZ.cy > a.y ? a.y += this.nodeA.height / 2 : a.y -= this.nodeA.height / 2, a\r\n        }, this.getEndPosition = function () {\r\n            var a = {x: this.nodeZ.cx, y: this.nodeZ.cy};\r\n            return "horizontal" == this.direction ? this.nodeA.cy < a.y ? a.y -= this.nodeZ.height / 2 : a.y += this.nodeZ.height / 2 : a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width, a\r\n        }, this.getPath = function (a) {\r\n            var b = [], c = this.getStartPosition(), d = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ)return [c, d];\r\n            var f, g, h = e(this.nodeA, this.nodeZ), i = (h - 1) * this.bundleGap, j = this.bundleGap * a - i / 2;\r\n            return "horizontal" == this.direction ? (f = d.x + j, g = c.y - j, b.push({x: c.x, y: g}), b.push({x: f, y: g}), b.push({x: f, y: d.y})) : (f = c.x + j, g = d.y - j, b.push({\r\n                x: f,\r\n                y: c.y\r\n            }), b.push({x: f, y: g}), b.push({x: d.x, y: g})), b\r\n        }, this.paintText = function (a, b) {\r\n            if (this.text && this.text.length > 0) {\r\n                var c = b[1], d = c.x + this.textOffsetX, e = c.y + this.textOffsetY;\r\n                a.save(), a.beginPath(), a.font = this.font;\r\n                var f = a.measureText(this.text).width, g = a.measureText("田").width;\r\n                a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.text, d - f / 2, e - g / 2), a.stroke(), a.closePath(), a.restore()\r\n            }\r\n        }\r\n    }\r\n\r\n    function h(a, b, c) {\r\n        this.initialize = function () {\r\n            h.prototype.initialize.apply(this, arguments), this.direction = "vertical", this.offsetGap = 44\r\n        }, this.initialize(a, b, c), this.getStartPosition = function () {\r\n            var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n            return "horizontal" == this.direction ? a.x = this.nodeZ.cx < a.x ? this.nodeA.x : this.nodeA.x + this.nodeA.width : a.y = this.nodeZ.cy < a.y ? this.nodeA.y : this.nodeA.y + this.nodeA.height, a\r\n        }, this.getEndPosition = function () {\r\n            var a = {x: this.nodeZ.cx, y: this.nodeZ.cy};\r\n            return "horizontal" == this.direction ? a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width : a.y = this.nodeA.cy < a.y ? this.nodeZ.y : this.nodeZ.y + this.nodeZ.height, a\r\n        }, this.getPath = function (a) {\r\n            var b = this.getStartPosition(), c = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ)return [b, c];\r\n            var d = [], f = e(this.nodeA, this.nodeZ), g = (f - 1) * this.bundleGap, h = this.bundleGap * a - g / 2, i = this.offsetGap;\r\n            return "horizontal" == this.direction ? (this.nodeA.cx > this.nodeZ.cx && (i = -i), d.push({x: b.x, y: b.y + h}), d.push({x: b.x + i, y: b.y + h}), d.push({\r\n                x: c.x - i,\r\n                y: c.y + h\r\n            }), d.push({x: c.x, y: c.y + h})) : (this.nodeA.cy > this.nodeZ.cy && (i = -i), d.push({x: b.x + h, y: b.y}), d.push({x: b.x + h, y: b.y + i}), d.push({\r\n                x: c.x + h,\r\n                y: c.y - i\r\n            }), d.push({x: c.x + h, y: c.y})), d\r\n        }\r\n    }\r\n\r\n    function i(a, b, c) {\r\n        this.initialize = function () {\r\n            i.prototype.initialize.apply(this, arguments)\r\n        }, this.initialize(a, b, c), this.paintPath = function (a, b) {\r\n            if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n            a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n            for (var c = 1; c < b.length; c++) {\r\n                var d = b[c - 1], e = b[c], f = (d.x + e.x) / 2, g = (d.y + e.y) / 2;\r\n                g += (e.y - d.y) / 2, a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", a.lineWidth = this.lineWidth, a.moveTo(d.x, d.cy), a.quadraticCurveTo(f, g, e.x, e.y), a.stroke()\r\n            }\r\n            if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n                var h = b[b.length - 2], i = b[b.length - 1];\r\n                this.paintArrow(a, h, i)\r\n            }\r\n        }\r\n    }\r\n\r\n    f.prototype = new a.InteractiveElement, g.prototype = new f, h.prototype = new f, i.prototype = new f, a.Link = f, a.FoldLink = g, a.FlexionalLink = h, a.CurveLink = i\r\n}(JTopo), function (a) {\r\n    function b(c) {\r\n        this.initialize = function (c) {\r\n            b.prototype.initialize.apply(this, null), this.elementType = "container", this.zIndex = a.zIndex_Container, this.width = 100, this.height = 100, this.childs = [], this.alpha = .5, this.dragable = !0, this.childDragble = !0, this.visible = !0, this.fillColor = "10,100,80", this.borderWidth = 0, this.borderColor = "255,255,255", this.borderRadius = null, this.font = "12px Consolas", this.fontColor = "255,255,255", this.text = c, this.textPosition = "Bottom_Center", this.textOffsetX = 0, this.textOffsetY = 0, this.layout = new a.layout.AutoBoundLayout\r\n        }, this.initialize(c), this.add = function (a) {\r\n            this.childs.push(a), a.dragable = this.childDragble\r\n        }, this.remove = function (a) {\r\n            for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a) {\r\n                a.parentContainer = null, this.childs = this.childs.del(b), a.lastParentContainer = this;\r\n                break\r\n            }\r\n        }, this.removeAll = function () {\r\n            this.childs = []\r\n        }, this.setLocation = function (a, b) {\r\n            var c = a - this.x, d = b - this.y;\r\n            this.x = a, this.y = b;\r\n            for (var e = 0; e < this.childs.length; e++) {\r\n                var f = this.childs[e];\r\n                f.setLocation(f.x + c, f.y + d)\r\n            }\r\n        }, this.doLayout = function (a) {\r\n            a && a(this, this.childs)\r\n        }, this.paint = function (a) {\r\n            this.visible && (this.layout && this.layout(this, this.childs), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", null == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x, this.y, this.width, this.height) : a.JTopoRoundRect(this.x, this.y, this.width, this.height, this.borderRadius), a.fill(), a.closePath(), this.paintText(a), this.paintBorder(a))\r\n        }, this.paintBorder = function (a) {\r\n            if (0 != this.borderWidth) {\r\n                a.beginPath(), a.lineWidth = this.borderWidth, a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                var b = this.borderWidth / 2;\r\n                null == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth) : a.JTopoRoundRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius), a.stroke(), a.closePath()\r\n            }\r\n        }, this.paintText = function (a) {\r\n            var b = this.text;\r\n            if (null != b && "" != b) {\r\n                a.beginPath(), a.font = this.font;\r\n                var c = a.measureText(b).width, d = a.measureText("田").width;\r\n                a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                var e = this.getTextPostion(this.textPosition, c, d);\r\n                a.fillText(b, e.x, e.y), a.closePath()\r\n            }\r\n        }, this.getTextPostion = function (a, b, c) {\r\n            var d = null;\r\n            return null == a || "Bottom_Center" == a ? d = {x: this.x + this.width / 2 - b / 2, y: this.y + this.height + c} : "Top_Center" == a ? d = {\r\n                x: this.x + this.width / 2 - b / 2,\r\n                y: this.y - c / 2\r\n            } : "Top_Right" == a ? d = {x: this.x + this.width - b, y: this.y - c / 2} : "Top_Left" == a ? d = {x: this.x, y: this.y - c / 2} : "Bottom_Right" == a ? d = {\r\n                x: this.x + this.width - b,\r\n                y: this.y + this.height + c\r\n            } : "Bottom_Left" == a ? d = {x: this.x, y: this.y + this.height + c} : "Middle_Center" == a ? d = {\r\n                x: this.x + this.width / 2 - b / 2,\r\n                y: this.y + this.height / 2 + c / 2\r\n            } : "Middle_Right" == a ? d = {x: this.x + this.width - b, y: this.y + this.height / 2 + c / 2} : "Middle_Left" == a && (d = {\r\n                x: this.x,\r\n                y: this.y + this.height / 2 + c / 2\r\n            }), null != this.textOffsetX && (d.x += this.textOffsetX), null != this.textOffsetY && (d.y += this.textOffsetY), d\r\n        }, this.paintMouseover = function () {\r\n        }, this.paintSelected = function (a) {\r\n            a.shadowBlur = 10, a.shadowColor = "rgba(0,0,0,1)", a.shadowOffsetX = 0, a.shadowOffsetY = 0\r\n        }\r\n    }\r\n\r\n    b.prototype = new a.InteractiveElement, a.Container = b\r\n}(JTopo), function (a) {\r\n    function b(a) {\r\n        var b = 0, c = 0;\r\n        a.forEach(function (a) {\r\n            b += a.cx, c += a.cy\r\n        });\r\n        var d = {x: b / a.length, y: c / a.length};\r\n        return d\r\n    }\r\n\r\n    function c(c, d) {\r\n        null == d && (d = {});\r\n        {\r\n            var e = d.cx, f = d.cy, g = d.minRadius, h = d.nodeDiameter, i = d.hScale || 1, j = d.vScale || 1;\r\n            d.beginAngle || 0, d.endAngle || 2 * Math.PI\r\n        }\r\n        if (null == e || null == f) {\r\n            var k = b(c);\r\n            e = k.x, f = k.y\r\n        }\r\n        var l = 0, m = [], n = [];\r\n        c.forEach(function (a) {\r\n            null == d.nodeDiameter ? (a.diameter && (h = a.diameter), h = a.radius ? 2 * a.radius : Math.sqrt(2 * a.width * a.height), n.push(h)) : n.push(h), l += h\r\n        }), c.forEach(function (a, b) {\r\n            var c = n[b] / l;\r\n            m.push(Math.PI * c)\r\n        });\r\n        var o = (c.length, m[0] + m[1]), p = n[0] / 2 + n[1] / 2, q = p / 2 / Math.sin(o / 2);\r\n        null != g && g > q && (q = g);\r\n        var r = q * i, s = q * j, t = d.animate;\r\n        if (t) {\r\n            var u = t.time || 1e3, v = 0;\r\n            c.forEach(function (b, c) {\r\n                v += 0 == c ? m[c] : m[c - 1] + m[c];\r\n                var d = e + Math.cos(v) * r, g = f + Math.sin(v) * s;\r\n                a.Animate.stepByStep(b, {x: d - b.width / 2, y: g - b.height / 2}, u).start()\r\n            })\r\n        } else {\r\n            var v = 0;\r\n            c.forEach(function (a, b) {\r\n                v += 0 == b ? m[b] : m[b - 1] + m[b];\r\n                var c = e + Math.cos(v) * r, d = f + Math.sin(v) * s;\r\n                a.cx = c, a.cy = d\r\n            })\r\n        }\r\n        return {cx: e, cy: f, radius: r, radiusA: r, radiusB: s}\r\n    }\r\n\r\n    function d(a, b) {\r\n        return function (c) {\r\n            var d = c.childs;\r\n            if (!(d.length <= 0))for (var e = c.getBound(), f = d[0], g = (e.width - f.width) / b, h = (e.height - f.height) / a, i = (d.length, 0), j = 0; a > j; j++)for (var k = 0; b > k; k++) {\r\n                var l = d[i++], m = e.left + g / 2 + k * g, n = e.top + h / 2 + j * h;\r\n                if (l.setLocation(m, n), i >= d.length)return\r\n            }\r\n        }\r\n    }\r\n\r\n    function e(a, b) {\r\n        return null == a && (a = 0), null == b && (b = 0), function (c) {\r\n            var d = c.childs;\r\n            if (!(d.length <= 0))for (var e = c.getBound(), f = e.left, g = e.top, h = 0; h < d.length; h++) {\r\n                var i = d[h];\r\n                f + i.width >= e.right && (f = e.left, g += b + i.height), i.setLocation(f, g), f += a + i.width\r\n            }\r\n        }\r\n    }\r\n\r\n    function f() {\r\n        return function (a, b) {\r\n            if (b.length > 0) {\r\n                for (var c = 1e7, d = -1e7, e = 1e7, f = -1e7, g = d - c, h = f - e, i = 0; i < b.length; i++) {\r\n                    var j = b[i];\r\n                    j.x <= c && (c = j.x), j.x >= d && (d = j.x), j.y <= e && (e = j.y), j.y >= f && (f = j.y), g = d - c + j.width, h = f - e + j.height\r\n                }\r\n                a.x = c, a.y = e, a.width = g, a.height = h\r\n            }\r\n        }\r\n    }\r\n\r\n    function g(b) {\r\n        var c = [], d = b.filter(function (b) {\r\n            return b instanceof a.Link ? !0 : (c.push(b), !1)\r\n        });\r\n        return b = c.filter(function (a) {\r\n            for (var b = 0; b < d.length; b++)if (d[b].nodeZ === a)return !1;\r\n            return !0\r\n        }), b = b.filter(function (a) {\r\n            for (var b = 0; b < d.length; b++)if (d[b].nodeA === a)return !0;\r\n            return !1\r\n        })\r\n    }\r\n\r\n    function h(a) {\r\n        var b = 0, c = 0;\r\n        return a.forEach(function (a) {\r\n            b += a.width, c += a.height\r\n        }), {width: b / a.length, height: c / a.length}\r\n    }\r\n\r\n    function i(a, b, c, d) {\r\n        b.x += c, b.y += d;\r\n        for (var e = q(a, b), f = 0; f < e.length; f++)i(a, e[f], c, d)\r\n    }\r\n\r\n    function j(a, b) {\r\n        function c(b, e) {\r\n            var f = q(a, b);\r\n            null == d[e] && (d[e] = {}, d[e].nodes = [], d[e].childs = []), d[e].nodes.push(b), d[e].childs.push(f);\r\n            for (var g = 0; g < f.length; g++)c(f[g], e + 1), f[g].parent = b\r\n        }\r\n\r\n        var d = [];\r\n        return c(b, 0), d\r\n    }\r\n\r\n    function k(b, c, d) {\r\n        return function (e) {\r\n            function f(f, g) {\r\n                for (var h = a.layout.getTreeDeep(f, g), k = j(f, g), l = k["" + h].nodes, m = 0; m < l.length; m++) {\r\n                    var n = l[m], o = (m + 1) * (c + 10), p = h * d;\r\n                    "down" == b || ("up" == b ? p = -p : "left" == b ? (o = -h * d, p = (m + 1) * (c + 10)) : "right" == b && (o = h * d, p = (m + 1) * (c + 10))), n.setLocation(o, p)\r\n                }\r\n                for (var q = h - 1; q >= 0; q--)for (var r = k["" + q].nodes, s = k["" + q].childs, m = 0; m < r.length; m++) {\r\n                    var t = r[m], u = s[m];\r\n                    if ("down" == b ? t.y = q * d : "up" == b ? t.y = -q * d : "left" == b ? t.x = -q * d : "right" == b && (t.x = q * d), u.length > 0 ? "down" == b || "up" == b ? t.x = (u[0].x + u[u.length - 1].x) / 2 : ("left" == b || "right" == b) && (t.y = (u[0].y + u[u.length - 1].y) / 2) : m > 0 && ("down" == b || "up" == b ? t.x = r[m - 1].x + r[m - 1].width + c : ("left" == b || "right" == b) && (t.y = r[m - 1].y + r[m - 1].height + c)), m > 0)if ("down" == b || "up" == b) {\r\n                        if (t.x < r[m - 1].x + r[m - 1].width)for (var v = r[m - 1].x + r[m - 1].width + c, w = Math.abs(v - t.x), x = m; x < r.length; x++)i(e.childs, r[x], w, 0)\r\n                    } else if (("left" == b || "right" == b) && t.y < r[m - 1].y + r[m - 1].height)for (var y = r[m - 1].y + r[m - 1].height + c, z = Math.abs(y - t.y), x = m; x < r.length; x++)i(e.childs, r[x], 0, z)\r\n                }\r\n            }\r\n\r\n            var g = null;\r\n            null == c && (g = h(e.childs), c = g.width, ("left" == b || "right" == b) && (c = g.width + 10)), null == d && (null == g && (g = h(e.childs)), d = 2 * g.height), null == b && (b = "down");\r\n            var k = a.layout.getRootNodes(e.childs);\r\n            if (k.length > 0) {\r\n                f(e.childs, k[0]);\r\n                var l = a.util.getElementsBound(e.childs), m = e.getCenterLocation(), n = m.x - (l.left + l.right) / 2, o = m.y - (l.top + l.bottom) / 2;\r\n                e.childs.forEach(function (b) {\r\n                    b instanceof a.Node && (b.x += n, b.y += o)\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    function l(b) {\r\n        return function (c) {\r\n            function d(a, c, e) {\r\n                var f = q(a, c);\r\n                if (0 != f.length) {\r\n                    null == e && (e = b);\r\n                    var g = 2 * Math.PI / f.length;\r\n                    f.forEach(function (b, f) {\r\n                        var h = c.x + e * Math.cos(g * f), i = c.y + e * Math.sin(g * f);\r\n                        b.setLocation(h, i);\r\n                        var j = e / 2;\r\n                        d(a, b, j)\r\n                    })\r\n                }\r\n            }\r\n\r\n            var e = a.layout.getRootNodes(c.childs);\r\n            if (e.length > 0) {\r\n                d(c.childs, e[0]);\r\n                var f = a.util.getElementsBound(c.childs), g = c.getCenterLocation(), h = g.x - (f.left + f.right) / 2, i = g.y - (f.top + f.bottom) / 2;\r\n                c.childs.forEach(function (b) {\r\n                    b instanceof a.Node && (b.x += h, b.y += i)\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    function m(a, b, c, d, e, f) {\r\n        for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n        return g\r\n    }\r\n\r\n    function n(a, b, c, d, e, f) {\r\n        var g = e ? e : 0, h = f ? f : 2 * Math.PI, i = h - g, j = i / c, k = [];\r\n        g += j / 2;\r\n        for (var l = g; h >= l; l += j) {\r\n            var m = a + Math.cos(l) * d, n = b + Math.sin(l) * d;\r\n            k.push({x: m, y: n})\r\n        }\r\n        return k\r\n    }\r\n\r\n    function o(a, b, c, d, e, f) {\r\n        var g = f || "bottom", h = [];\r\n        if ("bottom" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b + e\r\n        }); else if ("top" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b - e\r\n        }); else if ("right" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: a + e,\r\n            y: i + j * d\r\n        }); else if ("left" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({x: a - e, y: i + j * d});\r\n        return h\r\n    }\r\n\r\n    function m(a, b, c, d, e, f) {\r\n        for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n        return g\r\n    }\r\n\r\n    function p(a, b) {\r\n        if (a.layout) {\r\n            var c = a.layout, d = c.type, e = null;\r\n            if ("circle" == d) {\r\n                var f = c.radius || Math.max(a.width, a.height);\r\n                e = n(a.cx, a.cy, b.length, f, a.layout.beginAngle, a.layout.endAngle)\r\n            } else if ("tree" == d) {\r\n                var g = c.width || 50, h = c.height || 50, i = c.direction;\r\n                e = o(a.cx, a.cy, b.length, g, h, i)\r\n            } else {\r\n                if ("grid" != d)return;\r\n                e = m(a.x, a.y, c.rows, c.cols, c.horizontal || 0, c.vertical || 0)\r\n            }\r\n            for (var j = 0; j < b.length; j++)b[j].setCenterLocation(e[j].x, e[j].y)\r\n        }\r\n    }\r\n\r\n    function q(b, c) {\r\n        for (var d = [], e = 0; e < b.length; e++)b[e] instanceof a.Link && b[e].nodeA === c && d.push(b[e].nodeZ);\r\n        return d\r\n    }\r\n\r\n    function r(a, b, c) {\r\n        var d = q(a.childs, b);\r\n        if (0 == d.length)return null;\r\n        if (p(b, d), 1 == c)for (var e = 0; e < d.length; e++)r(a, d[e], c);\r\n        return null\r\n    }\r\n\r\n    function s(b, c) {\r\n        function d(a, b) {\r\n            var c = a.x - b.x, d = a.y - b.y;\r\n            i += c * f, j += d * f, i *= g, j *= g, j += h, b.x += i, b.y += j\r\n        }\r\n\r\n        function e() {\r\n            if (!(++k > 150)) {\r\n                for (var a = 0; a < l.length; a++)l[a] != b && d(b, l[a], l);\r\n                setTimeout(e, 1e3 / 24)\r\n            }\r\n        }\r\n\r\n        var f = .01, g = .95, h = -5, i = 0, j = 0, k = 0, l = c.getElementsByClass(a.Node);\r\n        e()\r\n    }\r\n\r\n    function t(a, b) {\r\n        function c(a, b, e) {\r\n            var f = q(a, b);\r\n            e > d && (d = e);\r\n            for (var g = 0; g < f.length; g++)c(a, f[g], e + 1)\r\n        }\r\n\r\n        var d = 0;\r\n        return c(a, b, 0), d\r\n    }\r\n\r\n    a.layout = a.Layout = {\r\n        layoutNode: r,\r\n        getNodeChilds: q,\r\n        adjustPosition: p,\r\n        springLayout: s,\r\n        getTreeDeep: t,\r\n        getRootNodes: g,\r\n        GridLayout: d,\r\n        FlowLayout: e,\r\n        AutoBoundLayout: f,\r\n        CircleLayout: l,\r\n        TreeLayout: k,\r\n        getNodesCenter: b,\r\n        circleLayoutNodes: c\r\n    }\r\n}(JTopo), function (a) {\r\n    function b() {\r\n        var b = new a.CircleNode;\r\n        return b.radius = 150, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n            var c = 2 * b.radius, d = 2 * b.radius;\r\n            b.width = c, b.height = d;\r\n            for (var e = 0, f = 0; f < this.datas.length; f++) {\r\n                var g = this.datas[f] * Math.PI * 2;\r\n                a.save(), a.beginPath(), a.fillStyle = b.colors[f], a.moveTo(0, 0), a.arc(0, 0, this.radius, e, e + g, !1), a.fill(), a.closePath(), a.restore(), a.beginPath(), a.font = this.font;\r\n                var h = this.titles[f] + ": " + (100 * this.datas[f]).toFixed(2) + "%", i = a.measureText(h).width, j = (a.measureText("田").width, (e + e + g) / 2), k = this.radius * Math.cos(j), l = this.radius * Math.sin(j);\r\n                j > Math.PI / 2 && j <= Math.PI ? k -= i : j > Math.PI && j < 2 * Math.PI * 3 / 4 ? k -= i : j > 2 * Math.PI * .75, a.fillStyle = "#FFFFFF", a.fillText(h, k, l), a.moveTo(this.radius * Math.cos(j), this.radius * Math.sin(j)), j > Math.PI / 2 && j < 2 * Math.PI * 3 / 4 && (k -= i), j > Math.PI, a.fill(), a.stroke(), a.closePath(), e += g\r\n            }\r\n        }, b\r\n    }\r\n\r\n    function c() {\r\n        var b = new a.Node;\r\n        return b.showSelected = !1, b.width = 250, b.height = 180, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n            var c = 3, d = (this.width - c) / this.datas.length;\r\n            a.save(), a.beginPath(), a.fillStyle = "#FFFFFF", a.strokeStyle = "#FFFFFF", a.moveTo(-this.width / 2 - 1, -this.height / 2), a.lineTo(-this.width / 2 - 1, this.height / 2 + 3), a.lineTo(this.width / 2 + c + 1, this.height / 2 + 3), a.stroke(), a.closePath(), a.restore();\r\n            for (var e = 0; e < this.datas.length; e++) {\r\n                a.save(), a.beginPath(), a.fillStyle = b.colors[e];\r\n                var f = this.datas[e], g = e * (d + c) - this.width / 2, h = this.height - f - this.height / 2;\r\n                a.fillRect(g, h, d, f);\r\n                var i = "" + parseInt(this.datas[e]), j = a.measureText(i).width, k = a.measureText("田").width;\r\n                a.fillStyle = "#FFFFFF", a.fillText(i, g + (d - j) / 2, h - k), a.fillText(this.titles[e], g + (d - j) / 2, this.height / 2 + k), a.fill(), a.closePath(), a.restore()\r\n            }\r\n        }, b\r\n    }\r\n\r\n    a.BarChartNode = c, a.PieChartNode = b\r\n}(JTopo), function (a) {\r\n    function b(b, c) {\r\n        var d, e = null;\r\n        return {\r\n            stop: function () {\r\n                return d ? (window.clearInterval(d), e && e.publish("stop"), this) : this\r\n            }, start: function () {\r\n                var a = this;\r\n                return d = setInterval(function () {\r\n                    b.call(a)\r\n                }, c), this\r\n            }, onStop: function (b) {\r\n                return null == e && (e = new a.util.MessageBus), e.subscribe("stop", b), this\r\n            }\r\n        }\r\n    }\r\n\r\n    function c(a, c) {\r\n        c = c || {};\r\n        var d = c.gravity || .1, e = c.dx || 0, f = c.dy || 5, g = c.stop, h = c.interval || 30, i = new b(function () {\r\n            g && g() ? (f = .5, this.stop()) : (f += d, a.setLocation(a.x + e, a.y + f))\r\n        }, h);\r\n        return i\r\n    }\r\n\r\n    function d(a, c, d, e, f) {\r\n        var g = 1e3 / 24, h = {};\r\n        for (var i in c) {\r\n            var j = c[i], k = j - a[i];\r\n            h[i] = {\r\n                oldValue: a[i], targetValue: j, step: k / d * g, isDone: function (b) {\r\n                    var c = this.step > 0 && a[b] >= this.targetValue || this.step < 0 && a[b] <= this.targetValue;\r\n                    return c\r\n                }\r\n            }\r\n        }\r\n        var l = new b(function () {\r\n            var b = !0;\r\n            for (var d in c)h[d].isDone(d) || (a[d] += h[d].step, b = !1);\r\n            if (b) {\r\n                if (!e)return this.stop();\r\n                for (var d in c)if (f) {\r\n                    var g = h[d].targetValue;\r\n                    h[d].targetValue = h[d].oldValue, h[d].oldValue = g, h[d].step = -h[d].step\r\n                } else a[d] = h[d].oldValue\r\n            }\r\n            return this\r\n        }, g);\r\n        return l\r\n    }\r\n\r\n    function e(a) {\r\n        null == a && (a = {});\r\n        var b = a.spring || .1, c = a.friction || .8, d = a.grivity || 0, e = (a.wind || 0, a.minLength || 0);\r\n        return {\r\n            items: [], timer: null, isPause: !1, addNode: function (a, b) {\r\n                var c = {node: a, target: b, vx: 0, vy: 0};\r\n                return this.items.push(c), this\r\n            }, play: function (a) {\r\n                this.stop(), a = null == a ? 1e3 / 24 : a;\r\n                var b = this;\r\n                this.timer = setInterval(function () {\r\n                    b.nextFrame()\r\n                }, a)\r\n            }, stop: function () {\r\n                null != this.timer && window.clearInterval(this.timer)\r\n            }, nextFrame: function () {\r\n                for (var a = 0; a < this.items.length; a++) {\r\n                    var f = this.items[a], g = f.node, h = f.target, i = f.vx, j = f.vy, k = h.x - g.x, l = h.y - g.y, m = Math.atan2(l, k);\r\n                    if (0 != e) {\r\n                        var n = h.x - Math.cos(m) * e, o = h.y - Math.sin(m) * e;\r\n                        i += (n - g.x) * b, j += (o - g.y) * b\r\n                    } else i += k * b, j += l * b;\r\n                    i *= c, j *= c, j += d, g.x += i, g.y += j, f.vx = i, f.vy = j\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function f(a, b) {\r\n        function c() {\r\n            return e = setInterval(function () {\r\n                return o ? void f.stop() : (a.rotate += g || .2, void(a.rotate > 2 * Math.PI && (a.rotate = 0)))\r\n            }, 100), f\r\n        }\r\n\r\n        function d() {\r\n            return window.clearInterval(e), f.onStop && f.onStop(a), f\r\n        }\r\n\r\n        var e = (b.context, null), f = {}, g = b.v;\r\n        return f.run = c, f.stop = d, f.onStop = function (a) {\r\n            return f.onStop = a, f\r\n        }, f\r\n    }\r\n\r\n    function g(a, b) {\r\n        function c() {\r\n            return window.clearInterval(g), h.onStop && h.onStop(a), h\r\n        }\r\n\r\n        function d() {\r\n            var d = b.dx || 0, i = b.dy || 2;\r\n            return g = setInterval(function () {\r\n                return o ? void h.stop() : (i += f, void(a.y + a.height < e.stage.canvas.height ? a.setLocation(a.x + d, a.y + i) : (i = 0, c())))\r\n            }, 20), h\r\n        }\r\n\r\n        var e = b.context, f = b.gravity || .1, g = null, h = {};\r\n        return h.run = d, h.stop = c, h.onStop = function (a) {\r\n            return h.onStop = a, h\r\n        }, h\r\n    }\r\n\r\n    function h(b, c) {\r\n        function d(c, d, e, f, g) {\r\n            var h = new a.Node;\r\n            return h.setImage(b.image), h.setSize(b.width, b.height), h.setLocation(c, d), h.showSelected = !1, h.dragable = !1, h.paint = function (a) {\r\n                a.save(), a.arc(0, 0, e, f, g), a.clip(), a.beginPath(), null != this.image ? a.drawImage(this.image, -this.width / 2, -this.height / 2) : (a.fillStyle = "rgba(" + this.style.fillStyle + "," + this.alpha + ")", a.rect(-this.width / 2, -this.height / 2, this.width / 2, this.height / 2), a.fill()), a.closePath(), a.restore()\r\n            }, h\r\n        }\r\n\r\n        function e(c, e) {\r\n            var f = c, g = c + Math.PI, h = d(b.x, b.y, b.width, f, g), j = d(b.x - 2 + 4 * Math.random(), b.y, b.width, f + Math.PI, f);\r\n            b.visible = !1, e.add(h), e.add(j), a.Animate.gravity(h, {context: e, dx: .3}).run().onStop(function () {\r\n                e.remove(h), e.remove(j), i.stop()\r\n            }), a.Animate.gravity(j, {context: e, dx: -.2}).run()\r\n        }\r\n\r\n        function f() {\r\n            return e(c.angle, h), i\r\n        }\r\n\r\n        function g() {\r\n            return i.onStop && i.onStop(b), i\r\n        }\r\n\r\n        var h = c.context, i = (b.style, {});\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = f, i.stop = g, i\r\n    }\r\n\r\n    function i(a, b) {\r\n        function c(a) {\r\n            a.visible = !0, a.rotate = Math.random();\r\n            var b = g.stage.canvas.width / 2;\r\n            a.x = b + Math.random() * (b - 100) - Math.random() * (b - 100), a.y = g.stage.canvas.height, a.vx = 5 * Math.random() - 5 * Math.random(), a.vy = -25\r\n        }\r\n\r\n        function d() {\r\n            return c(a), h = setInterval(function () {\r\n                return o ? void i.stop() : (a.vy += f, a.x += a.vx, a.y += a.vy, void((a.x < 0 || a.x > g.stage.canvas.width || a.y > g.stage.canvas.height) && (i.onStop && i.onStop(a), c(a))))\r\n            }, 50), i\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(h)\r\n        }\r\n\r\n        var f = .8, g = b.context, h = null, i = {};\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = d, i.stop = e, i\r\n    }\r\n\r\n    function j() {\r\n        o = !0\r\n    }\r\n\r\n    function k() {\r\n        o = !1\r\n    }\r\n\r\n    function l(b, c) {\r\n        function d() {\r\n            return n = setInterval(function () {\r\n                if (o)return void m.stop();\r\n                var a = f.y + h + Math.sin(k) * j;\r\n                b.setLocation(b.x, a), k += l\r\n            }, 100), m\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(n)\r\n        }\r\n\r\n        var f = c.p1, g = c.p2, h = (c.context, f.x + (g.x - f.x) / 2), i = f.y + (g.y - f.y) / 2, j = a.util.getDistance(f, g) / 2, k = Math.atan2(i, h), l = c.speed || .2, m = {}, n = null;\r\n        return m.run = d, m.stop = e, m\r\n    }\r\n\r\n    function m(a, b) {\r\n        function c() {\r\n            return h = setInterval(function () {\r\n                if (o)return void g.stop();\r\n                var b = e.x - a.x, c = e.y - a.y, h = b * f, i = c * f;\r\n                a.x += h, a.y += i, .01 > h && .1 > i && d()\r\n            }, 100), g\r\n        }\r\n\r\n        function d() {\r\n            window.clearInterval(h)\r\n        }\r\n\r\n        var e = b.position, f = (b.context, b.easing || .2), g = {}, h = null;\r\n        return g.onStop = function (a) {\r\n            return g.onStop = a, g\r\n        }, g.run = c, g.stop = d, g\r\n    }\r\n\r\n    function n(a, b) {\r\n        function c() {\r\n            return j = setInterval(function () {\r\n                a.scaleX += f, a.scaleY += f, a.scaleX >= e && d()\r\n            }, 100), i\r\n        }\r\n\r\n        function d() {\r\n            i.onStop && i.onStop(a), a.scaleX = g, a.scaleY = h, window.clearInterval(j)\r\n        }\r\n\r\n        var e = (b.position, b.context, b.scale || 1), f = .06, g = a.scaleX, h = a.scaleY, i = {}, j = null;\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = c, i.stop = d, i\r\n    }\r\n\r\n    a.Animate = {}, a.Effect = {};\r\n    var o = !1;\r\n    a.Effect.spring = e, a.Effect.gravity = c, a.Animate.stepByStep = d, a.Animate.rotate = f, a.Animate.scale = n, a.Animate.move = m, a.Animate.cycle = l, a.Animate.repeatThrow = i, a.Animate.dividedTwoPiece = h, a.Animate.gravity = g, a.Animate.startAll = k, a.Animate.stopAll = j\r\n}(JTopo), function (a) {\r\n    function b(a, b) {\r\n        var c = [];\r\n        if (0 == a.length)return c;\r\n        var d = b.match(/^\\s*(\\w+)\\s*$/);\r\n        if (null != d) {\r\n            var e = a.filter(function (a) {\r\n                return a.elementType == d[1]\r\n            });\r\n            null != e && e.length > 0 && (c = c.concat(e))\r\n        } else {\r\n            var f = !1;\r\n            if (d = b.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*[\'"](\\S+)[\'"]\\s*\\]\\s*/), (null == d || d.length < 5) && (d = b.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*(\\d+(\\.\\d+)?)\\s*\\]\\s*/), f = !0), null != d && d.length >= 5) {\r\n                var g = d[1], h = d[2], i = d[3], j = d[4];\r\n                e = a.filter(function (a) {\r\n                    if (a.elementType != g)return !1;\r\n                    var b = a[h];\r\n                    return 1 == f && (b = parseInt(b)), "=" == i ? b == j : ">" == i ? b > j : "<" == i ? j > b : "<=" == i ? j >= b : ">=" == i ? b >= j : "!=" == i ? b != j : !1\r\n                }), null != e && e.length > 0 && (c = c.concat(e))\r\n            }\r\n        }\r\n        return c\r\n    }\r\n\r\n    function c(a) {\r\n        if (a.find = function (a) {\r\n                return d.call(this, a)\r\n            }, e.forEach(function (b) {\r\n                a[b] = function (a) {\r\n                    for (var c = 0; c < this.length; c++)this[c][b](a);\r\n                    return this\r\n                }\r\n            }), a.length > 0) {\r\n            var b = a[0];\r\n            for (var c in b) {\r\n                var f = b[c];\r\n                "function" == typeof f && !function (b) {\r\n                    a[c] = function () {\r\n                        for (var c = [], d = 0; d < a.length; d++)c.push(b.apply(a[d], arguments));\r\n                        return c\r\n                    }\r\n                }(f)\r\n            }\r\n        }\r\n        return a.attr = function (a, b) {\r\n            if (null != a && null != b)for (var c = 0; c < this.length; c++)this[c][a] = b; else {\r\n                if (null != a && "string" == typeof a) {\r\n                    for (var d = [], c = 0; c < this.length; c++)d.push(this[c][a]);\r\n                    return d\r\n                }\r\n                if (null != a)for (var c = 0; c < this.length; c++)for (var e in a)this[c][e] = a[e]\r\n            }\r\n            return this\r\n        }, a\r\n    }\r\n\r\n    function d(d) {\r\n        var e = [], f = [];\r\n        this instanceof a.Stage ? (e = this.childs, f = f.concat(e)) : this instanceof a.Scene ? e = [this] : f = this, e.forEach(function (a) {\r\n            f = f.concat(a.childs)\r\n        });\r\n        var g = null;\r\n        return g = "function" == typeof d ? f.filter(d) : b(f, d), g = c(g)\r\n    }\r\n\r\n    var e = "click,mousedown,mouseup,mouseover,mouseout,mousedrag,keydown,keyup".split(",");\r\n    a.Stage.prototype.find = d, a.Scene.prototype.find = d\r\n}(JTopo), function (a) {\r\n    function b(a, b) {\r\n        this.x = a, this.y = b\r\n    }\r\n\r\n    function c(a) {\r\n        this.p = new b(0, 0), this.w = new b(1, 0), this.paint = a\r\n    }\r\n\r\n    function d(a, b, c) {\r\n        return function (d) {\r\n            for (var e = 0; b > e; e++)a(), c && d.turn(c), d.move(3)\r\n        }\r\n    }\r\n\r\n    function e(a, b) {\r\n        var c = 2 * Math.PI;\r\n        return function (d) {\r\n            for (var e = 0; b > e; e++)a(), d.turn(c / b)\r\n        }\r\n    }\r\n\r\n    function f(a, b, c) {\r\n        return function (d) {\r\n            for (var e = 0; b > e; e++)a(), d.resize(c)\r\n        }\r\n    }\r\n\r\n    function g(a) {\r\n        var b = 2 * Math.PI;\r\n        return function (c) {\r\n            for (var d = 0; a > d; d++)c.forward(1), c.turn(b / a)\r\n        }\r\n    }\r\n\r\n    function h(a) {\r\n        var b = 4 * Math.PI;\r\n        return function (c) {\r\n            for (var d = 0; a > d; d++)c.forward(1), c.turn(b / a)\r\n        }\r\n    }\r\n\r\n    function i(a, b, c, d) {\r\n        return function (e) {\r\n            for (var f = 0; b > f; f++)a(), e.forward(1), e.turn(c), e.resize(d)\r\n        }\r\n    }\r\n\r\n    var j = {};\r\n    c.prototype.forward = function (a) {\r\n        var b = this.p, c = this.w;\r\n        return b.x = b.x + a * c.x, b.y = b.y + a * c.y, this.paint && this.paint(b.x, b.y), this\r\n    }, c.prototype.move = function (a) {\r\n        var b = this.p, c = this.w;\r\n        return b.x = b.x + a * c.x, b.y = b.y + a * c.y, this\r\n    }, c.prototype.moveTo = function (a, b) {\r\n        return this.p.x = a, this.p.y = b, this\r\n    }, c.prototype.turn = function (a) {\r\n        var b = (this.p, this.w), c = Math.cos(a) * b.x - Math.sin(a) * b.y, d = Math.sin(a) * b.x + Math.cos(a) * b.y;\r\n        return b.x = c, b.y = d, this\r\n    }, c.prototype.resize = function (a) {\r\n        var b = this.w;\r\n        return b.x = b.x * a, b.y = b.y * a, this\r\n    }, c.prototype.save = function () {\r\n        return null == this._stack && (this._stack = []), this._stack.push([this.p, this.w]), this\r\n    }, c.prototype.restore = function () {\r\n        if (null != this._stack && this._stack.length > 0) {\r\n            var a = this._stack.pop();\r\n            this.p = a[0], this.w = a[1]\r\n        }\r\n        return this\r\n    }, j.Tortoise = c, j.shift = d, j.spin = e, j.polygon = g, j.spiral = i, j.star = h, j.scale = f, a.Logo = j\r\n}(window);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2p0b3BvL2p0b3BvLW1pbi5qcz8zOTdkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFNBQVM7QUFDVCxTQUFTO0FBQ1QsbURBQW1EO0FBQ25EO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1QsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLGFBQWEsVUFBVTtBQUN2QjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLE9BQU87QUFDOUI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsK0RBQStEO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EseUNBQXlDLGNBQWM7QUFDdkQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNCQUFzQixpR0FBaUcsUUFBUSxjQUFjO0FBQzdJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCOztBQUVBO0FBQ0EsK0JB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SztBQUNMLENBQUMiLCJmaWxlIjoiMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiFmdW5jdGlvbiAod2luZG93KSB7XHJcbiAgICBmdW5jdGlvbiBFbGVtZW50KCkge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50VHlwZSA9IFwiZWxlbWVudFwiLCB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gW1wiZWxlbWVudFR5cGVcIl0sIHRoaXMucHJvcGVydGllc1N0YWNrID0gW10sIHRoaXMuX2lkID0gXCJcIiArIChuZXcgRGF0ZSkuZ2V0VGltZSgpXHJcbiAgICAgICAgfSwgdGhpcy5kaXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCB0aGlzLmF0dHIgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSBhICYmIG51bGwgIT0gYil0aGlzW2FdID0gYjsgZWxzZSBpZiAobnVsbCAhPSBhKXJldHVybiB0aGlzW2FdO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSB0aGlzLCBiID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgYltjXSA9IGFbY11cclxuICAgICAgICAgICAgfSksIHRoaXMucHJvcGVydGllc1N0YWNrLnB1c2goYilcclxuICAgICAgICB9LCB0aGlzLnJlc3RvcmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMucHJvcGVydGllc1N0YWNrICYmIDAgIT0gdGhpcy5wcm9wZXJ0aWVzU3RhY2subGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHRoaXMsIGIgPSB0aGlzLnByb3BlcnRpZXNTdGFjay5wb3AoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGFbY10gPSBiW2NdXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy50b0pzb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gdGhpcywgYiA9IFwie1wiLCBjID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gYVtkXTtcclxuICAgICAgICAgICAgICAgIFwic3RyaW5nXCIgPT0gdHlwZW9mIGYgJiYgKGYgPSAnXCInICsgZiArICdcIicpLCBiICs9ICdcIicgKyBkICsgJ1wiOicgKyBmLCBjID4gZSArIDEgJiYgKGIgKz0gXCIsXCIpXHJcbiAgICAgICAgICAgIH0pLCBiICs9IFwifVwiXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuSlRvcG9Sb3VuZFJlY3QgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkge1xyXG4gICAgICAgIFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIGUgJiYgKGUgPSA1KSwgdGhpcy5iZWdpblBhdGgoKSwgdGhpcy5tb3ZlVG8oYSArIGUsIGIpLCB0aGlzLmxpbmVUbyhhICsgYyAtIGUsIGIpLCB0aGlzLnF1YWRyYXRpY0N1cnZlVG8oYSArIGMsIGIsIGEgKyBjLCBiICsgZSksIHRoaXMubGluZVRvKGEgKyBjLCBiICsgZCAtIGUpLCB0aGlzLnF1YWRyYXRpY0N1cnZlVG8oYSArIGMsIGIgKyBkLCBhICsgYyAtIGUsIGIgKyBkKSwgdGhpcy5saW5lVG8oYSArIGUsIGIgKyBkKSwgdGhpcy5xdWFkcmF0aWNDdXJ2ZVRvKGEsIGIgKyBkLCBhLCBiICsgZCAtIGUpLCB0aGlzLmxpbmVUbyhhLCBiICsgZSksIHRoaXMucXVhZHJhdGljQ3VydmVUbyhhLCBiLCBhICsgZSwgYiksIHRoaXMuY2xvc2VQYXRoKClcclxuICAgIH0sIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuSlRvcG9EYXNoZWRMaW5lVG8gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkge1xyXG4gICAgICAgIFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIGUgJiYgKGUgPSA1KTtcclxuICAgICAgICB2YXIgZiA9IGMgLSBhLCBnID0gZCAtIGIsIGggPSBNYXRoLmZsb29yKE1hdGguc3FydChmICogZiArIGcgKiBnKSksIGkgPSAwID49IGUgPyBoIDogaCAvIGUsIGogPSBnIC8gaCAqIGUsIGsgPSBmIC8gaCAqIGU7XHJcbiAgICAgICAgdGhpcy5iZWdpblBhdGgoKTtcclxuICAgICAgICBmb3IgKHZhciBsID0gMDsgaSA+IGw7IGwrKylsICUgMiA/IHRoaXMubGluZVRvKGEgKyBsICogaywgYiArIGwgKiBqKSA6IHRoaXMubW92ZVRvKGEgKyBsICogaywgYiArIGwgKiBqKTtcclxuICAgICAgICB0aGlzLnN0cm9rZSgpXHJcbiAgICB9LCBKVG9wbyA9IHtcclxuICAgICAgICB2ZXJzaW9uOiBcIjAuNC44XzAxXCIsXHJcbiAgICAgICAgekluZGV4X0NvbnRhaW5lcjogMSxcclxuICAgICAgICB6SW5kZXhfTGluazogMixcclxuICAgICAgICB6SW5kZXhfTm9kZTogMyxcclxuICAgICAgICBTY2VuZU1vZGU6IHtub3JtYWw6IFwibm9ybWFsXCIsIGRyYWc6IFwiZHJhZ1wiLCBlZGl0OiBcImVkaXRcIiwgc2VsZWN0OiBcInNlbGVjdFwifSxcclxuICAgICAgICBNb3VzZUN1cnNvcjoge1xyXG4gICAgICAgICAgICBub3JtYWw6IFwiZGVmYXVsdFwiLFxyXG4gICAgICAgICAgICBwb2ludGVyOiBcInBvaW50ZXJcIixcclxuICAgICAgICAgICAgdG9wX2xlZnQ6IFwibnctcmVzaXplXCIsXHJcbiAgICAgICAgICAgIHRvcF9jZW50ZXI6IFwibi1yZXNpemVcIixcclxuICAgICAgICAgICAgdG9wX3JpZ2h0OiBcIm5lLXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICBtaWRkbGVfbGVmdDogXCJlLXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICBtaWRkbGVfcmlnaHQ6IFwiZS1yZXNpemVcIixcclxuICAgICAgICAgICAgYm90dG9tX2xlZnQ6IFwibmUtcmVzaXplXCIsXHJcbiAgICAgICAgICAgIGJvdHRvbV9jZW50ZXI6IFwibi1yZXNpemVcIixcclxuICAgICAgICAgICAgYm90dG9tX3JpZ2h0OiBcIm53LXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICBtb3ZlOiBcIm1vdmVcIixcclxuICAgICAgICAgICAgb3Blbl9oYW5kOiBcInVybCguL2ltZy9jdXIvb3BlbmhhbmQuY3VyKSA4IDgsIGRlZmF1bHRcIixcclxuICAgICAgICAgICAgY2xvc2VkX2hhbmQ6IFwidXJsKC4vaW1nL2N1ci9jbG9zZWRoYW5kLmN1cikgOCA4LCBkZWZhdWx0XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNyZWF0ZVN0YWdlRnJvbUpzb246IGZ1bmN0aW9uIChqc29uU3RyLCBjYW52YXMpIHtcclxuICAgICAgICAgICAgZXZhbChcInZhciBqc29uT2JqID0gXCIgKyBqc29uU3RyKTtcclxuICAgICAgICAgICAgdmFyIHN0YWdlID0gbmV3IEpUb3BvLlN0YWdlKGNhbnZhcyk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4ganNvbk9iailcImNoaWxkc1wiICE9IGsgJiYgKHN0YWdlW2tdID0ganNvbk9ialtrXSk7XHJcbiAgICAgICAgICAgIHZhciBzY2VuZXMgPSBqc29uT2JqLmNoaWxkcztcclxuICAgICAgICAgICAgcmV0dXJuIHNjZW5lcy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IG5ldyBKVG9wby5TY2VuZShzdGFnZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjIGluIGEpXCJjaGlsZHNcIiAhPSBjICYmIChiW2NdID0gYVtjXSksIFwiYmFja2dyb3VuZFwiID09IGMgJiYgKGIuYmFja2dyb3VuZCA9IGFbY10pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBhLmNoaWxkcztcclxuICAgICAgICAgICAgICAgIGQuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gbnVsbCwgZCA9IGEuZWxlbWVudFR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJub2RlXCIgPT0gZCA/IGMgPSBuZXcgSlRvcG8uTm9kZSA6IFwiQ2lyY2xlTm9kZVwiID09IGQgJiYgKGMgPSBuZXcgSlRvcG8uQ2lyY2xlTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSBpbiBhKWNbZV0gPSBhW2VdO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuYWRkKGMpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KSwgc3RhZ2VcclxuICAgICAgICB9XHJcbiAgICB9LCBKVG9wby5FbGVtZW50ID0gRWxlbWVudCwgd2luZG93LkpUb3BvID0gSlRvcG9cclxufSh3aW5kb3cpLCBmdW5jdGlvbiAoSlRvcG8pIHtcclxuICAgIGZ1bmN0aW9uIE1lc3NhZ2VCdXMoYSkge1xyXG4gICAgICAgIHZhciBiID0gdGhpcztcclxuICAgICAgICB0aGlzLm5hbWUgPSBhLCB0aGlzLm1lc3NhZ2VNYXAgPSB7fSwgdGhpcy5tZXNzYWdlQ291bnQgPSAwLCB0aGlzLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChhLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYi5tZXNzYWdlTWFwW2FdO1xyXG4gICAgICAgICAgICBudWxsID09IGQgJiYgKGIubWVzc2FnZU1hcFthXSA9IFtdKSwgYi5tZXNzYWdlTWFwW2FdLnB1c2goYyksIGIubWVzc2FnZUNvdW50KytcclxuICAgICAgICB9LCB0aGlzLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBiLm1lc3NhZ2VNYXBbYV07XHJcbiAgICAgICAgICAgIG51bGwgIT0gYyAmJiAoYi5tZXNzYWdlTWFwW2FdID0gbnVsbCwgZGVsZXRlIGIubWVzc2FnZU1hcFthXSwgYi5tZXNzYWdlQ291bnQtLSlcclxuICAgICAgICB9LCB0aGlzLnB1Ymxpc2ggPSBmdW5jdGlvbiAoYSwgYywgZCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IGIubWVzc2FnZU1hcFthXTtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gZSlmb3IgKHZhciBmID0gMDsgZiA8IGUubGVuZ3RoOyBmKyspZCA/ICFmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYShiKVxyXG4gICAgICAgICAgICAgICAgfSwgMTApXHJcbiAgICAgICAgICAgIH0oZVtmXSwgYykgOiBlW2ZdKGMpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldERpc3RhbmNlKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICB2YXIgZSwgZjtcclxuICAgICAgICByZXR1cm4gbnVsbCA9PSBjICYmIG51bGwgPT0gZCA/IChlID0gYi54IC0gYS54LCBmID0gYi55IC0gYS55KSA6IChlID0gYyAtIGEsIGYgPSBkIC0gYiksIE1hdGguc3FydChlICogZSArIGYgKiBmKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRzQm91bmQoYSkge1xyXG4gICAgICAgIGZvciAodmFyIGIgPSB7bGVmdDogTnVtYmVyLk1BWF9WQUxVRSwgcmlnaHQ6IE51bWJlci5NSU5fVkFMVUUsIHRvcDogTnVtYmVyLk1BWF9WQUxVRSwgYm90dG9tOiBOdW1iZXIuTUlOX1ZBTFVFfSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYVtjXTtcclxuICAgICAgICAgICAgZCBpbnN0YW5jZW9mIEpUb3BvLkxpbmsgfHwgKGIubGVmdCA+IGQueCAmJiAoYi5sZWZ0ID0gZC54LCBiLmxlZnROb2RlID0gZCksIGIucmlnaHQgPCBkLnggKyBkLndpZHRoICYmIChiLnJpZ2h0ID0gZC54ICsgZC53aWR0aCwgYi5yaWdodE5vZGUgPSBkKSwgYi50b3AgPiBkLnkgJiYgKGIudG9wID0gZC55LCBiLnRvcE5vZGUgPSBkKSwgYi5ib3R0b20gPCBkLnkgKyBkLmhlaWdodCAmJiAoYi5ib3R0b20gPSBkLnkgKyBkLmhlaWdodCwgYi5ib3R0b21Ob2RlID0gZCkpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiLndpZHRoID0gYi5yaWdodCAtIGIubGVmdCwgYi5oZWlnaHQgPSBiLmJvdHRvbSAtIGIudG9wLCBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW91c2VDb29yZHMoYSkge1xyXG4gICAgICAgIHJldHVybiBhID0gY2xvbmVFdmVudChhKSwgYS5wYWdlWCB8fCAoYS5wYWdlWCA9IGEuY2xpZW50WCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCAtIGRvY3VtZW50LmJvZHkuY2xpZW50TGVmdCwgYS5wYWdlWSA9IGEuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIC0gZG9jdW1lbnQuYm9keS5jbGllbnRUb3ApLCBhXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0RXZlbnRQb3NpdGlvbihhKSB7XHJcbiAgICAgICAgcmV0dXJuIGEgPSBtb3VzZUNvb3JkcyhhKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJvdGF0ZVBvaW50KGEsIGIsIGMsIGQsIGUpIHtcclxuICAgICAgICB2YXIgZiA9IGMgLSBhLCBnID0gZCAtIGIsIGggPSBNYXRoLnNxcnQoZiAqIGYgKyBnICogZyksIGkgPSBNYXRoLmF0YW4yKGcsIGYpICsgZTtcclxuICAgICAgICByZXR1cm4ge3g6IGEgKyBNYXRoLmNvcyhpKSAqIGgsIHk6IGIgKyBNYXRoLnNpbihpKSAqIGh9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcm90YXRlUG9pbnRzKGEsIGIsIGMpIHtcclxuICAgICAgICBmb3IgKHZhciBkID0gW10sIGUgPSAwOyBlIDwgYi5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICB2YXIgZiA9IHJvdGF0ZVBvaW50KGEueCwgYS55LCBiW2VdLngsIGJbZV0ueSwgYyk7XHJcbiAgICAgICAgICAgIGQucHVzaChmKVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uICRmb3JlYWNoKGEsIGIsIGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKGUpIHtcclxuICAgICAgICAgICAgZSAhPSBhLmxlbmd0aCAmJiAoYihhW2VdKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBkKCsrZSlcclxuICAgICAgICAgICAgfSwgYykpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoMCAhPSBhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IDA7XHJcbiAgICAgICAgICAgIGQoZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gJGZvcihhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZShhKSB7XHJcbiAgICAgICAgICAgIGEgIT0gYiAmJiAoYyhiKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlKCsrYSlcclxuICAgICAgICAgICAgfSwgZCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIShhID4gYikpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSAwO1xyXG4gICAgICAgICAgICBlKGYpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNsb25lRXZlbnQoYSkge1xyXG4gICAgICAgIHZhciBiID0ge307XHJcbiAgICAgICAgZm9yICh2YXIgYyBpbiBhKVwicmV0dXJuVmFsdWVcIiAhPSBjICYmIFwia2V5TG9jYXRpb25cIiAhPSBjICYmIChiW2NdID0gYVtjXSk7XHJcbiAgICAgICAgcmV0dXJuIGJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjbG9uZShhKSB7XHJcbiAgICAgICAgdmFyIGIgPSB7fTtcclxuICAgICAgICBmb3IgKHZhciBjIGluIGEpYltjXSA9IGFbY107XHJcbiAgICAgICAgcmV0dXJuIGJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpc1BvaW50SW5SZWN0KGEsIGIpIHtcclxuICAgICAgICB2YXIgYyA9IGIueCwgZCA9IGIueSwgZSA9IGIud2lkdGgsIGYgPSBiLmhlaWdodDtcclxuICAgICAgICByZXR1cm4gYS54ID4gYyAmJiBhLnggPCBjICsgZSAmJiBhLnkgPiBkICYmIGEueSA8IGQgKyBmXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNQb2ludEluTGluZShhLCBiLCBjKSB7XHJcbiAgICAgICAgdmFyIGQgPSBKVG9wby51dGlsLmdldERpc3RhbmNlKGIsIGMpLCBlID0gSlRvcG8udXRpbC5nZXREaXN0YW5jZShiLCBhKSwgZiA9IEpUb3BvLnV0aWwuZ2V0RGlzdGFuY2UoYywgYSksIGcgPSBNYXRoLmFicyhlICsgZiAtIGQpIDw9IC41O1xyXG4gICAgICAgIHJldHVybiBnXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlRnJvbUFycmF5KGEsIGIpIHtcclxuICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBhW2NdO1xyXG4gICAgICAgICAgICBpZiAoZCA9PT0gYikge1xyXG4gICAgICAgICAgICAgICAgYSA9IGEuZGVsKGMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJhbmRvbUNvbG9yKCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKDI1NSAqIE1hdGgucmFuZG9tKCkpICsgXCIsXCIgKyBNYXRoLmZsb29yKDI1NSAqIE1hdGgucmFuZG9tKCkpICsgXCIsXCIgKyBNYXRoLmZsb29yKDI1NSAqIE1hdGgucmFuZG9tKCkpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNJbnRzZWN0KCkge1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFByb3BlcnRpZXMoYSwgYikge1xyXG4gICAgICAgIGZvciAodmFyIGMgPSBcIlwiLCBkID0gMDsgZCA8IGIubGVuZ3RoOyBkKyspIHtcclxuICAgICAgICAgICAgZCA+IDAgJiYgKGMgKz0gXCIsXCIpO1xyXG4gICAgICAgICAgICB2YXIgZSA9IGFbYltkXV07XHJcbiAgICAgICAgICAgIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBlID0gJ1wiJyArIGUgKyAnXCInIDogdm9pZCAwID09IGUgJiYgKGUgPSBudWxsKSwgYyArPSBiW2RdICsgXCI6XCIgKyBlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbG9hZFN0YWdlRnJvbUpzb24oanNvbiwgY2FudmFzKSB7XHJcbiAgICAgICAgdmFyIG9iaiA9IGV2YWwoanNvbiksIHN0YWdlID0gbmV3IEpUb3BvLlN0YWdlKGNhbnZhcyk7XHJcbiAgICAgICAgZm9yICh2YXIgayBpbiBzdGFnZU9iailpZiAoXCJzY2VuZXNcIiAhPSBrKXN0YWdlW2tdID0gb2JqW2tdOyBlbHNlIGZvciAodmFyIHNjZW5lcyA9IG9iai5zY2VuZXMsIGkgPSAwOyBpIDwgc2NlbmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBzY2VuZU9iaiA9IHNjZW5lc1tpXSwgc2NlbmUgPSBuZXcgSlRvcG8uU2NlbmUoc3RhZ2UpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHNjZW5lT2JqKWlmIChcImVsZW1lbnRzXCIgIT0gcClzY2VuZVtwXSA9IHNjZW5lT2JqW3BdOyBlbHNlIGZvciAodmFyIG5vZGVNYXAgPSB7fSwgZWxlbWVudHMgPSBzY2VuZU9iai5lbGVtZW50cywgbSA9IDA7IG0gPCBlbGVtZW50cy5sZW5ndGg7IG0rKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRPYmogPSBlbGVtZW50c1ttXSwgdHlwZSA9IGVsZW1lbnRPYmouZWxlbWVudFR5cGUsIGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBcIk5vZGVcIiA9PSB0eXBlICYmIChlbGVtZW50ID0gbmV3IEpUb3BvLk5vZGUpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbWsgaW4gZWxlbWVudE9iaillbGVtZW50W21rXSA9IGVsZW1lbnRPYmpbbWtdO1xyXG4gICAgICAgICAgICAgICAgbm9kZU1hcFtlbGVtZW50LnRleHRdID0gZWxlbWVudCwgc2NlbmUuYWRkKGVsZW1lbnQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKHN0YWdlKSwgc3RhZ2VcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0b0pzb24oYSkge1xyXG4gICAgICAgIHZhciBiID0gXCJiYWNrZ3JvdW5kQ29sb3IsdmlzaWJsZSxtb2RlLHJvdGF0ZSxhbHBoYSxzY2FsZVgsc2NhbGVZLHNoYWRvdyx0cmFuc2xhdGVYLHRyYW5zbGF0ZVksYXJlYVNlbGVjdCxwYWludEFsbFwiLnNwbGl0KFwiLFwiKSwgYyA9IFwidGV4dCxlbGVtZW50VHlwZSx4LHksd2lkdGgsaGVpZ2h0LHZpc2libGUsYWxwaGEscm90YXRlLHNjYWxlWCxzY2FsZVksZmlsbENvbG9yLHNoYWRvdyx0cmFuc2Zvcm1BYmxlLHpJbmRleCxkcmFnYWJsZSxzZWxlY3RlZCxzaG93U2VsZWN0ZWQsZm9udCxmb250Q29sb3IsdGV4dFBvc2l0aW9uLHRleHRPZmZzZXRYLHRleHRPZmZzZXRZXCIuc3BsaXQoXCIsXCIpLCBkID0gXCJ7XCI7XHJcbiAgICAgICAgZCArPSBcImZyYW1lczpcIiArIGEuZnJhbWVzLCBkICs9IFwiLCBzY2VuZXM6W1wiO1xyXG4gICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgYS5jaGlsZHMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBhLmNoaWxkc1tlXTtcclxuICAgICAgICAgICAgZCArPSBcIntcIiwgZCArPSBnZXRQcm9wZXJ0aWVzKGYsIGIpLCBkICs9IFwiLCBlbGVtZW50czpbXCI7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgZi5jaGlsZHMubGVuZ3RoOyBnKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBoID0gZi5jaGlsZHNbZ107XHJcbiAgICAgICAgICAgICAgICBnID4gMCAmJiAoZCArPSBcIixcIiksIGQgKz0gXCJ7XCIsIGQgKz0gZ2V0UHJvcGVydGllcyhoLCBjKSwgZCArPSBcIn1cIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGQgKz0gXCJdfVwiXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkICs9IFwiXVwiLCBkICs9IFwifVwiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2hhbmdlQ29sb3IoYSwgYiwgYykge1xyXG4gICAgICAgIHZhciBkID0gYy5zcGxpdChcIixcIiksIGUgPSBwYXJzZUludChkWzBdKSwgZiA9IHBhcnNlSW50KGRbMV0pLCBnID0gcGFyc2VJbnQoZFsyXSksIGggPSBjYW52YXMud2lkdGggPSBiLndpZHRoLCBpID0gY2FudmFzLmhlaWdodCA9IGIuaGVpZ2h0O1xyXG4gICAgICAgIGEuY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCksIGEuZHJhd0ltYWdlKGIsIDAsIDApO1xyXG4gICAgICAgIGZvciAodmFyIGogPSBhLmdldEltYWdlRGF0YSgwLCAwLCBiLndpZHRoLCBiLmhlaWdodCksIGsgPSBqLmRhdGEsIGwgPSAwOyBoID4gbDsgbCsrKWZvciAodmFyIG0gPSAwOyBpID4gbTsgbSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBuID0gNCAqIChsICsgbSAqIGgpO1xyXG4gICAgICAgICAgICAwICE9IGtbbiArIDNdICYmIChudWxsICE9IGUgJiYgKGtbbiArIDBdICs9IGUpLCBudWxsICE9IGYgJiYgKGtbbiArIDFdICs9IGYpLCBudWxsICE9IGcgJiYgKGtbbiArIDJdICs9IGcpKVxyXG4gICAgICAgIH1cclxuICAgICAgICBhLnB1dEltYWdlRGF0YShqLCAwLCAwLCAwLCAwLCBiLndpZHRoLCBiLmhlaWdodCk7XHJcbiAgICAgICAgdmFyIG8gPSBjYW52YXMudG9EYXRhVVJMKCk7XHJcbiAgICAgICAgcmV0dXJuIG9cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZW5JbWFnZUFsYXJtKGEsIGIpIHtcclxuICAgICAgICB2YXIgYyA9IGEuc3JjICsgYjtcclxuICAgICAgICBpZiAoYWxhcm1JbWFnZUNhY2hlW2NdKXJldHVybiBhbGFybUltYWdlQ2FjaGVbY107XHJcbiAgICAgICAgdmFyIGQgPSBuZXcgSW1hZ2U7XHJcbiAgICAgICAgcmV0dXJuIGQuc3JjID0gY2hhbmdlQ29sb3IoZ3JhcGhpY3MsIGEsIGIpLCBhbGFybUltYWdlQ2FjaGVbY10gPSBkLCBkXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0T2Zmc2V0UG9zaXRpb24oYSkge1xyXG4gICAgICAgIGlmICghYSlyZXR1cm4ge2xlZnQ6IDAsIHRvcDogMH07XHJcbiAgICAgICAgdmFyIGIgPSAwLCBjID0gMDtcclxuICAgICAgICBpZiAoXCJnZXRCb3VuZGluZ0NsaWVudFJlY3RcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpdmFyIGQgPSBhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBlID0gYS5vd25lckRvY3VtZW50LCBmID0gZS5ib2R5LCBnID0gZS5kb2N1bWVudEVsZW1lbnQsIGggPSBnLmNsaWVudFRvcCB8fCBmLmNsaWVudFRvcCB8fCAwLCBpID0gZy5jbGllbnRMZWZ0IHx8IGYuY2xpZW50TGVmdCB8fCAwLCBiID0gZC50b3AgKyAoc2VsZi5wYWdlWU9mZnNldCB8fCBnICYmIGcuc2Nyb2xsVG9wIHx8IGYuc2Nyb2xsVG9wKSAtIGgsIGMgPSBkLmxlZnQgKyAoc2VsZi5wYWdlWE9mZnNldCB8fCBnICYmIGcuc2Nyb2xsTGVmdCB8fCBmLnNjcm9sbExlZnQpIC0gaTsgZWxzZSBkbyBiICs9IGEub2Zmc2V0VG9wIHx8IDAsIGMgKz0gYS5vZmZzZXRMZWZ0IHx8IDAsIGEgPSBhLm9mZnNldFBhcmVudDsgd2hpbGUgKGEpO1xyXG4gICAgICAgIHJldHVybiB7bGVmdDogYywgdG9wOiBifVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGxpbmVGKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICBmdW5jdGlvbiBlKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEgKiBmICsgZ1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGYgPSAoZCAtIGIpIC8gKGMgLSBhKSwgZyA9IGIgLSBhICogZjtcclxuICAgICAgICByZXR1cm4gZS5rID0gZiwgZS5iID0gZywgZS54MSA9IGEsIGUueDIgPSBjLCBlLnkxID0gYiwgZS55MiA9IGQsIGVcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpblJhbmdlKGEsIGIsIGMpIHtcclxuICAgICAgICB2YXIgZCA9IE1hdGguYWJzKGIgLSBjKSwgZSA9IE1hdGguYWJzKGIgLSBhKSwgZiA9IE1hdGguYWJzKGMgLSBhKSwgZyA9IE1hdGguYWJzKGQgLSAoZSArIGYpKTtcclxuICAgICAgICByZXR1cm4gMWUtNiA+IGcgPyAhMCA6ICExXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNQb2ludEluTGluZVNlZyhhLCBiLCBjKSB7XHJcbiAgICAgICAgcmV0dXJuIGluUmFuZ2UoYSwgYy54MSwgYy54MikgJiYgaW5SYW5nZShiLCBjLnkxLCBjLnkyKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGludGVyc2VjdGlvbihhLCBiKSB7XHJcbiAgICAgICAgdmFyIGMsIGQ7XHJcbiAgICAgICAgcmV0dXJuIGEuayA9PSBiLmsgPyBudWxsIDogKDEgLyAwID09IGEuayB8fCBhLmsgPT0gLTEgLyAwID8gKGMgPSBhLngxLCBkID0gYihhLngxKSkgOiAxIC8gMCA9PSBiLmsgfHwgYi5rID09IC0xIC8gMCA/IChjID0gYi54MSwgZCA9IGEoYi54MSkpIDogKGMgPSAoYi5iIC0gYS5iKSAvIChhLmsgLSBiLmspLCBkID0gYShjKSksIDAgPT0gaXNQb2ludEluTGluZVNlZyhjLCBkLCBhKSA/IG51bGwgOiAwID09IGlzUG9pbnRJbkxpbmVTZWcoYywgZCwgYikgPyBudWxsIDoge1xyXG4gICAgICAgICAgICB4OiBjLFxyXG4gICAgICAgICAgICB5OiBkXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpbnRlcnNlY3Rpb25MaW5lQm91bmQoYSwgYikge1xyXG4gICAgICAgIHZhciBjID0gSlRvcG8udXRpbC5saW5lRihiLmxlZnQsIGIudG9wLCBiLmxlZnQsIGIuYm90dG9tKSwgZCA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uKGEsIGMpO1xyXG4gICAgICAgIHJldHVybiBudWxsID09IGQgJiYgKGMgPSBKVG9wby51dGlsLmxpbmVGKGIubGVmdCwgYi50b3AsIGIucmlnaHQsIGIudG9wKSwgZCA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uKGEsIGMpLCBudWxsID09IGQgJiYgKGMgPSBKVG9wby51dGlsLmxpbmVGKGIucmlnaHQsIGIudG9wLCBiLnJpZ2h0LCBiLmJvdHRvbSksIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihhLCBjKSwgbnVsbCA9PSBkICYmIChjID0gSlRvcG8udXRpbC5saW5lRihiLmxlZnQsIGIuYm90dG9tLCBiLnJpZ2h0LCBiLmJvdHRvbSksIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihhLCBjKSkpKSwgZFxyXG4gICAgfVxyXG5cclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGEsIDFlMyAvIDI0KVxyXG4gICAgICAgIH0sIEFycmF5LnByb3RvdHlwZS5kZWwgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIGlmIChcIm51bWJlclwiICE9IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgdGhpcy5sZW5ndGg7IGIrKylpZiAodGhpc1tiXSA9PT0gYSlyZXR1cm4gdGhpcy5zbGljZSgwLCBiKS5jb25jYXQodGhpcy5zbGljZShiICsgMSwgdGhpcy5sZW5ndGgpKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIDAgPiBhID8gdGhpcyA6IHRoaXMuc2xpY2UoMCwgYSkuY29uY2F0KHRoaXMuc2xpY2UoYSArIDEsIHRoaXMubGVuZ3RoKSlcclxuICAgIH0sIFtdLmluZGV4T2YgfHwgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMubGVuZ3RoOyBiKyspaWYgKHRoaXNbYl0gPT09IGEpcmV0dXJuIGI7XHJcbiAgICAgICAgcmV0dXJuIC0xXHJcbiAgICB9KSwgd2luZG93LmNvbnNvbGUgfHwgKHdpbmRvdy5jb25zb2xlID0ge1xyXG4gICAgICAgIGxvZzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIH0sIGluZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCBkZWJ1ZzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIH0sIHdhcm46IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCBlcnJvcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksIGdyYXBoaWNzID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKSwgYWxhcm1JbWFnZUNhY2hlID0ge307XHJcbiAgICBKVG9wby51dGlsID0ge1xyXG4gICAgICAgIHJvdGF0ZVBvaW50OiByb3RhdGVQb2ludCxcclxuICAgICAgICByb3RhdGVQb2ludHM6IHJvdGF0ZVBvaW50cyxcclxuICAgICAgICBnZXREaXN0YW5jZTogZ2V0RGlzdGFuY2UsXHJcbiAgICAgICAgZ2V0RXZlbnRQb3NpdGlvbjogZ2V0RXZlbnRQb3NpdGlvbixcclxuICAgICAgICBtb3VzZUNvb3JkczogbW91c2VDb29yZHMsXHJcbiAgICAgICAgTWVzc2FnZUJ1czogTWVzc2FnZUJ1cyxcclxuICAgICAgICBpc0ZpcmVmb3g6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIkZpcmVmb3hcIikgPiAwLFxyXG4gICAgICAgIGlzSUU6ICEoIXdpbmRvdy5hdHRhY2hFdmVudCB8fCAtMSAhPT0gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiT3BlcmFcIikpLFxyXG4gICAgICAgIGlzQ2hyb21lOiBudWxsICE9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvY2hyb21lLyksXHJcbiAgICAgICAgY2xvbmU6IGNsb25lLFxyXG4gICAgICAgIGlzUG9pbnRJblJlY3Q6IGlzUG9pbnRJblJlY3QsXHJcbiAgICAgICAgaXNQb2ludEluTGluZTogaXNQb2ludEluTGluZSxcclxuICAgICAgICByZW1vdmVGcm9tQXJyYXk6IHJlbW92ZUZyb21BcnJheSxcclxuICAgICAgICBjbG9uZUV2ZW50OiBjbG9uZUV2ZW50LFxyXG4gICAgICAgIHJhbmRvbUNvbG9yOiByYW5kb21Db2xvcixcclxuICAgICAgICBpc0ludHNlY3Q6IGlzSW50c2VjdCxcclxuICAgICAgICB0b0pzb246IHRvSnNvbixcclxuICAgICAgICBsb2FkU3RhZ2VGcm9tSnNvbjogbG9hZFN0YWdlRnJvbUpzb24sXHJcbiAgICAgICAgZ2V0RWxlbWVudHNCb3VuZDogZ2V0RWxlbWVudHNCb3VuZCxcclxuICAgICAgICBnZW5JbWFnZUFsYXJtOiBnZW5JbWFnZUFsYXJtLFxyXG4gICAgICAgIGdldE9mZnNldFBvc2l0aW9uOiBnZXRPZmZzZXRQb3NpdGlvbixcclxuICAgICAgICBsaW5lRjogbGluZUYsXHJcbiAgICAgICAgaW50ZXJzZWN0aW9uOiBpbnRlcnNlY3Rpb24sXHJcbiAgICAgICAgaW50ZXJzZWN0aW9uTGluZUJvdW5kOiBpbnRlcnNlY3Rpb25MaW5lQm91bmRcclxuICAgIH0sIHdpbmRvdy4kZm9yID0gJGZvciwgd2luZG93LiRmb3JlYWNoID0gJGZvcmVhY2hcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKGEpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBoZ2FwOiAxNiwgdmlzaWJsZTogITEsIGV4cG9ydENhbnZhczogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSwgZ2V0SW1hZ2U6IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGEuZ2V0Qm91bmQoKSwgZSA9IDEsIGYgPSAxO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMud2lkdGggPSBhLmNhbnZhcy53aWR0aCwgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0ID0gYS5jYW52YXMuaGVpZ2h0LCBudWxsICE9IGIgJiYgbnVsbCAhPSBjID8gKHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoID0gYiwgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0ID0gYywgZSA9IGIgLyBkLndpZHRoLCBmID0gYyAvIGQuaGVpZ2h0KSA6IChkLndpZHRoID4gYS5jYW52YXMud2lkdGggJiYgKHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoID0gZC53aWR0aCksIGQuaGVpZ2h0ID4gYS5jYW52YXMuaGVpZ2h0ICYmICh0aGlzLmV4cG9ydENhbnZhcy5oZWlnaHQgPSBkLmhlaWdodCkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGcgPSB0aGlzLmV4cG9ydENhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5jaGlsZHMubGVuZ3RoID4gMCAmJiAoZy5zYXZlKCksIGcuY2xlYXJSZWN0KDAsIDAsIHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoLCB0aGlzLmV4cG9ydENhbnZhcy5oZWlnaHQpLCBhLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgMSA9PSBhLnZpc2libGUgJiYgKGEuc2F2ZSgpLCBhLnRyYW5zbGF0ZVggPSAwLCBhLnRyYW5zbGF0ZVkgPSAwLCBhLnNjYWxlWCA9IDEsIGEuc2NhbGVZID0gMSwgZy5zY2FsZShlLCBmKSwgZC5sZWZ0IDwgMCAmJiAoYS50cmFuc2xhdGVYID0gTWF0aC5hYnMoZC5sZWZ0KSksIGQudG9wIDwgMCAmJiAoYS50cmFuc2xhdGVZID0gTWF0aC5hYnMoZC50b3ApKSwgYS5wYWludEFsbCA9ICEwLCBhLnJlcGFpbnQoZyksIGEucGFpbnRBbGwgPSAhMSwgYS5yZXN0b3JlKCkpXHJcbiAgICAgICAgICAgICAgICB9KSwgZy5yZXN0b3JlKCkpLCB0aGlzLmV4cG9ydENhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIilcclxuICAgICAgICAgICAgfSwgY2FudmFzOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLCB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWFnbGVJbWFnZURhdGFzID0gdGhpcy5nZXREYXRhKGEpXHJcbiAgICAgICAgICAgIH0sIHNldFNpemU6IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5jYW52YXMud2lkdGggPSBhLCB0aGlzLmhlaWdodCA9IHRoaXMuY2FudmFzLmhlaWdodCA9IGJcclxuICAgICAgICAgICAgfSwgZ2V0RGF0YTogZnVuY3Rpb24gKGIsIGMpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGQoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gYS5zdGFnZS5jYW52YXMud2lkdGgsIGMgPSBhLnN0YWdlLmNhbnZhcy5oZWlnaHQsIGQgPSBiIC8gYS5zY2FsZVggLyAyLCBlID0gYyAvIGEuc2NhbGVZIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3RyYW5zbGF0ZVg6IGEudHJhbnNsYXRlWCArIGQgLSBkICogYS5zY2FsZVgsIHRyYW5zbGF0ZVk6IGEudHJhbnNsYXRlWSArIGUgLSBlICogYS5zY2FsZVl9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbnVsbCAhPSBqICYmIG51bGwgIT0gayA/IHRoaXMuc2V0U2l6ZShiLCBjKSA6IHRoaXMuc2V0U2l6ZSgyMDAsIDE2MCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChhLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zYXZlKCksIGUuY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpLCBhLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDEgPT0gYS52aXNpYmxlICYmIChhLnNhdmUoKSwgYS5jZW50ZXJBbmRab29tKG51bGwsIG51bGwsIGUpLCBhLnJlcGFpbnQoZSksIGEucmVzdG9yZSgpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gZChhLmNoaWxkc1swXSksIGcgPSBmLnRyYW5zbGF0ZVggKiAodGhpcy5jYW52YXMud2lkdGggLyBhLmNhbnZhcy53aWR0aCkgKiBhLmNoaWxkc1swXS5zY2FsZVgsIGggPSBmLnRyYW5zbGF0ZVkgKiAodGhpcy5jYW52YXMuaGVpZ2h0IC8gYS5jYW52YXMuaGVpZ2h0KSAqIGEuY2hpbGRzWzBdLnNjYWxlWSwgaSA9IGEuZ2V0Qm91bmQoKSwgaiA9IGEuY2FudmFzLndpZHRoIC8gYS5jaGlsZHNbMF0uc2NhbGVYIC8gaS53aWR0aCwgayA9IGEuY2FudmFzLmhlaWdodCAvIGEuY2hpbGRzWzBdLnNjYWxlWSAvIGkuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGogPiAxICYmIChqID0gMSksIGsgPiAxICYmIChqID0gMSksIGcgKj0gaiwgaCAqPSBrLCBpLmxlZnQgPCAwICYmIChnIC09IE1hdGguYWJzKGkubGVmdCkgKiAodGhpcy53aWR0aCAvIGkud2lkdGgpKSwgaS50b3AgPCAwICYmIChoIC09IE1hdGguYWJzKGkudG9wKSAqICh0aGlzLmhlaWdodCAvIGkuaGVpZ2h0KSksIGUuc2F2ZSgpLCBlLmxpbmVXaWR0aCA9IDEsIGUuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMjU1LDAsMCwxKVwiLCBlLnN0cm9rZVJlY3QoLWcsIC1oLCBlLmNhbnZhcy53aWR0aCAqIGosIGUuY2FudmFzLmhlaWdodCAqIGspLCBlLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbCA9IGUuZ2V0SW1hZ2VEYXRhKDAsIDAsIGUuY2FudmFzLndpZHRoLCBlLmNhbnZhcy5oZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAobSkge1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfSwgcGFpbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuZWFnbGVJbWFnZURhdGFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhLmdyYXBoaWNzO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc2F2ZSgpLCBiLmZpbGxTdHlsZSA9IFwicmdiYSgyMTEsMjExLDIxMSwwLjMpXCIsIGIuZmlsbFJlY3QoYS5jYW52YXMud2lkdGggLSB0aGlzLmNhbnZhcy53aWR0aCAtIDIgKiB0aGlzLmhnYXAsIGEuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCAtIDEsIGEuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCArIDEpLCBiLmZpbGwoKSwgYi5zYXZlKCksIGIubGluZVdpZHRoID0gMSwgYi5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMCwxKVwiLCBiLnJlY3QoYS5jYW52YXMud2lkdGggLSB0aGlzLmNhbnZhcy53aWR0aCAtIDIgKiB0aGlzLmhnYXAsIGEuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCAtIDEsIGEuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCArIDEpLCBiLnN0cm9rZSgpLCBiLnJlc3RvcmUoKSwgYi5wdXRJbWFnZURhdGEodGhpcy5lYWdsZUltYWdlRGF0YXMsIGEuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggLSB0aGlzLmhnYXAsIGEuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCksIGIucmVzdG9yZSgpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5lYWdsZUltYWdlRGF0YXMgPSB0aGlzLmdldERhdGEoYSlcclxuICAgICAgICAgICAgfSwgZXZlbnRIYW5kbGVyOiBmdW5jdGlvbiAoYSwgYiwgYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiLngsIGUgPSBiLnk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZCA+IGMuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggJiYgZSA+IGMuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkID0gYi54IC0gdGhpcy5jYW52YXMud2lkdGgsIGUgPSBiLnkgLSB0aGlzLmNhbnZhcy5oZWlnaHQsIFwibW91c2Vkb3duXCIgPT0gYSAmJiAodGhpcy5sYXN0VHJhbnNsYXRlWCA9IGMuY2hpbGRzWzBdLnRyYW5zbGF0ZVgsIHRoaXMubGFzdFRyYW5zbGF0ZVkgPSBjLmNoaWxkc1swXS50cmFuc2xhdGVZKSwgXCJtb3VzZWRyYWdcIiA9PSBhICYmIGMuY2hpbGRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBiLmR4LCBnID0gYi5keSwgaCA9IGMuZ2V0Qm91bmQoKSwgaSA9IHRoaXMuY2FudmFzLndpZHRoIC8gYy5jaGlsZHNbMF0uc2NhbGVYIC8gaC53aWR0aCwgaiA9IHRoaXMuY2FudmFzLmhlaWdodCAvIGMuY2hpbGRzWzBdLnNjYWxlWSAvIGguaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjLmNoaWxkc1swXS50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCAtIGYgLyBpLCBjLmNoaWxkc1swXS50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSAtIGcgLyBqXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGMoYykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGQoYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IGEudXRpbC5nZXRFdmVudFBvc2l0aW9uKGIpLCBkID0gYS51dGlsLmdldE9mZnNldFBvc2l0aW9uKG4uY2FudmFzKTtcclxuICAgICAgICAgICAgcmV0dXJuIGMub2Zmc2V0TGVmdCA9IGMucGFnZVggLSBkLmxlZnQsIGMub2Zmc2V0VG9wID0gYy5wYWdlWSAtIGQudG9wLCBjLnggPSBjLm9mZnNldExlZnQsIGMueSA9IGMub2Zmc2V0VG9wLCBjLnRhcmdldCA9IG51bGwsIGNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoYSkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5vbnNlbGVjdHN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICExXHJcbiAgICAgICAgICAgIH0sIHRoaXMubW91c2VPdmVyID0gITA7XHJcbiAgICAgICAgICAgIHZhciBiID0gZChhKTtcclxuICAgICAgICAgICAgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZW92ZXJcIiwgYiksIG4uZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZihhKSB7XHJcbiAgICAgICAgICAgIHAgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIG8gPSAhMFxyXG4gICAgICAgICAgICB9LCA1MDApLCBkb2N1bWVudC5vbnNlbGVjdHN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEwXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciBiID0gZChhKTtcclxuICAgICAgICAgICAgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZW91dFwiLCBiKSwgbi5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYiksIG4ubmVlZFJlcGFpbnQgPSAwID09IG4uYW5pbWF0ZSA/ICExIDogITBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGcoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IGQoYSk7XHJcbiAgICAgICAgICAgIG4ubW91c2VEb3duID0gITAsIG4ubW91c2VEb3duWCA9IGIueCwgbi5tb3VzZURvd25ZID0gYi55LCBuLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlZG93blwiLCBiKSwgbi5kaXNwYXRjaEV2ZW50KFwibW91c2Vkb3duXCIsIGIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBkKGEpO1xyXG4gICAgICAgICAgICBuLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNldXBcIiwgYiksIG4uZGlzcGF0Y2hFdmVudChcIm1vdXNldXBcIiwgYiksIG4ubW91c2VEb3duID0gITEsIG4ubmVlZFJlcGFpbnQgPSAwID09IG4uYW5pbWF0ZSA/ICExIDogITBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGkoYSkge1xyXG4gICAgICAgICAgICBwICYmICh3aW5kb3cuY2xlYXJUaW1lb3V0KHApLCBwID0gbnVsbCksIG8gPSAhMTtcclxuICAgICAgICAgICAgdmFyIGIgPSBkKGEpO1xyXG4gICAgICAgICAgICBuLm1vdXNlRG93biA/IDAgPT0gYS5idXR0b24gJiYgKGIuZHggPSBiLnggLSBuLm1vdXNlRG93blgsIGIuZHkgPSBiLnkgLSBuLm1vdXNlRG93blksIG4uZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2VkcmFnXCIsIGIpLCBuLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRyYWdcIiwgYiksIDEgPT0gbi5lYWdsZUV5ZS52aXNpYmxlICYmIG4uZWFnbGVFeWUudXBkYXRlKCkpIDogKG4uZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2Vtb3ZlXCIsIGIpLCBuLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW1vdmVcIiwgYikpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBqKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBkKGEpO1xyXG4gICAgICAgICAgICBuLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcImNsaWNrXCIsIGIpLCBuLmRpc3BhdGNoRXZlbnQoXCJjbGlja1wiLCBiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gayhhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gZChhKTtcclxuICAgICAgICAgICAgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJkYmNsaWNrXCIsIGIpLCBuLmRpc3BhdGNoRXZlbnQoXCJkYmNsaWNrXCIsIGIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBsKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBkKGEpO1xyXG4gICAgICAgICAgICBuLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNld2hlZWxcIiwgYiksIG4uZGlzcGF0Y2hFdmVudChcIm1vdXNld2hlZWxcIiwgYiksIG51bGwgIT0gbi53aGVlbFpvb20gJiYgKGEucHJldmVudERlZmF1bHQgPyBhLnByZXZlbnREZWZhdWx0KCkgOiAoYSA9IGEgfHwgd2luZG93LmV2ZW50LCBhLnJldHVyblZhbHVlID0gITEpLCAxID09IG4uZWFnbGVFeWUudmlzaWJsZSAmJiBuLmVhZ2xlRXllLnVwZGF0ZSgpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbShiKSB7XHJcbiAgICAgICAgICAgIGEudXRpbC5pc0lFIHx8ICF3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA/IChiLm9ubW91c2VvdXQgPSBmLCBiLm9ubW91c2VvdmVyID0gZSwgYi5vbm1vdXNlZG93biA9IGcsIGIub25tb3VzZXVwID0gaCwgYi5vbm1vdXNlbW92ZSA9IGksIGIub25jbGljayA9IGosIGIub25kYmxjbGljayA9IGssIGIub25tb3VzZXdoZWVsID0gbCwgYi50b3VjaHN0YXJ0ID0gZywgYi50b3VjaG1vdmUgPSBpLCBiLnRvdWNoZW5kID0gaCkgOiAoYi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgZiksIGIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBlKSwgYi5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGcpLCBiLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGgpLCBiLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgaSksIGIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGopLCBiLmFkZEV2ZW50TGlzdGVuZXIoXCJkYmxjbGlja1wiLCBrKSwgYS51dGlsLmlzRmlyZWZveCA/IGIuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTU1vdXNlU2Nyb2xsXCIsIGwpIDogYi5hZGRFdmVudExpc3RlbmVyKFwibW91c2V3aGVlbFwiLCBsKSksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICYmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIG4uZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwia2V5ZG93blwiLCBhLnV0aWwuY2xvbmVFdmVudChiKSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGIua2V5Q29kZTtcclxuICAgICAgICAgICAgICAgICgzNyA9PSBjIHx8IDM4ID09IGMgfHwgMzkgPT0gYyB8fCA0MCA9PSBjKSAmJiAoYi5wcmV2ZW50RGVmYXVsdCA/IGIucHJldmVudERlZmF1bHQoKSA6IChiID0gYiB8fCB3aW5kb3cuZXZlbnQsIGIucmV0dXJuVmFsdWUgPSAhMSkpXHJcbiAgICAgICAgICAgIH0sICEwKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJrZXl1cFwiLCBhLnV0aWwuY2xvbmVFdmVudChiKSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGIua2V5Q29kZTtcclxuICAgICAgICAgICAgICAgICgzNyA9PSBjIHx8IDM4ID09IGMgfHwgMzkgPT0gYyB8fCA0MCA9PSBjKSAmJiAoYi5wcmV2ZW50RGVmYXVsdCA/IGIucHJldmVudERlZmF1bHQoKSA6IChiID0gYiB8fCB3aW5kb3cuZXZlbnQsIGIucmV0dXJuVmFsdWUgPSAhMSkpXHJcbiAgICAgICAgICAgIH0sICEwKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGEuc3RhZ2UgPSB0aGlzO1xyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICBtKGMpLCB0aGlzLmNhbnZhcyA9IGMsIHRoaXMuZ3JhcGhpY3MgPSBjLmdldENvbnRleHQoXCIyZFwiKSwgdGhpcy5jaGlsZHMgPSBbXSwgdGhpcy5mcmFtZXMgPSAyNCwgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGEudXRpbC5NZXNzYWdlQnVzLCB0aGlzLmVhZ2xlRXllID0gYih0aGlzKSwgdGhpcy53aGVlbFpvb20gPSBudWxsLCB0aGlzLm1vdXNlRG93blggPSAwLCB0aGlzLm1vdXNlRG93blkgPSAwLCB0aGlzLm1vdXNlRG93biA9ICExLCB0aGlzLm1vdXNlT3ZlciA9ICExLCB0aGlzLm5lZWRSZXBhaW50ID0gITAsIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSBbXCJmcmFtZXNcIiwgXCJ3aGVlbFpvb21cIl1cclxuICAgICAgICB9LCBudWxsICE9IGMgJiYgdGhpcy5pbml0aWFsaXplKGMpO1xyXG4gICAgICAgIHZhciBvID0gITAsIHAgPSBudWxsO1xyXG4gICAgICAgIGRvY3VtZW50Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgfSwgdGhpcy5kaXNwYXRjaEV2ZW50VG9TY2VuZXMgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAoMCAhPSB0aGlzLmZyYW1lcyAmJiAodGhpcy5uZWVkUmVwYWludCA9ICEwKSwgMSA9PSB0aGlzLmVhZ2xlRXllLnZpc2libGUgJiYgLTEgIT0gYS5pbmRleE9mKFwibW91c2VcIikpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gYi54LCBkID0gYi55O1xyXG4gICAgICAgICAgICAgICAgaWYgKGMgPiB0aGlzLndpZHRoIC0gdGhpcy5lYWdsZUV5ZS53aWR0aCAmJiBkID4gdGhpcy5oZWlnaHQgLSB0aGlzLmVhZ2xlRXllLmhlaWdodClyZXR1cm4gdm9pZCB0aGlzLmVhZ2xlRXllLmV2ZW50SGFuZGxlcihhLCBiLCB0aGlzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIGlmICgxID09IGMudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gY1thICsgXCJIYW5kbGVyXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IGQpdGhyb3cgbmV3IEVycm9yKFwiRnVuY3Rpb24gbm90IGZvdW5kOlwiICsgYSArIFwiSGFuZGxlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICBkLmNhbGwoYywgYilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LCB0aGlzLmFkZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBiKyspaWYgKHRoaXMuY2hpbGRzW2JdID09PSBhKXJldHVybjtcclxuICAgICAgICAgICAgYS5hZGRUbyh0aGlzKSwgdGhpcy5jaGlsZHMucHVzaChhKVxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgPT0gYSl0aHJvdyBuZXcgRXJyb3IoXCJTdGFnZS5yZW1vdmXlh7rplJk6IOWPguaVsOS4um51bGwhXCIpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgYisrKWlmICh0aGlzLmNoaWxkc1tiXSA9PT0gYSlyZXR1cm4gYS5zdGFnZSA9IG51bGwsIHRoaXMuY2hpbGRzID0gdGhpcy5jaGlsZHMuZGVsKGIpLCB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gW11cclxuICAgICAgICB9LCB0aGlzLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMsIGQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgYi5jYWxsKGMsIGEpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGEsIGQpLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnVuc3Vic2NyaWJlKGEpXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcgYS51dGlsLk1lc3NhZ2VCdXNcclxuICAgICAgICB9LCB0aGlzLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlQnVzLnB1Ymxpc2goYSwgYiksIHRoaXNcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBxID0gXCJjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLG1vdXNld2hlZWwsdG91Y2hzdGFydCx0b3VjaG1vdmUsdG91Y2hlbmQsa2V5ZG93bixrZXl1cFwiLnNwbGl0KFwiLFwiKSwgciA9IHRoaXM7XHJcbiAgICAgICAgcS5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJbYV0gPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgbnVsbCAhPSBiID8gdGhpcy5hZGRFdmVudExpc3RlbmVyKGEsIGIpIDogdGhpcy5kaXNwYXRjaEV2ZW50KGEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSwgdGhpcy5zYXZlSW1hZ2VJbmZvID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmVhZ2xlRXllLmdldEltYWdlKGEsIGIpLCBkID0gd2luZG93Lm9wZW4oXCJhYm91dDpibGFua1wiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGQuZG9jdW1lbnQud3JpdGUoXCI8aW1nIHNyYz0nXCIgKyBjICsgXCInIGFsdD0nZnJvbSBjYW52YXMnLz5cIiksIHRoaXNcclxuICAgICAgICB9LCB0aGlzLnNhdmVBc0xvY2FsSW1hZ2UgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuZWFnbGVFeWUuZ2V0SW1hZ2UoYSwgYik7XHJcbiAgICAgICAgICAgIHJldHVybiBjLnJlcGxhY2UoXCJpbWFnZS9wbmdcIiwgXCJpbWFnZS9vY3RldC1zdHJlYW1cIiksIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYywgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG51bGwgIT0gdGhpcy5jYW52YXMgJiYgKHRoaXMuZ3JhcGhpY3Muc2F2ZSgpLCB0aGlzLmdyYXBoaWNzLmNsZWFyUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCksIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIDEgPT0gYS52aXNpYmxlICYmIGEucmVwYWludChuLmdyYXBoaWNzKVxyXG4gICAgICAgICAgICB9KSwgMSA9PSB0aGlzLmVhZ2xlRXllLnZpc2libGUgJiYgdGhpcy5lYWdsZUV5ZS5wYWludCh0aGlzKSwgdGhpcy5ncmFwaGljcy5yZXN0b3JlKCkpXHJcbiAgICAgICAgfSwgdGhpcy5yZXBhaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAwICE9IHRoaXMuZnJhbWVzICYmICh0aGlzLmZyYW1lcyA8IDAgJiYgMCA9PSB0aGlzLm5lZWRSZXBhaW50IHx8ICh0aGlzLnBhaW50KCksIHRoaXMuZnJhbWVzIDwgMCAmJiAodGhpcy5uZWVkUmVwYWludCA9ICExKSkpXHJcbiAgICAgICAgfSwgdGhpcy56b29tID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgMCAhPSBiLnZpc2libGUgJiYgYi56b29tKGEpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdGhpcy56b29tT3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgMCAhPSBiLnZpc2libGUgJiYgYi56b29tT3V0KGEpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdGhpcy56b29tSW4gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAwICE9IGIudmlzaWJsZSAmJiBiLnpvb21JbihhKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sIHRoaXMuY2VudGVyQW5kWm9vbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgMCAhPSBhLnZpc2libGUgJiYgYS5jZW50ZXJBbmRab29tKClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LCB0aGlzLnNldENlbnRlciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSBhIC0gYy5jYW52YXMud2lkdGggLyAyLCBmID0gYiAtIGMuY2FudmFzLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgICAgICBkLnRyYW5zbGF0ZVggPSAtZSwgZC50cmFuc2xhdGVZID0gLWZcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LCB0aGlzLmdldEJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHtsZWZ0OiBOdW1iZXIuTUFYX1ZBTFVFLCByaWdodDogTnVtYmVyLk1JTl9WQUxVRSwgdG9wOiBOdW1iZXIuTUFYX1ZBTFVFLCBib3R0b206IE51bWJlci5NSU5fVkFMVUV9O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBiLmdldEVsZW1lbnRzQm91bmQoKTtcclxuICAgICAgICAgICAgICAgIGMubGVmdCA8IGEubGVmdCAmJiAoYS5sZWZ0ID0gYy5sZWZ0LCBhLmxlZnROb2RlID0gYy5sZWZ0Tm9kZSksIGMudG9wIDwgYS50b3AgJiYgKGEudG9wID0gYy50b3AsIGEudG9wTm9kZSA9IGMudG9wTm9kZSksIGMucmlnaHQgPiBhLnJpZ2h0ICYmIChhLnJpZ2h0ID0gYy5yaWdodCwgYS5yaWdodE5vZGUgPSBjLnJpZ2h0Tm9kZSksIGMuYm90dG9tID4gYS5ib3R0b20gJiYgKGEuYm90dG9tID0gYy5ib3R0b20sIGEuYm90dG9tTm9kZSA9IGMuYm90dG9tTm9kZSlcclxuICAgICAgICAgICAgfSksIGEud2lkdGggPSBhLnJpZ2h0IC0gYS5sZWZ0LCBhLmhlaWdodCA9IGEuYm90dG9tIC0gYS50b3AsIGFcclxuICAgICAgICB9LCB0aGlzLnRvSnNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLCBjID0gJ3tcInZlcnNpb25cIjpcIicgKyBhLnZlcnNpb24gKyAnXCIsJztcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMubGVuZ3RoXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiW2FdO1xyXG4gICAgICAgICAgICAgICAgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZCAmJiAoZCA9ICdcIicgKyBkICsgJ1wiJyksIGMgKz0gJ1wiJyArIGEgKyAnXCI6JyArIGQgKyBcIixcIlxyXG4gICAgICAgICAgICB9KSwgYyArPSAnXCJjaGlsZHNcIjpbJywgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgYyArPSBhLnRvSnNvbigpXHJcbiAgICAgICAgICAgIH0pLCBjICs9IFwiXVwiLCBjICs9IFwifVwiXHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAwID09IG4uZnJhbWVzID8gc2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLCAxMDApIDogbi5mcmFtZXMgPCAwID8gKG4ucmVwYWludCgpLCBzZXRUaW1lb3V0KGFyZ3VtZW50cy5jYWxsZWUsIDFlMyAvIC1uLmZyYW1lcykpIDogKG4ucmVwYWludCgpLCBzZXRUaW1lb3V0KGFyZ3VtZW50cy5jYWxsZWUsIDFlMyAvIG4uZnJhbWVzKSlcclxuICAgICAgICB9KCksIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBuLm1vdXNld2hlZWwoZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gbnVsbCA9PSBhLndoZWVsRGVsdGEgPyBhLmRldGFpbCA6IGEud2hlZWxEZWx0YTtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gdGhpcy53aGVlbFpvb20gJiYgKGIgPiAwID8gdGhpcy56b29tSW4odGhpcy53aGVlbFpvb20pIDogdGhpcy56b29tT3V0KHRoaXMud2hlZWxab29tKSlcclxuICAgICAgICAgICAgfSksIG4ucGFpbnQoKVxyXG4gICAgICAgIH0sIDMwMCksIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBuLnBhaW50KClcclxuICAgICAgICB9LCAxZTMpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbi5wYWludCgpXHJcbiAgICAgICAgfSwgM2UzKVxyXG4gICAgfVxyXG5cclxuICAgIGMucHJvdG90eXBlID0ge1xyXG4gICAgICAgIGdldCB3aWR0aCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLndpZHRoXHJcbiAgICAgICAgfSwgZ2V0IGhlaWdodCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLmhlaWdodFxyXG4gICAgICAgIH0sIHNldCBjdXJzb3IoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSBhXHJcbiAgICAgICAgfSwgZ2V0IGN1cnNvcigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLnN0eWxlLmN1cnNvclxyXG4gICAgICAgIH0sIHNldCBtb2RlKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgYi5tb2RlID0gYVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0sIGEuU3RhZ2UgPSBjXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihjKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZChhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5iZWdpblBhdGgoKSwgZS5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMjM2LDAuNSlcIiwgZS5maWxsU3R5bGUgPSBcInJnYmEoMCwwLDIzNiwwLjEpXCIsIGUucmVjdChhLCBiLCBjLCBkKSwgZS5maWxsKCksIGUuc3Ryb2tlKCksIGUuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcgYS51dGlsLk1lc3NhZ2VCdXMsIHRoaXMuZWxlbWVudFR5cGUgPSBcInNjZW5lXCIsIHRoaXMuY2hpbGRzID0gW10sIHRoaXMuekluZGV4TWFwID0ge30sIHRoaXMuekluZGV4QXJyYXkgPSBbXSwgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBcIjI1NSwyNTUsMjU1XCIsIHRoaXMudmlzaWJsZSA9ICEwLCB0aGlzLmFscGhhID0gMCwgdGhpcy5zY2FsZVggPSAxLCB0aGlzLnNjYWxlWSA9IDEsIHRoaXMubW9kZSA9IGEuU2NlbmVNb2RlLm5vcm1hbCwgdGhpcy50cmFuc2xhdGUgPSAhMCwgdGhpcy50cmFuc2xhdGVYID0gMCwgdGhpcy50cmFuc2xhdGVZID0gMCwgdGhpcy5sYXN0VHJhbnNsYXRlWCA9IDAsIHRoaXMubGFzdFRyYW5zbGF0ZVkgPSAwLCB0aGlzLm1vdXNlRG93biA9ICExLCB0aGlzLm1vdXNlRG93blggPSBudWxsLCB0aGlzLm1vdXNlRG93blkgPSBudWxsLCB0aGlzLm1vdXNlRG93bkV2ZW50ID0gbnVsbCwgdGhpcy5hcmVhU2VsZWN0ID0gITAsIHRoaXMub3BlcmF0aW9ucyA9IFtdLCB0aGlzLnNlbGVjdGVkRWxlbWVudHMgPSBbXSwgdGhpcy5wYWludEFsbCA9ICExO1xyXG4gICAgICAgICAgICB2YXIgYyA9IFwiYmFja2dyb3VuZCxiYWNrZ3JvdW5kQ29sb3IsbW9kZSxwYWludEFsbCxhcmVhU2VsZWN0LHRyYW5zbGF0ZSx0cmFuc2xhdGVYLHRyYW5zbGF0ZVksbGFzdFRyYW5zbGF0ZWRYLGxhc3RUcmFuc2xhdGVkWSxhbHBoYSx2aXNpYmxlLHNjYWxlWCxzY2FsZVlcIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChjKVxyXG4gICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZSgpLCB0aGlzLnNldEJhY2tncm91bmQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tncm91bmQgPSBhXHJcbiAgICAgICAgfSwgdGhpcy5hZGRUbyA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhZ2UgIT09IGEgJiYgbnVsbCAhPSBhICYmICh0aGlzLnN0YWdlID0gYSlcclxuICAgICAgICB9LCBudWxsICE9IGMgJiYgKGMuYWRkKHRoaXMpLCB0aGlzLmFkZFRvKGMpKSwgdGhpcy5zaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSAhMFxyXG4gICAgICAgIH0sIHRoaXMuaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gITFcclxuICAgICAgICB9LCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy52aXNpYmxlICYmIG51bGwgIT0gdGhpcy5zdGFnZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGEuc2F2ZSgpLCB0aGlzLnBhaW50QmFja2dyb3VkKGEpLCBhLnJlc3RvcmUoKSwgYS5zYXZlKCksIGEuc2NhbGUodGhpcy5zY2FsZVgsIHRoaXMuc2NhbGVZKSwgMSA9PSB0aGlzLnRyYW5zbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5nZXRPZmZzZXRUcmFuc2xhdGUoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS50cmFuc2xhdGUoYi50cmFuc2xhdGVYLCBiLnRyYW5zbGF0ZVkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50Q2hpbGRzKGEpLCBhLnJlc3RvcmUoKSwgYS5zYXZlKCksIHRoaXMucGFpbnRPcGVyYXRpb25zKGEsIHRoaXMub3BlcmF0aW9ucyksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLnJlcGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAwICE9IHRoaXMudmlzaWJsZSAmJiB0aGlzLnBhaW50KGEpXHJcbiAgICAgICAgfSwgdGhpcy5wYWludEJhY2tncm91ZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIG51bGwgIT0gdGhpcy5iYWNrZ3JvdW5kID8gYS5kcmF3SW1hZ2UodGhpcy5iYWNrZ3JvdW5kLCAwLCAwLCBhLmNhbnZhcy53aWR0aCwgYS5jYW52YXMuaGVpZ2h0KSA6IChhLmJlZ2luUGF0aCgpLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuYmFja2dyb3VuZENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFJlY3QoMCwgMCwgYS5jYW52YXMud2lkdGgsIGEuY2FudmFzLmhlaWdodCksIGEuY2xvc2VQYXRoKCkpXHJcbiAgICAgICAgfSwgdGhpcy5nZXREaXNwbGF5ZWRFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYSA9IFtdLCBiID0gMDsgYiA8IHRoaXMuekluZGV4QXJyYXkubGVuZ3RoOyBiKyspZm9yICh2YXIgYyA9IHRoaXMuekluZGV4QXJyYXlbYl0sIGQgPSB0aGlzLnpJbmRleE1hcFtjXSwgZSA9IDA7IGUgPCBkLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGRbZV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzVmlzaWFibGUoZikgJiYgYS5wdXNoKGYpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGFcclxuICAgICAgICB9LCB0aGlzLmdldERpc3BsYXllZE5vZGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5jaGlsZHNbY107XHJcbiAgICAgICAgICAgICAgICBkIGluc3RhbmNlb2YgYS5Ob2RlICYmIHRoaXMuaXNWaXNpYWJsZShkKSAmJiBiLnB1c2goZClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYlxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRDaGlsZHMgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMuekluZGV4QXJyYXkubGVuZ3RoOyBjKyspZm9yICh2YXIgZCA9IHRoaXMuekluZGV4QXJyYXlbY10sIGUgPSB0aGlzLnpJbmRleE1hcFtkXSwgZiA9IDA7IGYgPCBlLmxlbmd0aDsgZisrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZyA9IGVbZl07XHJcbiAgICAgICAgICAgICAgICBpZiAoMSA9PSB0aGlzLnBhaW50QWxsIHx8IHRoaXMuaXNWaXNpYWJsZShnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChiLnNhdmUoKSwgMSA9PSBnLnRyYW5zZm9ybUFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBnLmdldENlbnRlckxvY2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIudHJhbnNsYXRlKGgueCwgaC55KSwgZy5yb3RhdGUgJiYgYi5yb3RhdGUoZy5yb3RhdGUpLCBnLnNjYWxlWCAmJiBnLnNjYWxlWSA/IGIuc2NhbGUoZy5zY2FsZVgsIGcuc2NhbGVZKSA6IGcuc2NhbGVYID8gYi5zY2FsZShnLnNjYWxlWCwgMSkgOiBnLnNjYWxlWSAmJiBiLnNjYWxlKDEsIGcuc2NhbGVZKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAxID09IGcuc2hhZG93ICYmIChiLnNoYWRvd0JsdXIgPSBnLnNoYWRvd0JsdXIsIGIuc2hhZG93Q29sb3IgPSBnLnNoYWRvd0NvbG9yLCBiLnNoYWRvd09mZnNldFggPSBnLnNoYWRvd09mZnNldFgsIGIuc2hhZG93T2Zmc2V0WSA9IGcuc2hhZG93T2Zmc2V0WSksIGcgaW5zdGFuY2VvZiBhLkludGVyYWN0aXZlRWxlbWVudCAmJiAoZy5zZWxlY3RlZCAmJiAxID09IGcuc2hvd1NlbGVjdGVkICYmIGcucGFpbnRTZWxlY3RlZChiKSwgMSA9PSBnLmlzTW91c2VPdmVyICYmIGcucGFpbnRNb3VzZW92ZXIoYikpLCBnLnBhaW50KGIpLCBiLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5nZXRPZmZzZXRUcmFuc2xhdGUgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoLCBjID0gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICBudWxsICE9IGEgJiYgXCJtb3ZlXCIgIT0gYSAmJiAoYiA9IGEuY2FudmFzLndpZHRoLCBjID0gYS5jYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgdmFyIGQgPSBiIC8gdGhpcy5zY2FsZVggLyAyLCBlID0gYyAvIHRoaXMuc2NhbGVZIC8gMiwgZiA9IHt0cmFuc2xhdGVYOiB0aGlzLnRyYW5zbGF0ZVggKyAoZCAtIGQgKiB0aGlzLnNjYWxlWCksIHRyYW5zbGF0ZVk6IHRoaXMudHJhbnNsYXRlWSArIChlIC0gZSAqIHRoaXMuc2NhbGVZKX07XHJcbiAgICAgICAgICAgIHJldHVybiBmXHJcbiAgICAgICAgfSwgdGhpcy5pc1Zpc2lhYmxlID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgaWYgKDEgIT0gYi52aXNpYmxlKXJldHVybiAhMTtcclxuICAgICAgICAgICAgaWYgKGIgaW5zdGFuY2VvZiBhLkxpbmspcmV0dXJuICEwO1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlKCksIGQgPSBiLnggKyBjLnRyYW5zbGF0ZVgsIGUgPSBiLnkgKyBjLnRyYW5zbGF0ZVk7XHJcbiAgICAgICAgICAgIGQgKj0gdGhpcy5zY2FsZVgsIGUgKj0gdGhpcy5zY2FsZVk7XHJcbiAgICAgICAgICAgIHZhciBmID0gZCArIGIud2lkdGggKiB0aGlzLnNjYWxlWCwgZyA9IGUgKyBiLmhlaWdodCAqIHRoaXMuc2NhbGVZO1xyXG4gICAgICAgICAgICByZXR1cm4gZCA+IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoIHx8IGUgPiB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgfHwgMCA+IGYgfHwgMCA+IGcgPyAhMSA6ICEwXHJcbiAgICAgICAgfSwgdGhpcy5wYWludE9wZXJhdGlvbnMgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGIubGVuZ3RoOyBjKyspYltjXShhKVxyXG4gICAgICAgIH0sIHRoaXMuZmluZEVsZW1lbnRzID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IFtdLCBjID0gMDsgYyA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgYysrKTEgPT0gYSh0aGlzLmNoaWxkc1tjXSkgJiYgYi5wdXNoKHRoaXMuY2hpbGRzW2NdKTtcclxuICAgICAgICAgICAgcmV0dXJuIGJcclxuICAgICAgICB9LCB0aGlzLmdldEVsZW1lbnRzQnlDbGFzcyA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmRFbGVtZW50cyhmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGIgaW5zdGFuY2VvZiBhXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdGhpcy5hZGRPcGVyYXRpb24gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRpb25zLnB1c2goYSksIHRoaXNcclxuICAgICAgICB9LCB0aGlzLmNsZWFyT3BlcmF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3BlcmF0aW9ucyA9IFtdLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5nZXRFbGVtZW50QnlYWSA9IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGQgPSBudWxsLCBlID0gdGhpcy56SW5kZXhBcnJheS5sZW5ndGggLSAxOyBlID49IDA7IGUtLSlmb3IgKHZhciBmID0gdGhpcy56SW5kZXhBcnJheVtlXSwgZyA9IHRoaXMuekluZGV4TWFwW2ZdLCBoID0gZy5sZW5ndGggLSAxOyBoID49IDA7IGgtLSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBnW2hdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgaW5zdGFuY2VvZiBhLkludGVyYWN0aXZlRWxlbWVudCAmJiB0aGlzLmlzVmlzaWFibGUoaSkgJiYgaS5pc0luQm91bmQoYiwgYykpcmV0dXJuIGQgPSBpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGRcclxuICAgICAgICB9LCB0aGlzLmFkZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLnB1c2goYSksIG51bGwgPT0gdGhpcy56SW5kZXhNYXBbYS56SW5kZXhdICYmICh0aGlzLnpJbmRleE1hcFthLnpJbmRleF0gPSBbXSwgdGhpcy56SW5kZXhBcnJheS5wdXNoKGEuekluZGV4KSwgdGhpcy56SW5kZXhBcnJheS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYSAtIGJcclxuICAgICAgICAgICAgfSkpLCB0aGlzLnpJbmRleE1hcFtcIlwiICsgYS56SW5kZXhdLnB1c2goYSlcclxuICAgICAgICB9LCB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gYS51dGlsLnJlbW92ZUZyb21BcnJheSh0aGlzLmNoaWxkcywgYik7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy56SW5kZXhNYXBbYi56SW5kZXhdO1xyXG4gICAgICAgICAgICBjICYmICh0aGlzLnpJbmRleE1hcFtiLnpJbmRleF0gPSBhLnV0aWwucmVtb3ZlRnJvbUFycmF5KGMsIGIpKSwgYi5yZW1vdmVIYW5kbGVyKHRoaXMpXHJcbiAgICAgICAgfSwgdGhpcy5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBiLnJlbW92ZUhhbmRsZXIoYSlcclxuICAgICAgICAgICAgfSksIHRoaXMuY2hpbGRzID0gW10sIHRoaXMub3BlcmF0aW9ucyA9IFtdLCB0aGlzLnpJbmRleEFycmF5ID0gW10sIHRoaXMuekluZGV4TWFwID0ge31cclxuICAgICAgICB9LCB0aGlzLmFkZFRvU2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRWxlbWVudHMucHVzaChhKVxyXG4gICAgICAgIH0sIHRoaXMuY2FuY2xlQWxsU2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5sZW5ndGg7IGIrKyl0aGlzLnNlbGVjdGVkRWxlbWVudHNbYl0udW5zZWxlY3RlZEhhbmRsZXIoYSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRFbGVtZW50cyA9IFtdXHJcbiAgICAgICAgfSwgdGhpcy5ub3RJblNlbGVjdGVkTm9kZXMgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5sZW5ndGg7IGIrKylpZiAoYSA9PT0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2JdKXJldHVybiAhMTtcclxuICAgICAgICAgICAgcmV0dXJuICEwXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVGcm9tU2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5sZW5ndGg7IGIrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHNbYl07XHJcbiAgICAgICAgICAgICAgICBhID09PSBjICYmICh0aGlzLnNlbGVjdGVkRWxlbWVudHMgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHMuZGVsKGIpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy50b1NjZW5lRXZlbnQgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IGEudXRpbC5jbG9uZShiKTtcclxuICAgICAgICAgICAgaWYgKGMueCAvPSB0aGlzLnNjYWxlWCwgYy55IC89IHRoaXMuc2NhbGVZLCAxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlKCk7XHJcbiAgICAgICAgICAgICAgICBjLnggLT0gZC50cmFuc2xhdGVYLCBjLnkgLT0gZC50cmFuc2xhdGVZXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGwgIT0gYy5keCAmJiAoYy5keCAvPSB0aGlzLnNjYWxlWCwgYy5keSAvPSB0aGlzLnNjYWxlWSksIG51bGwgIT0gdGhpcy5jdXJyZW50RWxlbWVudCAmJiAoYy50YXJnZXQgPSB0aGlzLmN1cnJlbnRFbGVtZW50KSwgYy5zY2VuZSA9IHRoaXMsIGNcclxuICAgICAgICB9LCB0aGlzLnNlbGVjdEVsZW1lbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IGUuZ2V0RWxlbWVudEJ5WFkoYS54LCBhLnkpO1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSBiKWlmIChhLnRhcmdldCA9IGIsIGIubW91c2Vkb3duSGFuZGVyKGEpLCBiLnNlbGVjdGVkSGFuZGxlcihhKSwgZS5ub3RJblNlbGVjdGVkTm9kZXMoYikpYS5jdHJsS2V5IHx8IGUuY2FuY2xlQWxsU2VsZWN0ZWQoKSwgZS5hZGRUb1NlbGVjdGVkKGIpOyBlbHNlIHtcclxuICAgICAgICAgICAgICAgIDEgPT0gYS5jdHJsS2V5ICYmIChiLnVuc2VsZWN0ZWRIYW5kbGVyKCksIHRoaXMucmVtb3ZlRnJvbVNlbGVjdGVkKGIpKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHNbY107XHJcbiAgICAgICAgICAgICAgICAgICAgZC5zZWxlY3RlZEhhbmRsZXIoYSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGEuY3RybEtleSB8fCBlLmNhbmNsZUFsbFNlbGVjdGVkKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsZW1lbnQgPSBiXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZWRvd25IYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChiKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubW91c2VEb3duID0gITAsIHRoaXMubW91c2VEb3duWCA9IGMueCwgdGhpcy5tb3VzZURvd25ZID0gYy55LCB0aGlzLm1vdXNlRG93bkV2ZW50ID0gYywgdGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLm5vcm1hbCl0aGlzLnNlbGVjdEVsZW1lbnQoYyksIChudWxsID09IHRoaXMuY3VycmVudEVsZW1lbnQgfHwgdGhpcy5jdXJyZW50RWxlbWVudCBpbnN0YW5jZW9mIGEuTGluaykgJiYgMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5sYXN0VHJhbnNsYXRlWCA9IHRoaXMudHJhbnNsYXRlWCwgdGhpcy5sYXN0VHJhbnNsYXRlWSA9IHRoaXMudHJhbnNsYXRlWSk7IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5kcmFnICYmIDEgPT0gdGhpcy50cmFuc2xhdGUpcmV0dXJuIHRoaXMubGFzdFRyYW5zbGF0ZVggPSB0aGlzLnRyYW5zbGF0ZVgsIHZvaWQodGhpcy5sYXN0VHJhbnNsYXRlWSA9IHRoaXMudHJhbnNsYXRlWSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGUgPT0gYS5TY2VuZU1vZGUuc2VsZWN0ID8gdGhpcy5zZWxlY3RFbGVtZW50KGMpIDogdGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLmVkaXQgJiYgKHRoaXMuc2VsZWN0RWxlbWVudChjKSwgKG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YgYS5MaW5rKSAmJiAxID09IHRoaXMudHJhbnNsYXRlICYmICh0aGlzLmxhc3RUcmFuc2xhdGVYID0gdGhpcy50cmFuc2xhdGVYLCB0aGlzLmxhc3RUcmFuc2xhdGVZID0gdGhpcy50cmFuc2xhdGVZKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRvd25cIiwgYylcclxuICAgICAgICB9LCB0aGlzLm1vdXNldXBIYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFnZS5jdXJzb3IgIT0gYS5Nb3VzZUN1cnNvci5ub3JtYWwgJiYgKHRoaXMuc3RhZ2UuY3Vyc29yID0gYS5Nb3VzZUN1cnNvci5ub3JtYWwpLCBlLmNsZWFyT3BlcmF0aW9ucygpO1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMudG9TY2VuZUV2ZW50KGIpO1xyXG4gICAgICAgICAgICBudWxsICE9IHRoaXMuY3VycmVudEVsZW1lbnQgJiYgKGMudGFyZ2V0ID0gZS5jdXJyZW50RWxlbWVudCwgdGhpcy5jdXJyZW50RWxlbWVudC5tb3VzZXVwSGFuZGxlcihjKSksIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNldXBcIiwgYyksIHRoaXMubW91c2VEb3duID0gITFcclxuICAgICAgICB9LCB0aGlzLmRyYWdFbGVtZW50cyA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuY3VycmVudEVsZW1lbnQgJiYgMSA9PSB0aGlzLmN1cnJlbnRFbGVtZW50LmRyYWdhYmxlKWZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRFbGVtZW50c1tjXTtcclxuICAgICAgICAgICAgICAgIGlmICgwICE9IGQuZHJhZ2FibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGEudXRpbC5jbG9uZShiKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnRhcmdldCA9IGQsIGQubW91c2VkcmFnSGFuZGxlcihlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZWRyYWdIYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChiKTtcclxuICAgICAgICAgICAgdGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLm5vcm1hbCA/IG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YgYS5MaW5rID8gMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBhLk1vdXNlQ3Vyc29yLmNsb3NlZF9oYW5kLCB0aGlzLnRyYW5zbGF0ZVggPSB0aGlzLmxhc3RUcmFuc2xhdGVYICsgYy5keCwgdGhpcy50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSArIGMuZHkpIDogdGhpcy5kcmFnRWxlbWVudHMoYykgOiB0aGlzLm1vZGUgPT0gYS5TY2VuZU1vZGUuZHJhZyA/IDEgPT0gdGhpcy50cmFuc2xhdGUgJiYgKHRoaXMuc3RhZ2UuY3Vyc29yID0gYS5Nb3VzZUN1cnNvci5jbG9zZWRfaGFuZCwgdGhpcy50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCArIGMuZHgsIHRoaXMudHJhbnNsYXRlWSA9IHRoaXMubGFzdFRyYW5zbGF0ZVkgKyBjLmR5KSA6IHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5zZWxlY3QgPyBudWxsICE9IHRoaXMuY3VycmVudEVsZW1lbnQgPyAxID09IHRoaXMuY3VycmVudEVsZW1lbnQuZHJhZ2FibGUgJiYgdGhpcy5kcmFnRWxlbWVudHMoYykgOiAxID09IHRoaXMuYXJlYVNlbGVjdCAmJiB0aGlzLmFyZWFTZWxlY3RIYW5kbGUoYykgOiB0aGlzLm1vZGUgPT0gYS5TY2VuZU1vZGUuZWRpdCAmJiAobnVsbCA9PSB0aGlzLmN1cnJlbnRFbGVtZW50IHx8IHRoaXMuY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBhLkxpbmsgPyAxID09IHRoaXMudHJhbnNsYXRlICYmICh0aGlzLnN0YWdlLmN1cnNvciA9IGEuTW91c2VDdXJzb3IuY2xvc2VkX2hhbmQsIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBjLmR4LCB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmxhc3RUcmFuc2xhdGVZICsgYy5keSkgOiB0aGlzLmRyYWdFbGVtZW50cyhjKSksIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZHJhZ1wiLCBjKVxyXG4gICAgICAgIH0sIHRoaXMuYXJlYVNlbGVjdEhhbmRsZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gYS5vZmZzZXRMZWZ0LCBjID0gYS5vZmZzZXRUb3AsIGYgPSB0aGlzLm1vdXNlRG93bkV2ZW50Lm9mZnNldExlZnQsIGcgPSB0aGlzLm1vdXNlRG93bkV2ZW50Lm9mZnNldFRvcCwgaCA9IGIgPj0gZiA/IGYgOiBiLCBpID0gYyA+PSBnID8gZyA6IGMsIGogPSBNYXRoLmFicyhhLmR4KSAqIHRoaXMuc2NhbGVYLCBrID0gTWF0aC5hYnMoYS5keSkgKiB0aGlzLnNjYWxlWSwgbCA9IG5ldyBkKGgsIGksIGosIGspO1xyXG4gICAgICAgICAgICBlLmNsZWFyT3BlcmF0aW9ucygpLmFkZE9wZXJhdGlvbihsKSwgYiA9IGEueCwgYyA9IGEueSwgZiA9IHRoaXMubW91c2VEb3duRXZlbnQueCwgZyA9IHRoaXMubW91c2VEb3duRXZlbnQueSwgaCA9IGIgPj0gZiA/IGYgOiBiLCBpID0gYyA+PSBnID8gZyA6IGMsIGogPSBNYXRoLmFicyhhLmR4KSwgayA9IE1hdGguYWJzKGEuZHkpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBtID0gaCArIGosIG4gPSBpICsgaywgbyA9IDA7IG8gPCBlLmNoaWxkcy5sZW5ndGg7IG8rKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHAgPSBlLmNoaWxkc1tvXTtcclxuICAgICAgICAgICAgICAgIHAueCA+IGggJiYgcC54ICsgcC53aWR0aCA8IG0gJiYgcC55ID4gaSAmJiBwLnkgKyBwLmhlaWdodCA8IG4gJiYgZS5ub3RJblNlbGVjdGVkTm9kZXMocCkgJiYgKHAuc2VsZWN0ZWRIYW5kbGVyKGEpLCBlLmFkZFRvU2VsZWN0ZWQocCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLm1vdXNlbW92ZUhhbmRsZXIgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlY29vcmQgPSB7eDogYi54LCB5OiBiLnl9O1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMudG9TY2VuZUV2ZW50KGIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLmRyYWcpcmV0dXJuIHZvaWQodGhpcy5zdGFnZS5jdXJzb3IgPSBhLk1vdXNlQ3Vyc29yLm9wZW5faGFuZCk7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5ub3JtYWwgPyB0aGlzLnN0YWdlLmN1cnNvciA9IGEuTW91c2VDdXJzb3Iubm9ybWFsIDogdGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLnNlbGVjdCAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBhLk1vdXNlQ3Vyc29yLm5vcm1hbCk7XHJcbiAgICAgICAgICAgIHZhciBkID0gZS5nZXRFbGVtZW50QnlYWShjLngsIGMueSk7XHJcbiAgICAgICAgICAgIG51bGwgIT0gZCA/IChlLm1vdXNlT3ZlcmVsZW1lbnQgJiYgZS5tb3VzZU92ZXJlbGVtZW50ICE9PSBkICYmIChjLnRhcmdldCA9IGQsIGUubW91c2VPdmVyZWxlbWVudC5tb3VzZW91dEhhbmRsZXIoYykpLCBlLm1vdXNlT3ZlcmVsZW1lbnQgPSBkLCAwID09IGQuaXNNb3VzZU92ZXIgPyAoYy50YXJnZXQgPSBkLCBkLm1vdXNlb3ZlckhhbmRsZXIoYyksIGUuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBjKSkgOiAoYy50YXJnZXQgPSBkLCBkLm1vdXNlbW92ZUhhbmRsZXIoYyksIGUuZGlzcGF0Y2hFdmVudChcIm1vdXNlbW92ZVwiLCBjKSkpIDogZS5tb3VzZU92ZXJlbGVtZW50ID8gKGMudGFyZ2V0ID0gZCwgZS5tb3VzZU92ZXJlbGVtZW50Lm1vdXNlb3V0SGFuZGxlcihjKSwgZS5tb3VzZU92ZXJlbGVtZW50ID0gbnVsbCwgZS5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYykpIDogKGMudGFyZ2V0ID0gbnVsbCwgZS5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGMpKVxyXG4gICAgICAgIH0sIHRoaXMubW91c2VvdmVySGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy50b1NjZW5lRXZlbnQoYSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBiKVxyXG4gICAgICAgIH0sIHRoaXMubW91c2VvdXRIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYilcclxuICAgICAgICB9LCB0aGlzLmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy50b1NjZW5lRXZlbnQoYSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsZW1lbnQgJiYgKGIudGFyZ2V0ID0gdGhpcy5jdXJyZW50RWxlbWVudCwgdGhpcy5jdXJyZW50RWxlbWVudC5jbGlja0hhbmRsZXIoYikpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJjbGlja1wiLCBiKVxyXG4gICAgICAgIH0sIHRoaXMuZGJjbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMudG9TY2VuZUV2ZW50KGEpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50ID8gKGIudGFyZ2V0ID0gdGhpcy5jdXJyZW50RWxlbWVudCwgdGhpcy5jdXJyZW50RWxlbWVudC5kYmNsaWNrSGFuZGxlcihiKSkgOiBlLmNhbmNsZUFsbFNlbGVjdGVkKCksIHRoaXMuZGlzcGF0Y2hFdmVudChcImRiY2xpY2tcIiwgYilcclxuICAgICAgICB9LCB0aGlzLm1vdXNld2hlZWxIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2V3aGVlbFwiLCBiKVxyXG4gICAgICAgIH0sIHRoaXMudG91Y2hzdGFydCA9IHRoaXMubW91c2Vkb3duSGFuZGVyLCB0aGlzLnRvdWNobW92ZSA9IHRoaXMubW91c2VkcmFnSGFuZGxlciwgdGhpcy50b3VjaGVuZCA9IHRoaXMubW91c2Vkb3duSGFuZGVyLCB0aGlzLmtleWRvd25IYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwia2V5ZG93blwiLCBhKVxyXG4gICAgICAgIH0sIHRoaXMua2V5dXBIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwia2V5dXBcIiwgYSlcclxuICAgICAgICB9LCB0aGlzLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMsIGQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgYi5jYWxsKGMsIGEpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGEsIGQpLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnVuc3Vic2NyaWJlKGEpXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcgYS51dGlsLk1lc3NhZ2VCdXNcclxuICAgICAgICB9LCB0aGlzLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlQnVzLnB1Ymxpc2goYSwgYiksIHRoaXNcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBmID0gXCJjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLG1vdXNld2hlZWwsdG91Y2hzdGFydCx0b3VjaG1vdmUsdG91Y2hlbmQsa2V5ZG93bixrZXl1cFwiLnNwbGl0KFwiLFwiKSwgZyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGYuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBnW2FdID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gYiA/IHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihhLCBiKSA6IHRoaXMuZGlzcGF0Y2hFdmVudChhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSksIHRoaXMuem9vbSA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIG51bGwgIT0gYSAmJiAwICE9IGEgJiYgKHRoaXMuc2NhbGVYID0gYSksIG51bGwgIT0gYiAmJiAwICE9IGIgJiYgKHRoaXMuc2NhbGVZID0gYilcclxuICAgICAgICB9LCB0aGlzLnpvb21PdXQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAwICE9IGEgJiYgKG51bGwgPT0gYSAmJiAoYSA9IC44KSwgdGhpcy5zY2FsZVggLz0gYSwgdGhpcy5zY2FsZVkgLz0gYSlcclxuICAgICAgICB9LCB0aGlzLnpvb21JbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIDAgIT0gYSAmJiAobnVsbCA9PSBhICYmIChhID0gLjgpLCB0aGlzLnNjYWxlWCAqPSBhLCB0aGlzLnNjYWxlWSAqPSBhKVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0Qm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7bGVmdDogMCwgdG9wOiAwLCByaWdodDogdGhpcy5zdGFnZS5jYW52YXMud2lkdGgsIGJvdHRvbTogdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0LCB3aWR0aDogdGhpcy5zdGFnZS5jYW52YXMud2lkdGgsIGhlaWdodDogdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0fVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0RWxlbWVudHNCb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEudXRpbC5nZXRFbGVtZW50c0JvdW5kKHRoaXMuY2hpbGRzKVxyXG4gICAgICAgIH0sIHRoaXMudHJhbnNsYXRlVG9DZW50ZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMuZ2V0RWxlbWVudHNCb3VuZCgpLCBjID0gdGhpcy5zdGFnZS5jYW52YXMud2lkdGggLyAyIC0gKGIubGVmdCArIGIucmlnaHQpIC8gMiwgZCA9IHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodCAvIDIgLSAoYi50b3AgKyBiLmJvdHRvbSkgLyAyO1xyXG4gICAgICAgICAgICBhICYmIChjID0gYS5jYW52YXMud2lkdGggLyAyIC0gKGIubGVmdCArIGIucmlnaHQpIC8gMiwgZCA9IGEuY2FudmFzLmhlaWdodCAvIDIgLSAoYi50b3AgKyBiLmJvdHRvbSkgLyAyKSwgdGhpcy50cmFuc2xhdGVYID0gYywgdGhpcy50cmFuc2xhdGVZID0gZFxyXG4gICAgICAgIH0sIHRoaXMuc2V0Q2VudGVyID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBhIC0gdGhpcy5zdGFnZS5jYW52YXMud2lkdGggLyAyLCBkID0gYiAtIHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IC1jLCB0aGlzLnRyYW5zbGF0ZVkgPSAtZFxyXG4gICAgICAgIH0sIHRoaXMuY2VudGVyQW5kWm9vbSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zbGF0ZVRvQ2VudGVyKGMpLCBudWxsID09IGEgfHwgbnVsbCA9PSBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0RWxlbWVudHNCb3VuZCgpLCBlID0gZC5yaWdodCAtIGQubGVmdCwgZiA9IGQuYm90dG9tIC0gZC50b3AsIGcgPSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCAvIGUsIGggPSB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyBmO1xyXG4gICAgICAgICAgICAgICAgYyAmJiAoZyA9IGMuY2FudmFzLndpZHRoIC8gZSwgaCA9IGMuY2FudmFzLmhlaWdodCAvIGYpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBNYXRoLm1pbihnLCBoKTtcclxuICAgICAgICAgICAgICAgIGlmIChpID4gMSlyZXR1cm47XHJcbiAgICAgICAgICAgICAgICB0aGlzLnpvb20oaSwgaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnpvb20oYSwgYilcclxuICAgICAgICB9LCB0aGlzLmdldENlbnRlckxvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge3g6IGUuc3RhZ2UuY2FudmFzLndpZHRoIC8gMiwgeTogZS5zdGFnZS5jYW52YXMuaGVpZ2h0IC8gMn1cclxuICAgICAgICB9LCB0aGlzLmRvTGF5b3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYSAmJiBhKHRoaXMsIHRoaXMuY2hpbGRzKVxyXG4gICAgICAgIH0sIHRoaXMudG9Kc29uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHRoaXMsIGIgPSBcIntcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMubGVuZ3RoXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGFbY107XHJcbiAgICAgICAgICAgICAgICBcImJhY2tncm91bmRcIiA9PSBjICYmIChkID0gYS5fYmFja2dyb3VuZC5zcmMpLCBcInN0cmluZ1wiID09IHR5cGVvZiBkICYmIChkID0gJ1wiJyArIGQgKyAnXCInKSwgYiArPSAnXCInICsgYyArICdcIjonICsgZCArIFwiLFwiXHJcbiAgICAgICAgICAgIH0pLCBiICs9ICdcImNoaWxkc1wiOlsnO1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2hpbGRzLmxlbmd0aDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEsIGQpIHtcclxuICAgICAgICAgICAgICAgIGIgKz0gYS50b0pzb24oKSwgYyA+IGQgKyAxICYmIChiICs9IFwiLFwiKVxyXG4gICAgICAgICAgICB9KSwgYiArPSBcIl1cIiwgYiArPSBcIn1cIlxyXG4gICAgICAgIH0sIGVcclxuICAgIH1cclxuXHJcbiAgICBiLnByb3RvdHlwZSA9IG5ldyBhLkVsZW1lbnQ7XHJcbiAgICB2YXIgYyA9IHt9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYi5wcm90b3R5cGUsIHtcclxuICAgICAgICBiYWNrZ3JvdW5kOiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tncm91bmRcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGNbYV07XHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbCA9PSBiICYmIChiID0gbmV3IEltYWdlLCBiLnNyYyA9IGEsIGIub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjW2FdID0gYlxyXG4gICAgICAgICAgICAgICAgICAgIH0pLCB0aGlzLl9iYWNrZ3JvdW5kID0gYlxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHRoaXMuX2JhY2tncm91bmQgPSBhXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KSwgYS5TY2VuZSA9IGJcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKCkge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJkaXNwbGF5RWxlbWVudFwiLCB0aGlzLnggPSAwLCB0aGlzLnkgPSAwLCB0aGlzLndpZHRoID0gMzIsIHRoaXMuaGVpZ2h0ID0gMzIsIHRoaXMudmlzaWJsZSA9ICEwLCB0aGlzLmFscGhhID0gMSwgdGhpcy5yb3RhdGUgPSAwLCB0aGlzLnNjYWxlWCA9IDEsIHRoaXMuc2NhbGVZID0gMSwgdGhpcy5zdHJva2VDb2xvciA9IFwiMjIsMTI0LDI1NVwiLCB0aGlzLmJvcmRlckNvbG9yID0gXCIyMiwxMjQsMjU1XCIsIHRoaXMuZmlsbENvbG9yID0gXCIyMiwxMjQsMjU1XCIsIHRoaXMuc2hhZG93ID0gITEsIHRoaXMuc2hhZG93Qmx1ciA9IDUsIHRoaXMuc2hhZG93Q29sb3IgPSBcInJnYmEoMCwwLDAsMC41KVwiLCB0aGlzLnNoYWRvd09mZnNldFggPSAzLCB0aGlzLnNoYWRvd09mZnNldFkgPSA2LCB0aGlzLnRyYW5zZm9ybUFibGUgPSAhMSwgdGhpcy56SW5kZXggPSAwO1xyXG4gICAgICAgICAgICB2YXIgYSA9IFwieCx5LHdpZHRoLGhlaWdodCx2aXNpYmxlLGFscGhhLHJvdGF0ZSxzY2FsZVgsc2NhbGVZLHN0cm9rZUNvbG9yLGZpbGxDb2xvcixzaGFkb3csc2hhZG93Q29sb3Isc2hhZG93T2Zmc2V0WCxzaGFkb3dPZmZzZXRZLHRyYW5zZm9ybUFibGUsekluZGV4XCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoYSlcclxuICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoKSwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5yZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpLCBhLmZpbGwoKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7eDogdGhpcy54LCB5OiB0aGlzLnl9XHJcbiAgICAgICAgfSwgdGhpcy5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnggPSBhLCB0aGlzLnkgPSBiLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5nZXRDZW50ZXJMb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHt4OiB0aGlzLnggKyB0aGlzLndpZHRoIC8gMiwgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyfVxyXG4gICAgICAgIH0sIHRoaXMuc2V0Q2VudGVyTG9jYXRpb24gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ID0gYSAtIHRoaXMud2lkdGggLyAyLCB0aGlzLnkgPSBiIC0gdGhpcy5oZWlnaHQgLyAyLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5nZXRTaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge3dpZHRoOiB0aGlzLndpZHRoLCBoZWlnaHQ6IHRoaXMuaGVpdGh9XHJcbiAgICAgICAgfSwgdGhpcy5zZXRTaXplID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMud2lkdGggPSBhLCB0aGlzLmhlaWdodCA9IGIsIHRoaXNcclxuICAgICAgICB9LCB0aGlzLmdldEJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge2xlZnQ6IHRoaXMueCwgdG9wOiB0aGlzLnksIHJpZ2h0OiB0aGlzLnggKyB0aGlzLndpZHRoLCBib3R0b206IHRoaXMueSArIHRoaXMuaGVpZ2h0LCB3aWR0aDogdGhpcy53aWR0aCwgaGVpZ2h0OiB0aGlzLmhlaWdodH1cclxuICAgICAgICB9LCB0aGlzLnNldEJvdW5kID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0TG9jYXRpb24oYSwgYiksIHRoaXMuc2V0U2l6ZShjLCBkKSwgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuZ2V0RGlzcGxheUJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge2xlZnQ6IHRoaXMueCwgdG9wOiB0aGlzLnksIHJpZ2h0OiB0aGlzLnggKyB0aGlzLndpZHRoICogdGhpcy5zY2FsZVgsIGJvdHRvbTogdGhpcy55ICsgdGhpcy5oZWlnaHQgKiB0aGlzLnNjYWxlWX1cclxuICAgICAgICB9LCB0aGlzLmdldERpc3BsYXlTaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge3dpZHRoOiB0aGlzLndpZHRoICogdGhpcy5zY2FsZVgsIGhlaWdodDogdGhpcy5oZWlnaHQgKiB0aGlzLnNjYWxlWX1cclxuICAgICAgICB9LCB0aGlzLmdldFBvc2l0aW9uID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIsIGMgPSB0aGlzLmdldEJvdW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBcIlRvcF9MZWZ0XCIgPT0gYSA/IGIgPSB7eDogYy5sZWZ0LCB5OiBjLnRvcH0gOiBcIlRvcF9DZW50ZXJcIiA9PSBhID8gYiA9IHt4OiB0aGlzLmN4LCB5OiBjLnRvcH0gOiBcIlRvcF9SaWdodFwiID09IGEgPyBiID0ge3g6IGMucmlnaHQsIHk6IGMudG9wfSA6IFwiTWlkZGxlX0xlZnRcIiA9PSBhID8gYiA9IHtcclxuICAgICAgICAgICAgICAgIHg6IGMubGVmdCxcclxuICAgICAgICAgICAgICAgIHk6IHRoaXMuY3lcclxuICAgICAgICAgICAgfSA6IFwiTWlkZGxlX0NlbnRlclwiID09IGEgPyBiID0ge3g6IHRoaXMuY3gsIHk6IHRoaXMuY3l9IDogXCJNaWRkbGVfUmlnaHRcIiA9PSBhID8gYiA9IHt4OiBjLnJpZ2h0LCB5OiB0aGlzLmN5fSA6IFwiQm90dG9tX0xlZnRcIiA9PSBhID8gYiA9IHtcclxuICAgICAgICAgICAgICAgIHg6IGMubGVmdCxcclxuICAgICAgICAgICAgICAgIHk6IGMuYm90dG9tXHJcbiAgICAgICAgICAgIH0gOiBcIkJvdHRvbV9DZW50ZXJcIiA9PSBhID8gYiA9IHt4OiB0aGlzLmN4LCB5OiBjLmJvdHRvbX0gOiBcIkJvdHRvbV9SaWdodFwiID09IGEgJiYgKGIgPSB7eDogYy5yaWdodCwgeTogYy5ib3R0b219KSwgYlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJpbnRlcmFjdGl2ZUVsZW1lbnRcIiwgdGhpcy5kcmFnYWJsZSA9ICExLCB0aGlzLnNlbGVjdGVkID0gITEsIHRoaXMuc2hvd1NlbGVjdGVkID0gITAsIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbiA9IG51bGwsIHRoaXMuaXNNb3VzZU92ZXIgPSAhMTtcclxuICAgICAgICAgICAgdmFyIGEgPSBcImRyYWdhYmxlLHNlbGVjdGVkLHNob3dTZWxlY3RlZCxpc01vdXNlT3ZlclwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuY29uY2F0KGEpXHJcbiAgICAgICAgfSwgdGhpcy5pbml0aWFsaXplKCksIHRoaXMucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIDAgIT0gdGhpcy5zaG93U2VsZWN0ZWQgJiYgKGEuc2F2ZSgpLCBhLmJlZ2luUGF0aCgpLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKDE2OCwyMDIsMjU1LCAwLjkpXCIsIGEuZmlsbFN0eWxlID0gXCJyZ2JhKDE2OCwyMDIsMjM2LDAuNylcIiwgYS5yZWN0KC10aGlzLndpZHRoIC8gMiAtIDMsIC10aGlzLmhlaWdodCAvIDIgLSAzLCB0aGlzLndpZHRoICsgNiwgdGhpcy5oZWlnaHQgKyA2KSwgYS5maWxsKCksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpKVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRNb3VzZW92ZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYWludFNlbGVjdGVkKGEpXHJcbiAgICAgICAgfSwgdGhpcy5pc0luQm91bmQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gYSA+IHRoaXMueCAmJiBhIDwgdGhpcy54ICsgdGhpcy53aWR0aCAqIE1hdGguYWJzKHRoaXMuc2NhbGVYKSAmJiBiID4gdGhpcy55ICYmIGIgPCB0aGlzLnkgKyB0aGlzLmhlaWdodCAqIE1hdGguYWJzKHRoaXMuc2NhbGVZKVxyXG4gICAgICAgIH0sIHRoaXMuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gITAsIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbiA9IHt4OiB0aGlzLngsIHk6IHRoaXMueX1cclxuICAgICAgICB9LCB0aGlzLnVuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gITEsIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbiA9IG51bGxcclxuICAgICAgICB9LCB0aGlzLmRiY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwiZGJjbGlja1wiLCBhKVxyXG4gICAgICAgIH0sIHRoaXMuY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwiY2xpY2tcIiwgYSlcclxuICAgICAgICB9LCB0aGlzLm1vdXNlZG93bkhhbmRlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZG93blwiLCBhKVxyXG4gICAgICAgIH0sIHRoaXMubW91c2V1cEhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZXVwXCIsIGEpXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZW92ZXJIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5pc01vdXNlT3ZlciA9ICEwLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW92ZXJcIiwgYSlcclxuICAgICAgICB9LCB0aGlzLm1vdXNlbW92ZUhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW1vdmVcIiwgYSlcclxuICAgICAgICB9LCB0aGlzLm1vdXNlb3V0SGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNb3VzZU92ZXIgPSAhMSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYSlcclxuICAgICAgICB9LCB0aGlzLm1vdXNlZHJhZ0hhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keCwgYyA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi55ICsgYS5keTtcclxuICAgICAgICAgICAgdGhpcy5zZXRMb2NhdGlvbihiLCBjKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VkcmFnXCIsIGEpXHJcbiAgICAgICAgfSwgdGhpcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGIsIGMpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSB0aGlzLCBlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGMuY2FsbChkLCBhKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlQnVzIHx8ICh0aGlzLm1lc3NhZ2VCdXMgPSBuZXcgYS51dGlsLk1lc3NhZ2VCdXMpLCB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGIsIGUpLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUJ1cyA/ICh0aGlzLm1lc3NhZ2VCdXMucHVibGlzaChhLCBiKSwgdGhpcykgOiBudWxsXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnVuc3Vic2NyaWJlKGEpXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcgYS51dGlsLk1lc3NhZ2VCdXNcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBiID0gXCJjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kXCIuc3BsaXQoXCIsXCIpLCBkID0gdGhpcztcclxuICAgICAgICBiLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZFthXSA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBudWxsICE9IGIgPyB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoYSwgYikgOiB0aGlzLmRpc3BhdGNoRXZlbnQoYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5lZGl0QWJsZSA9ICExLCB0aGlzLnNlbGVjdGVkUG9pbnQgPSBudWxsXHJcbiAgICAgICAgfSwgdGhpcy5nZXRDdHJsUG9zaXRpb24gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IDUsIGMgPSA1LCBkID0gdGhpcy5nZXRQb3NpdGlvbihhKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtsZWZ0OiBkLnggLSBiLCB0b3A6IGQueSAtIGMsIHJpZ2h0OiBkLnggKyBiLCBib3R0b206IGQueSArIGN9XHJcbiAgICAgICAgfSwgdGhpcy5zZWxlY3RlZEhhbmRsZXIgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICBkLnByb3RvdHlwZS5zZWxlY3RlZEhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5zZWxlY3RlZFNpemUgPSB7d2lkdGg6IHRoaXMud2lkdGgsIGhlaWdodDogdGhpcy5oZWlnaHR9LCBiLnNjZW5lLm1vZGUgPT0gYS5TY2VuZU1vZGUuZWRpdCAmJiAodGhpcy5lZGl0QWJsZSA9ICEwKVxyXG4gICAgICAgIH0sIHRoaXMudW5zZWxlY3RlZEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGQucHJvdG90eXBlLnVuc2VsZWN0ZWRIYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuc2VsZWN0ZWRTaXplID0gbnVsbCwgdGhpcy5lZGl0QWJsZSA9ICExXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYiA9IFtcIlRvcF9MZWZ0XCIsIFwiVG9wX0NlbnRlclwiLCBcIlRvcF9SaWdodFwiLCBcIk1pZGRsZV9MZWZ0XCIsIFwiTWlkZGxlX1JpZ2h0XCIsIFwiQm90dG9tX0xlZnRcIiwgXCJCb3R0b21fQ2VudGVyXCIsIFwiQm90dG9tX1JpZ2h0XCJdO1xyXG4gICAgICAgIHRoaXMucGFpbnRDdHJsID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy5lZGl0QWJsZSkge1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGIubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0Q3RybFBvc2l0aW9uKGJbY10pO1xyXG4gICAgICAgICAgICAgICAgICAgIGQubGVmdCAtPSB0aGlzLmN4LCBkLnJpZ2h0IC09IHRoaXMuY3gsIGQudG9wIC09IHRoaXMuY3ksIGQuYm90dG9tIC09IHRoaXMuY3k7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBkLnJpZ2h0IC0gZC5sZWZ0LCBmID0gZC5ib3R0b20gLSBkLnRvcDtcclxuICAgICAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKDAsMCwwLDAuOClcIiwgYS5yZWN0KGQubGVmdCwgZC50b3AsIGUsIGYpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBhLmJlZ2luUGF0aCgpLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKDI1NSwyNTUsMjU1LDAuMylcIiwgYS5yZWN0KGQubGVmdCArIDEsIGQudG9wICsgMSwgZSAtIDIsIGYgLSAyKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYS5yZXN0b3JlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMuaXNJbkJvdW5kID0gZnVuY3Rpb24gKGEsIGMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRQb2ludCA9IG51bGwsIDEgPT0gdGhpcy5lZGl0QWJsZSlmb3IgKHZhciBlID0gMDsgZSA8IGIubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gdGhpcy5nZXRDdHJsUG9zaXRpb24oYltlXSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYSA+IGYubGVmdCAmJiBhIDwgZi5yaWdodCAmJiBjID4gZi50b3AgJiYgYyA8IGYuYm90dG9tKXJldHVybiB0aGlzLnNlbGVjdGVkUG9pbnQgPSBiW2VdLCAhMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBkLnByb3RvdHlwZS5pc0luQm91bmQuYXBwbHkodGhpcywgYXJndW1lbnRzKVxyXG4gICAgICAgIH0sIHRoaXMubW91c2VkcmFnSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueCArIGEuZHgsIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldExvY2F0aW9uKGIsIGMpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRyYWdcIiwgYSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChcIlRvcF9MZWZ0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCAtIGEuZHgsIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgLSBhLmR5LCBiID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnggKyBhLmR4LCBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGIgPCB0aGlzLnggKyB0aGlzLndpZHRoICYmICh0aGlzLnggPSBiLCB0aGlzLndpZHRoID0gZCksIGMgPCB0aGlzLnkgKyB0aGlzLmhlaWdodCAmJiAodGhpcy55ID0gYywgdGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIlRvcF9DZW50ZXJcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCAtIGEuZHksIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA8IHRoaXMueSArIHRoaXMuaGVpZ2h0ICYmICh0aGlzLnkgPSBjLCB0aGlzLmhlaWdodCA9IGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiVG9wX1JpZ2h0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCArIGEuZHgsIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA8IHRoaXMueSArIHRoaXMuaGVpZ2h0ICYmICh0aGlzLnkgPSBjLCB0aGlzLmhlaWdodCA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCAtIGEuZHkpLCBkID4gMSAmJiAodGhpcy53aWR0aCA9IGQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiTWlkZGxlX0xlZnRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoIC0gYS5keCwgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICAgICAgICAgICAgICBiIDwgdGhpcy54ICsgdGhpcy53aWR0aCAmJiAodGhpcy54ID0gYiksIGQgPiAxICYmICh0aGlzLndpZHRoID0gZClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJNaWRkbGVfUmlnaHRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoICsgYS5keDtcclxuICAgICAgICAgICAgICAgICAgICBkID4gMSAmJiAodGhpcy53aWR0aCA9IGQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiQm90dG9tX0xlZnRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoIC0gYS5keCwgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICAgICAgICAgICAgICBkID4gMSAmJiAodGhpcy54ID0gYiwgdGhpcy53aWR0aCA9IGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICBlID4gMSAmJiAodGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIkJvdHRvbV9DZW50ZXJcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA+IDEgJiYgKHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJCb3R0b21fUmlnaHRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoICsgYS5keDtcclxuICAgICAgICAgICAgICAgICAgICBkID4gMSAmJiAodGhpcy53aWR0aCA9IGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICBlID4gMSAmJiAodGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwicmVzaXplXCIsIGEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYi5wcm90b3R5cGUgPSBuZXcgYS5FbGVtZW50LCBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhiLnByb3RvdHlwZSwge1xyXG4gICAgICAgIGN4OiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGggLyAyXHJcbiAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMueCA9IGEgLSB0aGlzLndpZHRoIC8gMlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgY3k6IHtcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyXHJcbiAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMueSA9IGEgLSB0aGlzLmhlaWdodCAvIDJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pLCBjLnByb3RvdHlwZSA9IG5ldyBiLCBkLnByb3RvdHlwZSA9IG5ldyBjLCBhLkRpc3BsYXlFbGVtZW50ID0gYiwgYS5JbnRlcmFjdGl2ZUVsZW1lbnQgPSBjLCBhLkVkaXRhYmxlRWxlbWVudCA9IGRcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKGMpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICBiLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuZWxlbWVudFR5cGUgPSBcIm5vZGVcIiwgdGhpcy56SW5kZXggPSBhLnpJbmRleF9Ob2RlLCB0aGlzLnRleHQgPSBjLCB0aGlzLmZvbnQgPSBcIjEycHggQ29uc29sYXNcIiwgdGhpcy5mb250Q29sb3IgPSBcIjI1NSwyNTUsMjU1XCIsIHRoaXMuYm9yZGVyV2lkdGggPSAwLCB0aGlzLmJvcmRlckNvbG9yID0gXCIyNTUsMjU1LDI1NVwiLCB0aGlzLmJvcmRlclJhZGl1cyA9IG51bGwsIHRoaXMuZHJhZ2FibGUgPSAhMCwgdGhpcy50ZXh0UG9zaXRpb24gPSBcIkJvdHRvbV9DZW50ZXJcIiwgdGhpcy50ZXh0T2Zmc2V0WCA9IDAsIHRoaXMudGV4dE9mZnNldFkgPSAwLCB0aGlzLnRyYW5zZm9ybUFibGUgPSAhMCwgdGhpcy5pbkxpbmtzID0gbnVsbCwgdGhpcy5vdXRMaW5rcyA9IG51bGw7XHJcbiAgICAgICAgICAgIHZhciBkID0gXCJ0ZXh0LGZvbnQsZm9udENvbG9yLHRleHRQb3NpdGlvbix0ZXh0T2Zmc2V0WCx0ZXh0T2Zmc2V0WSxib3JkZXJSYWRpdXNcIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChkKVxyXG4gICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZShjKSwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGEuZ2xvYmFsQWxwaGE7XHJcbiAgICAgICAgICAgICAgICBhLmdsb2JhbEFscGhhID0gdGhpcy5hbHBoYSwgbnVsbCAhPSB0aGlzLmFsYXJtSW1hZ2UgJiYgbnVsbCAhPSB0aGlzLmFsYXJtID8gYS5kcmF3SW1hZ2UodGhpcy5hbGFybUltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KSA6IGEuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpLCBhLmdsb2JhbEFscGhhID0gYlxyXG4gICAgICAgICAgICB9IGVsc2UgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBudWxsID09IHRoaXMuYm9yZGVyUmFkaXVzIHx8IDAgPT0gdGhpcy5ib3JkZXJSYWRpdXMgPyBhLnJlY3QoLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCkgOiBhLkpUb3BvUm91bmRSZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuYm9yZGVyUmFkaXVzKSwgYS5maWxsKCksIGEuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRUZXh0KGEpLCB0aGlzLnBhaW50Qm9yZGVyKGEpLCB0aGlzLnBhaW50Q3RybChhKSwgdGhpcy5wYWludEFsYXJtVGV4dChhKVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRBbGFybVRleHQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmFsYXJtICYmIFwiXCIgIT0gdGhpcy5hbGFybSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmFsYXJtQ29sb3IgfHwgXCIyNTUsMCwwXCIsIGMgPSB0aGlzLmFsYXJtQWxwaGEgfHwgLjU7XHJcbiAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmFsYXJtRm9udCB8fCBcIjEwcHgg5b6u6L2v6ZuF6buRXCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGEubWVhc3VyZVRleHQodGhpcy5hbGFybSkud2lkdGggKyA2LCBlID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aCArIDYsIGYgPSB0aGlzLndpZHRoIC8gMiAtIGQgLyAyLCBnID0gLXRoaXMuaGVpZ2h0IC8gMiAtIGUgLSA4O1xyXG4gICAgICAgICAgICAgICAgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIGIgKyBcIiwgXCIgKyBjICsgXCIpXCIsIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgYiArIFwiLCBcIiArIGMgKyBcIilcIiwgYS5saW5lQ2FwID0gXCJyb3VuZFwiLCBhLmxpbmVXaWR0aCA9IDEsIGEubW92ZVRvKGYsIGcpLCBhLmxpbmVUbyhmICsgZCwgZyksIGEubGluZVRvKGYgKyBkLCBnICsgZSksIGEubGluZVRvKGYgKyBkIC8gMiArIDYsIGcgKyBlKSwgYS5saW5lVG8oZiArIGQgLyAyLCBnICsgZSArIDgpLCBhLmxpbmVUbyhmICsgZCAvIDIgLSA2LCBnICsgZSksIGEubGluZVRvKGYsIGcgKyBlKSwgYS5saW5lVG8oZiwgZyksIGEuZmlsbCgpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBhLmJlZ2luUGF0aCgpLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFRleHQodGhpcy5hbGFybSwgZiArIDIsIGcgKyBlIC0gNCksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRUZXh0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRleHQ7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IGIgJiYgXCJcIiAhPSBiKSB7XHJcbiAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGEubWVhc3VyZVRleHQoYikud2lkdGgsIGQgPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5nZXRUZXh0UG9zdGlvbih0aGlzLnRleHRQb3NpdGlvbiwgYywgZCk7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxUZXh0KGIsIGUueCwgZS55KSwgYS5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5wYWludEJvcmRlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHRoaXMuYm9yZGVyV2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEubGluZVdpZHRoID0gdGhpcy5ib3JkZXJXaWR0aCwgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuYm9yZGVyQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5ib3JkZXJXaWR0aCAvIDI7XHJcbiAgICAgICAgICAgICAgICBudWxsID09IHRoaXMuYm9yZGVyUmFkaXVzIHx8IDAgPT0gdGhpcy5ib3JkZXJSYWRpdXMgPyBhLnJlY3QoLXRoaXMud2lkdGggLyAyIC0gYiwgLXRoaXMuaGVpZ2h0IC8gMiAtIGIsIHRoaXMud2lkdGggKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmhlaWdodCArIHRoaXMuYm9yZGVyV2lkdGgpIDogYS5KVG9wb1JvdW5kUmVjdCgtdGhpcy53aWR0aCAvIDIgLSBiLCAtdGhpcy5oZWlnaHQgLyAyIC0gYiwgdGhpcy53aWR0aCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuaGVpZ2h0ICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5ib3JkZXJSYWRpdXMpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLmdldFRleHRQb3N0aW9uID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBudWxsO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbCA9PSBhIHx8IFwiQm90dG9tX0NlbnRlclwiID09IGEgPyBkID0ge3g6IC10aGlzLndpZHRoIC8gMiArICh0aGlzLndpZHRoIC0gYikgLyAyLCB5OiB0aGlzLmhlaWdodCAvIDIgKyBjfSA6IFwiVG9wX0NlbnRlclwiID09IGEgPyBkID0ge1xyXG4gICAgICAgICAgICAgICAgeDogLXRoaXMud2lkdGggLyAyICsgKHRoaXMud2lkdGggLSBiKSAvIDIsXHJcbiAgICAgICAgICAgICAgICB5OiAtdGhpcy5oZWlnaHQgLyAyIC0gYyAvIDJcclxuICAgICAgICAgICAgfSA6IFwiVG9wX1JpZ2h0XCIgPT0gYSA/IGQgPSB7eDogdGhpcy53aWR0aCAvIDIsIHk6IC10aGlzLmhlaWdodCAvIDIgLSBjIC8gMn0gOiBcIlRvcF9MZWZ0XCIgPT0gYSA/IGQgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiAtdGhpcy53aWR0aCAvIDIgLSBiLFxyXG4gICAgICAgICAgICAgICAgeTogLXRoaXMuaGVpZ2h0IC8gMiAtIGMgLyAyXHJcbiAgICAgICAgICAgIH0gOiBcIkJvdHRvbV9SaWdodFwiID09IGEgPyBkID0ge3g6IHRoaXMud2lkdGggLyAyLCB5OiB0aGlzLmhlaWdodCAvIDIgKyBjfSA6IFwiQm90dG9tX0xlZnRcIiA9PSBhID8gZCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IC10aGlzLndpZHRoIC8gMiAtIGIsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLmhlaWdodCAvIDIgKyBjXHJcbiAgICAgICAgICAgIH0gOiBcIk1pZGRsZV9DZW50ZXJcIiA9PSBhID8gZCA9IHt4OiAtdGhpcy53aWR0aCAvIDIgKyAodGhpcy53aWR0aCAtIGIpIC8gMiwgeTogYyAvIDJ9IDogXCJNaWRkbGVfUmlnaHRcIiA9PSBhID8gZCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgeTogYyAvIDJcclxuICAgICAgICAgICAgfSA6IFwiTWlkZGxlX0xlZnRcIiA9PSBhICYmIChkID0ge3g6IC10aGlzLndpZHRoIC8gMiAtIGIsIHk6IGMgLyAyfSksIG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WCAmJiAoZC54ICs9IHRoaXMudGV4dE9mZnNldFgpLCBudWxsICE9IHRoaXMudGV4dE9mZnNldFkgJiYgKGQueSArPSB0aGlzLnRleHRPZmZzZXRZKSwgZFxyXG4gICAgICAgIH0sIHRoaXMuc2V0SW1hZ2UgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSBhKXRocm93IG5ldyBFcnJvcihcIk5vZGUuc2V0SW1hZ2UoKTog5Y+C5pWwSW1hZ2Xlr7nosaHkuLrnqbohXCIpO1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGpbYV07XHJcbiAgICAgICAgICAgICAgICBudWxsID09IGQgPyAoZCA9IG5ldyBJbWFnZSwgZC5zcmMgPSBhLCBkLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBqW2FdID0gZCwgMSA9PSBiICYmIGMuc2V0U2l6ZShkLndpZHRoLCBkLmhlaWdodCksIGMuaW1hZ2UgPSBkLCBjLmFsYXJtQ29sb3IgPSBudWxsID09IGMuYWxhcm1Db2xvciA/IFwiMjU1LDAsMFwiIDogYy5hbGFybUNvbG9yXHJcbiAgICAgICAgICAgICAgICB9KSA6IChiICYmIHRoaXMuc2V0U2l6ZShkLndpZHRoLCBkLmhlaWdodCksIGMuaW1hZ2UgPSBkLCBjLmFsYXJtQ29sb3IgPSBudWxsID09IGMuYWxhcm1Db2xvciA/IFwiMjU1LDAsMFwiIDogYy5hbGFybUNvbG9yKVxyXG4gICAgICAgICAgICB9IGVsc2UgdGhpcy5pbWFnZSA9IGEsIGMuYWxhcm1Db2xvciA9IG51bGwgPT0gYy5hbGFybUNvbG9yID8gXCIyNTUsMCwwXCIgOiBjLmFsYXJtQ29sb3IsIDEgPT0gYiAmJiB0aGlzLnNldFNpemUoYS53aWR0aCwgYS5oZWlnaHQpXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLm91dExpbmtzICYmICh0aGlzLm91dExpbmtzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIGMubm9kZUEgPT09IGIgJiYgYS5yZW1vdmUoYylcclxuICAgICAgICAgICAgfSksIHRoaXMub3V0TGlua3MgPSBudWxsKSwgdGhpcy5pbkxpbmtzICYmICh0aGlzLmluTGlua3MuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgYy5ub2RlWiA9PT0gYiAmJiBhLnJlbW92ZShjKVxyXG4gICAgICAgICAgICB9KSwgdGhpcy5pbkxpbmtzID0gbnVsbClcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICBjLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkKGEpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoKSwgdGhpcy50ZXh0ID0gYSwgdGhpcy5lbGVtZW50VHlwZSA9IFwiVGV4dE5vZGVcIiwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udCwgdGhpcy53aWR0aCA9IGEubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCwgdGhpcy5oZWlnaHQgPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFRleHQodGhpcy50ZXh0LCAtdGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0IC8gMiksIGEuY2xvc2VQYXRoKCksIHRoaXMucGFpbnRCb3JkZXIoYSksIHRoaXMucGFpbnRDdHJsKGEpLCB0aGlzLnBhaW50QWxhcm1UZXh0KGEpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGUoYSwgYiwgYykge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpLCB0aGlzLnRleHQgPSBhLCB0aGlzLmhyZWYgPSBiLCB0aGlzLnRhcmdldCA9IGMsIHRoaXMuZWxlbWVudFR5cGUgPSBcIkxpbmtOb2RlXCIsIHRoaXMuaXNWaXNpdGVkID0gITEsIHRoaXMudmlzaXRlZENvbG9yID0gbnVsbCwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udCwgdGhpcy53aWR0aCA9IGEubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCwgdGhpcy5oZWlnaHQgPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoLCB0aGlzLmlzVmlzaXRlZCAmJiBudWxsICE9IHRoaXMudmlzaXRlZENvbG9yID8gKGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnZpc2l0ZWRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnZpc2l0ZWRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIikgOiAoYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiKSwgYS5maWxsVGV4dCh0aGlzLnRleHQsIC10aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyKSwgdGhpcy5pc01vdXNlT3ZlciAmJiAoYS5tb3ZlVG8oLXRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCksIGEubGluZVRvKHRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCksIGEuc3Ryb2tlKCkpLCBhLmNsb3NlUGF0aCgpLCB0aGlzLnBhaW50Qm9yZGVyKGEpLCB0aGlzLnBhaW50Q3RybChhKSwgdGhpcy5wYWludEFsYXJtVGV4dChhKVxyXG4gICAgICAgIH0sIHRoaXMubW91c2Vtb3ZlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgaWYgKGEgJiYgYS5sZW5ndGggPiAwKWZvciAodmFyIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKylhW2JdLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiXHJcbiAgICAgICAgfSksIHRoaXMubW91c2VvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICBpZiAoYSAmJiBhLmxlbmd0aCA+IDApZm9yICh2YXIgYiA9IDA7IGIgPCBhLmxlbmd0aDsgYisrKWFbYl0uc3R5bGUuY3Vyc29yID0gXCJkZWZhdWx0XCJcclxuICAgICAgICB9KSwgdGhpcy5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIFwiX2JsYW5rXCIgPT0gdGhpcy50YXJnZXQgPyB3aW5kb3cub3Blbih0aGlzLmhyZWYpIDogbG9jYXRpb24gPSB0aGlzLmhyZWYsIHRoaXMuaXNWaXNpdGVkID0gITBcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGYoYSkge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZShhcmd1bWVudHMpLCB0aGlzLl9yYWRpdXMgPSAyMCwgdGhpcy5iZWdpbkRlZ3JlZSA9IDAsIHRoaXMuZW5kRGVncmVlID0gMiAqIE1hdGguUEksIHRoaXMudGV4dCA9IGEsIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmFyYygwLCAwLCB0aGlzLnJhZGl1cywgdGhpcy5iZWdpbkRlZ3JlZSwgdGhpcy5lbmREZWdyZWUsICEwKSwgYS5maWxsKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpLCB0aGlzLnBhaW50VGV4dChhKSwgdGhpcy5wYWludEJvcmRlcihhKSwgdGhpcy5wYWludEN0cmwoYSksIHRoaXMucGFpbnRBbGFybVRleHQoYSlcclxuICAgICAgICB9LCB0aGlzLnBhaW50U2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5zdHJva2VTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDI1NSwgMC45KVwiLCBhLmZpbGxTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDIzNiwwLjcpXCIsIGEuYXJjKDAsIDAsIHRoaXMucmFkaXVzICsgMywgdGhpcy5iZWdpbkRlZ3JlZSwgdGhpcy5lbmREZWdyZWUsICEwKSwgYS5maWxsKCksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGcoYSwgYiwgYykge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpLCB0aGlzLmZyYW1lSW1hZ2VzID0gYSB8fCBbXSwgdGhpcy5mcmFtZUluZGV4ID0gMCwgdGhpcy5pc1N0b3AgPSAhMDtcclxuICAgICAgICB2YXIgZCA9IGIgfHwgMWUzO1xyXG4gICAgICAgIHRoaXMucmVwZWF0UGxheSA9ICExO1xyXG4gICAgICAgIHZhciBlID0gdGhpcztcclxuICAgICAgICB0aGlzLm5leHRGcmFtZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzU3RvcCAmJiBudWxsICE9IHRoaXMuZnJhbWVJbWFnZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mcmFtZUluZGV4KyssIHRoaXMuZnJhbWVJbmRleCA+PSB0aGlzLmZyYW1lSW1hZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yZXBlYXRQbGF5KXJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lSW5kZXggPSAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEltYWdlKHRoaXMuZnJhbWVJbWFnZXNbdGhpcy5mcmFtZUluZGV4XSwgYyksIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUubmV4dEZyYW1lKClcclxuICAgICAgICAgICAgICAgIH0sIGQgLyBhLmxlbmd0aClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoKGEsIGIsIGMsIGQsIGUpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICAgICAgICB2YXIgZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zZXRJbWFnZShhKSwgdGhpcy5mcmFtZUluZGV4ID0gMCwgdGhpcy5pc1BhdXNlID0gITAsIHRoaXMucmVwZWF0UGxheSA9ICExO1xyXG4gICAgICAgIHZhciBnID0gZCB8fCAxZTM7XHJcbiAgICAgICAgZSA9IGUgfHwgMCwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMud2lkdGgsIGQgPSB0aGlzLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIGEuc2F2ZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IChNYXRoLmZsb29yKHRoaXMuZnJhbWVJbmRleCAvIGMpICsgZSkgKiBkLCBnID0gTWF0aC5mbG9vcih0aGlzLmZyYW1lSW5kZXggJSBjKSAqIGI7XHJcbiAgICAgICAgICAgICAgICBhLmRyYXdJbWFnZSh0aGlzLmltYWdlLCBnLCBmLCBiLCBkLCAtYiAvIDIsIC1kIC8gMiwgYiwgZCksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKSwgdGhpcy5wYWludFRleHQoYSksIHRoaXMucGFpbnRCb3JkZXIoYSksIHRoaXMucGFpbnRDdHJsKGEpLCB0aGlzLnBhaW50QWxhcm1UZXh0KGEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLm5leHRGcmFtZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzU3RvcCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZnJhbWVJbmRleCsrLCB0aGlzLmZyYW1lSW5kZXggPj0gYiAqIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVwZWF0UGxheSlyZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5pc1N0b3AgfHwgZi5uZXh0RnJhbWUoKVxyXG4gICAgICAgICAgICAgICAgfSwgZyAvIChiICogYykpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaSgpIHtcclxuICAgICAgICB2YXIgYSA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGEgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDMgPyBuZXcgZyhhcmd1bWVudHNbMF0sIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKSA6IG5ldyBoKGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0sIGFyZ3VtZW50c1szXSwgYXJndW1lbnRzWzRdLCBhcmd1bWVudHNbNV0pLCBhLnN0b3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGEuaXNTdG9wID0gITBcclxuICAgICAgICB9LCBhLnBsYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGEuaXNTdG9wID0gITEsIGEuZnJhbWVJbmRleCA9IDAsIGEubmV4dEZyYW1lKClcclxuICAgICAgICB9LCBhXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGogPSB7fTtcclxuICAgIGIucHJvdG90eXBlID0gbmV3IGEuRWRpdGFibGVFbGVtZW50LCBjLnByb3RvdHlwZSA9IG5ldyBiLCBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhjLnByb3RvdHlwZSwge1xyXG4gICAgICAgIGFsYXJtQ29sb3I6IHtcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYWxhcm1Db2xvclxyXG4gICAgICAgICAgICB9LCBzZXQ6IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWxhcm1Db2xvciA9IGIsIG51bGwgIT0gdGhpcy5pbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gYS51dGlsLmdlbkltYWdlQWxhcm0odGhpcy5pbWFnZSwgYik7XHJcbiAgICAgICAgICAgICAgICAgICAgYyAmJiAodGhpcy5hbGFybUltYWdlID0gYylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pLCBkLnByb3RvdHlwZSA9IG5ldyBjLCBlLnByb3RvdHlwZSA9IG5ldyBkLCBmLnByb3RvdHlwZSA9IG5ldyBjLCBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhmLnByb3RvdHlwZSwge1xyXG4gICAgICAgIHJhZGl1czoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yYWRpdXNcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFkaXVzID0gYTtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gMiAqIHRoaXMucmFkaXVzLCBjID0gMiAqIHRoaXMucmFkaXVzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IGIsIHRoaXMuaGVpZ2h0ID0gY1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgd2lkdGg6IHtcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGhcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFkaXVzID0gYSAvIDIsIHRoaXMuX3dpZHRoID0gYVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgaGVpZ2h0OiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlaWdodFxyXG4gICAgICAgICAgICB9LCBzZXQ6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yYWRpdXMgPSBhIC8gMiwgdGhpcy5faGVpZ2h0ID0gYVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSksIGcucHJvdG90eXBlID0gbmV3IGMsIGgucHJvdG90eXBlID0gbmV3IGMsIGkucHJvdG90eXBlID0gbmV3IGMsIGEuTm9kZSA9IGMsIGEuVGV4dE5vZGUgPSBkLCBhLkxpbmtOb2RlID0gZSwgYS5DaXJjbGVOb2RlID0gZiwgYS5BbmltYXRlTm9kZSA9IGlcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKGEsIGIpIHtcclxuICAgICAgICB2YXIgYyA9IFtdO1xyXG4gICAgICAgIGlmIChudWxsID09IGEgfHwgbnVsbCA9PSBiKXJldHVybiBjO1xyXG4gICAgICAgIGlmIChhICYmIGIgJiYgYS5vdXRMaW5rcyAmJiBiLmluTGlua3MpZm9yICh2YXIgZCA9IDA7IGQgPCBhLm91dExpbmtzLmxlbmd0aDsgZCsrKWZvciAodmFyIGUgPSBhLm91dExpbmtzW2RdLCBmID0gMDsgZiA8IGIuaW5MaW5rcy5sZW5ndGg7IGYrKykge1xyXG4gICAgICAgICAgICB2YXIgZyA9IGIuaW5MaW5rc1tmXTtcclxuICAgICAgICAgICAgZSA9PT0gZyAmJiBjLnB1c2goZylcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjKGEsIGMpIHtcclxuICAgICAgICB2YXIgZCA9IGIoYSwgYyksIGUgPSBiKGMsIGEpLCBmID0gZC5jb25jYXQoZSk7XHJcbiAgICAgICAgcmV0dXJuIGZcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkKGEpIHtcclxuICAgICAgICB2YXIgYiA9IGMoYS5ub2RlQSwgYS5ub2RlWik7XHJcbiAgICAgICAgcmV0dXJuIGIgPSBiLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICByZXR1cm4gYSAhPT0gYlxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZShhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIGMoYSwgYikubGVuZ3RoXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZihiLCBjLCBnKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gaChiLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYS51dGlsLmxpbmVGKGIuY3gsIGIuY3ksIGMuY3gsIGMuY3kpLCBlID0gYi5nZXRCb3VuZCgpLCBmID0gYS51dGlsLmludGVyc2VjdGlvbkxpbmVCb3VuZChkLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIGlmIChmLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuZWxlbWVudFR5cGUgPSBcImxpbmtcIiwgdGhpcy56SW5kZXggPSBhLnpJbmRleF9MaW5rLCAwICE9IGFyZ3VtZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dCA9IGQsIHRoaXMubm9kZUEgPSBiLCB0aGlzLm5vZGVaID0gYywgdGhpcy5ub2RlQSAmJiBudWxsID09IHRoaXMubm9kZUEub3V0TGlua3MgJiYgKHRoaXMubm9kZUEub3V0TGlua3MgPSBbXSksIHRoaXMubm9kZUEgJiYgbnVsbCA9PSB0aGlzLm5vZGVBLmluTGlua3MgJiYgKHRoaXMubm9kZUEuaW5MaW5rcyA9IFtdKSwgdGhpcy5ub2RlWiAmJiBudWxsID09IHRoaXMubm9kZVouaW5MaW5rcyAmJiAodGhpcy5ub2RlWi5pbkxpbmtzID0gW10pLCB0aGlzLm5vZGVaICYmIG51bGwgPT0gdGhpcy5ub2RlWi5vdXRMaW5rcyAmJiAodGhpcy5ub2RlWi5vdXRMaW5rcyA9IFtdKSwgbnVsbCAhPSB0aGlzLm5vZGVBICYmIHRoaXMubm9kZUEub3V0TGlua3MucHVzaCh0aGlzKSwgbnVsbCAhPSB0aGlzLm5vZGVaICYmIHRoaXMubm9kZVouaW5MaW5rcy5wdXNoKHRoaXMpLCB0aGlzLmNhY3VsYXRlSW5kZXgoKSwgdGhpcy5mb250ID0gXCIxMnB4IENvbnNvbGFzXCIsIHRoaXMuZm9udENvbG9yID0gXCIyNTUsMjU1LDI1NVwiLCB0aGlzLmxpbmVXaWR0aCA9IDIsIHRoaXMubGluZUpvaW4gPSBcIm1pdGVyXCIsIHRoaXMudHJhbnNmb3JtQWJsZSA9ICExLCB0aGlzLmJ1bmRsZU9mZnNldCA9IDIwLCB0aGlzLmJ1bmRsZUdhcCA9IDEyLCB0aGlzLnRleHRPZmZzZXRYID0gMCwgdGhpcy50ZXh0T2Zmc2V0WSA9IDAsIHRoaXMuYXJyb3dzUmFkaXVzID0gbnVsbCwgdGhpcy5hcnJvd3NPZmZzZXQgPSAwLCB0aGlzLmRhc2hlZFBhdHRlcm4gPSBudWxsLCB0aGlzLnBhdGggPSBbXTtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gXCJ0ZXh0LGZvbnQsZm9udENvbG9yLGxpbmVXaWR0aCxsaW5lSm9pblwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5jYWN1bGF0ZUluZGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGUodGhpcy5ub2RlQSwgdGhpcy5ub2RlWik7XHJcbiAgICAgICAgICAgIGEgPiAwICYmICh0aGlzLm5vZGVJbmRleCA9IGEgLSAxKVxyXG4gICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZShiLCBjLCBnKSwgdGhpcy5yZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZUEgJiYgdGhpcy5ub2RlQS5vdXRMaW5rcyAmJiAodGhpcy5ub2RlQS5vdXRMaW5rcyA9IHRoaXMubm9kZUEub3V0TGlua3MuZmlsdGVyKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYiAhPT0gYVxyXG4gICAgICAgICAgICB9KSksIHRoaXMubm9kZVogJiYgdGhpcy5ub2RlWi5pbkxpbmtzICYmICh0aGlzLm5vZGVaLmluTGlua3MgPSB0aGlzLm5vZGVaLmluTGlua3MuZmlsdGVyKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYiAhPT0gYVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHZhciBiID0gZCh0aGlzKTtcclxuICAgICAgICAgICAgYi5mb3JFYWNoKGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICBhLm5vZGVJbmRleCA9IGJcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LCB0aGlzLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0ge3g6IHRoaXMubm9kZUEuY3gsIHk6IHRoaXMubm9kZUEuY3l9O1xyXG4gICAgICAgICAgICByZXR1cm4gYVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0RW5kUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbCAhPSB0aGlzLmFycm93c1JhZGl1cyAmJiAoYSA9IGgodGhpcy5ub2RlWiwgdGhpcy5ub2RlQSkpLCBudWxsID09IGEgJiYgKGEgPSB7eDogdGhpcy5ub2RlWi5jeCwgeTogdGhpcy5ub2RlWi5jeX0pLCBhXHJcbiAgICAgICAgfSwgdGhpcy5nZXRQYXRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IFtdLCBiID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCksIGMgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKXJldHVybiBbYiwgY107XHJcbiAgICAgICAgICAgIHZhciBkID0gZSh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKTtcclxuICAgICAgICAgICAgaWYgKDEgPT0gZClyZXR1cm4gW2IsIGNdO1xyXG4gICAgICAgICAgICB2YXIgZiA9IE1hdGguYXRhbjIoYy55IC0gYi55LCBjLnggLSBiLngpLCBnID0ge3g6IGIueCArIHRoaXMuYnVuZGxlT2Zmc2V0ICogTWF0aC5jb3MoZiksIHk6IGIueSArIHRoaXMuYnVuZGxlT2Zmc2V0ICogTWF0aC5zaW4oZil9LCBoID0ge1xyXG4gICAgICAgICAgICAgICAgeDogYy54ICsgdGhpcy5idW5kbGVPZmZzZXQgKiBNYXRoLmNvcyhmIC0gTWF0aC5QSSksXHJcbiAgICAgICAgICAgICAgICB5OiBjLnkgKyB0aGlzLmJ1bmRsZU9mZnNldCAqIE1hdGguc2luKGYgLSBNYXRoLlBJKVxyXG4gICAgICAgICAgICB9LCBpID0gZiAtIE1hdGguUEkgLyAyLCBqID0gZiAtIE1hdGguUEkgLyAyLCBrID0gZCAqIHRoaXMuYnVuZGxlR2FwIC8gMiAtIHRoaXMuYnVuZGxlR2FwIC8gMiwgbCA9IHRoaXMuYnVuZGxlR2FwICogdGhpcy5ub2RlSW5kZXgsIG0gPSB7XHJcbiAgICAgICAgICAgICAgICB4OiBnLnggKyBsICogTWF0aC5jb3MoaSksXHJcbiAgICAgICAgICAgICAgICB5OiBnLnkgKyBsICogTWF0aC5zaW4oaSlcclxuICAgICAgICAgICAgfSwgbiA9IHt4OiBoLnggKyBsICogTWF0aC5jb3MoaiksIHk6IGgueSArIGwgKiBNYXRoLnNpbihqKX07XHJcbiAgICAgICAgICAgIHJldHVybiBtID0ge3g6IG0ueCArIGsgKiBNYXRoLmNvcyhpIC0gTWF0aC5QSSksIHk6IG0ueSArIGsgKiBNYXRoLnNpbihpIC0gTWF0aC5QSSl9LCBuID0ge3g6IG4ueCArIGsgKiBNYXRoLmNvcyhqIC0gTWF0aC5QSSksIHk6IG4ueSArIGsgKiBNYXRoLnNpbihqIC0gTWF0aC5QSSl9LCBhLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgeDogYi54LFxyXG4gICAgICAgICAgICAgICAgeTogYi55XHJcbiAgICAgICAgICAgIH0pLCBhLnB1c2goe3g6IG0ueCwgeTogbS55fSksIGEucHVzaCh7eDogbi54LCB5OiBuLnl9KSwgYS5wdXNoKHt4OiBjLngsIHk6IGMueX0pLCBhXHJcbiAgICAgICAgfSwgdGhpcy5wYWludFBhdGggPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gdm9pZCB0aGlzLnBhaW50TG9vcChhKTtcclxuICAgICAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5tb3ZlVG8oYlswXS54LCBiWzBdLnkpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjID0gMTsgYyA8IGIubGVuZ3RoOyBjKyspbnVsbCA9PSB0aGlzLmRhc2hlZFBhdHRlcm4gPyBhLmxpbmVUbyhiW2NdLngsIGJbY10ueSkgOiBhLkpUb3BvRGFzaGVkTGluZVRvKGJbYyAtIDFdLngsIGJbYyAtIDFdLnksIGJbY10ueCwgYltjXS55LCB0aGlzLmRhc2hlZFBhdHRlcm4pO1xyXG4gICAgICAgICAgICBpZiAoYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgbnVsbCAhPSB0aGlzLmFycm93c1JhZGl1cykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiW2IubGVuZ3RoIC0gMl0sIGUgPSBiW2IubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgZCwgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRMb29wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmJ1bmRsZUdhcCAqICh0aGlzLm5vZGVJbmRleCArIDEpIC8gMjtcclxuICAgICAgICAgICAgICAgIE1hdGguUEkgKyBNYXRoLlBJIC8gMlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGEuYXJjKHRoaXMubm9kZUEueCwgdGhpcy5ub2RlQS55LCBiLCBNYXRoLlBJIC8gMiwgMiAqIE1hdGguUEkpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgfSwgdGhpcy5wYWludEFycm93ID0gZnVuY3Rpb24gKGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmFycm93c09mZnNldCwgZiA9IHRoaXMuYXJyb3dzUmFkaXVzIC8gMiwgZyA9IGMsIGggPSBkLCBpID0gTWF0aC5hdGFuMihoLnkgLSBnLnksIGgueCAtIGcueCksIGogPSBhLnV0aWwuZ2V0RGlzdGFuY2UoZywgaCkgLSB0aGlzLmFycm93c1JhZGl1cywgayA9IGcueCArIChqICsgZSkgKiBNYXRoLmNvcyhpKSwgbCA9IGcueSArIChqICsgZSkgKiBNYXRoLnNpbihpKSwgbSA9IGgueCArIGUgKiBNYXRoLmNvcyhpKSwgbiA9IGgueSArIGUgKiBNYXRoLnNpbihpKTtcclxuICAgICAgICAgICAgaSAtPSBNYXRoLlBJIC8gMjtcclxuICAgICAgICAgICAgdmFyIG8gPSB7eDogayArIGYgKiBNYXRoLmNvcyhpKSwgeTogbCArIGYgKiBNYXRoLnNpbihpKX0sIHAgPSB7eDogayArIGYgKiBNYXRoLmNvcyhpIC0gTWF0aC5QSSksIHk6IGwgKyBmICogTWF0aC5zaW4oaSAtIE1hdGguUEkpfTtcclxuICAgICAgICAgICAgYi5iZWdpblBhdGgoKSwgYi5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnN0cm9rZUNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGIubW92ZVRvKG8ueCwgby55KSwgYi5saW5lVG8obSwgbiksIGIubGluZVRvKHAueCwgcC55KSwgYi5zdHJva2UoKSwgYi5jbG9zZVBhdGgoKVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLm5vZGVBICYmIG51bGwgIT0gIXRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5nZXRQYXRoKHRoaXMubm9kZUluZGV4KTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGF0aCA9IGIsIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnN0cm9rZUNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGgsIHRoaXMucGFpbnRQYXRoKGEsIGIpLCBiICYmIGIubGVuZ3RoID4gMCAmJiB0aGlzLnBhaW50VGV4dChhLCBiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaSA9IC0oTWF0aC5QSSAvIDIgKyBNYXRoLlBJIC8gNCk7XHJcbiAgICAgICAgdGhpcy5wYWludFRleHQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IGJbMF0sIGQgPSBiW2IubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmICg0ID09IGIubGVuZ3RoICYmIChjID0gYlsxXSwgZCA9IGJbMl0pLCB0aGlzLnRleHQgJiYgdGhpcy50ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gKGQueCArIGMueCkgLyAyICsgdGhpcy50ZXh0T2Zmc2V0WCwgZiA9IChkLnkgKyBjLnkpIC8gMiArIHRoaXMudGV4dE9mZnNldFk7XHJcbiAgICAgICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICAgICAgdmFyIGcgPSBhLm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGgsIGggPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IHRoaXMuYnVuZGxlR2FwICogKHRoaXMubm9kZUluZGV4ICsgMSkgLyAyLCBlID0gdGhpcy5ub2RlQS54ICsgaiAqIE1hdGguY29zKGkpLCBmID0gdGhpcy5ub2RlQS55ICsgaiAqIE1hdGguc2luKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuZmlsbFRleHQodGhpcy50ZXh0LCBlLCBmKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGEuZmlsbFRleHQodGhpcy50ZXh0LCBlIC0gZyAvIDIsIGYgLSBoIC8gMik7XHJcbiAgICAgICAgICAgICAgICBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5wYWludFNlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYS5zaGFkb3dCbHVyID0gMTAsIGEuc2hhZG93Q29sb3IgPSBcInJnYmEoMCwwLDAsMSlcIiwgYS5zaGFkb3dPZmZzZXRYID0gMCwgYS5zaGFkb3dPZmZzZXRZID0gMFxyXG4gICAgICAgIH0sIHRoaXMuaXNJbkJvdW5kID0gZnVuY3Rpb24gKGIsIGMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5idW5kbGVHYXAgKiAodGhpcy5ub2RlSW5kZXggKyAxKSAvIDIsIGUgPSBhLnV0aWwuZ2V0RGlzdGFuY2UodGhpcy5ub2RlQSwge3g6IGIsIHk6IGN9KSAtIGQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5hYnMoZSkgPD0gM1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGYgPSAhMSwgZyA9IDE7IGcgPCB0aGlzLnBhdGgubGVuZ3RoOyBnKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBoID0gdGhpcy5wYXRoW2cgLSAxXSwgaSA9IHRoaXMucGF0aFtnXTtcclxuICAgICAgICAgICAgICAgIGlmICgxID09IGEudXRpbC5pc1BvaW50SW5MaW5lKHt4OiBiLCB5OiBjfSwgaCwgaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnKGEsIGIsIGMpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5kaXJlY3Rpb24gPSBcImhvcml6b250YWxcIlxyXG4gICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZShhLCBiLCBjKSwgdGhpcy5nZXRTdGFydFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHt4OiB0aGlzLm5vZGVBLmN4LCB5OiB0aGlzLm5vZGVBLmN5fTtcclxuICAgICAgICAgICAgcmV0dXJuIFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uID8gdGhpcy5ub2RlWi5jeCA+IGEueCA/IGEueCArPSB0aGlzLm5vZGVBLndpZHRoIC8gMiA6IGEueCAtPSB0aGlzLm5vZGVBLndpZHRoIC8gMiA6IHRoaXMubm9kZVouY3kgPiBhLnkgPyBhLnkgKz0gdGhpcy5ub2RlQS5oZWlnaHQgLyAyIDogYS55IC09IHRoaXMubm9kZUEuaGVpZ2h0IC8gMiwgYVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0RW5kUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0ge3g6IHRoaXMubm9kZVouY3gsIHk6IHRoaXMubm9kZVouY3l9O1xyXG4gICAgICAgICAgICByZXR1cm4gXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24gPyB0aGlzLm5vZGVBLmN5IDwgYS55ID8gYS55IC09IHRoaXMubm9kZVouaGVpZ2h0IC8gMiA6IGEueSArPSB0aGlzLm5vZGVaLmhlaWdodCAvIDIgOiBhLnggPSB0aGlzLm5vZGVBLmN4IDwgYS54ID8gdGhpcy5ub2RlWi54IDogdGhpcy5ub2RlWi54ICsgdGhpcy5ub2RlWi53aWR0aCwgYVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0UGF0aCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gW10sIGMgPSB0aGlzLmdldFN0YXJ0UG9zaXRpb24oKSwgZCA9IHRoaXMuZ2V0RW5kUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIFtjLCBkXTtcclxuICAgICAgICAgICAgdmFyIGYsIGcsIGggPSBlKHRoaXMubm9kZUEsIHRoaXMubm9kZVopLCBpID0gKGggLSAxKSAqIHRoaXMuYnVuZGxlR2FwLCBqID0gdGhpcy5idW5kbGVHYXAgKiBhIC0gaSAvIDI7XHJcbiAgICAgICAgICAgIHJldHVybiBcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbiA/IChmID0gZC54ICsgaiwgZyA9IGMueSAtIGosIGIucHVzaCh7eDogYy54LCB5OiBnfSksIGIucHVzaCh7eDogZiwgeTogZ30pLCBiLnB1c2goe3g6IGYsIHk6IGQueX0pKSA6IChmID0gYy54ICsgaiwgZyA9IGQueSAtIGosIGIucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB4OiBmLFxyXG4gICAgICAgICAgICAgICAgeTogYy55XHJcbiAgICAgICAgICAgIH0pLCBiLnB1c2goe3g6IGYsIHk6IGd9KSwgYi5wdXNoKHt4OiBkLngsIHk6IGd9KSksIGJcclxuICAgICAgICB9LCB0aGlzLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHQgJiYgdGhpcy50ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gYlsxXSwgZCA9IGMueCArIHRoaXMudGV4dE9mZnNldFgsIGUgPSBjLnkgKyB0aGlzLnRleHRPZmZzZXRZO1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gYS5tZWFzdXJlVGV4dCh0aGlzLnRleHQpLndpZHRoLCBnID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFRleHQodGhpcy50ZXh0LCBkIC0gZiAvIDIsIGUgLSBnIC8gMiksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaChhLCBiLCBjKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBoLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuZGlyZWN0aW9uID0gXCJ2ZXJ0aWNhbFwiLCB0aGlzLm9mZnNldEdhcCA9IDQ0XHJcbiAgICAgICAgfSwgdGhpcy5pbml0aWFsaXplKGEsIGIsIGMpLCB0aGlzLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0ge3g6IHRoaXMubm9kZUEuY3gsIHk6IHRoaXMubm9kZUEuY3l9O1xyXG4gICAgICAgICAgICByZXR1cm4gXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24gPyBhLnggPSB0aGlzLm5vZGVaLmN4IDwgYS54ID8gdGhpcy5ub2RlQS54IDogdGhpcy5ub2RlQS54ICsgdGhpcy5ub2RlQS53aWR0aCA6IGEueSA9IHRoaXMubm9kZVouY3kgPCBhLnkgPyB0aGlzLm5vZGVBLnkgOiB0aGlzLm5vZGVBLnkgKyB0aGlzLm5vZGVBLmhlaWdodCwgYVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0RW5kUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0ge3g6IHRoaXMubm9kZVouY3gsIHk6IHRoaXMubm9kZVouY3l9O1xyXG4gICAgICAgICAgICByZXR1cm4gXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24gPyBhLnggPSB0aGlzLm5vZGVBLmN4IDwgYS54ID8gdGhpcy5ub2RlWi54IDogdGhpcy5ub2RlWi54ICsgdGhpcy5ub2RlWi53aWR0aCA6IGEueSA9IHRoaXMubm9kZUEuY3kgPCBhLnkgPyB0aGlzLm5vZGVaLnkgOiB0aGlzLm5vZGVaLnkgKyB0aGlzLm5vZGVaLmhlaWdodCwgYVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0UGF0aCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCksIGMgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKXJldHVybiBbYiwgY107XHJcbiAgICAgICAgICAgIHZhciBkID0gW10sIGYgPSBlKHRoaXMubm9kZUEsIHRoaXMubm9kZVopLCBnID0gKGYgLSAxKSAqIHRoaXMuYnVuZGxlR2FwLCBoID0gdGhpcy5idW5kbGVHYXAgKiBhIC0gZyAvIDIsIGkgPSB0aGlzLm9mZnNldEdhcDtcclxuICAgICAgICAgICAgcmV0dXJuIFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uID8gKHRoaXMubm9kZUEuY3ggPiB0aGlzLm5vZGVaLmN4ICYmIChpID0gLWkpLCBkLnB1c2goe3g6IGIueCwgeTogYi55ICsgaH0pLCBkLnB1c2goe3g6IGIueCArIGksIHk6IGIueSArIGh9KSwgZC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHg6IGMueCAtIGksXHJcbiAgICAgICAgICAgICAgICB5OiBjLnkgKyBoXHJcbiAgICAgICAgICAgIH0pLCBkLnB1c2goe3g6IGMueCwgeTogYy55ICsgaH0pKSA6ICh0aGlzLm5vZGVBLmN5ID4gdGhpcy5ub2RlWi5jeSAmJiAoaSA9IC1pKSwgZC5wdXNoKHt4OiBiLnggKyBoLCB5OiBiLnl9KSwgZC5wdXNoKHt4OiBiLnggKyBoLCB5OiBiLnkgKyBpfSksIGQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB4OiBjLnggKyBoLFxyXG4gICAgICAgICAgICAgICAgeTogYy55IC0gaVxyXG4gICAgICAgICAgICB9KSwgZC5wdXNoKHt4OiBjLnggKyBoLCB5OiBjLnl9KSksIGRcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaShhLCBiLCBjKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcclxuICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoYSwgYiwgYyksIHRoaXMucGFpbnRQYXRoID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEubW92ZVRvKGJbMF0ueCwgYlswXS55KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgYyA9IDE7IGMgPCBiLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGJbYyAtIDFdLCBlID0gYltjXSwgZiA9IChkLnggKyBlLngpIC8gMiwgZyA9IChkLnkgKyBlLnkpIC8gMjtcclxuICAgICAgICAgICAgICAgIGcgKz0gKGUueSAtIGQueSkgLyAyLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5zdHJva2VDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoLCBhLm1vdmVUbyhkLngsIGQuY3kpLCBhLnF1YWRyYXRpY0N1cnZlVG8oZiwgZywgZS54LCBlLnkpLCBhLnN0cm9rZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoID0gYltiLmxlbmd0aCAtIDJdLCBpID0gYltiLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGEsIGgsIGkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZi5wcm90b3R5cGUgPSBuZXcgYS5JbnRlcmFjdGl2ZUVsZW1lbnQsIGcucHJvdG90eXBlID0gbmV3IGYsIGgucHJvdG90eXBlID0gbmV3IGYsIGkucHJvdG90eXBlID0gbmV3IGYsIGEuTGluayA9IGYsIGEuRm9sZExpbmsgPSBnLCBhLkZsZXhpb25hbExpbmsgPSBoLCBhLkN1cnZlTGluayA9IGlcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKGMpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICBiLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIG51bGwpLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJjb250YWluZXJcIiwgdGhpcy56SW5kZXggPSBhLnpJbmRleF9Db250YWluZXIsIHRoaXMud2lkdGggPSAxMDAsIHRoaXMuaGVpZ2h0ID0gMTAwLCB0aGlzLmNoaWxkcyA9IFtdLCB0aGlzLmFscGhhID0gLjUsIHRoaXMuZHJhZ2FibGUgPSAhMCwgdGhpcy5jaGlsZERyYWdibGUgPSAhMCwgdGhpcy52aXNpYmxlID0gITAsIHRoaXMuZmlsbENvbG9yID0gXCIxMCwxMDAsODBcIiwgdGhpcy5ib3JkZXJXaWR0aCA9IDAsIHRoaXMuYm9yZGVyQ29sb3IgPSBcIjI1NSwyNTUsMjU1XCIsIHRoaXMuYm9yZGVyUmFkaXVzID0gbnVsbCwgdGhpcy5mb250ID0gXCIxMnB4IENvbnNvbGFzXCIsIHRoaXMuZm9udENvbG9yID0gXCIyNTUsMjU1LDI1NVwiLCB0aGlzLnRleHQgPSBjLCB0aGlzLnRleHRQb3NpdGlvbiA9IFwiQm90dG9tX0NlbnRlclwiLCB0aGlzLnRleHRPZmZzZXRYID0gMCwgdGhpcy50ZXh0T2Zmc2V0WSA9IDAsIHRoaXMubGF5b3V0ID0gbmV3IGEubGF5b3V0LkF1dG9Cb3VuZExheW91dFxyXG4gICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZShjKSwgdGhpcy5hZGQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5wdXNoKGEpLCBhLmRyYWdhYmxlID0gdGhpcy5jaGlsZERyYWdibGVcclxuICAgICAgICB9LCB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBiKyspaWYgKHRoaXMuY2hpbGRzW2JdID09PSBhKSB7XHJcbiAgICAgICAgICAgICAgICBhLnBhcmVudENvbnRhaW5lciA9IG51bGwsIHRoaXMuY2hpbGRzID0gdGhpcy5jaGlsZHMuZGVsKGIpLCBhLmxhc3RQYXJlbnRDb250YWluZXIgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlQWxsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcyA9IFtdXHJcbiAgICAgICAgfSwgdGhpcy5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gYSAtIHRoaXMueCwgZCA9IGIgLSB0aGlzLnk7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IGEsIHRoaXMueSA9IGI7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gdGhpcy5jaGlsZHNbZV07XHJcbiAgICAgICAgICAgICAgICBmLnNldExvY2F0aW9uKGYueCArIGMsIGYueSArIGQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLmRvTGF5b3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYSAmJiBhKHRoaXMsIHRoaXMuY2hpbGRzKVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgJiYgKHRoaXMubGF5b3V0ICYmIHRoaXMubGF5b3V0KHRoaXMsIHRoaXMuY2hpbGRzKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBudWxsID09IHRoaXMuYm9yZGVyUmFkaXVzIHx8IDAgPT0gdGhpcy5ib3JkZXJSYWRpdXMgPyBhLnJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KSA6IGEuSlRvcG9Sb3VuZFJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmJvcmRlclJhZGl1cyksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpLCB0aGlzLnBhaW50VGV4dChhKSwgdGhpcy5wYWludEJvcmRlcihhKSlcclxuICAgICAgICB9LCB0aGlzLnBhaW50Qm9yZGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy5ib3JkZXJXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5saW5lV2lkdGggPSB0aGlzLmJvcmRlcldpZHRoLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5ib3JkZXJDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmJvcmRlcldpZHRoIC8gMjtcclxuICAgICAgICAgICAgICAgIG51bGwgPT0gdGhpcy5ib3JkZXJSYWRpdXMgfHwgMCA9PSB0aGlzLmJvcmRlclJhZGl1cyA/IGEucmVjdCh0aGlzLnggLSBiLCB0aGlzLnkgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoKSA6IGEuSlRvcG9Sb3VuZFJlY3QodGhpcy54IC0gYiwgdGhpcy55IC0gYiwgdGhpcy53aWR0aCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuaGVpZ2h0ICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5ib3JkZXJSYWRpdXMpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy50ZXh0O1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSBiICYmIFwiXCIgIT0gYikge1xyXG4gICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBhLm1lYXN1cmVUZXh0KGIpLndpZHRoLCBkID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0VGV4dFBvc3Rpb24odGhpcy50ZXh0UG9zaXRpb24sIGMsIGQpO1xyXG4gICAgICAgICAgICAgICAgYS5maWxsVGV4dChiLCBlLngsIGUueSksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0VGV4dFBvc3Rpb24gPSBmdW5jdGlvbiAoYSwgYiwgYykge1xyXG4gICAgICAgICAgICB2YXIgZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsID09IGEgfHwgXCJCb3R0b21fQ2VudGVyXCIgPT0gYSA/IGQgPSB7eDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIgLSBiIC8gMiwgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgKyBjfSA6IFwiVG9wX0NlbnRlclwiID09IGEgPyBkID0ge1xyXG4gICAgICAgICAgICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIgLSBiIC8gMixcclxuICAgICAgICAgICAgICAgIHk6IHRoaXMueSAtIGMgLyAyXHJcbiAgICAgICAgICAgIH0gOiBcIlRvcF9SaWdodFwiID09IGEgPyBkID0ge3g6IHRoaXMueCArIHRoaXMud2lkdGggLSBiLCB5OiB0aGlzLnkgLSBjIC8gMn0gOiBcIlRvcF9MZWZ0XCIgPT0gYSA/IGQgPSB7eDogdGhpcy54LCB5OiB0aGlzLnkgLSBjIC8gMn0gOiBcIkJvdHRvbV9SaWdodFwiID09IGEgPyBkID0ge1xyXG4gICAgICAgICAgICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCAtIGIsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCArIGNcclxuICAgICAgICAgICAgfSA6IFwiQm90dG9tX0xlZnRcIiA9PSBhID8gZCA9IHt4OiB0aGlzLngsIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0ICsgY30gOiBcIk1pZGRsZV9DZW50ZXJcIiA9PSBhID8gZCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyIC0gYiAvIDIsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDIgKyBjIC8gMlxyXG4gICAgICAgICAgICB9IDogXCJNaWRkbGVfUmlnaHRcIiA9PSBhID8gZCA9IHt4OiB0aGlzLnggKyB0aGlzLndpZHRoIC0gYiwgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgYyAvIDJ9IDogXCJNaWRkbGVfTGVmdFwiID09IGEgJiYgKGQgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiB0aGlzLngsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDIgKyBjIC8gMlxyXG4gICAgICAgICAgICB9KSwgbnVsbCAhPSB0aGlzLnRleHRPZmZzZXRYICYmIChkLnggKz0gdGhpcy50ZXh0T2Zmc2V0WCksIG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WSAmJiAoZC55ICs9IHRoaXMudGV4dE9mZnNldFkpLCBkXHJcbiAgICAgICAgfSwgdGhpcy5wYWludE1vdXNlb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCB0aGlzLnBhaW50U2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLnNoYWRvd0JsdXIgPSAxMCwgYS5zaGFkb3dDb2xvciA9IFwicmdiYSgwLDAsMCwxKVwiLCBhLnNoYWRvd09mZnNldFggPSAwLCBhLnNoYWRvd09mZnNldFkgPSAwXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGIucHJvdG90eXBlID0gbmV3IGEuSW50ZXJhY3RpdmVFbGVtZW50LCBhLkNvbnRhaW5lciA9IGJcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKGEpIHtcclxuICAgICAgICB2YXIgYiA9IDAsIGMgPSAwO1xyXG4gICAgICAgIGEuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBiICs9IGEuY3gsIGMgKz0gYS5jeVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkID0ge3g6IGIgLyBhLmxlbmd0aCwgeTogYyAvIGEubGVuZ3RofTtcclxuICAgICAgICByZXR1cm4gZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGMoYywgZCkge1xyXG4gICAgICAgIG51bGwgPT0gZCAmJiAoZCA9IHt9KTtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBlID0gZC5jeCwgZiA9IGQuY3ksIGcgPSBkLm1pblJhZGl1cywgaCA9IGQubm9kZURpYW1ldGVyLCBpID0gZC5oU2NhbGUgfHwgMSwgaiA9IGQudlNjYWxlIHx8IDE7XHJcbiAgICAgICAgICAgIGQuYmVnaW5BbmdsZSB8fCAwLCBkLmVuZEFuZ2xlIHx8IDIgKiBNYXRoLlBJXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChudWxsID09IGUgfHwgbnVsbCA9PSBmKSB7XHJcbiAgICAgICAgICAgIHZhciBrID0gYihjKTtcclxuICAgICAgICAgICAgZSA9IGsueCwgZiA9IGsueVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbCA9IDAsIG0gPSBbXSwgbiA9IFtdO1xyXG4gICAgICAgIGMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBudWxsID09IGQubm9kZURpYW1ldGVyID8gKGEuZGlhbWV0ZXIgJiYgKGggPSBhLmRpYW1ldGVyKSwgaCA9IGEucmFkaXVzID8gMiAqIGEucmFkaXVzIDogTWF0aC5zcXJ0KDIgKiBhLndpZHRoICogYS5oZWlnaHQpLCBuLnB1c2goaCkpIDogbi5wdXNoKGgpLCBsICs9IGhcclxuICAgICAgICB9KSwgYy5mb3JFYWNoKGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gbltiXSAvIGw7XHJcbiAgICAgICAgICAgIG0ucHVzaChNYXRoLlBJICogYylcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgbyA9IChjLmxlbmd0aCwgbVswXSArIG1bMV0pLCBwID0gblswXSAvIDIgKyBuWzFdIC8gMiwgcSA9IHAgLyAyIC8gTWF0aC5zaW4obyAvIDIpO1xyXG4gICAgICAgIG51bGwgIT0gZyAmJiBnID4gcSAmJiAocSA9IGcpO1xyXG4gICAgICAgIHZhciByID0gcSAqIGksIHMgPSBxICogaiwgdCA9IGQuYW5pbWF0ZTtcclxuICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICB2YXIgdSA9IHQudGltZSB8fCAxZTMsIHYgPSAwO1xyXG4gICAgICAgICAgICBjLmZvckVhY2goZnVuY3Rpb24gKGIsIGMpIHtcclxuICAgICAgICAgICAgICAgIHYgKz0gMCA9PSBjID8gbVtjXSA6IG1bYyAtIDFdICsgbVtjXTtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gZSArIE1hdGguY29zKHYpICogciwgZyA9IGYgKyBNYXRoLnNpbih2KSAqIHM7XHJcbiAgICAgICAgICAgICAgICBhLkFuaW1hdGUuc3RlcEJ5U3RlcChiLCB7eDogZCAtIGIud2lkdGggLyAyLCB5OiBnIC0gYi5oZWlnaHQgLyAyfSwgdSkuc3RhcnQoKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB2ID0gMDtcclxuICAgICAgICAgICAgYy5mb3JFYWNoKGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB2ICs9IDAgPT0gYiA/IG1bYl0gOiBtW2IgLSAxXSArIG1bYl07XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGUgKyBNYXRoLmNvcyh2KSAqIHIsIGQgPSBmICsgTWF0aC5zaW4odikgKiBzO1xyXG4gICAgICAgICAgICAgICAgYS5jeCA9IGMsIGEuY3kgPSBkXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7Y3g6IGUsIGN5OiBmLCByYWRpdXM6IHIsIHJhZGl1c0E6IHIsIHJhZGl1c0I6IHN9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZChhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYy5jaGlsZHM7XHJcbiAgICAgICAgICAgIGlmICghKGQubGVuZ3RoIDw9IDApKWZvciAodmFyIGUgPSBjLmdldEJvdW5kKCksIGYgPSBkWzBdLCBnID0gKGUud2lkdGggLSBmLndpZHRoKSAvIGIsIGggPSAoZS5oZWlnaHQgLSBmLmhlaWdodCkgLyBhLCBpID0gKGQubGVuZ3RoLCAwKSwgaiA9IDA7IGEgPiBqOyBqKyspZm9yICh2YXIgayA9IDA7IGIgPiBrOyBrKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBsID0gZFtpKytdLCBtID0gZS5sZWZ0ICsgZyAvIDIgKyBrICogZywgbiA9IGUudG9wICsgaCAvIDIgKyBqICogaDtcclxuICAgICAgICAgICAgICAgIGlmIChsLnNldExvY2F0aW9uKG0sIG4pLCBpID49IGQubGVuZ3RoKXJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGUoYSwgYikge1xyXG4gICAgICAgIHJldHVybiBudWxsID09IGEgJiYgKGEgPSAwKSwgbnVsbCA9PSBiICYmIChiID0gMCksIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYy5jaGlsZHM7XHJcbiAgICAgICAgICAgIGlmICghKGQubGVuZ3RoIDw9IDApKWZvciAodmFyIGUgPSBjLmdldEJvdW5kKCksIGYgPSBlLmxlZnQsIGcgPSBlLnRvcCwgaCA9IDA7IGggPCBkLmxlbmd0aDsgaCsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IGRbaF07XHJcbiAgICAgICAgICAgICAgICBmICsgaS53aWR0aCA+PSBlLnJpZ2h0ICYmIChmID0gZS5sZWZ0LCBnICs9IGIgKyBpLmhlaWdodCksIGkuc2V0TG9jYXRpb24oZiwgZyksIGYgKz0gYSArIGkud2lkdGhcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBmKCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAoYi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMWU3LCBkID0gLTFlNywgZSA9IDFlNywgZiA9IC0xZTcsIGcgPSBkIC0gYywgaCA9IGYgLSBlLCBpID0gMDsgaSA8IGIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IGJbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgai54IDw9IGMgJiYgKGMgPSBqLngpLCBqLnggPj0gZCAmJiAoZCA9IGoueCksIGoueSA8PSBlICYmIChlID0gai55KSwgai55ID49IGYgJiYgKGYgPSBqLnkpLCBnID0gZCAtIGMgKyBqLndpZHRoLCBoID0gZiAtIGUgKyBqLmhlaWdodFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYS54ID0gYywgYS55ID0gZSwgYS53aWR0aCA9IGcsIGEuaGVpZ2h0ID0gaFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGcoYikge1xyXG4gICAgICAgIHZhciBjID0gW10sIGQgPSBiLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICByZXR1cm4gYiBpbnN0YW5jZW9mIGEuTGluayA/ICEwIDogKGMucHVzaChiKSwgITEpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGIgPSBjLmZpbHRlcihmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IGQubGVuZ3RoOyBiKyspaWYgKGRbYl0ubm9kZVogPT09IGEpcmV0dXJuICExO1xyXG4gICAgICAgICAgICByZXR1cm4gITBcclxuICAgICAgICB9KSwgYiA9IGIuZmlsdGVyKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgZC5sZW5ndGg7IGIrKylpZiAoZFtiXS5ub2RlQSA9PT0gYSlyZXR1cm4gITA7XHJcbiAgICAgICAgICAgIHJldHVybiAhMVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaChhKSB7XHJcbiAgICAgICAgdmFyIGIgPSAwLCBjID0gMDtcclxuICAgICAgICByZXR1cm4gYS5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGIgKz0gYS53aWR0aCwgYyArPSBhLmhlaWdodFxyXG4gICAgICAgIH0pLCB7d2lkdGg6IGIgLyBhLmxlbmd0aCwgaGVpZ2h0OiBjIC8gYS5sZW5ndGh9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaShhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgYi54ICs9IGMsIGIueSArPSBkO1xyXG4gICAgICAgIGZvciAodmFyIGUgPSBxKGEsIGIpLCBmID0gMDsgZiA8IGUubGVuZ3RoOyBmKyspaShhLCBlW2ZdLCBjLCBkKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGooYSwgYikge1xyXG4gICAgICAgIGZ1bmN0aW9uIGMoYiwgZSkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IHEoYSwgYik7XHJcbiAgICAgICAgICAgIG51bGwgPT0gZFtlXSAmJiAoZFtlXSA9IHt9LCBkW2VdLm5vZGVzID0gW10sIGRbZV0uY2hpbGRzID0gW10pLCBkW2VdLm5vZGVzLnB1c2goYiksIGRbZV0uY2hpbGRzLnB1c2goZik7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgZi5sZW5ndGg7IGcrKyljKGZbZ10sIGUgKyAxKSwgZltnXS5wYXJlbnQgPSBiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZCA9IFtdO1xyXG4gICAgICAgIHJldHVybiBjKGIsIDApLCBkXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gayhiLCBjLCBkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGYoZiwgZykge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaCA9IGEubGF5b3V0LmdldFRyZWVEZWVwKGYsIGcpLCBrID0gaihmLCBnKSwgbCA9IGtbXCJcIiArIGhdLm5vZGVzLCBtID0gMDsgbSA8IGwubGVuZ3RoOyBtKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGxbbV0sIG8gPSAobSArIDEpICogKGMgKyAxMCksIHAgPSBoICogZDtcclxuICAgICAgICAgICAgICAgICAgICBcImRvd25cIiA9PSBiIHx8IChcInVwXCIgPT0gYiA/IHAgPSAtcCA6IFwibGVmdFwiID09IGIgPyAobyA9IC1oICogZCwgcCA9IChtICsgMSkgKiAoYyArIDEwKSkgOiBcInJpZ2h0XCIgPT0gYiAmJiAobyA9IGggKiBkLCBwID0gKG0gKyAxKSAqIChjICsgMTApKSksIG4uc2V0TG9jYXRpb24obywgcClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIHEgPSBoIC0gMTsgcSA+PSAwOyBxLS0pZm9yICh2YXIgciA9IGtbXCJcIiArIHFdLm5vZGVzLCBzID0ga1tcIlwiICsgcV0uY2hpbGRzLCBtID0gMDsgbSA8IHIubGVuZ3RoOyBtKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IHJbbV0sIHUgPSBzW21dO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcImRvd25cIiA9PSBiID8gdC55ID0gcSAqIGQgOiBcInVwXCIgPT0gYiA/IHQueSA9IC1xICogZCA6IFwibGVmdFwiID09IGIgPyB0LnggPSAtcSAqIGQgOiBcInJpZ2h0XCIgPT0gYiAmJiAodC54ID0gcSAqIGQpLCB1Lmxlbmd0aCA+IDAgPyBcImRvd25cIiA9PSBiIHx8IFwidXBcIiA9PSBiID8gdC54ID0gKHVbMF0ueCArIHVbdS5sZW5ndGggLSAxXS54KSAvIDIgOiAoXCJsZWZ0XCIgPT0gYiB8fCBcInJpZ2h0XCIgPT0gYikgJiYgKHQueSA9ICh1WzBdLnkgKyB1W3UubGVuZ3RoIC0gMV0ueSkgLyAyKSA6IG0gPiAwICYmIChcImRvd25cIiA9PSBiIHx8IFwidXBcIiA9PSBiID8gdC54ID0gclttIC0gMV0ueCArIHJbbSAtIDFdLndpZHRoICsgYyA6IChcImxlZnRcIiA9PSBiIHx8IFwicmlnaHRcIiA9PSBiKSAmJiAodC55ID0gclttIC0gMV0ueSArIHJbbSAtIDFdLmhlaWdodCArIGMpKSwgbSA+IDApaWYgKFwiZG93blwiID09IGIgfHwgXCJ1cFwiID09IGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQueCA8IHJbbSAtIDFdLnggKyByW20gLSAxXS53aWR0aClmb3IgKHZhciB2ID0gclttIC0gMV0ueCArIHJbbSAtIDFdLndpZHRoICsgYywgdyA9IE1hdGguYWJzKHYgLSB0LngpLCB4ID0gbTsgeCA8IHIubGVuZ3RoOyB4KyspaShlLmNoaWxkcywgclt4XSwgdywgMClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChcImxlZnRcIiA9PSBiIHx8IFwicmlnaHRcIiA9PSBiKSAmJiB0LnkgPCByW20gLSAxXS55ICsgclttIC0gMV0uaGVpZ2h0KWZvciAodmFyIHkgPSByW20gLSAxXS55ICsgclttIC0gMV0uaGVpZ2h0ICsgYywgeiA9IE1hdGguYWJzKHkgLSB0LnkpLCB4ID0gbTsgeCA8IHIubGVuZ3RoOyB4KyspaShlLmNoaWxkcywgclt4XSwgMCwgeilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGcgPSBudWxsO1xyXG4gICAgICAgICAgICBudWxsID09IGMgJiYgKGcgPSBoKGUuY2hpbGRzKSwgYyA9IGcud2lkdGgsIChcImxlZnRcIiA9PSBiIHx8IFwicmlnaHRcIiA9PSBiKSAmJiAoYyA9IGcud2lkdGggKyAxMCkpLCBudWxsID09IGQgJiYgKG51bGwgPT0gZyAmJiAoZyA9IGgoZS5jaGlsZHMpKSwgZCA9IDIgKiBnLmhlaWdodCksIG51bGwgPT0gYiAmJiAoYiA9IFwiZG93blwiKTtcclxuICAgICAgICAgICAgdmFyIGsgPSBhLmxheW91dC5nZXRSb290Tm9kZXMoZS5jaGlsZHMpO1xyXG4gICAgICAgICAgICBpZiAoay5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmKGUuY2hpbGRzLCBrWzBdKTtcclxuICAgICAgICAgICAgICAgIHZhciBsID0gYS51dGlsLmdldEVsZW1lbnRzQm91bmQoZS5jaGlsZHMpLCBtID0gZS5nZXRDZW50ZXJMb2NhdGlvbigpLCBuID0gbS54IC0gKGwubGVmdCArIGwucmlnaHQpIC8gMiwgbyA9IG0ueSAtIChsLnRvcCArIGwuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgICAgICAgICBlLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYiBpbnN0YW5jZW9mIGEuTm9kZSAmJiAoYi54ICs9IG4sIGIueSArPSBvKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsKGIpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gZChhLCBjLCBlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IHEoYSwgYyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoMCAhPSBmLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG51bGwgPT0gZSAmJiAoZSA9IGIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBnID0gMiAqIE1hdGguUEkgLyBmLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBmLmZvckVhY2goZnVuY3Rpb24gKGIsIGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBjLnggKyBlICogTWF0aC5jb3MoZyAqIGYpLCBpID0gYy55ICsgZSAqIE1hdGguc2luKGcgKiBmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5zZXRMb2NhdGlvbihoLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGogPSBlIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZChhLCBiLCBqKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBlID0gYS5sYXlvdXQuZ2V0Um9vdE5vZGVzKGMuY2hpbGRzKTtcclxuICAgICAgICAgICAgaWYgKGUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZChjLmNoaWxkcywgZVswXSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGEudXRpbC5nZXRFbGVtZW50c0JvdW5kKGMuY2hpbGRzKSwgZyA9IGMuZ2V0Q2VudGVyTG9jYXRpb24oKSwgaCA9IGcueCAtIChmLmxlZnQgKyBmLnJpZ2h0KSAvIDIsIGkgPSBnLnkgLSAoZi50b3AgKyBmLmJvdHRvbSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgYy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGIgaW5zdGFuY2VvZiBhLk5vZGUgJiYgKGIueCArPSBoLCBiLnkgKz0gaSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbShhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZyA9IFtdLCBoID0gMDsgYyA+IGg7IGgrKylmb3IgKHZhciBpID0gMDsgZCA+IGk7IGkrKylnLnB1c2goe3g6IGEgKyBpICogZSwgeTogYiArIGggKiBmfSk7XHJcbiAgICAgICAgcmV0dXJuIGdcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBuKGEsIGIsIGMsIGQsIGUsIGYpIHtcclxuICAgICAgICB2YXIgZyA9IGUgPyBlIDogMCwgaCA9IGYgPyBmIDogMiAqIE1hdGguUEksIGkgPSBoIC0gZywgaiA9IGkgLyBjLCBrID0gW107XHJcbiAgICAgICAgZyArPSBqIC8gMjtcclxuICAgICAgICBmb3IgKHZhciBsID0gZzsgaCA+PSBsOyBsICs9IGopIHtcclxuICAgICAgICAgICAgdmFyIG0gPSBhICsgTWF0aC5jb3MobCkgKiBkLCBuID0gYiArIE1hdGguc2luKGwpICogZDtcclxuICAgICAgICAgICAgay5wdXNoKHt4OiBtLCB5OiBufSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvKGEsIGIsIGMsIGQsIGUsIGYpIHtcclxuICAgICAgICB2YXIgZyA9IGYgfHwgXCJib3R0b21cIiwgaCA9IFtdO1xyXG4gICAgICAgIGlmIChcImJvdHRvbVwiID09IGcpZm9yICh2YXIgaSA9IGEgLSBjIC8gMiAqIGQgKyBkIC8gMiwgaiA9IDA7IGMgPj0gajsgaisrKWgucHVzaCh7XHJcbiAgICAgICAgICAgIHg6IGkgKyBqICogZCxcclxuICAgICAgICAgICAgeTogYiArIGVcclxuICAgICAgICB9KTsgZWxzZSBpZiAoXCJ0b3BcIiA9PSBnKWZvciAodmFyIGkgPSBhIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBpICsgaiAqIGQsXHJcbiAgICAgICAgICAgIHk6IGIgLSBlXHJcbiAgICAgICAgfSk7IGVsc2UgaWYgKFwicmlnaHRcIiA9PSBnKWZvciAodmFyIGkgPSBiIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBhICsgZSxcclxuICAgICAgICAgICAgeTogaSArIGogKiBkXHJcbiAgICAgICAgfSk7IGVsc2UgaWYgKFwibGVmdFwiID09IGcpZm9yICh2YXIgaSA9IGIgLSBjIC8gMiAqIGQgKyBkIC8gMiwgaiA9IDA7IGMgPj0gajsgaisrKWgucHVzaCh7eDogYSAtIGUsIHk6IGkgKyBqICogZH0pO1xyXG4gICAgICAgIHJldHVybiBoXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbShhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZyA9IFtdLCBoID0gMDsgYyA+IGg7IGgrKylmb3IgKHZhciBpID0gMDsgZCA+IGk7IGkrKylnLnB1c2goe3g6IGEgKyBpICogZSwgeTogYiArIGggKiBmfSk7XHJcbiAgICAgICAgcmV0dXJuIGdcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwKGEsIGIpIHtcclxuICAgICAgICBpZiAoYS5sYXlvdXQpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBhLmxheW91dCwgZCA9IGMudHlwZSwgZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChcImNpcmNsZVwiID09IGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gYy5yYWRpdXMgfHwgTWF0aC5tYXgoYS53aWR0aCwgYS5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgZSA9IG4oYS5jeCwgYS5jeSwgYi5sZW5ndGgsIGYsIGEubGF5b3V0LmJlZ2luQW5nbGUsIGEubGF5b3V0LmVuZEFuZ2xlKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKFwidHJlZVwiID09IGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBnID0gYy53aWR0aCB8fCA1MCwgaCA9IGMuaGVpZ2h0IHx8IDUwLCBpID0gYy5kaXJlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBlID0gbyhhLmN4LCBhLmN5LCBiLmxlbmd0aCwgZywgaCwgaSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChcImdyaWRcIiAhPSBkKXJldHVybjtcclxuICAgICAgICAgICAgICAgIGUgPSBtKGEueCwgYS55LCBjLnJvd3MsIGMuY29scywgYy5ob3Jpem9udGFsIHx8IDAsIGMudmVydGljYWwgfHwgMClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGIubGVuZ3RoOyBqKyspYltqXS5zZXRDZW50ZXJMb2NhdGlvbihlW2pdLngsIGVbal0ueSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcShiLCBjKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZCA9IFtdLCBlID0gMDsgZSA8IGIubGVuZ3RoOyBlKyspYltlXSBpbnN0YW5jZW9mIGEuTGluayAmJiBiW2VdLm5vZGVBID09PSBjICYmIGQucHVzaChiW2VdLm5vZGVaKTtcclxuICAgICAgICByZXR1cm4gZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHIoYSwgYiwgYykge1xyXG4gICAgICAgIHZhciBkID0gcShhLmNoaWxkcywgYik7XHJcbiAgICAgICAgaWYgKDAgPT0gZC5sZW5ndGgpcmV0dXJuIG51bGw7XHJcbiAgICAgICAgaWYgKHAoYiwgZCksIDEgPT0gYylmb3IgKHZhciBlID0gMDsgZSA8IGQubGVuZ3RoOyBlKyspcihhLCBkW2VdLCBjKTtcclxuICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHMoYiwgYykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGQoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IGEueCAtIGIueCwgZCA9IGEueSAtIGIueTtcclxuICAgICAgICAgICAgaSArPSBjICogZiwgaiArPSBkICogZiwgaSAqPSBnLCBqICo9IGcsIGogKz0gaCwgYi54ICs9IGksIGIueSArPSBqXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICBpZiAoISgrK2sgPiAxNTApKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gMDsgYSA8IGwubGVuZ3RoOyBhKyspbFthXSAhPSBiICYmIGQoYiwgbFthXSwgbCk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGUsIDFlMyAvIDI0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZiA9IC4wMSwgZyA9IC45NSwgaCA9IC01LCBpID0gMCwgaiA9IDAsIGsgPSAwLCBsID0gYy5nZXRFbGVtZW50c0J5Q2xhc3MoYS5Ob2RlKTtcclxuICAgICAgICBlKClcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0KGEsIGIpIHtcclxuICAgICAgICBmdW5jdGlvbiBjKGEsIGIsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBxKGEsIGIpO1xyXG4gICAgICAgICAgICBlID4gZCAmJiAoZCA9IGUpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBnID0gMDsgZyA8IGYubGVuZ3RoOyBnKyspYyhhLCBmW2ddLCBlICsgMSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBkID0gMDtcclxuICAgICAgICByZXR1cm4gYyhhLCBiLCAwKSwgZFxyXG4gICAgfVxyXG5cclxuICAgIGEubGF5b3V0ID0gYS5MYXlvdXQgPSB7XHJcbiAgICAgICAgbGF5b3V0Tm9kZTogcixcclxuICAgICAgICBnZXROb2RlQ2hpbGRzOiBxLFxyXG4gICAgICAgIGFkanVzdFBvc2l0aW9uOiBwLFxyXG4gICAgICAgIHNwcmluZ0xheW91dDogcyxcclxuICAgICAgICBnZXRUcmVlRGVlcDogdCxcclxuICAgICAgICBnZXRSb290Tm9kZXM6IGcsXHJcbiAgICAgICAgR3JpZExheW91dDogZCxcclxuICAgICAgICBGbG93TGF5b3V0OiBlLFxyXG4gICAgICAgIEF1dG9Cb3VuZExheW91dDogZixcclxuICAgICAgICBDaXJjbGVMYXlvdXQ6IGwsXHJcbiAgICAgICAgVHJlZUxheW91dDogayxcclxuICAgICAgICBnZXROb2Rlc0NlbnRlcjogYixcclxuICAgICAgICBjaXJjbGVMYXlvdXROb2RlczogY1xyXG4gICAgfVxyXG59KEpUb3BvKSwgZnVuY3Rpb24gKGEpIHtcclxuICAgIGZ1bmN0aW9uIGIoKSB7XHJcbiAgICAgICAgdmFyIGIgPSBuZXcgYS5DaXJjbGVOb2RlO1xyXG4gICAgICAgIHJldHVybiBiLnJhZGl1cyA9IDE1MCwgYi5jb2xvcnMgPSBbXCIjMzY2NkIwXCIsIFwiIzJDQThFMFwiLCBcIiM3N0QxRjZcIl0sIGIuZGF0YXMgPSBbLjMsIC4zLCAuNF0sIGIudGl0bGVzID0gW1wiQVwiLCBcIkJcIiwgXCJDXCJdLCBiLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSAyICogYi5yYWRpdXMsIGQgPSAyICogYi5yYWRpdXM7XHJcbiAgICAgICAgICAgIGIud2lkdGggPSBjLCBiLmhlaWdodCA9IGQ7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGUgPSAwLCBmID0gMDsgZiA8IHRoaXMuZGF0YXMubGVuZ3RoOyBmKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy5kYXRhc1tmXSAqIE1hdGguUEkgKiAyO1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gYi5jb2xvcnNbZl0sIGEubW92ZVRvKDAsIDApLCBhLmFyYygwLCAwLCB0aGlzLnJhZGl1cywgZSwgZSArIGcsICExKSwgYS5maWxsKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IHRoaXMudGl0bGVzW2ZdICsgXCI6IFwiICsgKDEwMCAqIHRoaXMuZGF0YXNbZl0pLnRvRml4ZWQoMikgKyBcIiVcIiwgaSA9IGEubWVhc3VyZVRleHQoaCkud2lkdGgsIGogPSAoYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aCwgKGUgKyBlICsgZykgLyAyKSwgayA9IHRoaXMucmFkaXVzICogTWF0aC5jb3MoaiksIGwgPSB0aGlzLnJhZGl1cyAqIE1hdGguc2luKGopO1xyXG4gICAgICAgICAgICAgICAgaiA+IE1hdGguUEkgLyAyICYmIGogPD0gTWF0aC5QSSA/IGsgLT0gaSA6IGogPiBNYXRoLlBJICYmIGogPCAyICogTWF0aC5QSSAqIDMgLyA0ID8gayAtPSBpIDogaiA+IDIgKiBNYXRoLlBJICogLjc1LCBhLmZpbGxTdHlsZSA9IFwiI0ZGRkZGRlwiLCBhLmZpbGxUZXh0KGgsIGssIGwpLCBhLm1vdmVUbyh0aGlzLnJhZGl1cyAqIE1hdGguY29zKGopLCB0aGlzLnJhZGl1cyAqIE1hdGguc2luKGopKSwgaiA+IE1hdGguUEkgLyAyICYmIGogPCAyICogTWF0aC5QSSAqIDMgLyA0ICYmIChrIC09IGkpLCBqID4gTWF0aC5QSSwgYS5maWxsKCksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIGUgKz0gZ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgYlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGMoKSB7XHJcbiAgICAgICAgdmFyIGIgPSBuZXcgYS5Ob2RlO1xyXG4gICAgICAgIHJldHVybiBiLnNob3dTZWxlY3RlZCA9ICExLCBiLndpZHRoID0gMjUwLCBiLmhlaWdodCA9IDE4MCwgYi5jb2xvcnMgPSBbXCIjMzY2NkIwXCIsIFwiIzJDQThFMFwiLCBcIiM3N0QxRjZcIl0sIGIuZGF0YXMgPSBbLjMsIC4zLCAuNF0sIGIudGl0bGVzID0gW1wiQVwiLCBcIkJcIiwgXCJDXCJdLCBiLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSAzLCBkID0gKHRoaXMud2lkdGggLSBjKSAvIHRoaXMuZGF0YXMubGVuZ3RoO1xyXG4gICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBcIiNGRkZGRkZcIiwgYS5zdHJva2VTdHlsZSA9IFwiI0ZGRkZGRlwiLCBhLm1vdmVUbygtdGhpcy53aWR0aCAvIDIgLSAxLCAtdGhpcy5oZWlnaHQgLyAyKSwgYS5saW5lVG8oLXRoaXMud2lkdGggLyAyIC0gMSwgdGhpcy5oZWlnaHQgLyAyICsgMyksIGEubGluZVRvKHRoaXMud2lkdGggLyAyICsgYyArIDEsIHRoaXMuaGVpZ2h0IC8gMiArIDMpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLmRhdGFzLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBiLmNvbG9yc1tlXTtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gdGhpcy5kYXRhc1tlXSwgZyA9IGUgKiAoZCArIGMpIC0gdGhpcy53aWR0aCAvIDIsIGggPSB0aGlzLmhlaWdodCAtIGYgLSB0aGlzLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxSZWN0KGcsIGgsIGQsIGYpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBcIlwiICsgcGFyc2VJbnQodGhpcy5kYXRhc1tlXSksIGogPSBhLm1lYXN1cmVUZXh0KGkpLndpZHRoLCBrID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gXCIjRkZGRkZGXCIsIGEuZmlsbFRleHQoaSwgZyArIChkIC0gaikgLyAyLCBoIC0gayksIGEuZmlsbFRleHQodGhpcy50aXRsZXNbZV0sIGcgKyAoZCAtIGopIC8gMiwgdGhpcy5oZWlnaHQgLyAyICsgayksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgYlxyXG4gICAgfVxyXG5cclxuICAgIGEuQmFyQ2hhcnROb2RlID0gYywgYS5QaWVDaGFydE5vZGUgPSBiXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihiLCBjKSB7XHJcbiAgICAgICAgdmFyIGQsIGUgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkID8gKHdpbmRvdy5jbGVhckludGVydmFsKGQpLCBlICYmIGUucHVibGlzaChcInN0b3BcIiksIHRoaXMpIDogdGhpc1xyXG4gICAgICAgICAgICB9LCBzdGFydDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5jYWxsKGEpXHJcbiAgICAgICAgICAgICAgICB9LCBjKSwgdGhpc1xyXG4gICAgICAgICAgICB9LCBvblN0b3A6IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbCA9PSBlICYmIChlID0gbmV3IGEudXRpbC5NZXNzYWdlQnVzKSwgZS5zdWJzY3JpYmUoXCJzdG9wXCIsIGIpLCB0aGlzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYyhhLCBjKSB7XHJcbiAgICAgICAgYyA9IGMgfHwge307XHJcbiAgICAgICAgdmFyIGQgPSBjLmdyYXZpdHkgfHwgLjEsIGUgPSBjLmR4IHx8IDAsIGYgPSBjLmR5IHx8IDUsIGcgPSBjLnN0b3AsIGggPSBjLmludGVydmFsIHx8IDMwLCBpID0gbmV3IGIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBnICYmIGcoKSA/IChmID0gLjUsIHRoaXMuc3RvcCgpKSA6IChmICs9IGQsIGEuc2V0TG9jYXRpb24oYS54ICsgZSwgYS55ICsgZikpXHJcbiAgICAgICAgfSwgaCk7XHJcbiAgICAgICAgcmV0dXJuIGlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkKGEsIGMsIGQsIGUsIGYpIHtcclxuICAgICAgICB2YXIgZyA9IDFlMyAvIDI0LCBoID0ge307XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBjKSB7XHJcbiAgICAgICAgICAgIHZhciBqID0gY1tpXSwgayA9IGogLSBhW2ldO1xyXG4gICAgICAgICAgICBoW2ldID0ge1xyXG4gICAgICAgICAgICAgICAgb2xkVmFsdWU6IGFbaV0sIHRhcmdldFZhbHVlOiBqLCBzdGVwOiBrIC8gZCAqIGcsIGlzRG9uZTogZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuc3RlcCA+IDAgJiYgYVtiXSA+PSB0aGlzLnRhcmdldFZhbHVlIHx8IHRoaXMuc3RlcCA8IDAgJiYgYVtiXSA8PSB0aGlzLnRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGwgPSBuZXcgYihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gITA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGQgaW4gYyloW2RdLmlzRG9uZShkKSB8fCAoYVtkXSArPSBoW2RdLnN0ZXAsIGIgPSAhMSk7XHJcbiAgICAgICAgICAgIGlmIChiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpcmV0dXJuIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZCBpbiBjKWlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBoW2RdLnRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGhbZF0udGFyZ2V0VmFsdWUgPSBoW2RdLm9sZFZhbHVlLCBoW2RdLm9sZFZhbHVlID0gZywgaFtkXS5zdGVwID0gLWhbZF0uc3RlcFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGFbZF0gPSBoW2RdLm9sZFZhbHVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9LCBnKTtcclxuICAgICAgICByZXR1cm4gbFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGUoYSkge1xyXG4gICAgICAgIG51bGwgPT0gYSAmJiAoYSA9IHt9KTtcclxuICAgICAgICB2YXIgYiA9IGEuc3ByaW5nIHx8IC4xLCBjID0gYS5mcmljdGlvbiB8fCAuOCwgZCA9IGEuZ3Jpdml0eSB8fCAwLCBlID0gKGEud2luZCB8fCAwLCBhLm1pbkxlbmd0aCB8fCAwKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpdGVtczogW10sIHRpbWVyOiBudWxsLCBpc1BhdXNlOiAhMSwgYWRkTm9kZTogZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0ge25vZGU6IGEsIHRhcmdldDogYiwgdng6IDAsIHZ5OiAwfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zLnB1c2goYyksIHRoaXNcclxuICAgICAgICAgICAgfSwgcGxheTogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcCgpLCBhID0gbnVsbCA9PSBhID8gMWUzIC8gMjQgOiBhO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBiLm5leHRGcmFtZSgpXHJcbiAgICAgICAgICAgICAgICB9LCBhKVxyXG4gICAgICAgICAgICB9LCBzdG9wOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBudWxsICE9IHRoaXMudGltZXIgJiYgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy50aW1lcilcclxuICAgICAgICAgICAgfSwgbmV4dEZyYW1lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gMDsgYSA8IHRoaXMuaXRlbXMubGVuZ3RoOyBhKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IHRoaXMuaXRlbXNbYV0sIGcgPSBmLm5vZGUsIGggPSBmLnRhcmdldCwgaSA9IGYudngsIGogPSBmLnZ5LCBrID0gaC54IC0gZy54LCBsID0gaC55IC0gZy55LCBtID0gTWF0aC5hdGFuMihsLCBrKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMCAhPSBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gaC54IC0gTWF0aC5jb3MobSkgKiBlLCBvID0gaC55IC0gTWF0aC5zaW4obSkgKiBlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpICs9IChuIC0gZy54KSAqIGIsIGogKz0gKG8gLSBnLnkpICogYlxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpICs9IGsgKiBiLCBqICs9IGwgKiBiO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgKj0gYywgaiAqPSBjLCBqICs9IGQsIGcueCArPSBpLCBnLnkgKz0gaiwgZi52eCA9IGksIGYudnkgPSBqXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZihhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbyA/IHZvaWQgZi5zdG9wKCkgOiAoYS5yb3RhdGUgKz0gZyB8fCAuMiwgdm9pZChhLnJvdGF0ZSA+IDIgKiBNYXRoLlBJICYmIChhLnJvdGF0ZSA9IDApKSlcclxuICAgICAgICAgICAgfSwgMTAwKSwgZlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jbGVhckludGVydmFsKGUpLCBmLm9uU3RvcCAmJiBmLm9uU3RvcChhKSwgZlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGUgPSAoYi5jb250ZXh0LCBudWxsKSwgZiA9IHt9LCBnID0gYi52O1xyXG4gICAgICAgIHJldHVybiBmLnJ1biA9IGMsIGYuc3RvcCA9IGQsIGYub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGYub25TdG9wID0gYSwgZlxyXG4gICAgICAgIH0sIGZcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnKGEsIGIpIHtcclxuICAgICAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmNsZWFySW50ZXJ2YWwoZyksIGgub25TdG9wICYmIGgub25TdG9wKGEpLCBoXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGIuZHggfHwgMCwgaSA9IGIuZHkgfHwgMjtcclxuICAgICAgICAgICAgcmV0dXJuIGcgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbyA/IHZvaWQgaC5zdG9wKCkgOiAoaSArPSBmLCB2b2lkKGEueSArIGEuaGVpZ2h0IDwgZS5zdGFnZS5jYW52YXMuaGVpZ2h0ID8gYS5zZXRMb2NhdGlvbihhLnggKyBkLCBhLnkgKyBpKSA6IChpID0gMCwgYygpKSkpXHJcbiAgICAgICAgICAgIH0sIDIwKSwgaFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGUgPSBiLmNvbnRleHQsIGYgPSBiLmdyYXZpdHkgfHwgLjEsIGcgPSBudWxsLCBoID0ge307XHJcbiAgICAgICAgcmV0dXJuIGgucnVuID0gZCwgaC5zdG9wID0gYywgaC5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaC5vblN0b3AgPSBhLCBoXHJcbiAgICAgICAgfSwgaFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGgoYiwgYykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGQoYywgZCwgZSwgZiwgZykge1xyXG4gICAgICAgICAgICB2YXIgaCA9IG5ldyBhLk5vZGU7XHJcbiAgICAgICAgICAgIHJldHVybiBoLnNldEltYWdlKGIuaW1hZ2UpLCBoLnNldFNpemUoYi53aWR0aCwgYi5oZWlnaHQpLCBoLnNldExvY2F0aW9uKGMsIGQpLCBoLnNob3dTZWxlY3RlZCA9ICExLCBoLmRyYWdhYmxlID0gITEsIGgucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYXJjKDAsIDAsIGUsIGYsIGcpLCBhLmNsaXAoKSwgYS5iZWdpblBhdGgoKSwgbnVsbCAhPSB0aGlzLmltYWdlID8gYS5kcmF3SW1hZ2UodGhpcy5pbWFnZSwgLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyKSA6IChhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3R5bGUuZmlsbFN0eWxlICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEucmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIpLCBhLmZpbGwoKSksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgIH0sIGhcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoYywgZSkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGMsIGcgPSBjICsgTWF0aC5QSSwgaCA9IGQoYi54LCBiLnksIGIud2lkdGgsIGYsIGcpLCBqID0gZChiLnggLSAyICsgNCAqIE1hdGgucmFuZG9tKCksIGIueSwgYi53aWR0aCwgZiArIE1hdGguUEksIGYpO1xyXG4gICAgICAgICAgICBiLnZpc2libGUgPSAhMSwgZS5hZGQoaCksIGUuYWRkKGopLCBhLkFuaW1hdGUuZ3Jhdml0eShoLCB7Y29udGV4dDogZSwgZHg6IC4zfSkucnVuKCkub25TdG9wKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGUucmVtb3ZlKGgpLCBlLnJlbW92ZShqKSwgaS5zdG9wKClcclxuICAgICAgICAgICAgfSksIGEuQW5pbWF0ZS5ncmF2aXR5KGosIHtjb250ZXh0OiBlLCBkeDogLS4yfSkucnVuKClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGYoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlKGMuYW5nbGUsIGgpLCBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgJiYgaS5vblN0b3AoYiksIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBoID0gYy5jb250ZXh0LCBpID0gKGIuc3R5bGUsIHt9KTtcclxuICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBhLCBpXHJcbiAgICAgICAgfSwgaS5ydW4gPSBmLCBpLnN0b3AgPSBnLCBpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaShhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYyhhKSB7XHJcbiAgICAgICAgICAgIGEudmlzaWJsZSA9ICEwLCBhLnJvdGF0ZSA9IE1hdGgucmFuZG9tKCk7XHJcbiAgICAgICAgICAgIHZhciBiID0gZy5zdGFnZS5jYW52YXMud2lkdGggLyAyO1xyXG4gICAgICAgICAgICBhLnggPSBiICsgTWF0aC5yYW5kb20oKSAqIChiIC0gMTAwKSAtIE1hdGgucmFuZG9tKCkgKiAoYiAtIDEwMCksIGEueSA9IGcuc3RhZ2UuY2FudmFzLmhlaWdodCwgYS52eCA9IDUgKiBNYXRoLnJhbmRvbSgpIC0gNSAqIE1hdGgucmFuZG9tKCksIGEudnkgPSAtMjVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjKGEpLCBoID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG8gPyB2b2lkIGkuc3RvcCgpIDogKGEudnkgKz0gZiwgYS54ICs9IGEudngsIGEueSArPSBhLnZ5LCB2b2lkKChhLnggPCAwIHx8IGEueCA+IGcuc3RhZ2UuY2FudmFzLndpZHRoIHx8IGEueSA+IGcuc3RhZ2UuY2FudmFzLmhlaWdodCkgJiYgKGkub25TdG9wICYmIGkub25TdG9wKGEpLCBjKGEpKSkpXHJcbiAgICAgICAgICAgIH0sIDUwKSwgaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoaClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBmID0gLjgsIGcgPSBiLmNvbnRleHQsIGggPSBudWxsLCBpID0ge307XHJcbiAgICAgICAgcmV0dXJuIGkub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGkub25TdG9wID0gYSwgaVxyXG4gICAgICAgIH0sIGkucnVuID0gZCwgaS5zdG9wID0gZSwgaVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGooKSB7XHJcbiAgICAgICAgbyA9ICEwXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaygpIHtcclxuICAgICAgICBvID0gITFcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsKGIsIGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbiA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvKXJldHVybiB2b2lkIG0uc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBmLnkgKyBoICsgTWF0aC5zaW4oaykgKiBqO1xyXG4gICAgICAgICAgICAgICAgYi5zZXRMb2NhdGlvbihiLngsIGEpLCBrICs9IGxcclxuICAgICAgICAgICAgfSwgMTAwKSwgbVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwobilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBmID0gYy5wMSwgZyA9IGMucDIsIGggPSAoYy5jb250ZXh0LCBmLnggKyAoZy54IC0gZi54KSAvIDIpLCBpID0gZi55ICsgKGcueSAtIGYueSkgLyAyLCBqID0gYS51dGlsLmdldERpc3RhbmNlKGYsIGcpIC8gMiwgayA9IE1hdGguYXRhbjIoaSwgaCksIGwgPSBjLnNwZWVkIHx8IC4yLCBtID0ge30sIG4gPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBtLnJ1biA9IGQsIG0uc3RvcCA9IGUsIG1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBtKGEsIGIpIHtcclxuICAgICAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvKXJldHVybiB2b2lkIGcuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBlLnggLSBhLngsIGMgPSBlLnkgLSBhLnksIGggPSBiICogZiwgaSA9IGMgKiBmO1xyXG4gICAgICAgICAgICAgICAgYS54ICs9IGgsIGEueSArPSBpLCAuMDEgPiBoICYmIC4xID4gaSAmJiBkKClcclxuICAgICAgICAgICAgfSwgMTAwKSwgZ1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoaClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlID0gYi5wb3NpdGlvbiwgZiA9IChiLmNvbnRleHQsIGIuZWFzaW5nIHx8IC4yKSwgZyA9IHt9LCBoID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gZy5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZy5vblN0b3AgPSBhLCBnXHJcbiAgICAgICAgfSwgZy5ydW4gPSBjLCBnLnN0b3AgPSBkLCBnXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbihhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGogPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBhLnNjYWxlWCArPSBmLCBhLnNjYWxlWSArPSBmLCBhLnNjYWxlWCA+PSBlICYmIGQoKVxyXG4gICAgICAgICAgICB9LCAxMDApLCBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICBpLm9uU3RvcCAmJiBpLm9uU3RvcChhKSwgYS5zY2FsZVggPSBnLCBhLnNjYWxlWSA9IGgsIHdpbmRvdy5jbGVhckludGVydmFsKGopXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZSA9IChiLnBvc2l0aW9uLCBiLmNvbnRleHQsIGIuc2NhbGUgfHwgMSksIGYgPSAuMDYsIGcgPSBhLnNjYWxlWCwgaCA9IGEuc2NhbGVZLCBpID0ge30sIGogPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGEsIGlcclxuICAgICAgICB9LCBpLnJ1biA9IGMsIGkuc3RvcCA9IGQsIGlcclxuICAgIH1cclxuXHJcbiAgICBhLkFuaW1hdGUgPSB7fSwgYS5FZmZlY3QgPSB7fTtcclxuICAgIHZhciBvID0gITE7XHJcbiAgICBhLkVmZmVjdC5zcHJpbmcgPSBlLCBhLkVmZmVjdC5ncmF2aXR5ID0gYywgYS5BbmltYXRlLnN0ZXBCeVN0ZXAgPSBkLCBhLkFuaW1hdGUucm90YXRlID0gZiwgYS5BbmltYXRlLnNjYWxlID0gbiwgYS5BbmltYXRlLm1vdmUgPSBtLCBhLkFuaW1hdGUuY3ljbGUgPSBsLCBhLkFuaW1hdGUucmVwZWF0VGhyb3cgPSBpLCBhLkFuaW1hdGUuZGl2aWRlZFR3b1BpZWNlID0gaCwgYS5BbmltYXRlLmdyYXZpdHkgPSBnLCBhLkFuaW1hdGUuc3RhcnRBbGwgPSBrLCBhLkFuaW1hdGUuc3RvcEFsbCA9IGpcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKGEsIGIpIHtcclxuICAgICAgICB2YXIgYyA9IFtdO1xyXG4gICAgICAgIGlmICgwID09IGEubGVuZ3RoKXJldHVybiBjO1xyXG4gICAgICAgIHZhciBkID0gYi5tYXRjaCgvXlxccyooXFx3KylcXHMqJC8pO1xyXG4gICAgICAgIGlmIChudWxsICE9IGQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSBhLmZpbHRlcihmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGEuZWxlbWVudFR5cGUgPT0gZFsxXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbnVsbCAhPSBlICYmIGUubGVuZ3RoID4gMCAmJiAoYyA9IGMuY29uY2F0KGUpKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBmID0gITE7XHJcbiAgICAgICAgICAgIGlmIChkID0gYi5tYXRjaCgvXFxzKihcXHcrKVxccypcXFtcXHMqKFxcdyspXFxzKihbPj08XSlcXHMqWydcIl0oXFxTKylbJ1wiXVxccypcXF1cXHMqLyksIChudWxsID09IGQgfHwgZC5sZW5ndGggPCA1KSAmJiAoZCA9IGIubWF0Y2goL1xccyooXFx3KylcXHMqXFxbXFxzKihcXHcrKVxccyooWz49PF0pXFxzKihcXGQrKFxcLlxcZCspPylcXHMqXFxdXFxzKi8pLCBmID0gITApLCBudWxsICE9IGQgJiYgZC5sZW5ndGggPj0gNSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGcgPSBkWzFdLCBoID0gZFsyXSwgaSA9IGRbM10sIGogPSBkWzRdO1xyXG4gICAgICAgICAgICAgICAgZSA9IGEuZmlsdGVyKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEuZWxlbWVudFR5cGUgIT0gZylyZXR1cm4gITE7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhW2hdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxID09IGYgJiYgKGIgPSBwYXJzZUludChiKSksIFwiPVwiID09IGkgPyBiID09IGogOiBcIj5cIiA9PSBpID8gYiA+IGogOiBcIjxcIiA9PSBpID8gaiA+IGIgOiBcIjw9XCIgPT0gaSA/IGogPj0gYiA6IFwiPj1cIiA9PSBpID8gYiA+PSBqIDogXCIhPVwiID09IGkgPyBiICE9IGogOiAhMVxyXG4gICAgICAgICAgICAgICAgfSksIG51bGwgIT0gZSAmJiBlLmxlbmd0aCA+IDAgJiYgKGMgPSBjLmNvbmNhdChlKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGMoYSkge1xyXG4gICAgICAgIGlmIChhLmZpbmQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQuY2FsbCh0aGlzLCBhKVxyXG4gICAgICAgICAgICB9LCBlLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIGFbYl0gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5sZW5ndGg7IGMrKyl0aGlzW2NdW2JdKGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLCBhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBhWzBdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjIGluIGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gYltjXTtcclxuICAgICAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZiAmJiAhZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhW2NdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gW10sIGQgPSAwOyBkIDwgYS5sZW5ndGg7IGQrKyljLnB1c2goYi5hcHBseShhW2RdLCBhcmd1bWVudHMpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KGYpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGEuYXR0ciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IGEgJiYgbnVsbCAhPSBiKWZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5sZW5ndGg7IGMrKyl0aGlzW2NdW2FdID0gYjsgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBhICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gW10sIGMgPSAwOyBjIDwgdGhpcy5sZW5ndGg7IGMrKylkLnB1c2godGhpc1tjXVthXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGEpZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLmxlbmd0aDsgYysrKWZvciAodmFyIGUgaW4gYSl0aGlzW2NdW2VdID0gYVtlXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgfSwgYVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGQoZCkge1xyXG4gICAgICAgIHZhciBlID0gW10sIGYgPSBbXTtcclxuICAgICAgICB0aGlzIGluc3RhbmNlb2YgYS5TdGFnZSA/IChlID0gdGhpcy5jaGlsZHMsIGYgPSBmLmNvbmNhdChlKSkgOiB0aGlzIGluc3RhbmNlb2YgYS5TY2VuZSA/IGUgPSBbdGhpc10gOiBmID0gdGhpcywgZS5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGYgPSBmLmNvbmNhdChhLmNoaWxkcylcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZyA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGcgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGQgPyBmLmZpbHRlcihkKSA6IGIoZiwgZCksIGcgPSBjKGcpXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGUgPSBcImNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZWRyYWcsa2V5ZG93bixrZXl1cFwiLnNwbGl0KFwiLFwiKTtcclxuICAgIGEuU3RhZ2UucHJvdG90eXBlLmZpbmQgPSBkLCBhLlNjZW5lLnByb3RvdHlwZS5maW5kID0gZFxyXG59KEpUb3BvKSwgZnVuY3Rpb24gKGEpIHtcclxuICAgIGZ1bmN0aW9uIGIoYSwgYikge1xyXG4gICAgICAgIHRoaXMueCA9IGEsIHRoaXMueSA9IGJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjKGEpIHtcclxuICAgICAgICB0aGlzLnAgPSBuZXcgYigwLCAwKSwgdGhpcy53ID0gbmV3IGIoMSwgMCksIHRoaXMucGFpbnQgPSBhXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZChhLCBiLCBjKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBiID4gZTsgZSsrKWEoKSwgYyAmJiBkLnR1cm4oYyksIGQubW92ZSgzKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlKGEsIGIpIHtcclxuICAgICAgICB2YXIgYyA9IDIgKiBNYXRoLlBJO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgYiA+IGU7IGUrKylhKCksIGQudHVybihjIC8gYilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZihhLCBiLCBjKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBiID4gZTsgZSsrKWEoKSwgZC5yZXNpemUoYylcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZyhhKSB7XHJcbiAgICAgICAgdmFyIGIgPSAyICogTWF0aC5QSTtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGEgPiBkOyBkKyspYy5mb3J3YXJkKDEpLCBjLnR1cm4oYiAvIGEpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGgoYSkge1xyXG4gICAgICAgIHZhciBiID0gNCAqIE1hdGguUEk7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBhID4gZDsgZCsrKWMuZm9yd2FyZCgxKSwgYy50dXJuKGIgLyBhKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgZiA9IDA7IGIgPiBmOyBmKyspYSgpLCBlLmZvcndhcmQoMSksIGUudHVybihjKSwgZS5yZXNpemUoZClcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGogPSB7fTtcclxuICAgIGMucHJvdG90eXBlLmZvcndhcmQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIHZhciBiID0gdGhpcy5wLCBjID0gdGhpcy53O1xyXG4gICAgICAgIHJldHVybiBiLnggPSBiLnggKyBhICogYy54LCBiLnkgPSBiLnkgKyBhICogYy55LCB0aGlzLnBhaW50ICYmIHRoaXMucGFpbnQoYi54LCBiLnkpLCB0aGlzXHJcbiAgICB9LCBjLnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB2YXIgYiA9IHRoaXMucCwgYyA9IHRoaXMudztcclxuICAgICAgICByZXR1cm4gYi54ID0gYi54ICsgYSAqIGMueCwgYi55ID0gYi55ICsgYSAqIGMueSwgdGhpc1xyXG4gICAgfSwgYy5wcm90b3R5cGUubW92ZVRvID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wLnggPSBhLCB0aGlzLnAueSA9IGIsIHRoaXNcclxuICAgIH0sIGMucHJvdG90eXBlLnR1cm4gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIHZhciBiID0gKHRoaXMucCwgdGhpcy53KSwgYyA9IE1hdGguY29zKGEpICogYi54IC0gTWF0aC5zaW4oYSkgKiBiLnksIGQgPSBNYXRoLnNpbihhKSAqIGIueCArIE1hdGguY29zKGEpICogYi55O1xyXG4gICAgICAgIHJldHVybiBiLnggPSBjLCBiLnkgPSBkLCB0aGlzXHJcbiAgICB9LCBjLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIHZhciBiID0gdGhpcy53O1xyXG4gICAgICAgIHJldHVybiBiLnggPSBiLnggKiBhLCBiLnkgPSBiLnkgKiBhLCB0aGlzXHJcbiAgICB9LCBjLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsID09IHRoaXMuX3N0YWNrICYmICh0aGlzLl9zdGFjayA9IFtdKSwgdGhpcy5fc3RhY2sucHVzaChbdGhpcy5wLCB0aGlzLnddKSwgdGhpc1xyXG4gICAgfSwgYy5wcm90b3R5cGUucmVzdG9yZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAobnVsbCAhPSB0aGlzLl9zdGFjayAmJiB0aGlzLl9zdGFjay5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gdGhpcy5fc3RhY2sucG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMucCA9IGFbMF0sIHRoaXMudyA9IGFbMV1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgIH0sIGouVG9ydG9pc2UgPSBjLCBqLnNoaWZ0ID0gZCwgai5zcGluID0gZSwgai5wb2x5Z29uID0gZywgai5zcGlyYWwgPSBpLCBqLnN0YXIgPSBoLCBqLnNjYWxlID0gZiwgYS5Mb2dvID0galxyXG59KHdpbmRvdyk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jb3JlL2p0b3BvL2p0b3BvLW1pbi5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9');
},function(module,exports){eval('/**\r\n * Created by qiyc on 2017/2/6.\r\n */\r\nvar ruler;\r\nvar util = {\r\n    toJson:function(json){\r\n        if (typeof json == \'string\') {\r\n            json = $.parseJSON(json.replace(/\'/g, \'"\'));\r\n        }\r\n        return json;\r\n    },\r\n    upFirst: function (string) {\r\n        return string.replace(/(^|\\s+)\\w/g, function (s) {\r\n            return s.toUpperCase();//首字母大寫\r\n        })\r\n    },\r\n    extend: function (base, config) {\r\n        try {\r\n            if (typeof base == "object" && typeof config == "object") {\r\n                deep(base, config);\r\n            }\r\n            else {\r\n                console.error("some extend error:", base, config);\r\n            }\r\n        } catch (e) {\r\n            console.error("extend error", e, base, config);\r\n        }\r\n        function deep(attr, config) {\r\n            $.each(attr, function (key, value) {\r\n                if(base.arrow&&key=="size"){\r\n                }\r\n                if (attr[key]&&typeof attr[key] == "object" && typeof config[key] == "object") {\r\n                    if ($.isArray(attr[key]) && $.isArray(config[key])) {\r\n                        attr[key] = config[key];\r\n                    } else if ($.isFunction(attr[key]) && $.isFunction(config[key])) {\r\n                        attr[key] = config[key];\r\n                    } else {\r\n                        deep(attr[key], config[key]);\r\n                    }\r\n                } else if (typeof attr[key] != "undefined" && typeof config[key] != "undefined") {\r\n                    attr[key] = config[key];\r\n                }\r\n            });\r\n        }\r\n\r\n        return base;\r\n    },\r\n    merge:function(object,config){\r\n        if(object&&config&&typeof object=="object"&&typeof config=="object"){\r\n            deep(object,config);\r\n        }\r\n        function deep(source,target){\r\n            $.each(source,function(k,v){\r\n                if(v&&typeof v=="object"){\r\n                    if(!target[k]){\r\n                        target[k]={};\r\n                        deep(v,target[k]);\r\n                    }\r\n                }else\r\n                if(!target[k]){\r\n                    target[k]=v;\r\n                }\r\n            })\r\n        }\r\n        return config;\r\n    },\r\n    getParameter: function (param) {\r\n        var query = window.location.search;//获取URL地址中？后的所有字符\r\n        var iLen = param.length;//获取你的参数名称长度\r\n        var iStart = query.indexOf(param);//获取你该参数名称的其实索引\r\n        if (iStart == -1)//-1为没有该参数\r\n            return "";\r\n        iStart += iLen + 1;\r\n        var iEnd = query.indexOf("&", iStart);//获取第二个参数的其实索引\r\n        if (iEnd == -1)//只有一个参数\r\n            return query.substring(iStart);//获取单个参数的参数值\r\n        return query.substring(iStart, iEnd);//获取第二个参数的值\r\n    },\r\n    //仅画布全屏展示\r\n    runPrefixMethod: function (element, method) {\r\n        var usablePrefixMethod;\r\n        ["webkit", "moz", "ms", "o", ""].forEach(function (prefix) {\r\n                if (usablePrefixMethod) return;\r\n                if (prefix === "") {\r\n                    // 无前缀，方法首字母小写\r\n                    method = method.slice(0, 1).toLowerCase() + method.slice(1);\r\n                }\r\n                var typePrefixMethod = typeof element[prefix + method];\r\n                if (typePrefixMethod + "" !== "undefined") {\r\n                    if (typePrefixMethod === "function") {\r\n                        usablePrefixMethod = element[prefix + method]();\r\n                    } else {\r\n                        usablePrefixMethod = element[prefix + method];\r\n                    }\r\n                }\r\n            }\r\n        );\r\n    },\r\n    //浏览器全屏展示\r\n    launchFullScreen: function (element) {\r\n        if (element.requestFullscreen) {\r\n            element.requestFullscreen();\r\n        } else if (element.mozRequestFullScreen) {\r\n            element.mozRequestFullScreen();\r\n        } else if (element.webkitRequestFullscreen) {\r\n            element.webkitRequestFullscreen();\r\n        } else if (element.msRequestFullscreen) {\r\n            element.msRequestFullscreen();\r\n        }\r\n    },\r\n    //关闭浏览器全屏\r\n    exitFullScreen: function (doc) {\r\n        if (doc.exitFullscreen) {\r\n            doc.exitFullscreen();\r\n        } else if (doc.mozCancelFullScreen) {\r\n            doc.mozCancelFullScreen();\r\n        } else if (doc.webkitExitFullscreen) {\r\n            doc.webkitExitFullscreen();\r\n        }\r\n    },\r\n    //16进制转换\r\n    transHex: function (color) {\r\n        if (color && color.length == 7 && color.charAt(0) == \'#\') {\r\n            var a = parseInt(color.substr(1, 2), 16);\r\n            var b = parseInt(color.substr(3, 2), 16);\r\n            var c = parseInt(color.substr(5, 2), 16);\r\n            return a + \',\' + b + \',\' + c;\r\n        } else {\r\n            return color;\r\n        }\r\n    },\r\n    //切换隐藏\r\n    toggleElemnts: function (arr, visiable) {\r\n        if (arr && arr instanceof Array) {\r\n            $.each(arr, function (i, v) {\r\n                if (typeof(visiable) == \'boolean\') {\r\n                    visiable ? v.show() : v.hide();\r\n                } else {\r\n                    v.visible ? v.hide() : v.show();\r\n                }\r\n            });\r\n        }\r\n    },\r\n    //如果数组中不存在则存入，否则不做操作\r\n    arrayPush: function (arr, value) {\r\n        if (arr.indexOf(value) < 0) {\r\n            arr.push(value);\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //如果数组中不存在则删除，否则不做操作\r\n    arrayDelete: function (arr, value) {\r\n        var i = arr.indexOf(value);\r\n        if (i >= 0) {\r\n            arr.splice(i, 1);\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //批量设值\r\n    setAttr: function (element, object) {\r\n        $.each(object, function (key, value) {\r\n            element.prop[key] = value;\r\n        });\r\n    }, /**\r\n     * 构造类继承关系\r\n     * @memberOf module:zrender/tool/util\r\n     * @param {Function} clazz 源类\r\n     * @param {Function} baseClazz 基类\r\n     */\r\n    inherits: function (clazz, baseClazz) {\r\n        var clazzPrototype = clazz.prototype;\r\n\r\n        function F() {\r\n        }\r\n\r\n        F.prototype = baseClazz.prototype;\r\n        clazz.prototype = new F();\r\n\r\n        for (var prop in clazzPrototype) {\r\n            clazz.prototype[prop] = clazzPrototype[prop];\r\n        }\r\n        clazz.constructor = clazz;\r\n    },\r\n    //显示名字\r\n    showName: function (element) {\r\n        element.text = element.prop.name;\r\n    },\r\n    hideName: function (element) {\r\n        element.text = \'\';\r\n    },\r\n    //深度克隆对象\r\n    deepClone: function (obj) {\r\n        var result, oClass = isClass(obj);\r\n        //确定result的类型\r\n        if (oClass === "Object") {\r\n            result = {};\r\n        } else if (oClass === "Array") {\r\n            result = [];\r\n        } else {\r\n            return obj;\r\n        }\r\n        for (key in obj) {\r\n            var copy = obj[key];\r\n            if (isClass(copy) == "Object") {\r\n                result[key] = arguments.callee(copy);//递归调用\r\n            } else if (isClass(copy) == "Array") {\r\n                result[key] = arguments.callee(copy);\r\n            } else {\r\n                result[key] = obj[key];\r\n            }\r\n        }\r\n        return result;\r\n        function isClass(o) {\r\n            if (o === null) return "Null";\r\n            if (o === undefined) return "Undefined";\r\n            return Object.prototype.toString.call(o).slice(8, -1);\r\n        }\r\n    },\r\n    //获取当前屏幕正中心\r\n    getCenterPosition: function (scene) {\r\n        return {\r\n            x: -scene.translateX + $(window).width() / 2,\r\n            y: -scene.translateY + $(window).height() / 2\r\n        }\r\n    },\r\n    //闪烁\r\n    nodeFlash: function (node, n) {\r\n        if (n == 0) {\r\n            node.selected = false;\r\n            return;\r\n        }\r\n        node.selected = !node.selected;\r\n        setTimeout(function () {\r\n            util.nodeFlash(node, n - 1);\r\n        }, 300);\r\n    },\r\n    //图层平移到节点上\r\n    nodeAsCenter: function (scene, node) {\r\n        if (node) {\r\n            var location = node.getCenterLocation();\r\n            // 查询到的节点居中显示\r\n            if (scene.childs.indexOf(node) > -1) {\r\n                scene.scaleX = 1;\r\n                scene.scaleY = 1;\r\n                scene.setCenter(location.x, location.y);\r\n                // 闪烁几下\r\n                util.nodeFlash(node, 6);\r\n            }\r\n        }\r\n    },//获取字符串长度\r\n    getStringWidth: function (text, size) {\r\n        if (!ruler) {\r\n            ruler = $("span[name=topo_get_string_Width]");\r\n        }\r\n        ruler.text(text);\r\n        if (size) {\r\n            ruler.css("fontSize", size);\r\n        } else {\r\n            ruler.css("fontSize", "14px");\r\n        }\r\n        return ruler[0].offsetWidth;\r\n    }\r\n};\r\nmodule.exports = util;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL3V0aWwuanM/ZjQ1MiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwyQ0FBMkM7QUFDM0MsZ0NBQWdDO0FBQ2hDLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQSwyQ0FBMkM7QUFDM0MsNkNBQTZDO0FBQzdDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsZUFBZSxTQUFTO0FBQ3hCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzYuXHJcbiAqL1xyXG52YXIgcnVsZXI7XHJcbnZhciB1dGlsID0ge1xyXG4gICAgdG9Kc29uOmZ1bmN0aW9uKGpzb24pe1xyXG4gICAgICAgIGlmICh0eXBlb2YganNvbiA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBqc29uID0gJC5wYXJzZUpTT04oanNvbi5yZXBsYWNlKC8nL2csICdcIicpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGpzb247XHJcbiAgICB9LFxyXG4gICAgdXBGaXJzdDogZnVuY3Rpb24gKHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKF58XFxzKylcXHcvZywgZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHMudG9VcHBlckNhc2UoKTsvL+mmluWtl+avjeWkp+Wvq1xyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgZXh0ZW5kOiBmdW5jdGlvbiAoYmFzZSwgY29uZmlnKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBiYXNlID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGNvbmZpZyA9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBkZWVwKGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwic29tZSBleHRlbmQgZXJyb3I6XCIsIGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJleHRlbmQgZXJyb3JcIiwgZSwgYmFzZSwgY29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZGVlcChhdHRyLCBjb25maWcpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGF0dHIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZihiYXNlLmFycm93JiZrZXk9PVwic2l6ZVwiKXtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChhdHRyW2tleV0mJnR5cGVvZiBhdHRyW2tleV0gPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgY29uZmlnW2tleV0gPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoYXR0cltrZXldKSAmJiAkLmlzQXJyYXkoY29uZmlnW2tleV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJC5pc0Z1bmN0aW9uKGF0dHJba2V5XSkgJiYgJC5pc0Z1bmN0aW9uKGNvbmZpZ1trZXldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyW2tleV0gPSBjb25maWdba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWVwKGF0dHJba2V5XSwgY29uZmlnW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGF0dHJba2V5XSAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBjb25maWdba2V5XSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cltrZXldID0gY29uZmlnW2tleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGJhc2U7XHJcbiAgICB9LFxyXG4gICAgbWVyZ2U6ZnVuY3Rpb24ob2JqZWN0LGNvbmZpZyl7XHJcbiAgICAgICAgaWYob2JqZWN0JiZjb25maWcmJnR5cGVvZiBvYmplY3Q9PVwib2JqZWN0XCImJnR5cGVvZiBjb25maWc9PVwib2JqZWN0XCIpe1xyXG4gICAgICAgICAgICBkZWVwKG9iamVjdCxjb25maWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBkZWVwKHNvdXJjZSx0YXJnZXQpe1xyXG4gICAgICAgICAgICAkLmVhY2goc291cmNlLGZ1bmN0aW9uKGssdil7XHJcbiAgICAgICAgICAgICAgICBpZih2JiZ0eXBlb2Ygdj09XCJvYmplY3RcIil7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXRhcmdldFtrXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFtrXT17fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVlcCh2LHRhcmdldFtrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfWVsc2VcclxuICAgICAgICAgICAgICAgIGlmKCF0YXJnZXRba10pe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFtrXT12O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29uZmlnO1xyXG4gICAgfSxcclxuICAgIGdldFBhcmFtZXRlcjogZnVuY3Rpb24gKHBhcmFtKSB7XHJcbiAgICAgICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDsvL+iOt+WPllVSTOWcsOWdgOS4re+8n+WQjueahOaJgOacieWtl+esplxyXG4gICAgICAgIHZhciBpTGVuID0gcGFyYW0ubGVuZ3RoOy8v6I635Y+W5L2g55qE5Y+C5pWw5ZCN56ew6ZW/5bqmXHJcbiAgICAgICAgdmFyIGlTdGFydCA9IHF1ZXJ5LmluZGV4T2YocGFyYW0pOy8v6I635Y+W5L2g6K+l5Y+C5pWw5ZCN56ew55qE5YW25a6e57Si5byVXHJcbiAgICAgICAgaWYgKGlTdGFydCA9PSAtMSkvLy0x5Li65rKh5pyJ6K+l5Y+C5pWwXHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgIGlTdGFydCArPSBpTGVuICsgMTtcclxuICAgICAgICB2YXIgaUVuZCA9IHF1ZXJ5LmluZGV4T2YoXCImXCIsIGlTdGFydCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICBpZiAoaUVuZCA9PSAtMSkvL+WPquacieS4gOS4quWPguaVsFxyXG4gICAgICAgICAgICByZXR1cm4gcXVlcnkuc3Vic3RyaW5nKGlTdGFydCk7Ly/ojrflj5bljZXkuKrlj4LmlbDnmoTlj4LmlbDlgLxcclxuICAgICAgICByZXR1cm4gcXVlcnkuc3Vic3RyaW5nKGlTdGFydCwgaUVuZCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlgLxcclxuICAgIH0sXHJcbiAgICAvL+S7heeUu+W4g+WFqOWxj+WxleekulxyXG4gICAgcnVuUHJlZml4TWV0aG9kOiBmdW5jdGlvbiAoZWxlbWVudCwgbWV0aG9kKSB7XHJcbiAgICAgICAgdmFyIHVzYWJsZVByZWZpeE1ldGhvZDtcclxuICAgICAgICBbXCJ3ZWJraXRcIiwgXCJtb3pcIiwgXCJtc1wiLCBcIm9cIiwgXCJcIl0uZm9yRWFjaChmdW5jdGlvbiAocHJlZml4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNhYmxlUHJlZml4TWV0aG9kKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBpZiAocHJlZml4ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5peg5YmN57yA77yM5pa55rOV6aaW5a2X5q+N5bCP5YaZXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gbWV0aG9kLnNsaWNlKDAsIDEpLnRvTG93ZXJDYXNlKCkgKyBtZXRob2Quc2xpY2UoMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZVByZWZpeE1ldGhvZCA9IHR5cGVvZiBlbGVtZW50W3ByZWZpeCArIG1ldGhvZF07XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZVByZWZpeE1ldGhvZCArIFwiXCIgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZVByZWZpeE1ldGhvZCA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzYWJsZVByZWZpeE1ldGhvZCA9IGVsZW1lbnRbcHJlZml4ICsgbWV0aG9kXSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzYWJsZVByZWZpeE1ldGhvZCA9IGVsZW1lbnRbcHJlZml4ICsgbWV0aG9kXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfSxcclxuICAgIC8v5rWP6KeI5Zmo5YWo5bGP5bGV56S6XHJcbiAgICBsYXVuY2hGdWxsU2NyZWVuOiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIGlmIChlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQubW96UmVxdWVzdEZ1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICBlbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgZWxlbWVudC5tc1JlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5YWz6Zet5rWP6KeI5Zmo5YWo5bGPXHJcbiAgICBleGl0RnVsbFNjcmVlbjogZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIGlmIChkb2MuZXhpdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgZG9jLmV4aXRGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkb2MubW96Q2FuY2VsRnVsbFNjcmVlbikge1xyXG4gICAgICAgICAgICBkb2MubW96Q2FuY2VsRnVsbFNjcmVlbigpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZG9jLndlYmtpdEV4aXRGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgIGRvYy53ZWJraXRFeGl0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLzE26L+b5Yi26L2s5o2iXHJcbiAgICB0cmFuc0hleDogZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICAgICAgaWYgKGNvbG9yICYmIGNvbG9yLmxlbmd0aCA9PSA3ICYmIGNvbG9yLmNoYXJBdCgwKSA9PSAnIycpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBwYXJzZUludChjb2xvci5zdWJzdHIoMSwgMiksIDE2KTtcclxuICAgICAgICAgICAgdmFyIGIgPSBwYXJzZUludChjb2xvci5zdWJzdHIoMywgMiksIDE2KTtcclxuICAgICAgICAgICAgdmFyIGMgPSBwYXJzZUludChjb2xvci5zdWJzdHIoNSwgMiksIDE2KTtcclxuICAgICAgICAgICAgcmV0dXJuIGEgKyAnLCcgKyBiICsgJywnICsgYztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gY29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5YiH5o2i6ZqQ6JePXHJcbiAgICB0b2dnbGVFbGVtbnRzOiBmdW5jdGlvbiAoYXJyLCB2aXNpYWJsZSkge1xyXG4gICAgICAgIGlmIChhcnIgJiYgYXJyIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGFyciwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YodmlzaWFibGUpID09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZpc2lhYmxlID8gdi5zaG93KCkgOiB2LmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdi52aXNpYmxlID8gdi5oaWRlKCkgOiB2LnNob3coKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5a2Y5YWl77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICBhcnJheVB1c2g6IGZ1bmN0aW9uIChhcnIsIHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKGFyci5pbmRleE9mKHZhbHVlKSA8IDApIHtcclxuICAgICAgICAgICAgYXJyLnB1c2godmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8v5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5Yig6Zmk77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICBhcnJheURlbGV0ZTogZnVuY3Rpb24gKGFyciwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgaSA9IGFyci5pbmRleE9mKHZhbHVlKTtcclxuICAgICAgICBpZiAoaSA+PSAwKSB7XHJcbiAgICAgICAgICAgIGFyci5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgLy/mibnph4/orr7lgLxcclxuICAgIHNldEF0dHI6IGZ1bmN0aW9uIChlbGVtZW50LCBvYmplY3QpIHtcclxuICAgICAgICAkLmVhY2gob2JqZWN0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBlbGVtZW50LnByb3Bba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSwgLyoqXHJcbiAgICAgKiDmnoTpgKDnsbvnu6fmib/lhbPns7tcclxuICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6enJlbmRlci90b29sL3V0aWxcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNsYXp6IOa6kOexu1xyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYmFzZUNsYXp6IOWfuuexu1xyXG4gICAgICovXHJcbiAgICBpbmhlcml0czogZnVuY3Rpb24gKGNsYXp6LCBiYXNlQ2xhenopIHtcclxuICAgICAgICB2YXIgY2xhenpQcm90b3R5cGUgPSBjbGF6ei5wcm90b3R5cGU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEYoKSB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBGLnByb3RvdHlwZSA9IGJhc2VDbGF6ei5wcm90b3R5cGU7XHJcbiAgICAgICAgY2xhenoucHJvdG90eXBlID0gbmV3IEYoKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBjbGF6elByb3RvdHlwZSkge1xyXG4gICAgICAgICAgICBjbGF6ei5wcm90b3R5cGVbcHJvcF0gPSBjbGF6elByb3RvdHlwZVtwcm9wXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2xhenouY29uc3RydWN0b3IgPSBjbGF6ejtcclxuICAgIH0sXHJcbiAgICAvL+aYvuekuuWQjeWtl1xyXG4gICAgc2hvd05hbWU6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbWVudC50ZXh0ID0gZWxlbWVudC5wcm9wLm5hbWU7XHJcbiAgICB9LFxyXG4gICAgaGlkZU5hbWU6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbWVudC50ZXh0ID0gJyc7XHJcbiAgICB9LFxyXG4gICAgLy/mt7HluqblhYvpmoblr7nosaFcclxuICAgIGRlZXBDbG9uZTogZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgIHZhciByZXN1bHQsIG9DbGFzcyA9IGlzQ2xhc3Mob2JqKTtcclxuICAgICAgICAvL+ehruWumnJlc3VsdOeahOexu+Wei1xyXG4gICAgICAgIGlmIChvQ2xhc3MgPT09IFwiT2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge307XHJcbiAgICAgICAgfSBlbHNlIGlmIChvQ2xhc3MgPT09IFwiQXJyYXlcIikge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGtleSBpbiBvYmopIHtcclxuICAgICAgICAgICAgdmFyIGNvcHkgPSBvYmpba2V5XTtcclxuICAgICAgICAgICAgaWYgKGlzQ2xhc3MoY29weSkgPT0gXCJPYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBhcmd1bWVudHMuY2FsbGVlKGNvcHkpOy8v6YCS5b2S6LCD55SoXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNDbGFzcyhjb3B5KSA9PSBcIkFycmF5XCIpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gYXJndW1lbnRzLmNhbGxlZShjb3B5KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gb2JqW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICBmdW5jdGlvbiBpc0NsYXNzKG8pIHtcclxuICAgICAgICAgICAgaWYgKG8gPT09IG51bGwpIHJldHVybiBcIk51bGxcIjtcclxuICAgICAgICAgICAgaWYgKG8gPT09IHVuZGVmaW5lZCkgcmV0dXJuIFwiVW5kZWZpbmVkXCI7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+iOt+WPluW9k+WJjeWxj+W5leato+S4reW/g1xyXG4gICAgZ2V0Q2VudGVyUG9zaXRpb246IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHg6IC1zY2VuZS50cmFuc2xhdGVYICsgJCh3aW5kb3cpLndpZHRoKCkgLyAyLFxyXG4gICAgICAgICAgICB5OiAtc2NlbmUudHJhbnNsYXRlWSArICQod2luZG93KS5oZWlnaHQoKSAvIDJcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/pl6rng4FcclxuICAgIG5vZGVGbGFzaDogZnVuY3Rpb24gKG5vZGUsIG4pIHtcclxuICAgICAgICBpZiAobiA9PSAwKSB7XHJcbiAgICAgICAgICAgIG5vZGUuc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBub2RlLnNlbGVjdGVkID0gIW5vZGUuc2VsZWN0ZWQ7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHV0aWwubm9kZUZsYXNoKG5vZGUsIG4gLSAxKTtcclxuICAgICAgICB9LCAzMDApO1xyXG4gICAgfSxcclxuICAgIC8v5Zu+5bGC5bmz56e75Yiw6IqC54K55LiKXHJcbiAgICBub2RlQXNDZW50ZXI6IGZ1bmN0aW9uIChzY2VuZSwgbm9kZSkge1xyXG4gICAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IG5vZGUuZ2V0Q2VudGVyTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgLy8g5p+l6K+i5Yiw55qE6IqC54K55bGF5Lit5pi+56S6XHJcbiAgICAgICAgICAgIGlmIChzY2VuZS5jaGlsZHMuaW5kZXhPZihub2RlKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBzY2VuZS5zY2FsZVggPSAxO1xyXG4gICAgICAgICAgICAgICAgc2NlbmUuc2NhbGVZID0gMTtcclxuICAgICAgICAgICAgICAgIHNjZW5lLnNldENlbnRlcihsb2NhdGlvbi54LCBsb2NhdGlvbi55KTtcclxuICAgICAgICAgICAgICAgIC8vIOmXqueDgeWHoOS4i1xyXG4gICAgICAgICAgICAgICAgdXRpbC5ub2RlRmxhc2gobm9kZSwgNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LC8v6I635Y+W5a2X56ym5Liy6ZW/5bqmXHJcbiAgICBnZXRTdHJpbmdXaWR0aDogZnVuY3Rpb24gKHRleHQsIHNpemUpIHtcclxuICAgICAgICBpZiAoIXJ1bGVyKSB7XHJcbiAgICAgICAgICAgIHJ1bGVyID0gJChcInNwYW5bbmFtZT10b3BvX2dldF9zdHJpbmdfV2lkdGhdXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBydWxlci50ZXh0KHRleHQpO1xyXG4gICAgICAgIGlmIChzaXplKSB7XHJcbiAgICAgICAgICAgIHJ1bGVyLmNzcyhcImZvbnRTaXplXCIsIHNpemUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJ1bGVyLmNzcyhcImZvbnRTaXplXCIsIFwiMTRweFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJ1bGVyWzBdLm9mZnNldFdpZHRoO1xyXG4gICAgfVxyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IHV0aWw7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jb3JlL3V0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Node = {\r\n    Normal: __webpack_require__(4),\r\n    Text: __webpack_require__(7)\r\n};\r\nvar Link = {\r\n    Curve: __webpack_require__(8),\r\n    Direct: __webpack_require__(10),\r\n    Flexional: __webpack_require__(11),\r\n    Fold: __webpack_require__(12)\r\n};\r\nvar Container = {\r\n    Group: __webpack_require__(13)\r\n};\r\nmodule.exports = Scene;\r\nvar Element = __webpack_require__(6);\r\nvar ELementInstance=new Element();\r\n//画布对象\r\nvar defaults = function () {\r\n    return {\r\n        name: \'\',\r\n        id: \'\',\r\n        pid: \'\',\r\n        weight: 1,\r\n        path: [],\r\n        offsetX: 0,\r\n        offsetY: 0,\r\n        mode: "edit",\r\n        background:""\r\n    };\r\n};\r\nfunction Scene(stage, config) {\r\n    var self = this;\r\n    self.jtopo = new JTopo.Scene();\r\n    self.jtopo.qtopo=self;\r\n    self.children = {\r\n        node: [],\r\n        link: [],\r\n        container: []\r\n    };\r\n    self.attr = defaults();\r\n    stage.add(self.jtopo);\r\n    setTimeout(function(){\r\n        if(config.background){\r\n            self.setBackGround(config.background);\r\n        }\r\n        if(config.mode){\r\n            self.setMode(config.mode);\r\n        }\r\n    });\r\n}\r\n//scan 格式 aaa=bb,ccc=dd条件之间以,分隔\r\nScene.prototype.on = ELementInstance.on;\r\nScene.prototype.off= ELementInstance.off;\r\nScene.prototype.find=function(scan, type) {\r\n    var children = this.children;\r\n    var result = [];\r\n    var condition = typeof scan == "string" ? scan.split(",") : [];\r\n    if (condition.length > 0) {\r\n        $.each(condition, function (i, term) {\r\n            term = term.split("=");\r\n            //制定了类型，缩小查找范围，未指定则全部遍历\r\n            if (type) {\r\n                switch (type) {\r\n                    case "node":\r\n                        scanArr(children.node, term[0], term[1]);\r\n                        break;\r\n                    case "link":\r\n                        scanArr(children.link, term[0], term[1]);\r\n                        break;\r\n                    case "container":\r\n                        scanArr(children.container, term[0], term[1]);\r\n                        break;\r\n                }\r\n            } else {\r\n                $.each(children,function(j,arr){\r\n                    scanArr(arr, term[0], term[1]);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n    function scanArr(arr, key, value) {\r\n        $.each(arr, function (i, v) {\r\n            if (equal(v, key, value) || equal(v.attr, key, value)) {\r\n                result.push(v);\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    function equal(object, key, value) {\r\n        return object[key] && object[key] == value;\r\n    }\r\n};\r\nScene.prototype.createNode=function(config) {\r\n    var newNode;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case "text":\r\n            newNode = new Node.Text(config);\r\n            break;\r\n        default:\r\n            newNode = new Node.Normal(config);\r\n    }\r\n    if (newNode.jtopo) {\r\n        this.add(newNode.jtopo);\r\n        this.children.node.push(newNode);\r\n        return newNode;\r\n    } else {\r\n        console.error("create Node error", config);\r\n        return false;\r\n    }\r\n};\r\nScene.prototype.createLink=function(config) {\r\n    var newLink;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case "direct":\r\n            newLink = new Link.Direct(config);\r\n            break;\r\n        case "curve":\r\n            newLink = new Link.Curve(config);\r\n            break;\r\n        case "flexional":\r\n            newLink = new Link.Flexional(config);\r\n            break;\r\n        case "fold":\r\n            newLink = new Link.Fold(config);\r\n            break;\r\n        default:\r\n            newLink = new Link.Direct(config);\r\n    }\r\n    if (newLink.jtopo) {\r\n        this.add(newLink.jtopo);\r\n        this.children.link.push(newLink);\r\n        return newLink;\r\n    } else {\r\n        console.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\nScene.prototype.createContainer=function(config) {\r\n    var newContainer;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newContainer = new Container.Group(config);\r\n    }\r\n    if (newContainer.jtopo) {\r\n        this.add(newContainer.jtopo);\r\n        this.children.container.push(newContainer);\r\n        return newContainer;\r\n    } else {\r\n        console.error("create Container error", config);\r\n        return false;\r\n    }\r\n};\r\nScene.prototype.add=function(element) {\r\n    if (element) {\r\n        this.jtopo.add(element);\r\n    }\r\n};\r\nScene.prototype.center=function(){\r\n    this.jtopo.stage.centerAndZoom();\r\n};\r\nScene.prototype.setMode=function(mode) {\r\n    this.attr.mode = mode;\r\n    this.jtopo.mode = mode;\r\n};\r\nScene.prototype.setBackGround=function(background) {\r\n    this.jtopo.background = background;\r\n    this.attr.background=background;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL1NjZW5lLmpzPzAyZTciXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvNy5cclxuICovXHJcbnZhciBOb2RlID0ge1xyXG4gICAgTm9ybWFsOiByZXF1aXJlKFwiLi9lbGVtZW50L25vZGUvTm9ybWFsLmpzXCIpLFxyXG4gICAgVGV4dDogcmVxdWlyZShcIi4vZWxlbWVudC9ub2RlL1RleHQuanNcIilcclxufTtcclxudmFyIExpbmsgPSB7XHJcbiAgICBDdXJ2ZTogcmVxdWlyZShcIi4vZWxlbWVudC9saW5rL0N1cnZlLmpzXCIpLFxyXG4gICAgRGlyZWN0OiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvRGlyZWN0LmpzXCIpLFxyXG4gICAgRmxleGlvbmFsOiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvRmxleGlvbmFsLmpzXCIpLFxyXG4gICAgRm9sZDogcmVxdWlyZShcIi4vZWxlbWVudC9saW5rL0ZvbGQuanNcIilcclxufTtcclxudmFyIENvbnRhaW5lciA9IHtcclxuICAgIEdyb3VwOiByZXF1aXJlKFwiLi9lbGVtZW50L2NvbnRhaW5lci9Hcm91cC5qc1wiKVxyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IFNjZW5lO1xyXG52YXIgRWxlbWVudCA9IHJlcXVpcmUoXCIuL2VsZW1lbnQvRWxlbWVudC5qc1wiKTtcclxudmFyIEVMZW1lbnRJbnN0YW5jZT1uZXcgRWxlbWVudCgpO1xyXG4vL+eUu+W4g+WvueixoVxyXG52YXIgZGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6ICcnLFxyXG4gICAgICAgIGlkOiAnJyxcclxuICAgICAgICBwaWQ6ICcnLFxyXG4gICAgICAgIHdlaWdodDogMSxcclxuICAgICAgICBwYXRoOiBbXSxcclxuICAgICAgICBvZmZzZXRYOiAwLFxyXG4gICAgICAgIG9mZnNldFk6IDAsXHJcbiAgICAgICAgbW9kZTogXCJlZGl0XCIsXHJcbiAgICAgICAgYmFja2dyb3VuZDpcIlwiXHJcbiAgICB9O1xyXG59O1xyXG5mdW5jdGlvbiBTY2VuZShzdGFnZSwgY29uZmlnKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmp0b3BvID0gbmV3IEpUb3BvLlNjZW5lKCk7XHJcbiAgICBzZWxmLmp0b3BvLnF0b3BvPXNlbGY7XHJcbiAgICBzZWxmLmNoaWxkcmVuID0ge1xyXG4gICAgICAgIG5vZGU6IFtdLFxyXG4gICAgICAgIGxpbms6IFtdLFxyXG4gICAgICAgIGNvbnRhaW5lcjogW11cclxuICAgIH07XHJcbiAgICBzZWxmLmF0dHIgPSBkZWZhdWx0cygpO1xyXG4gICAgc3RhZ2UuYWRkKHNlbGYuanRvcG8pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKGNvbmZpZy5iYWNrZ3JvdW5kKXtcclxuICAgICAgICAgICAgc2VsZi5zZXRCYWNrR3JvdW5kKGNvbmZpZy5iYWNrZ3JvdW5kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoY29uZmlnLm1vZGUpe1xyXG4gICAgICAgICAgICBzZWxmLnNldE1vZGUoY29uZmlnLm1vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8vc2NhbiDmoLzlvI8gYWFhPWJiLGNjYz1kZOadoeS7tuS5i+mXtOS7pSzliIbpmpRcclxuU2NlbmUucHJvdG90eXBlLm9uID0gRUxlbWVudEluc3RhbmNlLm9uO1xyXG5TY2VuZS5wcm90b3R5cGUub2ZmPSBFTGVtZW50SW5zdGFuY2Uub2ZmO1xyXG5TY2VuZS5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihzY2FuLCB0eXBlKSB7XHJcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xyXG4gICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgdmFyIGNvbmRpdGlvbiA9IHR5cGVvZiBzY2FuID09IFwic3RyaW5nXCIgPyBzY2FuLnNwbGl0KFwiLFwiKSA6IFtdO1xyXG4gICAgaWYgKGNvbmRpdGlvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgJC5lYWNoKGNvbmRpdGlvbiwgZnVuY3Rpb24gKGksIHRlcm0pIHtcclxuICAgICAgICAgICAgdGVybSA9IHRlcm0uc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgICAgICAvL+WItuWumuS6huexu+Wei++8jOe8qeWwj+afpeaJvuiMg+WbtO+8jOacquaMh+WumuWImeWFqOmDqOmBjeWOhlxyXG4gICAgICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vZGVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5ub2RlLCB0ZXJtWzBdLCB0ZXJtWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxpbmtcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5saW5rLCB0ZXJtWzBdLCB0ZXJtWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNvbnRhaW5lclwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGNoaWxkcmVuLmNvbnRhaW5lciwgdGVybVswXSwgdGVybVsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGNoaWxkcmVuLGZ1bmN0aW9uKGosYXJyKXtcclxuICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGFyciwgdGVybVswXSwgdGVybVsxXSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIGZ1bmN0aW9uIHNjYW5BcnIoYXJyLCBrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgJC5lYWNoKGFyciwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgaWYgKGVxdWFsKHYsIGtleSwgdmFsdWUpIHx8IGVxdWFsKHYuYXR0ciwga2V5LCB2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlcXVhbChvYmplY3QsIGtleSwgdmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gb2JqZWN0W2tleV0gJiYgb2JqZWN0W2tleV0gPT0gdmFsdWU7XHJcbiAgICB9XHJcbn07XHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvbmZpZykge1xyXG4gICAgdmFyIG5ld05vZGU7XHJcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSBcInRleHRcIjpcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlLlRleHQoY29uZmlnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlLk5vcm1hbChjb25maWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG5ld05vZGUuanRvcG8pIHtcclxuICAgICAgICB0aGlzLmFkZChuZXdOb2RlLmp0b3BvKTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLm5vZGUucHVzaChuZXdOb2RlKTtcclxuICAgICAgICByZXR1cm4gbmV3Tm9kZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcImNyZWF0ZSBOb2RlIGVycm9yXCIsIGNvbmZpZyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG5TY2VuZS5wcm90b3R5cGUuY3JlYXRlTGluaz1mdW5jdGlvbihjb25maWcpIHtcclxuICAgIHZhciBuZXdMaW5rO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGNhc2UgXCJkaXJlY3RcIjpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkRpcmVjdChjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiY3VydmVcIjpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkN1cnZlKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJmbGV4aW9uYWxcIjpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkZsZXhpb25hbChjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiZm9sZFwiOlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuRm9sZChjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuRGlyZWN0KGNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAobmV3TGluay5qdG9wbykge1xyXG4gICAgICAgIHRoaXMuYWRkKG5ld0xpbmsuanRvcG8pO1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4ubGluay5wdXNoKG5ld0xpbmspO1xyXG4gICAgICAgIHJldHVybiBuZXdMaW5rO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiY3JlYXRlIExpbmsgZXJyb3JcIiwgY29uZmlnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVDb250YWluZXI9ZnVuY3Rpb24oY29uZmlnKSB7XHJcbiAgICB2YXIgbmV3Q29udGFpbmVyO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld0NvbnRhaW5lciA9IG5ldyBDb250YWluZXIuR3JvdXAoY29uZmlnKTtcclxuICAgIH1cclxuICAgIGlmIChuZXdDb250YWluZXIuanRvcG8pIHtcclxuICAgICAgICB0aGlzLmFkZChuZXdDb250YWluZXIuanRvcG8pO1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4uY29udGFpbmVyLnB1c2gobmV3Q29udGFpbmVyKTtcclxuICAgICAgICByZXR1cm4gbmV3Q29udGFpbmVyO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiY3JlYXRlIENvbnRhaW5lciBlcnJvclwiLCBjb25maWcpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuU2NlbmUucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uYWRkKGVsZW1lbnQpO1xyXG4gICAgfVxyXG59O1xyXG5TY2VuZS5wcm90b3R5cGUuY2VudGVyPWZ1bmN0aW9uKCl7XHJcbiAgICB0aGlzLmp0b3BvLnN0YWdlLmNlbnRlckFuZFpvb20oKTtcclxufTtcclxuU2NlbmUucHJvdG90eXBlLnNldE1vZGU9ZnVuY3Rpb24obW9kZSkge1xyXG4gICAgdGhpcy5hdHRyLm1vZGUgPSBtb2RlO1xyXG4gICAgdGhpcy5qdG9wby5tb2RlID0gbW9kZTtcclxufTtcclxuU2NlbmUucHJvdG90eXBlLnNldEJhY2tHcm91bmQ9ZnVuY3Rpb24oYmFja2dyb3VuZCkge1xyXG4gICAgdGhpcy5qdG9wby5iYWNrZ3JvdW5kID0gYmFja2dyb3VuZDtcclxuICAgIHRoaXMuYXR0ci5iYWNrZ3JvdW5kPWJhY2tncm91bmQ7XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jb3JlL1NjZW5lLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Node=__webpack_require__(5);\r\nNormalNode.prototype =new Node();\r\nmodule.exports = NormalNode;\r\nvar defaults = function () {\r\n    return {\r\n        image: "",\r\n        size: [30, 30],\r\n        name: "node",\r\n        alpha: 1,\r\n        position: [0, 0],\r\n        font: {\r\n            size: 16,\r\n            type: \'微软雅黑\',\r\n            color: "255,255,255"\r\n        },\r\n        zIndex: 200,//层级(10-999)\r\n        color: JTopo.util.randomColor(),\r\n        textPosition: \'bottom\',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden\r\n        type: \'normal\',\r\n        alarm: {\r\n            show: false,\r\n            text: "",\r\n            color: "255,255,255",\r\n            font: {\r\n                size: 16,\r\n                type: "微软雅黑"\r\n            }\r\n        }\r\n    }\r\n};\r\n//一般节点\r\nfunction NormalNode(config) {\r\n    var self = this;\r\n    self.attr = QTopo.util.extend(defaults(), config || {});\r\n    self.jtopo = new JTopo.Node();\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo = self;\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n        //处理特殊属性的设置\r\n    }\r\n}\r\nNormalNode.prototype.setAlarm=function(config) {\r\n    var jtopo = this.jtopo;\r\n    var alarm=this.attr.alarm;\r\n    if (config.show) {\r\n        jtopo.alarm = config.text || "";\r\n        alarm.text=jtopo.alarm;\r\n        jtopo.alarmColor = QTopo.util.transHex(config.color.toLowerCase());\r\n        alarm.color=jtopo.alarmColor;\r\n        jtopo.alarmAlpha = 1;\r\n        var size=alarm.font.size;\r\n        var font=alarm.font.type;\r\n        if(config.font&&config.font.size){\r\n            size=config.font.size;\r\n        }\r\n        if(config.font&&config.font.type){\r\n            font=config.font.type;\r\n        }\r\n        jtopo.alarmFont =  size+ \'px \' + font;\r\n        alarm.font.size=size;\r\n        alarm.font.type=font;\r\n    } else {\r\n        jtopo.alarm = null;\r\n    }\r\n};\r\nNormalNode.prototype.setImage=function(image) {\r\n    this.jtopo.setImage(image);\r\n    this.attr.image=image;\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbm9kZS9Ob3JtYWwuanM/ZTZhMCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRDtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiNC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG52YXIgTm9kZT1yZXF1aXJlKFwiLi9Ob2RlLmpzXCIpO1xyXG5Ob3JtYWxOb2RlLnByb3RvdHlwZSA9bmV3IE5vZGUoKTtcclxubW9kdWxlLmV4cG9ydHMgPSBOb3JtYWxOb2RlO1xyXG52YXIgZGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGltYWdlOiBcIlwiLFxyXG4gICAgICAgIHNpemU6IFszMCwgMzBdLFxyXG4gICAgICAgIG5hbWU6IFwibm9kZVwiLFxyXG4gICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sXHJcbiAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgdHlwZTogJ+W+rui9r+mbhem7kScsXHJcbiAgICAgICAgICAgIGNvbG9yOiBcIjI1NSwyNTUsMjU1XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHpJbmRleDogMjAwLC8v5bGC57qnKDEwLTk5OSlcclxuICAgICAgICBjb2xvcjogSlRvcG8udXRpbC5yYW5kb21Db2xvcigpLFxyXG4gICAgICAgIHRleHRQb3NpdGlvbjogJ2JvdHRvbScsLy9Cb3R0b21fQ2VudGVyIFRvcF9DZW50ZXIgTWlkZGxlX0xlZnQgTWlkZGxlX1JpZ2h0IEhpZGRlblxyXG4gICAgICAgIHR5cGU6ICdub3JtYWwnLFxyXG4gICAgICAgIGFsYXJtOiB7XHJcbiAgICAgICAgICAgIHNob3c6IGZhbHNlLFxyXG4gICAgICAgICAgICB0ZXh0OiBcIlwiLFxyXG4gICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiLFxyXG4gICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLy/kuIDoiKzoioLngrlcclxuZnVuY3Rpb24gTm9ybWFsTm9kZShjb25maWcpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuYXR0ciA9IFFUb3BvLnV0aWwuZXh0ZW5kKGRlZmF1bHRzKCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBzZWxmLmp0b3BvID0gbmV3IEpUb3BvLk5vZGUoKTtcclxuICAgIC8v5bCB6KOF5a+56LGh5LmL6Ze055u45LqS5L+d5oyB5byV55SoXHJcbiAgICBzZWxmLmp0b3BvLnF0b3BvID0gc2VsZjtcclxuICAgIC8v5Ye95pWwXHJcbiAgICBzZWxmLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHNlbGYuc2V0KHNlbGYuYXR0cik7XHJcbn1cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIC8v5aSE55CG5LiA6Iis5bGe5oCn55qE6K6+572uXHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgICAgIC8v5aSE55CG54m55q6K5bGe5oCn55qE6K6+572uXHJcbiAgICB9XHJcbn1cclxuTm9ybWFsTm9kZS5wcm90b3R5cGUuc2V0QWxhcm09ZnVuY3Rpb24oY29uZmlnKSB7XHJcbiAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgdmFyIGFsYXJtPXRoaXMuYXR0ci5hbGFybTtcclxuICAgIGlmIChjb25maWcuc2hvdykge1xyXG4gICAgICAgIGp0b3BvLmFsYXJtID0gY29uZmlnLnRleHQgfHwgXCJcIjtcclxuICAgICAgICBhbGFybS50ZXh0PWp0b3BvLmFsYXJtO1xyXG4gICAgICAgIGp0b3BvLmFsYXJtQ29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGNvbmZpZy5jb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICBhbGFybS5jb2xvcj1qdG9wby5hbGFybUNvbG9yO1xyXG4gICAgICAgIGp0b3BvLmFsYXJtQWxwaGEgPSAxO1xyXG4gICAgICAgIHZhciBzaXplPWFsYXJtLmZvbnQuc2l6ZTtcclxuICAgICAgICB2YXIgZm9udD1hbGFybS5mb250LnR5cGU7XHJcbiAgICAgICAgaWYoY29uZmlnLmZvbnQmJmNvbmZpZy5mb250LnNpemUpe1xyXG4gICAgICAgICAgICBzaXplPWNvbmZpZy5mb250LnNpemU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNvbmZpZy5mb250JiZjb25maWcuZm9udC50eXBlKXtcclxuICAgICAgICAgICAgZm9udD1jb25maWcuZm9udC50eXBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBqdG9wby5hbGFybUZvbnQgPSAgc2l6ZSsgJ3B4ICcgKyBmb250O1xyXG4gICAgICAgIGFsYXJtLmZvbnQuc2l6ZT1zaXplO1xyXG4gICAgICAgIGFsYXJtLmZvbnQudHlwZT1mb250O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBqdG9wby5hbGFybSA9IG51bGw7XHJcbiAgICB9XHJcbn07XHJcbk5vcm1hbE5vZGUucHJvdG90eXBlLnNldEltYWdlPWZ1bmN0aW9uKGltYWdlKSB7XHJcbiAgICB0aGlzLmp0b3BvLnNldEltYWdlKGltYWdlKTtcclxuICAgIHRoaXMuYXR0ci5pbWFnZT1pbWFnZTtcclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jb3JlL2VsZW1lbnQvbm9kZS9Ob3JtYWwuanNcbi8vIG1vZHVsZSBpZCA9IDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Element=__webpack_require__(6);\r\nNode.prototype = new Element();\r\nmodule.exports =Node;\r\nfunction Node() {\r\n    this.getType=function(){\r\n        return "node";\r\n    };\r\n    this.setColor = function (color) {\r\n        if (color) {\r\n            color = QTopo.util.transHex(color.toLowerCase());\r\n            this.jtopo.fillColor = color;\r\n            this.attr.color=this.jtopo.fillColor;\r\n        }\r\n    };\r\n    this.setName=function(name){\r\n        if(this.attr.textPosition!="hide"){\r\n            this.jtopo.text=name;\r\n            this.attr.name=this.jtopo.text;\r\n        }\r\n    };\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbm9kZS9Ob2RlLmpzP2RhZjkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxudmFyIEVsZW1lbnQ9cmVxdWlyZShcIi4uL0VsZW1lbnQuanNcIik7XHJcbk5vZGUucHJvdG90eXBlID0gbmV3IEVsZW1lbnQoKTtcclxubW9kdWxlLmV4cG9ydHMgPU5vZGU7XHJcbmZ1bmN0aW9uIE5vZGUoKSB7XHJcbiAgICB0aGlzLmdldFR5cGU9ZnVuY3Rpb24oKXtcclxuICAgICAgICByZXR1cm4gXCJub2RlXCI7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgICAgICBjb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uZmlsbENvbG9yID0gY29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5jb2xvcj10aGlzLmp0b3BvLmZpbGxDb2xvcjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXROYW1lPWZ1bmN0aW9uKG5hbWUpe1xyXG4gICAgICAgIGlmKHRoaXMuYXR0ci50ZXh0UG9zaXRpb24hPVwiaGlkZVwiKXtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0PW5hbWU7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5uYW1lPXRoaXMuanRvcG8udGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2NvcmUvZWxlbWVudC9ub2RlL05vZGUuanNcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nmodule.exports =Element;\r\nfunction Element() {\r\n    this.show = function () {\r\n        this.jtopo.visible = true;\r\n        this.attr.show=this.jtopo.visible;\r\n    };\r\n    this.hide = function () {\r\n        this.jtopo.visible = false;\r\n        this.attr.show=this.jtopo.visible;\r\n    };\r\n    this.setText = function (text) {\r\n        this.jtopo.text = text;\r\n        this.attr.text=text;\r\n    };\r\n    this.on = function (name, fn) {\r\n        this.jtopo.addEventListener(name, function (e) {\r\n            if(e.target&&e.target.qtopo){\r\n                fn(e.target.qtopo, e);\r\n            }else{\r\n                fn(e.scene.qtopo,e);\r\n            }\r\n        });\r\n    };\r\n    this.off = function (name, fn) {\r\n        this.jtopo.removeEventListener(name);\r\n    };\r\n    this.setZIndex = function (zIndex) {\r\n        this.jtopo.zIndex = parseInt($.isNumeric(zIndex) ? zIndex : 10);\r\n        this.attr.zIndex=this.jtopo.zIndex;\r\n    };\r\n    this.setFont = function (font) {\r\n        if(font){\r\n            var type= this.attr.font.type;\r\n            var size=this.attr.font.size;\r\n            if ($.isNumeric(font.size)) {\r\n                this.attr.font.size=font.size;\r\n                size=font.size;\r\n            }\r\n            if(font.type){\r\n                this.attr.font.type=font.type;\r\n                type=font.type;\r\n            }\r\n            this.jtopo.font = size + "px " + type;\r\n            if (font.color) {\r\n                this.jtopo.fontColor = QTopo.util.transHex(font.color.toLowerCase());\r\n                this.attr.font.color=this.jtopo.fontColor;\r\n            }\r\n        }\r\n    };\r\n    this.setAlpha = function (alpha) {\r\n        if ($.isNumeric(alpha) && alpha <= 1 && alpha > 0) {\r\n            this.jtopo.alpha = alpha;\r\n        } else {\r\n            this.jtopo.alpha = 1;\r\n        }\r\n        this.attr.alpha= this.jtopo.alpha;\r\n    };\r\n    this.setTextOffset = function (arr) {\r\n        if ($.isArray(arr) && arr.length >= 2) {\r\n            this.jtopo.textOffsetX = arr[0];\r\n            this.jtopo.textOffsetY = arr[1];\r\n            this.attr.textOffset=arr;\r\n        } else {\r\n            console.error(this,"textOffset need be array and 2 length");\r\n        }\r\n    };\r\n    this.setPosition = function (position) {\r\n        if ($.isArray(position) && position.length >= 2) {\r\n            if ($.isNumeric(position[0]) && $.isNumeric(position[1])) {\r\n                this.jtopo.setLocation(parseInt(position[0]), parseInt(position[1]));\r\n                this.attr.position=[this.jtopo.x, this.jtopo.y];\r\n            }\r\n        } else {\r\n            console.error(this,"position need be array and 2 length");\r\n        }\r\n    };\r\n    this.setSize = function (size) {\r\n        if ($.isArray(size) && size.length >= 2) {\r\n            this.jtopo.setSize(size[0], size[1]);\r\n            this.attr.size=[this.jtopo.width,this.jtopo.height];\r\n        } else {\r\n            console.error(this,"size need be array and 2 length");\r\n        }\r\n    };\r\n    this.setDragable = function (dragable) {\r\n        this.jtopo.dragable = dragable;\r\n        this.attr.dragable=this.jtopo.dragable;\r\n    };\r\n    this.setTextPosition = function (textPosition) {\r\n        var jtopo = this.jtopo;\r\n        jtopo.text = this.attr.name;\r\n        switch (textPosition) {\r\n            case \'hide\':\r\n                jtopo.text = \'\';\r\n                this.attr.textPosition="hide";\r\n                break;\r\n            case \'bottom\':\r\n                jtopo.textOffsetX = 0;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Bottom_Center";\r\n                this.attr.textPosition="bottom";\r\n                break;\r\n            case \'top\':\r\n                jtopo.textOffsetX = 0;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Top_Center";\r\n                this.attr.textPosition="top";\r\n                break;\r\n            case \'left\':\r\n                jtopo.textOffsetX = -5;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Middle_Left";\r\n                this.attr.textPosition="left";\r\n                break;\r\n            case \'right\':\r\n                jtopo.textOffsetX = 5;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Middle_Right";\r\n                this.attr.textPosition="right";\r\n                break;\r\n            default:\r\n                jtopo.textOffsetX = 0;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.text = this.attr.name;\r\n                jtopo.textPosition = \'Bottom_Center\';\r\n                this.attr.textPosition="bottom";\r\n                console.error(this,"set wrong textPosition,default is bottom");\r\n                break;\r\n        }\r\n    };\r\n    //只要对应属性有方法则修改\r\n    this._setAttr = function (config) {\r\n        var self = this;\r\n        $.each(config, function (k, v) {\r\n            try {\r\n                var fn = self[\'set\' + QTopo.util.upFirst(k)];\r\n                if (fn) {\r\n                    //v=QTopo.util.merge(self.attr[k],v);\r\n                    fn.call(self, v);\r\n                }\r\n            } catch (e) {\r\n                console.error(self,"Element _setAttr error :" + k,e);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvRWxlbWVudC5qcz80NjViIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBIiwiZmlsZSI6IjYuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxubW9kdWxlLmV4cG9ydHMgPUVsZW1lbnQ7XHJcbmZ1bmN0aW9uIEVsZW1lbnQoKSB7XHJcbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmF0dHIuc2hvdz10aGlzLmp0b3BvLnZpc2libGU7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5oaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuanRvcG8udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYXR0ci5zaG93PXRoaXMuanRvcG8udmlzaWJsZTtcclxuICAgIH07XHJcbiAgICB0aGlzLnNldFRleHQgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIHRoaXMuanRvcG8udGV4dCA9IHRleHQ7XHJcbiAgICAgICAgdGhpcy5hdHRyLnRleHQ9dGV4dDtcclxuICAgIH07XHJcbiAgICB0aGlzLm9uID0gZnVuY3Rpb24gKG5hbWUsIGZuKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5hZGRFdmVudExpc3RlbmVyKG5hbWUsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmKGUudGFyZ2V0JiZlLnRhcmdldC5xdG9wbyl7XHJcbiAgICAgICAgICAgICAgICBmbihlLnRhcmdldC5xdG9wbywgZSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgZm4oZS5zY2VuZS5xdG9wbyxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHRoaXMub2ZmID0gZnVuY3Rpb24gKG5hbWUsIGZuKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUpO1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0WkluZGV4ID0gZnVuY3Rpb24gKHpJbmRleCkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uekluZGV4ID0gcGFyc2VJbnQoJC5pc051bWVyaWMoekluZGV4KSA/IHpJbmRleCA6IDEwKTtcclxuICAgICAgICB0aGlzLmF0dHIuekluZGV4PXRoaXMuanRvcG8uekluZGV4O1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0Rm9udCA9IGZ1bmN0aW9uIChmb250KSB7XHJcbiAgICAgICAgaWYoZm9udCl7XHJcbiAgICAgICAgICAgIHZhciB0eXBlPSB0aGlzLmF0dHIuZm9udC50eXBlO1xyXG4gICAgICAgICAgICB2YXIgc2l6ZT10aGlzLmF0dHIuZm9udC5zaXplO1xyXG4gICAgICAgICAgICBpZiAoJC5pc051bWVyaWMoZm9udC5zaXplKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLmZvbnQuc2l6ZT1mb250LnNpemU7XHJcbiAgICAgICAgICAgICAgICBzaXplPWZvbnQuc2l6ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihmb250LnR5cGUpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLmZvbnQudHlwZT1mb250LnR5cGU7XHJcbiAgICAgICAgICAgICAgICB0eXBlPWZvbnQudHlwZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmZvbnQgPSBzaXplICsgXCJweCBcIiArIHR5cGU7XHJcbiAgICAgICAgICAgIGlmIChmb250LmNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmp0b3BvLmZvbnRDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoZm9udC5jb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5mb250LmNvbG9yPXRoaXMuanRvcG8uZm9udENvbG9yO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0QWxwaGEgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgICAgICBpZiAoJC5pc051bWVyaWMoYWxwaGEpICYmIGFscGhhIDw9IDEgJiYgYWxwaGEgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uYWxwaGEgPSBhbHBoYTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmFscGhhID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLmFscGhhPSB0aGlzLmp0b3BvLmFscGhhO1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0VGV4dE9mZnNldCA9IGZ1bmN0aW9uIChhcnIpIHtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGFycikgJiYgYXJyLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dE9mZnNldFggPSBhcnJbMF07XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dE9mZnNldFkgPSBhcnJbMV07XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci50ZXh0T2Zmc2V0PWFycjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMsXCJ0ZXh0T2Zmc2V0IG5lZWQgYmUgYXJyYXkgYW5kIDIgbGVuZ3RoXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShwb3NpdGlvbikgJiYgcG9zaXRpb24ubGVuZ3RoID49IDIpIHtcclxuICAgICAgICAgICAgaWYgKCQuaXNOdW1lcmljKHBvc2l0aW9uWzBdKSAmJiAkLmlzTnVtZXJpYyhwb3NpdGlvblsxXSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuanRvcG8uc2V0TG9jYXRpb24ocGFyc2VJbnQocG9zaXRpb25bMF0pLCBwYXJzZUludChwb3NpdGlvblsxXSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLnBvc2l0aW9uPVt0aGlzLmp0b3BvLngsIHRoaXMuanRvcG8ueV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMsXCJwb3NpdGlvbiBuZWVkIGJlIGFycmF5IGFuZCAyIGxlbmd0aFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRTaXplID0gZnVuY3Rpb24gKHNpemUpIHtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KHNpemUpICYmIHNpemUubGVuZ3RoID49IDIpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5zZXRTaXplKHNpemVbMF0sIHNpemVbMV0pO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuc2l6ZT1bdGhpcy5qdG9wby53aWR0aCx0aGlzLmp0b3BvLmhlaWdodF07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLFwic2l6ZSBuZWVkIGJlIGFycmF5IGFuZCAyIGxlbmd0aFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXREcmFnYWJsZSA9IGZ1bmN0aW9uIChkcmFnYWJsZSkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uZHJhZ2FibGUgPSBkcmFnYWJsZTtcclxuICAgICAgICB0aGlzLmF0dHIuZHJhZ2FibGU9dGhpcy5qdG9wby5kcmFnYWJsZTtcclxuICAgIH07XHJcbiAgICB0aGlzLnNldFRleHRQb3NpdGlvbiA9IGZ1bmN0aW9uICh0ZXh0UG9zaXRpb24pIHtcclxuICAgICAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgICAgIGp0b3BvLnRleHQgPSB0aGlzLmF0dHIubmFtZTtcclxuICAgICAgICBzd2l0Y2ggKHRleHRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICBjYXNlICdoaWRlJzpcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHQgPSAnJztcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci50ZXh0UG9zaXRpb249XCJoaWRlXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnYm90dG9tJzpcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiQm90dG9tX0NlbnRlclwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLnRleHRQb3NpdGlvbj1cImJvdHRvbVwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0T2Zmc2V0WCA9IDA7XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIlRvcF9DZW50ZXJcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci50ZXh0UG9zaXRpb249XCJ0b3BcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gLTU7XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIk1pZGRsZV9MZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIudGV4dFBvc2l0aW9uPVwibGVmdFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gNTtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiTWlkZGxlX1JpZ2h0XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIudGV4dFBvc2l0aW9uPVwicmlnaHRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFggPSAwO1xyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dCA9IHRoaXMuYXR0ci5uYW1lO1xyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dFBvc2l0aW9uID0gJ0JvdHRvbV9DZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLnRleHRQb3NpdGlvbj1cImJvdHRvbVwiO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLFwic2V0IHdyb25nIHRleHRQb3NpdGlvbixkZWZhdWx0IGlzIGJvdHRvbVwiKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvL+WPquimgeWvueW6lOWxnuaAp+acieaWueazleWImeS/ruaUuVxyXG4gICAgdGhpcy5fc2V0QXR0ciA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgJC5lYWNoKGNvbmZpZywgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHZhciBmbiA9IHNlbGZbJ3NldCcgKyBRVG9wby51dGlsLnVwRmlyc3QoayldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGZuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy92PVFUb3BvLnV0aWwubWVyZ2Uoc2VsZi5hdHRyW2tdLHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZuLmNhbGwoc2VsZiwgdik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3Ioc2VsZixcIkVsZW1lbnQgX3NldEF0dHIgZXJyb3IgOlwiICsgayxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2NvcmUvZWxlbWVudC9FbGVtZW50LmpzXG4vLyBtb2R1bGUgaWQgPSA2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\n\r\nvar Node=__webpack_require__(5);\r\nTextNode.prototype =new Node();\r\nmodule.exports = TextNode;\r\nvar defaults =function(){\r\n    return {\r\n        position:[0,0],\r\n        font:{\r\n            size:16,\r\n            type: '微软雅黑',\r\n            color:\"255,255,255\"\r\n        },\r\n        zIndex: 200,//层级(10-999)\r\n        alpha: 1,\r\n        text: 'no text here',\r\n        type: 'text'\r\n    };\r\n};\r\n//一般节点\r\nfunction TextNode(config) {\r\n    var self = this;\r\n    self.jtopo = new JTopo.TextNode();\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n    }\r\n}\r\n//私有函数//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbm9kZS9UZXh0LmpzPzMyMmEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjcuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxuXHJcbnZhciBOb2RlPXJlcXVpcmUoXCIuL05vZGUuanNcIik7XHJcblRleHROb2RlLnByb3RvdHlwZSA9bmV3IE5vZGUoKTtcclxubW9kdWxlLmV4cG9ydHMgPSBUZXh0Tm9kZTtcclxudmFyIGRlZmF1bHRzID1mdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBwb3NpdGlvbjpbMCwwXSxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTogJ+W+rui9r+mbhem7kScsXHJcbiAgICAgICAgICAgIGNvbG9yOlwiMjU1LDI1NSwyNTVcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgekluZGV4OiAyMDAsLy/lsYLnuqcoMTAtOTk5KVxyXG4gICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgIHRleHQ6ICdubyB0ZXh0IGhlcmUnLFxyXG4gICAgICAgIHR5cGU6ICd0ZXh0J1xyXG4gICAgfTtcclxufTtcclxuLy/kuIDoiKzoioLngrlcclxuZnVuY3Rpb24gVGV4dE5vZGUoY29uZmlnKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmp0b3BvID0gbmV3IEpUb3BvLlRleHROb2RlKCk7XHJcbiAgICAvL+WwgeijheWvueixoeS5i+mXtOebuOS6kuS/neaMgeW8leeUqFxyXG4gICAgc2VsZi5qdG9wby5xdG9wbz1zZWxmO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHNlbGYuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgc2VsZi5zZXQoc2VsZi5hdHRyKTtcclxufVxyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIC8v5aSE55CG5LiA6Iis5bGe5oCn55qE6K6+572uXHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbi8v56eB5pyJ5Ye95pWwXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jb3JlL2VsZW1lbnQvbm9kZS9UZXh0LmpzXG4vLyBtb2R1bGUgaWQgPSA3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(9);\r\nCurveLink.prototype=new Link();\r\nmodule.exports = CurveLink;\r\n//曲线\r\nvar defaults =function(){\r\n    return {\r\n        num: 1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        type: \'curve\',\r\n        curveOffset:200\r\n    };\r\n};\r\nfunction CurveLink(config){\r\n    if(!config.start||!config.end){\r\n        console.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.FoldLink(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //改写源码绘制曲线,可由curveOffset指定弧度\r\n    reset(self);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    link.jtopo.getStartPosition = function () {\r\n        var a;\r\n        return (a = (function (thisl) {\r\n            var b = thisl.nodeA, c = thisl.nodeZ;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), a;\r\n    };\r\n    link.jtopo.getEndPosition = function () {\r\n        var a;\r\n        return (a = (function (thisl) {\r\n            var b = thisl.nodeZ, c = thisl.nodeA;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), a;\r\n    };\r\n    link.jtopo.paintPath = function (cx, path) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(cx);\r\n        var s = path[0];\r\n        var t = path[path.length - 1];\r\n        cx.beginPath();\r\n        cx.moveTo(s.x, s.y);\r\n        var angle = Math.atan(Math.abs(t.y - s.y) / Math.abs(t.x - s.x));\r\n        var mX = (s.x + t.x) / 2 + link.attr.curveOffset * Math.cos(angle - Math.PI / 2);\r\n        var mY = (s.y + t.y) / 2 + link.attr.curveOffset * Math.sin(angle - Math.PI / 2);\r\n        cx.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n        cx.lineWidth = this.lineWidth;\r\n        cx.moveTo(s.x, s.cy);\r\n        cx.quadraticCurveTo(mX, mY, t.x, t.y);\r\n        cx.stroke();\r\n        if (cx.stroke(), cx.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(cx, s, t);\r\n            }\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(cx, t, s);\r\n            }\r\n        }\r\n    };\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbGluay9DdXJ2ZS5qcz8xYjY1Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxudmFyIExpbms9cmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxuQ3VydmVMaW5rLnByb3RvdHlwZT1uZXcgTGluaygpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IEN1cnZlTGluaztcclxuLy/mm7Lnur9cclxudmFyIGRlZmF1bHRzID1mdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBudW06IDEsXHJcbiAgICAgICAgYWxwaGE6MSxcclxuICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgc2l6ZTpudWxsLFxyXG4gICAgICAgICAgICBvZmZzZXQ6MCxcclxuICAgICAgICAgICAgc3RhcnQ6ZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZDp0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnYXA6MjAsXHJcbiAgICAgICAgd2lkdGg6IDIsXHJcbiAgICAgICAgZGFzaGVkOiAgbnVsbCxcclxuICAgICAgICB6SW5kZXggOiAxMDAsXHJcbiAgICAgICAgdGV4dE9mZnNldDpbMCwwXSxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0eXBlOiAnY3VydmUnLFxyXG4gICAgICAgIGN1cnZlT2Zmc2V0OjIwMFxyXG4gICAgfTtcclxufTtcclxuZnVuY3Rpb24gQ3VydmVMaW5rKGNvbmZpZyl7XHJcbiAgICBpZighY29uZmlnLnN0YXJ0fHwhY29uZmlnLmVuZCl7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNyZWF0ZSBMaW5rIG5lZWQgc3RhcnQgYW5kIGVuZFwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmp0b3BvID0gbmV3IEpUb3BvLkZvbGRMaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbyk7XHJcbiAgICAvL+WwgeijheWvueixoeS5i+mXtOebuOS6kuS/neaMgeW8leeUqFxyXG4gICAgc2VsZi5qdG9wby5xdG9wbz1zZWxmO1xyXG4gICAgc2VsZi5hdHRyID0gIFFUb3BvLnV0aWwuZXh0ZW5kKGRlZmF1bHRzKCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgc2VsZi5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICBzZWxmLnNldChzZWxmLmF0dHIpO1xyXG4gICAgLy/mlLnlhpnmupDnoIHnu5jliLbmm7Lnur8s5Y+v55SxY3VydmVPZmZzZXTmjIflrprlvKfluqZcclxuICAgIHJlc2V0KHNlbGYpO1xyXG59XHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgc2VsZi5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlc2V0KGxpbmspe1xyXG4gICAgbGluay5qdG9wby5nZXRTdGFydFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhO1xyXG4gICAgICAgIHJldHVybiAoYSA9IChmdW5jdGlvbiAodGhpc2wpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzbC5ub2RlQSwgYyA9IHRoaXNsLm5vZGVaO1xyXG4gICAgICAgICAgICB2YXIgZCA9IEpUb3BvLnV0aWwubGluZUYoYi5jeCwgYi5jeSwgYy5jeCwgYy5jeSk7XHJcbiAgICAgICAgICAgIHZhciBlID0gYi5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gZiA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uTGluZUJvdW5kKGQsIGUpO1xyXG4gICAgICAgIH0pKHRoaXMpKSwgYTtcclxuICAgIH07XHJcbiAgICBsaW5rLmp0b3BvLmdldEVuZFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhO1xyXG4gICAgICAgIHJldHVybiAoYSA9IChmdW5jdGlvbiAodGhpc2wpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzbC5ub2RlWiwgYyA9IHRoaXNsLm5vZGVBO1xyXG4gICAgICAgICAgICB2YXIgZCA9IEpUb3BvLnV0aWwubGluZUYoYi5jeCwgYi5jeSwgYy5jeCwgYy5jeSk7XHJcbiAgICAgICAgICAgIHZhciBlID0gYi5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gZiA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uTGluZUJvdW5kKGQsIGUpO1xyXG4gICAgICAgIH0pKHRoaXMpKSwgYTtcclxuICAgIH07XHJcbiAgICBsaW5rLmp0b3BvLnBhaW50UGF0aCA9IGZ1bmN0aW9uIChjeCwgcGF0aCkge1xyXG4gICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKXJldHVybiB2b2lkIHRoaXMucGFpbnRMb29wKGN4KTtcclxuICAgICAgICB2YXIgcyA9IHBhdGhbMF07XHJcbiAgICAgICAgdmFyIHQgPSBwYXRoW3BhdGgubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgY3guYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgY3gubW92ZVRvKHMueCwgcy55KTtcclxuICAgICAgICB2YXIgYW5nbGUgPSBNYXRoLmF0YW4oTWF0aC5hYnModC55IC0gcy55KSAvIE1hdGguYWJzKHQueCAtIHMueCkpO1xyXG4gICAgICAgIHZhciBtWCA9IChzLnggKyB0LngpIC8gMiArIGxpbmsuYXR0ci5jdXJ2ZU9mZnNldCAqIE1hdGguY29zKGFuZ2xlIC0gTWF0aC5QSSAvIDIpO1xyXG4gICAgICAgIHZhciBtWSA9IChzLnkgKyB0LnkpIC8gMiArIGxpbmsuYXR0ci5jdXJ2ZU9mZnNldCAqIE1hdGguc2luKGFuZ2xlIC0gTWF0aC5QSSAvIDIpO1xyXG4gICAgICAgIGN4LnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5zdHJva2VDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgIGN4LmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoO1xyXG4gICAgICAgIGN4Lm1vdmVUbyhzLngsIHMuY3kpO1xyXG4gICAgICAgIGN4LnF1YWRyYXRpY0N1cnZlVG8obVgsIG1ZLCB0LngsIHQueSk7XHJcbiAgICAgICAgY3guc3Ryb2tlKCk7XHJcbiAgICAgICAgaWYgKGN4LnN0cm9rZSgpLCBjeC5jbG9zZVBhdGgoKSwgbnVsbCAhPSB0aGlzLmFycm93c1JhZGl1cykge1xyXG4gICAgICAgICAgICBpZiAobGluay5hdHRyLmFycm93LmVuZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGN4LCBzLCB0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobGluay5hdHRyLmFycm93LnN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coY3gsIHQsIHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY29yZS9lbGVtZW50L2xpbmsvQ3VydmUuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Element=__webpack_require__(6);\r\nLink.prototype = new Element();\r\nmodule.exports =Link;\r\nfunction Link() {\r\n    this.getType=function(){\r\n        return \"link\";\r\n    };\r\n    this.setColor = function (color) {\r\n        if (color) {\r\n            color = QTopo.util.transHex(color.toLowerCase());\r\n            this.jtopo.strokeColor = color;\r\n            this.attr.color=this.jtopo.strokeColor;\r\n        }\r\n    };\r\n    this.setNum = function (num) {\r\n        if ($.isNumeric(num)&&num > 1) {\r\n            this.jtopo.text = '(+' + num + ')';\r\n        } else {\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.num=num;\r\n    };\r\n    this.setWidth=function(width){\r\n        this.jtopo.lineWidth = width; // 线宽\r\n        this.attr.width=width;\r\n    };\r\n    this.setArrow = function(arrow){\r\n        this.jtopo.arrowsRadius = $.isNumeric(arrow.size)?arrow.size:0;\r\n        this.jtopo.arrowsOffset = $.isNumeric(arrow.offset)?arrow.offset:0;\r\n        this.attr.arrow.size=this.jtopo.arrowsRadius;\r\n        this.attr.arrow.offset=this.jtopo.arrowsOffset;\r\n    };\r\n    this.setGap=function(gap){\r\n        this.jtopo.bundleGap = $.isNumeric(gap)?gap:0; // 线条之间的间隔\r\n        this.attr.gap=this.jtopo.bundleGap;\r\n    };\r\n    this.setDashed=function(dashedPattern){\r\n        if($.isNumeric(dashedPattern)&&dashedPattern>0){\r\n            this.jtopo.dashedPattern=dashedPattern;\r\n        }else{\r\n            this.jtopo.dashedPattern=null;\r\n        }\r\n        this.attr.dashed=this.jtopo.dashedPattern;\r\n    };\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbGluay9MaW5rLmpzPzg2ZTUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiOS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG52YXIgRWxlbWVudD1yZXF1aXJlKFwiLi4vRWxlbWVudC5qc1wiKTtcclxuTGluay5wcm90b3R5cGUgPSBuZXcgRWxlbWVudCgpO1xyXG5tb2R1bGUuZXhwb3J0cyA9TGluaztcclxuZnVuY3Rpb24gTGluaygpIHtcclxuICAgIHRoaXMuZ2V0VHlwZT1mdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiBcImxpbmtcIjtcclxuICAgIH07XHJcbiAgICB0aGlzLnNldENvbG9yID0gZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICAgICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgICAgIGNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5zdHJva2VDb2xvciA9IGNvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuY29sb3I9dGhpcy5qdG9wby5zdHJva2VDb2xvcjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXROdW0gPSBmdW5jdGlvbiAobnVtKSB7XHJcbiAgICAgICAgaWYgKCQuaXNOdW1lcmljKG51bSkmJm51bSA+IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gJygrJyArIG51bSArICcpJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLm51bT1udW07XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRXaWR0aD1mdW5jdGlvbih3aWR0aCl7XHJcbiAgICAgICAgdGhpcy5qdG9wby5saW5lV2lkdGggPSB3aWR0aDsgLy8g57q/5a69XHJcbiAgICAgICAgdGhpcy5hdHRyLndpZHRoPXdpZHRoO1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0QXJyb3cgPSBmdW5jdGlvbihhcnJvdyl7XHJcbiAgICAgICAgdGhpcy5qdG9wby5hcnJvd3NSYWRpdXMgPSAkLmlzTnVtZXJpYyhhcnJvdy5zaXplKT9hcnJvdy5zaXplOjA7XHJcbiAgICAgICAgdGhpcy5qdG9wby5hcnJvd3NPZmZzZXQgPSAkLmlzTnVtZXJpYyhhcnJvdy5vZmZzZXQpP2Fycm93Lm9mZnNldDowO1xyXG4gICAgICAgIHRoaXMuYXR0ci5hcnJvdy5zaXplPXRoaXMuanRvcG8uYXJyb3dzUmFkaXVzO1xyXG4gICAgICAgIHRoaXMuYXR0ci5hcnJvdy5vZmZzZXQ9dGhpcy5qdG9wby5hcnJvd3NPZmZzZXQ7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRHYXA9ZnVuY3Rpb24oZ2FwKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmJ1bmRsZUdhcCA9ICQuaXNOdW1lcmljKGdhcCk/Z2FwOjA7IC8vIOe6v+adoeS5i+mXtOeahOmXtOmalFxyXG4gICAgICAgIHRoaXMuYXR0ci5nYXA9dGhpcy5qdG9wby5idW5kbGVHYXA7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXREYXNoZWQ9ZnVuY3Rpb24oZGFzaGVkUGF0dGVybil7XHJcbiAgICAgICAgaWYoJC5pc051bWVyaWMoZGFzaGVkUGF0dGVybikmJmRhc2hlZFBhdHRlcm4+MCl7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uZGFzaGVkUGF0dGVybj1kYXNoZWRQYXR0ZXJuO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm49bnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLmRhc2hlZD10aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm47XHJcbiAgICB9O1xyXG59XHJcblxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2NvcmUvZWxlbWVudC9saW5rL0xpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(9);\r\nDirectLink.prototype=new Link();\r\nmodule.exports = DirectLink;\r\n//直线\r\nvar defaults =function(){\r\n    return {\r\n        num: 1,\r\n        alpha:1,\r\n        color: '22,124,255',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:\"微软雅黑\",\r\n            color:'255,255,255'\r\n        },\r\n        type: 'direct',\r\n        bundleOffset:60// 多条直线时，线条折线拐角处的长度\r\n    };\r\n};\r\nfunction DirectLink(config) {\r\n    if(!config.start||!config.end){\r\n        console.error(\"Create Link need start and end\");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.Link(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //源码修改\r\n    reset(self);\r\n\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    //双向箭头\r\n    link.jtopo.getStartPosition = function () {\r\n        var a;\r\n        return null != this.arrowsRadius && (a = (function (thisl) {\r\n            var b = thisl.nodeA, c = thisl.nodeZ;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), null == a && (a = {\r\n            x: this.nodeA.cx,\r\n            y: this.nodeA.cy\r\n        }), a;\r\n    };\r\n    link.jtopo.paintPath = function (a, b) {\r\n        if (this.nodeA === this.nodeZ) return void this.paintLoop(a);\r\n        a.beginPath(),\r\n            a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++) {\r\n            null == this.dashedPattern ? (\r\n                (null == this.PointPathColor ? a.lineTo(b[c].x, b[c].y) : a.JtopoDrawPointPath(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, a.strokeStyle, this.PointPathColor))\r\n            ) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern)\r\n        }\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(a, b[0], b[b.length - 1]);\r\n            }//终点箭头\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(a, b[b.length - 1], b[0]);\r\n            }//起点箭头\r\n        }\r\n    };\r\n}\r\nDirectLink.prototype.setBundleOffset=function(bundleOffset){\r\n    this.jtopo.bundleOffset=parseInt(bundleOffset);\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbGluay9EaXJlY3QuanM/ZTVhYyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGNBQWM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxudmFyIExpbms9cmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxuRGlyZWN0TGluay5wcm90b3R5cGU9bmV3IExpbmsoKTtcclxubW9kdWxlLmV4cG9ydHMgPSBEaXJlY3RMaW5rO1xyXG4vL+ebtOe6v1xyXG52YXIgZGVmYXVsdHMgPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG51bTogMSxcclxuICAgICAgICBhbHBoYToxLFxyXG4gICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICBzaXplOm51bGwsXHJcbiAgICAgICAgICAgIG9mZnNldDowLFxyXG4gICAgICAgICAgICBzdGFydDpmYWxzZSxcclxuICAgICAgICAgICAgZW5kOnRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdhcDoyMCxcclxuICAgICAgICB3aWR0aDogMixcclxuICAgICAgICBkYXNoZWQ6ICBudWxsLFxyXG4gICAgICAgIHpJbmRleCA6IDEwMCxcclxuICAgICAgICB0ZXh0T2Zmc2V0OlswLDBdLFxyXG4gICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICBzaXplOjE2LFxyXG4gICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHR5cGU6ICdkaXJlY3QnLFxyXG4gICAgICAgIGJ1bmRsZU9mZnNldDo2MC8vIOWkmuadoeebtOe6v+aXtu+8jOe6v+adoeaKmOe6v+aLkOinkuWkhOeahOmVv+W6plxyXG4gICAgfTtcclxufTtcclxuZnVuY3Rpb24gRGlyZWN0TGluayhjb25maWcpIHtcclxuICAgIGlmKCFjb25maWcuc3RhcnR8fCFjb25maWcuZW5kKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ3JlYXRlIExpbmsgbmVlZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuanRvcG8gPSBuZXcgSlRvcG8uTGluayhjb25maWcuc3RhcnQuanRvcG8sIGNvbmZpZy5lbmQuanRvcG8pO1xyXG4gICAgLy/lsIHoo4Xlr7nosaHkuYvpl7Tnm7jkupLkv53mjIHlvJXnlKhcclxuICAgIHNlbGYuanRvcG8ucXRvcG89c2VsZjtcclxuICAgIHNlbGYuYXR0ciA9ICBRVG9wby51dGlsLmV4dGVuZChkZWZhdWx0cygpLCBjb25maWcgfHwge30pO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHNlbGYuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgc2VsZi5zZXQoc2VsZi5hdHRyKTtcclxuICAgIC8v5rqQ56CB5L+u5pS5XHJcbiAgICByZXNldChzZWxmKTtcclxuXHJcbn1cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVzZXQobGluayl7XHJcbiAgICAvL+WPjOWQkeeureWktFxyXG4gICAgbGluay5qdG9wby5nZXRTdGFydFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhO1xyXG4gICAgICAgIHJldHVybiBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzICYmIChhID0gKGZ1bmN0aW9uICh0aGlzbCkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXNsLm5vZGVBLCBjID0gdGhpc2wubm9kZVo7XHJcbiAgICAgICAgICAgIHZhciBkID0gSlRvcG8udXRpbC5saW5lRihiLmN4LCBiLmN5LCBjLmN4LCBjLmN5KTtcclxuICAgICAgICAgICAgdmFyIGUgPSBiLmdldEJvdW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb25MaW5lQm91bmQoZCwgZSk7XHJcbiAgICAgICAgfSkodGhpcykpLCBudWxsID09IGEgJiYgKGEgPSB7XHJcbiAgICAgICAgICAgIHg6IHRoaXMubm9kZUEuY3gsXHJcbiAgICAgICAgICAgIHk6IHRoaXMubm9kZUEuY3lcclxuICAgICAgICB9KSwgYTtcclxuICAgIH07XHJcbiAgICBsaW5rLmp0b3BvLnBhaW50UGF0aCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHJldHVybiB2b2lkIHRoaXMucGFpbnRMb29wKGEpO1xyXG4gICAgICAgIGEuYmVnaW5QYXRoKCksXHJcbiAgICAgICAgICAgIGEubW92ZVRvKGJbMF0ueCwgYlswXS55KTtcclxuICAgICAgICBmb3IgKHZhciBjID0gMTsgYyA8IGIubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmRhc2hlZFBhdHRlcm4gPyAoXHJcbiAgICAgICAgICAgICAgICAobnVsbCA9PSB0aGlzLlBvaW50UGF0aENvbG9yID8gYS5saW5lVG8oYltjXS54LCBiW2NdLnkpIDogYS5KdG9wb0RyYXdQb2ludFBhdGgoYltjIC0gMV0ueCwgYltjIC0gMV0ueSwgYltjXS54LCBiW2NdLnksIGEuc3Ryb2tlU3R5bGUsIHRoaXMuUG9pbnRQYXRoQ29sb3IpKVxyXG4gICAgICAgICAgICApIDogYS5KVG9wb0Rhc2hlZExpbmVUbyhiW2MgLSAxXS54LCBiW2MgLSAxXS55LCBiW2NdLngsIGJbY10ueSwgdGhpcy5kYXNoZWRQYXR0ZXJuKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgbnVsbCAhPSB0aGlzLmFycm93c1JhZGl1cykge1xyXG4gICAgICAgICAgICBpZiAobGluay5hdHRyLmFycm93LmVuZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGEsIGJbMF0sIGJbYi5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgIH0vL+e7iOeCueeureWktFxyXG4gICAgICAgICAgICBpZiAobGluay5hdHRyLmFycm93LnN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgYltiLmxlbmd0aCAtIDFdLCBiWzBdKTtcclxuICAgICAgICAgICAgfS8v6LW354K5566t5aS0XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5EaXJlY3RMaW5rLnByb3RvdHlwZS5zZXRCdW5kbGVPZmZzZXQ9ZnVuY3Rpb24oYnVuZGxlT2Zmc2V0KXtcclxuICAgIHRoaXMuanRvcG8uYnVuZGxlT2Zmc2V0PXBhcnNlSW50KGJ1bmRsZU9mZnNldCk7XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jb3JlL2VsZW1lbnQvbGluay9EaXJlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDEwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(9);\r\nFlexionalLink.prototype=new Link();\r\nmodule.exports = FlexionalLink;\r\n//二次折线\r\nvar defaults =function(){\r\n    return {\r\n        num: 1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width:2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        type: \'flexional\',\r\n        direction:"horizontal",\r\n        offsetGap:60\r\n    };\r\n};\r\nfunction FlexionalLink(config){\r\n    if(!config.start||!config.end){\r\n        console.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.FlexionalLink(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //修改源码\r\n    reset(self);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    //双向箭头\r\n    link.jtopo.paintPath = function (a, b) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n        a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++)\r\n            null == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(a, b[b.length - 2], b[b.length - 1]);\r\n            }\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(a, b[1], b[0]);//添加双向箭头\r\n            }\r\n        }\r\n    };\r\n}\r\nFlexionalLink.prototype.setOffsetGap=function(offsetGap){\r\n    this.jtopo.offsetGap = parseInt(offsetGap);// 折线拐角处的长度\r\n    this.attr.offsetGap=this.jtopo.offsetGap;\r\n};\r\nFlexionalLink.prototype.setDirection=function(direction){\r\n    //折线方向 horizontal 水平 "vertical"垂直\r\n    this.jtopo.direction=direction;\r\n    this.attr.direction=this.jtopo.direction;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbGluay9GbGV4aW9uYWwuanM/Yzk4ZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixjQUFjO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjExLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvNy5cclxuICovXHJcbnZhciBMaW5rPXJlcXVpcmUoXCIuL0xpbmsuanNcIik7XHJcbkZsZXhpb25hbExpbmsucHJvdG90eXBlPW5ldyBMaW5rKCk7XHJcbm1vZHVsZS5leHBvcnRzID0gRmxleGlvbmFsTGluaztcclxuLy/kuozmrKHmipjnur9cclxudmFyIGRlZmF1bHRzID1mdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBudW06IDEsXHJcbiAgICAgICAgYWxwaGE6MSxcclxuICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgc2l6ZTpudWxsLFxyXG4gICAgICAgICAgICBvZmZzZXQ6MCxcclxuICAgICAgICAgICAgc3RhcnQ6ZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZDp0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnYXA6MjAsXHJcbiAgICAgICAgd2lkdGg6MixcclxuICAgICAgICBkYXNoZWQ6ICBudWxsLFxyXG4gICAgICAgIHpJbmRleCA6IDEwMCxcclxuICAgICAgICB0ZXh0T2Zmc2V0OlswLDBdLFxyXG4gICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICBzaXplOjE2LFxyXG4gICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHR5cGU6ICdmbGV4aW9uYWwnLFxyXG4gICAgICAgIGRpcmVjdGlvbjpcImhvcml6b250YWxcIixcclxuICAgICAgICBvZmZzZXRHYXA6NjBcclxuICAgIH07XHJcbn07XHJcbmZ1bmN0aW9uIEZsZXhpb25hbExpbmsoY29uZmlnKXtcclxuICAgIGlmKCFjb25maWcuc3RhcnR8fCFjb25maWcuZW5kKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ3JlYXRlIExpbmsgbmVlZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuanRvcG8gPSBuZXcgSlRvcG8uRmxleGlvbmFsTGluayhjb25maWcuc3RhcnQuanRvcG8sIGNvbmZpZy5lbmQuanRvcG8pO1xyXG4gICAgLy/lsIHoo4Xlr7nosaHkuYvpl7Tnm7jkupLkv53mjIHlvJXnlKhcclxuICAgIHNlbGYuanRvcG8ucXRvcG89c2VsZjtcclxuICAgIHNlbGYuYXR0ciA9ICBRVG9wby51dGlsLmV4dGVuZChkZWZhdWx0cygpLCBjb25maWcgfHwge30pO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHNlbGYuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgc2VsZi5zZXQoc2VsZi5hdHRyKTtcclxuICAgIC8v5L+u5pS55rqQ56CBXHJcbiAgICByZXNldChzZWxmKTtcclxufVxyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXNldChsaW5rKXtcclxuICAgIC8v5Y+M5ZCR566t5aS0XHJcbiAgICBsaW5rLmp0b3BvLnBhaW50UGF0aCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5tb3ZlVG8oYlswXS54LCBiWzBdLnkpO1xyXG4gICAgICAgIGZvciAodmFyIGMgPSAxOyBjIDwgYi5sZW5ndGg7IGMrKylcclxuICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmRhc2hlZFBhdHRlcm4gPyBhLmxpbmVUbyhiW2NdLngsIGJbY10ueSkgOiBhLkpUb3BvRGFzaGVkTGluZVRvKGJbYyAtIDFdLngsIGJbYyAtIDFdLnksIGJbY10ueCwgYltjXS55LCB0aGlzLmRhc2hlZFBhdHRlcm4pO1xyXG4gICAgICAgIGlmIChhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuZW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgYltiLmxlbmd0aCAtIDJdLCBiW2IubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhhLCBiWzFdLCBiWzBdKTsvL+a3u+WKoOWPjOWQkeeureWktFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5GbGV4aW9uYWxMaW5rLnByb3RvdHlwZS5zZXRPZmZzZXRHYXA9ZnVuY3Rpb24ob2Zmc2V0R2FwKXtcclxuICAgIHRoaXMuanRvcG8ub2Zmc2V0R2FwID0gcGFyc2VJbnQob2Zmc2V0R2FwKTsvLyDmipjnur/mi5Dop5LlpITnmoTplb/luqZcclxuICAgIHRoaXMuYXR0ci5vZmZzZXRHYXA9dGhpcy5qdG9wby5vZmZzZXRHYXA7XHJcbn07XHJcbkZsZXhpb25hbExpbmsucHJvdG90eXBlLnNldERpcmVjdGlvbj1mdW5jdGlvbihkaXJlY3Rpb24pe1xyXG4gICAgLy/mipjnur/mlrnlkJEgaG9yaXpvbnRhbCDmsLTlubMgXCJ2ZXJ0aWNhbFwi5Z6C55u0XHJcbiAgICB0aGlzLmp0b3BvLmRpcmVjdGlvbj1kaXJlY3Rpb247XHJcbiAgICB0aGlzLmF0dHIuZGlyZWN0aW9uPXRoaXMuanRvcG8uZGlyZWN0aW9uO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY29yZS9lbGVtZW50L2xpbmsvRmxleGlvbmFsLmpzXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(9);\r\nFoldLink.prototype=new Link();\r\nmodule.exports = FoldLink;\r\n//折线\r\nvar defaults =function(){\r\n    return {\r\n        num:1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        type: \'fold\',\r\n        direction:"vertical"\r\n    };\r\n};\r\nfunction FoldLink(config){\r\n    if(!config.start||!config.end){\r\n        console.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.FoldLink(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //修改源码\r\n    reset(self);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    //双向箭头\r\n    link.jtopo.paintPath = function (a, b) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n        a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++)\r\n            null == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(a, b[b.length - 2], b[b.length - 1]);\r\n            }\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(a, b[1], b[0]);//添加双向箭头\r\n            }\r\n        }\r\n    };\r\n}\r\nFoldLink.prototype.setDirection=function(direction){\r\n    //折线方向 horizontal 水平 "vertical"垂直\r\n    this.jtopo.direction=direction;\r\n    this.attr.direction=this.jtopo.direction;\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvbGluay9Gb2xkLmpzPzQ4ZmYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGNBQWM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG52YXIgTGluaz1yZXF1aXJlKFwiLi9MaW5rLmpzXCIpO1xyXG5Gb2xkTGluay5wcm90b3R5cGU9bmV3IExpbmsoKTtcclxubW9kdWxlLmV4cG9ydHMgPSBGb2xkTGluaztcclxuLy/mipjnur9cclxudmFyIGRlZmF1bHRzID1mdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBudW06MSxcclxuICAgICAgICBhbHBoYToxLFxyXG4gICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICBzaXplOm51bGwsXHJcbiAgICAgICAgICAgIG9mZnNldDowLFxyXG4gICAgICAgICAgICBzdGFydDpmYWxzZSxcclxuICAgICAgICAgICAgZW5kOnRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdhcDoyMCxcclxuICAgICAgICB3aWR0aDogMixcclxuICAgICAgICBkYXNoZWQ6ICBudWxsLFxyXG4gICAgICAgIHpJbmRleCA6IDEwMCxcclxuICAgICAgICB0ZXh0T2Zmc2V0OlswLDBdLFxyXG4gICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICBzaXplOjE2LFxyXG4gICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHR5cGU6ICdmb2xkJyxcclxuICAgICAgICBkaXJlY3Rpb246XCJ2ZXJ0aWNhbFwiXHJcbiAgICB9O1xyXG59O1xyXG5mdW5jdGlvbiBGb2xkTGluayhjb25maWcpe1xyXG4gICAgaWYoIWNvbmZpZy5zdGFydHx8IWNvbmZpZy5lbmQpe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5qdG9wbyA9IG5ldyBKVG9wby5Gb2xkTGluayhjb25maWcuc3RhcnQuanRvcG8sIGNvbmZpZy5lbmQuanRvcG8pO1xyXG4gICAgLy/lsIHoo4Xlr7nosaHkuYvpl7Tnm7jkupLkv53mjIHlvJXnlKhcclxuICAgIHNlbGYuanRvcG8ucXRvcG89c2VsZjtcclxuICAgIHNlbGYuYXR0ciA9ICBRVG9wby51dGlsLmV4dGVuZChkZWZhdWx0cygpLCBjb25maWcgfHwge30pO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHNlbGYuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgc2VsZi5zZXQoc2VsZi5hdHRyKTtcclxuICAgIC8v5L+u5pS55rqQ56CBXHJcbiAgICByZXNldChzZWxmKTtcclxufVxyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXNldChsaW5rKXtcclxuICAgIC8v5Y+M5ZCR566t5aS0XHJcbiAgICBsaW5rLmp0b3BvLnBhaW50UGF0aCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5tb3ZlVG8oYlswXS54LCBiWzBdLnkpO1xyXG4gICAgICAgIGZvciAodmFyIGMgPSAxOyBjIDwgYi5sZW5ndGg7IGMrKylcclxuICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmRhc2hlZFBhdHRlcm4gPyBhLmxpbmVUbyhiW2NdLngsIGJbY10ueSkgOiBhLkpUb3BvRGFzaGVkTGluZVRvKGJbYyAtIDFdLngsIGJbYyAtIDFdLnksIGJbY10ueCwgYltjXS55LCB0aGlzLmRhc2hlZFBhdHRlcm4pO1xyXG4gICAgICAgIGlmIChhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuZW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgYltiLmxlbmd0aCAtIDJdLCBiW2IubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhhLCBiWzFdLCBiWzBdKTsvL+a3u+WKoOWPjOWQkeeureWktFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5Gb2xkTGluay5wcm90b3R5cGUuc2V0RGlyZWN0aW9uPWZ1bmN0aW9uKGRpcmVjdGlvbil7XHJcbiAgICAvL+aKmOe6v+aWueWQkSBob3Jpem9udGFsIOawtOW5syBcInZlcnRpY2FsXCLlnoLnm7RcclxuICAgIHRoaXMuanRvcG8uZGlyZWN0aW9uPWRpcmVjdGlvbjtcclxuICAgIHRoaXMuYXR0ci5kaXJlY3Rpb249dGhpcy5qdG9wby5kaXJlY3Rpb247XHJcbn07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY29yZS9lbGVtZW50L2xpbmsvRm9sZC5qc1xuLy8gbW9kdWxlIGlkID0gMTJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/8.\r\n */\r\nvar Container=__webpack_require__(14);\r\nGroup.prototype = new Container();\r\nmodule.exports = Group;\r\n//曲线\r\nvar defaults = function () {\r\n    return {\r\n        name: 'group',\r\n        font:{\r\n            size:16,\r\n            type:\"微软雅黑\",\r\n            color:'255,255,255'\r\n        },\r\n        color: '10,10,100',\r\n        alpha: 0.5,\r\n        dragable: true,\r\n        zIndex: 10,\r\n        border:{\r\n            width:0,\r\n            radius:30,//最大160 最小0\r\n            color:\"255,0,0\"\r\n        },\r\n        textPosition: 'bottom',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n        layout: \"\",\r\n        children:{\r\n            showLink: false,\r\n            showName: true,\r\n            dragble: true\r\n        }\r\n    };\r\n};\r\n\r\nfunction Group(config) {\r\n    var self = this;\r\n    self.jtopo = new JTopo.Container();\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.children=[];\r\n    self.set(self.attr);\r\n    //改写源码绘制曲线,可由curveOffset指定弧度\r\n    reset(self);\r\n}\r\nvar defaultLayout = function (container, children) {\r\n    if (children.length > 0) {\r\n        var left = 1e7,\r\n            right = -1e7,\r\n            top = 1e7,\r\n            bottom = -1e7,\r\n            width = right - left,\r\n            height = bottom - top;\r\n        for (var i = 0; i < children.length; i++) {\r\n            var child = children[i];\r\n            child.x <= left && (left = child.x);\r\n            (child.x+child.width) >= right && (right = child.x+child.width);\r\n            child.y <= top && (top = child.y);\r\n            (child.y+child.height) >= bottom && (bottom = child.y+child.height);\r\n            width = right - left;\r\n            height = bottom - top;\r\n        }\r\n        container.x = left;\r\n        container.y = top;\r\n        container.width = width;\r\n        container.height = height;\r\n    }\r\n};\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(group) {\r\n    group.jtopo.layout=defaultLayout;\r\n}\r\nGroup.prototype.setLayout=function(layout){\r\n    var selected;\r\n    if (layout) {\r\n        switch (layout.type) {\r\n            case 'flow':\r\n                // 流式布局（水平,垂直间隔)\r\n                selected = JTopo.layout.FlowLayout(layout.row, layout.column);\r\n                this.attr.layout=layout;\r\n                break;\r\n            case 'grid':\r\n                // 网格布局(行,列)\r\n                selected = JTopo.layout.GridLayout(layout.row, layout.column);\r\n                this.attr.layout=layout;\r\n                break;\r\n            default:\r\n                selected = defaultLayout;\r\n                this.attr.layout={};\r\n                this.attr.layout.type=\"set\";\r\n        }\r\n    } else {\r\n        selected = defaultLayout;\r\n        this.attr.layout={};\r\n        this.attr.layout.type=\"set\";\r\n    }\r\n    this.jtopo.layout = selected;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvY29udGFpbmVyL0dyb3VwLmpzPzY5NzMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHFCQUFxQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjEzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvOC5cclxuICovXHJcbnZhciBDb250YWluZXI9cmVxdWlyZShcIi4vQ29udGFpbmVyLmpzXCIpO1xyXG5Hcm91cC5wcm90b3R5cGUgPSBuZXcgQ29udGFpbmVyKCk7XHJcbm1vZHVsZS5leHBvcnRzID0gR3JvdXA7XHJcbi8v5puy57q/XHJcbnZhciBkZWZhdWx0cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmFtZTogJ2dyb3VwJyxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb2xvcjogJzEwLDEwLDEwMCcsXHJcbiAgICAgICAgYWxwaGE6IDAuNSxcclxuICAgICAgICBkcmFnYWJsZTogdHJ1ZSxcclxuICAgICAgICB6SW5kZXg6IDEwLFxyXG4gICAgICAgIGJvcmRlcjp7XHJcbiAgICAgICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgICAgIHJhZGl1czozMCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgIGNvbG9yOlwiMjU1LDAsMFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0ZXh0UG9zaXRpb246ICdib3R0b20nLC8vQm90dG9tX0NlbnRlciBUb3BfQ2VudGVyIE1pZGRsZV9MZWZ0IE1pZGRsZV9SaWdodCBIaWRkZW4sXHJcbiAgICAgICAgbGF5b3V0OiBcIlwiLFxyXG4gICAgICAgIGNoaWxkcmVuOntcclxuICAgICAgICAgICAgc2hvd0xpbms6IGZhbHNlLFxyXG4gICAgICAgICAgICBzaG93TmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgZHJhZ2JsZTogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XHJcblxyXG5mdW5jdGlvbiBHcm91cChjb25maWcpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuanRvcG8gPSBuZXcgSlRvcG8uQ29udGFpbmVyKCk7XHJcbiAgICAvL+WwgeijheWvueixoeS5i+mXtOebuOS6kuS/neaMgeW8leeUqFxyXG4gICAgc2VsZi5qdG9wby5xdG9wbz1zZWxmO1xyXG4gICAgc2VsZi5hdHRyID0gIFFUb3BvLnV0aWwuZXh0ZW5kKGRlZmF1bHRzKCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgc2VsZi5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICBzZWxmLmNoaWxkcmVuPVtdO1xyXG4gICAgc2VsZi5zZXQoc2VsZi5hdHRyKTtcclxuICAgIC8v5pS55YaZ5rqQ56CB57uY5Yi25puy57q/LOWPr+eUsWN1cnZlT2Zmc2V05oyH5a6a5byn5bqmXHJcbiAgICByZXNldChzZWxmKTtcclxufVxyXG52YXIgZGVmYXVsdExheW91dCA9IGZ1bmN0aW9uIChjb250YWluZXIsIGNoaWxkcmVuKSB7XHJcbiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHZhciBsZWZ0ID0gMWU3LFxyXG4gICAgICAgICAgICByaWdodCA9IC0xZTcsXHJcbiAgICAgICAgICAgIHRvcCA9IDFlNyxcclxuICAgICAgICAgICAgYm90dG9tID0gLTFlNyxcclxuICAgICAgICAgICAgd2lkdGggPSByaWdodCAtIGxlZnQsXHJcbiAgICAgICAgICAgIGhlaWdodCA9IGJvdHRvbSAtIHRvcDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBjaGlsZC54IDw9IGxlZnQgJiYgKGxlZnQgPSBjaGlsZC54KTtcclxuICAgICAgICAgICAgKGNoaWxkLngrY2hpbGQud2lkdGgpID49IHJpZ2h0ICYmIChyaWdodCA9IGNoaWxkLngrY2hpbGQud2lkdGgpO1xyXG4gICAgICAgICAgICBjaGlsZC55IDw9IHRvcCAmJiAodG9wID0gY2hpbGQueSk7XHJcbiAgICAgICAgICAgIChjaGlsZC55K2NoaWxkLmhlaWdodCkgPj0gYm90dG9tICYmIChib3R0b20gPSBjaGlsZC55K2NoaWxkLmhlaWdodCk7XHJcbiAgICAgICAgICAgIHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xyXG4gICAgICAgICAgICBoZWlnaHQgPSBib3R0b20gLSB0b3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRhaW5lci54ID0gbGVmdDtcclxuICAgICAgICBjb250YWluZXIueSA9IHRvcDtcclxuICAgICAgICBjb250YWluZXIud2lkdGggPSB3aWR0aDtcclxuICAgICAgICBjb250YWluZXIuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIHNlbGYuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXNldChncm91cCkge1xyXG4gICAgZ3JvdXAuanRvcG8ubGF5b3V0PWRlZmF1bHRMYXlvdXQ7XHJcbn1cclxuR3JvdXAucHJvdG90eXBlLnNldExheW91dD1mdW5jdGlvbihsYXlvdXQpe1xyXG4gICAgdmFyIHNlbGVjdGVkO1xyXG4gICAgaWYgKGxheW91dCkge1xyXG4gICAgICAgIHN3aXRjaCAobGF5b3V0LnR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSAnZmxvdyc6XHJcbiAgICAgICAgICAgICAgICAvLyDmtYHlvI/luIPlsYDvvIjmsLTlubMs5Z6C55u06Ze06ZqUKVxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSBKVG9wby5sYXlvdXQuRmxvd0xheW91dChsYXlvdXQucm93LCBsYXlvdXQuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9bGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2dyaWQnOlxyXG4gICAgICAgICAgICAgICAgLy8g572R5qC85biD5bGAKOihjCzliJcpXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLmxheW91dC5HcmlkTGF5b3V0KGxheW91dC5yb3csIGxheW91dC5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLmxheW91dD1sYXlvdXQ7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gZGVmYXVsdExheW91dDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9e307XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0LnR5cGU9XCJzZXRcIjtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNlbGVjdGVkID0gZGVmYXVsdExheW91dDtcclxuICAgICAgICB0aGlzLmF0dHIubGF5b3V0PXt9O1xyXG4gICAgICAgIHRoaXMuYXR0ci5sYXlvdXQudHlwZT1cInNldFwiO1xyXG4gICAgfVxyXG4gICAgdGhpcy5qdG9wby5sYXlvdXQgPSBzZWxlY3RlZDtcclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanNcbi8vIG1vZHVsZSBpZCA9IDEzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=");
},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Element=__webpack_require__(6);\r\nContainer.prototype = new Element();\r\nmodule.exports =Container;\r\nfunction Container() {\r\n    this.setName=function(name){\r\n        if(this.attr.textPosition!="hide"){\r\n            this.jtopo.text=name;\r\n            this.attr.name=name;\r\n        }\r\n    };\r\n    this.add = function (element) {\r\n        if (!$.isArray(this.children)) {\r\n            this.children = [];\r\n        }\r\n        if(element.jtopo&&this.children.indexOf(element)<0){\r\n            this.children.push(element);\r\n            this.jtopo.add(element.jtopo);\r\n        }\r\n    };\r\n    this.remove=function(element){\r\n        if($.isArray(this.children)&&this.children.indexOf(element)>0){\r\n            this.children.splice(this.children.indexOf(element),1);\r\n            this.jtopo.remove(element.jtopo);\r\n        }\r\n    };\r\n    this.getChildren=function(){\r\n        var children=[];\r\n        var self=this;\r\n        if(self.jtopo&&self.jtopo.childs){\r\n            $.each(self.jtopo.childs,function(i,v){\r\n                if(v.qtopo){\r\n                    children.push(v.qtopo);\r\n                }else{\r\n                    console.error(this,"the child not wraped by qtopo",v);\r\n                }\r\n            });\r\n        }\r\n        this.children=children;\r\n        return children;\r\n    };\r\n    this.getType = function () {\r\n        return "container"\r\n    };\r\n    this.setColor = function (color) {\r\n        if (color) {\r\n            color = QTopo.util.transHex(color.toLowerCase());\r\n            this.jtopo.fillColor = color;\r\n            this.attr.color=color;\r\n        }\r\n    };\r\n    this.setBorder = function (border) {\r\n        if (border.color && $.isNumeric(border.width) && $.isNumeric(border.radius)) {\r\n            this.jtopo.borderColor = QTopo.util.transHex(border.color.toLowerCase());\r\n            this.jtopo.borderWidth = parseInt(border.width);\r\n            this.jtopo.borderRadius = parseInt(border.radius);\r\n            this.attr.border.color=this.jtopo.borderColor;\r\n            this.attr.border.width=this.jtopo.borderWidth;\r\n            this.attr.border.raidus=this.jtopo.borderRadius;\r\n        } else {\r\n            console.error(this,"setBorder need params", border);\r\n        }\r\n    };\r\n    this.setChildren = function (children) {\r\n        if (children) {\r\n            this.jtopo.childDragble = typeof children.dragble == "boolean" ? children.dragble : true;\r\n            this.attr.children.dragble=this.jtopo.childDragble;\r\n        }\r\n    };\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2VsZW1lbnQvY29udGFpbmVyL0NvbnRhaW5lci5qcz84MjdlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxNC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG52YXIgRWxlbWVudD1yZXF1aXJlKFwiLi4vRWxlbWVudC5qc1wiKTtcclxuQ29udGFpbmVyLnByb3RvdHlwZSA9IG5ldyBFbGVtZW50KCk7XHJcbm1vZHVsZS5leHBvcnRzID1Db250YWluZXI7XHJcbmZ1bmN0aW9uIENvbnRhaW5lcigpIHtcclxuICAgIHRoaXMuc2V0TmFtZT1mdW5jdGlvbihuYW1lKXtcclxuICAgICAgICBpZih0aGlzLmF0dHIudGV4dFBvc2l0aW9uIT1cImhpZGVcIil7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dD1uYW1lO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIubmFtZT1uYW1lO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLmFkZCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCEkLmlzQXJyYXkodGhpcy5jaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihlbGVtZW50Lmp0b3BvJiZ0aGlzLmNoaWxkcmVuLmluZGV4T2YoZWxlbWVudCk8MCl7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaChlbGVtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5hZGQoZWxlbWVudC5qdG9wbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMucmVtb3ZlPWZ1bmN0aW9uKGVsZW1lbnQpe1xyXG4gICAgICAgIGlmKCQuaXNBcnJheSh0aGlzLmNoaWxkcmVuKSYmdGhpcy5jaGlsZHJlbi5pbmRleE9mKGVsZW1lbnQpPjApe1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZSh0aGlzLmNoaWxkcmVuLmluZGV4T2YoZWxlbWVudCksMSk7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8ucmVtb3ZlKGVsZW1lbnQuanRvcG8pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLmdldENoaWxkcmVuPWZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuPVtdO1xyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgaWYoc2VsZi5qdG9wbyYmc2VsZi5qdG9wby5jaGlsZHMpe1xyXG4gICAgICAgICAgICAkLmVhY2goc2VsZi5qdG9wby5jaGlsZHMsZnVuY3Rpb24oaSx2KXtcclxuICAgICAgICAgICAgICAgIGlmKHYucXRvcG8pe1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godi5xdG9wbyk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMsXCJ0aGUgY2hpbGQgbm90IHdyYXBlZCBieSBxdG9wb1wiLHYpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbj1jaGlsZHJlbjtcclxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XHJcbiAgICB9O1xyXG4gICAgdGhpcy5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBcImNvbnRhaW5lclwiXHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgICAgICBjb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uZmlsbENvbG9yID0gY29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5jb2xvcj1jb2xvcjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRCb3JkZXIgPSBmdW5jdGlvbiAoYm9yZGVyKSB7XHJcbiAgICAgICAgaWYgKGJvcmRlci5jb2xvciAmJiAkLmlzTnVtZXJpYyhib3JkZXIud2lkdGgpICYmICQuaXNOdW1lcmljKGJvcmRlci5yYWRpdXMpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uYm9yZGVyQ29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGJvcmRlci5jb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5ib3JkZXJXaWR0aCA9IHBhcnNlSW50KGJvcmRlci53aWR0aCk7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uYm9yZGVyUmFkaXVzID0gcGFyc2VJbnQoYm9yZGVyLnJhZGl1cyk7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5ib3JkZXIuY29sb3I9dGhpcy5qdG9wby5ib3JkZXJDb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLmJvcmRlci53aWR0aD10aGlzLmp0b3BvLmJvcmRlcldpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuYm9yZGVyLnJhaWR1cz10aGlzLmp0b3BvLmJvcmRlclJhZGl1cztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMsXCJzZXRCb3JkZXIgbmVlZCBwYXJhbXNcIiwgYm9yZGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRDaGlsZHJlbiA9IGZ1bmN0aW9uIChjaGlsZHJlbikge1xyXG4gICAgICAgIGlmIChjaGlsZHJlbikge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmNoaWxkRHJhZ2JsZSA9IHR5cGVvZiBjaGlsZHJlbi5kcmFnYmxlID09IFwiYm9vbGVhblwiID8gY2hpbGRyZW4uZHJhZ2JsZSA6IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5jaGlsZHJlbi5kcmFnYmxlPXRoaXMuanRvcG8uY2hpbGREcmFnYmxlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY29yZS9lbGVtZW50L2NvbnRhaW5lci9Db250YWluZXIuanNcbi8vIG1vZHVsZSBpZCA9IDE0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=')}]);