!function(g){function I(A){if(C[A])return C[A].exports;var n=C[A]={i:A,l:!1,exports:{}};return g[A].call(n.exports,n,n.exports,I),n.l=!0,n.exports}var C={};return I.m=g,I.c=C,I.i=function(g){return g},I.d=function(g,C,A){I.o(g,C)||Object.defineProperty(g,C,{configurable:!1,enumerable:!0,get:A})},I.n=function(g){var C=g&&g.__esModule?function(){return g.default}:function(){return g};return I.d(C,"a",C),C},I.o=function(g,I){return Object.prototype.hasOwnProperty.call(g,I)},I.p="",I(I.s=16)}([function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Element=__webpack_require__(1);\r\nLink.prototype = new Element();\r\nmodule.exports =Link;\r\nfunction Link() {\r\n    this.getType=function(){\r\n        return \"link\";\r\n    };\r\n    this.setColor = function (color) {\r\n        if (color) {\r\n            color = QTopo.util.transHex(color.toLowerCase());\r\n            this.jtopo.strokeColor = color;\r\n            this.attr.color=this.jtopo.strokeColor;\r\n        }\r\n    };\r\n    this.setNum = function (num) {\r\n        if ($.isNumeric(num)&&num > 1) {\r\n            this.jtopo.text = '(+' + num + ')';\r\n        } else {\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.num=num;\r\n    };\r\n    this.setWidth=function(width){\r\n        this.jtopo.lineWidth = width; // 线宽\r\n        this.attr.width=width;\r\n    };\r\n    this.setArrow = function(arrow){\r\n        this.jtopo.arrowsRadius = $.isNumeric(arrow.size)?arrow.size:0;\r\n        this.jtopo.arrowsOffset = $.isNumeric(arrow.offset)?arrow.offset:0;\r\n        this.attr.arrow.size=this.jtopo.arrowsRadius;\r\n        this.attr.arrow.offset=this.jtopo.arrowsOffset;\r\n    };\r\n    this.setGap=function(gap){\r\n        this.jtopo.bundleGap = $.isNumeric(gap)?gap:0; // 线条之间的间隔\r\n        this.attr.gap=this.jtopo.bundleGap;\r\n    };\r\n    this.setDashed=function(dashedPattern){\r\n        if($.isNumeric(dashedPattern)&&dashedPattern>0){\r\n            this.jtopo.dashedPattern=dashedPattern;\r\n        }else{\r\n            this.jtopo.dashedPattern=null;\r\n        }\r\n        this.attr.dashed=this.jtopo.dashedPattern;\r\n    };\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0xpbmsuanM/NTYwMCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvNy5cclxuICovXHJcbnZhciBFbGVtZW50PXJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5MaW5rLnByb3RvdHlwZSA9IG5ldyBFbGVtZW50KCk7XHJcbm1vZHVsZS5leHBvcnRzID1MaW5rO1xyXG5mdW5jdGlvbiBMaW5rKCkge1xyXG4gICAgdGhpcy5nZXRUeXBlPWZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuIFwibGlua1wiO1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0Q29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgICAgICBpZiAoY29sb3IpIHtcclxuICAgICAgICAgICAgY29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnN0cm9rZUNvbG9yID0gY29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5jb2xvcj10aGlzLmp0b3BvLnN0cm9rZUNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLnNldE51bSA9IGZ1bmN0aW9uIChudW0pIHtcclxuICAgICAgICBpZiAoJC5pc051bWVyaWMobnVtKSYmbnVtID4gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSAnKCsnICsgbnVtICsgJyknO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF0dHIubnVtPW51bTtcclxuICAgIH07XHJcbiAgICB0aGlzLnNldFdpZHRoPWZ1bmN0aW9uKHdpZHRoKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmxpbmVXaWR0aCA9IHdpZHRoOyAvLyDnur/lrr1cclxuICAgICAgICB0aGlzLmF0dHIud2lkdGg9d2lkdGg7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRBcnJvdyA9IGZ1bmN0aW9uKGFycm93KXtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c1JhZGl1cyA9ICQuaXNOdW1lcmljKGFycm93LnNpemUpP2Fycm93LnNpemU6MDtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c09mZnNldCA9ICQuaXNOdW1lcmljKGFycm93Lm9mZnNldCk/YXJyb3cub2Zmc2V0OjA7XHJcbiAgICAgICAgdGhpcy5hdHRyLmFycm93LnNpemU9dGhpcy5qdG9wby5hcnJvd3NSYWRpdXM7XHJcbiAgICAgICAgdGhpcy5hdHRyLmFycm93Lm9mZnNldD10aGlzLmp0b3BvLmFycm93c09mZnNldDtcclxuICAgIH07XHJcbiAgICB0aGlzLnNldEdhcD1mdW5jdGlvbihnYXApe1xyXG4gICAgICAgIHRoaXMuanRvcG8uYnVuZGxlR2FwID0gJC5pc051bWVyaWMoZ2FwKT9nYXA6MDsgLy8g57q/5p2h5LmL6Ze055qE6Ze06ZqUXHJcbiAgICAgICAgdGhpcy5hdHRyLmdhcD10aGlzLmp0b3BvLmJ1bmRsZUdhcDtcclxuICAgIH07XHJcbiAgICB0aGlzLnNldERhc2hlZD1mdW5jdGlvbihkYXNoZWRQYXR0ZXJuKXtcclxuICAgICAgICBpZigkLmlzTnVtZXJpYyhkYXNoZWRQYXR0ZXJuKSYmZGFzaGVkUGF0dGVybj4wKXtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuPWRhc2hlZFBhdHRlcm47XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uZGFzaGVkUGF0dGVybj1udWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF0dHIuZGFzaGVkPXRoaXMuanRvcG8uZGFzaGVkUGF0dGVybjtcclxuICAgIH07XHJcbn1cclxuXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluay9MaW5rLmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nmodule.exports =Element;\r\nfunction Element() {\r\n    this.show = function () {\r\n        this.jtopo.visible = true;\r\n        this.attr.show=this.jtopo.visible;\r\n    };\r\n    this.hide = function () {\r\n        this.jtopo.visible = false;\r\n        this.attr.show=this.jtopo.visible;\r\n    };\r\n    this.setText = function (text) {\r\n        this.jtopo.text = text;\r\n        this.attr.text=text;\r\n    };\r\n    this.on = function (name, fn) {\r\n        this.jtopo.addEventListener(name, function (e) {\r\n            if(e.target&&e.target.qtopo){\r\n                fn(e,e.target.qtopo);\r\n            }else{\r\n                fn(e);\r\n            }\r\n        });\r\n    };\r\n    this.off = function (name, fn) {\r\n        this.jtopo.removeEventListener(name);\r\n    };\r\n    this.setZIndex = function (zIndex) {\r\n        this.jtopo.zIndex = parseInt($.isNumeric(zIndex) ? zIndex : 10);\r\n        this.attr.zIndex=this.jtopo.zIndex;\r\n    };\r\n    this.setFont = function (font) {\r\n        if(font){\r\n            var type= this.attr.font.type;\r\n            var size=this.attr.font.size;\r\n            if ($.isNumeric(font.size)) {\r\n                this.attr.font.size=font.size;\r\n                size=font.size;\r\n            }\r\n            if(font.type){\r\n                this.attr.font.type=font.type;\r\n                type=font.type;\r\n            }\r\n            this.jtopo.font = size + "px " + type;\r\n            if (font.color) {\r\n                this.jtopo.fontColor = QTopo.util.transHex(font.color.toLowerCase());\r\n                this.attr.font.color=this.jtopo.fontColor;\r\n            }\r\n        }\r\n    };\r\n    this.setAlpha = function (alpha) {\r\n        if ($.isNumeric(alpha) && alpha <= 1 && alpha > 0) {\r\n            this.jtopo.alpha = alpha;\r\n        } else {\r\n            this.jtopo.alpha = 1;\r\n        }\r\n        this.attr.alpha= this.jtopo.alpha;\r\n    };\r\n    this.setTextOffset = function (arr) {\r\n        if ($.isArray(arr) && arr.length >= 2) {\r\n            this.jtopo.textOffsetX = arr[0];\r\n            this.jtopo.textOffsetY = arr[1];\r\n            this.attr.textOffset=arr;\r\n        } else {\r\n            console.error(this,"textOffset need be array and 2 length");\r\n        }\r\n    };\r\n    this.setPosition = function (position) {\r\n        if ($.isArray(position) && position.length >= 2) {\r\n            if ($.isNumeric(position[0]) && $.isNumeric(position[1])) {\r\n                this.jtopo.setLocation(parseInt(position[0]), parseInt(position[1]));\r\n                this.attr.position=[this.jtopo.x, this.jtopo.y];\r\n            }\r\n        } else {\r\n            console.error(this,"position need be array and 2 length");\r\n        }\r\n    };\r\n    this.setSize = function (size) {\r\n        if ($.isArray(size) && size.length >= 2) {\r\n            this.jtopo.setSize(size[0], size[1]);\r\n            this.attr.size=[this.jtopo.width,this.jtopo.height];\r\n        } else {\r\n            console.error(this,"size need be array and 2 length");\r\n        }\r\n    };\r\n    this.setDragable = function (dragable) {\r\n        this.jtopo.dragable = dragable;\r\n        this.attr.dragable=this.jtopo.dragable;\r\n    };\r\n    this.setTextPosition = function (textPosition) {\r\n        var jtopo = this.jtopo;\r\n        jtopo.text = this.attr.name;\r\n        switch (textPosition) {\r\n            case \'hide\':\r\n                jtopo.text = \'\';\r\n                this.attr.textPosition="hide";\r\n                break;\r\n            case \'bottom\':\r\n                jtopo.textOffsetX = 0;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Bottom_Center";\r\n                this.attr.textPosition="bottom";\r\n                break;\r\n            case \'top\':\r\n                jtopo.textOffsetX = 0;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Top_Center";\r\n                this.attr.textPosition="top";\r\n                break;\r\n            case \'left\':\r\n                jtopo.textOffsetX = -5;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Middle_Left";\r\n                this.attr.textPosition="left";\r\n                break;\r\n            case \'right\':\r\n                jtopo.textOffsetX = 5;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.textPosition = "Middle_Right";\r\n                this.attr.textPosition="right";\r\n                break;\r\n            default:\r\n                jtopo.textOffsetX = 0;\r\n                jtopo.textOffsetY = 0;\r\n                jtopo.text = this.attr.name;\r\n                jtopo.textPosition = \'Bottom_Center\';\r\n                this.attr.textPosition="bottom";\r\n                console.error(this,"set wrong textPosition,default is bottom");\r\n                break;\r\n        }\r\n    };\r\n    //只要对应属性有方法则修改\r\n    this._setAttr = function (config) {\r\n        var self = this;\r\n        $.each(config, function (k, v) {\r\n            try {\r\n                var fn = self[\'set\' + QTopo.util.upFirst(k)];\r\n                if (fn) {\r\n                    //v=QTopo.util.merge(self.attr[k],v);\r\n                    fn.call(self, v);\r\n                }\r\n            } catch (e) {\r\n                console.error(self,"Element _setAttr error :" + k,e);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9FbGVtZW50LmpzPzg1ZDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EiLCJmaWxlIjoiMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG5tb2R1bGUuZXhwb3J0cyA9RWxlbWVudDtcclxuZnVuY3Rpb24gRWxlbWVudCgpIHtcclxuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYXR0ci5zaG93PXRoaXMuanRvcG8udmlzaWJsZTtcclxuICAgIH07XHJcbiAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hdHRyLnNob3c9dGhpcy5qdG9wby52aXNpYmxlO1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0VGV4dCA9IGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gdGV4dDtcclxuICAgICAgICB0aGlzLmF0dHIudGV4dD10ZXh0O1xyXG4gICAgfTtcclxuICAgIHRoaXMub24gPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgaWYoZS50YXJnZXQmJmUudGFyZ2V0LnF0b3BvKXtcclxuICAgICAgICAgICAgICAgIGZuKGUsZS50YXJnZXQucXRvcG8pO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGZuKGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5vZmYgPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRaSW5kZXggPSBmdW5jdGlvbiAoekluZGV4KSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby56SW5kZXggPSBwYXJzZUludCgkLmlzTnVtZXJpYyh6SW5kZXgpID8gekluZGV4IDogMTApO1xyXG4gICAgICAgIHRoaXMuYXR0ci56SW5kZXg9dGhpcy5qdG9wby56SW5kZXg7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRGb250ID0gZnVuY3Rpb24gKGZvbnQpIHtcclxuICAgICAgICBpZihmb250KXtcclxuICAgICAgICAgICAgdmFyIHR5cGU9IHRoaXMuYXR0ci5mb250LnR5cGU7XHJcbiAgICAgICAgICAgIHZhciBzaXplPXRoaXMuYXR0ci5mb250LnNpemU7XHJcbiAgICAgICAgICAgIGlmICgkLmlzTnVtZXJpYyhmb250LnNpemUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIuZm9udC5zaXplPWZvbnQuc2l6ZTtcclxuICAgICAgICAgICAgICAgIHNpemU9Zm9udC5zaXplO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKGZvbnQudHlwZSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIuZm9udC50eXBlPWZvbnQudHlwZTtcclxuICAgICAgICAgICAgICAgIHR5cGU9Zm9udC50eXBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uZm9udCA9IHNpemUgKyBcInB4IFwiICsgdHlwZTtcclxuICAgICAgICAgICAgaWYgKGZvbnQuY29sb3IpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuanRvcG8uZm9udENvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChmb250LmNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLmZvbnQuY29sb3I9dGhpcy5qdG9wby5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRBbHBoYSA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICAgIGlmICgkLmlzTnVtZXJpYyhhbHBoYSkgJiYgYWxwaGEgPD0gMSAmJiBhbHBoYSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5hbHBoYSA9IGFscGhhO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uYWxwaGEgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF0dHIuYWxwaGE9IHRoaXMuanRvcG8uYWxwaGE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRUZXh0T2Zmc2V0ID0gZnVuY3Rpb24gKGFycikge1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoYXJyKSAmJiBhcnIubGVuZ3RoID49IDIpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0T2Zmc2V0WCA9IGFyclswXTtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0T2Zmc2V0WSA9IGFyclsxXTtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLnRleHRPZmZzZXQ9YXJyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcyxcInRleHRPZmZzZXQgbmVlZCBiZSBhcnJheSBhbmQgMiBsZW5ndGhcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0UG9zaXRpb24gPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KHBvc2l0aW9uKSAmJiBwb3NpdGlvbi5sZW5ndGggPj0gMikge1xyXG4gICAgICAgICAgICBpZiAoJC5pc051bWVyaWMocG9zaXRpb25bMF0pICYmICQuaXNOdW1lcmljKHBvc2l0aW9uWzFdKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5qdG9wby5zZXRMb2NhdGlvbihwYXJzZUludChwb3NpdGlvblswXSksIHBhcnNlSW50KHBvc2l0aW9uWzFdKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIucG9zaXRpb249W3RoaXMuanRvcG8ueCwgdGhpcy5qdG9wby55XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcyxcInBvc2l0aW9uIG5lZWQgYmUgYXJyYXkgYW5kIDIgbGVuZ3RoXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLnNldFNpemUgPSBmdW5jdGlvbiAoc2l6ZSkge1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoc2l6ZSkgJiYgc2l6ZS5sZW5ndGggPj0gMikge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnNldFNpemUoc2l6ZVswXSwgc2l6ZVsxXSk7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5zaXplPVt0aGlzLmp0b3BvLndpZHRoLHRoaXMuanRvcG8uaGVpZ2h0XTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMsXCJzaXplIG5lZWQgYmUgYXJyYXkgYW5kIDIgbGVuZ3RoXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLnNldERyYWdhYmxlID0gZnVuY3Rpb24gKGRyYWdhYmxlKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kcmFnYWJsZSA9IGRyYWdhYmxlO1xyXG4gICAgICAgIHRoaXMuYXR0ci5kcmFnYWJsZT10aGlzLmp0b3BvLmRyYWdhYmxlO1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0VGV4dFBvc2l0aW9uID0gZnVuY3Rpb24gKHRleHRQb3NpdGlvbikge1xyXG4gICAgICAgIHZhciBqdG9wbyA9IHRoaXMuanRvcG87XHJcbiAgICAgICAganRvcG8udGV4dCA9IHRoaXMuYXR0ci5uYW1lO1xyXG4gICAgICAgIHN3aXRjaCAodGV4dFBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2hpZGUnOlxyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLnRleHRQb3NpdGlvbj1cImhpZGVcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFggPSAwO1xyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dFBvc2l0aW9uID0gXCJCb3R0b21fQ2VudGVyXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIudGV4dFBvc2l0aW9uPVwiYm90dG9tXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndG9wJzpcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiVG9wX0NlbnRlclwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLnRleHRQb3NpdGlvbj1cInRvcFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFggPSAtNTtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiTWlkZGxlX0xlZnRcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci50ZXh0UG9zaXRpb249XCJsZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFggPSA1O1xyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICAgICAganRvcG8udGV4dFBvc2l0aW9uID0gXCJNaWRkbGVfUmlnaHRcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci50ZXh0UG9zaXRpb249XCJyaWdodFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0T2Zmc2V0WCA9IDA7XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0ID0gdGhpcy5hdHRyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSAnQm90dG9tX0NlbnRlcic7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIudGV4dFBvc2l0aW9uPVwiYm90dG9tXCI7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMsXCJzZXQgd3JvbmcgdGV4dFBvc2l0aW9uLGRlZmF1bHQgaXMgYm90dG9tXCIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8v5Y+q6KaB5a+55bqU5bGe5oCn5pyJ5pa55rOV5YiZ5L+u5pS5XHJcbiAgICB0aGlzLl9zZXRBdHRyID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkLmVhY2goY29uZmlnLCBmdW5jdGlvbiAoaywgdikge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZuID0gc2VsZlsnc2V0JyArIFFUb3BvLnV0aWwudXBGaXJzdChrKV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZm4pIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3Y9UVRvcG8udXRpbC5tZXJnZShzZWxmLmF0dHJba10sdik7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4uY2FsbChzZWxmLCB2KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihzZWxmLFwiRWxlbWVudCBfc2V0QXR0ciBlcnJvciA6XCIgKyBrLGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvRWxlbWVudC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Element=__webpack_require__(1);\r\nNode.prototype = new Element();\r\nmodule.exports =Node;\r\nfunction Node() {\r\n    this.getType=function(){\r\n        return "node";\r\n    };\r\n    this.setColor = function (color) {\r\n        if (color) {\r\n            color = QTopo.util.transHex(color.toLowerCase());\r\n            this.jtopo.fillColor = color;\r\n            this.attr.color=this.jtopo.fillColor;\r\n        }\r\n    };\r\n    this.setName=function(name){\r\n        if(this.attr.textPosition!="hide"){\r\n            this.jtopo.text=name;\r\n            this.attr.name=this.jtopo.text;\r\n        }\r\n    };\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL05vZGUuanM/OTA1OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG52YXIgRWxlbWVudD1yZXF1aXJlKFwiLi4vRWxlbWVudC5qc1wiKTtcclxuTm9kZS5wcm90b3R5cGUgPSBuZXcgRWxlbWVudCgpO1xyXG5tb2R1bGUuZXhwb3J0cyA9Tm9kZTtcclxuZnVuY3Rpb24gTm9kZSgpIHtcclxuICAgIHRoaXMuZ2V0VHlwZT1mdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiBcIm5vZGVcIjtcclxuICAgIH07XHJcbiAgICB0aGlzLnNldENvbG9yID0gZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICAgICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgICAgIGNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5maWxsQ29sb3IgPSBjb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLmNvbG9yPXRoaXMuanRvcG8uZmlsbENvbG9yO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLnNldE5hbWU9ZnVuY3Rpb24obmFtZSl7XHJcbiAgICAgICAgaWYodGhpcy5hdHRyLnRleHRQb3NpdGlvbiE9XCJoaWRlXCIpe1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQ9bmFtZTtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWU9dGhpcy5qdG9wby50ZXh0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbm9kZS9Ob2RlLmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/16.\r\n */\r\n//依赖bootstrap\r\n__webpack_require__(15);\r\nmodule.exports = windows;\r\nfunction windows(){\r\n\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvbXBvbmVudC93aW5kb3dzLmpzPzYxMzIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJmaWxlIjoiMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzE2LlxyXG4gKi9cclxuLy/kvp3otZZib290c3RyYXBcclxucmVxdWlyZShcIi4vdGVzdC5jc3NcIik7XHJcbm1vZHVsZS5leHBvcnRzID0gd2luZG93cztcclxuZnVuY3Rpb24gd2luZG93cygpe1xyXG5cclxufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb21wb25lbnQvd2luZG93cy5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Node = {\r\n    Normal: __webpack_require__(13),\r\n    Text: __webpack_require__(14)\r\n};\r\nvar Link = {\r\n    Curve: __webpack_require__(9),\r\n    Direct: __webpack_require__(10),\r\n    Flexional: __webpack_require__(11),\r\n    Fold: __webpack_require__(12)\r\n};\r\nvar Container = {\r\n    Group: __webpack_require__(8)\r\n};\r\nmodule.exports = Scene;\r\n//画布对象\r\nvar defaults = function () {\r\n    return {\r\n        name: \'\',\r\n        id: \'\',\r\n        pid: \'\',\r\n        weight: 1,\r\n        path: [],\r\n        offsetX: 0,\r\n        offsetY: 0,\r\n        mode: "edit",\r\n        background:""\r\n    };\r\n};\r\nfunction Scene(stage, config) {\r\n    var self = this;\r\n    self.jtopo = new JTopo.Scene();\r\n    self.jtopo.qtopo=self;\r\n    self.children = {\r\n        node: [],\r\n        link: [],\r\n        container: []\r\n    };\r\n    self.attr = defaults();\r\n    stage.add(self.jtopo);\r\n    setTimeout(function(){\r\n        if(config.background){\r\n            self.setBackGround(config.background);\r\n        }\r\n        if(config.mode){\r\n            self.setMode(config.mode);\r\n        }\r\n    });\r\n}\r\n//scan 格式 aaa=bb,ccc=dd条件之间以,分隔\r\nScene.prototype.clear=function(){\r\n    console.info("scene clear");\r\n    this.jtopo.clear();\r\n};\r\nScene.prototype.on = function (name, fn) {\r\n    this.jtopo.addEventListener(name, function (e) {\r\n        if(e.target&&e.target.qtopo){\r\n            fn(e,e.target.qtopo);\r\n        }else{\r\n            fn(e);\r\n        }\r\n    });\r\n};\r\nScene.prototype.off= function (name, fn) {\r\n    this.jtopo.removeEventListener(name);\r\n};\r\nScene.prototype.find=function(scan, type) {\r\n    var children = this.children;\r\n    var result = [];\r\n    var condition = typeof scan == "string" ? scan.split(",") : [];\r\n    if (condition.length > 0) {\r\n        $.each(condition, function (i, term) {\r\n            term = term.split("=");\r\n            //制定了类型，缩小查找范围，未指定则全部遍历\r\n            if (type) {\r\n                switch (type) {\r\n                    case "node":\r\n                        scanArr(children.node, term[0], term[1]);\r\n                        break;\r\n                    case "link":\r\n                        scanArr(children.link, term[0], term[1]);\r\n                        break;\r\n                    case "container":\r\n                        scanArr(children.container, term[0], term[1]);\r\n                        break;\r\n                }\r\n            } else {\r\n                $.each(children,function(j,arr){\r\n                    scanArr(arr, term[0], term[1]);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n    function scanArr(arr, key, value) {\r\n        $.each(arr, function (i, v) {\r\n            if (equal(v, key, value) || equal(v.attr, key, value)) {\r\n                result.push(v);\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    function equal(object, key, value) {\r\n        return object[key] && object[key] == value;\r\n    }\r\n};\r\nScene.prototype.createNode=function(config) {\r\n    var newNode;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case "text":\r\n            newNode = new Node.Text(config);\r\n            break;\r\n        default:\r\n            newNode = new Node.Normal(config);\r\n    }\r\n    if (newNode.jtopo) {\r\n        this.add(newNode.jtopo);\r\n        this.children.node.push(newNode);\r\n        return newNode;\r\n    } else {\r\n        console.error("create Node error", config);\r\n        return false;\r\n    }\r\n};\r\nScene.prototype.createLink=function(config) {\r\n    var newLink;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case "direct":\r\n            newLink = new Link.Direct(config);\r\n            break;\r\n        case "curve":\r\n            newLink = new Link.Curve(config);\r\n            break;\r\n        case "flexional":\r\n            newLink = new Link.Flexional(config);\r\n            break;\r\n        case "fold":\r\n            newLink = new Link.Fold(config);\r\n            break;\r\n        default:\r\n            newLink = new Link.Direct(config);\r\n    }\r\n    if (newLink.jtopo) {\r\n        this.add(newLink.jtopo);\r\n        this.children.link.push(newLink);\r\n        return newLink;\r\n    } else {\r\n        console.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\nScene.prototype.createContainer=function(config) {\r\n    var newContainer;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newContainer = new Container.Group(config);\r\n    }\r\n    if (newContainer.jtopo) {\r\n        this.add(newContainer.jtopo);\r\n        this.children.container.push(newContainer);\r\n        return newContainer;\r\n    } else {\r\n        console.error("create Container error", config);\r\n        return false;\r\n    }\r\n};\r\nScene.prototype.add=function(element) {\r\n    if (element) {\r\n        this.jtopo.add(element);\r\n    }\r\n};\r\nScene.prototype.center=function(){\r\n    this.jtopo.stage.centerAndZoom();\r\n};\r\nScene.prototype.setMode=function(mode) {\r\n    this.attr.mode = mode;\r\n    this.jtopo.mode = mode;\r\n};\r\nScene.prototype.setBackGround=function(background) {\r\n    this.jtopo.background = background;\r\n    this.attr.background=background;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvU2NlbmUuanM/OWVjOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvNy5cclxuICovXHJcbnZhciBOb2RlID0ge1xyXG4gICAgTm9ybWFsOiByZXF1aXJlKFwiLi9lbGVtZW50L25vZGUvTm9ybWFsLmpzXCIpLFxyXG4gICAgVGV4dDogcmVxdWlyZShcIi4vZWxlbWVudC9ub2RlL1RleHQuanNcIilcclxufTtcclxudmFyIExpbmsgPSB7XHJcbiAgICBDdXJ2ZTogcmVxdWlyZShcIi4vZWxlbWVudC9saW5rL0N1cnZlLmpzXCIpLFxyXG4gICAgRGlyZWN0OiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvRGlyZWN0LmpzXCIpLFxyXG4gICAgRmxleGlvbmFsOiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvRmxleGlvbmFsLmpzXCIpLFxyXG4gICAgRm9sZDogcmVxdWlyZShcIi4vZWxlbWVudC9saW5rL0ZvbGQuanNcIilcclxufTtcclxudmFyIENvbnRhaW5lciA9IHtcclxuICAgIEdyb3VwOiByZXF1aXJlKFwiLi9lbGVtZW50L2NvbnRhaW5lci9Hcm91cC5qc1wiKVxyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IFNjZW5lO1xyXG4vL+eUu+W4g+WvueixoVxyXG52YXIgZGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6ICcnLFxyXG4gICAgICAgIGlkOiAnJyxcclxuICAgICAgICBwaWQ6ICcnLFxyXG4gICAgICAgIHdlaWdodDogMSxcclxuICAgICAgICBwYXRoOiBbXSxcclxuICAgICAgICBvZmZzZXRYOiAwLFxyXG4gICAgICAgIG9mZnNldFk6IDAsXHJcbiAgICAgICAgbW9kZTogXCJlZGl0XCIsXHJcbiAgICAgICAgYmFja2dyb3VuZDpcIlwiXHJcbiAgICB9O1xyXG59O1xyXG5mdW5jdGlvbiBTY2VuZShzdGFnZSwgY29uZmlnKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmp0b3BvID0gbmV3IEpUb3BvLlNjZW5lKCk7XHJcbiAgICBzZWxmLmp0b3BvLnF0b3BvPXNlbGY7XHJcbiAgICBzZWxmLmNoaWxkcmVuID0ge1xyXG4gICAgICAgIG5vZGU6IFtdLFxyXG4gICAgICAgIGxpbms6IFtdLFxyXG4gICAgICAgIGNvbnRhaW5lcjogW11cclxuICAgIH07XHJcbiAgICBzZWxmLmF0dHIgPSBkZWZhdWx0cygpO1xyXG4gICAgc3RhZ2UuYWRkKHNlbGYuanRvcG8pO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKGNvbmZpZy5iYWNrZ3JvdW5kKXtcclxuICAgICAgICAgICAgc2VsZi5zZXRCYWNrR3JvdW5kKGNvbmZpZy5iYWNrZ3JvdW5kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoY29uZmlnLm1vZGUpe1xyXG4gICAgICAgICAgICBzZWxmLnNldE1vZGUoY29uZmlnLm1vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8vc2NhbiDmoLzlvI8gYWFhPWJiLGNjYz1kZOadoeS7tuS5i+mXtOS7pSzliIbpmpRcclxuU2NlbmUucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7XHJcbiAgICBjb25zb2xlLmluZm8oXCJzY2VuZSBjbGVhclwiKTtcclxuICAgIHRoaXMuanRvcG8uY2xlYXIoKTtcclxufTtcclxuU2NlbmUucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKG5hbWUsIGZuKSB7XHJcbiAgICB0aGlzLmp0b3BvLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZihlLnRhcmdldCYmZS50YXJnZXQucXRvcG8pe1xyXG4gICAgICAgICAgICBmbihlLGUudGFyZ2V0LnF0b3BvKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgZm4oZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblNjZW5lLnByb3RvdHlwZS5vZmY9IGZ1bmN0aW9uIChuYW1lLCBmbikge1xyXG4gICAgdGhpcy5qdG9wby5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUpO1xyXG59O1xyXG5TY2VuZS5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihzY2FuLCB0eXBlKSB7XHJcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xyXG4gICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgdmFyIGNvbmRpdGlvbiA9IHR5cGVvZiBzY2FuID09IFwic3RyaW5nXCIgPyBzY2FuLnNwbGl0KFwiLFwiKSA6IFtdO1xyXG4gICAgaWYgKGNvbmRpdGlvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgJC5lYWNoKGNvbmRpdGlvbiwgZnVuY3Rpb24gKGksIHRlcm0pIHtcclxuICAgICAgICAgICAgdGVybSA9IHRlcm0uc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgICAgICAvL+WItuWumuS6huexu+Wei++8jOe8qeWwj+afpeaJvuiMg+WbtO+8jOacquaMh+WumuWImeWFqOmDqOmBjeWOhlxyXG4gICAgICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vZGVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5ub2RlLCB0ZXJtWzBdLCB0ZXJtWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxpbmtcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5saW5rLCB0ZXJtWzBdLCB0ZXJtWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNvbnRhaW5lclwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGNoaWxkcmVuLmNvbnRhaW5lciwgdGVybVswXSwgdGVybVsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGNoaWxkcmVuLGZ1bmN0aW9uKGosYXJyKXtcclxuICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGFyciwgdGVybVswXSwgdGVybVsxXSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIGZ1bmN0aW9uIHNjYW5BcnIoYXJyLCBrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgJC5lYWNoKGFyciwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgaWYgKGVxdWFsKHYsIGtleSwgdmFsdWUpIHx8IGVxdWFsKHYuYXR0ciwga2V5LCB2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlcXVhbChvYmplY3QsIGtleSwgdmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gb2JqZWN0W2tleV0gJiYgb2JqZWN0W2tleV0gPT0gdmFsdWU7XHJcbiAgICB9XHJcbn07XHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvbmZpZykge1xyXG4gICAgdmFyIG5ld05vZGU7XHJcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSBcInRleHRcIjpcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlLlRleHQoY29uZmlnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlLk5vcm1hbChjb25maWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG5ld05vZGUuanRvcG8pIHtcclxuICAgICAgICB0aGlzLmFkZChuZXdOb2RlLmp0b3BvKTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLm5vZGUucHVzaChuZXdOb2RlKTtcclxuICAgICAgICByZXR1cm4gbmV3Tm9kZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcImNyZWF0ZSBOb2RlIGVycm9yXCIsIGNvbmZpZyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG5TY2VuZS5wcm90b3R5cGUuY3JlYXRlTGluaz1mdW5jdGlvbihjb25maWcpIHtcclxuICAgIHZhciBuZXdMaW5rO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGNhc2UgXCJkaXJlY3RcIjpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkRpcmVjdChjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiY3VydmVcIjpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkN1cnZlKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJmbGV4aW9uYWxcIjpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkZsZXhpb25hbChjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiZm9sZFwiOlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuRm9sZChjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuRGlyZWN0KGNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAobmV3TGluay5qdG9wbykge1xyXG4gICAgICAgIHRoaXMuYWRkKG5ld0xpbmsuanRvcG8pO1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4ubGluay5wdXNoKG5ld0xpbmspO1xyXG4gICAgICAgIHJldHVybiBuZXdMaW5rO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiY3JlYXRlIExpbmsgZXJyb3JcIiwgY29uZmlnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVDb250YWluZXI9ZnVuY3Rpb24oY29uZmlnKSB7XHJcbiAgICB2YXIgbmV3Q29udGFpbmVyO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld0NvbnRhaW5lciA9IG5ldyBDb250YWluZXIuR3JvdXAoY29uZmlnKTtcclxuICAgIH1cclxuICAgIGlmIChuZXdDb250YWluZXIuanRvcG8pIHtcclxuICAgICAgICB0aGlzLmFkZChuZXdDb250YWluZXIuanRvcG8pO1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4uY29udGFpbmVyLnB1c2gobmV3Q29udGFpbmVyKTtcclxuICAgICAgICByZXR1cm4gbmV3Q29udGFpbmVyO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiY3JlYXRlIENvbnRhaW5lciBlcnJvclwiLCBjb25maWcpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuU2NlbmUucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uYWRkKGVsZW1lbnQpO1xyXG4gICAgfVxyXG59O1xyXG5TY2VuZS5wcm90b3R5cGUuY2VudGVyPWZ1bmN0aW9uKCl7XHJcbiAgICB0aGlzLmp0b3BvLnN0YWdlLmNlbnRlckFuZFpvb20oKTtcclxufTtcclxuU2NlbmUucHJvdG90eXBlLnNldE1vZGU9ZnVuY3Rpb24obW9kZSkge1xyXG4gICAgdGhpcy5hdHRyLm1vZGUgPSBtb2RlO1xyXG4gICAgdGhpcy5qdG9wby5tb2RlID0gbW9kZTtcclxufTtcclxuU2NlbmUucHJvdG90eXBlLnNldEJhY2tHcm91bmQ9ZnVuY3Rpb24oYmFja2dyb3VuZCkge1xyXG4gICAgdGhpcy5qdG9wby5iYWNrZ3JvdW5kID0gYmFja2dyb3VuZDtcclxuICAgIHRoaXMuYXR0ci5iYWNrZ3JvdW5kPWJhY2tncm91bmQ7XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvU2NlbmUuanNcbi8vIG1vZHVsZSBpZCA9IDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval('!function (window) {\r\n    function Element() {\r\n        this.initialize = function () {\r\n            this.elementType = "element", this.serializedProperties = ["elementType"], this.propertiesStack = [], this._id = "" + (new Date).getTime()\r\n        }, this.distroy = function () {\r\n        }, this.removeHandler = function () {\r\n        }, this.attr = function (a, b) {\r\n            if (null != a && null != b)this[a] = b; else if (null != a)return this[a];\r\n            return this\r\n        }, this.save = function () {\r\n            var a = this, b = {};\r\n            this.serializedProperties.forEach(function (c) {\r\n                b[c] = a[c]\r\n            }), this.propertiesStack.push(b)\r\n        }, this.restore = function () {\r\n            if (null != this.propertiesStack && 0 != this.propertiesStack.length) {\r\n                var a = this, b = this.propertiesStack.pop();\r\n                this.serializedProperties.forEach(function (c) {\r\n                    a[c] = b[c]\r\n                })\r\n            }\r\n        }, this.toJson = function () {\r\n            var a = this, b = "{", c = this.serializedProperties.length;\r\n            return this.serializedProperties.forEach(function (d, e) {\r\n                var f = a[d];\r\n                "string" == typeof f && (f = \'"\' + f + \'"\'), b += \'"\' + d + \'":\' + f, c > e + 1 && (b += ",")\r\n            }), b += "}"\r\n        }\r\n    }\r\n\r\n    CanvasRenderingContext2D.prototype.JTopoRoundRect = function (a, b, c, d, e) {\r\n        "undefined" == typeof e && (e = 5), this.beginPath(), this.moveTo(a + e, b), this.lineTo(a + c - e, b), this.quadraticCurveTo(a + c, b, a + c, b + e), this.lineTo(a + c, b + d - e), this.quadraticCurveTo(a + c, b + d, a + c - e, b + d), this.lineTo(a + e, b + d), this.quadraticCurveTo(a, b + d, a, b + d - e), this.lineTo(a, b + e), this.quadraticCurveTo(a, b, a + e, b), this.closePath()\r\n    }, CanvasRenderingContext2D.prototype.JTopoDashedLineTo = function (a, b, c, d, e) {\r\n        "undefined" == typeof e && (e = 5);\r\n        var f = c - a, g = d - b, h = Math.floor(Math.sqrt(f * f + g * g)), i = 0 >= e ? h : h / e, j = g / h * e, k = f / h * e;\r\n        this.beginPath();\r\n        for (var l = 0; i > l; l++)l % 2 ? this.lineTo(a + l * k, b + l * j) : this.moveTo(a + l * k, b + l * j);\r\n        this.stroke()\r\n    }, JTopo = {\r\n        version: "0.4.8_01",\r\n        zIndex_Container: 1,\r\n        zIndex_Link: 2,\r\n        zIndex_Node: 3,\r\n        SceneMode: {normal: "normal", drag: "drag", edit: "edit", select: "select"},\r\n        MouseCursor: {\r\n            normal: "default",\r\n            pointer: "pointer",\r\n            top_left: "nw-resize",\r\n            top_center: "n-resize",\r\n            top_right: "ne-resize",\r\n            middle_left: "e-resize",\r\n            middle_right: "e-resize",\r\n            bottom_left: "ne-resize",\r\n            bottom_center: "n-resize",\r\n            bottom_right: "nw-resize",\r\n            move: "move",\r\n            open_hand: "url(./img/cur/openhand.cur) 8 8, default",\r\n            closed_hand: "url(./img/cur/closedhand.cur) 8 8, default"\r\n        },\r\n        createStageFromJson: function (jsonStr, canvas) {\r\n            eval("var jsonObj = " + jsonStr);\r\n            var stage = new JTopo.Stage(canvas);\r\n            for (var k in jsonObj)"childs" != k && (stage[k] = jsonObj[k]);\r\n            var scenes = jsonObj.childs;\r\n            return scenes.forEach(function (a) {\r\n                var b = new JTopo.Scene(stage);\r\n                for (var c in a)"childs" != c && (b[c] = a[c]), "background" == c && (b.background = a[c]);\r\n                var d = a.childs;\r\n                d.forEach(function (a) {\r\n                    var c = null, d = a.elementType;\r\n                    "node" == d ? c = new JTopo.Node : "CircleNode" == d && (c = new JTopo.CircleNode);\r\n                    for (var e in a)c[e] = a[e];\r\n                    b.add(c)\r\n                })\r\n            }), stage\r\n        }\r\n    }, JTopo.Element = Element, window.JTopo = JTopo\r\n}(window), function (JTopo) {\r\n    function MessageBus(a) {\r\n        var b = this;\r\n        this.name = a, this.messageMap = {}, this.messageCount = 0, this.subscribe = function (a, c) {\r\n            var d = b.messageMap[a];\r\n            null == d && (b.messageMap[a] = []), b.messageMap[a].push(c), b.messageCount++\r\n        }, this.unsubscribe = function (a) {\r\n            var c = b.messageMap[a];\r\n            null != c && (b.messageMap[a] = null, delete b.messageMap[a], b.messageCount--)\r\n        }, this.publish = function (a, c, d) {\r\n            var e = b.messageMap[a];\r\n            if (null != e)for (var f = 0; f < e.length; f++)d ? !function (a, b) {\r\n                setTimeout(function () {\r\n                    a(b)\r\n                }, 10)\r\n            }(e[f], c) : e[f](c)\r\n        }\r\n    }\r\n\r\n    function getDistance(a, b, c, d) {\r\n        var e, f;\r\n        return null == c && null == d ? (e = b.x - a.x, f = b.y - a.y) : (e = c - a, f = d - b), Math.sqrt(e * e + f * f)\r\n    }\r\n\r\n    function getElementsBound(a) {\r\n        for (var b = {left: Number.MAX_VALUE, right: Number.MIN_VALUE, top: Number.MAX_VALUE, bottom: Number.MIN_VALUE}, c = 0; c < a.length; c++) {\r\n            var d = a[c];\r\n            d instanceof JTopo.Link || (b.left > d.x && (b.left = d.x, b.leftNode = d), b.right < d.x + d.width && (b.right = d.x + d.width, b.rightNode = d), b.top > d.y && (b.top = d.y, b.topNode = d), b.bottom < d.y + d.height && (b.bottom = d.y + d.height, b.bottomNode = d))\r\n        }\r\n        return b.width = b.right - b.left, b.height = b.bottom - b.top, b\r\n    }\r\n\r\n    function mouseCoords(a) {\r\n        return a = cloneEvent(a), a.pageX || (a.pageX = a.clientX + document.body.scrollLeft - document.body.clientLeft, a.pageY = a.clientY + document.body.scrollTop - document.body.clientTop), a\r\n    }\r\n\r\n    function getEventPosition(a) {\r\n        return a = mouseCoords(a)\r\n    }\r\n\r\n    function rotatePoint(a, b, c, d, e) {\r\n        var f = c - a, g = d - b, h = Math.sqrt(f * f + g * g), i = Math.atan2(g, f) + e;\r\n        return {x: a + Math.cos(i) * h, y: b + Math.sin(i) * h}\r\n    }\r\n\r\n    function rotatePoints(a, b, c) {\r\n        for (var d = [], e = 0; e < b.length; e++) {\r\n            var f = rotatePoint(a.x, a.y, b[e].x, b[e].y, c);\r\n            d.push(f)\r\n        }\r\n        return d\r\n    }\r\n\r\n    function $foreach(a, b, c) {\r\n        function d(e) {\r\n            e != a.length && (b(a[e]), setTimeout(function () {\r\n                d(++e)\r\n            }, c))\r\n        }\r\n\r\n        if (0 != a.length) {\r\n            var e = 0;\r\n            d(e)\r\n        }\r\n    }\r\n\r\n    function $for(a, b, c, d) {\r\n        function e(a) {\r\n            a != b && (c(b), setTimeout(function () {\r\n                e(++a)\r\n            }, d))\r\n        }\r\n\r\n        if (!(a > b)) {\r\n            var f = 0;\r\n            e(f)\r\n        }\r\n    }\r\n\r\n    function cloneEvent(a) {\r\n        var b = {};\r\n        for (var c in a)"returnValue" != c && "keyLocation" != c && (b[c] = a[c]);\r\n        return b\r\n    }\r\n\r\n    function clone(a) {\r\n        var b = {};\r\n        for (var c in a)b[c] = a[c];\r\n        return b\r\n    }\r\n\r\n    function isPointInRect(a, b) {\r\n        var c = b.x, d = b.y, e = b.width, f = b.height;\r\n        return a.x > c && a.x < c + e && a.y > d && a.y < d + f\r\n    }\r\n\r\n    function isPointInLine(a, b, c) {\r\n        var d = JTopo.util.getDistance(b, c), e = JTopo.util.getDistance(b, a), f = JTopo.util.getDistance(c, a), g = Math.abs(e + f - d) <= .5;\r\n        return g\r\n    }\r\n\r\n    function removeFromArray(a, b) {\r\n        for (var c = 0; c < a.length; c++) {\r\n            var d = a[c];\r\n            if (d === b) {\r\n                a = a.del(c);\r\n                break\r\n            }\r\n        }\r\n        return a\r\n    }\r\n\r\n    function randomColor() {\r\n        return Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random())\r\n    }\r\n\r\n    function isIntsect() {\r\n    }\r\n\r\n    function getProperties(a, b) {\r\n        for (var c = "", d = 0; d < b.length; d++) {\r\n            d > 0 && (c += ",");\r\n            var e = a[b[d]];\r\n            "string" == typeof e ? e = \'"\' + e + \'"\' : void 0 == e && (e = null), c += b[d] + ":" + e\r\n        }\r\n        return c\r\n    }\r\n\r\n    function loadStageFromJson(json, canvas) {\r\n        var obj = eval(json), stage = new JTopo.Stage(canvas);\r\n        for (var k in stageObj)if ("scenes" != k)stage[k] = obj[k]; else for (var scenes = obj.scenes, i = 0; i < scenes.length; i++) {\r\n            var sceneObj = scenes[i], scene = new JTopo.Scene(stage);\r\n            for (var p in sceneObj)if ("elements" != p)scene[p] = sceneObj[p]; else for (var nodeMap = {}, elements = sceneObj.elements, m = 0; m < elements.length; m++) {\r\n                var elementObj = elements[m], type = elementObj.elementType, element;\r\n                "Node" == type && (element = new JTopo.Node);\r\n                for (var mk in elementObj)element[mk] = elementObj[mk];\r\n                nodeMap[element.text] = element, scene.add(element)\r\n            }\r\n        }\r\n        return console.log(stage), stage\r\n    }\r\n\r\n    function toJson(a) {\r\n        var b = "backgroundColor,visible,mode,rotate,alpha,scaleX,scaleY,shadow,translateX,translateY,areaSelect,paintAll".split(","), c = "text,elementType,x,y,width,height,visible,alpha,rotate,scaleX,scaleY,fillColor,shadow,transformAble,zIndex,dragable,selected,showSelected,font,fontColor,textPosition,textOffsetX,textOffsetY".split(","), d = "{";\r\n        d += "frames:" + a.frames, d += ", scenes:[";\r\n        for (var e = 0; e < a.childs.length; e++) {\r\n            var f = a.childs[e];\r\n            d += "{", d += getProperties(f, b), d += ", elements:[";\r\n            for (var g = 0; g < f.childs.length; g++) {\r\n                var h = f.childs[g];\r\n                g > 0 && (d += ","), d += "{", d += getProperties(h, c), d += "}"\r\n            }\r\n            d += "]}"\r\n        }\r\n        return d += "]", d += "}"\r\n    }\r\n\r\n    function changeColor(a, b, c) {\r\n        var d = c.split(","), e = parseInt(d[0]), f = parseInt(d[1]), g = parseInt(d[2]), h = canvas.width = b.width, i = canvas.height = b.height;\r\n        a.clearRect(0, 0, canvas.width, canvas.height), a.drawImage(b, 0, 0);\r\n        for (var j = a.getImageData(0, 0, b.width, b.height), k = j.data, l = 0; h > l; l++)for (var m = 0; i > m; m++) {\r\n            var n = 4 * (l + m * h);\r\n            0 != k[n + 3] && (null != e && (k[n + 0] += e), null != f && (k[n + 1] += f), null != g && (k[n + 2] += g))\r\n        }\r\n        a.putImageData(j, 0, 0, 0, 0, b.width, b.height);\r\n        var o = canvas.toDataURL();\r\n        return o\r\n    }\r\n\r\n    function genImageAlarm(a, b) {\r\n        var c = a.src + b;\r\n        if (alarmImageCache[c])return alarmImageCache[c];\r\n        var d = new Image;\r\n        return d.src = changeColor(graphics, a, b), alarmImageCache[c] = d, d\r\n    }\r\n\r\n    function getOffsetPosition(a) {\r\n        if (!a)return {left: 0, top: 0};\r\n        var b = 0, c = 0;\r\n        if ("getBoundingClientRect" in document.documentElement)var d = a.getBoundingClientRect(), e = a.ownerDocument, f = e.body, g = e.documentElement, h = g.clientTop || f.clientTop || 0, i = g.clientLeft || f.clientLeft || 0, b = d.top + (self.pageYOffset || g && g.scrollTop || f.scrollTop) - h, c = d.left + (self.pageXOffset || g && g.scrollLeft || f.scrollLeft) - i; else do b += a.offsetTop || 0, c += a.offsetLeft || 0, a = a.offsetParent; while (a);\r\n        return {left: c, top: b}\r\n    }\r\n\r\n    function lineF(a, b, c, d) {\r\n        function e(a) {\r\n            return a * f + g\r\n        }\r\n\r\n        var f = (d - b) / (c - a), g = b - a * f;\r\n        return e.k = f, e.b = g, e.x1 = a, e.x2 = c, e.y1 = b, e.y2 = d, e\r\n    }\r\n\r\n    function inRange(a, b, c) {\r\n        var d = Math.abs(b - c), e = Math.abs(b - a), f = Math.abs(c - a), g = Math.abs(d - (e + f));\r\n        return 1e-6 > g ? !0 : !1\r\n    }\r\n\r\n    function isPointInLineSeg(a, b, c) {\r\n        return inRange(a, c.x1, c.x2) && inRange(b, c.y1, c.y2)\r\n    }\r\n\r\n    function intersection(a, b) {\r\n        var c, d;\r\n        return a.k == b.k ? null : (1 / 0 == a.k || a.k == -1 / 0 ? (c = a.x1, d = b(a.x1)) : 1 / 0 == b.k || b.k == -1 / 0 ? (c = b.x1, d = a(b.x1)) : (c = (b.b - a.b) / (a.k - b.k), d = a(c)), 0 == isPointInLineSeg(c, d, a) ? null : 0 == isPointInLineSeg(c, d, b) ? null : {\r\n            x: c,\r\n            y: d\r\n        })\r\n    }\r\n\r\n    function intersectionLineBound(a, b) {\r\n        var c = JTopo.util.lineF(b.left, b.top, b.left, b.bottom), d = JTopo.util.intersection(a, c);\r\n        return null == d && (c = JTopo.util.lineF(b.left, b.top, b.right, b.top), d = JTopo.util.intersection(a, c), null == d && (c = JTopo.util.lineF(b.right, b.top, b.right, b.bottom), d = JTopo.util.intersection(a, c), null == d && (c = JTopo.util.lineF(b.left, b.bottom, b.right, b.bottom), d = JTopo.util.intersection(a, c)))), d\r\n    }\r\n\r\n    requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function (a) {\r\n            setTimeout(a, 1e3 / 24)\r\n        }, Array.prototype.del = function (a) {\r\n        if ("number" != typeof a) {\r\n            for (var b = 0; b < this.length; b++)if (this[b] === a)return this.slice(0, b).concat(this.slice(b + 1, this.length));\r\n            return this\r\n        }\r\n        return 0 > a ? this : this.slice(0, a).concat(this.slice(a + 1, this.length))\r\n    }, [].indexOf || (Array.prototype.indexOf = function (a) {\r\n        for (var b = 0; b < this.length; b++)if (this[b] === a)return b;\r\n        return -1\r\n    }), window.console || (window.console = {\r\n        log: function () {\r\n        }, info: function () {\r\n        }, debug: function () {\r\n        }, warn: function () {\r\n        }, error: function () {\r\n        }\r\n    });\r\n    var canvas = document.createElement("canvas"), graphics = canvas.getContext("2d"), alarmImageCache = {};\r\n    JTopo.util = {\r\n        rotatePoint: rotatePoint,\r\n        rotatePoints: rotatePoints,\r\n        getDistance: getDistance,\r\n        getEventPosition: getEventPosition,\r\n        mouseCoords: mouseCoords,\r\n        MessageBus: MessageBus,\r\n        isFirefox: navigator.userAgent.indexOf("Firefox") > 0,\r\n        isIE: !(!window.attachEvent || -1 !== navigator.userAgent.indexOf("Opera")),\r\n        isChrome: null != navigator.userAgent.toLowerCase().match(/chrome/),\r\n        clone: clone,\r\n        isPointInRect: isPointInRect,\r\n        isPointInLine: isPointInLine,\r\n        removeFromArray: removeFromArray,\r\n        cloneEvent: cloneEvent,\r\n        randomColor: randomColor,\r\n        isIntsect: isIntsect,\r\n        toJson: toJson,\r\n        loadStageFromJson: loadStageFromJson,\r\n        getElementsBound: getElementsBound,\r\n        genImageAlarm: genImageAlarm,\r\n        getOffsetPosition: getOffsetPosition,\r\n        lineF: lineF,\r\n        intersection: intersection,\r\n        intersectionLineBound: intersectionLineBound\r\n    }, window.$for = $for, window.$foreach = $foreach\r\n}(JTopo), function (a) {\r\n    function b(a) {\r\n        return {\r\n            hgap: 16, visible: !1, exportCanvas: document.createElement("canvas"), getImage: function (b, c) {\r\n                var d = a.getBound(), e = 1, f = 1;\r\n                this.exportCanvas.width = a.canvas.width, this.exportCanvas.height = a.canvas.height, null != b && null != c ? (this.exportCanvas.width = b, this.exportCanvas.height = c, e = b / d.width, f = c / d.height) : (d.width > a.canvas.width && (this.exportCanvas.width = d.width), d.height > a.canvas.height && (this.exportCanvas.height = d.height));\r\n                var g = this.exportCanvas.getContext("2d");\r\n                return a.childs.length > 0 && (g.save(), g.clearRect(0, 0, this.exportCanvas.width, this.exportCanvas.height), a.childs.forEach(function (a) {\r\n                    1 == a.visible && (a.save(), a.translateX = 0, a.translateY = 0, a.scaleX = 1, a.scaleY = 1, g.scale(e, f), d.left < 0 && (a.translateX = Math.abs(d.left)), d.top < 0 && (a.translateY = Math.abs(d.top)), a.paintAll = !0, a.repaint(g), a.paintAll = !1, a.restore())\r\n                }), g.restore()), this.exportCanvas.toDataURL("image/png")\r\n            }, canvas: document.createElement("canvas"), update: function () {\r\n                this.eagleImageDatas = this.getData(a)\r\n            }, setSize: function (a, b) {\r\n                this.width = this.canvas.width = a, this.height = this.canvas.height = b\r\n            }, getData: function (b, c) {\r\n                function d(a) {\r\n                    var b = a.stage.canvas.width, c = a.stage.canvas.height, d = b / a.scaleX / 2, e = c / a.scaleY / 2;\r\n                    return {translateX: a.translateX + d - d * a.scaleX, translateY: a.translateY + e - e * a.scaleY}\r\n                }\r\n\r\n                null != j && null != k ? this.setSize(b, c) : this.setSize(200, 160);\r\n                var e = this.canvas.getContext("2d");\r\n                if (a.childs.length > 0) {\r\n                    e.save(), e.clearRect(0, 0, this.canvas.width, this.canvas.height), a.childs.forEach(function (a) {\r\n                        1 == a.visible && (a.save(), a.centerAndZoom(null, null, e), a.repaint(e), a.restore())\r\n                    });\r\n                    var f = d(a.childs[0]), g = f.translateX * (this.canvas.width / a.canvas.width) * a.childs[0].scaleX, h = f.translateY * (this.canvas.height / a.canvas.height) * a.childs[0].scaleY, i = a.getBound(), j = a.canvas.width / a.childs[0].scaleX / i.width, k = a.canvas.height / a.childs[0].scaleY / i.height;\r\n                    j > 1 && (j = 1), k > 1 && (j = 1), g *= j, h *= k, i.left < 0 && (g -= Math.abs(i.left) * (this.width / i.width)), i.top < 0 && (h -= Math.abs(i.top) * (this.height / i.height)), e.save(), e.lineWidth = 1, e.strokeStyle = "rgba(255,0,0,1)", e.strokeRect(-g, -h, e.canvas.width * j, e.canvas.height * k), e.restore();\r\n                    var l = null;\r\n                    try {\r\n                        l = e.getImageData(0, 0, e.canvas.width, e.canvas.height)\r\n                    } catch (m) {\r\n                    }\r\n                    return l\r\n                }\r\n                return null\r\n            }, paint: function () {\r\n                if (null != this.eagleImageDatas) {\r\n                    var b = a.graphics;\r\n                    b.save(), b.fillStyle = "rgba(211,211,211,0.3)", b.fillRect(a.canvas.width - this.canvas.width - 2 * this.hgap, a.canvas.height - this.canvas.height - 1, a.canvas.width - this.canvas.width, this.canvas.height + 1), b.fill(), b.save(), b.lineWidth = 1, b.strokeStyle = "rgba(0,0,0,1)", b.rect(a.canvas.width - this.canvas.width - 2 * this.hgap, a.canvas.height - this.canvas.height - 1, a.canvas.width - this.canvas.width, this.canvas.height + 1), b.stroke(), b.restore(), b.putImageData(this.eagleImageDatas, a.canvas.width - this.canvas.width - this.hgap, a.canvas.height - this.canvas.height), b.restore()\r\n                } else this.eagleImageDatas = this.getData(a)\r\n            }, eventHandler: function (a, b, c) {\r\n                var d = b.x, e = b.y;\r\n                if (d > c.canvas.width - this.canvas.width && e > c.canvas.height - this.canvas.height) {\r\n                    if (d = b.x - this.canvas.width, e = b.y - this.canvas.height, "mousedown" == a && (this.lastTranslateX = c.childs[0].translateX, this.lastTranslateY = c.childs[0].translateY), "mousedrag" == a && c.childs.length > 0) {\r\n                        var f = b.dx, g = b.dy, h = c.getBound(), i = this.canvas.width / c.childs[0].scaleX / h.width, j = this.canvas.height / c.childs[0].scaleY / h.height;\r\n                        c.childs[0].translateX = this.lastTranslateX - f / i, c.childs[0].translateY = this.lastTranslateY - g / j\r\n                    }\r\n                } else;\r\n            }\r\n        }\r\n    }\r\n\r\n    function c(c) {\r\n        function d(b) {\r\n            var c = a.util.getEventPosition(b), d = a.util.getOffsetPosition(n.canvas);\r\n            return c.offsetLeft = c.pageX - d.left, c.offsetTop = c.pageY - d.top, c.x = c.offsetLeft, c.y = c.offsetTop, c.target = null, c\r\n        }\r\n\r\n        function e(a) {\r\n            document.onselectstart = function () {\r\n                return !1\r\n            }, this.mouseOver = !0;\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mouseover", b), n.dispatchEvent("mouseover", b)\r\n        }\r\n\r\n        function f(a) {\r\n            p = setTimeout(function () {\r\n                o = !0\r\n            }, 500), document.onselectstart = function () {\r\n                return !0\r\n            };\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mouseout", b), n.dispatchEvent("mouseout", b), n.needRepaint = 0 == n.animate ? !1 : !0\r\n        }\r\n\r\n        function g(a) {\r\n            var b = d(a);\r\n            n.mouseDown = !0, n.mouseDownX = b.x, n.mouseDownY = b.y, n.dispatchEventToScenes("mousedown", b), n.dispatchEvent("mousedown", b)\r\n        }\r\n\r\n        function h(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mouseup", b), n.dispatchEvent("mouseup", b), n.mouseDown = !1, n.needRepaint = 0 == n.animate ? !1 : !0\r\n        }\r\n\r\n        function i(a) {\r\n            p && (window.clearTimeout(p), p = null), o = !1;\r\n            var b = d(a);\r\n            n.mouseDown ? 0 == a.button && (b.dx = b.x - n.mouseDownX, b.dy = b.y - n.mouseDownY, n.dispatchEventToScenes("mousedrag", b), n.dispatchEvent("mousedrag", b), 1 == n.eagleEye.visible && n.eagleEye.update()) : (n.dispatchEventToScenes("mousemove", b), n.dispatchEvent("mousemove", b))\r\n        }\r\n\r\n        function j(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("click", b), n.dispatchEvent("click", b)\r\n        }\r\n\r\n        function k(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("dbclick", b), n.dispatchEvent("dbclick", b)\r\n        }\r\n\r\n        function l(a) {\r\n            var b = d(a);\r\n            n.dispatchEventToScenes("mousewheel", b), n.dispatchEvent("mousewheel", b), null != n.wheelZoom && (a.preventDefault ? a.preventDefault() : (a = a || window.event, a.returnValue = !1), 1 == n.eagleEye.visible && n.eagleEye.update())\r\n        }\r\n\r\n        function m(b) {\r\n            a.util.isIE || !window.addEventListener ? (b.onmouseout = f, b.onmouseover = e, b.onmousedown = g, b.onmouseup = h, b.onmousemove = i, b.onclick = j, b.ondblclick = k, b.onmousewheel = l, b.touchstart = g, b.touchmove = i, b.touchend = h) : (b.addEventListener("mouseout", f), b.addEventListener("mouseover", e), b.addEventListener("mousedown", g), b.addEventListener("mouseup", h), b.addEventListener("mousemove", i), b.addEventListener("click", j), b.addEventListener("dblclick", k), a.util.isFirefox ? b.addEventListener("DOMMouseScroll", l) : b.addEventListener("mousewheel", l)), window.addEventListener && (window.addEventListener("keydown", function (b) {\r\n                n.dispatchEventToScenes("keydown", a.util.cloneEvent(b));\r\n                var c = b.keyCode;\r\n                (37 == c || 38 == c || 39 == c || 40 == c) && (b.preventDefault ? b.preventDefault() : (b = b || window.event, b.returnValue = !1))\r\n            }, !0), window.addEventListener("keyup", function (b) {\r\n                n.dispatchEventToScenes("keyup", a.util.cloneEvent(b));\r\n                var c = b.keyCode;\r\n                (37 == c || 38 == c || 39 == c || 40 == c) && (b.preventDefault ? b.preventDefault() : (b = b || window.event, b.returnValue = !1))\r\n            }, !0))\r\n        }\r\n\r\n        a.stage = this;\r\n        var n = this;\r\n        this.initialize = function (c) {\r\n            m(c), this.canvas = c, this.graphics = c.getContext("2d"), this.childs = [], this.frames = 24, this.messageBus = new a.util.MessageBus, this.eagleEye = b(this), this.wheelZoom = null, this.mouseDownX = 0, this.mouseDownY = 0, this.mouseDown = !1, this.mouseOver = !1, this.needRepaint = !0, this.serializedProperties = ["frames", "wheelZoom"]\r\n        }, null != c && this.initialize(c);\r\n        var o = !0, p = null;\r\n        document.oncontextmenu = function () {\r\n            return o\r\n        }, this.dispatchEventToScenes = function (a, b) {\r\n            if (0 != this.frames && (this.needRepaint = !0), 1 == this.eagleEye.visible && -1 != a.indexOf("mouse")) {\r\n                var c = b.x, d = b.y;\r\n                if (c > this.width - this.eagleEye.width && d > this.height - this.eagleEye.height)return void this.eagleEye.eventHandler(a, b, this)\r\n            }\r\n            this.childs.forEach(function (c) {\r\n                if (1 == c.visible) {\r\n                    var d = c[a + "Handler"];\r\n                    if (null == d)throw new Error("Function not found:" + a + "Handler");\r\n                    d.call(c, b)\r\n                }\r\n            })\r\n        }, this.add = function (a) {\r\n            for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a)return;\r\n            a.addTo(this), this.childs.push(a)\r\n        }, this.remove = function (a) {\r\n            if (null == a)throw new Error("Stage.remove出错: 参数为null!");\r\n            for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a)return a.stage = null, this.childs = this.childs.del(b), this;\r\n            return this\r\n        }, this.clear = function () {\r\n            this.childs = []\r\n        }, this.addEventListener = function (a, b) {\r\n            var c = this, d = function (a) {\r\n                b.call(c, a)\r\n            };\r\n            return this.messageBus.subscribe(a, d), this\r\n        }, this.removeEventListener = function (a) {\r\n            this.messageBus.unsubscribe(a)\r\n        }, this.removeAllEventListener = function () {\r\n            this.messageBus = new a.util.MessageBus\r\n        }, this.dispatchEvent = function (a, b) {\r\n            return this.messageBus.publish(a, b), this\r\n        };\r\n        var q = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), r = this;\r\n        q.forEach(function (a) {\r\n            r[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        }), this.saveImageInfo = function (a, b) {\r\n            var c = this.eagleEye.getImage(a, b), d = window.open("about:blank");\r\n            return d.document.write("<img src=\'" + c + "\' alt=\'from canvas\'/>"), this\r\n        }, this.saveAsLocalImage = function (a, b) {\r\n            var c = this.eagleEye.getImage(a, b);\r\n            return c.replace("image/png", "image/octet-stream"), window.location.href = c, this\r\n        }, this.paint = function () {\r\n            null != this.canvas && (this.graphics.save(), this.graphics.clearRect(0, 0, this.width, this.height), this.childs.forEach(function (a) {\r\n                1 == a.visible && a.repaint(n.graphics)\r\n            }), 1 == this.eagleEye.visible && this.eagleEye.paint(this), this.graphics.restore())\r\n        }, this.repaint = function () {\r\n            0 != this.frames && (this.frames < 0 && 0 == this.needRepaint || (this.paint(), this.frames < 0 && (this.needRepaint = !1)))\r\n        }, this.zoom = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoom(a)\r\n            })\r\n        }, this.zoomOut = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoomOut(a)\r\n            })\r\n        }, this.zoomIn = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoomIn(a)\r\n            })\r\n        }, this.centerAndZoom = function () {\r\n            this.childs.forEach(function (a) {\r\n                0 != a.visible && a.centerAndZoom()\r\n            })\r\n        }, this.setCenter = function (a, b) {\r\n            var c = this;\r\n            this.childs.forEach(function (d) {\r\n                var e = a - c.canvas.width / 2, f = b - c.canvas.height / 2;\r\n                d.translateX = -e, d.translateY = -f\r\n            })\r\n        }, this.getBound = function () {\r\n            var a = {left: Number.MAX_VALUE, right: Number.MIN_VALUE, top: Number.MAX_VALUE, bottom: Number.MIN_VALUE};\r\n            return this.childs.forEach(function (b) {\r\n                var c = b.getElementsBound();\r\n                c.left < a.left && (a.left = c.left, a.leftNode = c.leftNode), c.top < a.top && (a.top = c.top, a.topNode = c.topNode), c.right > a.right && (a.right = c.right, a.rightNode = c.rightNode), c.bottom > a.bottom && (a.bottom = c.bottom, a.bottomNode = c.bottomNode)\r\n            }), a.width = a.right - a.left, a.height = a.bottom - a.top, a\r\n        }, this.toJson = function () {\r\n            {\r\n                var b = this, c = \'{"version":"\' + a.version + \'",\';\r\n                this.serializedProperties.length\r\n            }\r\n            return this.serializedProperties.forEach(function (a) {\r\n                var d = b[a];\r\n                "string" == typeof d && (d = \'"\' + d + \'"\'), c += \'"\' + a + \'":\' + d + ","\r\n            }), c += \'"childs":[\', this.childs.forEach(function (a) {\r\n                c += a.toJson()\r\n            }), c += "]", c += "}"\r\n        }, function () {\r\n            0 == n.frames ? setTimeout(arguments.callee, 100) : n.frames < 0 ? (n.repaint(), setTimeout(arguments.callee, 1e3 / -n.frames)) : (n.repaint(), setTimeout(arguments.callee, 1e3 / n.frames))\r\n        }(), setTimeout(function () {\r\n            n.mousewheel(function (a) {\r\n                var b = null == a.wheelDelta ? a.detail : a.wheelDelta;\r\n                null != this.wheelZoom && (b > 0 ? this.zoomIn(this.wheelZoom) : this.zoomOut(this.wheelZoom))\r\n            }), n.paint()\r\n        }, 300), setTimeout(function () {\r\n            n.paint()\r\n        }, 1e3), setTimeout(function () {\r\n            n.paint()\r\n        }, 3e3)\r\n    }\r\n\r\n    c.prototype = {\r\n        get width() {\r\n            return this.canvas.width\r\n        }, get height() {\r\n            return this.canvas.height\r\n        }, set cursor(a) {\r\n            this.canvas.style.cursor = a\r\n        }, get cursor() {\r\n            return this.canvas.style.cursor\r\n        }, set mode(a) {\r\n            this.childs.forEach(function (b) {\r\n                b.mode = a\r\n            })\r\n        }\r\n    }, a.Stage = c\r\n}(JTopo), function (a) {\r\n    function b(c) {\r\n        function d(a, b, c, d) {\r\n            return function (e) {\r\n                e.beginPath(), e.strokeStyle = "rgba(0,0,236,0.5)", e.fillStyle = "rgba(0,0,236,0.1)", e.rect(a, b, c, d), e.fill(), e.stroke(), e.closePath()\r\n            }\r\n        }\r\n\r\n        var e = this;\r\n        this.initialize = function () {\r\n            b.prototype.initialize.apply(this, arguments), this.messageBus = new a.util.MessageBus, this.elementType = "scene", this.childs = [], this.zIndexMap = {}, this.zIndexArray = [], this.backgroundColor = "255,255,255", this.visible = !0, this.alpha = 0, this.scaleX = 1, this.scaleY = 1, this.mode = a.SceneMode.normal, this.translate = !0, this.translateX = 0, this.translateY = 0, this.lastTranslateX = 0, this.lastTranslateY = 0, this.mouseDown = !1, this.mouseDownX = null, this.mouseDownY = null, this.mouseDownEvent = null, this.areaSelect = !0, this.operations = [], this.selectedElements = [], this.paintAll = !1;\r\n            var c = "background,backgroundColor,mode,paintAll,areaSelect,translate,translateX,translateY,lastTranslatedX,lastTranslatedY,alpha,visible,scaleX,scaleY".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(c)\r\n        }, this.initialize(), this.setBackground = function (a) {\r\n            this.background = a\r\n        }, this.addTo = function (a) {\r\n            this.stage !== a && null != a && (this.stage = a)\r\n        }, null != c && (c.add(this), this.addTo(c)), this.show = function () {\r\n            this.visible = !0\r\n        }, this.hide = function () {\r\n            this.visible = !1\r\n        }, this.paint = function (a) {\r\n            if (0 != this.visible && null != this.stage) {\r\n                if (a.save(), this.paintBackgroud(a), a.restore(), a.save(), a.scale(this.scaleX, this.scaleY), 1 == this.translate) {\r\n                    var b = this.getOffsetTranslate(a);\r\n                    a.translate(b.translateX, b.translateY)\r\n                }\r\n                this.paintChilds(a), a.restore(), a.save(), this.paintOperations(a, this.operations), a.restore()\r\n            }\r\n        }, this.repaint = function (a) {\r\n            0 != this.visible && this.paint(a)\r\n        }, this.paintBackgroud = function (a) {\r\n            null != this.background ? a.drawImage(this.background, 0, 0, a.canvas.width, a.canvas.height) : (a.beginPath(), a.fillStyle = "rgba(" + this.backgroundColor + "," + this.alpha + ")", a.fillRect(0, 0, a.canvas.width, a.canvas.height), a.closePath())\r\n        }, this.getDisplayedElements = function () {\r\n            for (var a = [], b = 0; b < this.zIndexArray.length; b++)for (var c = this.zIndexArray[b], d = this.zIndexMap[c], e = 0; e < d.length; e++) {\r\n                var f = d[e];\r\n                this.isVisiable(f) && a.push(f)\r\n            }\r\n            return a\r\n        }, this.getDisplayedNodes = function () {\r\n            for (var b = [], c = 0; c < this.childs.length; c++) {\r\n                var d = this.childs[c];\r\n                d instanceof a.Node && this.isVisiable(d) && b.push(d)\r\n            }\r\n            return b\r\n        }, this.paintChilds = function (b) {\r\n            for (var c = 0; c < this.zIndexArray.length; c++)for (var d = this.zIndexArray[c], e = this.zIndexMap[d], f = 0; f < e.length; f++) {\r\n                var g = e[f];\r\n                if (1 == this.paintAll || this.isVisiable(g)) {\r\n                    if (b.save(), 1 == g.transformAble) {\r\n                        var h = g.getCenterLocation();\r\n                        b.translate(h.x, h.y), g.rotate && b.rotate(g.rotate), g.scaleX && g.scaleY ? b.scale(g.scaleX, g.scaleY) : g.scaleX ? b.scale(g.scaleX, 1) : g.scaleY && b.scale(1, g.scaleY)\r\n                    }\r\n                    //源码修改\r\n                    if(g.alarmFlash){\r\n                        g.alarmFlash();\r\n                    }\r\n                    1 == g.shadow && (b.shadowBlur = g.shadowBlur, b.shadowColor = g.shadowColor, b.shadowOffsetX = g.shadowOffsetX, b.shadowOffsetY = g.shadowOffsetY), g instanceof a.InteractiveElement && (g.selected && 1 == g.showSelected && g.paintSelected(b), 1 == g.isMouseOver && g.paintMouseover(b)), g.paint(b), b.restore()\r\n                }\r\n            }\r\n        }, this.getOffsetTranslate = function (a) {\r\n            var b = this.stage.canvas.width, c = this.stage.canvas.height;\r\n            null != a && "move" != a && (b = a.canvas.width, c = a.canvas.height);\r\n            var d = b / this.scaleX / 2, e = c / this.scaleY / 2, f = {translateX: this.translateX + (d - d * this.scaleX), translateY: this.translateY + (e - e * this.scaleY)};\r\n            return f\r\n        }, this.isVisiable = function (b) {\r\n            if (1 != b.visible)return !1;\r\n            if (b instanceof a.Link)return !0;\r\n            var c = this.getOffsetTranslate(), d = b.x + c.translateX, e = b.y + c.translateY;\r\n            d *= this.scaleX, e *= this.scaleY;\r\n            var f = d + b.width * this.scaleX, g = e + b.height * this.scaleY;\r\n            return d > this.stage.canvas.width || e > this.stage.canvas.height || 0 > f || 0 > g ? !1 : !0\r\n        }, this.paintOperations = function (a, b) {\r\n            for (var c = 0; c < b.length; c++)b[c](a)\r\n        }, this.findElements = function (a) {\r\n            for (var b = [], c = 0; c < this.childs.length; c++)1 == a(this.childs[c]) && b.push(this.childs[c]);\r\n            return b\r\n        }, this.getElementsByClass = function (a) {\r\n            return this.findElements(function (b) {\r\n                return b instanceof a\r\n            })\r\n        }, this.addOperation = function (a) {\r\n            return this.operations.push(a), this\r\n        }, this.clearOperations = function () {\r\n            return this.operations = [], this\r\n        }, this.getElementByXY = function (b, c) {\r\n            for (var d = null, e = this.zIndexArray.length - 1; e >= 0; e--)for (var f = this.zIndexArray[e], g = this.zIndexMap[f], h = g.length - 1; h >= 0; h--) {\r\n                var i = g[h];\r\n                if (i instanceof a.InteractiveElement && this.isVisiable(i) && i.isInBound(b, c))return d = i\r\n            }\r\n            return d\r\n        }, this.add = function (a) {\r\n            this.childs.push(a), null == this.zIndexMap[a.zIndex] && (this.zIndexMap[a.zIndex] = [], this.zIndexArray.push(a.zIndex), this.zIndexArray.sort(function (a, b) {\r\n                return a - b\r\n            })), this.zIndexMap["" + a.zIndex].push(a)\r\n        }, this.remove = function (b) {\r\n            this.childs = a.util.removeFromArray(this.childs, b);\r\n            var c = this.zIndexMap[b.zIndex];\r\n            c && (this.zIndexMap[b.zIndex] = a.util.removeFromArray(c, b)), b.removeHandler(this)\r\n        }, this.clear = function () {\r\n            var a = this;\r\n            this.childs.forEach(function (b) {\r\n                b.removeHandler(a)\r\n            }), this.childs = [], this.operations = [], this.zIndexArray = [], this.zIndexMap = {}\r\n        }, this.addToSelected = function (a) {\r\n            this.selectedElements.push(a)\r\n        }, this.cancleAllSelected = function (a) {\r\n            for (var b = 0; b < this.selectedElements.length; b++)this.selectedElements[b].unselectedHandler(a);\r\n            this.selectedElements = []\r\n        }, this.notInSelectedNodes = function (a) {\r\n            for (var b = 0; b < this.selectedElements.length; b++)if (a === this.selectedElements[b])return !1;\r\n            return !0\r\n        }, this.removeFromSelected = function (a) {\r\n            for (var b = 0; b < this.selectedElements.length; b++) {\r\n                var c = this.selectedElements[b];\r\n                a === c && (this.selectedElements = this.selectedElements.del(b))\r\n            }\r\n        }, this.toSceneEvent = function (b) {\r\n            var c = a.util.clone(b);\r\n            if (c.x /= this.scaleX, c.y /= this.scaleY, 1 == this.translate) {\r\n                var d = this.getOffsetTranslate();\r\n                c.x -= d.translateX, c.y -= d.translateY\r\n            }\r\n            return null != c.dx && (c.dx /= this.scaleX, c.dy /= this.scaleY), null != this.currentElement && (c.target = this.currentElement), c.scene = this, c\r\n        }, this.selectElement = function (a) {\r\n            var b = e.getElementByXY(a.x, a.y);\r\n            if (null != b)if (a.target = b, b.mousedownHander(a), b.selectedHandler(a), e.notInSelectedNodes(b))a.ctrlKey || e.cancleAllSelected(), e.addToSelected(b); else {\r\n                1 == a.ctrlKey && (b.unselectedHandler(), this.removeFromSelected(b));\r\n                for (var c = 0; c < this.selectedElements.length; c++) {\r\n                    var d = this.selectedElements[c];\r\n                    d.selectedHandler(a)\r\n                }\r\n            } else a.ctrlKey || e.cancleAllSelected();\r\n            this.currentElement = b\r\n        }, this.mousedownHandler = function (b) {\r\n            var c = this.toSceneEvent(b);\r\n            if (this.mouseDown = !0, this.mouseDownX = c.x, this.mouseDownY = c.y, this.mouseDownEvent = c, this.mode == a.SceneMode.normal)this.selectElement(c), (null == this.currentElement || this.currentElement instanceof a.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX, this.lastTranslateY = this.translateY); else {\r\n                if (this.mode == a.SceneMode.drag && 1 == this.translate)return this.lastTranslateX = this.translateX, void(this.lastTranslateY = this.translateY);\r\n                this.mode == a.SceneMode.select ? this.selectElement(c) : this.mode == a.SceneMode.edit && (this.selectElement(c), (null == this.currentElement || this.currentElement instanceof a.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX, this.lastTranslateY = this.translateY))\r\n            }\r\n            e.dispatchEvent("mousedown", c)\r\n        }, this.mouseupHandler = function (b) {\r\n            this.stage.cursor != a.MouseCursor.normal && (this.stage.cursor = a.MouseCursor.normal), e.clearOperations();\r\n            var c = this.toSceneEvent(b);\r\n            null != this.currentElement && (c.target = e.currentElement, this.currentElement.mouseupHandler(c)), this.dispatchEvent("mouseup", c), this.mouseDown = !1\r\n        }, this.dragElements = function (b) {\r\n            if (null != this.currentElement && 1 == this.currentElement.dragable)for (var c = 0; c < this.selectedElements.length; c++) {\r\n                var d = this.selectedElements[c];\r\n                if (0 != d.dragable) {\r\n                    var e = a.util.clone(b);\r\n                    e.target = d, d.mousedragHandler(e)\r\n                }\r\n            }\r\n        }, this.mousedragHandler = function (b) {\r\n            var c = this.toSceneEvent(b);\r\n            this.mode == a.SceneMode.normal ? null == this.currentElement || this.currentElement instanceof a.Link ? 1 == this.translate && (this.stage.cursor = a.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c) : this.mode == a.SceneMode.drag ? 1 == this.translate && (this.stage.cursor = a.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.mode == a.SceneMode.select ? null != this.currentElement ? 1 == this.currentElement.dragable && this.dragElements(c) : 1 == this.areaSelect && this.areaSelectHandle(c) : this.mode == a.SceneMode.edit && (null == this.currentElement || this.currentElement instanceof a.Link ? 1 == this.translate && (this.stage.cursor = a.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c)), this.dispatchEvent("mousedrag", c)\r\n        }, this.areaSelectHandle = function (a) {\r\n            var b = a.offsetLeft, c = a.offsetTop, f = this.mouseDownEvent.offsetLeft, g = this.mouseDownEvent.offsetTop, h = b >= f ? f : b, i = c >= g ? g : c, j = Math.abs(a.dx) * this.scaleX, k = Math.abs(a.dy) * this.scaleY, l = new d(h, i, j, k);\r\n            e.clearOperations().addOperation(l), b = a.x, c = a.y, f = this.mouseDownEvent.x, g = this.mouseDownEvent.y, h = b >= f ? f : b, i = c >= g ? g : c, j = Math.abs(a.dx), k = Math.abs(a.dy);\r\n            for (var m = h + j, n = i + k, o = 0; o < e.childs.length; o++) {\r\n                var p = e.childs[o];\r\n                p.x > h && p.x + p.width < m && p.y > i && p.y + p.height < n && e.notInSelectedNodes(p) && (p.selectedHandler(a), e.addToSelected(p))\r\n            }\r\n        }, this.mousemoveHandler = function (b) {\r\n            this.mousecoord = {x: b.x, y: b.y};\r\n            var c = this.toSceneEvent(b);\r\n            if (this.mode == a.SceneMode.drag)return void(this.stage.cursor = a.MouseCursor.open_hand);\r\n            this.mode == a.SceneMode.normal ? this.stage.cursor = a.MouseCursor.normal : this.mode == a.SceneMode.select && (this.stage.cursor = a.MouseCursor.normal);\r\n            var d = e.getElementByXY(c.x, c.y);\r\n            null != d ? (e.mouseOverelement && e.mouseOverelement !== d && (c.target = d, e.mouseOverelement.mouseoutHandler(c)), e.mouseOverelement = d, 0 == d.isMouseOver ? (c.target = d, d.mouseoverHandler(c), e.dispatchEvent("mouseover", c)) : (c.target = d, d.mousemoveHandler(c), e.dispatchEvent("mousemove", c))) : e.mouseOverelement ? (c.target = d, e.mouseOverelement.mouseoutHandler(c), e.mouseOverelement = null, e.dispatchEvent("mouseout", c)) : (c.target = null, e.dispatchEvent("mousemove", c))\r\n        }, this.mouseoverHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mouseover", b)\r\n        }, this.mouseoutHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mouseout", b)\r\n        }, this.clickHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.currentElement && (b.target = this.currentElement, this.currentElement.clickHandler(b)), this.dispatchEvent("click", b)\r\n        }, this.dbclickHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.currentElement ? (b.target = this.currentElement, this.currentElement.dbclickHandler(b)) : e.cancleAllSelected(), this.dispatchEvent("dbclick", b)\r\n        }, this.mousewheelHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mousewheel", b)\r\n        }, this.touchstart = this.mousedownHander, this.touchmove = this.mousedragHandler, this.touchend = this.mousedownHander, this.keydownHandler = function (a) {\r\n            this.dispatchEvent("keydown", a)\r\n        }, this.keyupHandler = function (a) {\r\n            this.dispatchEvent("keyup", a)\r\n        }, this.addEventListener = function (a, b) {\r\n            var c = this, d = function (a) {\r\n                b.call(c, a)\r\n            };\r\n            return this.messageBus.subscribe(a, d), this\r\n        }, this.removeEventListener = function (a) {\r\n            this.messageBus.unsubscribe(a)\r\n        }, this.removeAllEventListener = function () {\r\n            this.messageBus = new a.util.MessageBus\r\n        }, this.dispatchEvent = function (a, b) {\r\n            return this.messageBus.publish(a, b), this\r\n        };\r\n        var f = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), g = this;\r\n        return f.forEach(function (a) {\r\n            g[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        }), this.zoom = function (a, b) {\r\n            null != a && 0 != a && (this.scaleX = a), null != b && 0 != b && (this.scaleY = b)\r\n        }, this.zoomOut = function (a) {\r\n            0 != a && (null == a && (a = .8), this.scaleX /= a, this.scaleY /= a)\r\n        }, this.zoomIn = function (a) {\r\n            0 != a && (null == a && (a = .8), this.scaleX *= a, this.scaleY *= a)\r\n        }, this.getBound = function () {\r\n            return {left: 0, top: 0, right: this.stage.canvas.width, bottom: this.stage.canvas.height, width: this.stage.canvas.width, height: this.stage.canvas.height}\r\n        }, this.getElementsBound = function () {\r\n            return a.util.getElementsBound(this.childs)\r\n        }, this.translateToCenter = function (a) {\r\n            var b = this.getElementsBound(), c = this.stage.canvas.width / 2 - (b.left + b.right) / 2, d = this.stage.canvas.height / 2 - (b.top + b.bottom) / 2;\r\n            a && (c = a.canvas.width / 2 - (b.left + b.right) / 2, d = a.canvas.height / 2 - (b.top + b.bottom) / 2), this.translateX = c, this.translateY = d\r\n        }, this.setCenter = function (a, b) {\r\n            var c = a - this.stage.canvas.width / 2, d = b - this.stage.canvas.height / 2;\r\n            this.translateX = -c, this.translateY = -d\r\n        }, this.centerAndZoom = function (a, b, c) {\r\n            if (this.translateToCenter(c), null == a || null == b) {\r\n                var d = this.getElementsBound(), e = d.right - d.left, f = d.bottom - d.top, g = this.stage.canvas.width / e, h = this.stage.canvas.height / f;\r\n                c && (g = c.canvas.width / e, h = c.canvas.height / f);\r\n                var i = Math.min(g, h);\r\n                if (i > 1)return;\r\n                this.zoom(i, i)\r\n            }\r\n            this.zoom(a, b)\r\n        }, this.getCenterLocation = function () {\r\n            return {x: e.stage.canvas.width / 2, y: e.stage.canvas.height / 2}\r\n        }, this.doLayout = function (a) {\r\n            a && a(this, this.childs)\r\n        }, this.toJson = function () {\r\n            {\r\n                var a = this, b = "{";\r\n                this.serializedProperties.length\r\n            }\r\n            this.serializedProperties.forEach(function (c) {\r\n                var d = a[c];\r\n                "background" == c && (d = a._background.src), "string" == typeof d && (d = \'"\' + d + \'"\'), b += \'"\' + c + \'":\' + d + ","\r\n            }), b += \'"childs":[\';\r\n            var c = this.childs.length;\r\n            return this.childs.forEach(function (a, d) {\r\n                b += a.toJson(), c > d + 1 && (b += ",")\r\n            }), b += "]", b += "}"\r\n        }, e\r\n    }\r\n\r\n    b.prototype = new a.Element;\r\n    var c = {};\r\n    Object.defineProperties(b.prototype, {\r\n        background: {\r\n            get: function () {\r\n                return this._background\r\n            }, set: function (a) {\r\n                if ("string" == typeof a) {\r\n                    var b = c[a];\r\n                    null == b && (b = new Image, b.src = a, b.onload = function () {\r\n                        c[a] = b\r\n                    }), this._background = b\r\n                } else this._background = a\r\n            }\r\n        }\r\n    }), a.Scene = b\r\n}(JTopo), function (a) {\r\n    function b() {\r\n        this.initialize = function () {\r\n            b.prototype.initialize.apply(this, arguments), this.elementType = "displayElement", this.x = 0, this.y = 0, this.width = 32, this.height = 32, this.visible = !0, this.alpha = 1, this.rotate = 0, this.scaleX = 1, this.scaleY = 1, this.strokeColor = "22,124,255", this.borderColor = "22,124,255", this.fillColor = "22,124,255", this.shadow = !1, this.shadowBlur = 5, this.shadowColor = "rgba(0,0,0,0.5)", this.shadowOffsetX = 3, this.shadowOffsetY = 6, this.transformAble = !1, this.zIndex = 0;\r\n            var a = "x,y,width,height,visible,alpha,rotate,scaleX,scaleY,strokeColor,fillColor,shadow,shadowColor,shadowOffsetX,shadowOffsetY,transformAble,zIndex".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(a)\r\n        }, this.initialize(), this.paint = function (a) {\r\n            a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", a.rect(-this.width / 2, -this.height / 2, this.width, this.height), a.fill(), a.stroke(), a.closePath()\r\n        }, this.getLocation = function () {\r\n            return {x: this.x, y: this.y}\r\n        }, this.setLocation = function (a, b) {\r\n            return this.x = a, this.y = b, this\r\n        }, this.getCenterLocation = function () {\r\n            return {x: this.x + this.width / 2, y: this.y + this.height / 2}\r\n        }, this.setCenterLocation = function (a, b) {\r\n            return this.x = a - this.width / 2, this.y = b - this.height / 2, this\r\n        }, this.getSize = function () {\r\n            return {width: this.width, height: this.heith}\r\n        }, this.setSize = function (a, b) {\r\n            return this.width = a, this.height = b, this\r\n        }, this.getBound = function () {\r\n            return {left: this.x, top: this.y, right: this.x + this.width, bottom: this.y + this.height, width: this.width, height: this.height}\r\n        }, this.setBound = function (a, b, c, d) {\r\n            return this.setLocation(a, b), this.setSize(c, d), this\r\n        }, this.getDisplayBound = function () {\r\n            return {left: this.x, top: this.y, right: this.x + this.width * this.scaleX, bottom: this.y + this.height * this.scaleY}\r\n        }, this.getDisplaySize = function () {\r\n            return {width: this.width * this.scaleX, height: this.height * this.scaleY}\r\n        }, this.getPosition = function (a) {\r\n            var b, c = this.getBound();\r\n            return "Top_Left" == a ? b = {x: c.left, y: c.top} : "Top_Center" == a ? b = {x: this.cx, y: c.top} : "Top_Right" == a ? b = {x: c.right, y: c.top} : "Middle_Left" == a ? b = {\r\n                x: c.left,\r\n                y: this.cy\r\n            } : "Middle_Center" == a ? b = {x: this.cx, y: this.cy} : "Middle_Right" == a ? b = {x: c.right, y: this.cy} : "Bottom_Left" == a ? b = {\r\n                x: c.left,\r\n                y: c.bottom\r\n            } : "Bottom_Center" == a ? b = {x: this.cx, y: c.bottom} : "Bottom_Right" == a && (b = {x: c.right, y: c.bottom}), b\r\n        }\r\n    }\r\n\r\n    function c() {\r\n        this.initialize = function () {\r\n            c.prototype.initialize.apply(this, arguments), this.elementType = "interactiveElement", this.dragable = !1, this.selected = !1, this.showSelected = !0, this.selectedLocation = null, this.isMouseOver = !1;\r\n            var a = "dragable,selected,showSelected,isMouseOver".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(a)\r\n        }, this.initialize(), this.paintSelected = function (a) {\r\n            0 != this.showSelected && (a.save(), a.beginPath(), a.strokeStyle = "rgba(168,202,255, 0.9)", a.fillStyle = "rgba(168,202,236,0.7)", a.rect(-this.width / 2 - 3, -this.height / 2 - 3, this.width + 6, this.height + 6), a.fill(), a.stroke(), a.closePath(), a.restore())\r\n        }, this.paintMouseover = function (a) {\r\n            return this.paintSelected(a)\r\n        }, this.isInBound = function (a, b) {\r\n            return a > this.x && a < this.x + this.width * Math.abs(this.scaleX) && b > this.y && b < this.y + this.height * Math.abs(this.scaleY)\r\n        }, this.selectedHandler = function () {\r\n            this.selected = !0, this.selectedLocation = {x: this.x, y: this.y}\r\n        }, this.unselectedHandler = function () {\r\n            this.selected = !1, this.selectedLocation = null\r\n        }, this.dbclickHandler = function (a) {\r\n            this.dispatchEvent("dbclick", a)\r\n        }, this.clickHandler = function (a) {\r\n            this.dispatchEvent("click", a)\r\n        }, this.mousedownHander = function (a) {\r\n            this.dispatchEvent("mousedown", a)\r\n        }, this.mouseupHandler = function (a) {\r\n            this.dispatchEvent("mouseup", a)\r\n        }, this.mouseoverHandler = function (a) {\r\n            this.isMouseOver = !0, this.dispatchEvent("mouseover", a)\r\n        }, this.mousemoveHandler = function (a) {\r\n            this.dispatchEvent("mousemove", a)\r\n        }, this.mouseoutHandler = function (a) {\r\n            this.isMouseOver = !1, this.dispatchEvent("mouseout", a)\r\n        }, this.mousedragHandler = function (a) {\r\n            var b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n            this.setLocation(b, c), this.dispatchEvent("mousedrag", a)\r\n        }, this.addEventListener = function (b, c) {\r\n            var d = this, e = function (a) {\r\n                c.call(d, a)\r\n            };\r\n            return this.messageBus || (this.messageBus = new a.util.MessageBus), this.messageBus.subscribe(b, e), this\r\n        }, this.dispatchEvent = function (a, b) {\r\n            return this.messageBus ? (this.messageBus.publish(a, b), this) : null\r\n        }, this.removeEventListener = function (a) {\r\n            this.messageBus.unsubscribe(a)\r\n        }, this.removeAllEventListener = function () {\r\n            this.messageBus = new a.util.MessageBus\r\n        };\r\n        var b = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,touchstart,touchmove,touchend".split(","), d = this;\r\n        b.forEach(function (a) {\r\n            d[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        })\r\n    }\r\n\r\n    function d() {\r\n        this.initialize = function () {\r\n            d.prototype.initialize.apply(this, arguments), this.editAble = !1, this.selectedPoint = null\r\n        }, this.getCtrlPosition = function (a) {\r\n            var b = 5, c = 5, d = this.getPosition(a);\r\n            return {left: d.x - b, top: d.y - c, right: d.x + b, bottom: d.y + c}\r\n        }, this.selectedHandler = function (b) {\r\n            d.prototype.selectedHandler.apply(this, arguments), this.selectedSize = {width: this.width, height: this.height}, b.scene.mode == a.SceneMode.edit && (this.editAble = !0)\r\n        }, this.unselectedHandler = function () {\r\n            d.prototype.unselectedHandler.apply(this, arguments), this.selectedSize = null, this.editAble = !1\r\n        };\r\n        var b = ["Top_Left", "Top_Center", "Top_Right", "Middle_Left", "Middle_Right", "Bottom_Left", "Bottom_Center", "Bottom_Right"];\r\n        this.paintCtrl = function (a) {\r\n            if (0 != this.editAble) {\r\n                a.save();\r\n                for (var c = 0; c < b.length; c++) {\r\n                    var d = this.getCtrlPosition(b[c]);\r\n                    d.left -= this.cx, d.right -= this.cx, d.top -= this.cy, d.bottom -= this.cy;\r\n                    var e = d.right - d.left, f = d.bottom - d.top;\r\n                    a.beginPath(), a.strokeStyle = "rgba(0,0,0,0.8)", a.rect(d.left, d.top, e, f), a.stroke(), a.closePath(), a.beginPath(), a.strokeStyle = "rgba(255,255,255,0.3)", a.rect(d.left + 1, d.top + 1, e - 2, f - 2), a.stroke(), a.closePath()\r\n                }\r\n                a.restore()\r\n            }\r\n        }, this.isInBound = function (a, c) {\r\n            if (this.selectedPoint = null, 1 == this.editAble)for (var e = 0; e < b.length; e++) {\r\n                var f = this.getCtrlPosition(b[e]);\r\n                if (a > f.left && a < f.right && c > f.top && c < f.bottom)return this.selectedPoint = b[e], !0\r\n            }\r\n            return d.prototype.isInBound.apply(this, arguments)\r\n        }, this.mousedragHandler = function (a) {\r\n            if (null == this.selectedPoint) {\r\n                var b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                this.setLocation(b, c), this.dispatchEvent("mousedrag", a)\r\n            } else {\r\n                if ("Top_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, e = this.selectedSize.height - a.dy, b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                    b < this.x + this.width && (this.x = b, this.width = d), c < this.y + this.height && (this.y = c, this.height = e)\r\n                } else if ("Top_Center" == this.selectedPoint) {\r\n                    var e = this.selectedSize.height - a.dy, c = this.selectedLocation.y + a.dy;\r\n                    c < this.y + this.height && (this.y = c, this.height = e)\r\n                } else if ("Top_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx, c = this.selectedLocation.y + a.dy;\r\n                    c < this.y + this.height && (this.y = c, this.height = this.selectedSize.height - a.dy), d > 1 && (this.width = d)\r\n                } else if ("Middle_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                    b < this.x + this.width && (this.x = b), d > 1 && (this.width = d)\r\n                } else if ("Middle_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx;\r\n                    d > 1 && (this.width = d)\r\n                } else if ("Bottom_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                    d > 1 && (this.x = b, this.width = d);\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                } else if ("Bottom_Center" == this.selectedPoint) {\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                } else if ("Bottom_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx;\r\n                    d > 1 && (this.width = d);\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                }\r\n                this.dispatchEvent("resize", a)\r\n            }\r\n        }\r\n    }\r\n\r\n    b.prototype = new a.Element, Object.defineProperties(b.prototype, {\r\n        cx: {\r\n            get: function () {\r\n                return this.x + this.width / 2\r\n            }, set: function (a) {\r\n                this.x = a - this.width / 2\r\n            }\r\n        }, cy: {\r\n            get: function () {\r\n                return this.y + this.height / 2\r\n            }, set: function (a) {\r\n                this.y = a - this.height / 2\r\n            }\r\n        }\r\n    }), c.prototype = new b, d.prototype = new c, a.DisplayElement = b, a.InteractiveElement = c, a.EditableElement = d\r\n}(JTopo), function (a) {\r\n    function b(c) {\r\n        this.initialize = function (c) {\r\n            b.prototype.initialize.apply(this, arguments), this.elementType = "node", this.zIndex = a.zIndex_Node, this.text = c, this.font = "12px Consolas", this.fontColor = "255,255,255", this.borderWidth = 0, this.borderColor = "255,255,255", this.borderRadius = null, this.dragable = !0, this.textPosition = "Bottom_Center", this.textOffsetX = 0, this.textOffsetY = 0, this.transformAble = !0, this.inLinks = null, this.outLinks = null;\r\n            var d = "text,font,fontColor,textPosition,textOffsetX,textOffsetY,borderRadius".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(d)\r\n        }, this.initialize(c), this.paint = function (a) {\r\n            if (this.image) {\r\n                var b = a.globalAlpha;\r\n                a.globalAlpha = this.alpha, null != this.alarmImage && null != this.alarm ? a.drawImage(this.alarmImage, -this.width / 2, -this.height / 2, this.width, this.height) : a.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height), a.globalAlpha = b\r\n            } else a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", null == this.borderRadius || 0 == this.borderRadius ? a.rect(-this.width / 2, -this.height / 2, this.width, this.height) : a.JTopoRoundRect(-this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius), a.fill(), a.closePath();\r\n            this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }, this.paintAlarmText = function (a) {\r\n            if (null != this.alarm && "" != this.alarm) {\r\n                var b = this.alarmColor || "255,0,0", c = this.alarmAlpha || .5;\r\n                a.beginPath(), a.font = this.alarmFont || "10px 微软雅黑";\r\n                var d = a.measureText(this.alarm).width + 6, e = a.measureText("田").width + 6, f = this.width / 2 - d / 2, g = -this.height / 2 - e - 8;\r\n                a.strokeStyle = "rgba(" + b + ", " + c + ")", a.fillStyle = "rgba(" + b + ", " + c + ")", a.lineCap = "round", a.lineWidth = 1, a.moveTo(f, g), a.lineTo(f + d, g), a.lineTo(f + d, g + e), a.lineTo(f + d / 2 + 6, g + e), a.lineTo(f + d / 2, g + e + 8), a.lineTo(f + d / 2 - 6, g + e), a.lineTo(f, g + e), a.lineTo(f, g), a.fill(), a.stroke(), a.closePath(), a.beginPath(), a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.alarm, f + 2, g + e - 4), a.closePath()\r\n            }\r\n        }, this.paintText = function (a) {\r\n            var b = this.text;\r\n            if (null != b && "" != b) {\r\n                a.beginPath(), a.font = this.font;\r\n                var c = a.measureText(b).width, d = a.measureText("田").width;\r\n                a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                var e = this.getTextPostion(this.textPosition, c, d);\r\n                a.fillText(b, e.x, e.y), a.closePath()\r\n            }\r\n        }, this.paintBorder = function (a) {\r\n            if (0 != this.borderWidth) {\r\n                a.beginPath(), a.lineWidth = this.borderWidth, a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                var b = this.borderWidth / 2;\r\n                null == this.borderRadius || 0 == this.borderRadius ? a.rect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth) : a.JTopoRoundRect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius), a.stroke(), a.closePath()\r\n            }\r\n        }, this.getTextPostion = function (a, b, c) {\r\n            var d = null;\r\n            return null == a || "Bottom_Center" == a ? d = {x: -this.width / 2 + (this.width - b) / 2, y: this.height / 2 + c} : "Top_Center" == a ? d = {\r\n                x: -this.width / 2 + (this.width - b) / 2,\r\n                y: -this.height / 2 - c / 2\r\n            } : "Top_Right" == a ? d = {x: this.width / 2, y: -this.height / 2 - c / 2} : "Top_Left" == a ? d = {\r\n                x: -this.width / 2 - b,\r\n                y: -this.height / 2 - c / 2\r\n            } : "Bottom_Right" == a ? d = {x: this.width / 2, y: this.height / 2 + c} : "Bottom_Left" == a ? d = {\r\n                x: -this.width / 2 - b,\r\n                y: this.height / 2 + c\r\n            } : "Middle_Center" == a ? d = {x: -this.width / 2 + (this.width - b) / 2, y: c / 2} : "Middle_Right" == a ? d = {\r\n                x: this.width / 2,\r\n                y: c / 2\r\n            } : "Middle_Left" == a && (d = {x: -this.width / 2 - b, y: c / 2}), null != this.textOffsetX && (d.x += this.textOffsetX), null != this.textOffsetY && (d.y += this.textOffsetY), d\r\n        }, this.setImage = function (a, b) {\r\n            if (null == a)throw new Error("Node.setImage(): 参数Image对象为空!");\r\n            var c = this;\r\n            if ("string" == typeof a) {\r\n                var d = j[a];\r\n                null == d ? (d = new Image, d.src = a, d.onload = function () {\r\n                    j[a] = d, 1 == b && c.setSize(d.width, d.height), c.image = d, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor\r\n                }) : (b && this.setSize(d.width, d.height), c.image = d, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor)\r\n            } else this.image = a, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor, 1 == b && this.setSize(a.width, a.height)\r\n        }, this.removeHandler = function (a) {\r\n            var b = this;\r\n            this.outLinks && (this.outLinks.forEach(function (c) {\r\n                c.nodeA === b && a.remove(c)\r\n            }), this.outLinks = null), this.inLinks && (this.inLinks.forEach(function (c) {\r\n                c.nodeZ === b && a.remove(c)\r\n            }), this.inLinks = null)\r\n        }\r\n    }\r\n\r\n    function c() {\r\n        c.prototype.initialize.apply(this, arguments)\r\n    }\r\n\r\n    function d(a) {\r\n        this.initialize(), this.text = a, this.elementType = "TextNode", this.paint = function (a) {\r\n            a.beginPath(), a.font = this.font, this.width = a.measureText(this.text).width, this.height = a.measureText("田").width, a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.text, -this.width / 2, this.height / 2), a.closePath(), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }\r\n    }\r\n\r\n    function e(a, b, c) {\r\n        this.initialize(), this.text = a, this.href = b, this.target = c, this.elementType = "LinkNode", this.isVisited = !1, this.visitedColor = null, this.paint = function (a) {\r\n            a.beginPath(), a.font = this.font, this.width = a.measureText(this.text).width, this.height = a.measureText("田").width, this.isVisited && null != this.visitedColor ? (a.strokeStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")") : (a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")"), a.fillText(this.text, -this.width / 2, this.height / 2), this.isMouseOver && (a.moveTo(-this.width / 2, this.height), a.lineTo(this.width / 2, this.height), a.stroke()), a.closePath(), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }, this.mousemove(function () {\r\n            var a = document.getElementsByTagName("canvas");\r\n            if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "pointer"\r\n        }), this.mouseout(function () {\r\n            var a = document.getElementsByTagName("canvas");\r\n            if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "default"\r\n        }), this.click(function () {\r\n            "_blank" == this.target ? window.open(this.href) : location = this.href, this.isVisited = !0\r\n        })\r\n    }\r\n\r\n    function f(a) {\r\n        this.initialize(arguments), this._radius = 20, this.beginDegree = 0, this.endDegree = 2 * Math.PI, this.text = a, this.paint = function (a) {\r\n            a.save(), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", a.arc(0, 0, this.radius, this.beginDegree, this.endDegree, !0), a.fill(), a.closePath(), a.restore(), this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n        }, this.paintSelected = function (a) {\r\n            a.save(), a.beginPath(), a.strokeStyle = "rgba(168,202,255, 0.9)", a.fillStyle = "rgba(168,202,236,0.7)", a.arc(0, 0, this.radius + 3, this.beginDegree, this.endDegree, !0), a.fill(), a.stroke(), a.closePath(), a.restore()\r\n        }\r\n    }\r\n\r\n    function g(a, b, c) {\r\n        this.initialize(), this.frameImages = a || [], this.frameIndex = 0, this.isStop = !0;\r\n        var d = b || 1e3;\r\n        this.repeatPlay = !1;\r\n        var e = this;\r\n        this.nextFrame = function () {\r\n            if (!this.isStop && null != this.frameImages.length) {\r\n                if (this.frameIndex++, this.frameIndex >= this.frameImages.length) {\r\n                    if (!this.repeatPlay)return;\r\n                    this.frameIndex = 0\r\n                }\r\n                this.setImage(this.frameImages[this.frameIndex], c), setTimeout(function () {\r\n                    e.nextFrame()\r\n                }, d / a.length)\r\n            }\r\n        }\r\n    }\r\n\r\n    function h(a, b, c, d, e) {\r\n        this.initialize();\r\n        var f = this;\r\n        this.setImage(a), this.frameIndex = 0, this.isPause = !0, this.repeatPlay = !1;\r\n        var g = d || 1e3;\r\n        e = e || 0, this.paint = function (a) {\r\n            if (this.image) {\r\n                var b = this.width, d = this.height;\r\n                a.save(), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                var f = (Math.floor(this.frameIndex / c) + e) * d, g = Math.floor(this.frameIndex % c) * b;\r\n                a.drawImage(this.image, g, f, b, d, -b / 2, -d / 2, b, d), a.fill(), a.closePath(), a.restore(), this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n            }\r\n        }, this.nextFrame = function () {\r\n            if (!this.isStop) {\r\n                if (this.frameIndex++, this.frameIndex >= b * c) {\r\n                    if (!this.repeatPlay)return;\r\n                    this.frameIndex = 0\r\n                }\r\n                setTimeout(function () {\r\n                    f.isStop || f.nextFrame()\r\n                }, g / (b * c))\r\n            }\r\n        }\r\n    }\r\n\r\n    function i() {\r\n        var a = null;\r\n        return a = arguments.length <= 3 ? new g(arguments[0], arguments[1], arguments[2]) : new h(arguments[0], arguments[1], arguments[2], arguments[3], arguments[4], arguments[5]), a.stop = function () {\r\n            a.isStop = !0\r\n        }, a.play = function () {\r\n            a.isStop = !1, a.frameIndex = 0, a.nextFrame()\r\n        }, a\r\n    }\r\n\r\n    var j = {};\r\n    b.prototype = new a.EditableElement, c.prototype = new b, Object.defineProperties(c.prototype, {\r\n        alarmColor: {\r\n            get: function () {\r\n                return this._alarmColor\r\n            }, set: function (b) {\r\n                if (this._alarmColor = b, null != this.image) {\r\n                    var c = a.util.genImageAlarm(this.image, b);\r\n                    c && (this.alarmImage = c)\r\n                }\r\n            }\r\n        }\r\n    }), d.prototype = new c, e.prototype = new d, f.prototype = new c, Object.defineProperties(f.prototype, {\r\n        radius: {\r\n            get: function () {\r\n                return this._radius\r\n            }, set: function (a) {\r\n                this._radius = a;\r\n                var b = 2 * this.radius, c = 2 * this.radius;\r\n                this.width = b, this.height = c\r\n            }\r\n        }, width: {\r\n            get: function () {\r\n                return this._width\r\n            }, set: function (a) {\r\n                this._radius = a / 2, this._width = a\r\n            }\r\n        }, height: {\r\n            get: function () {\r\n                return this._height\r\n            }, set: function (a) {\r\n                this._radius = a / 2, this._height = a\r\n            }\r\n        }\r\n    }), g.prototype = new c, h.prototype = new c, i.prototype = new c, a.Node = c, a.TextNode = d, a.LinkNode = e, a.CircleNode = f, a.AnimateNode = i\r\n}(JTopo), function (a) {\r\n    function b(a, b) {\r\n        var c = [];\r\n        if (null == a || null == b)return c;\r\n        if (a && b && a.outLinks && b.inLinks)for (var d = 0; d < a.outLinks.length; d++)for (var e = a.outLinks[d], f = 0; f < b.inLinks.length; f++) {\r\n            var g = b.inLinks[f];\r\n            e === g && c.push(g)\r\n        }\r\n        return c\r\n    }\r\n\r\n    function c(a, c) {\r\n        var d = b(a, c), e = b(c, a), f = d.concat(e);\r\n        return f\r\n    }\r\n\r\n    function d(a) {\r\n        var b = c(a.nodeA, a.nodeZ);\r\n        return b = b.filter(function (b) {\r\n            return a !== b\r\n        })\r\n    }\r\n\r\n    function e(a, b) {\r\n        return c(a, b).length\r\n    }\r\n\r\n    function f(b, c, g) {\r\n        function h(b, c) {\r\n            var d = a.util.lineF(b.cx, b.cy, c.cx, c.cy), e = b.getBound(), f = a.util.intersectionLineBound(d, e);\r\n            return f\r\n        }\r\n\r\n        this.initialize = function (b, c, d) {\r\n            if (f.prototype.initialize.apply(this, arguments), this.elementType = "link", this.zIndex = a.zIndex_Link, 0 != arguments.length) {\r\n                this.text = d, this.nodeA = b, this.nodeZ = c, this.nodeA && null == this.nodeA.outLinks && (this.nodeA.outLinks = []), this.nodeA && null == this.nodeA.inLinks && (this.nodeA.inLinks = []), this.nodeZ && null == this.nodeZ.inLinks && (this.nodeZ.inLinks = []), this.nodeZ && null == this.nodeZ.outLinks && (this.nodeZ.outLinks = []), null != this.nodeA && this.nodeA.outLinks.push(this), null != this.nodeZ && this.nodeZ.inLinks.push(this), this.caculateIndex(), this.font = "12px Consolas", this.fontColor = "255,255,255", this.lineWidth = 2, this.lineJoin = "miter", this.transformAble = !1, this.bundleOffset = 20, this.bundleGap = 12, this.textOffsetX = 0, this.textOffsetY = 0, this.arrowsRadius = null, this.arrowsOffset = 0, this.dashedPattern = null, this.path = [];\r\n                var e = "text,font,fontColor,lineWidth,lineJoin".split(",");\r\n                this.serializedProperties = this.serializedProperties.concat(e)\r\n            }\r\n        }, this.caculateIndex = function () {\r\n            var a = e(this.nodeA, this.nodeZ);\r\n            a > 0 && (this.nodeIndex = a - 1)\r\n        }, this.initialize(b, c, g), this.removeHandler = function () {\r\n            var a = this;\r\n            this.nodeA && this.nodeA.outLinks && (this.nodeA.outLinks = this.nodeA.outLinks.filter(function (b) {\r\n                return b !== a\r\n            })), this.nodeZ && this.nodeZ.inLinks && (this.nodeZ.inLinks = this.nodeZ.inLinks.filter(function (b) {\r\n                return b !== a\r\n            }));\r\n            var b = d(this);\r\n            b.forEach(function (a, b) {\r\n                a.nodeIndex = b\r\n            })\r\n        }, this.getStartPosition = function () {\r\n            var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n            return a\r\n        }, this.getEndPosition = function () {\r\n            var a;\r\n            return null != this.arrowsRadius && (a = h(this.nodeZ, this.nodeA)), null == a && (a = {x: this.nodeZ.cx, y: this.nodeZ.cy}), a\r\n        }, this.getPath = function () {\r\n            var a = [], b = this.getStartPosition(), c = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ)return [b, c];\r\n            var d = e(this.nodeA, this.nodeZ);\r\n            if (1 == d)return [b, c];\r\n            var f = Math.atan2(c.y - b.y, c.x - b.x), g = {x: b.x + this.bundleOffset * Math.cos(f), y: b.y + this.bundleOffset * Math.sin(f)}, h = {\r\n                x: c.x + this.bundleOffset * Math.cos(f - Math.PI),\r\n                y: c.y + this.bundleOffset * Math.sin(f - Math.PI)\r\n            }, i = f - Math.PI / 2, j = f - Math.PI / 2, k = d * this.bundleGap / 2 - this.bundleGap / 2, l = this.bundleGap * this.nodeIndex, m = {\r\n                x: g.x + l * Math.cos(i),\r\n                y: g.y + l * Math.sin(i)\r\n            }, n = {x: h.x + l * Math.cos(j), y: h.y + l * Math.sin(j)};\r\n            return m = {x: m.x + k * Math.cos(i - Math.PI), y: m.y + k * Math.sin(i - Math.PI)}, n = {x: n.x + k * Math.cos(j - Math.PI), y: n.y + k * Math.sin(j - Math.PI)}, a.push({\r\n                x: b.x,\r\n                y: b.y\r\n            }), a.push({x: m.x, y: m.y}), a.push({x: n.x, y: n.y}), a.push({x: c.x, y: c.y}), a\r\n        }, this.paintPath = function (a, b) {\r\n            if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n            a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n            for (var c = 1; c < b.length; c++)null == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);\r\n            if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n                var d = b[b.length - 2], e = b[b.length - 1];\r\n                this.paintArrow(a, d, e)\r\n            }\r\n        }, this.paintLoop = function (a) {\r\n            a.beginPath();\r\n            {\r\n                var b = this.bundleGap * (this.nodeIndex + 1) / 2;\r\n                Math.PI + Math.PI / 2\r\n            }\r\n            a.arc(this.nodeA.x, this.nodeA.y, b, Math.PI / 2, 2 * Math.PI), a.stroke(), a.closePath()\r\n        }, this.paintArrow = function (b, c, d) {\r\n            var e = this.arrowsOffset, f = this.arrowsRadius / 2, g = c, h = d, i = Math.atan2(h.y - g.y, h.x - g.x), j = a.util.getDistance(g, h) - this.arrowsRadius, k = g.x + (j + e) * Math.cos(i), l = g.y + (j + e) * Math.sin(i), m = h.x + e * Math.cos(i), n = h.y + e * Math.sin(i);\r\n            i -= Math.PI / 2;\r\n            var o = {x: k + f * Math.cos(i), y: l + f * Math.sin(i)}, p = {x: k + f * Math.cos(i - Math.PI), y: l + f * Math.sin(i - Math.PI)};\r\n            b.beginPath(), b.fillStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", b.moveTo(o.x, o.y), b.lineTo(m, n), b.lineTo(p.x, p.y), b.stroke(), b.closePath()\r\n        }, this.paint = function (a) {\r\n            if (null != this.nodeA && null != !this.nodeZ) {\r\n                var b = this.getPath(this.nodeIndex);\r\n                this.path = b, a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", a.lineWidth = this.lineWidth, this.paintPath(a, b), b && b.length > 0 && this.paintText(a, b)\r\n            }\r\n        };\r\n        var i = -(Math.PI / 2 + Math.PI / 4);\r\n        this.paintText = function (a, b) {\r\n            var c = b[0], d = b[b.length - 1];\r\n            if (4 == b.length && (c = b[1], d = b[2]), this.text && this.text.length > 0) {\r\n                var e = (d.x + c.x) / 2 + this.textOffsetX, f = (d.y + c.y) / 2 + this.textOffsetY;\r\n                a.save(), a.beginPath(), a.font = this.font;\r\n                var g = a.measureText(this.text).width, h = a.measureText("田").width;\r\n                if (a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", this.nodeA === this.nodeZ) {\r\n                    var j = this.bundleGap * (this.nodeIndex + 1) / 2, e = this.nodeA.x + j * Math.cos(i), f = this.nodeA.y + j * Math.sin(i);\r\n                    a.fillText(this.text, e, f)\r\n                } else a.fillText(this.text, e - g / 2, f - h / 2);\r\n                a.stroke(), a.closePath(), a.restore()\r\n            }\r\n        }, this.paintSelected = function (a) {\r\n            a.shadowBlur = 10, a.shadowColor = "rgba(0,0,0,1)", a.shadowOffsetX = 0, a.shadowOffsetY = 0\r\n        }, this.isInBound = function (b, c) {\r\n            if (this.nodeA === this.nodeZ) {\r\n                var d = this.bundleGap * (this.nodeIndex + 1) / 2, e = a.util.getDistance(this.nodeA, {x: b, y: c}) - d;\r\n                return Math.abs(e) <= 3\r\n            }\r\n            for (var f = !1, g = 1; g < this.path.length; g++) {\r\n                var h = this.path[g - 1], i = this.path[g];\r\n                if (1 == a.util.isPointInLine({x: b, y: c}, h, i)) {\r\n                    f = !0;\r\n                    break\r\n                }\r\n            }\r\n            return f\r\n        }\r\n    }\r\n\r\n    function g(a, b, c) {\r\n        this.initialize = function () {\r\n            g.prototype.initialize.apply(this, arguments), this.direction = "horizontal"\r\n        }, this.initialize(a, b, c), this.getStartPosition = function () {\r\n            var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n            return "horizontal" == this.direction ? this.nodeZ.cx > a.x ? a.x += this.nodeA.width / 2 : a.x -= this.nodeA.width / 2 : this.nodeZ.cy > a.y ? a.y += this.nodeA.height / 2 : a.y -= this.nodeA.height / 2, a\r\n        }, this.getEndPosition = function () {\r\n            var a = {x: this.nodeZ.cx, y: this.nodeZ.cy};\r\n            return "horizontal" == this.direction ? this.nodeA.cy < a.y ? a.y -= this.nodeZ.height / 2 : a.y += this.nodeZ.height / 2 : a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width, a\r\n        }, this.getPath = function (a) {\r\n            var b = [], c = this.getStartPosition(), d = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ)return [c, d];\r\n            var f, g, h = e(this.nodeA, this.nodeZ), i = (h - 1) * this.bundleGap, j = this.bundleGap * a - i / 2;\r\n            return "horizontal" == this.direction ? (f = d.x + j, g = c.y - j, b.push({x: c.x, y: g}), b.push({x: f, y: g}), b.push({x: f, y: d.y})) : (f = c.x + j, g = d.y - j, b.push({\r\n                x: f,\r\n                y: c.y\r\n            }), b.push({x: f, y: g}), b.push({x: d.x, y: g})), b\r\n        }, this.paintText = function (a, b) {\r\n            if (this.text && this.text.length > 0) {\r\n                var c = b[1], d = c.x + this.textOffsetX, e = c.y + this.textOffsetY;\r\n                a.save(), a.beginPath(), a.font = this.font;\r\n                var f = a.measureText(this.text).width, g = a.measureText("田").width;\r\n                a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.text, d - f / 2, e - g / 2), a.stroke(), a.closePath(), a.restore()\r\n            }\r\n        }\r\n    }\r\n\r\n    function h(a, b, c) {\r\n        this.initialize = function () {\r\n            h.prototype.initialize.apply(this, arguments), this.direction = "vertical", this.offsetGap = 44\r\n        }, this.initialize(a, b, c), this.getStartPosition = function () {\r\n            var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n            return "horizontal" == this.direction ? a.x = this.nodeZ.cx < a.x ? this.nodeA.x : this.nodeA.x + this.nodeA.width : a.y = this.nodeZ.cy < a.y ? this.nodeA.y : this.nodeA.y + this.nodeA.height, a\r\n        }, this.getEndPosition = function () {\r\n            var a = {x: this.nodeZ.cx, y: this.nodeZ.cy};\r\n            return "horizontal" == this.direction ? a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width : a.y = this.nodeA.cy < a.y ? this.nodeZ.y : this.nodeZ.y + this.nodeZ.height, a\r\n        }, this.getPath = function (a) {\r\n            var b = this.getStartPosition(), c = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ)return [b, c];\r\n            var d = [], f = e(this.nodeA, this.nodeZ), g = (f - 1) * this.bundleGap, h = this.bundleGap * a - g / 2, i = this.offsetGap;\r\n            return "horizontal" == this.direction ? (this.nodeA.cx > this.nodeZ.cx && (i = -i), d.push({x: b.x, y: b.y + h}), d.push({x: b.x + i, y: b.y + h}), d.push({\r\n                x: c.x - i,\r\n                y: c.y + h\r\n            }), d.push({x: c.x, y: c.y + h})) : (this.nodeA.cy > this.nodeZ.cy && (i = -i), d.push({x: b.x + h, y: b.y}), d.push({x: b.x + h, y: b.y + i}), d.push({\r\n                x: c.x + h,\r\n                y: c.y - i\r\n            }), d.push({x: c.x + h, y: c.y})), d\r\n        }\r\n    }\r\n\r\n    function i(a, b, c) {\r\n        this.initialize = function () {\r\n            i.prototype.initialize.apply(this, arguments)\r\n        }, this.initialize(a, b, c), this.paintPath = function (a, b) {\r\n            if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n            a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n            for (var c = 1; c < b.length; c++) {\r\n                var d = b[c - 1], e = b[c], f = (d.x + e.x) / 2, g = (d.y + e.y) / 2;\r\n                g += (e.y - d.y) / 2, a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", a.lineWidth = this.lineWidth, a.moveTo(d.x, d.cy), a.quadraticCurveTo(f, g, e.x, e.y), a.stroke()\r\n            }\r\n            if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n                var h = b[b.length - 2], i = b[b.length - 1];\r\n                this.paintArrow(a, h, i)\r\n            }\r\n        }\r\n    }\r\n\r\n    f.prototype = new a.InteractiveElement, g.prototype = new f, h.prototype = new f, i.prototype = new f, a.Link = f, a.FoldLink = g, a.FlexionalLink = h, a.CurveLink = i\r\n}(JTopo), function (a) {\r\n    function b(c) {\r\n        this.initialize = function (c) {\r\n            b.prototype.initialize.apply(this, null), this.elementType = "container", this.zIndex = a.zIndex_Container, this.width = 100, this.height = 100, this.childs = [], this.alpha = .5, this.dragable = !0, this.childDragble = !0, this.visible = !0, this.fillColor = "10,100,80", this.borderWidth = 0, this.borderColor = "255,255,255", this.borderRadius = null, this.font = "12px Consolas", this.fontColor = "255,255,255", this.text = c, this.textPosition = "Bottom_Center", this.textOffsetX = 0, this.textOffsetY = 0, this.layout = new a.layout.AutoBoundLayout\r\n        }, this.initialize(c), this.add = function (a) {\r\n            this.childs.push(a), a.dragable = this.childDragble\r\n        }, this.remove = function (a) {\r\n            for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a) {\r\n                a.parentContainer = null, this.childs = this.childs.del(b), a.lastParentContainer = this;\r\n                break\r\n            }\r\n        }, this.removeAll = function () {\r\n            this.childs = []\r\n        }, this.setLocation = function (a, b) {\r\n            var c = a - this.x, d = b - this.y;\r\n            this.x = a, this.y = b;\r\n            for (var e = 0; e < this.childs.length; e++) {\r\n                var f = this.childs[e];\r\n                f.setLocation(f.x + c, f.y + d)\r\n            }\r\n        }, this.doLayout = function (a) {\r\n            a && a(this, this.childs)\r\n        }, this.paint = function (a) {\r\n            this.visible && (this.layout && this.layout(this, this.childs), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", null == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x, this.y, this.width, this.height) : a.JTopoRoundRect(this.x, this.y, this.width, this.height, this.borderRadius), a.fill(), a.closePath(), this.paintText(a), this.paintBorder(a))\r\n        }, this.paintBorder = function (a) {\r\n            if (0 != this.borderWidth) {\r\n                a.beginPath(), a.lineWidth = this.borderWidth, a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                var b = this.borderWidth / 2;\r\n                null == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth) : a.JTopoRoundRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius), a.stroke(), a.closePath()\r\n            }\r\n        }, this.paintText = function (a) {\r\n            var b = this.text;\r\n            if (null != b && "" != b) {\r\n                a.beginPath(), a.font = this.font;\r\n                var c = a.measureText(b).width, d = a.measureText("田").width;\r\n                a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                var e = this.getTextPostion(this.textPosition, c, d);\r\n                a.fillText(b, e.x, e.y), a.closePath()\r\n            }\r\n        }, this.getTextPostion = function (a, b, c) {\r\n            var d = null;\r\n            return null == a || "Bottom_Center" == a ? d = {x: this.x + this.width / 2 - b / 2, y: this.y + this.height + c} : "Top_Center" == a ? d = {\r\n                x: this.x + this.width / 2 - b / 2,\r\n                y: this.y - c / 2\r\n            } : "Top_Right" == a ? d = {x: this.x + this.width - b, y: this.y - c / 2} : "Top_Left" == a ? d = {x: this.x, y: this.y - c / 2} : "Bottom_Right" == a ? d = {\r\n                x: this.x + this.width - b,\r\n                y: this.y + this.height + c\r\n            } : "Bottom_Left" == a ? d = {x: this.x, y: this.y + this.height + c} : "Middle_Center" == a ? d = {\r\n                x: this.x + this.width / 2 - b / 2,\r\n                y: this.y + this.height / 2 + c / 2\r\n            } : "Middle_Right" == a ? d = {x: this.x + this.width - b, y: this.y + this.height / 2 + c / 2} : "Middle_Left" == a && (d = {\r\n                x: this.x,\r\n                y: this.y + this.height / 2 + c / 2\r\n            }), null != this.textOffsetX && (d.x += this.textOffsetX), null != this.textOffsetY && (d.y += this.textOffsetY), d\r\n        }, this.paintMouseover = function () {\r\n        }, this.paintSelected = function (a) {\r\n            a.shadowBlur = 10, a.shadowColor = "rgba(0,0,0,1)", a.shadowOffsetX = 0, a.shadowOffsetY = 0\r\n        }\r\n    }\r\n\r\n    b.prototype = new a.InteractiveElement, a.Container = b\r\n}(JTopo), function (a) {\r\n    function b(a) {\r\n        var b = 0, c = 0;\r\n        a.forEach(function (a) {\r\n            b += a.cx, c += a.cy\r\n        });\r\n        var d = {x: b / a.length, y: c / a.length};\r\n        return d\r\n    }\r\n\r\n    function c(c, d) {\r\n        null == d && (d = {});\r\n        {\r\n            var e = d.cx, f = d.cy, g = d.minRadius, h = d.nodeDiameter, i = d.hScale || 1, j = d.vScale || 1;\r\n            d.beginAngle || 0, d.endAngle || 2 * Math.PI\r\n        }\r\n        if (null == e || null == f) {\r\n            var k = b(c);\r\n            e = k.x, f = k.y\r\n        }\r\n        var l = 0, m = [], n = [];\r\n        c.forEach(function (a) {\r\n            null == d.nodeDiameter ? (a.diameter && (h = a.diameter), h = a.radius ? 2 * a.radius : Math.sqrt(2 * a.width * a.height), n.push(h)) : n.push(h), l += h\r\n        }), c.forEach(function (a, b) {\r\n            var c = n[b] / l;\r\n            m.push(Math.PI * c)\r\n        });\r\n        var o = (c.length, m[0] + m[1]), p = n[0] / 2 + n[1] / 2, q = p / 2 / Math.sin(o / 2);\r\n        null != g && g > q && (q = g);\r\n        var r = q * i, s = q * j, t = d.animate;\r\n        if (t) {\r\n            var u = t.time || 1e3, v = 0;\r\n            c.forEach(function (b, c) {\r\n                v += 0 == c ? m[c] : m[c - 1] + m[c];\r\n                var d = e + Math.cos(v) * r, g = f + Math.sin(v) * s;\r\n                a.Animate.stepByStep(b, {x: d - b.width / 2, y: g - b.height / 2}, u).start()\r\n            })\r\n        } else {\r\n            var v = 0;\r\n            c.forEach(function (a, b) {\r\n                v += 0 == b ? m[b] : m[b - 1] + m[b];\r\n                var c = e + Math.cos(v) * r, d = f + Math.sin(v) * s;\r\n                a.cx = c, a.cy = d\r\n            })\r\n        }\r\n        return {cx: e, cy: f, radius: r, radiusA: r, radiusB: s}\r\n    }\r\n\r\n    function d(a, b) {\r\n        return function (c) {\r\n            var d = c.childs;\r\n            if (!(d.length <= 0))for (var e = c.getBound(), f = d[0], g = (e.width - f.width) / b, h = (e.height - f.height) / a, i = (d.length, 0), j = 0; a > j; j++)for (var k = 0; b > k; k++) {\r\n                var l = d[i++], m = e.left + g / 2 + k * g, n = e.top + h / 2 + j * h;\r\n                if (l.setLocation(m, n), i >= d.length)return\r\n            }\r\n        }\r\n    }\r\n\r\n    function e(a, b) {\r\n        return null == a && (a = 0), null == b && (b = 0), function (c) {\r\n            var d = c.childs;\r\n            if (!(d.length <= 0))for (var e = c.getBound(), f = e.left, g = e.top, h = 0; h < d.length; h++) {\r\n                var i = d[h];\r\n                f + i.width >= e.right && (f = e.left, g += b + i.height), i.setLocation(f, g), f += a + i.width\r\n            }\r\n        }\r\n    }\r\n\r\n    function f() {\r\n        return function (a, b) {\r\n            if (b.length > 0) {\r\n                for (var c = 1e7, d = -1e7, e = 1e7, f = -1e7, g = d - c, h = f - e, i = 0; i < b.length; i++) {\r\n                    var j = b[i];\r\n                    j.x <= c && (c = j.x), j.x >= d && (d = j.x), j.y <= e && (e = j.y), j.y >= f && (f = j.y), g = d - c + j.width, h = f - e + j.height\r\n                }\r\n                a.x = c, a.y = e, a.width = g, a.height = h\r\n            }\r\n        }\r\n    }\r\n\r\n    function g(b) {\r\n        var c = [], d = b.filter(function (b) {\r\n            return b instanceof a.Link ? !0 : (c.push(b), !1)\r\n        });\r\n        return b = c.filter(function (a) {\r\n            for (var b = 0; b < d.length; b++)if (d[b].nodeZ === a)return !1;\r\n            return !0\r\n        }), b = b.filter(function (a) {\r\n            for (var b = 0; b < d.length; b++)if (d[b].nodeA === a)return !0;\r\n            return !1\r\n        })\r\n    }\r\n\r\n    function h(a) {\r\n        var b = 0, c = 0;\r\n        return a.forEach(function (a) {\r\n            b += a.width, c += a.height\r\n        }), {width: b / a.length, height: c / a.length}\r\n    }\r\n\r\n    function i(a, b, c, d) {\r\n        b.x += c, b.y += d;\r\n        for (var e = q(a, b), f = 0; f < e.length; f++)i(a, e[f], c, d)\r\n    }\r\n\r\n    function j(a, b) {\r\n        function c(b, e) {\r\n            var f = q(a, b);\r\n            null == d[e] && (d[e] = {}, d[e].nodes = [], d[e].childs = []), d[e].nodes.push(b), d[e].childs.push(f);\r\n            for (var g = 0; g < f.length; g++)c(f[g], e + 1), f[g].parent = b\r\n        }\r\n\r\n        var d = [];\r\n        return c(b, 0), d\r\n    }\r\n\r\n    function k(b, c, d) {\r\n        return function (e) {\r\n            function f(f, g) {\r\n                for (var h = a.layout.getTreeDeep(f, g), k = j(f, g), l = k["" + h].nodes, m = 0; m < l.length; m++) {\r\n                    var n = l[m], o = (m + 1) * (c + 10), p = h * d;\r\n                    "down" == b || ("up" == b ? p = -p : "left" == b ? (o = -h * d, p = (m + 1) * (c + 10)) : "right" == b && (o = h * d, p = (m + 1) * (c + 10))), n.setLocation(o, p)\r\n                }\r\n                for (var q = h - 1; q >= 0; q--)for (var r = k["" + q].nodes, s = k["" + q].childs, m = 0; m < r.length; m++) {\r\n                    var t = r[m], u = s[m];\r\n                    if ("down" == b ? t.y = q * d : "up" == b ? t.y = -q * d : "left" == b ? t.x = -q * d : "right" == b && (t.x = q * d), u.length > 0 ? "down" == b || "up" == b ? t.x = (u[0].x + u[u.length - 1].x) / 2 : ("left" == b || "right" == b) && (t.y = (u[0].y + u[u.length - 1].y) / 2) : m > 0 && ("down" == b || "up" == b ? t.x = r[m - 1].x + r[m - 1].width + c : ("left" == b || "right" == b) && (t.y = r[m - 1].y + r[m - 1].height + c)), m > 0)if ("down" == b || "up" == b) {\r\n                        if (t.x < r[m - 1].x + r[m - 1].width)for (var v = r[m - 1].x + r[m - 1].width + c, w = Math.abs(v - t.x), x = m; x < r.length; x++)i(e.childs, r[x], w, 0)\r\n                    } else if (("left" == b || "right" == b) && t.y < r[m - 1].y + r[m - 1].height)for (var y = r[m - 1].y + r[m - 1].height + c, z = Math.abs(y - t.y), x = m; x < r.length; x++)i(e.childs, r[x], 0, z)\r\n                }\r\n            }\r\n\r\n            var g = null;\r\n            null == c && (g = h(e.childs), c = g.width, ("left" == b || "right" == b) && (c = g.width + 10)), null == d && (null == g && (g = h(e.childs)), d = 2 * g.height), null == b && (b = "down");\r\n            var k = a.layout.getRootNodes(e.childs);\r\n            if (k.length > 0) {\r\n                f(e.childs, k[0]);\r\n                var l = a.util.getElementsBound(e.childs), m = e.getCenterLocation(), n = m.x - (l.left + l.right) / 2, o = m.y - (l.top + l.bottom) / 2;\r\n                e.childs.forEach(function (b) {\r\n                    b instanceof a.Node && (b.x += n, b.y += o)\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    function l(b) {\r\n        return function (c) {\r\n            function d(a, c, e) {\r\n                var f = q(a, c);\r\n                if (0 != f.length) {\r\n                    null == e && (e = b);\r\n                    var g = 2 * Math.PI / f.length;\r\n                    f.forEach(function (b, f) {\r\n                        var h = c.x + e * Math.cos(g * f), i = c.y + e * Math.sin(g * f);\r\n                        b.setLocation(h, i);\r\n                        var j = e / 2;\r\n                        d(a, b, j)\r\n                    })\r\n                }\r\n            }\r\n\r\n            var e = a.layout.getRootNodes(c.childs);\r\n            if (e.length > 0) {\r\n                d(c.childs, e[0]);\r\n                var f = a.util.getElementsBound(c.childs), g = c.getCenterLocation(), h = g.x - (f.left + f.right) / 2, i = g.y - (f.top + f.bottom) / 2;\r\n                c.childs.forEach(function (b) {\r\n                    b instanceof a.Node && (b.x += h, b.y += i)\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    function m(a, b, c, d, e, f) {\r\n        for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n        return g\r\n    }\r\n\r\n    function n(a, b, c, d, e, f) {\r\n        var g = e ? e : 0, h = f ? f : 2 * Math.PI, i = h - g, j = i / c, k = [];\r\n        g += j / 2;\r\n        for (var l = g; h >= l; l += j) {\r\n            var m = a + Math.cos(l) * d, n = b + Math.sin(l) * d;\r\n            k.push({x: m, y: n})\r\n        }\r\n        return k\r\n    }\r\n\r\n    function o(a, b, c, d, e, f) {\r\n        var g = f || "bottom", h = [];\r\n        if ("bottom" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b + e\r\n        }); else if ("top" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b - e\r\n        }); else if ("right" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: a + e,\r\n            y: i + j * d\r\n        }); else if ("left" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({x: a - e, y: i + j * d});\r\n        return h\r\n    }\r\n\r\n    function m(a, b, c, d, e, f) {\r\n        for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n        return g\r\n    }\r\n\r\n    function p(a, b) {\r\n        if (a.layout) {\r\n            var c = a.layout, d = c.type, e = null;\r\n            if ("circle" == d) {\r\n                var f = c.radius || Math.max(a.width, a.height);\r\n                e = n(a.cx, a.cy, b.length, f, a.layout.beginAngle, a.layout.endAngle)\r\n            } else if ("tree" == d) {\r\n                var g = c.width || 50, h = c.height || 50, i = c.direction;\r\n                e = o(a.cx, a.cy, b.length, g, h, i)\r\n            } else {\r\n                if ("grid" != d)return;\r\n                e = m(a.x, a.y, c.rows, c.cols, c.horizontal || 0, c.vertical || 0)\r\n            }\r\n            for (var j = 0; j < b.length; j++)b[j].setCenterLocation(e[j].x, e[j].y)\r\n        }\r\n    }\r\n\r\n    function q(b, c) {\r\n        for (var d = [], e = 0; e < b.length; e++)b[e] instanceof a.Link && b[e].nodeA === c && d.push(b[e].nodeZ);\r\n        return d\r\n    }\r\n\r\n    function r(a, b, c) {\r\n        var d = q(a.childs, b);\r\n        if (0 == d.length)return null;\r\n        if (p(b, d), 1 == c)for (var e = 0; e < d.length; e++)r(a, d[e], c);\r\n        return null\r\n    }\r\n\r\n    function s(b, c) {\r\n        function d(a, b) {\r\n            var c = a.x - b.x, d = a.y - b.y;\r\n            i += c * f, j += d * f, i *= g, j *= g, j += h, b.x += i, b.y += j\r\n        }\r\n\r\n        function e() {\r\n            if (!(++k > 150)) {\r\n                for (var a = 0; a < l.length; a++)l[a] != b && d(b, l[a], l);\r\n                setTimeout(e, 1e3 / 24)\r\n            }\r\n        }\r\n\r\n        var f = .01, g = .95, h = -5, i = 0, j = 0, k = 0, l = c.getElementsByClass(a.Node);\r\n        e()\r\n    }\r\n\r\n    function t(a, b) {\r\n        function c(a, b, e) {\r\n            var f = q(a, b);\r\n            e > d && (d = e);\r\n            for (var g = 0; g < f.length; g++)c(a, f[g], e + 1)\r\n        }\r\n\r\n        var d = 0;\r\n        return c(a, b, 0), d\r\n    }\r\n\r\n    a.layout = a.Layout = {\r\n        layoutNode: r,\r\n        getNodeChilds: q,\r\n        adjustPosition: p,\r\n        springLayout: s,\r\n        getTreeDeep: t,\r\n        getRootNodes: g,\r\n        GridLayout: d,\r\n        FlowLayout: e,\r\n        AutoBoundLayout: f,\r\n        CircleLayout: l,\r\n        TreeLayout: k,\r\n        getNodesCenter: b,\r\n        circleLayoutNodes: c\r\n    }\r\n}(JTopo), function (a) {\r\n    function b() {\r\n        var b = new a.CircleNode;\r\n        return b.radius = 150, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n            var c = 2 * b.radius, d = 2 * b.radius;\r\n            b.width = c, b.height = d;\r\n            for (var e = 0, f = 0; f < this.datas.length; f++) {\r\n                var g = this.datas[f] * Math.PI * 2;\r\n                a.save(), a.beginPath(), a.fillStyle = b.colors[f], a.moveTo(0, 0), a.arc(0, 0, this.radius, e, e + g, !1), a.fill(), a.closePath(), a.restore(), a.beginPath(), a.font = this.font;\r\n                var h = this.titles[f] + ": " + (100 * this.datas[f]).toFixed(2) + "%", i = a.measureText(h).width, j = (a.measureText("田").width, (e + e + g) / 2), k = this.radius * Math.cos(j), l = this.radius * Math.sin(j);\r\n                j > Math.PI / 2 && j <= Math.PI ? k -= i : j > Math.PI && j < 2 * Math.PI * 3 / 4 ? k -= i : j > 2 * Math.PI * .75, a.fillStyle = "#FFFFFF", a.fillText(h, k, l), a.moveTo(this.radius * Math.cos(j), this.radius * Math.sin(j)), j > Math.PI / 2 && j < 2 * Math.PI * 3 / 4 && (k -= i), j > Math.PI, a.fill(), a.stroke(), a.closePath(), e += g\r\n            }\r\n        }, b\r\n    }\r\n\r\n    function c() {\r\n        var b = new a.Node;\r\n        return b.showSelected = !1, b.width = 250, b.height = 180, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n            var c = 3, d = (this.width - c) / this.datas.length;\r\n            a.save(), a.beginPath(), a.fillStyle = "#FFFFFF", a.strokeStyle = "#FFFFFF", a.moveTo(-this.width / 2 - 1, -this.height / 2), a.lineTo(-this.width / 2 - 1, this.height / 2 + 3), a.lineTo(this.width / 2 + c + 1, this.height / 2 + 3), a.stroke(), a.closePath(), a.restore();\r\n            for (var e = 0; e < this.datas.length; e++) {\r\n                a.save(), a.beginPath(), a.fillStyle = b.colors[e];\r\n                var f = this.datas[e], g = e * (d + c) - this.width / 2, h = this.height - f - this.height / 2;\r\n                a.fillRect(g, h, d, f);\r\n                var i = "" + parseInt(this.datas[e]), j = a.measureText(i).width, k = a.measureText("田").width;\r\n                a.fillStyle = "#FFFFFF", a.fillText(i, g + (d - j) / 2, h - k), a.fillText(this.titles[e], g + (d - j) / 2, this.height / 2 + k), a.fill(), a.closePath(), a.restore()\r\n            }\r\n        }, b\r\n    }\r\n\r\n    a.BarChartNode = c, a.PieChartNode = b\r\n}(JTopo), function (a) {\r\n    function b(b, c) {\r\n        var d, e = null;\r\n        return {\r\n            stop: function () {\r\n                return d ? (window.clearInterval(d), e && e.publish("stop"), this) : this\r\n            }, start: function () {\r\n                var a = this;\r\n                return d = setInterval(function () {\r\n                    b.call(a)\r\n                }, c), this\r\n            }, onStop: function (b) {\r\n                return null == e && (e = new a.util.MessageBus), e.subscribe("stop", b), this\r\n            }\r\n        }\r\n    }\r\n\r\n    function c(a, c) {\r\n        c = c || {};\r\n        var d = c.gravity || .1, e = c.dx || 0, f = c.dy || 5, g = c.stop, h = c.interval || 30, i = new b(function () {\r\n            g && g() ? (f = .5, this.stop()) : (f += d, a.setLocation(a.x + e, a.y + f))\r\n        }, h);\r\n        return i\r\n    }\r\n\r\n    function d(a, c, d, e, f) {\r\n        var g = 1e3 / 24, h = {};\r\n        for (var i in c) {\r\n            var j = c[i], k = j - a[i];\r\n            h[i] = {\r\n                oldValue: a[i], targetValue: j, step: k / d * g, isDone: function (b) {\r\n                    var c = this.step > 0 && a[b] >= this.targetValue || this.step < 0 && a[b] <= this.targetValue;\r\n                    return c\r\n                }\r\n            }\r\n        }\r\n        var l = new b(function () {\r\n            var b = !0;\r\n            for (var d in c)h[d].isDone(d) || (a[d] += h[d].step, b = !1);\r\n            if (b) {\r\n                if (!e)return this.stop();\r\n                for (var d in c)if (f) {\r\n                    var g = h[d].targetValue;\r\n                    h[d].targetValue = h[d].oldValue, h[d].oldValue = g, h[d].step = -h[d].step\r\n                } else a[d] = h[d].oldValue\r\n            }\r\n            return this\r\n        }, g);\r\n        return l\r\n    }\r\n\r\n    function e(a) {\r\n        null == a && (a = {});\r\n        var b = a.spring || .1, c = a.friction || .8, d = a.grivity || 0, e = (a.wind || 0, a.minLength || 0);\r\n        return {\r\n            items: [], timer: null, isPause: !1, addNode: function (a, b) {\r\n                var c = {node: a, target: b, vx: 0, vy: 0};\r\n                return this.items.push(c), this\r\n            }, play: function (a) {\r\n                this.stop(), a = null == a ? 1e3 / 24 : a;\r\n                var b = this;\r\n                this.timer = setInterval(function () {\r\n                    b.nextFrame()\r\n                }, a)\r\n            }, stop: function () {\r\n                null != this.timer && window.clearInterval(this.timer)\r\n            }, nextFrame: function () {\r\n                for (var a = 0; a < this.items.length; a++) {\r\n                    var f = this.items[a], g = f.node, h = f.target, i = f.vx, j = f.vy, k = h.x - g.x, l = h.y - g.y, m = Math.atan2(l, k);\r\n                    if (0 != e) {\r\n                        var n = h.x - Math.cos(m) * e, o = h.y - Math.sin(m) * e;\r\n                        i += (n - g.x) * b, j += (o - g.y) * b\r\n                    } else i += k * b, j += l * b;\r\n                    i *= c, j *= c, j += d, g.x += i, g.y += j, f.vx = i, f.vy = j\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function f(a, b) {\r\n        function c() {\r\n            return e = setInterval(function () {\r\n                return o ? void f.stop() : (a.rotate += g || .2, void(a.rotate > 2 * Math.PI && (a.rotate = 0)))\r\n            }, 100), f\r\n        }\r\n\r\n        function d() {\r\n            return window.clearInterval(e), f.onStop && f.onStop(a), f\r\n        }\r\n\r\n        var e = (b.context, null), f = {}, g = b.v;\r\n        return f.run = c, f.stop = d, f.onStop = function (a) {\r\n            return f.onStop = a, f\r\n        }, f\r\n    }\r\n\r\n    function g(a, b) {\r\n        function c() {\r\n            return window.clearInterval(g), h.onStop && h.onStop(a), h\r\n        }\r\n\r\n        function d() {\r\n            var d = b.dx || 0, i = b.dy || 2;\r\n            return g = setInterval(function () {\r\n                return o ? void h.stop() : (i += f, void(a.y + a.height < e.stage.canvas.height ? a.setLocation(a.x + d, a.y + i) : (i = 0, c())))\r\n            }, 20), h\r\n        }\r\n\r\n        var e = b.context, f = b.gravity || .1, g = null, h = {};\r\n        return h.run = d, h.stop = c, h.onStop = function (a) {\r\n            return h.onStop = a, h\r\n        }, h\r\n    }\r\n\r\n    function h(b, c) {\r\n        function d(c, d, e, f, g) {\r\n            var h = new a.Node;\r\n            return h.setImage(b.image), h.setSize(b.width, b.height), h.setLocation(c, d), h.showSelected = !1, h.dragable = !1, h.paint = function (a) {\r\n                a.save(), a.arc(0, 0, e, f, g), a.clip(), a.beginPath(), null != this.image ? a.drawImage(this.image, -this.width / 2, -this.height / 2) : (a.fillStyle = "rgba(" + this.style.fillStyle + "," + this.alpha + ")", a.rect(-this.width / 2, -this.height / 2, this.width / 2, this.height / 2), a.fill()), a.closePath(), a.restore()\r\n            }, h\r\n        }\r\n\r\n        function e(c, e) {\r\n            var f = c, g = c + Math.PI, h = d(b.x, b.y, b.width, f, g), j = d(b.x - 2 + 4 * Math.random(), b.y, b.width, f + Math.PI, f);\r\n            b.visible = !1, e.add(h), e.add(j), a.Animate.gravity(h, {context: e, dx: .3}).run().onStop(function () {\r\n                e.remove(h), e.remove(j), i.stop()\r\n            }), a.Animate.gravity(j, {context: e, dx: -.2}).run()\r\n        }\r\n\r\n        function f() {\r\n            return e(c.angle, h), i\r\n        }\r\n\r\n        function g() {\r\n            return i.onStop && i.onStop(b), i\r\n        }\r\n\r\n        var h = c.context, i = (b.style, {});\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = f, i.stop = g, i\r\n    }\r\n\r\n    function i(a, b) {\r\n        function c(a) {\r\n            a.visible = !0, a.rotate = Math.random();\r\n            var b = g.stage.canvas.width / 2;\r\n            a.x = b + Math.random() * (b - 100) - Math.random() * (b - 100), a.y = g.stage.canvas.height, a.vx = 5 * Math.random() - 5 * Math.random(), a.vy = -25\r\n        }\r\n\r\n        function d() {\r\n            return c(a), h = setInterval(function () {\r\n                return o ? void i.stop() : (a.vy += f, a.x += a.vx, a.y += a.vy, void((a.x < 0 || a.x > g.stage.canvas.width || a.y > g.stage.canvas.height) && (i.onStop && i.onStop(a), c(a))))\r\n            }, 50), i\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(h)\r\n        }\r\n\r\n        var f = .8, g = b.context, h = null, i = {};\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = d, i.stop = e, i\r\n    }\r\n\r\n    function j() {\r\n        o = !0\r\n    }\r\n\r\n    function k() {\r\n        o = !1\r\n    }\r\n\r\n    function l(b, c) {\r\n        function d() {\r\n            return n = setInterval(function () {\r\n                if (o)return void m.stop();\r\n                var a = f.y + h + Math.sin(k) * j;\r\n                b.setLocation(b.x, a), k += l\r\n            }, 100), m\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(n)\r\n        }\r\n\r\n        var f = c.p1, g = c.p2, h = (c.context, f.x + (g.x - f.x) / 2), i = f.y + (g.y - f.y) / 2, j = a.util.getDistance(f, g) / 2, k = Math.atan2(i, h), l = c.speed || .2, m = {}, n = null;\r\n        return m.run = d, m.stop = e, m\r\n    }\r\n\r\n    function m(a, b) {\r\n        function c() {\r\n            return h = setInterval(function () {\r\n                if (o)return void g.stop();\r\n                var b = e.x - a.x, c = e.y - a.y, h = b * f, i = c * f;\r\n                a.x += h, a.y += i, .01 > h && .1 > i && d()\r\n            }, 100), g\r\n        }\r\n\r\n        function d() {\r\n            window.clearInterval(h)\r\n        }\r\n\r\n        var e = b.position, f = (b.context, b.easing || .2), g = {}, h = null;\r\n        return g.onStop = function (a) {\r\n            return g.onStop = a, g\r\n        }, g.run = c, g.stop = d, g\r\n    }\r\n\r\n    function n(a, b) {\r\n        function c() {\r\n            return j = setInterval(function () {\r\n                a.scaleX += f, a.scaleY += f, a.scaleX >= e && d()\r\n            }, 100), i\r\n        }\r\n\r\n        function d() {\r\n            i.onStop && i.onStop(a), a.scaleX = g, a.scaleY = h, window.clearInterval(j)\r\n        }\r\n\r\n        var e = (b.position, b.context, b.scale || 1), f = .06, g = a.scaleX, h = a.scaleY, i = {}, j = null;\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = c, i.stop = d, i\r\n    }\r\n\r\n    a.Animate = {}, a.Effect = {};\r\n    var o = !1;\r\n    a.Effect.spring = e, a.Effect.gravity = c, a.Animate.stepByStep = d, a.Animate.rotate = f, a.Animate.scale = n, a.Animate.move = m, a.Animate.cycle = l, a.Animate.repeatThrow = i, a.Animate.dividedTwoPiece = h, a.Animate.gravity = g, a.Animate.startAll = k, a.Animate.stopAll = j\r\n}(JTopo), function (a) {\r\n    function b(a, b) {\r\n        var c = [];\r\n        if (0 == a.length)return c;\r\n        var d = b.match(/^\\s*(\\w+)\\s*$/);\r\n        if (null != d) {\r\n            var e = a.filter(function (a) {\r\n                return a.elementType == d[1]\r\n            });\r\n            null != e && e.length > 0 && (c = c.concat(e))\r\n        } else {\r\n            var f = !1;\r\n            if (d = b.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*[\'"](\\S+)[\'"]\\s*\\]\\s*/), (null == d || d.length < 5) && (d = b.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*(\\d+(\\.\\d+)?)\\s*\\]\\s*/), f = !0), null != d && d.length >= 5) {\r\n                var g = d[1], h = d[2], i = d[3], j = d[4];\r\n                e = a.filter(function (a) {\r\n                    if (a.elementType != g)return !1;\r\n                    var b = a[h];\r\n                    return 1 == f && (b = parseInt(b)), "=" == i ? b == j : ">" == i ? b > j : "<" == i ? j > b : "<=" == i ? j >= b : ">=" == i ? b >= j : "!=" == i ? b != j : !1\r\n                }), null != e && e.length > 0 && (c = c.concat(e))\r\n            }\r\n        }\r\n        return c\r\n    }\r\n\r\n    function c(a) {\r\n        if (a.find = function (a) {\r\n                return d.call(this, a)\r\n            }, e.forEach(function (b) {\r\n                a[b] = function (a) {\r\n                    for (var c = 0; c < this.length; c++)this[c][b](a);\r\n                    return this\r\n                }\r\n            }), a.length > 0) {\r\n            var b = a[0];\r\n            for (var c in b) {\r\n                var f = b[c];\r\n                "function" == typeof f && !function (b) {\r\n                    a[c] = function () {\r\n                        for (var c = [], d = 0; d < a.length; d++)c.push(b.apply(a[d], arguments));\r\n                        return c\r\n                    }\r\n                }(f)\r\n            }\r\n        }\r\n        return a.attr = function (a, b) {\r\n            if (null != a && null != b)for (var c = 0; c < this.length; c++)this[c][a] = b; else {\r\n                if (null != a && "string" == typeof a) {\r\n                    for (var d = [], c = 0; c < this.length; c++)d.push(this[c][a]);\r\n                    return d\r\n                }\r\n                if (null != a)for (var c = 0; c < this.length; c++)for (var e in a)this[c][e] = a[e]\r\n            }\r\n            return this\r\n        }, a\r\n    }\r\n\r\n    function d(d) {\r\n        var e = [], f = [];\r\n        this instanceof a.Stage ? (e = this.childs, f = f.concat(e)) : this instanceof a.Scene ? e = [this] : f = this, e.forEach(function (a) {\r\n            f = f.concat(a.childs)\r\n        });\r\n        var g = null;\r\n        return g = "function" == typeof d ? f.filter(d) : b(f, d), g = c(g)\r\n    }\r\n\r\n    var e = "click,mousedown,mouseup,mouseover,mouseout,mousedrag,keydown,keyup".split(",");\r\n    a.Stage.prototype.find = d, a.Scene.prototype.find = d\r\n}(JTopo), function (a) {\r\n    function b(a, b) {\r\n        this.x = a, this.y = b\r\n    }\r\n\r\n    function c(a) {\r\n        this.p = new b(0, 0), this.w = new b(1, 0), this.paint = a\r\n    }\r\n\r\n    function d(a, b, c) {\r\n        return function (d) {\r\n            for (var e = 0; b > e; e++)a(), c && d.turn(c), d.move(3)\r\n        }\r\n    }\r\n\r\n    function e(a, b) {\r\n        var c = 2 * Math.PI;\r\n        return function (d) {\r\n            for (var e = 0; b > e; e++)a(), d.turn(c / b)\r\n        }\r\n    }\r\n\r\n    function f(a, b, c) {\r\n        return function (d) {\r\n            for (var e = 0; b > e; e++)a(), d.resize(c)\r\n        }\r\n    }\r\n\r\n    function g(a) {\r\n        var b = 2 * Math.PI;\r\n        return function (c) {\r\n            for (var d = 0; a > d; d++)c.forward(1), c.turn(b / a)\r\n        }\r\n    }\r\n\r\n    function h(a) {\r\n        var b = 4 * Math.PI;\r\n        return function (c) {\r\n            for (var d = 0; a > d; d++)c.forward(1), c.turn(b / a)\r\n        }\r\n    }\r\n\r\n    function i(a, b, c, d) {\r\n        return function (e) {\r\n            for (var f = 0; b > f; f++)a(), e.forward(1), e.turn(c), e.resize(d)\r\n        }\r\n    }\r\n\r\n    var j = {};\r\n    c.prototype.forward = function (a) {\r\n        var b = this.p, c = this.w;\r\n        return b.x = b.x + a * c.x, b.y = b.y + a * c.y, this.paint && this.paint(b.x, b.y), this\r\n    }, c.prototype.move = function (a) {\r\n        var b = this.p, c = this.w;\r\n        return b.x = b.x + a * c.x, b.y = b.y + a * c.y, this\r\n    }, c.prototype.moveTo = function (a, b) {\r\n        return this.p.x = a, this.p.y = b, this\r\n    }, c.prototype.turn = function (a) {\r\n        var b = (this.p, this.w), c = Math.cos(a) * b.x - Math.sin(a) * b.y, d = Math.sin(a) * b.x + Math.cos(a) * b.y;\r\n        return b.x = c, b.y = d, this\r\n    }, c.prototype.resize = function (a) {\r\n        var b = this.w;\r\n        return b.x = b.x * a, b.y = b.y * a, this\r\n    }, c.prototype.save = function () {\r\n        return null == this._stack && (this._stack = []), this._stack.push([this.p, this.w]), this\r\n    }, c.prototype.restore = function () {\r\n        if (null != this._stack && this._stack.length > 0) {\r\n            var a = this._stack.pop();\r\n            this.p = a[0], this.w = a[1]\r\n        }\r\n        return this\r\n    }, j.Tortoise = c, j.shift = d, j.spin = e, j.polygon = g, j.spiral = i, j.star = h, j.scale = f, a.Logo = j\r\n}(window);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vanRvcG8tbWluLmpzPzM0OWEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsU0FBUztBQUNULFNBQVM7QUFDVCxtREFBbUQ7QUFDbkQ7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVCxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsYUFBYSxVQUFVO0FBQ3ZCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsT0FBTztBQUM5QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBK0Q7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSx5Q0FBeUMsY0FBYztBQUN2RDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0JBQXNCLGlHQUFpRyxRQUFRLGNBQWM7QUFDN0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7O0FBRUE7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCLGNBQWM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtRUFBbUUsMENBQTBDLG1CQUFtQjtBQUNoSTtBQUNBLDhFQUE4RSwyQkFBMkIsc0NBQXNDLHFCQUFxQjtBQUNwSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsNlZBQTZWO0FBQzdWO0FBQ0EsdUJBQXVCLHFCQUFxQjtBQUM1QztBQUNBLG1CQUFtQjtBQUNuQiwyQkFBMkIscUJBQXFCO0FBQ2hEO0FBQ0EsNENBQTRDLG9DQUFvQztBQUNoRjtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBLGdDQUFnQztBQUNoQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsT0FBTyxvQkFBb0IsT0FBTztBQUNsSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQSx1WEFBdVgsMkVBQTJFO0FBQ2xjLGdCQUFnQjtBQUNoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLHVCQUF1QixpQkFBaUI7QUFDeEM7QUFDQSxLQUFLO0FBQ0w7QUFDQSxTQUFTO0FBQ1QsU0FBUztBQUNULFNBQVM7QUFDVCxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDRCQUE0QjtBQUM1Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1QsMkJBQTJCLHdCQUF3QjtBQUNuRDtBQUNBLFNBQVM7QUFDVDtBQUNBLDJCQUEyQix3QkFBd0I7QUFDbkQ7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVCxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EscUtBQXFLO0FBQ3JLO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsbUNBQW1DLDZCQUE2QixvRUFBb0UsY0FBYztBQUNsSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxtQ0FBbUMsd0JBQXdCO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULDJCQUEyQiw2QkFBNkIsb0VBQW9FLGNBQWM7QUFDMUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHVFQUF1RTtBQUN2RTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsMkJBQTJCLGNBQWM7QUFDekMsU0FBUztBQUNULG1DQUFtQyx3QkFBd0I7QUFDM0Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsK0RBQStELFFBQVEsK0VBQStFLFFBQVE7QUFDOUo7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsMkJBQTJCLGtDQUFrQztBQUM3RDtBQUNBLFNBQVM7QUFDVCwyQkFBMkIsa0NBQWtDO0FBQzdEO0FBQ0EsU0FBUztBQUNULDJCQUEyQixrQ0FBa0M7QUFDN0Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLHVLQUF1SztBQUN2SztBQUNBLCtCQUErQixrQ0FBa0M7QUFDakU7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0EsbVZBQW1WO0FBQ25WO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxnR0FBZ0csa0NBQWtDO0FBQ2xJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxpREFBaUQscUJBQXFCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Qsb0JBQW9CO0FBQ3BCLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxvQkFBb0I7QUFDcEIsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxvQkFBb0I7QUFDcEIsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNULG9CQUFvQjtBQUNwQixTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Qsb0JBQW9CO0FBQ3BCLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxvQkFBb0I7QUFDcEIsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNULG9CQUFvQjtBQUNwQixTQUFTO0FBQ1Qsb0JBQW9CO0FBQ3BCLFNBQVM7QUFDVDtBQUNBLDBDQUEwQyxvQkFBb0IsNEJBQTRCLHFCQUFxQiwyQkFBMkIscUJBQXFCO0FBQy9KO0FBQ0E7QUFDQSxhQUFhLCtCQUErQix1QkFBdUIsOEJBQThCLHVCQUF1QjtBQUN4SDtBQUNBO0FBQ0EsYUFBYSwrQkFBK0Isd0JBQXdCLGdDQUFnQyx3QkFBd0I7QUFDNUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNULHlEQUF5RDtBQUN6RCxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxvQkFBb0I7QUFDcEIsU0FBUztBQUNULHFGQUFxRix1Q0FBdUM7QUFDNUgsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixjQUFjO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULDZFQUE2RSxjQUFjO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsNERBQTRELGtFQUFrRTtBQUM5SDtBQUNBO0FBQ0EsYUFBYSwyQkFBMkIsK0NBQStDO0FBQ3ZGO0FBQ0E7QUFDQSxhQUFhLDhCQUE4QiwwQ0FBMEM7QUFDckY7QUFDQTtBQUNBLGFBQWEsK0JBQStCLG9EQUFvRDtBQUNoRztBQUNBO0FBQ0EsYUFBYSwrQkFBK0IsaUNBQWlDO0FBQzdFLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxpREFBaUQsY0FBYztBQUMvRCxTQUFTO0FBQ1Q7QUFDQSxpREFBaUQsY0FBYztBQUMvRCxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsdUJBQXVCLHVDQUF1QyxzQkFBc0I7QUFDako7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVCxxQkFBcUI7QUFDckI7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxvR0FBb0csbUNBQW1DO0FBQ3ZJLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxtRkFBbUY7QUFDOUk7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLHdCQUF3Qix1RUFBdUUsT0FBTyx1RUFBdUU7QUFDN0s7QUFDQTtBQUNBLGFBQWEsV0FBVyxlQUFlLFdBQVcsZUFBZSxXQUFXLGVBQWU7QUFDM0YsU0FBUztBQUNUO0FBQ0E7QUFDQSwyQkFBMkIsY0FBYztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHFCQUFxQiwrQ0FBK0MsT0FBTztBQUMzRTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLHVHQUF1RyxXQUFXO0FBQ2xIO0FBQ0E7QUFDQSxtQ0FBbUMsc0JBQXNCO0FBQ3pEO0FBQ0EsK0NBQStDLFdBQVc7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHFCQUFxQjtBQUNyQjtBQUNBLFNBQVM7QUFDVCxxQkFBcUI7QUFDckI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsdUZBQXVGLGFBQWEsV0FBVyxXQUFXLFdBQVcsYUFBYTtBQUNsSjtBQUNBO0FBQ0EsYUFBYSxXQUFXLFdBQVcsV0FBVyxhQUFhO0FBQzNELFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxxQkFBcUI7QUFDckI7QUFDQSxTQUFTO0FBQ1QscUJBQXFCO0FBQ3JCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHdHQUF3RyxtQkFBbUIsV0FBVyx1QkFBdUI7QUFDN0o7QUFDQTtBQUNBLGFBQWEsV0FBVyxtQkFBbUIseURBQXlELG1CQUFtQixXQUFXLHVCQUF1QjtBQUN6SjtBQUNBO0FBQ0EsYUFBYSxXQUFXLG1CQUFtQjtBQUMzQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsMkJBQTJCLGNBQWM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCwyQkFBMkIsd0JBQXdCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsMkJBQTJCLHdCQUF3QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsNERBQTRELGdFQUFnRTtBQUM1SDtBQUNBO0FBQ0EsYUFBYSwyQkFBMkIsOENBQThDLDBCQUEwQiw2QkFBNkI7QUFDN0k7QUFDQTtBQUNBLGFBQWEsNkJBQTZCLHVDQUF1QztBQUNqRjtBQUNBO0FBQ0EsYUFBYSw4QkFBOEIsZ0VBQWdFO0FBQzNHO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNULFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsd0NBQXdDO0FBQ2pGLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGdCQUFnQjtBQUNoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwySkFBMkosT0FBTyxvQkFBb0IsT0FBTztBQUM3TDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHlGQUF5RixjQUFjO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMkZBQTJGLGNBQWM7QUFDekc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsMkJBQTJCLGNBQWM7QUFDekM7QUFDQSxTQUFTO0FBQ1QsMkJBQTJCLGNBQWM7QUFDekM7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLElBQUk7QUFDYjs7QUFFQTtBQUNBO0FBQ0Esb0NBQW9DLGNBQWM7QUFDbEQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDLDJCQUEyQixjQUFjO0FBQ3pDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpR0FBaUcsY0FBYztBQUMvRztBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsUUFBUSwrREFBK0QsY0FBYztBQUN4SDtBQUNBO0FBQ0EseUlBQXlJLGNBQWM7QUFDdkoscUJBQXFCLDBKQUEwSixjQUFjO0FBQzdMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQixPQUFPLG9CQUFvQixPQUFPLGFBQWEsMkJBQTJCO0FBQ3pHO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFFBQVE7QUFDL0I7QUFDQSxvQkFBb0IsV0FBVztBQUMvQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9FQUFvRSxRQUFRO0FBQzVFO0FBQ0E7QUFDQSxTQUFTLEVBQUUsK0RBQStELFFBQVE7QUFDbEY7QUFDQTtBQUNBLFNBQVMsRUFBRSxpRUFBaUUsUUFBUTtBQUNwRjtBQUNBO0FBQ0EsU0FBUyxFQUFFLGdFQUFnRSxRQUFRLGFBQWEsdUJBQXVCO0FBQ3ZIO0FBQ0E7O0FBRUE7QUFDQSwrQkFBK0IsT0FBTyxvQkFBb0IsT0FBTyxhQUFhLDJCQUEyQjtBQUN6RztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixjQUFjO0FBQ3pDO0FBQ0E7O0FBRUE7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxjQUFjO0FBQ3pEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0JBQStCLGNBQWM7QUFDN0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixjQUFjO0FBQ3pDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyx1QkFBdUI7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVCQUF1QjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2IsK0JBQStCLHVCQUF1QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0Esc0VBQXNFLG1CQUFtQjtBQUN6RjtBQUNBLGFBQWEseUJBQXlCLG9CQUFvQjtBQUMxRDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsb0xBQW9MO0FBQ3BMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxtRUFBbUU7QUFDbkU7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsa0dBQWtHO0FBQ2xHO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUEsa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsbUNBQW1DLGlCQUFpQjtBQUNwRDtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsY0FBYztBQUM3RDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxpQkFBaUIsb0JBQW9CO0FBQzNGO0FBQ0EsMkNBQTJDLGlCQUFpQjtBQUM1RDtBQUNBO0FBQ0EsNkNBQTZDLGlCQUFpQjtBQUM5RDtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDJCQUEyQixPQUFPO0FBQ2xDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLE9BQU87QUFDbEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMkJBQTJCLE9BQU87QUFDbEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsT0FBTztBQUNsQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixPQUFPO0FBQ2xDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDJCQUEyQixPQUFPO0FBQ2xDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDIiwiZmlsZSI6IjUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIhZnVuY3Rpb24gKHdpbmRvdykge1xyXG4gICAgZnVuY3Rpb24gRWxlbWVudCgpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImVsZW1lbnRcIiwgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IFtcImVsZW1lbnRUeXBlXCJdLCB0aGlzLnByb3BlcnRpZXNTdGFjayA9IFtdLCB0aGlzLl9pZCA9IFwiXCIgKyAobmV3IERhdGUpLmdldFRpbWUoKVxyXG4gICAgICAgIH0sIHRoaXMuZGlzdHJveSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCB0aGlzLnJlbW92ZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfSwgdGhpcy5hdHRyID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gYSAmJiBudWxsICE9IGIpdGhpc1thXSA9IGI7IGVsc2UgaWYgKG51bGwgIT0gYSlyZXR1cm4gdGhpc1thXTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9LCB0aGlzLnNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gdGhpcywgYiA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIGJbY10gPSBhW2NdXHJcbiAgICAgICAgICAgIH0pLCB0aGlzLnByb3BlcnRpZXNTdGFjay5wdXNoKGIpXHJcbiAgICAgICAgfSwgdGhpcy5yZXN0b3JlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLnByb3BlcnRpZXNTdGFjayAmJiAwICE9IHRoaXMucHJvcGVydGllc1N0YWNrLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLCBiID0gdGhpcy5wcm9wZXJ0aWVzU3RhY2sucG9wKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICBhW2NdID0gYltjXVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMudG9Kc29uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHRoaXMsIGIgPSBcIntcIiwgYyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChkLCBlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGFbZF07XHJcbiAgICAgICAgICAgICAgICBcInN0cmluZ1wiID09IHR5cGVvZiBmICYmIChmID0gJ1wiJyArIGYgKyAnXCInKSwgYiArPSAnXCInICsgZCArICdcIjonICsgZiwgYyA+IGUgKyAxICYmIChiICs9IFwiLFwiKVxyXG4gICAgICAgICAgICB9KSwgYiArPSBcIn1cIlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLkpUb3BvUm91bmRSZWN0ID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUpIHtcclxuICAgICAgICBcInVuZGVmaW5lZFwiID09IHR5cGVvZiBlICYmIChlID0gNSksIHRoaXMuYmVnaW5QYXRoKCksIHRoaXMubW92ZVRvKGEgKyBlLCBiKSwgdGhpcy5saW5lVG8oYSArIGMgLSBlLCBiKSwgdGhpcy5xdWFkcmF0aWNDdXJ2ZVRvKGEgKyBjLCBiLCBhICsgYywgYiArIGUpLCB0aGlzLmxpbmVUbyhhICsgYywgYiArIGQgLSBlKSwgdGhpcy5xdWFkcmF0aWNDdXJ2ZVRvKGEgKyBjLCBiICsgZCwgYSArIGMgLSBlLCBiICsgZCksIHRoaXMubGluZVRvKGEgKyBlLCBiICsgZCksIHRoaXMucXVhZHJhdGljQ3VydmVUbyhhLCBiICsgZCwgYSwgYiArIGQgLSBlKSwgdGhpcy5saW5lVG8oYSwgYiArIGUpLCB0aGlzLnF1YWRyYXRpY0N1cnZlVG8oYSwgYiwgYSArIGUsIGIpLCB0aGlzLmNsb3NlUGF0aCgpXHJcbiAgICB9LCBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLkpUb3BvRGFzaGVkTGluZVRvID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUpIHtcclxuICAgICAgICBcInVuZGVmaW5lZFwiID09IHR5cGVvZiBlICYmIChlID0gNSk7XHJcbiAgICAgICAgdmFyIGYgPSBjIC0gYSwgZyA9IGQgLSBiLCBoID0gTWF0aC5mbG9vcihNYXRoLnNxcnQoZiAqIGYgKyBnICogZykpLCBpID0gMCA+PSBlID8gaCA6IGggLyBlLCBqID0gZyAvIGggKiBlLCBrID0gZiAvIGggKiBlO1xyXG4gICAgICAgIHRoaXMuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgZm9yICh2YXIgbCA9IDA7IGkgPiBsOyBsKyspbCAlIDIgPyB0aGlzLmxpbmVUbyhhICsgbCAqIGssIGIgKyBsICogaikgOiB0aGlzLm1vdmVUbyhhICsgbCAqIGssIGIgKyBsICogaik7XHJcbiAgICAgICAgdGhpcy5zdHJva2UoKVxyXG4gICAgfSwgSlRvcG8gPSB7XHJcbiAgICAgICAgdmVyc2lvbjogXCIwLjQuOF8wMVwiLFxyXG4gICAgICAgIHpJbmRleF9Db250YWluZXI6IDEsXHJcbiAgICAgICAgekluZGV4X0xpbms6IDIsXHJcbiAgICAgICAgekluZGV4X05vZGU6IDMsXHJcbiAgICAgICAgU2NlbmVNb2RlOiB7bm9ybWFsOiBcIm5vcm1hbFwiLCBkcmFnOiBcImRyYWdcIiwgZWRpdDogXCJlZGl0XCIsIHNlbGVjdDogXCJzZWxlY3RcIn0sXHJcbiAgICAgICAgTW91c2VDdXJzb3I6IHtcclxuICAgICAgICAgICAgbm9ybWFsOiBcImRlZmF1bHRcIixcclxuICAgICAgICAgICAgcG9pbnRlcjogXCJwb2ludGVyXCIsXHJcbiAgICAgICAgICAgIHRvcF9sZWZ0OiBcIm53LXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICB0b3BfY2VudGVyOiBcIm4tcmVzaXplXCIsXHJcbiAgICAgICAgICAgIHRvcF9yaWdodDogXCJuZS1yZXNpemVcIixcclxuICAgICAgICAgICAgbWlkZGxlX2xlZnQ6IFwiZS1yZXNpemVcIixcclxuICAgICAgICAgICAgbWlkZGxlX3JpZ2h0OiBcImUtcmVzaXplXCIsXHJcbiAgICAgICAgICAgIGJvdHRvbV9sZWZ0OiBcIm5lLXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICBib3R0b21fY2VudGVyOiBcIm4tcmVzaXplXCIsXHJcbiAgICAgICAgICAgIGJvdHRvbV9yaWdodDogXCJudy1yZXNpemVcIixcclxuICAgICAgICAgICAgbW92ZTogXCJtb3ZlXCIsXHJcbiAgICAgICAgICAgIG9wZW5faGFuZDogXCJ1cmwoLi9pbWcvY3VyL29wZW5oYW5kLmN1cikgOCA4LCBkZWZhdWx0XCIsXHJcbiAgICAgICAgICAgIGNsb3NlZF9oYW5kOiBcInVybCguL2ltZy9jdXIvY2xvc2VkaGFuZC5jdXIpIDggOCwgZGVmYXVsdFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjcmVhdGVTdGFnZUZyb21Kc29uOiBmdW5jdGlvbiAoanNvblN0ciwgY2FudmFzKSB7XHJcbiAgICAgICAgICAgIGV2YWwoXCJ2YXIganNvbk9iaiA9IFwiICsganNvblN0cik7XHJcbiAgICAgICAgICAgIHZhciBzdGFnZSA9IG5ldyBKVG9wby5TdGFnZShjYW52YXMpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIGpzb25PYmopXCJjaGlsZHNcIiAhPSBrICYmIChzdGFnZVtrXSA9IGpzb25PYmpba10pO1xyXG4gICAgICAgICAgICB2YXIgc2NlbmVzID0ganNvbk9iai5jaGlsZHM7XHJcbiAgICAgICAgICAgIHJldHVybiBzY2VuZXMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBuZXcgSlRvcG8uU2NlbmUoc3RhZ2UpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYyBpbiBhKVwiY2hpbGRzXCIgIT0gYyAmJiAoYltjXSA9IGFbY10pLCBcImJhY2tncm91bmRcIiA9PSBjICYmIChiLmJhY2tncm91bmQgPSBhW2NdKTtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gYS5jaGlsZHM7XHJcbiAgICAgICAgICAgICAgICBkLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IG51bGwsIGQgPSBhLmVsZW1lbnRUeXBlO1xyXG4gICAgICAgICAgICAgICAgICAgIFwibm9kZVwiID09IGQgPyBjID0gbmV3IEpUb3BvLk5vZGUgOiBcIkNpcmNsZU5vZGVcIiA9PSBkICYmIChjID0gbmV3IEpUb3BvLkNpcmNsZU5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGUgaW4gYSljW2VdID0gYVtlXTtcclxuICAgICAgICAgICAgICAgICAgICBiLmFkZChjKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSksIHN0YWdlXHJcbiAgICAgICAgfVxyXG4gICAgfSwgSlRvcG8uRWxlbWVudCA9IEVsZW1lbnQsIHdpbmRvdy5KVG9wbyA9IEpUb3BvXHJcbn0od2luZG93KSwgZnVuY3Rpb24gKEpUb3BvKSB7XHJcbiAgICBmdW5jdGlvbiBNZXNzYWdlQnVzKGEpIHtcclxuICAgICAgICB2YXIgYiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gYSwgdGhpcy5tZXNzYWdlTWFwID0ge30sIHRoaXMubWVzc2FnZUNvdW50ID0gMCwgdGhpcy5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoYSwgYykge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGIubWVzc2FnZU1hcFthXTtcclxuICAgICAgICAgICAgbnVsbCA9PSBkICYmIChiLm1lc3NhZ2VNYXBbYV0gPSBbXSksIGIubWVzc2FnZU1hcFthXS5wdXNoKGMpLCBiLm1lc3NhZ2VDb3VudCsrXHJcbiAgICAgICAgfSwgdGhpcy51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gYi5tZXNzYWdlTWFwW2FdO1xyXG4gICAgICAgICAgICBudWxsICE9IGMgJiYgKGIubWVzc2FnZU1hcFthXSA9IG51bGwsIGRlbGV0ZSBiLm1lc3NhZ2VNYXBbYV0sIGIubWVzc2FnZUNvdW50LS0pXHJcbiAgICAgICAgfSwgdGhpcy5wdWJsaXNoID0gZnVuY3Rpb24gKGEsIGMsIGQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSBiLm1lc3NhZ2VNYXBbYV07XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IGUpZm9yICh2YXIgZiA9IDA7IGYgPCBlLmxlbmd0aDsgZisrKWQgPyAhZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGEoYilcclxuICAgICAgICAgICAgICAgIH0sIDEwKVxyXG4gICAgICAgICAgICB9KGVbZl0sIGMpIDogZVtmXShjKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXREaXN0YW5jZShhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgdmFyIGUsIGY7XHJcbiAgICAgICAgcmV0dXJuIG51bGwgPT0gYyAmJiBudWxsID09IGQgPyAoZSA9IGIueCAtIGEueCwgZiA9IGIueSAtIGEueSkgOiAoZSA9IGMgLSBhLCBmID0gZCAtIGIpLCBNYXRoLnNxcnQoZSAqIGUgKyBmICogZilcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRFbGVtZW50c0JvdW5kKGEpIHtcclxuICAgICAgICBmb3IgKHZhciBiID0ge2xlZnQ6IE51bWJlci5NQVhfVkFMVUUsIHJpZ2h0OiBOdW1iZXIuTUlOX1ZBTFVFLCB0b3A6IE51bWJlci5NQVhfVkFMVUUsIGJvdHRvbTogTnVtYmVyLk1JTl9WQUxVRX0sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGFbY107XHJcbiAgICAgICAgICAgIGQgaW5zdGFuY2VvZiBKVG9wby5MaW5rIHx8IChiLmxlZnQgPiBkLnggJiYgKGIubGVmdCA9IGQueCwgYi5sZWZ0Tm9kZSA9IGQpLCBiLnJpZ2h0IDwgZC54ICsgZC53aWR0aCAmJiAoYi5yaWdodCA9IGQueCArIGQud2lkdGgsIGIucmlnaHROb2RlID0gZCksIGIudG9wID4gZC55ICYmIChiLnRvcCA9IGQueSwgYi50b3BOb2RlID0gZCksIGIuYm90dG9tIDwgZC55ICsgZC5oZWlnaHQgJiYgKGIuYm90dG9tID0gZC55ICsgZC5oZWlnaHQsIGIuYm90dG9tTm9kZSA9IGQpKVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYi53aWR0aCA9IGIucmlnaHQgLSBiLmxlZnQsIGIuaGVpZ2h0ID0gYi5ib3R0b20gLSBiLnRvcCwgYlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1vdXNlQ29vcmRzKGEpIHtcclxuICAgICAgICByZXR1cm4gYSA9IGNsb25lRXZlbnQoYSksIGEucGFnZVggfHwgKGEucGFnZVggPSBhLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgLSBkb2N1bWVudC5ib2R5LmNsaWVudExlZnQsIGEucGFnZVkgPSBhLmNsaWVudFkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCAtIGRvY3VtZW50LmJvZHkuY2xpZW50VG9wKSwgYVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEV2ZW50UG9zaXRpb24oYSkge1xyXG4gICAgICAgIHJldHVybiBhID0gbW91c2VDb29yZHMoYSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByb3RhdGVQb2ludChhLCBiLCBjLCBkLCBlKSB7XHJcbiAgICAgICAgdmFyIGYgPSBjIC0gYSwgZyA9IGQgLSBiLCBoID0gTWF0aC5zcXJ0KGYgKiBmICsgZyAqIGcpLCBpID0gTWF0aC5hdGFuMihnLCBmKSArIGU7XHJcbiAgICAgICAgcmV0dXJuIHt4OiBhICsgTWF0aC5jb3MoaSkgKiBoLCB5OiBiICsgTWF0aC5zaW4oaSkgKiBofVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJvdGF0ZVBvaW50cyhhLCBiLCBjKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZCA9IFtdLCBlID0gMDsgZSA8IGIubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgdmFyIGYgPSByb3RhdGVQb2ludChhLngsIGEueSwgYltlXS54LCBiW2VdLnksIGMpO1xyXG4gICAgICAgICAgICBkLnB1c2goZilcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiAkZm9yZWFjaChhLCBiLCBjKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZChlKSB7XHJcbiAgICAgICAgICAgIGUgIT0gYS5sZW5ndGggJiYgKGIoYVtlXSksIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZCgrK2UpXHJcbiAgICAgICAgICAgIH0sIGMpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKDAgIT0gYS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAwO1xyXG4gICAgICAgICAgICBkKGUpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uICRmb3IoYSwgYiwgYywgZCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGUoYSkge1xyXG4gICAgICAgICAgICBhICE9IGIgJiYgKGMoYiksIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZSgrK2EpXHJcbiAgICAgICAgICAgIH0sIGQpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCEoYSA+IGIpKSB7XHJcbiAgICAgICAgICAgIHZhciBmID0gMDtcclxuICAgICAgICAgICAgZShmKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjbG9uZUV2ZW50KGEpIHtcclxuICAgICAgICB2YXIgYiA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGMgaW4gYSlcInJldHVyblZhbHVlXCIgIT0gYyAmJiBcImtleUxvY2F0aW9uXCIgIT0gYyAmJiAoYltjXSA9IGFbY10pO1xyXG4gICAgICAgIHJldHVybiBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xvbmUoYSkge1xyXG4gICAgICAgIHZhciBiID0ge307XHJcbiAgICAgICAgZm9yICh2YXIgYyBpbiBhKWJbY10gPSBhW2NdO1xyXG4gICAgICAgIHJldHVybiBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNQb2ludEluUmVjdChhLCBiKSB7XHJcbiAgICAgICAgdmFyIGMgPSBiLngsIGQgPSBiLnksIGUgPSBiLndpZHRoLCBmID0gYi5oZWlnaHQ7XHJcbiAgICAgICAgcmV0dXJuIGEueCA+IGMgJiYgYS54IDwgYyArIGUgJiYgYS55ID4gZCAmJiBhLnkgPCBkICsgZlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzUG9pbnRJbkxpbmUoYSwgYiwgYykge1xyXG4gICAgICAgIHZhciBkID0gSlRvcG8udXRpbC5nZXREaXN0YW5jZShiLCBjKSwgZSA9IEpUb3BvLnV0aWwuZ2V0RGlzdGFuY2UoYiwgYSksIGYgPSBKVG9wby51dGlsLmdldERpc3RhbmNlKGMsIGEpLCBnID0gTWF0aC5hYnMoZSArIGYgLSBkKSA8PSAuNTtcclxuICAgICAgICByZXR1cm4gZ1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlbW92ZUZyb21BcnJheShhLCBiKSB7XHJcbiAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYVtjXTtcclxuICAgICAgICAgICAgaWYgKGQgPT09IGIpIHtcclxuICAgICAgICAgICAgICAgIGEgPSBhLmRlbChjKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByYW5kb21Db2xvcigpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKSArIFwiLFwiICsgTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKSArIFwiLFwiICsgTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzSW50c2VjdCgpIHtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRQcm9wZXJ0aWVzKGEsIGIpIHtcclxuICAgICAgICBmb3IgKHZhciBjID0gXCJcIiwgZCA9IDA7IGQgPCBiLmxlbmd0aDsgZCsrKSB7XHJcbiAgICAgICAgICAgIGQgPiAwICYmIChjICs9IFwiLFwiKTtcclxuICAgICAgICAgICAgdmFyIGUgPSBhW2JbZF1dO1xyXG4gICAgICAgICAgICBcInN0cmluZ1wiID09IHR5cGVvZiBlID8gZSA9ICdcIicgKyBlICsgJ1wiJyA6IHZvaWQgMCA9PSBlICYmIChlID0gbnVsbCksIGMgKz0gYltkXSArIFwiOlwiICsgZVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGxvYWRTdGFnZUZyb21Kc29uKGpzb24sIGNhbnZhcykge1xyXG4gICAgICAgIHZhciBvYmogPSBldmFsKGpzb24pLCBzdGFnZSA9IG5ldyBKVG9wby5TdGFnZShjYW52YXMpO1xyXG4gICAgICAgIGZvciAodmFyIGsgaW4gc3RhZ2VPYmopaWYgKFwic2NlbmVzXCIgIT0gaylzdGFnZVtrXSA9IG9ialtrXTsgZWxzZSBmb3IgKHZhciBzY2VuZXMgPSBvYmouc2NlbmVzLCBpID0gMDsgaSA8IHNjZW5lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgc2NlbmVPYmogPSBzY2VuZXNbaV0sIHNjZW5lID0gbmV3IEpUb3BvLlNjZW5lKHN0YWdlKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzY2VuZU9iailpZiAoXCJlbGVtZW50c1wiICE9IHApc2NlbmVbcF0gPSBzY2VuZU9ialtwXTsgZWxzZSBmb3IgKHZhciBub2RlTWFwID0ge30sIGVsZW1lbnRzID0gc2NlbmVPYmouZWxlbWVudHMsIG0gPSAwOyBtIDwgZWxlbWVudHMubGVuZ3RoOyBtKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50T2JqID0gZWxlbWVudHNbbV0sIHR5cGUgPSBlbGVtZW50T2JqLmVsZW1lbnRUeXBlLCBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgXCJOb2RlXCIgPT0gdHlwZSAmJiAoZWxlbWVudCA9IG5ldyBKVG9wby5Ob2RlKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG1rIGluIGVsZW1lbnRPYmopZWxlbWVudFtta10gPSBlbGVtZW50T2JqW21rXTtcclxuICAgICAgICAgICAgICAgIG5vZGVNYXBbZWxlbWVudC50ZXh0XSA9IGVsZW1lbnQsIHNjZW5lLmFkZChlbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhzdGFnZSksIHN0YWdlXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdG9Kc29uKGEpIHtcclxuICAgICAgICB2YXIgYiA9IFwiYmFja2dyb3VuZENvbG9yLHZpc2libGUsbW9kZSxyb3RhdGUsYWxwaGEsc2NhbGVYLHNjYWxlWSxzaGFkb3csdHJhbnNsYXRlWCx0cmFuc2xhdGVZLGFyZWFTZWxlY3QscGFpbnRBbGxcIi5zcGxpdChcIixcIiksIGMgPSBcInRleHQsZWxlbWVudFR5cGUseCx5LHdpZHRoLGhlaWdodCx2aXNpYmxlLGFscGhhLHJvdGF0ZSxzY2FsZVgsc2NhbGVZLGZpbGxDb2xvcixzaGFkb3csdHJhbnNmb3JtQWJsZSx6SW5kZXgsZHJhZ2FibGUsc2VsZWN0ZWQsc2hvd1NlbGVjdGVkLGZvbnQsZm9udENvbG9yLHRleHRQb3NpdGlvbix0ZXh0T2Zmc2V0WCx0ZXh0T2Zmc2V0WVwiLnNwbGl0KFwiLFwiKSwgZCA9IFwie1wiO1xyXG4gICAgICAgIGQgKz0gXCJmcmFtZXM6XCIgKyBhLmZyYW1lcywgZCArPSBcIiwgc2NlbmVzOltcIjtcclxuICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IGEuY2hpbGRzLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmID0gYS5jaGlsZHNbZV07XHJcbiAgICAgICAgICAgIGQgKz0gXCJ7XCIsIGQgKz0gZ2V0UHJvcGVydGllcyhmLCBiKSwgZCArPSBcIiwgZWxlbWVudHM6W1wiO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBnID0gMDsgZyA8IGYuY2hpbGRzLmxlbmd0aDsgZysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IGYuY2hpbGRzW2ddO1xyXG4gICAgICAgICAgICAgICAgZyA+IDAgJiYgKGQgKz0gXCIsXCIpLCBkICs9IFwie1wiLCBkICs9IGdldFByb3BlcnRpZXMoaCwgYyksIGQgKz0gXCJ9XCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkICs9IFwiXX1cIlxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZCArPSBcIl1cIiwgZCArPSBcIn1cIlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNoYW5nZUNvbG9yKGEsIGIsIGMpIHtcclxuICAgICAgICB2YXIgZCA9IGMuc3BsaXQoXCIsXCIpLCBlID0gcGFyc2VJbnQoZFswXSksIGYgPSBwYXJzZUludChkWzFdKSwgZyA9IHBhcnNlSW50KGRbMl0pLCBoID0gY2FudmFzLndpZHRoID0gYi53aWR0aCwgaSA9IGNhbnZhcy5oZWlnaHQgPSBiLmhlaWdodDtcclxuICAgICAgICBhLmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpLCBhLmRyYXdJbWFnZShiLCAwLCAwKTtcclxuICAgICAgICBmb3IgKHZhciBqID0gYS5nZXRJbWFnZURhdGEoMCwgMCwgYi53aWR0aCwgYi5oZWlnaHQpLCBrID0gai5kYXRhLCBsID0gMDsgaCA+IGw7IGwrKylmb3IgKHZhciBtID0gMDsgaSA+IG07IG0rKykge1xyXG4gICAgICAgICAgICB2YXIgbiA9IDQgKiAobCArIG0gKiBoKTtcclxuICAgICAgICAgICAgMCAhPSBrW24gKyAzXSAmJiAobnVsbCAhPSBlICYmIChrW24gKyAwXSArPSBlKSwgbnVsbCAhPSBmICYmIChrW24gKyAxXSArPSBmKSwgbnVsbCAhPSBnICYmIChrW24gKyAyXSArPSBnKSlcclxuICAgICAgICB9XHJcbiAgICAgICAgYS5wdXRJbWFnZURhdGEoaiwgMCwgMCwgMCwgMCwgYi53aWR0aCwgYi5oZWlnaHQpO1xyXG4gICAgICAgIHZhciBvID0gY2FudmFzLnRvRGF0YVVSTCgpO1xyXG4gICAgICAgIHJldHVybiBvXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2VuSW1hZ2VBbGFybShhLCBiKSB7XHJcbiAgICAgICAgdmFyIGMgPSBhLnNyYyArIGI7XHJcbiAgICAgICAgaWYgKGFsYXJtSW1hZ2VDYWNoZVtjXSlyZXR1cm4gYWxhcm1JbWFnZUNhY2hlW2NdO1xyXG4gICAgICAgIHZhciBkID0gbmV3IEltYWdlO1xyXG4gICAgICAgIHJldHVybiBkLnNyYyA9IGNoYW5nZUNvbG9yKGdyYXBoaWNzLCBhLCBiKSwgYWxhcm1JbWFnZUNhY2hlW2NdID0gZCwgZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldE9mZnNldFBvc2l0aW9uKGEpIHtcclxuICAgICAgICBpZiAoIWEpcmV0dXJuIHtsZWZ0OiAwLCB0b3A6IDB9O1xyXG4gICAgICAgIHZhciBiID0gMCwgYyA9IDA7XHJcbiAgICAgICAgaWYgKFwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0XCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KXZhciBkID0gYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgZSA9IGEub3duZXJEb2N1bWVudCwgZiA9IGUuYm9keSwgZyA9IGUuZG9jdW1lbnRFbGVtZW50LCBoID0gZy5jbGllbnRUb3AgfHwgZi5jbGllbnRUb3AgfHwgMCwgaSA9IGcuY2xpZW50TGVmdCB8fCBmLmNsaWVudExlZnQgfHwgMCwgYiA9IGQudG9wICsgKHNlbGYucGFnZVlPZmZzZXQgfHwgZyAmJiBnLnNjcm9sbFRvcCB8fCBmLnNjcm9sbFRvcCkgLSBoLCBjID0gZC5sZWZ0ICsgKHNlbGYucGFnZVhPZmZzZXQgfHwgZyAmJiBnLnNjcm9sbExlZnQgfHwgZi5zY3JvbGxMZWZ0KSAtIGk7IGVsc2UgZG8gYiArPSBhLm9mZnNldFRvcCB8fCAwLCBjICs9IGEub2Zmc2V0TGVmdCB8fCAwLCBhID0gYS5vZmZzZXRQYXJlbnQ7IHdoaWxlIChhKTtcclxuICAgICAgICByZXR1cm4ge2xlZnQ6IGMsIHRvcDogYn1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsaW5lRihhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZShhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhICogZiArIGdcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBmID0gKGQgLSBiKSAvIChjIC0gYSksIGcgPSBiIC0gYSAqIGY7XHJcbiAgICAgICAgcmV0dXJuIGUuayA9IGYsIGUuYiA9IGcsIGUueDEgPSBhLCBlLngyID0gYywgZS55MSA9IGIsIGUueTIgPSBkLCBlXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW5SYW5nZShhLCBiLCBjKSB7XHJcbiAgICAgICAgdmFyIGQgPSBNYXRoLmFicyhiIC0gYyksIGUgPSBNYXRoLmFicyhiIC0gYSksIGYgPSBNYXRoLmFicyhjIC0gYSksIGcgPSBNYXRoLmFicyhkIC0gKGUgKyBmKSk7XHJcbiAgICAgICAgcmV0dXJuIDFlLTYgPiBnID8gITAgOiAhMVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzUG9pbnRJbkxpbmVTZWcoYSwgYiwgYykge1xyXG4gICAgICAgIHJldHVybiBpblJhbmdlKGEsIGMueDEsIGMueDIpICYmIGluUmFuZ2UoYiwgYy55MSwgYy55MilcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oYSwgYikge1xyXG4gICAgICAgIHZhciBjLCBkO1xyXG4gICAgICAgIHJldHVybiBhLmsgPT0gYi5rID8gbnVsbCA6ICgxIC8gMCA9PSBhLmsgfHwgYS5rID09IC0xIC8gMCA/IChjID0gYS54MSwgZCA9IGIoYS54MSkpIDogMSAvIDAgPT0gYi5rIHx8IGIuayA9PSAtMSAvIDAgPyAoYyA9IGIueDEsIGQgPSBhKGIueDEpKSA6IChjID0gKGIuYiAtIGEuYikgLyAoYS5rIC0gYi5rKSwgZCA9IGEoYykpLCAwID09IGlzUG9pbnRJbkxpbmVTZWcoYywgZCwgYSkgPyBudWxsIDogMCA9PSBpc1BvaW50SW5MaW5lU2VnKGMsIGQsIGIpID8gbnVsbCA6IHtcclxuICAgICAgICAgICAgeDogYyxcclxuICAgICAgICAgICAgeTogZFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW50ZXJzZWN0aW9uTGluZUJvdW5kKGEsIGIpIHtcclxuICAgICAgICB2YXIgYyA9IEpUb3BvLnV0aWwubGluZUYoYi5sZWZ0LCBiLnRvcCwgYi5sZWZ0LCBiLmJvdHRvbSksIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihhLCBjKTtcclxuICAgICAgICByZXR1cm4gbnVsbCA9PSBkICYmIChjID0gSlRvcG8udXRpbC5saW5lRihiLmxlZnQsIGIudG9wLCBiLnJpZ2h0LCBiLnRvcCksIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihhLCBjKSwgbnVsbCA9PSBkICYmIChjID0gSlRvcG8udXRpbC5saW5lRihiLnJpZ2h0LCBiLnRvcCwgYi5yaWdodCwgYi5ib3R0b20pLCBkID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb24oYSwgYyksIG51bGwgPT0gZCAmJiAoYyA9IEpUb3BvLnV0aWwubGluZUYoYi5sZWZ0LCBiLmJvdHRvbSwgYi5yaWdodCwgYi5ib3R0b20pLCBkID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb24oYSwgYykpKSksIGRcclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dChhLCAxZTMgLyAyNClcclxuICAgICAgICB9LCBBcnJheS5wcm90b3R5cGUuZGVsID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICBpZiAoXCJudW1iZXJcIiAhPSB0eXBlb2YgYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMubGVuZ3RoOyBiKyspaWYgKHRoaXNbYl0gPT09IGEpcmV0dXJuIHRoaXMuc2xpY2UoMCwgYikuY29uY2F0KHRoaXMuc2xpY2UoYiArIDEsIHRoaXMubGVuZ3RoKSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAwID4gYSA/IHRoaXMgOiB0aGlzLnNsaWNlKDAsIGEpLmNvbmNhdCh0aGlzLnNsaWNlKGEgKyAxLCB0aGlzLmxlbmd0aCkpXHJcbiAgICB9LCBbXS5pbmRleE9mIHx8IChBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLmxlbmd0aDsgYisrKWlmICh0aGlzW2JdID09PSBhKXJldHVybiBiO1xyXG4gICAgICAgIHJldHVybiAtMVxyXG4gICAgfSksIHdpbmRvdy5jb25zb2xlIHx8ICh3aW5kb3cuY29uc29sZSA9IHtcclxuICAgICAgICBsb2c6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCBpbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfSwgZGVidWc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCB3YXJuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfSwgZXJyb3I6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLCBncmFwaGljcyA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksIGFsYXJtSW1hZ2VDYWNoZSA9IHt9O1xyXG4gICAgSlRvcG8udXRpbCA9IHtcclxuICAgICAgICByb3RhdGVQb2ludDogcm90YXRlUG9pbnQsXHJcbiAgICAgICAgcm90YXRlUG9pbnRzOiByb3RhdGVQb2ludHMsXHJcbiAgICAgICAgZ2V0RGlzdGFuY2U6IGdldERpc3RhbmNlLFxyXG4gICAgICAgIGdldEV2ZW50UG9zaXRpb246IGdldEV2ZW50UG9zaXRpb24sXHJcbiAgICAgICAgbW91c2VDb29yZHM6IG1vdXNlQ29vcmRzLFxyXG4gICAgICAgIE1lc3NhZ2VCdXM6IE1lc3NhZ2VCdXMsXHJcbiAgICAgICAgaXNGaXJlZm94OiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJGaXJlZm94XCIpID4gMCxcclxuICAgICAgICBpc0lFOiAhKCF3aW5kb3cuYXR0YWNoRXZlbnQgfHwgLTEgIT09IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk9wZXJhXCIpKSxcclxuICAgICAgICBpc0Nocm9tZTogbnVsbCAhPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2Nocm9tZS8pLFxyXG4gICAgICAgIGNsb25lOiBjbG9uZSxcclxuICAgICAgICBpc1BvaW50SW5SZWN0OiBpc1BvaW50SW5SZWN0LFxyXG4gICAgICAgIGlzUG9pbnRJbkxpbmU6IGlzUG9pbnRJbkxpbmUsXHJcbiAgICAgICAgcmVtb3ZlRnJvbUFycmF5OiByZW1vdmVGcm9tQXJyYXksXHJcbiAgICAgICAgY2xvbmVFdmVudDogY2xvbmVFdmVudCxcclxuICAgICAgICByYW5kb21Db2xvcjogcmFuZG9tQ29sb3IsXHJcbiAgICAgICAgaXNJbnRzZWN0OiBpc0ludHNlY3QsXHJcbiAgICAgICAgdG9Kc29uOiB0b0pzb24sXHJcbiAgICAgICAgbG9hZFN0YWdlRnJvbUpzb246IGxvYWRTdGFnZUZyb21Kc29uLFxyXG4gICAgICAgIGdldEVsZW1lbnRzQm91bmQ6IGdldEVsZW1lbnRzQm91bmQsXHJcbiAgICAgICAgZ2VuSW1hZ2VBbGFybTogZ2VuSW1hZ2VBbGFybSxcclxuICAgICAgICBnZXRPZmZzZXRQb3NpdGlvbjogZ2V0T2Zmc2V0UG9zaXRpb24sXHJcbiAgICAgICAgbGluZUY6IGxpbmVGLFxyXG4gICAgICAgIGludGVyc2VjdGlvbjogaW50ZXJzZWN0aW9uLFxyXG4gICAgICAgIGludGVyc2VjdGlvbkxpbmVCb3VuZDogaW50ZXJzZWN0aW9uTGluZUJvdW5kXHJcbiAgICB9LCB3aW5kb3cuJGZvciA9ICRmb3IsIHdpbmRvdy4kZm9yZWFjaCA9ICRmb3JlYWNoXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihhKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaGdhcDogMTYsIHZpc2libGU6ICExLCBleHBvcnRDYW52YXM6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksIGdldEltYWdlOiBmdW5jdGlvbiAoYiwgYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBhLmdldEJvdW5kKCksIGUgPSAxLCBmID0gMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoID0gYS5jYW52YXMud2lkdGgsIHRoaXMuZXhwb3J0Q2FudmFzLmhlaWdodCA9IGEuY2FudmFzLmhlaWdodCwgbnVsbCAhPSBiICYmIG51bGwgIT0gYyA/ICh0aGlzLmV4cG9ydENhbnZhcy53aWR0aCA9IGIsIHRoaXMuZXhwb3J0Q2FudmFzLmhlaWdodCA9IGMsIGUgPSBiIC8gZC53aWR0aCwgZiA9IGMgLyBkLmhlaWdodCkgOiAoZC53aWR0aCA+IGEuY2FudmFzLndpZHRoICYmICh0aGlzLmV4cG9ydENhbnZhcy53aWR0aCA9IGQud2lkdGgpLCBkLmhlaWdodCA+IGEuY2FudmFzLmhlaWdodCAmJiAodGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0ID0gZC5oZWlnaHQpKTtcclxuICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy5leHBvcnRDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGEuY2hpbGRzLmxlbmd0aCA+IDAgJiYgKGcuc2F2ZSgpLCBnLmNsZWFyUmVjdCgwLCAwLCB0aGlzLmV4cG9ydENhbnZhcy53aWR0aCwgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0KSwgYS5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIDEgPT0gYS52aXNpYmxlICYmIChhLnNhdmUoKSwgYS50cmFuc2xhdGVYID0gMCwgYS50cmFuc2xhdGVZID0gMCwgYS5zY2FsZVggPSAxLCBhLnNjYWxlWSA9IDEsIGcuc2NhbGUoZSwgZiksIGQubGVmdCA8IDAgJiYgKGEudHJhbnNsYXRlWCA9IE1hdGguYWJzKGQubGVmdCkpLCBkLnRvcCA8IDAgJiYgKGEudHJhbnNsYXRlWSA9IE1hdGguYWJzKGQudG9wKSksIGEucGFpbnRBbGwgPSAhMCwgYS5yZXBhaW50KGcpLCBhLnBhaW50QWxsID0gITEsIGEucmVzdG9yZSgpKVxyXG4gICAgICAgICAgICAgICAgfSksIGcucmVzdG9yZSgpKSwgdGhpcy5leHBvcnRDYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpXHJcbiAgICAgICAgICAgIH0sIGNhbnZhczogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSwgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVhZ2xlSW1hZ2VEYXRhcyA9IHRoaXMuZ2V0RGF0YShhKVxyXG4gICAgICAgICAgICB9LCBzZXRTaXplOiBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMuY2FudmFzLndpZHRoID0gYSwgdGhpcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQgPSBiXHJcbiAgICAgICAgICAgIH0sIGdldERhdGE6IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGEuc3RhZ2UuY2FudmFzLndpZHRoLCBjID0gYS5zdGFnZS5jYW52YXMuaGVpZ2h0LCBkID0gYiAvIGEuc2NhbGVYIC8gMiwgZSA9IGMgLyBhLnNjYWxlWSAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt0cmFuc2xhdGVYOiBhLnRyYW5zbGF0ZVggKyBkIC0gZCAqIGEuc2NhbGVYLCB0cmFuc2xhdGVZOiBhLnRyYW5zbGF0ZVkgKyBlIC0gZSAqIGEuc2NhbGVZfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG51bGwgIT0gaiAmJiBudWxsICE9IGsgPyB0aGlzLnNldFNpemUoYiwgYykgOiB0aGlzLnNldFNpemUoMjAwLCAxNjApO1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoYS5jaGlsZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc2F2ZSgpLCBlLmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KSwgYS5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAxID09IGEudmlzaWJsZSAmJiAoYS5zYXZlKCksIGEuY2VudGVyQW5kWm9vbShudWxsLCBudWxsLCBlKSwgYS5yZXBhaW50KGUpLCBhLnJlc3RvcmUoKSlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGQoYS5jaGlsZHNbMF0pLCBnID0gZi50cmFuc2xhdGVYICogKHRoaXMuY2FudmFzLndpZHRoIC8gYS5jYW52YXMud2lkdGgpICogYS5jaGlsZHNbMF0uc2NhbGVYLCBoID0gZi50cmFuc2xhdGVZICogKHRoaXMuY2FudmFzLmhlaWdodCAvIGEuY2FudmFzLmhlaWdodCkgKiBhLmNoaWxkc1swXS5zY2FsZVksIGkgPSBhLmdldEJvdW5kKCksIGogPSBhLmNhbnZhcy53aWR0aCAvIGEuY2hpbGRzWzBdLnNjYWxlWCAvIGkud2lkdGgsIGsgPSBhLmNhbnZhcy5oZWlnaHQgLyBhLmNoaWxkc1swXS5zY2FsZVkgLyBpLmhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBqID4gMSAmJiAoaiA9IDEpLCBrID4gMSAmJiAoaiA9IDEpLCBnICo9IGosIGggKj0gaywgaS5sZWZ0IDwgMCAmJiAoZyAtPSBNYXRoLmFicyhpLmxlZnQpICogKHRoaXMud2lkdGggLyBpLndpZHRoKSksIGkudG9wIDwgMCAmJiAoaCAtPSBNYXRoLmFicyhpLnRvcCkgKiAodGhpcy5oZWlnaHQgLyBpLmhlaWdodCkpLCBlLnNhdmUoKSwgZS5saW5lV2lkdGggPSAxLCBlLnN0cm9rZVN0eWxlID0gXCJyZ2JhKDI1NSwwLDAsMSlcIiwgZS5zdHJva2VSZWN0KC1nLCAtaCwgZS5jYW52YXMud2lkdGggKiBqLCBlLmNhbnZhcy5oZWlnaHQgKiBrKSwgZS5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBlLmdldEltYWdlRGF0YSgwLCAwLCBlLmNhbnZhcy53aWR0aCwgZS5jYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKG0pIHtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH0sIHBhaW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmVhZ2xlSW1hZ2VEYXRhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gYS5ncmFwaGljcztcclxuICAgICAgICAgICAgICAgICAgICBiLnNhdmUoKSwgYi5maWxsU3R5bGUgPSBcInJnYmEoMjExLDIxMSwyMTEsMC4zKVwiLCBiLmZpbGxSZWN0KGEuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggLSAyICogdGhpcy5oZ2FwLCBhLmNhbnZhcy5oZWlnaHQgLSB0aGlzLmNhbnZhcy5oZWlnaHQgLSAxLCBhLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgKyAxKSwgYi5maWxsKCksIGIuc2F2ZSgpLCBiLmxpbmVXaWR0aCA9IDEsIGIuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMCwwLDAsMSlcIiwgYi5yZWN0KGEuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggLSAyICogdGhpcy5oZ2FwLCBhLmNhbnZhcy5oZWlnaHQgLSB0aGlzLmNhbnZhcy5oZWlnaHQgLSAxLCBhLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgKyAxKSwgYi5zdHJva2UoKSwgYi5yZXN0b3JlKCksIGIucHV0SW1hZ2VEYXRhKHRoaXMuZWFnbGVJbWFnZURhdGFzLCBhLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoIC0gdGhpcy5oZ2FwLCBhLmNhbnZhcy5oZWlnaHQgLSB0aGlzLmNhbnZhcy5oZWlnaHQpLCBiLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHRoaXMuZWFnbGVJbWFnZURhdGFzID0gdGhpcy5nZXREYXRhKGEpXHJcbiAgICAgICAgICAgIH0sIGV2ZW50SGFuZGxlcjogZnVuY3Rpb24gKGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gYi54LCBlID0gYi55O1xyXG4gICAgICAgICAgICAgICAgaWYgKGQgPiBjLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoICYmIGUgPiBjLmNhbnZhcy5oZWlnaHQgLSB0aGlzLmNhbnZhcy5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZCA9IGIueCAtIHRoaXMuY2FudmFzLndpZHRoLCBlID0gYi55IC0gdGhpcy5jYW52YXMuaGVpZ2h0LCBcIm1vdXNlZG93blwiID09IGEgJiYgKHRoaXMubGFzdFRyYW5zbGF0ZVggPSBjLmNoaWxkc1swXS50cmFuc2xhdGVYLCB0aGlzLmxhc3RUcmFuc2xhdGVZID0gYy5jaGlsZHNbMF0udHJhbnNsYXRlWSksIFwibW91c2VkcmFnXCIgPT0gYSAmJiBjLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gYi5keCwgZyA9IGIuZHksIGggPSBjLmdldEJvdW5kKCksIGkgPSB0aGlzLmNhbnZhcy53aWR0aCAvIGMuY2hpbGRzWzBdLnNjYWxlWCAvIGgud2lkdGgsIGogPSB0aGlzLmNhbnZhcy5oZWlnaHQgLyBjLmNoaWxkc1swXS5zY2FsZVkgLyBoLmhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy5jaGlsZHNbMF0udHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggLSBmIC8gaSwgYy5jaGlsZHNbMF0udHJhbnNsYXRlWSA9IHRoaXMubGFzdFRyYW5zbGF0ZVkgLSBnIC8galxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjKGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBhLnV0aWwuZ2V0RXZlbnRQb3NpdGlvbihiKSwgZCA9IGEudXRpbC5nZXRPZmZzZXRQb3NpdGlvbihuLmNhbnZhcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBjLm9mZnNldExlZnQgPSBjLnBhZ2VYIC0gZC5sZWZ0LCBjLm9mZnNldFRvcCA9IGMucGFnZVkgLSBkLnRvcCwgYy54ID0gYy5vZmZzZXRMZWZ0LCBjLnkgPSBjLm9mZnNldFRvcCwgYy50YXJnZXQgPSBudWxsLCBjXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlKGEpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhMVxyXG4gICAgICAgICAgICB9LCB0aGlzLm1vdXNlT3ZlciA9ICEwO1xyXG4gICAgICAgICAgICB2YXIgYiA9IGQoYSk7XHJcbiAgICAgICAgICAgIG4uZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2VvdmVyXCIsIGIpLCBuLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW92ZXJcIiwgYilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGYoYSkge1xyXG4gICAgICAgICAgICBwID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBvID0gITBcclxuICAgICAgICAgICAgfSwgNTAwKSwgZG9jdW1lbnQub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgYiA9IGQoYSk7XHJcbiAgICAgICAgICAgIG4uZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2VvdXRcIiwgYiksIG4uZGlzcGF0Y2hFdmVudChcIm1vdXNlb3V0XCIsIGIpLCBuLm5lZWRSZXBhaW50ID0gMCA9PSBuLmFuaW1hdGUgPyAhMSA6ICEwXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBkKGEpO1xyXG4gICAgICAgICAgICBuLm1vdXNlRG93biA9ICEwLCBuLm1vdXNlRG93blggPSBiLngsIG4ubW91c2VEb3duWSA9IGIueSwgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZWRvd25cIiwgYiksIG4uZGlzcGF0Y2hFdmVudChcIm1vdXNlZG93blwiLCBiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gZChhKTtcclxuICAgICAgICAgICAgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZXVwXCIsIGIpLCBuLmRpc3BhdGNoRXZlbnQoXCJtb3VzZXVwXCIsIGIpLCBuLm1vdXNlRG93biA9ICExLCBuLm5lZWRSZXBhaW50ID0gMCA9PSBuLmFuaW1hdGUgPyAhMSA6ICEwXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpKGEpIHtcclxuICAgICAgICAgICAgcCAmJiAod2luZG93LmNsZWFyVGltZW91dChwKSwgcCA9IG51bGwpLCBvID0gITE7XHJcbiAgICAgICAgICAgIHZhciBiID0gZChhKTtcclxuICAgICAgICAgICAgbi5tb3VzZURvd24gPyAwID09IGEuYnV0dG9uICYmIChiLmR4ID0gYi54IC0gbi5tb3VzZURvd25YLCBiLmR5ID0gYi55IC0gbi5tb3VzZURvd25ZLCBuLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlZHJhZ1wiLCBiKSwgbi5kaXNwYXRjaEV2ZW50KFwibW91c2VkcmFnXCIsIGIpLCAxID09IG4uZWFnbGVFeWUudmlzaWJsZSAmJiBuLmVhZ2xlRXllLnVwZGF0ZSgpKSA6IChuLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlbW92ZVwiLCBiKSwgbi5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGIpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaihhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gZChhKTtcclxuICAgICAgICAgICAgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJjbGlja1wiLCBiKSwgbi5kaXNwYXRjaEV2ZW50KFwiY2xpY2tcIiwgYilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGsoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IGQoYSk7XHJcbiAgICAgICAgICAgIG4uZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwiZGJjbGlja1wiLCBiKSwgbi5kaXNwYXRjaEV2ZW50KFwiZGJjbGlja1wiLCBiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gZChhKTtcclxuICAgICAgICAgICAgbi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZXdoZWVsXCIsIGIpLCBuLmRpc3BhdGNoRXZlbnQoXCJtb3VzZXdoZWVsXCIsIGIpLCBudWxsICE9IG4ud2hlZWxab29tICYmIChhLnByZXZlbnREZWZhdWx0ID8gYS5wcmV2ZW50RGVmYXVsdCgpIDogKGEgPSBhIHx8IHdpbmRvdy5ldmVudCwgYS5yZXR1cm5WYWx1ZSA9ICExKSwgMSA9PSBuLmVhZ2xlRXllLnZpc2libGUgJiYgbi5lYWdsZUV5ZS51cGRhdGUoKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG0oYikge1xyXG4gICAgICAgICAgICBhLnV0aWwuaXNJRSB8fCAhd2luZG93LmFkZEV2ZW50TGlzdGVuZXIgPyAoYi5vbm1vdXNlb3V0ID0gZiwgYi5vbm1vdXNlb3ZlciA9IGUsIGIub25tb3VzZWRvd24gPSBnLCBiLm9ubW91c2V1cCA9IGgsIGIub25tb3VzZW1vdmUgPSBpLCBiLm9uY2xpY2sgPSBqLCBiLm9uZGJsY2xpY2sgPSBrLCBiLm9ubW91c2V3aGVlbCA9IGwsIGIudG91Y2hzdGFydCA9IGcsIGIudG91Y2htb3ZlID0gaSwgYi50b3VjaGVuZCA9IGgpIDogKGIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsIGYpLCBiLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZSksIGIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBnKSwgYi5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBoKSwgYi5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGkpLCBiLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBqKSwgYi5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIiwgayksIGEudXRpbC5pc0ZpcmVmb3ggPyBiLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Nb3VzZVNjcm9sbFwiLCBsKSA6IGIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNld2hlZWxcIiwgbCkpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciAmJiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBuLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcImtleWRvd25cIiwgYS51dGlsLmNsb25lRXZlbnQoYikpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBiLmtleUNvZGU7XHJcbiAgICAgICAgICAgICAgICAoMzcgPT0gYyB8fCAzOCA9PSBjIHx8IDM5ID09IGMgfHwgNDAgPT0gYykgJiYgKGIucHJldmVudERlZmF1bHQgPyBiLnByZXZlbnREZWZhdWx0KCkgOiAoYiA9IGIgfHwgd2luZG93LmV2ZW50LCBiLnJldHVyblZhbHVlID0gITEpKVxyXG4gICAgICAgICAgICB9LCAhMCksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIG4uZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwia2V5dXBcIiwgYS51dGlsLmNsb25lRXZlbnQoYikpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBiLmtleUNvZGU7XHJcbiAgICAgICAgICAgICAgICAoMzcgPT0gYyB8fCAzOCA9PSBjIHx8IDM5ID09IGMgfHwgNDAgPT0gYykgJiYgKGIucHJldmVudERlZmF1bHQgPyBiLnByZXZlbnREZWZhdWx0KCkgOiAoYiA9IGIgfHwgd2luZG93LmV2ZW50LCBiLnJldHVyblZhbHVlID0gITEpKVxyXG4gICAgICAgICAgICB9LCAhMCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhLnN0YWdlID0gdGhpcztcclxuICAgICAgICB2YXIgbiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgbShjKSwgdGhpcy5jYW52YXMgPSBjLCB0aGlzLmdyYXBoaWNzID0gYy5nZXRDb250ZXh0KFwiMmRcIiksIHRoaXMuY2hpbGRzID0gW10sIHRoaXMuZnJhbWVzID0gMjQsIHRoaXMubWVzc2FnZUJ1cyA9IG5ldyBhLnV0aWwuTWVzc2FnZUJ1cywgdGhpcy5lYWdsZUV5ZSA9IGIodGhpcyksIHRoaXMud2hlZWxab29tID0gbnVsbCwgdGhpcy5tb3VzZURvd25YID0gMCwgdGhpcy5tb3VzZURvd25ZID0gMCwgdGhpcy5tb3VzZURvd24gPSAhMSwgdGhpcy5tb3VzZU92ZXIgPSAhMSwgdGhpcy5uZWVkUmVwYWludCA9ICEwLCB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gW1wiZnJhbWVzXCIsIFwid2hlZWxab29tXCJdXHJcbiAgICAgICAgfSwgbnVsbCAhPSBjICYmIHRoaXMuaW5pdGlhbGl6ZShjKTtcclxuICAgICAgICB2YXIgbyA9ICEwLCBwID0gbnVsbDtcclxuICAgICAgICBkb2N1bWVudC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgIH0sIHRoaXMuZGlzcGF0Y2hFdmVudFRvU2NlbmVzID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy5mcmFtZXMgJiYgKHRoaXMubmVlZFJlcGFpbnQgPSAhMCksIDEgPT0gdGhpcy5lYWdsZUV5ZS52aXNpYmxlICYmIC0xICE9IGEuaW5kZXhPZihcIm1vdXNlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGIueCwgZCA9IGIueTtcclxuICAgICAgICAgICAgICAgIGlmIChjID4gdGhpcy53aWR0aCAtIHRoaXMuZWFnbGVFeWUud2lkdGggJiYgZCA+IHRoaXMuaGVpZ2h0IC0gdGhpcy5lYWdsZUV5ZS5oZWlnaHQpcmV0dXJuIHZvaWQgdGhpcy5lYWdsZUV5ZS5ldmVudEhhbmRsZXIoYSwgYiwgdGhpcylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoMSA9PSBjLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGNbYSArIFwiSGFuZGxlclwiXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBkKXRocm93IG5ldyBFcnJvcihcIkZ1bmN0aW9uIG5vdCBmb3VuZDpcIiArIGEgKyBcIkhhbmRsZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZC5jYWxsKGMsIGIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdGhpcy5hZGQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgYisrKWlmICh0aGlzLmNoaWxkc1tiXSA9PT0gYSlyZXR1cm47XHJcbiAgICAgICAgICAgIGEuYWRkVG8odGhpcyksIHRoaXMuY2hpbGRzLnB1c2goYSlcclxuICAgICAgICB9LCB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IGEpdGhyb3cgbmV3IEVycm9yKFwiU3RhZ2UucmVtb3Zl5Ye66ZSZOiDlj4LmlbDkuLpudWxsIVwiKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLmNoaWxkcy5sZW5ndGg7IGIrKylpZiAodGhpcy5jaGlsZHNbYl0gPT09IGEpcmV0dXJuIGEuc3RhZ2UgPSBudWxsLCB0aGlzLmNoaWxkcyA9IHRoaXMuY2hpbGRzLmRlbChiKSwgdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9LCB0aGlzLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcyA9IFtdXHJcbiAgICAgICAgfSwgdGhpcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLCBkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGIuY2FsbChjLCBhKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlQnVzLnN1YnNjcmliZShhLCBkKSwgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy51bnN1YnNjcmliZShhKVxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlQWxsRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGEudXRpbC5NZXNzYWdlQnVzXHJcbiAgICAgICAgfSwgdGhpcy5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUJ1cy5wdWJsaXNoKGEsIGIpLCB0aGlzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgcSA9IFwiY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcIi5zcGxpdChcIixcIiksIHIgPSB0aGlzO1xyXG4gICAgICAgIHEuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByW2FdID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gYiA/IHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihhLCBiKSA6IHRoaXMuZGlzcGF0Y2hFdmVudChhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSksIHRoaXMuc2F2ZUltYWdlSW5mbyA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5lYWdsZUV5ZS5nZXRJbWFnZShhLCBiKSwgZCA9IHdpbmRvdy5vcGVuKFwiYWJvdXQ6YmxhbmtcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBkLmRvY3VtZW50LndyaXRlKFwiPGltZyBzcmM9J1wiICsgYyArIFwiJyBhbHQ9J2Zyb20gY2FudmFzJy8+XCIpLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5zYXZlQXNMb2NhbEltYWdlID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmVhZ2xlRXllLmdldEltYWdlKGEsIGIpO1xyXG4gICAgICAgICAgICByZXR1cm4gYy5yZXBsYWNlKFwiaW1hZ2UvcG5nXCIsIFwiaW1hZ2Uvb2N0ZXQtc3RyZWFtXCIpLCB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGMsIHRoaXNcclxuICAgICAgICB9LCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBudWxsICE9IHRoaXMuY2FudmFzICYmICh0aGlzLmdyYXBoaWNzLnNhdmUoKSwgdGhpcy5ncmFwaGljcy5jbGVhclJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpLCB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAxID09IGEudmlzaWJsZSAmJiBhLnJlcGFpbnQobi5ncmFwaGljcylcclxuICAgICAgICAgICAgfSksIDEgPT0gdGhpcy5lYWdsZUV5ZS52aXNpYmxlICYmIHRoaXMuZWFnbGVFeWUucGFpbnQodGhpcyksIHRoaXMuZ3JhcGhpY3MucmVzdG9yZSgpKVxyXG4gICAgICAgIH0sIHRoaXMucmVwYWludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgMCAhPSB0aGlzLmZyYW1lcyAmJiAodGhpcy5mcmFtZXMgPCAwICYmIDAgPT0gdGhpcy5uZWVkUmVwYWludCB8fCAodGhpcy5wYWludCgpLCB0aGlzLmZyYW1lcyA8IDAgJiYgKHRoaXMubmVlZFJlcGFpbnQgPSAhMSkpKVxyXG4gICAgICAgIH0sIHRoaXMuem9vbSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIDAgIT0gYi52aXNpYmxlICYmIGIuem9vbShhKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sIHRoaXMuem9vbU91dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIDAgIT0gYi52aXNpYmxlICYmIGIuem9vbU91dChhKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sIHRoaXMuem9vbUluID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgMCAhPSBiLnZpc2libGUgJiYgYi56b29tSW4oYSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LCB0aGlzLmNlbnRlckFuZFpvb20gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIDAgIT0gYS52aXNpYmxlICYmIGEuY2VudGVyQW5kWm9vbSgpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdGhpcy5zZXRDZW50ZXIgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gYSAtIGMuY2FudmFzLndpZHRoIC8gMiwgZiA9IGIgLSBjLmNhbnZhcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICAgICAgZC50cmFuc2xhdGVYID0gLWUsIGQudHJhbnNsYXRlWSA9IC1mXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdGhpcy5nZXRCb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSB7bGVmdDogTnVtYmVyLk1BWF9WQUxVRSwgcmlnaHQ6IE51bWJlci5NSU5fVkFMVUUsIHRvcDogTnVtYmVyLk1BWF9WQUxVRSwgYm90dG9tOiBOdW1iZXIuTUlOX1ZBTFVFfTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gYi5nZXRFbGVtZW50c0JvdW5kKCk7XHJcbiAgICAgICAgICAgICAgICBjLmxlZnQgPCBhLmxlZnQgJiYgKGEubGVmdCA9IGMubGVmdCwgYS5sZWZ0Tm9kZSA9IGMubGVmdE5vZGUpLCBjLnRvcCA8IGEudG9wICYmIChhLnRvcCA9IGMudG9wLCBhLnRvcE5vZGUgPSBjLnRvcE5vZGUpLCBjLnJpZ2h0ID4gYS5yaWdodCAmJiAoYS5yaWdodCA9IGMucmlnaHQsIGEucmlnaHROb2RlID0gYy5yaWdodE5vZGUpLCBjLmJvdHRvbSA+IGEuYm90dG9tICYmIChhLmJvdHRvbSA9IGMuYm90dG9tLCBhLmJvdHRvbU5vZGUgPSBjLmJvdHRvbU5vZGUpXHJcbiAgICAgICAgICAgIH0pLCBhLndpZHRoID0gYS5yaWdodCAtIGEubGVmdCwgYS5oZWlnaHQgPSBhLmJvdHRvbSAtIGEudG9wLCBhXHJcbiAgICAgICAgfSwgdGhpcy50b0pzb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcywgYyA9ICd7XCJ2ZXJzaW9uXCI6XCInICsgYS52ZXJzaW9uICsgJ1wiLCc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gYlthXTtcclxuICAgICAgICAgICAgICAgIFwic3RyaW5nXCIgPT0gdHlwZW9mIGQgJiYgKGQgPSAnXCInICsgZCArICdcIicpLCBjICs9ICdcIicgKyBhICsgJ1wiOicgKyBkICsgXCIsXCJcclxuICAgICAgICAgICAgfSksIGMgKz0gJ1wiY2hpbGRzXCI6WycsIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGMgKz0gYS50b0pzb24oKVxyXG4gICAgICAgICAgICB9KSwgYyArPSBcIl1cIiwgYyArPSBcIn1cIlxyXG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgMCA9PSBuLmZyYW1lcyA/IHNldFRpbWVvdXQoYXJndW1lbnRzLmNhbGxlZSwgMTAwKSA6IG4uZnJhbWVzIDwgMCA/IChuLnJlcGFpbnQoKSwgc2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLCAxZTMgLyAtbi5mcmFtZXMpKSA6IChuLnJlcGFpbnQoKSwgc2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLCAxZTMgLyBuLmZyYW1lcykpXHJcbiAgICAgICAgfSgpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbi5tb3VzZXdoZWVsKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IG51bGwgPT0gYS53aGVlbERlbHRhID8gYS5kZXRhaWwgOiBhLndoZWVsRGVsdGE7XHJcbiAgICAgICAgICAgICAgICBudWxsICE9IHRoaXMud2hlZWxab29tICYmIChiID4gMCA/IHRoaXMuem9vbUluKHRoaXMud2hlZWxab29tKSA6IHRoaXMuem9vbU91dCh0aGlzLndoZWVsWm9vbSkpXHJcbiAgICAgICAgICAgIH0pLCBuLnBhaW50KClcclxuICAgICAgICB9LCAzMDApLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbi5wYWludCgpXHJcbiAgICAgICAgfSwgMWUzKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG4ucGFpbnQoKVxyXG4gICAgICAgIH0sIDNlMylcclxuICAgIH1cclxuXHJcbiAgICBjLnByb3RvdHlwZSA9IHtcclxuICAgICAgICBnZXQgd2lkdGgoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy53aWR0aFxyXG4gICAgICAgIH0sIGdldCBoZWlnaHQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy5oZWlnaHRcclxuICAgICAgICB9LCBzZXQgY3Vyc29yKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuY3Vyc29yID0gYVxyXG4gICAgICAgIH0sIGdldCBjdXJzb3IoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy5zdHlsZS5jdXJzb3JcclxuICAgICAgICB9LCBzZXQgbW9kZShhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIGIubW9kZSA9IGFcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9LCBhLlN0YWdlID0gY1xyXG59KEpUb3BvKSwgZnVuY3Rpb24gKGEpIHtcclxuICAgIGZ1bmN0aW9uIGIoYykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGQoYSwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIGUuYmVnaW5QYXRoKCksIGUuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMCwwLDIzNiwwLjUpXCIsIGUuZmlsbFN0eWxlID0gXCJyZ2JhKDAsMCwyMzYsMC4xKVwiLCBlLnJlY3QoYSwgYiwgYywgZCksIGUuZmlsbCgpLCBlLnN0cm9rZSgpLCBlLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlID0gdGhpcztcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGEudXRpbC5NZXNzYWdlQnVzLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJzY2VuZVwiLCB0aGlzLmNoaWxkcyA9IFtdLCB0aGlzLnpJbmRleE1hcCA9IHt9LCB0aGlzLnpJbmRleEFycmF5ID0gW10sIHRoaXMuYmFja2dyb3VuZENvbG9yID0gXCIyNTUsMjU1LDI1NVwiLCB0aGlzLnZpc2libGUgPSAhMCwgdGhpcy5hbHBoYSA9IDAsIHRoaXMuc2NhbGVYID0gMSwgdGhpcy5zY2FsZVkgPSAxLCB0aGlzLm1vZGUgPSBhLlNjZW5lTW9kZS5ub3JtYWwsIHRoaXMudHJhbnNsYXRlID0gITAsIHRoaXMudHJhbnNsYXRlWCA9IDAsIHRoaXMudHJhbnNsYXRlWSA9IDAsIHRoaXMubGFzdFRyYW5zbGF0ZVggPSAwLCB0aGlzLmxhc3RUcmFuc2xhdGVZID0gMCwgdGhpcy5tb3VzZURvd24gPSAhMSwgdGhpcy5tb3VzZURvd25YID0gbnVsbCwgdGhpcy5tb3VzZURvd25ZID0gbnVsbCwgdGhpcy5tb3VzZURvd25FdmVudCA9IG51bGwsIHRoaXMuYXJlYVNlbGVjdCA9ICEwLCB0aGlzLm9wZXJhdGlvbnMgPSBbXSwgdGhpcy5zZWxlY3RlZEVsZW1lbnRzID0gW10sIHRoaXMucGFpbnRBbGwgPSAhMTtcclxuICAgICAgICAgICAgdmFyIGMgPSBcImJhY2tncm91bmQsYmFja2dyb3VuZENvbG9yLG1vZGUscGFpbnRBbGwsYXJlYVNlbGVjdCx0cmFuc2xhdGUsdHJhbnNsYXRlWCx0cmFuc2xhdGVZLGxhc3RUcmFuc2xhdGVkWCxsYXN0VHJhbnNsYXRlZFksYWxwaGEsdmlzaWJsZSxzY2FsZVgsc2NhbGVZXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoYylcclxuICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoKSwgdGhpcy5zZXRCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kID0gYVxyXG4gICAgICAgIH0sIHRoaXMuYWRkVG8gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YWdlICE9PSBhICYmIG51bGwgIT0gYSAmJiAodGhpcy5zdGFnZSA9IGEpXHJcbiAgICAgICAgfSwgbnVsbCAhPSBjICYmIChjLmFkZCh0aGlzKSwgdGhpcy5hZGRUbyhjKSksIHRoaXMuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gITBcclxuICAgICAgICB9LCB0aGlzLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9ICExXHJcbiAgICAgICAgfSwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHRoaXMudmlzaWJsZSAmJiBudWxsICE9IHRoaXMuc3RhZ2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhLnNhdmUoKSwgdGhpcy5wYWludEJhY2tncm91ZChhKSwgYS5yZXN0b3JlKCksIGEuc2F2ZSgpLCBhLnNjYWxlKHRoaXMuc2NhbGVYLCB0aGlzLnNjYWxlWSksIDEgPT0gdGhpcy50cmFuc2xhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlKGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEudHJhbnNsYXRlKGIudHJhbnNsYXRlWCwgYi50cmFuc2xhdGVZKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludENoaWxkcyhhKSwgYS5yZXN0b3JlKCksIGEuc2F2ZSgpLCB0aGlzLnBhaW50T3BlcmF0aW9ucyhhLCB0aGlzLm9wZXJhdGlvbnMpLCBhLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5yZXBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgMCAhPSB0aGlzLnZpc2libGUgJiYgdGhpcy5wYWludChhKVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRCYWNrZ3JvdWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBudWxsICE9IHRoaXMuYmFja2dyb3VuZCA/IGEuZHJhd0ltYWdlKHRoaXMuYmFja2dyb3VuZCwgMCwgMCwgYS5jYW52YXMud2lkdGgsIGEuY2FudmFzLmhlaWdodCkgOiAoYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmJhY2tncm91bmRDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxSZWN0KDAsIDAsIGEuY2FudmFzLndpZHRoLCBhLmNhbnZhcy5oZWlnaHQpLCBhLmNsb3NlUGF0aCgpKVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0RGlzcGxheWVkRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCB0aGlzLnpJbmRleEFycmF5Lmxlbmd0aDsgYisrKWZvciAodmFyIGMgPSB0aGlzLnpJbmRleEFycmF5W2JdLCBkID0gdGhpcy56SW5kZXhNYXBbY10sIGUgPSAwOyBlIDwgZC5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBkW2VdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1Zpc2lhYmxlKGYpICYmIGEucHVzaChmKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBhXHJcbiAgICAgICAgfSwgdGhpcy5nZXREaXNwbGF5ZWROb2RlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IFtdLCBjID0gMDsgYyA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuY2hpbGRzW2NdO1xyXG4gICAgICAgICAgICAgICAgZCBpbnN0YW5jZW9mIGEuTm9kZSAmJiB0aGlzLmlzVmlzaWFibGUoZCkgJiYgYi5wdXNoKGQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGJcclxuICAgICAgICB9LCB0aGlzLnBhaW50Q2hpbGRzID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLnpJbmRleEFycmF5Lmxlbmd0aDsgYysrKWZvciAodmFyIGQgPSB0aGlzLnpJbmRleEFycmF5W2NdLCBlID0gdGhpcy56SW5kZXhNYXBbZF0sIGYgPSAwOyBmIDwgZS5sZW5ndGg7IGYrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGcgPSBlW2ZdO1xyXG4gICAgICAgICAgICAgICAgaWYgKDEgPT0gdGhpcy5wYWludEFsbCB8fCB0aGlzLmlzVmlzaWFibGUoZykpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYi5zYXZlKCksIDEgPT0gZy50cmFuc2Zvcm1BYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoID0gZy5nZXRDZW50ZXJMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnRyYW5zbGF0ZShoLngsIGgueSksIGcucm90YXRlICYmIGIucm90YXRlKGcucm90YXRlKSwgZy5zY2FsZVggJiYgZy5zY2FsZVkgPyBiLnNjYWxlKGcuc2NhbGVYLCBnLnNjYWxlWSkgOiBnLnNjYWxlWCA/IGIuc2NhbGUoZy5zY2FsZVgsIDEpIDogZy5zY2FsZVkgJiYgYi5zY2FsZSgxLCBnLnNjYWxlWSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy/mupDnoIHkv67mlLlcclxuICAgICAgICAgICAgICAgICAgICBpZihnLmFsYXJtRmxhc2gpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnLmFsYXJtRmxhc2goKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgMSA9PSBnLnNoYWRvdyAmJiAoYi5zaGFkb3dCbHVyID0gZy5zaGFkb3dCbHVyLCBiLnNoYWRvd0NvbG9yID0gZy5zaGFkb3dDb2xvciwgYi5zaGFkb3dPZmZzZXRYID0gZy5zaGFkb3dPZmZzZXRYLCBiLnNoYWRvd09mZnNldFkgPSBnLnNoYWRvd09mZnNldFkpLCBnIGluc3RhbmNlb2YgYS5JbnRlcmFjdGl2ZUVsZW1lbnQgJiYgKGcuc2VsZWN0ZWQgJiYgMSA9PSBnLnNob3dTZWxlY3RlZCAmJiBnLnBhaW50U2VsZWN0ZWQoYiksIDEgPT0gZy5pc01vdXNlT3ZlciAmJiBnLnBhaW50TW91c2VvdmVyKGIpKSwgZy5wYWludChiKSwgYi5yZXN0b3JlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCwgYyA9IHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodDtcclxuICAgICAgICAgICAgbnVsbCAhPSBhICYmIFwibW92ZVwiICE9IGEgJiYgKGIgPSBhLmNhbnZhcy53aWR0aCwgYyA9IGEuY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgICAgIHZhciBkID0gYiAvIHRoaXMuc2NhbGVYIC8gMiwgZSA9IGMgLyB0aGlzLnNjYWxlWSAvIDIsIGYgPSB7dHJhbnNsYXRlWDogdGhpcy50cmFuc2xhdGVYICsgKGQgLSBkICogdGhpcy5zY2FsZVgpLCB0cmFuc2xhdGVZOiB0aGlzLnRyYW5zbGF0ZVkgKyAoZSAtIGUgKiB0aGlzLnNjYWxlWSl9O1xyXG4gICAgICAgICAgICByZXR1cm4gZlxyXG4gICAgICAgIH0sIHRoaXMuaXNWaXNpYWJsZSA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgIGlmICgxICE9IGIudmlzaWJsZSlyZXR1cm4gITE7XHJcbiAgICAgICAgICAgIGlmIChiIGluc3RhbmNlb2YgYS5MaW5rKXJldHVybiAhMDtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmdldE9mZnNldFRyYW5zbGF0ZSgpLCBkID0gYi54ICsgYy50cmFuc2xhdGVYLCBlID0gYi55ICsgYy50cmFuc2xhdGVZO1xyXG4gICAgICAgICAgICBkICo9IHRoaXMuc2NhbGVYLCBlICo9IHRoaXMuc2NhbGVZO1xyXG4gICAgICAgICAgICB2YXIgZiA9IGQgKyBiLndpZHRoICogdGhpcy5zY2FsZVgsIGcgPSBlICsgYi5oZWlnaHQgKiB0aGlzLnNjYWxlWTtcclxuICAgICAgICAgICAgcmV0dXJuIGQgPiB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCB8fCBlID4gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0IHx8IDAgPiBmIHx8IDAgPiBnID8gITEgOiAhMFxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRPcGVyYXRpb25zID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBiLmxlbmd0aDsgYysrKWJbY10oYSlcclxuICAgICAgICB9LCB0aGlzLmZpbmRFbGVtZW50cyA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCB0aGlzLmNoaWxkcy5sZW5ndGg7IGMrKykxID09IGEodGhpcy5jaGlsZHNbY10pICYmIGIucHVzaCh0aGlzLmNoaWxkc1tjXSk7XHJcbiAgICAgICAgICAgIHJldHVybiBiXHJcbiAgICAgICAgfSwgdGhpcy5nZXRFbGVtZW50c0J5Q2xhc3MgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kRWxlbWVudHMoZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBiIGluc3RhbmNlb2YgYVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sIHRoaXMuYWRkT3BlcmF0aW9uID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3BlcmF0aW9ucy5wdXNoKGEpLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5jbGVhck9wZXJhdGlvbnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wZXJhdGlvbnMgPSBbXSwgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuZ2V0RWxlbWVudEJ5WFkgPSBmdW5jdGlvbiAoYiwgYykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBkID0gbnVsbCwgZSA9IHRoaXMuekluZGV4QXJyYXkubGVuZ3RoIC0gMTsgZSA+PSAwOyBlLS0pZm9yICh2YXIgZiA9IHRoaXMuekluZGV4QXJyYXlbZV0sIGcgPSB0aGlzLnpJbmRleE1hcFtmXSwgaCA9IGcubGVuZ3RoIC0gMTsgaCA+PSAwOyBoLS0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gZ1toXTtcclxuICAgICAgICAgICAgICAgIGlmIChpIGluc3RhbmNlb2YgYS5JbnRlcmFjdGl2ZUVsZW1lbnQgJiYgdGhpcy5pc1Zpc2lhYmxlKGkpICYmIGkuaXNJbkJvdW5kKGIsIGMpKXJldHVybiBkID0gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBkXHJcbiAgICAgICAgfSwgdGhpcy5hZGQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5wdXNoKGEpLCBudWxsID09IHRoaXMuekluZGV4TWFwW2EuekluZGV4XSAmJiAodGhpcy56SW5kZXhNYXBbYS56SW5kZXhdID0gW10sIHRoaXMuekluZGV4QXJyYXkucHVzaChhLnpJbmRleCksIHRoaXMuekluZGV4QXJyYXkuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGEgLSBiXHJcbiAgICAgICAgICAgIH0pKSwgdGhpcy56SW5kZXhNYXBbXCJcIiArIGEuekluZGV4XS5wdXNoKGEpXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmUgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcyA9IGEudXRpbC5yZW1vdmVGcm9tQXJyYXkodGhpcy5jaGlsZHMsIGIpO1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuekluZGV4TWFwW2IuekluZGV4XTtcclxuICAgICAgICAgICAgYyAmJiAodGhpcy56SW5kZXhNYXBbYi56SW5kZXhdID0gYS51dGlsLnJlbW92ZUZyb21BcnJheShjLCBiKSksIGIucmVtb3ZlSGFuZGxlcih0aGlzKVxyXG4gICAgICAgIH0sIHRoaXMuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgYi5yZW1vdmVIYW5kbGVyKGEpXHJcbiAgICAgICAgICAgIH0pLCB0aGlzLmNoaWxkcyA9IFtdLCB0aGlzLm9wZXJhdGlvbnMgPSBbXSwgdGhpcy56SW5kZXhBcnJheSA9IFtdLCB0aGlzLnpJbmRleE1hcCA9IHt9XHJcbiAgICAgICAgfSwgdGhpcy5hZGRUb1NlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEVsZW1lbnRzLnB1c2goYSlcclxuICAgICAgICB9LCB0aGlzLmNhbmNsZUFsbFNlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBiKyspdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2JdLnVuc2VsZWN0ZWRIYW5kbGVyKGEpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRWxlbWVudHMgPSBbXVxyXG4gICAgICAgIH0sIHRoaXMubm90SW5TZWxlY3RlZE5vZGVzID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBiKyspaWYgKGEgPT09IHRoaXMuc2VsZWN0ZWRFbGVtZW50c1tiXSlyZXR1cm4gITE7XHJcbiAgICAgICAgICAgIHJldHVybiAhMFxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlRnJvbVNlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBiKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2JdO1xyXG4gICAgICAgICAgICAgICAgYSA9PT0gYyAmJiAodGhpcy5zZWxlY3RlZEVsZW1lbnRzID0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmRlbChiKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMudG9TY2VuZUV2ZW50ID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBhLnV0aWwuY2xvbmUoYik7XHJcbiAgICAgICAgICAgIGlmIChjLnggLz0gdGhpcy5zY2FsZVgsIGMueSAvPSB0aGlzLnNjYWxlWSwgMSA9PSB0aGlzLnRyYW5zbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmdldE9mZnNldFRyYW5zbGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgYy54IC09IGQudHJhbnNsYXRlWCwgYy55IC09IGQudHJhbnNsYXRlWVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsICE9IGMuZHggJiYgKGMuZHggLz0gdGhpcy5zY2FsZVgsIGMuZHkgLz0gdGhpcy5zY2FsZVkpLCBudWxsICE9IHRoaXMuY3VycmVudEVsZW1lbnQgJiYgKGMudGFyZ2V0ID0gdGhpcy5jdXJyZW50RWxlbWVudCksIGMuc2NlbmUgPSB0aGlzLCBjXHJcbiAgICAgICAgfSwgdGhpcy5zZWxlY3RFbGVtZW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBlLmdldEVsZW1lbnRCeVhZKGEueCwgYS55KTtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gYilpZiAoYS50YXJnZXQgPSBiLCBiLm1vdXNlZG93bkhhbmRlcihhKSwgYi5zZWxlY3RlZEhhbmRsZXIoYSksIGUubm90SW5TZWxlY3RlZE5vZGVzKGIpKWEuY3RybEtleSB8fCBlLmNhbmNsZUFsbFNlbGVjdGVkKCksIGUuYWRkVG9TZWxlY3RlZChiKTsgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAxID09IGEuY3RybEtleSAmJiAoYi51bnNlbGVjdGVkSGFuZGxlcigpLCB0aGlzLnJlbW92ZUZyb21TZWxlY3RlZChiKSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2NdO1xyXG4gICAgICAgICAgICAgICAgICAgIGQuc2VsZWN0ZWRIYW5kbGVyKGEpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBhLmN0cmxLZXkgfHwgZS5jYW5jbGVBbGxTZWxlY3RlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50ID0gYlxyXG4gICAgICAgIH0sIHRoaXMubW91c2Vkb3duSGFuZGxlciA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy50b1NjZW5lRXZlbnQoYik7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1vdXNlRG93biA9ICEwLCB0aGlzLm1vdXNlRG93blggPSBjLngsIHRoaXMubW91c2VEb3duWSA9IGMueSwgdGhpcy5tb3VzZURvd25FdmVudCA9IGMsIHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5ub3JtYWwpdGhpcy5zZWxlY3RFbGVtZW50KGMpLCAobnVsbCA9PSB0aGlzLmN1cnJlbnRFbGVtZW50IHx8IHRoaXMuY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBhLkxpbmspICYmIDEgPT0gdGhpcy50cmFuc2xhdGUgJiYgKHRoaXMubGFzdFRyYW5zbGF0ZVggPSB0aGlzLnRyYW5zbGF0ZVgsIHRoaXMubGFzdFRyYW5zbGF0ZVkgPSB0aGlzLnRyYW5zbGF0ZVkpOyBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT0gYS5TY2VuZU1vZGUuZHJhZyAmJiAxID09IHRoaXMudHJhbnNsYXRlKXJldHVybiB0aGlzLmxhc3RUcmFuc2xhdGVYID0gdGhpcy50cmFuc2xhdGVYLCB2b2lkKHRoaXMubGFzdFRyYW5zbGF0ZVkgPSB0aGlzLnRyYW5zbGF0ZVkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLnNlbGVjdCA/IHRoaXMuc2VsZWN0RWxlbWVudChjKSA6IHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5lZGl0ICYmICh0aGlzLnNlbGVjdEVsZW1lbnQoYyksIChudWxsID09IHRoaXMuY3VycmVudEVsZW1lbnQgfHwgdGhpcy5jdXJyZW50RWxlbWVudCBpbnN0YW5jZW9mIGEuTGluaykgJiYgMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5sYXN0VHJhbnNsYXRlWCA9IHRoaXMudHJhbnNsYXRlWCwgdGhpcy5sYXN0VHJhbnNsYXRlWSA9IHRoaXMudHJhbnNsYXRlWSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZS5kaXNwYXRjaEV2ZW50KFwibW91c2Vkb3duXCIsIGMpXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZXVwSGFuZGxlciA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhZ2UuY3Vyc29yICE9IGEuTW91c2VDdXJzb3Iubm9ybWFsICYmICh0aGlzLnN0YWdlLmN1cnNvciA9IGEuTW91c2VDdXJzb3Iubm9ybWFsKSwgZS5jbGVhck9wZXJhdGlvbnMoKTtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChiKTtcclxuICAgICAgICAgICAgbnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50ICYmIChjLnRhcmdldCA9IGUuY3VycmVudEVsZW1lbnQsIHRoaXMuY3VycmVudEVsZW1lbnQubW91c2V1cEhhbmRsZXIoYykpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZXVwXCIsIGMpLCB0aGlzLm1vdXNlRG93biA9ICExXHJcbiAgICAgICAgfSwgdGhpcy5kcmFnRWxlbWVudHMgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50ICYmIDEgPT0gdGhpcy5jdXJyZW50RWxlbWVudC5kcmFnYWJsZSlmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHNbY107XHJcbiAgICAgICAgICAgICAgICBpZiAoMCAhPSBkLmRyYWdhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhLnV0aWwuY2xvbmUoYik7XHJcbiAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQgPSBkLCBkLm1vdXNlZHJhZ0hhbmRsZXIoZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMubW91c2VkcmFnSGFuZGxlciA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy50b1NjZW5lRXZlbnQoYik7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5ub3JtYWwgPyBudWxsID09IHRoaXMuY3VycmVudEVsZW1lbnQgfHwgdGhpcy5jdXJyZW50RWxlbWVudCBpbnN0YW5jZW9mIGEuTGluayA/IDEgPT0gdGhpcy50cmFuc2xhdGUgJiYgKHRoaXMuc3RhZ2UuY3Vyc29yID0gYS5Nb3VzZUN1cnNvci5jbG9zZWRfaGFuZCwgdGhpcy50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCArIGMuZHgsIHRoaXMudHJhbnNsYXRlWSA9IHRoaXMubGFzdFRyYW5zbGF0ZVkgKyBjLmR5KSA6IHRoaXMuZHJhZ0VsZW1lbnRzKGMpIDogdGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLmRyYWcgPyAxID09IHRoaXMudHJhbnNsYXRlICYmICh0aGlzLnN0YWdlLmN1cnNvciA9IGEuTW91c2VDdXJzb3IuY2xvc2VkX2hhbmQsIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBjLmR4LCB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmxhc3RUcmFuc2xhdGVZICsgYy5keSkgOiB0aGlzLm1vZGUgPT0gYS5TY2VuZU1vZGUuc2VsZWN0ID8gbnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50ID8gMSA9PSB0aGlzLmN1cnJlbnRFbGVtZW50LmRyYWdhYmxlICYmIHRoaXMuZHJhZ0VsZW1lbnRzKGMpIDogMSA9PSB0aGlzLmFyZWFTZWxlY3QgJiYgdGhpcy5hcmVhU2VsZWN0SGFuZGxlKGMpIDogdGhpcy5tb2RlID09IGEuU2NlbmVNb2RlLmVkaXQgJiYgKG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YgYS5MaW5rID8gMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBhLk1vdXNlQ3Vyc29yLmNsb3NlZF9oYW5kLCB0aGlzLnRyYW5zbGF0ZVggPSB0aGlzLmxhc3RUcmFuc2xhdGVYICsgYy5keCwgdGhpcy50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSArIGMuZHkpIDogdGhpcy5kcmFnRWxlbWVudHMoYykpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRyYWdcIiwgYylcclxuICAgICAgICB9LCB0aGlzLmFyZWFTZWxlY3RIYW5kbGUgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IGEub2Zmc2V0TGVmdCwgYyA9IGEub2Zmc2V0VG9wLCBmID0gdGhpcy5tb3VzZURvd25FdmVudC5vZmZzZXRMZWZ0LCBnID0gdGhpcy5tb3VzZURvd25FdmVudC5vZmZzZXRUb3AsIGggPSBiID49IGYgPyBmIDogYiwgaSA9IGMgPj0gZyA/IGcgOiBjLCBqID0gTWF0aC5hYnMoYS5keCkgKiB0aGlzLnNjYWxlWCwgayA9IE1hdGguYWJzKGEuZHkpICogdGhpcy5zY2FsZVksIGwgPSBuZXcgZChoLCBpLCBqLCBrKTtcclxuICAgICAgICAgICAgZS5jbGVhck9wZXJhdGlvbnMoKS5hZGRPcGVyYXRpb24obCksIGIgPSBhLngsIGMgPSBhLnksIGYgPSB0aGlzLm1vdXNlRG93bkV2ZW50LngsIGcgPSB0aGlzLm1vdXNlRG93bkV2ZW50LnksIGggPSBiID49IGYgPyBmIDogYiwgaSA9IGMgPj0gZyA/IGcgOiBjLCBqID0gTWF0aC5hYnMoYS5keCksIGsgPSBNYXRoLmFicyhhLmR5KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgbSA9IGggKyBqLCBuID0gaSArIGssIG8gPSAwOyBvIDwgZS5jaGlsZHMubGVuZ3RoOyBvKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gZS5jaGlsZHNbb107XHJcbiAgICAgICAgICAgICAgICBwLnggPiBoICYmIHAueCArIHAud2lkdGggPCBtICYmIHAueSA+IGkgJiYgcC55ICsgcC5oZWlnaHQgPCBuICYmIGUubm90SW5TZWxlY3RlZE5vZGVzKHApICYmIChwLnNlbGVjdGVkSGFuZGxlcihhKSwgZS5hZGRUb1NlbGVjdGVkKHApKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZWNvb3JkID0ge3g6IGIueCwgeTogYi55fTtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChiKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5kcmFnKXJldHVybiB2b2lkKHRoaXMuc3RhZ2UuY3Vyc29yID0gYS5Nb3VzZUN1cnNvci5vcGVuX2hhbmQpO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGUgPT0gYS5TY2VuZU1vZGUubm9ybWFsID8gdGhpcy5zdGFnZS5jdXJzb3IgPSBhLk1vdXNlQ3Vyc29yLm5vcm1hbCA6IHRoaXMubW9kZSA9PSBhLlNjZW5lTW9kZS5zZWxlY3QgJiYgKHRoaXMuc3RhZ2UuY3Vyc29yID0gYS5Nb3VzZUN1cnNvci5ub3JtYWwpO1xyXG4gICAgICAgICAgICB2YXIgZCA9IGUuZ2V0RWxlbWVudEJ5WFkoYy54LCBjLnkpO1xyXG4gICAgICAgICAgICBudWxsICE9IGQgPyAoZS5tb3VzZU92ZXJlbGVtZW50ICYmIGUubW91c2VPdmVyZWxlbWVudCAhPT0gZCAmJiAoYy50YXJnZXQgPSBkLCBlLm1vdXNlT3ZlcmVsZW1lbnQubW91c2VvdXRIYW5kbGVyKGMpKSwgZS5tb3VzZU92ZXJlbGVtZW50ID0gZCwgMCA9PSBkLmlzTW91c2VPdmVyID8gKGMudGFyZ2V0ID0gZCwgZC5tb3VzZW92ZXJIYW5kbGVyKGMpLCBlLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW92ZXJcIiwgYykpIDogKGMudGFyZ2V0ID0gZCwgZC5tb3VzZW1vdmVIYW5kbGVyKGMpLCBlLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW1vdmVcIiwgYykpKSA6IGUubW91c2VPdmVyZWxlbWVudCA/IChjLnRhcmdldCA9IGQsIGUubW91c2VPdmVyZWxlbWVudC5tb3VzZW91dEhhbmRsZXIoYyksIGUubW91c2VPdmVyZWxlbWVudCA9IG51bGwsIGUuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3V0XCIsIGMpKSA6IChjLnRhcmdldCA9IG51bGwsIGUuZGlzcGF0Y2hFdmVudChcIm1vdXNlbW92ZVwiLCBjKSlcclxuICAgICAgICB9LCB0aGlzLm1vdXNlb3ZlckhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMudG9TY2VuZUV2ZW50KGEpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW92ZXJcIiwgYilcclxuICAgICAgICB9LCB0aGlzLm1vdXNlb3V0SGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy50b1NjZW5lRXZlbnQoYSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3V0XCIsIGIpXHJcbiAgICAgICAgfSwgdGhpcy5jbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMudG9TY2VuZUV2ZW50KGEpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50ICYmIChiLnRhcmdldCA9IHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMuY3VycmVudEVsZW1lbnQuY2xpY2tIYW5kbGVyKGIpKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwiY2xpY2tcIiwgYilcclxuICAgICAgICB9LCB0aGlzLmRiY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudCA/IChiLnRhcmdldCA9IHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMuY3VycmVudEVsZW1lbnQuZGJjbGlja0hhbmRsZXIoYikpIDogZS5jYW5jbGVBbGxTZWxlY3RlZCgpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJkYmNsaWNrXCIsIGIpXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZXdoZWVsSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy50b1NjZW5lRXZlbnQoYSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNld2hlZWxcIiwgYilcclxuICAgICAgICB9LCB0aGlzLnRvdWNoc3RhcnQgPSB0aGlzLm1vdXNlZG93bkhhbmRlciwgdGhpcy50b3VjaG1vdmUgPSB0aGlzLm1vdXNlZHJhZ0hhbmRsZXIsIHRoaXMudG91Y2hlbmQgPSB0aGlzLm1vdXNlZG93bkhhbmRlciwgdGhpcy5rZXlkb3duSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImtleWRvd25cIiwgYSlcclxuICAgICAgICB9LCB0aGlzLmtleXVwSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImtleXVwXCIsIGEpXHJcbiAgICAgICAgfSwgdGhpcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLCBkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGIuY2FsbChjLCBhKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlQnVzLnN1YnNjcmliZShhLCBkKSwgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy51bnN1YnNjcmliZShhKVxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlQWxsRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGEudXRpbC5NZXNzYWdlQnVzXHJcbiAgICAgICAgfSwgdGhpcy5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUJ1cy5wdWJsaXNoKGEsIGIpLCB0aGlzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZiA9IFwiY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcIi5zcGxpdChcIixcIiksIGcgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBmLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZ1thXSA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBudWxsICE9IGIgPyB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoYSwgYikgOiB0aGlzLmRpc3BhdGNoRXZlbnQoYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLCB0aGlzLnpvb20gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBudWxsICE9IGEgJiYgMCAhPSBhICYmICh0aGlzLnNjYWxlWCA9IGEpLCBudWxsICE9IGIgJiYgMCAhPSBiICYmICh0aGlzLnNjYWxlWSA9IGIpXHJcbiAgICAgICAgfSwgdGhpcy56b29tT3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgMCAhPSBhICYmIChudWxsID09IGEgJiYgKGEgPSAuOCksIHRoaXMuc2NhbGVYIC89IGEsIHRoaXMuc2NhbGVZIC89IGEpXHJcbiAgICAgICAgfSwgdGhpcy56b29tSW4gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAwICE9IGEgJiYgKG51bGwgPT0gYSAmJiAoYSA9IC44KSwgdGhpcy5zY2FsZVggKj0gYSwgdGhpcy5zY2FsZVkgKj0gYSlcclxuICAgICAgICB9LCB0aGlzLmdldEJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge2xlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoLCBib3R0b206IHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodCwgd2lkdGg6IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoLCBoZWlnaHQ6IHRoaXMuc3RhZ2UuY2FudmFzLmhlaWdodH1cclxuICAgICAgICB9LCB0aGlzLmdldEVsZW1lbnRzQm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhLnV0aWwuZ2V0RWxlbWVudHNCb3VuZCh0aGlzLmNoaWxkcylcclxuICAgICAgICB9LCB0aGlzLnRyYW5zbGF0ZVRvQ2VudGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmdldEVsZW1lbnRzQm91bmQoKSwgYyA9IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoIC8gMiAtIChiLmxlZnQgKyBiLnJpZ2h0KSAvIDIsIGQgPSB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyAyIC0gKGIudG9wICsgYi5ib3R0b20pIC8gMjtcclxuICAgICAgICAgICAgYSAmJiAoYyA9IGEuY2FudmFzLndpZHRoIC8gMiAtIChiLmxlZnQgKyBiLnJpZ2h0KSAvIDIsIGQgPSBhLmNhbnZhcy5oZWlnaHQgLyAyIC0gKGIudG9wICsgYi5ib3R0b20pIC8gMiksIHRoaXMudHJhbnNsYXRlWCA9IGMsIHRoaXMudHJhbnNsYXRlWSA9IGRcclxuICAgICAgICB9LCB0aGlzLnNldENlbnRlciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gYSAtIHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoIC8gMiwgZCA9IGIgLSB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVggPSAtYywgdGhpcy50cmFuc2xhdGVZID0gLWRcclxuICAgICAgICB9LCB0aGlzLmNlbnRlckFuZFpvb20gPSBmdW5jdGlvbiAoYSwgYiwgYykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50cmFuc2xhdGVUb0NlbnRlcihjKSwgbnVsbCA9PSBhIHx8IG51bGwgPT0gYikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmdldEVsZW1lbnRzQm91bmQoKSwgZSA9IGQucmlnaHQgLSBkLmxlZnQsIGYgPSBkLmJvdHRvbSAtIGQudG9wLCBnID0gdGhpcy5zdGFnZS5jYW52YXMud2lkdGggLyBlLCBoID0gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0IC8gZjtcclxuICAgICAgICAgICAgICAgIGMgJiYgKGcgPSBjLmNhbnZhcy53aWR0aCAvIGUsIGggPSBjLmNhbnZhcy5oZWlnaHQgLyBmKTtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gTWF0aC5taW4oZywgaCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+IDEpcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgdGhpcy56b29tKGksIGkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy56b29tKGEsIGIpXHJcbiAgICAgICAgfSwgdGhpcy5nZXRDZW50ZXJMb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHt4OiBlLnN0YWdlLmNhbnZhcy53aWR0aCAvIDIsIHk6IGUuc3RhZ2UuY2FudmFzLmhlaWdodCAvIDJ9XHJcbiAgICAgICAgfSwgdGhpcy5kb0xheW91dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEgJiYgYSh0aGlzLCB0aGlzLmNoaWxkcylcclxuICAgICAgICB9LCB0aGlzLnRvSnNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLCBiID0gXCJ7XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBhW2NdO1xyXG4gICAgICAgICAgICAgICAgXCJiYWNrZ3JvdW5kXCIgPT0gYyAmJiAoZCA9IGEuX2JhY2tncm91bmQuc3JjKSwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZCAmJiAoZCA9ICdcIicgKyBkICsgJ1wiJyksIGIgKz0gJ1wiJyArIGMgKyAnXCI6JyArIGQgKyBcIixcIlxyXG4gICAgICAgICAgICB9KSwgYiArPSAnXCJjaGlsZHNcIjpbJztcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmNoaWxkcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChhLCBkKSB7XHJcbiAgICAgICAgICAgICAgICBiICs9IGEudG9Kc29uKCksIGMgPiBkICsgMSAmJiAoYiArPSBcIixcIilcclxuICAgICAgICAgICAgfSksIGIgKz0gXCJdXCIsIGIgKz0gXCJ9XCJcclxuICAgICAgICB9LCBlXHJcbiAgICB9XHJcblxyXG4gICAgYi5wcm90b3R5cGUgPSBuZXcgYS5FbGVtZW50O1xyXG4gICAgdmFyIGMgPSB7fTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGIucHJvdG90eXBlLCB7XHJcbiAgICAgICAgYmFja2dyb3VuZDoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBjW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgIG51bGwgPT0gYiAmJiAoYiA9IG5ldyBJbWFnZSwgYi5zcmMgPSBhLCBiLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY1thXSA9IGJcclxuICAgICAgICAgICAgICAgICAgICB9KSwgdGhpcy5fYmFja2dyb3VuZCA9IGJcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB0aGlzLl9iYWNrZ3JvdW5kID0gYVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSksIGEuU2NlbmUgPSBiXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYigpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5lbGVtZW50VHlwZSA9IFwiZGlzcGxheUVsZW1lbnRcIiwgdGhpcy54ID0gMCwgdGhpcy55ID0gMCwgdGhpcy53aWR0aCA9IDMyLCB0aGlzLmhlaWdodCA9IDMyLCB0aGlzLnZpc2libGUgPSAhMCwgdGhpcy5hbHBoYSA9IDEsIHRoaXMucm90YXRlID0gMCwgdGhpcy5zY2FsZVggPSAxLCB0aGlzLnNjYWxlWSA9IDEsIHRoaXMuc3Ryb2tlQ29sb3IgPSBcIjIyLDEyNCwyNTVcIiwgdGhpcy5ib3JkZXJDb2xvciA9IFwiMjIsMTI0LDI1NVwiLCB0aGlzLmZpbGxDb2xvciA9IFwiMjIsMTI0LDI1NVwiLCB0aGlzLnNoYWRvdyA9ICExLCB0aGlzLnNoYWRvd0JsdXIgPSA1LCB0aGlzLnNoYWRvd0NvbG9yID0gXCJyZ2JhKDAsMCwwLDAuNSlcIiwgdGhpcy5zaGFkb3dPZmZzZXRYID0gMywgdGhpcy5zaGFkb3dPZmZzZXRZID0gNiwgdGhpcy50cmFuc2Zvcm1BYmxlID0gITEsIHRoaXMuekluZGV4ID0gMDtcclxuICAgICAgICAgICAgdmFyIGEgPSBcIngseSx3aWR0aCxoZWlnaHQsdmlzaWJsZSxhbHBoYSxyb3RhdGUsc2NhbGVYLHNjYWxlWSxzdHJva2VDb2xvcixmaWxsQ29sb3Isc2hhZG93LHNoYWRvd0NvbG9yLHNoYWRvd09mZnNldFgsc2hhZG93T2Zmc2V0WSx0cmFuc2Zvcm1BYmxlLHpJbmRleFwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuY29uY2F0KGEpXHJcbiAgICAgICAgfSwgdGhpcy5pbml0aWFsaXplKCksIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEucmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KSwgYS5maWxsKCksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICB9LCB0aGlzLmdldExvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge3g6IHRoaXMueCwgeTogdGhpcy55fVxyXG4gICAgICAgIH0sIHRoaXMuc2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ID0gYSwgdGhpcy55ID0gYiwgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuZ2V0Q2VudGVyTG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7eDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIsIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMn1cclxuICAgICAgICB9LCB0aGlzLnNldENlbnRlckxvY2F0aW9uID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueCA9IGEgLSB0aGlzLndpZHRoIC8gMiwgdGhpcy55ID0gYiAtIHRoaXMuaGVpZ2h0IC8gMiwgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHt3aWR0aDogdGhpcy53aWR0aCwgaGVpZ2h0OiB0aGlzLmhlaXRofVxyXG4gICAgICAgIH0sIHRoaXMuc2V0U2l6ZSA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndpZHRoID0gYSwgdGhpcy5oZWlnaHQgPSBiLCB0aGlzXHJcbiAgICAgICAgfSwgdGhpcy5nZXRCb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtsZWZ0OiB0aGlzLngsIHRvcDogdGhpcy55LCByaWdodDogdGhpcy54ICsgdGhpcy53aWR0aCwgYm90dG9tOiB0aGlzLnkgKyB0aGlzLmhlaWdodCwgd2lkdGg6IHRoaXMud2lkdGgsIGhlaWdodDogdGhpcy5oZWlnaHR9XHJcbiAgICAgICAgfSwgdGhpcy5zZXRCb3VuZCA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldExvY2F0aW9uKGEsIGIpLCB0aGlzLnNldFNpemUoYywgZCksIHRoaXNcclxuICAgICAgICB9LCB0aGlzLmdldERpc3BsYXlCb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtsZWZ0OiB0aGlzLngsIHRvcDogdGhpcy55LCByaWdodDogdGhpcy54ICsgdGhpcy53aWR0aCAqIHRoaXMuc2NhbGVYLCBib3R0b206IHRoaXMueSArIHRoaXMuaGVpZ2h0ICogdGhpcy5zY2FsZVl9XHJcbiAgICAgICAgfSwgdGhpcy5nZXREaXNwbGF5U2l6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHt3aWR0aDogdGhpcy53aWR0aCAqIHRoaXMuc2NhbGVYLCBoZWlnaHQ6IHRoaXMuaGVpZ2h0ICogdGhpcy5zY2FsZVl9XHJcbiAgICAgICAgfSwgdGhpcy5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiLCBjID0gdGhpcy5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gXCJUb3BfTGVmdFwiID09IGEgPyBiID0ge3g6IGMubGVmdCwgeTogYy50b3B9IDogXCJUb3BfQ2VudGVyXCIgPT0gYSA/IGIgPSB7eDogdGhpcy5jeCwgeTogYy50b3B9IDogXCJUb3BfUmlnaHRcIiA9PSBhID8gYiA9IHt4OiBjLnJpZ2h0LCB5OiBjLnRvcH0gOiBcIk1pZGRsZV9MZWZ0XCIgPT0gYSA/IGIgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiBjLmxlZnQsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLmN5XHJcbiAgICAgICAgICAgIH0gOiBcIk1pZGRsZV9DZW50ZXJcIiA9PSBhID8gYiA9IHt4OiB0aGlzLmN4LCB5OiB0aGlzLmN5fSA6IFwiTWlkZGxlX1JpZ2h0XCIgPT0gYSA/IGIgPSB7eDogYy5yaWdodCwgeTogdGhpcy5jeX0gOiBcIkJvdHRvbV9MZWZ0XCIgPT0gYSA/IGIgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiBjLmxlZnQsXHJcbiAgICAgICAgICAgICAgICB5OiBjLmJvdHRvbVxyXG4gICAgICAgICAgICB9IDogXCJCb3R0b21fQ2VudGVyXCIgPT0gYSA/IGIgPSB7eDogdGhpcy5jeCwgeTogYy5ib3R0b219IDogXCJCb3R0b21fUmlnaHRcIiA9PSBhICYmIChiID0ge3g6IGMucmlnaHQsIHk6IGMuYm90dG9tfSksIGJcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGMucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5lbGVtZW50VHlwZSA9IFwiaW50ZXJhY3RpdmVFbGVtZW50XCIsIHRoaXMuZHJhZ2FibGUgPSAhMSwgdGhpcy5zZWxlY3RlZCA9ICExLCB0aGlzLnNob3dTZWxlY3RlZCA9ICEwLCB0aGlzLnNlbGVjdGVkTG9jYXRpb24gPSBudWxsLCB0aGlzLmlzTW91c2VPdmVyID0gITE7XHJcbiAgICAgICAgICAgIHZhciBhID0gXCJkcmFnYWJsZSxzZWxlY3RlZCxzaG93U2VsZWN0ZWQsaXNNb3VzZU92ZXJcIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChhKVxyXG4gICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZSgpLCB0aGlzLnBhaW50U2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAwICE9IHRoaXMuc2hvd1NlbGVjdGVkICYmIChhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5zdHJva2VTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDI1NSwgMC45KVwiLCBhLmZpbGxTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDIzNiwwLjcpXCIsIGEucmVjdCgtdGhpcy53aWR0aCAvIDIgLSAzLCAtdGhpcy5oZWlnaHQgLyAyIC0gMywgdGhpcy53aWR0aCArIDYsIHRoaXMuaGVpZ2h0ICsgNiksIGEuZmlsbCgpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKSlcclxuICAgICAgICB9LCB0aGlzLnBhaW50TW91c2VvdmVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFpbnRTZWxlY3RlZChhKVxyXG4gICAgICAgIH0sIHRoaXMuaXNJbkJvdW5kID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEgPiB0aGlzLnggJiYgYSA8IHRoaXMueCArIHRoaXMud2lkdGggKiBNYXRoLmFicyh0aGlzLnNjYWxlWCkgJiYgYiA+IHRoaXMueSAmJiBiIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgKiBNYXRoLmFicyh0aGlzLnNjYWxlWSlcclxuICAgICAgICB9LCB0aGlzLnNlbGVjdGVkSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICEwLCB0aGlzLnNlbGVjdGVkTG9jYXRpb24gPSB7eDogdGhpcy54LCB5OiB0aGlzLnl9XHJcbiAgICAgICAgfSwgdGhpcy51bnNlbGVjdGVkSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICExLCB0aGlzLnNlbGVjdGVkTG9jYXRpb24gPSBudWxsXHJcbiAgICAgICAgfSwgdGhpcy5kYmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImRiY2xpY2tcIiwgYSlcclxuICAgICAgICB9LCB0aGlzLmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImNsaWNrXCIsIGEpXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZWRvd25IYW5kZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRvd25cIiwgYSlcclxuICAgICAgICB9LCB0aGlzLm1vdXNldXBIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2V1cFwiLCBhKVxyXG4gICAgICAgIH0sIHRoaXMubW91c2VvdmVySGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNb3VzZU92ZXIgPSAhMCwgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdmVyXCIsIGEpXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGEpXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZW91dEhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmlzTW91c2VPdmVyID0gITEsIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3V0XCIsIGEpXHJcbiAgICAgICAgfSwgdGhpcy5tb3VzZWRyYWdIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueCArIGEuZHgsIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0TG9jYXRpb24oYiwgYyksIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZHJhZ1wiLCBhKVxyXG4gICAgICAgIH0sIHRoaXMuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gdGhpcywgZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBjLmNhbGwoZCwgYSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUJ1cyB8fCAodGhpcy5tZXNzYWdlQnVzID0gbmV3IGEudXRpbC5NZXNzYWdlQnVzKSwgdGhpcy5tZXNzYWdlQnVzLnN1YnNjcmliZShiLCBlKSwgdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VCdXMgPyAodGhpcy5tZXNzYWdlQnVzLnB1Ymxpc2goYSwgYiksIHRoaXMpIDogbnVsbFxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy51bnN1YnNjcmliZShhKVxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlQWxsRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGEudXRpbC5NZXNzYWdlQnVzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYiA9IFwiY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZFwiLnNwbGl0KFwiLFwiKSwgZCA9IHRoaXM7XHJcbiAgICAgICAgYi5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGRbYV0gPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgbnVsbCAhPSBiID8gdGhpcy5hZGRFdmVudExpc3RlbmVyKGEsIGIpIDogdGhpcy5kaXNwYXRjaEV2ZW50KGEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuZWRpdEFibGUgPSAhMSwgdGhpcy5zZWxlY3RlZFBvaW50ID0gbnVsbFxyXG4gICAgICAgIH0sIHRoaXMuZ2V0Q3RybFBvc2l0aW9uID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSA1LCBjID0gNSwgZCA9IHRoaXMuZ2V0UG9zaXRpb24oYSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7bGVmdDogZC54IC0gYiwgdG9wOiBkLnkgLSBjLCByaWdodDogZC54ICsgYiwgYm90dG9tOiBkLnkgKyBjfVxyXG4gICAgICAgIH0sIHRoaXMuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgZC5wcm90b3R5cGUuc2VsZWN0ZWRIYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuc2VsZWN0ZWRTaXplID0ge3dpZHRoOiB0aGlzLndpZHRoLCBoZWlnaHQ6IHRoaXMuaGVpZ2h0fSwgYi5zY2VuZS5tb2RlID09IGEuU2NlbmVNb2RlLmVkaXQgJiYgKHRoaXMuZWRpdEFibGUgPSAhMClcclxuICAgICAgICB9LCB0aGlzLnVuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkLnByb3RvdHlwZS51bnNlbGVjdGVkSGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLnNlbGVjdGVkU2l6ZSA9IG51bGwsIHRoaXMuZWRpdEFibGUgPSAhMVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGIgPSBbXCJUb3BfTGVmdFwiLCBcIlRvcF9DZW50ZXJcIiwgXCJUb3BfUmlnaHRcIiwgXCJNaWRkbGVfTGVmdFwiLCBcIk1pZGRsZV9SaWdodFwiLCBcIkJvdHRvbV9MZWZ0XCIsIFwiQm90dG9tX0NlbnRlclwiLCBcIkJvdHRvbV9SaWdodFwiXTtcclxuICAgICAgICB0aGlzLnBhaW50Q3RybCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHRoaXMuZWRpdEFibGUpIHtcclxuICAgICAgICAgICAgICAgIGEuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBiLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmdldEN0cmxQb3NpdGlvbihiW2NdKTtcclxuICAgICAgICAgICAgICAgICAgICBkLmxlZnQgLT0gdGhpcy5jeCwgZC5yaWdodCAtPSB0aGlzLmN4LCBkLnRvcCAtPSB0aGlzLmN5LCBkLmJvdHRvbSAtPSB0aGlzLmN5O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gZC5yaWdodCAtIGQubGVmdCwgZiA9IGQuYm90dG9tIC0gZC50b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMCwwLjgpXCIsIGEucmVjdChkLmxlZnQsIGQudG9wLCBlLCBmKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgYS5iZWdpblBhdGgoKSwgYS5zdHJva2VTdHlsZSA9IFwicmdiYSgyNTUsMjU1LDI1NSwwLjMpXCIsIGEucmVjdChkLmxlZnQgKyAxLCBkLnRvcCArIDEsIGUgLSAyLCBmIC0gMiksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLmlzSW5Cb3VuZCA9IGZ1bmN0aW9uIChhLCBjKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUG9pbnQgPSBudWxsLCAxID09IHRoaXMuZWRpdEFibGUpZm9yICh2YXIgZSA9IDA7IGUgPCBiLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IHRoaXMuZ2V0Q3RybFBvc2l0aW9uKGJbZV0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEgPiBmLmxlZnQgJiYgYSA8IGYucmlnaHQgJiYgYyA+IGYudG9wICYmIGMgPCBmLmJvdHRvbSlyZXR1cm4gdGhpcy5zZWxlY3RlZFBvaW50ID0gYltlXSwgITBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZC5wcm90b3R5cGUuaXNJbkJvdW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcclxuICAgICAgICB9LCB0aGlzLm1vdXNlZHJhZ0hhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnggKyBhLmR4LCBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRMb2NhdGlvbihiLCBjKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VkcmFnXCIsIGEpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoXCJUb3BfTGVmdFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZFNpemUud2lkdGggLSBhLmR4LCBlID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0IC0gYS5keSwgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keCwgYyA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi55ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICBiIDwgdGhpcy54ICsgdGhpcy53aWR0aCAmJiAodGhpcy54ID0gYiwgdGhpcy53aWR0aCA9IGQpLCBjIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgJiYgKHRoaXMueSA9IGMsIHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJUb3BfQ2VudGVyXCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgLSBhLmR5LCBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGMgPCB0aGlzLnkgKyB0aGlzLmhlaWdodCAmJiAodGhpcy55ID0gYywgdGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIlRvcF9SaWdodFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZFNpemUud2lkdGggKyBhLmR4LCBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGMgPCB0aGlzLnkgKyB0aGlzLmhlaWdodCAmJiAodGhpcy55ID0gYywgdGhpcy5oZWlnaHQgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgLSBhLmR5KSwgZCA+IDEgJiYgKHRoaXMud2lkdGggPSBkKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIk1pZGRsZV9MZWZ0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCAtIGEuZHgsIGIgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueCArIGEuZHg7XHJcbiAgICAgICAgICAgICAgICAgICAgYiA8IHRoaXMueCArIHRoaXMud2lkdGggJiYgKHRoaXMueCA9IGIpLCBkID4gMSAmJiAodGhpcy53aWR0aCA9IGQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiTWlkZGxlX1JpZ2h0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCArIGEuZHg7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA+IDEgJiYgKHRoaXMud2lkdGggPSBkKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIkJvdHRvbV9MZWZ0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCAtIGEuZHgsIGIgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueCArIGEuZHg7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA+IDEgJiYgKHRoaXMueCA9IGIsIHRoaXMud2lkdGggPSBkKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA+IDEgJiYgKHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJCb3R0b21fQ2VudGVyXCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPiAxICYmICh0aGlzLmhlaWdodCA9IGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiQm90dG9tX1JpZ2h0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCArIGEuZHg7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA+IDEgJiYgKHRoaXMud2lkdGggPSBkKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA+IDEgJiYgKHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcInJlc2l6ZVwiLCBhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGIucHJvdG90eXBlID0gbmV3IGEuRWxlbWVudCwgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYi5wcm90b3R5cGUsIHtcclxuICAgICAgICBjeDoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnggKyB0aGlzLndpZHRoIC8gMlxyXG4gICAgICAgICAgICB9LCBzZXQ6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnggPSBhIC0gdGhpcy53aWR0aCAvIDJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGN5OiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMlxyXG4gICAgICAgICAgICB9LCBzZXQ6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnkgPSBhIC0gdGhpcy5oZWlnaHQgLyAyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KSwgYy5wcm90b3R5cGUgPSBuZXcgYiwgZC5wcm90b3R5cGUgPSBuZXcgYywgYS5EaXNwbGF5RWxlbWVudCA9IGIsIGEuSW50ZXJhY3RpdmVFbGVtZW50ID0gYywgYS5FZGl0YWJsZUVsZW1lbnQgPSBkXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihjKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgYi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJub2RlXCIsIHRoaXMuekluZGV4ID0gYS56SW5kZXhfTm9kZSwgdGhpcy50ZXh0ID0gYywgdGhpcy5mb250ID0gXCIxMnB4IENvbnNvbGFzXCIsIHRoaXMuZm9udENvbG9yID0gXCIyNTUsMjU1LDI1NVwiLCB0aGlzLmJvcmRlcldpZHRoID0gMCwgdGhpcy5ib3JkZXJDb2xvciA9IFwiMjU1LDI1NSwyNTVcIiwgdGhpcy5ib3JkZXJSYWRpdXMgPSBudWxsLCB0aGlzLmRyYWdhYmxlID0gITAsIHRoaXMudGV4dFBvc2l0aW9uID0gXCJCb3R0b21fQ2VudGVyXCIsIHRoaXMudGV4dE9mZnNldFggPSAwLCB0aGlzLnRleHRPZmZzZXRZID0gMCwgdGhpcy50cmFuc2Zvcm1BYmxlID0gITAsIHRoaXMuaW5MaW5rcyA9IG51bGwsIHRoaXMub3V0TGlua3MgPSBudWxsO1xyXG4gICAgICAgICAgICB2YXIgZCA9IFwidGV4dCxmb250LGZvbnRDb2xvcix0ZXh0UG9zaXRpb24sdGV4dE9mZnNldFgsdGV4dE9mZnNldFksYm9yZGVyUmFkaXVzXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoZClcclxuICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoYyksIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBhLmdsb2JhbEFscGhhO1xyXG4gICAgICAgICAgICAgICAgYS5nbG9iYWxBbHBoYSA9IHRoaXMuYWxwaGEsIG51bGwgIT0gdGhpcy5hbGFybUltYWdlICYmIG51bGwgIT0gdGhpcy5hbGFybSA/IGEuZHJhd0ltYWdlKHRoaXMuYWxhcm1JbWFnZSwgLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCkgOiBhLmRyYXdJbWFnZSh0aGlzLmltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KSwgYS5nbG9iYWxBbHBoYSA9IGJcclxuICAgICAgICAgICAgfSBlbHNlIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgbnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzID8gYS5yZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpIDogYS5KVG9wb1JvdW5kUmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmJvcmRlclJhZGl1cyksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50VGV4dChhKSwgdGhpcy5wYWludEJvcmRlcihhKSwgdGhpcy5wYWludEN0cmwoYSksIHRoaXMucGFpbnRBbGFybVRleHQoYSlcclxuICAgICAgICB9LCB0aGlzLnBhaW50QWxhcm1UZXh0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5hbGFybSAmJiBcIlwiICE9IHRoaXMuYWxhcm0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5hbGFybUNvbG9yIHx8IFwiMjU1LDAsMFwiLCBjID0gdGhpcy5hbGFybUFscGhhIHx8IC41O1xyXG4gICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5mb250ID0gdGhpcy5hbGFybUZvbnQgfHwgXCIxMHB4IOW+rui9r+mbhem7kVwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBhLm1lYXN1cmVUZXh0KHRoaXMuYWxhcm0pLndpZHRoICsgNiwgZSA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGggKyA2LCBmID0gdGhpcy53aWR0aCAvIDIgLSBkIC8gMiwgZyA9IC10aGlzLmhlaWdodCAvIDIgLSBlIC0gODtcclxuICAgICAgICAgICAgICAgIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyBiICsgXCIsIFwiICsgYyArIFwiKVwiLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIGIgKyBcIiwgXCIgKyBjICsgXCIpXCIsIGEubGluZUNhcCA9IFwicm91bmRcIiwgYS5saW5lV2lkdGggPSAxLCBhLm1vdmVUbyhmLCBnKSwgYS5saW5lVG8oZiArIGQsIGcpLCBhLmxpbmVUbyhmICsgZCwgZyArIGUpLCBhLmxpbmVUbyhmICsgZCAvIDIgKyA2LCBnICsgZSksIGEubGluZVRvKGYgKyBkIC8gMiwgZyArIGUgKyA4KSwgYS5saW5lVG8oZiArIGQgLyAyIC0gNiwgZyArIGUpLCBhLmxpbmVUbyhmLCBnICsgZSksIGEubGluZVRvKGYsIGcpLCBhLmZpbGwoKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgYS5iZWdpblBhdGgoKSwgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxUZXh0KHRoaXMuYWxhcm0sIGYgKyAyLCBnICsgZSAtIDQpLCBhLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy50ZXh0O1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSBiICYmIFwiXCIgIT0gYikge1xyXG4gICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBhLm1lYXN1cmVUZXh0KGIpLndpZHRoLCBkID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0VGV4dFBvc3Rpb24odGhpcy50ZXh0UG9zaXRpb24sIGMsIGQpO1xyXG4gICAgICAgICAgICAgICAgYS5maWxsVGV4dChiLCBlLngsIGUueSksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRCb3JkZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAoMCAhPSB0aGlzLmJvcmRlcldpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmxpbmVXaWR0aCA9IHRoaXMuYm9yZGVyV2lkdGgsIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmJvcmRlckNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuYm9yZGVyV2lkdGggLyAyO1xyXG4gICAgICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzID8gYS5yZWN0KC10aGlzLndpZHRoIC8gMiAtIGIsIC10aGlzLmhlaWdodCAvIDIgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoKSA6IGEuSlRvcG9Sb3VuZFJlY3QoLXRoaXMud2lkdGggLyAyIC0gYiwgLXRoaXMuaGVpZ2h0IC8gMiAtIGIsIHRoaXMud2lkdGggKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmhlaWdodCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuYm9yZGVyUmFkaXVzKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5nZXRUZXh0UG9zdGlvbiA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGwgPT0gYSB8fCBcIkJvdHRvbV9DZW50ZXJcIiA9PSBhID8gZCA9IHt4OiAtdGhpcy53aWR0aCAvIDIgKyAodGhpcy53aWR0aCAtIGIpIC8gMiwgeTogdGhpcy5oZWlnaHQgLyAyICsgY30gOiBcIlRvcF9DZW50ZXJcIiA9PSBhID8gZCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IC10aGlzLndpZHRoIC8gMiArICh0aGlzLndpZHRoIC0gYikgLyAyLFxyXG4gICAgICAgICAgICAgICAgeTogLXRoaXMuaGVpZ2h0IC8gMiAtIGMgLyAyXHJcbiAgICAgICAgICAgIH0gOiBcIlRvcF9SaWdodFwiID09IGEgPyBkID0ge3g6IHRoaXMud2lkdGggLyAyLCB5OiAtdGhpcy5oZWlnaHQgLyAyIC0gYyAvIDJ9IDogXCJUb3BfTGVmdFwiID09IGEgPyBkID0ge1xyXG4gICAgICAgICAgICAgICAgeDogLXRoaXMud2lkdGggLyAyIC0gYixcclxuICAgICAgICAgICAgICAgIHk6IC10aGlzLmhlaWdodCAvIDIgLSBjIC8gMlxyXG4gICAgICAgICAgICB9IDogXCJCb3R0b21fUmlnaHRcIiA9PSBhID8gZCA9IHt4OiB0aGlzLndpZHRoIC8gMiwgeTogdGhpcy5oZWlnaHQgLyAyICsgY30gOiBcIkJvdHRvbV9MZWZ0XCIgPT0gYSA/IGQgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiAtdGhpcy53aWR0aCAvIDIgLSBiLFxyXG4gICAgICAgICAgICAgICAgeTogdGhpcy5oZWlnaHQgLyAyICsgY1xyXG4gICAgICAgICAgICB9IDogXCJNaWRkbGVfQ2VudGVyXCIgPT0gYSA/IGQgPSB7eDogLXRoaXMud2lkdGggLyAyICsgKHRoaXMud2lkdGggLSBiKSAvIDIsIHk6IGMgLyAyfSA6IFwiTWlkZGxlX1JpZ2h0XCIgPT0gYSA/IGQgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiB0aGlzLndpZHRoIC8gMixcclxuICAgICAgICAgICAgICAgIHk6IGMgLyAyXHJcbiAgICAgICAgICAgIH0gOiBcIk1pZGRsZV9MZWZ0XCIgPT0gYSAmJiAoZCA9IHt4OiAtdGhpcy53aWR0aCAvIDIgLSBiLCB5OiBjIC8gMn0pLCBudWxsICE9IHRoaXMudGV4dE9mZnNldFggJiYgKGQueCArPSB0aGlzLnRleHRPZmZzZXRYKSwgbnVsbCAhPSB0aGlzLnRleHRPZmZzZXRZICYmIChkLnkgKz0gdGhpcy50ZXh0T2Zmc2V0WSksIGRcclxuICAgICAgICB9LCB0aGlzLnNldEltYWdlID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgPT0gYSl0aHJvdyBuZXcgRXJyb3IoXCJOb2RlLnNldEltYWdlKCk6IOWPguaVsEltYWdl5a+56LGh5Li656m6IVwiKTtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBqW2FdO1xyXG4gICAgICAgICAgICAgICAgbnVsbCA9PSBkID8gKGQgPSBuZXcgSW1hZ2UsIGQuc3JjID0gYSwgZC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgalthXSA9IGQsIDEgPT0gYiAmJiBjLnNldFNpemUoZC53aWR0aCwgZC5oZWlnaHQpLCBjLmltYWdlID0gZCwgYy5hbGFybUNvbG9yID0gbnVsbCA9PSBjLmFsYXJtQ29sb3IgPyBcIjI1NSwwLDBcIiA6IGMuYWxhcm1Db2xvclxyXG4gICAgICAgICAgICAgICAgfSkgOiAoYiAmJiB0aGlzLnNldFNpemUoZC53aWR0aCwgZC5oZWlnaHQpLCBjLmltYWdlID0gZCwgYy5hbGFybUNvbG9yID0gbnVsbCA9PSBjLmFsYXJtQ29sb3IgPyBcIjI1NSwwLDBcIiA6IGMuYWxhcm1Db2xvcilcclxuICAgICAgICAgICAgfSBlbHNlIHRoaXMuaW1hZ2UgPSBhLCBjLmFsYXJtQ29sb3IgPSBudWxsID09IGMuYWxhcm1Db2xvciA/IFwiMjU1LDAsMFwiIDogYy5hbGFybUNvbG9yLCAxID09IGIgJiYgdGhpcy5zZXRTaXplKGEud2lkdGgsIGEuaGVpZ2h0KVxyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5vdXRMaW5rcyAmJiAodGhpcy5vdXRMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICBjLm5vZGVBID09PSBiICYmIGEucmVtb3ZlKGMpXHJcbiAgICAgICAgICAgIH0pLCB0aGlzLm91dExpbmtzID0gbnVsbCksIHRoaXMuaW5MaW5rcyAmJiAodGhpcy5pbkxpbmtzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIGMubm9kZVogPT09IGIgJiYgYS5yZW1vdmUoYylcclxuICAgICAgICAgICAgfSksIHRoaXMuaW5MaW5rcyA9IG51bGwpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGMoKSB7XHJcbiAgICAgICAgYy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZChhKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplKCksIHRoaXMudGV4dCA9IGEsIHRoaXMuZWxlbWVudFR5cGUgPSBcIlRleHROb2RlXCIsIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQsIHRoaXMud2lkdGggPSBhLm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGgsIHRoaXMuaGVpZ2h0ID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aCwgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxUZXh0KHRoaXMudGV4dCwgLXRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIpLCBhLmNsb3NlUGF0aCgpLCB0aGlzLnBhaW50Qm9yZGVyKGEpLCB0aGlzLnBhaW50Q3RybChhKSwgdGhpcy5wYWludEFsYXJtVGV4dChhKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlKGEsIGIsIGMpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoKSwgdGhpcy50ZXh0ID0gYSwgdGhpcy5ocmVmID0gYiwgdGhpcy50YXJnZXQgPSBjLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJMaW5rTm9kZVwiLCB0aGlzLmlzVmlzaXRlZCA9ICExLCB0aGlzLnZpc2l0ZWRDb2xvciA9IG51bGwsIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQsIHRoaXMud2lkdGggPSBhLm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGgsIHRoaXMuaGVpZ2h0ID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aCwgdGhpcy5pc1Zpc2l0ZWQgJiYgbnVsbCAhPSB0aGlzLnZpc2l0ZWRDb2xvciA/IChhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy52aXNpdGVkQ29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy52aXNpdGVkQ29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIpIDogKGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIiksIGEuZmlsbFRleHQodGhpcy50ZXh0LCAtdGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0IC8gMiksIHRoaXMuaXNNb3VzZU92ZXIgJiYgKGEubW92ZVRvKC10aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQpLCBhLmxpbmVUbyh0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQpLCBhLnN0cm9rZSgpKSwgYS5jbG9zZVBhdGgoKSwgdGhpcy5wYWludEJvcmRlcihhKSwgdGhpcy5wYWludEN0cmwoYSksIHRoaXMucGFpbnRBbGFybVRleHQoYSlcclxuICAgICAgICB9LCB0aGlzLm1vdXNlbW92ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICAgIGlmIChhICYmIGEubGVuZ3RoID4gMClmb3IgKHZhciBiID0gMDsgYiA8IGEubGVuZ3RoOyBiKyspYVtiXS5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIlxyXG4gICAgICAgIH0pLCB0aGlzLm1vdXNlb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgaWYgKGEgJiYgYS5sZW5ndGggPiAwKWZvciAodmFyIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKylhW2JdLnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiXHJcbiAgICAgICAgfSksIHRoaXMuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBcIl9ibGFua1wiID09IHRoaXMudGFyZ2V0ID8gd2luZG93Lm9wZW4odGhpcy5ocmVmKSA6IGxvY2F0aW9uID0gdGhpcy5ocmVmLCB0aGlzLmlzVmlzaXRlZCA9ICEwXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBmKGEpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoYXJndW1lbnRzKSwgdGhpcy5fcmFkaXVzID0gMjAsIHRoaXMuYmVnaW5EZWdyZWUgPSAwLCB0aGlzLmVuZERlZ3JlZSA9IDIgKiBNYXRoLlBJLCB0aGlzLnRleHQgPSBhLCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5hcmMoMCwgMCwgdGhpcy5yYWRpdXMsIHRoaXMuYmVnaW5EZWdyZWUsIHRoaXMuZW5kRGVncmVlLCAhMCksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKSwgdGhpcy5wYWludFRleHQoYSksIHRoaXMucGFpbnRCb3JkZXIoYSksIHRoaXMucGFpbnRDdHJsKGEpLCB0aGlzLnBhaW50QWxhcm1UZXh0KGEpXHJcbiAgICAgICAgfSwgdGhpcy5wYWludFNlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMTY4LDIwMiwyNTUsIDAuOSlcIiwgYS5maWxsU3R5bGUgPSBcInJnYmEoMTY4LDIwMiwyMzYsMC43KVwiLCBhLmFyYygwLCAwLCB0aGlzLnJhZGl1cyArIDMsIHRoaXMuYmVnaW5EZWdyZWUsIHRoaXMuZW5kRGVncmVlLCAhMCksIGEuZmlsbCgpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnKGEsIGIsIGMpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoKSwgdGhpcy5mcmFtZUltYWdlcyA9IGEgfHwgW10sIHRoaXMuZnJhbWVJbmRleCA9IDAsIHRoaXMuaXNTdG9wID0gITA7XHJcbiAgICAgICAgdmFyIGQgPSBiIHx8IDFlMztcclxuICAgICAgICB0aGlzLnJlcGVhdFBsYXkgPSAhMTtcclxuICAgICAgICB2YXIgZSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5uZXh0RnJhbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1N0b3AgJiYgbnVsbCAhPSB0aGlzLmZyYW1lSW1hZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZnJhbWVJbmRleCsrLCB0aGlzLmZyYW1lSW5kZXggPj0gdGhpcy5mcmFtZUltYWdlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVwZWF0UGxheSlyZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRJbWFnZSh0aGlzLmZyYW1lSW1hZ2VzW3RoaXMuZnJhbWVJbmRleF0sIGMpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLm5leHRGcmFtZSgpXHJcbiAgICAgICAgICAgICAgICB9LCBkIC8gYS5sZW5ndGgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaChhLCBiLCBjLCBkLCBlKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgdmFyIGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc2V0SW1hZ2UoYSksIHRoaXMuZnJhbWVJbmRleCA9IDAsIHRoaXMuaXNQYXVzZSA9ICEwLCB0aGlzLnJlcGVhdFBsYXkgPSAhMTtcclxuICAgICAgICB2YXIgZyA9IGQgfHwgMWUzO1xyXG4gICAgICAgIGUgPSBlIHx8IDAsIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLndpZHRoLCBkID0gdGhpcy5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSAoTWF0aC5mbG9vcih0aGlzLmZyYW1lSW5kZXggLyBjKSArIGUpICogZCwgZyA9IE1hdGguZmxvb3IodGhpcy5mcmFtZUluZGV4ICUgYykgKiBiO1xyXG4gICAgICAgICAgICAgICAgYS5kcmF3SW1hZ2UodGhpcy5pbWFnZSwgZywgZiwgYiwgZCwgLWIgLyAyLCAtZCAvIDIsIGIsIGQpLCBhLmZpbGwoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKCksIHRoaXMucGFpbnRUZXh0KGEpLCB0aGlzLnBhaW50Qm9yZGVyKGEpLCB0aGlzLnBhaW50Q3RybChhKSwgdGhpcy5wYWludEFsYXJtVGV4dChhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5uZXh0RnJhbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1N0b3ApIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyYW1lSW5kZXgrKywgdGhpcy5mcmFtZUluZGV4ID49IGIgKiBjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlcGVhdFBsYXkpcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJhbWVJbmRleCA9IDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYuaXNTdG9wIHx8IGYubmV4dEZyYW1lKClcclxuICAgICAgICAgICAgICAgIH0sIGcgLyAoYiAqIGMpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGkoKSB7XHJcbiAgICAgICAgdmFyIGEgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBhID0gYXJndW1lbnRzLmxlbmd0aCA8PSAzID8gbmV3IGcoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSkgOiBuZXcgaChhcmd1bWVudHNbMF0sIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdLCBhcmd1bWVudHNbM10sIGFyZ3VtZW50c1s0XSwgYXJndW1lbnRzWzVdKSwgYS5zdG9wID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBhLmlzU3RvcCA9ICEwXHJcbiAgICAgICAgfSwgYS5wbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBhLmlzU3RvcCA9ICExLCBhLmZyYW1lSW5kZXggPSAwLCBhLm5leHRGcmFtZSgpXHJcbiAgICAgICAgfSwgYVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBqID0ge307XHJcbiAgICBiLnByb3RvdHlwZSA9IG5ldyBhLkVkaXRhYmxlRWxlbWVudCwgYy5wcm90b3R5cGUgPSBuZXcgYiwgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYy5wcm90b3R5cGUsIHtcclxuICAgICAgICBhbGFybUNvbG9yOiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FsYXJtQ29sb3JcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FsYXJtQ29sb3IgPSBiLCBudWxsICE9IHRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGEudXRpbC5nZW5JbWFnZUFsYXJtKHRoaXMuaW1hZ2UsIGIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGMgJiYgKHRoaXMuYWxhcm1JbWFnZSA9IGMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KSwgZC5wcm90b3R5cGUgPSBuZXcgYywgZS5wcm90b3R5cGUgPSBuZXcgZCwgZi5wcm90b3R5cGUgPSBuZXcgYywgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZi5wcm90b3R5cGUsIHtcclxuICAgICAgICByYWRpdXM6IHtcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmFkaXVzXHJcbiAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JhZGl1cyA9IGE7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IDIgKiB0aGlzLnJhZGl1cywgYyA9IDIgKiB0aGlzLnJhZGl1cztcclxuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBiLCB0aGlzLmhlaWdodCA9IGNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHdpZHRoOiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoXHJcbiAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JhZGl1cyA9IGEgLyAyLCB0aGlzLl93aWR0aCA9IGFcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGhlaWdodDoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHRcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFkaXVzID0gYSAvIDIsIHRoaXMuX2hlaWdodCA9IGFcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pLCBnLnByb3RvdHlwZSA9IG5ldyBjLCBoLnByb3RvdHlwZSA9IG5ldyBjLCBpLnByb3RvdHlwZSA9IG5ldyBjLCBhLk5vZGUgPSBjLCBhLlRleHROb2RlID0gZCwgYS5MaW5rTm9kZSA9IGUsIGEuQ2lyY2xlTm9kZSA9IGYsIGEuQW5pbWF0ZU5vZGUgPSBpXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihhLCBiKSB7XHJcbiAgICAgICAgdmFyIGMgPSBbXTtcclxuICAgICAgICBpZiAobnVsbCA9PSBhIHx8IG51bGwgPT0gYilyZXR1cm4gYztcclxuICAgICAgICBpZiAoYSAmJiBiICYmIGEub3V0TGlua3MgJiYgYi5pbkxpbmtzKWZvciAodmFyIGQgPSAwOyBkIDwgYS5vdXRMaW5rcy5sZW5ndGg7IGQrKylmb3IgKHZhciBlID0gYS5vdXRMaW5rc1tkXSwgZiA9IDA7IGYgPCBiLmluTGlua3MubGVuZ3RoOyBmKyspIHtcclxuICAgICAgICAgICAgdmFyIGcgPSBiLmluTGlua3NbZl07XHJcbiAgICAgICAgICAgIGUgPT09IGcgJiYgYy5wdXNoKGcpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYyhhLCBjKSB7XHJcbiAgICAgICAgdmFyIGQgPSBiKGEsIGMpLCBlID0gYihjLCBhKSwgZiA9IGQuY29uY2F0KGUpO1xyXG4gICAgICAgIHJldHVybiBmXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZChhKSB7XHJcbiAgICAgICAgdmFyIGIgPSBjKGEubm9kZUEsIGEubm9kZVopO1xyXG4gICAgICAgIHJldHVybiBiID0gYi5maWx0ZXIoZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEgIT09IGJcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGUoYSwgYikge1xyXG4gICAgICAgIHJldHVybiBjKGEsIGIpLmxlbmd0aFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGYoYiwgYywgZykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGgoYiwgYykge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGEudXRpbC5saW5lRihiLmN4LCBiLmN5LCBjLmN4LCBjLmN5KSwgZSA9IGIuZ2V0Qm91bmQoKSwgZiA9IGEudXRpbC5pbnRlcnNlY3Rpb25MaW5lQm91bmQoZCwgZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZiAoZi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJsaW5rXCIsIHRoaXMuekluZGV4ID0gYS56SW5kZXhfTGluaywgMCAhPSBhcmd1bWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHQgPSBkLCB0aGlzLm5vZGVBID0gYiwgdGhpcy5ub2RlWiA9IGMsIHRoaXMubm9kZUEgJiYgbnVsbCA9PSB0aGlzLm5vZGVBLm91dExpbmtzICYmICh0aGlzLm5vZGVBLm91dExpbmtzID0gW10pLCB0aGlzLm5vZGVBICYmIG51bGwgPT0gdGhpcy5ub2RlQS5pbkxpbmtzICYmICh0aGlzLm5vZGVBLmluTGlua3MgPSBbXSksIHRoaXMubm9kZVogJiYgbnVsbCA9PSB0aGlzLm5vZGVaLmluTGlua3MgJiYgKHRoaXMubm9kZVouaW5MaW5rcyA9IFtdKSwgdGhpcy5ub2RlWiAmJiBudWxsID09IHRoaXMubm9kZVoub3V0TGlua3MgJiYgKHRoaXMubm9kZVoub3V0TGlua3MgPSBbXSksIG51bGwgIT0gdGhpcy5ub2RlQSAmJiB0aGlzLm5vZGVBLm91dExpbmtzLnB1c2godGhpcyksIG51bGwgIT0gdGhpcy5ub2RlWiAmJiB0aGlzLm5vZGVaLmluTGlua3MucHVzaCh0aGlzKSwgdGhpcy5jYWN1bGF0ZUluZGV4KCksIHRoaXMuZm9udCA9IFwiMTJweCBDb25zb2xhc1wiLCB0aGlzLmZvbnRDb2xvciA9IFwiMjU1LDI1NSwyNTVcIiwgdGhpcy5saW5lV2lkdGggPSAyLCB0aGlzLmxpbmVKb2luID0gXCJtaXRlclwiLCB0aGlzLnRyYW5zZm9ybUFibGUgPSAhMSwgdGhpcy5idW5kbGVPZmZzZXQgPSAyMCwgdGhpcy5idW5kbGVHYXAgPSAxMiwgdGhpcy50ZXh0T2Zmc2V0WCA9IDAsIHRoaXMudGV4dE9mZnNldFkgPSAwLCB0aGlzLmFycm93c1JhZGl1cyA9IG51bGwsIHRoaXMuYXJyb3dzT2Zmc2V0ID0gMCwgdGhpcy5kYXNoZWRQYXR0ZXJuID0gbnVsbCwgdGhpcy5wYXRoID0gW107XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IFwidGV4dCxmb250LGZvbnRDb2xvcixsaW5lV2lkdGgsbGluZUpvaW5cIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMuY2FjdWxhdGVJbmRleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBlKHRoaXMubm9kZUEsIHRoaXMubm9kZVopO1xyXG4gICAgICAgICAgICBhID4gMCAmJiAodGhpcy5ub2RlSW5kZXggPSBhIC0gMSlcclxuICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoYiwgYywgZyksIHRoaXMucmVtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGVBICYmIHRoaXMubm9kZUEub3V0TGlua3MgJiYgKHRoaXMubm9kZUEub3V0TGlua3MgPSB0aGlzLm5vZGVBLm91dExpbmtzLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGIgIT09IGFcclxuICAgICAgICAgICAgfSkpLCB0aGlzLm5vZGVaICYmIHRoaXMubm9kZVouaW5MaW5rcyAmJiAodGhpcy5ub2RlWi5pbkxpbmtzID0gdGhpcy5ub2RlWi5pbkxpbmtzLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGIgIT09IGFcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB2YXIgYiA9IGQodGhpcyk7XHJcbiAgICAgICAgICAgIGIuZm9yRWFjaChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgYS5ub2RlSW5kZXggPSBiXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdGhpcy5nZXRTdGFydFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHt4OiB0aGlzLm5vZGVBLmN4LCB5OiB0aGlzLm5vZGVBLmN5fTtcclxuICAgICAgICAgICAgcmV0dXJuIGFcclxuICAgICAgICB9LCB0aGlzLmdldEVuZFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMgJiYgKGEgPSBoKHRoaXMubm9kZVosIHRoaXMubm9kZUEpKSwgbnVsbCA9PSBhICYmIChhID0ge3g6IHRoaXMubm9kZVouY3gsIHk6IHRoaXMubm9kZVouY3l9KSwgYVxyXG4gICAgICAgIH0sIHRoaXMuZ2V0UGF0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBbXSwgYiA9IHRoaXMuZ2V0U3RhcnRQb3NpdGlvbigpLCBjID0gdGhpcy5nZXRFbmRQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gW2IsIGNdO1xyXG4gICAgICAgICAgICB2YXIgZCA9IGUodGhpcy5ub2RlQSwgdGhpcy5ub2RlWik7XHJcbiAgICAgICAgICAgIGlmICgxID09IGQpcmV0dXJuIFtiLCBjXTtcclxuICAgICAgICAgICAgdmFyIGYgPSBNYXRoLmF0YW4yKGMueSAtIGIueSwgYy54IC0gYi54KSwgZyA9IHt4OiBiLnggKyB0aGlzLmJ1bmRsZU9mZnNldCAqIE1hdGguY29zKGYpLCB5OiBiLnkgKyB0aGlzLmJ1bmRsZU9mZnNldCAqIE1hdGguc2luKGYpfSwgaCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IGMueCArIHRoaXMuYnVuZGxlT2Zmc2V0ICogTWF0aC5jb3MoZiAtIE1hdGguUEkpLFxyXG4gICAgICAgICAgICAgICAgeTogYy55ICsgdGhpcy5idW5kbGVPZmZzZXQgKiBNYXRoLnNpbihmIC0gTWF0aC5QSSlcclxuICAgICAgICAgICAgfSwgaSA9IGYgLSBNYXRoLlBJIC8gMiwgaiA9IGYgLSBNYXRoLlBJIC8gMiwgayA9IGQgKiB0aGlzLmJ1bmRsZUdhcCAvIDIgLSB0aGlzLmJ1bmRsZUdhcCAvIDIsIGwgPSB0aGlzLmJ1bmRsZUdhcCAqIHRoaXMubm9kZUluZGV4LCBtID0ge1xyXG4gICAgICAgICAgICAgICAgeDogZy54ICsgbCAqIE1hdGguY29zKGkpLFxyXG4gICAgICAgICAgICAgICAgeTogZy55ICsgbCAqIE1hdGguc2luKGkpXHJcbiAgICAgICAgICAgIH0sIG4gPSB7eDogaC54ICsgbCAqIE1hdGguY29zKGopLCB5OiBoLnkgKyBsICogTWF0aC5zaW4oail9O1xyXG4gICAgICAgICAgICByZXR1cm4gbSA9IHt4OiBtLnggKyBrICogTWF0aC5jb3MoaSAtIE1hdGguUEkpLCB5OiBtLnkgKyBrICogTWF0aC5zaW4oaSAtIE1hdGguUEkpfSwgbiA9IHt4OiBuLnggKyBrICogTWF0aC5jb3MoaiAtIE1hdGguUEkpLCB5OiBuLnkgKyBrICogTWF0aC5zaW4oaiAtIE1hdGguUEkpfSwgYS5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHg6IGIueCxcclxuICAgICAgICAgICAgICAgIHk6IGIueVxyXG4gICAgICAgICAgICB9KSwgYS5wdXNoKHt4OiBtLngsIHk6IG0ueX0pLCBhLnB1c2goe3g6IG4ueCwgeTogbi55fSksIGEucHVzaCh7eDogYy54LCB5OiBjLnl9KSwgYVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRQYXRoID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEubW92ZVRvKGJbMF0ueCwgYlswXS55KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgYyA9IDE7IGMgPCBiLmxlbmd0aDsgYysrKW51bGwgPT0gdGhpcy5kYXNoZWRQYXR0ZXJuID8gYS5saW5lVG8oYltjXS54LCBiW2NdLnkpIDogYS5KVG9wb0Rhc2hlZExpbmVUbyhiW2MgLSAxXS54LCBiW2MgLSAxXS55LCBiW2NdLngsIGJbY10ueSwgdGhpcy5kYXNoZWRQYXR0ZXJuKTtcclxuICAgICAgICAgICAgaWYgKGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gYltiLmxlbmd0aCAtIDJdLCBlID0gYltiLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGEsIGQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLnBhaW50TG9vcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5idW5kbGVHYXAgKiAodGhpcy5ub2RlSW5kZXggKyAxKSAvIDI7XHJcbiAgICAgICAgICAgICAgICBNYXRoLlBJICsgTWF0aC5QSSAvIDJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhLmFyYyh0aGlzLm5vZGVBLngsIHRoaXMubm9kZUEueSwgYiwgTWF0aC5QSSAvIDIsIDIgKiBNYXRoLlBJKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRBcnJvdyA9IGZ1bmN0aW9uIChiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdGhpcy5hcnJvd3NPZmZzZXQsIGYgPSB0aGlzLmFycm93c1JhZGl1cyAvIDIsIGcgPSBjLCBoID0gZCwgaSA9IE1hdGguYXRhbjIoaC55IC0gZy55LCBoLnggLSBnLngpLCBqID0gYS51dGlsLmdldERpc3RhbmNlKGcsIGgpIC0gdGhpcy5hcnJvd3NSYWRpdXMsIGsgPSBnLnggKyAoaiArIGUpICogTWF0aC5jb3MoaSksIGwgPSBnLnkgKyAoaiArIGUpICogTWF0aC5zaW4oaSksIG0gPSBoLnggKyBlICogTWF0aC5jb3MoaSksIG4gPSBoLnkgKyBlICogTWF0aC5zaW4oaSk7XHJcbiAgICAgICAgICAgIGkgLT0gTWF0aC5QSSAvIDI7XHJcbiAgICAgICAgICAgIHZhciBvID0ge3g6IGsgKyBmICogTWF0aC5jb3MoaSksIHk6IGwgKyBmICogTWF0aC5zaW4oaSl9LCBwID0ge3g6IGsgKyBmICogTWF0aC5jb3MoaSAtIE1hdGguUEkpLCB5OiBsICsgZiAqIE1hdGguc2luKGkgLSBNYXRoLlBJKX07XHJcbiAgICAgICAgICAgIGIuYmVnaW5QYXRoKCksIGIuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5zdHJva2VDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBiLm1vdmVUbyhvLngsIG8ueSksIGIubGluZVRvKG0sIG4pLCBiLmxpbmVUbyhwLngsIHAueSksIGIuc3Ryb2tlKCksIGIuY2xvc2VQYXRoKClcclxuICAgICAgICB9LCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5ub2RlQSAmJiBudWxsICE9ICF0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuZ2V0UGF0aCh0aGlzLm5vZGVJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhdGggPSBiLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5zdHJva2VDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoLCB0aGlzLnBhaW50UGF0aChhLCBiKSwgYiAmJiBiLmxlbmd0aCA+IDAgJiYgdGhpcy5wYWludFRleHQoYSwgYilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGkgPSAtKE1hdGguUEkgLyAyICsgTWF0aC5QSSAvIDQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRUZXh0ID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBiWzBdLCBkID0gYltiLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBpZiAoNCA9PSBiLmxlbmd0aCAmJiAoYyA9IGJbMV0sIGQgPSBiWzJdKSwgdGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IChkLnggKyBjLngpIC8gMiArIHRoaXMudGV4dE9mZnNldFgsIGYgPSAoZC55ICsgYy55KSAvIDIgKyB0aGlzLnRleHRPZmZzZXRZO1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgIHZhciBnID0gYS5tZWFzdXJlVGV4dCh0aGlzLnRleHQpLndpZHRoLCBoID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGlmIChhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCB0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGogPSB0aGlzLmJ1bmRsZUdhcCAqICh0aGlzLm5vZGVJbmRleCArIDEpIC8gMiwgZSA9IHRoaXMubm9kZUEueCArIGogKiBNYXRoLmNvcyhpKSwgZiA9IHRoaXMubm9kZUEueSArIGogKiBNYXRoLnNpbihpKTtcclxuICAgICAgICAgICAgICAgICAgICBhLmZpbGxUZXh0KHRoaXMudGV4dCwgZSwgZilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBhLmZpbGxUZXh0KHRoaXMudGV4dCwgZSAtIGcgLyAyLCBmIC0gaCAvIDIpO1xyXG4gICAgICAgICAgICAgICAgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEuc2hhZG93Qmx1ciA9IDEwLCBhLnNoYWRvd0NvbG9yID0gXCJyZ2JhKDAsMCwwLDEpXCIsIGEuc2hhZG93T2Zmc2V0WCA9IDAsIGEuc2hhZG93T2Zmc2V0WSA9IDBcclxuICAgICAgICB9LCB0aGlzLmlzSW5Cb3VuZCA9IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuYnVuZGxlR2FwICogKHRoaXMubm9kZUluZGV4ICsgMSkgLyAyLCBlID0gYS51dGlsLmdldERpc3RhbmNlKHRoaXMubm9kZUEsIHt4OiBiLCB5OiBjfSkgLSBkO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKGUpIDw9IDNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBmID0gITEsIGcgPSAxOyBnIDwgdGhpcy5wYXRoLmxlbmd0aDsgZysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IHRoaXMucGF0aFtnIC0gMV0sIGkgPSB0aGlzLnBhdGhbZ107XHJcbiAgICAgICAgICAgICAgICBpZiAoMSA9PSBhLnV0aWwuaXNQb2ludEluTGluZSh7eDogYiwgeTogY30sIGgsIGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZyhhLCBiLCBjKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBnLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuZGlyZWN0aW9uID0gXCJob3Jpem9udGFsXCJcclxuICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoYSwgYiwgYyksIHRoaXMuZ2V0U3RhcnRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSB7eDogdGhpcy5ub2RlQS5jeCwgeTogdGhpcy5ub2RlQS5jeX07XHJcbiAgICAgICAgICAgIHJldHVybiBcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbiA/IHRoaXMubm9kZVouY3ggPiBhLnggPyBhLnggKz0gdGhpcy5ub2RlQS53aWR0aCAvIDIgOiBhLnggLT0gdGhpcy5ub2RlQS53aWR0aCAvIDIgOiB0aGlzLm5vZGVaLmN5ID4gYS55ID8gYS55ICs9IHRoaXMubm9kZUEuaGVpZ2h0IC8gMiA6IGEueSAtPSB0aGlzLm5vZGVBLmhlaWdodCAvIDIsIGFcclxuICAgICAgICB9LCB0aGlzLmdldEVuZFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHt4OiB0aGlzLm5vZGVaLmN4LCB5OiB0aGlzLm5vZGVaLmN5fTtcclxuICAgICAgICAgICAgcmV0dXJuIFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uID8gdGhpcy5ub2RlQS5jeSA8IGEueSA/IGEueSAtPSB0aGlzLm5vZGVaLmhlaWdodCAvIDIgOiBhLnkgKz0gdGhpcy5ub2RlWi5oZWlnaHQgLyAyIDogYS54ID0gdGhpcy5ub2RlQS5jeCA8IGEueCA/IHRoaXMubm9kZVoueCA6IHRoaXMubm9kZVoueCArIHRoaXMubm9kZVoud2lkdGgsIGFcclxuICAgICAgICB9LCB0aGlzLmdldFBhdGggPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IFtdLCBjID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCksIGQgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKXJldHVybiBbYywgZF07XHJcbiAgICAgICAgICAgIHZhciBmLCBnLCBoID0gZSh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKSwgaSA9IChoIC0gMSkgKiB0aGlzLmJ1bmRsZUdhcCwgaiA9IHRoaXMuYnVuZGxlR2FwICogYSAtIGkgLyAyO1xyXG4gICAgICAgICAgICByZXR1cm4gXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24gPyAoZiA9IGQueCArIGosIGcgPSBjLnkgLSBqLCBiLnB1c2goe3g6IGMueCwgeTogZ30pLCBiLnB1c2goe3g6IGYsIHk6IGd9KSwgYi5wdXNoKHt4OiBmLCB5OiBkLnl9KSkgOiAoZiA9IGMueCArIGosIGcgPSBkLnkgLSBqLCBiLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgeDogZixcclxuICAgICAgICAgICAgICAgIHk6IGMueVxyXG4gICAgICAgICAgICB9KSwgYi5wdXNoKHt4OiBmLCB5OiBnfSksIGIucHVzaCh7eDogZC54LCB5OiBnfSkpLCBiXHJcbiAgICAgICAgfSwgdGhpcy5wYWludFRleHQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGJbMV0sIGQgPSBjLnggKyB0aGlzLnRleHRPZmZzZXRYLCBlID0gYy55ICsgdGhpcy50ZXh0T2Zmc2V0WTtcclxuICAgICAgICAgICAgICAgIGEuc2F2ZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGEubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCwgZyA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxUZXh0KHRoaXMudGV4dCwgZCAtIGYgLyAyLCBlIC0gZyAvIDIpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGgoYSwgYiwgYykge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLmRpcmVjdGlvbiA9IFwidmVydGljYWxcIiwgdGhpcy5vZmZzZXRHYXAgPSA0NFxyXG4gICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZShhLCBiLCBjKSwgdGhpcy5nZXRTdGFydFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHt4OiB0aGlzLm5vZGVBLmN4LCB5OiB0aGlzLm5vZGVBLmN5fTtcclxuICAgICAgICAgICAgcmV0dXJuIFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uID8gYS54ID0gdGhpcy5ub2RlWi5jeCA8IGEueCA/IHRoaXMubm9kZUEueCA6IHRoaXMubm9kZUEueCArIHRoaXMubm9kZUEud2lkdGggOiBhLnkgPSB0aGlzLm5vZGVaLmN5IDwgYS55ID8gdGhpcy5ub2RlQS55IDogdGhpcy5ub2RlQS55ICsgdGhpcy5ub2RlQS5oZWlnaHQsIGFcclxuICAgICAgICB9LCB0aGlzLmdldEVuZFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHt4OiB0aGlzLm5vZGVaLmN4LCB5OiB0aGlzLm5vZGVaLmN5fTtcclxuICAgICAgICAgICAgcmV0dXJuIFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uID8gYS54ID0gdGhpcy5ub2RlQS5jeCA8IGEueCA/IHRoaXMubm9kZVoueCA6IHRoaXMubm9kZVoueCArIHRoaXMubm9kZVoud2lkdGggOiBhLnkgPSB0aGlzLm5vZGVBLmN5IDwgYS55ID8gdGhpcy5ub2RlWi55IDogdGhpcy5ub2RlWi55ICsgdGhpcy5ub2RlWi5oZWlnaHQsIGFcclxuICAgICAgICB9LCB0aGlzLmdldFBhdGggPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMuZ2V0U3RhcnRQb3NpdGlvbigpLCBjID0gdGhpcy5nZXRFbmRQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gW2IsIGNdO1xyXG4gICAgICAgICAgICB2YXIgZCA9IFtdLCBmID0gZSh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKSwgZyA9IChmIC0gMSkgKiB0aGlzLmJ1bmRsZUdhcCwgaCA9IHRoaXMuYnVuZGxlR2FwICogYSAtIGcgLyAyLCBpID0gdGhpcy5vZmZzZXRHYXA7XHJcbiAgICAgICAgICAgIHJldHVybiBcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbiA/ICh0aGlzLm5vZGVBLmN4ID4gdGhpcy5ub2RlWi5jeCAmJiAoaSA9IC1pKSwgZC5wdXNoKHt4OiBiLngsIHk6IGIueSArIGh9KSwgZC5wdXNoKHt4OiBiLnggKyBpLCB5OiBiLnkgKyBofSksIGQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB4OiBjLnggLSBpLFxyXG4gICAgICAgICAgICAgICAgeTogYy55ICsgaFxyXG4gICAgICAgICAgICB9KSwgZC5wdXNoKHt4OiBjLngsIHk6IGMueSArIGh9KSkgOiAodGhpcy5ub2RlQS5jeSA+IHRoaXMubm9kZVouY3kgJiYgKGkgPSAtaSksIGQucHVzaCh7eDogYi54ICsgaCwgeTogYi55fSksIGQucHVzaCh7eDogYi54ICsgaCwgeTogYi55ICsgaX0pLCBkLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgeDogYy54ICsgaCxcclxuICAgICAgICAgICAgICAgIHk6IGMueSAtIGlcclxuICAgICAgICAgICAgfSksIGQucHVzaCh7eDogYy54ICsgaCwgeTogYy55fSkpLCBkXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGkoYSwgYiwgYykge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaS5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpXHJcbiAgICAgICAgfSwgdGhpcy5pbml0aWFsaXplKGEsIGIsIGMpLCB0aGlzLnBhaW50UGF0aCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKXJldHVybiB2b2lkIHRoaXMucGFpbnRMb29wKGEpO1xyXG4gICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLm1vdmVUbyhiWzBdLngsIGJbMF0ueSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGMgPSAxOyBjIDwgYi5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiW2MgLSAxXSwgZSA9IGJbY10sIGYgPSAoZC54ICsgZS54KSAvIDIsIGcgPSAoZC55ICsgZS55KSAvIDI7XHJcbiAgICAgICAgICAgICAgICBnICs9IChlLnkgLSBkLnkpIC8gMiwgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3Ryb2tlQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5saW5lV2lkdGggPSB0aGlzLmxpbmVXaWR0aCwgYS5tb3ZlVG8oZC54LCBkLmN5KSwgYS5xdWFkcmF0aWNDdXJ2ZVRvKGYsIGcsIGUueCwgZS55KSwgYS5zdHJva2UoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IGJbYi5sZW5ndGggLSAyXSwgaSA9IGJbYi5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhhLCBoLCBpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGYucHJvdG90eXBlID0gbmV3IGEuSW50ZXJhY3RpdmVFbGVtZW50LCBnLnByb3RvdHlwZSA9IG5ldyBmLCBoLnByb3RvdHlwZSA9IG5ldyBmLCBpLnByb3RvdHlwZSA9IG5ldyBmLCBhLkxpbmsgPSBmLCBhLkZvbGRMaW5rID0gZywgYS5GbGV4aW9uYWxMaW5rID0gaCwgYS5DdXJ2ZUxpbmsgPSBpXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihjKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgYi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBudWxsKSwgdGhpcy5lbGVtZW50VHlwZSA9IFwiY29udGFpbmVyXCIsIHRoaXMuekluZGV4ID0gYS56SW5kZXhfQ29udGFpbmVyLCB0aGlzLndpZHRoID0gMTAwLCB0aGlzLmhlaWdodCA9IDEwMCwgdGhpcy5jaGlsZHMgPSBbXSwgdGhpcy5hbHBoYSA9IC41LCB0aGlzLmRyYWdhYmxlID0gITAsIHRoaXMuY2hpbGREcmFnYmxlID0gITAsIHRoaXMudmlzaWJsZSA9ICEwLCB0aGlzLmZpbGxDb2xvciA9IFwiMTAsMTAwLDgwXCIsIHRoaXMuYm9yZGVyV2lkdGggPSAwLCB0aGlzLmJvcmRlckNvbG9yID0gXCIyNTUsMjU1LDI1NVwiLCB0aGlzLmJvcmRlclJhZGl1cyA9IG51bGwsIHRoaXMuZm9udCA9IFwiMTJweCBDb25zb2xhc1wiLCB0aGlzLmZvbnRDb2xvciA9IFwiMjU1LDI1NSwyNTVcIiwgdGhpcy50ZXh0ID0gYywgdGhpcy50ZXh0UG9zaXRpb24gPSBcIkJvdHRvbV9DZW50ZXJcIiwgdGhpcy50ZXh0T2Zmc2V0WCA9IDAsIHRoaXMudGV4dE9mZnNldFkgPSAwLCB0aGlzLmxheW91dCA9IG5ldyBhLmxheW91dC5BdXRvQm91bmRMYXlvdXRcclxuICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoYyksIHRoaXMuYWRkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMucHVzaChhKSwgYS5kcmFnYWJsZSA9IHRoaXMuY2hpbGREcmFnYmxlXHJcbiAgICAgICAgfSwgdGhpcy5yZW1vdmUgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgYisrKWlmICh0aGlzLmNoaWxkc1tiXSA9PT0gYSkge1xyXG4gICAgICAgICAgICAgICAgYS5wYXJlbnRDb250YWluZXIgPSBudWxsLCB0aGlzLmNoaWxkcyA9IHRoaXMuY2hpbGRzLmRlbChiKSwgYS5sYXN0UGFyZW50Q29udGFpbmVyID0gdGhpcztcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLnJlbW92ZUFsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMgPSBbXVxyXG4gICAgICAgIH0sIHRoaXMuc2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IGEgLSB0aGlzLngsIGQgPSBiIC0gdGhpcy55O1xyXG4gICAgICAgICAgICB0aGlzLnggPSBhLCB0aGlzLnkgPSBiO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IHRoaXMuY2hpbGRzW2VdO1xyXG4gICAgICAgICAgICAgICAgZi5zZXRMb2NhdGlvbihmLnggKyBjLCBmLnkgKyBkKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5kb0xheW91dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEgJiYgYSh0aGlzLCB0aGlzLmNoaWxkcylcclxuICAgICAgICB9LCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlICYmICh0aGlzLmxheW91dCAmJiB0aGlzLmxheW91dCh0aGlzLCB0aGlzLmNoaWxkcyksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgbnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzID8gYS5yZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCkgOiBhLkpUb3BvUm91bmRSZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgdGhpcy5ib3JkZXJSYWRpdXMpLCBhLmZpbGwoKSwgYS5jbG9zZVBhdGgoKSwgdGhpcy5wYWludFRleHQoYSksIHRoaXMucGFpbnRCb3JkZXIoYSkpXHJcbiAgICAgICAgfSwgdGhpcy5wYWludEJvcmRlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHRoaXMuYm9yZGVyV2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEubGluZVdpZHRoID0gdGhpcy5ib3JkZXJXaWR0aCwgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuYm9yZGVyQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5ib3JkZXJXaWR0aCAvIDI7XHJcbiAgICAgICAgICAgICAgICBudWxsID09IHRoaXMuYm9yZGVyUmFkaXVzIHx8IDAgPT0gdGhpcy5ib3JkZXJSYWRpdXMgPyBhLnJlY3QodGhpcy54IC0gYiwgdGhpcy55IC0gYiwgdGhpcy53aWR0aCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuaGVpZ2h0ICsgdGhpcy5ib3JkZXJXaWR0aCkgOiBhLkpUb3BvUm91bmRSZWN0KHRoaXMueCAtIGIsIHRoaXMueSAtIGIsIHRoaXMud2lkdGggKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmhlaWdodCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuYm9yZGVyUmFkaXVzKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy5wYWludFRleHQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMudGV4dDtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gYiAmJiBcIlwiICE9IGIpIHtcclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gYS5tZWFzdXJlVGV4dChiKS53aWR0aCwgZCA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmdldFRleHRQb3N0aW9uKHRoaXMudGV4dFBvc2l0aW9uLCBjLCBkKTtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFRleHQoYiwgZS54LCBlLnkpLCBhLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzLmdldFRleHRQb3N0aW9uID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBudWxsO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbCA9PSBhIHx8IFwiQm90dG9tX0NlbnRlclwiID09IGEgPyBkID0ge3g6IHRoaXMueCArIHRoaXMud2lkdGggLyAyIC0gYiAvIDIsIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0ICsgY30gOiBcIlRvcF9DZW50ZXJcIiA9PSBhID8gZCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyIC0gYiAvIDIsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnkgLSBjIC8gMlxyXG4gICAgICAgICAgICB9IDogXCJUb3BfUmlnaHRcIiA9PSBhID8gZCA9IHt4OiB0aGlzLnggKyB0aGlzLndpZHRoIC0gYiwgeTogdGhpcy55IC0gYyAvIDJ9IDogXCJUb3BfTGVmdFwiID09IGEgPyBkID0ge3g6IHRoaXMueCwgeTogdGhpcy55IC0gYyAvIDJ9IDogXCJCb3R0b21fUmlnaHRcIiA9PSBhID8gZCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLSBiLFxyXG4gICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgKyBjXHJcbiAgICAgICAgICAgIH0gOiBcIkJvdHRvbV9MZWZ0XCIgPT0gYSA/IGQgPSB7eDogdGhpcy54LCB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCArIGN9IDogXCJNaWRkbGVfQ2VudGVyXCIgPT0gYSA/IGQgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyB0aGlzLndpZHRoIC8gMiAtIGIgLyAyLFxyXG4gICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgYyAvIDJcclxuICAgICAgICAgICAgfSA6IFwiTWlkZGxlX1JpZ2h0XCIgPT0gYSA/IGQgPSB7eDogdGhpcy54ICsgdGhpcy53aWR0aCAtIGIsIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMiArIGMgLyAyfSA6IFwiTWlkZGxlX0xlZnRcIiA9PSBhICYmIChkID0ge1xyXG4gICAgICAgICAgICAgICAgeDogdGhpcy54LFxyXG4gICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgYyAvIDJcclxuICAgICAgICAgICAgfSksIG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WCAmJiAoZC54ICs9IHRoaXMudGV4dE9mZnNldFgpLCBudWxsICE9IHRoaXMudGV4dE9mZnNldFkgJiYgKGQueSArPSB0aGlzLnRleHRPZmZzZXRZKSwgZFxyXG4gICAgICAgIH0sIHRoaXMucGFpbnRNb3VzZW92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfSwgdGhpcy5wYWludFNlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYS5zaGFkb3dCbHVyID0gMTAsIGEuc2hhZG93Q29sb3IgPSBcInJnYmEoMCwwLDAsMSlcIiwgYS5zaGFkb3dPZmZzZXRYID0gMCwgYS5zaGFkb3dPZmZzZXRZID0gMFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBiLnByb3RvdHlwZSA9IG5ldyBhLkludGVyYWN0aXZlRWxlbWVudCwgYS5Db250YWluZXIgPSBiXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihhKSB7XHJcbiAgICAgICAgdmFyIGIgPSAwLCBjID0gMDtcclxuICAgICAgICBhLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYiArPSBhLmN4LCBjICs9IGEuY3lcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZCA9IHt4OiBiIC8gYS5sZW5ndGgsIHk6IGMgLyBhLmxlbmd0aH07XHJcbiAgICAgICAgcmV0dXJuIGRcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjKGMsIGQpIHtcclxuICAgICAgICBudWxsID09IGQgJiYgKGQgPSB7fSk7XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgZSA9IGQuY3gsIGYgPSBkLmN5LCBnID0gZC5taW5SYWRpdXMsIGggPSBkLm5vZGVEaWFtZXRlciwgaSA9IGQuaFNjYWxlIHx8IDEsIGogPSBkLnZTY2FsZSB8fCAxO1xyXG4gICAgICAgICAgICBkLmJlZ2luQW5nbGUgfHwgMCwgZC5lbmRBbmdsZSB8fCAyICogTWF0aC5QSVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobnVsbCA9PSBlIHx8IG51bGwgPT0gZikge1xyXG4gICAgICAgICAgICB2YXIgayA9IGIoYyk7XHJcbiAgICAgICAgICAgIGUgPSBrLngsIGYgPSBrLnlcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGwgPSAwLCBtID0gW10sIG4gPSBbXTtcclxuICAgICAgICBjLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgbnVsbCA9PSBkLm5vZGVEaWFtZXRlciA/IChhLmRpYW1ldGVyICYmIChoID0gYS5kaWFtZXRlciksIGggPSBhLnJhZGl1cyA/IDIgKiBhLnJhZGl1cyA6IE1hdGguc3FydCgyICogYS53aWR0aCAqIGEuaGVpZ2h0KSwgbi5wdXNoKGgpKSA6IG4ucHVzaChoKSwgbCArPSBoXHJcbiAgICAgICAgfSksIGMuZm9yRWFjaChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IG5bYl0gLyBsO1xyXG4gICAgICAgICAgICBtLnB1c2goTWF0aC5QSSAqIGMpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIG8gPSAoYy5sZW5ndGgsIG1bMF0gKyBtWzFdKSwgcCA9IG5bMF0gLyAyICsgblsxXSAvIDIsIHEgPSBwIC8gMiAvIE1hdGguc2luKG8gLyAyKTtcclxuICAgICAgICBudWxsICE9IGcgJiYgZyA+IHEgJiYgKHEgPSBnKTtcclxuICAgICAgICB2YXIgciA9IHEgKiBpLCBzID0gcSAqIGosIHQgPSBkLmFuaW1hdGU7XHJcbiAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgdmFyIHUgPSB0LnRpbWUgfHwgMWUzLCB2ID0gMDtcclxuICAgICAgICAgICAgYy5mb3JFYWNoKGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgICAgICB2ICs9IDAgPT0gYyA/IG1bY10gOiBtW2MgLSAxXSArIG1bY107XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGUgKyBNYXRoLmNvcyh2KSAqIHIsIGcgPSBmICsgTWF0aC5zaW4odikgKiBzO1xyXG4gICAgICAgICAgICAgICAgYS5BbmltYXRlLnN0ZXBCeVN0ZXAoYiwge3g6IGQgLSBiLndpZHRoIC8gMiwgeTogZyAtIGIuaGVpZ2h0IC8gMn0sIHUpLnN0YXJ0KClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdiA9IDA7XHJcbiAgICAgICAgICAgIGMuZm9yRWFjaChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdiArPSAwID09IGIgPyBtW2JdIDogbVtiIC0gMV0gKyBtW2JdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBlICsgTWF0aC5jb3ModikgKiByLCBkID0gZiArIE1hdGguc2luKHYpICogcztcclxuICAgICAgICAgICAgICAgIGEuY3ggPSBjLCBhLmN5ID0gZFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge2N4OiBlLCBjeTogZiwgcmFkaXVzOiByLCByYWRpdXNBOiByLCByYWRpdXNCOiBzfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGQoYSwgYikge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGMuY2hpbGRzO1xyXG4gICAgICAgICAgICBpZiAoIShkLmxlbmd0aCA8PSAwKSlmb3IgKHZhciBlID0gYy5nZXRCb3VuZCgpLCBmID0gZFswXSwgZyA9IChlLndpZHRoIC0gZi53aWR0aCkgLyBiLCBoID0gKGUuaGVpZ2h0IC0gZi5oZWlnaHQpIC8gYSwgaSA9IChkLmxlbmd0aCwgMCksIGogPSAwOyBhID4gajsgaisrKWZvciAodmFyIGsgPSAwOyBiID4gazsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbCA9IGRbaSsrXSwgbSA9IGUubGVmdCArIGcgLyAyICsgayAqIGcsIG4gPSBlLnRvcCArIGggLyAyICsgaiAqIGg7XHJcbiAgICAgICAgICAgICAgICBpZiAobC5zZXRMb2NhdGlvbihtLCBuKSwgaSA+PSBkLmxlbmd0aClyZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlKGEsIGIpIHtcclxuICAgICAgICByZXR1cm4gbnVsbCA9PSBhICYmIChhID0gMCksIG51bGwgPT0gYiAmJiAoYiA9IDApLCBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGMuY2hpbGRzO1xyXG4gICAgICAgICAgICBpZiAoIShkLmxlbmd0aCA8PSAwKSlmb3IgKHZhciBlID0gYy5nZXRCb3VuZCgpLCBmID0gZS5sZWZ0LCBnID0gZS50b3AsIGggPSAwOyBoIDwgZC5sZW5ndGg7IGgrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBkW2hdO1xyXG4gICAgICAgICAgICAgICAgZiArIGkud2lkdGggPj0gZS5yaWdodCAmJiAoZiA9IGUubGVmdCwgZyArPSBiICsgaS5oZWlnaHQpLCBpLnNldExvY2F0aW9uKGYsIGcpLCBmICs9IGEgKyBpLndpZHRoXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZigpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgaWYgKGIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDFlNywgZCA9IC0xZTcsIGUgPSAxZTcsIGYgPSAtMWU3LCBnID0gZCAtIGMsIGggPSBmIC0gZSwgaSA9IDA7IGkgPCBiLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGogPSBiW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGoueCA8PSBjICYmIChjID0gai54KSwgai54ID49IGQgJiYgKGQgPSBqLngpLCBqLnkgPD0gZSAmJiAoZSA9IGoueSksIGoueSA+PSBmICYmIChmID0gai55KSwgZyA9IGQgLSBjICsgai53aWR0aCwgaCA9IGYgLSBlICsgai5oZWlnaHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGEueCA9IGMsIGEueSA9IGUsIGEud2lkdGggPSBnLCBhLmhlaWdodCA9IGhcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnKGIpIHtcclxuICAgICAgICB2YXIgYyA9IFtdLCBkID0gYi5maWx0ZXIoZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGIgaW5zdGFuY2VvZiBhLkxpbmsgPyAhMCA6IChjLnB1c2goYiksICExKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBiID0gYy5maWx0ZXIoZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBkLmxlbmd0aDsgYisrKWlmIChkW2JdLm5vZGVaID09PSBhKXJldHVybiAhMTtcclxuICAgICAgICAgICAgcmV0dXJuICEwXHJcbiAgICAgICAgfSksIGIgPSBiLmZpbHRlcihmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IGQubGVuZ3RoOyBiKyspaWYgKGRbYl0ubm9kZUEgPT09IGEpcmV0dXJuICEwO1xyXG4gICAgICAgICAgICByZXR1cm4gITFcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGgoYSkge1xyXG4gICAgICAgIHZhciBiID0gMCwgYyA9IDA7XHJcbiAgICAgICAgcmV0dXJuIGEuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBiICs9IGEud2lkdGgsIGMgKz0gYS5oZWlnaHRcclxuICAgICAgICB9KSwge3dpZHRoOiBiIC8gYS5sZW5ndGgsIGhlaWdodDogYyAvIGEubGVuZ3RofVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGkoYSwgYiwgYywgZCkge1xyXG4gICAgICAgIGIueCArPSBjLCBiLnkgKz0gZDtcclxuICAgICAgICBmb3IgKHZhciBlID0gcShhLCBiKSwgZiA9IDA7IGYgPCBlLmxlbmd0aDsgZisrKWkoYSwgZVtmXSwgYywgZClcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBqKGEsIGIpIHtcclxuICAgICAgICBmdW5jdGlvbiBjKGIsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBxKGEsIGIpO1xyXG4gICAgICAgICAgICBudWxsID09IGRbZV0gJiYgKGRbZV0gPSB7fSwgZFtlXS5ub2RlcyA9IFtdLCBkW2VdLmNoaWxkcyA9IFtdKSwgZFtlXS5ub2Rlcy5wdXNoKGIpLCBkW2VdLmNoaWxkcy5wdXNoKGYpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBnID0gMDsgZyA8IGYubGVuZ3RoOyBnKyspYyhmW2ddLCBlICsgMSksIGZbZ10ucGFyZW50ID0gYlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGQgPSBbXTtcclxuICAgICAgICByZXR1cm4gYyhiLCAwKSwgZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGsoYiwgYywgZCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBmKGYsIGcpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGggPSBhLmxheW91dC5nZXRUcmVlRGVlcChmLCBnKSwgayA9IGooZiwgZyksIGwgPSBrW1wiXCIgKyBoXS5ub2RlcywgbSA9IDA7IG0gPCBsLmxlbmd0aDsgbSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBsW21dLCBvID0gKG0gKyAxKSAqIChjICsgMTApLCBwID0gaCAqIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJkb3duXCIgPT0gYiB8fCAoXCJ1cFwiID09IGIgPyBwID0gLXAgOiBcImxlZnRcIiA9PSBiID8gKG8gPSAtaCAqIGQsIHAgPSAobSArIDEpICogKGMgKyAxMCkpIDogXCJyaWdodFwiID09IGIgJiYgKG8gPSBoICogZCwgcCA9IChtICsgMSkgKiAoYyArIDEwKSkpLCBuLnNldExvY2F0aW9uKG8sIHApXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBxID0gaCAtIDE7IHEgPj0gMDsgcS0tKWZvciAodmFyIHIgPSBrW1wiXCIgKyBxXS5ub2RlcywgcyA9IGtbXCJcIiArIHFdLmNoaWxkcywgbSA9IDA7IG0gPCByLmxlbmd0aDsgbSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSByW21dLCB1ID0gc1ttXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJkb3duXCIgPT0gYiA/IHQueSA9IHEgKiBkIDogXCJ1cFwiID09IGIgPyB0LnkgPSAtcSAqIGQgOiBcImxlZnRcIiA9PSBiID8gdC54ID0gLXEgKiBkIDogXCJyaWdodFwiID09IGIgJiYgKHQueCA9IHEgKiBkKSwgdS5sZW5ndGggPiAwID8gXCJkb3duXCIgPT0gYiB8fCBcInVwXCIgPT0gYiA/IHQueCA9ICh1WzBdLnggKyB1W3UubGVuZ3RoIC0gMV0ueCkgLyAyIDogKFwibGVmdFwiID09IGIgfHwgXCJyaWdodFwiID09IGIpICYmICh0LnkgPSAodVswXS55ICsgdVt1Lmxlbmd0aCAtIDFdLnkpIC8gMikgOiBtID4gMCAmJiAoXCJkb3duXCIgPT0gYiB8fCBcInVwXCIgPT0gYiA/IHQueCA9IHJbbSAtIDFdLnggKyByW20gLSAxXS53aWR0aCArIGMgOiAoXCJsZWZ0XCIgPT0gYiB8fCBcInJpZ2h0XCIgPT0gYikgJiYgKHQueSA9IHJbbSAtIDFdLnkgKyByW20gLSAxXS5oZWlnaHQgKyBjKSksIG0gPiAwKWlmIChcImRvd25cIiA9PSBiIHx8IFwidXBcIiA9PSBiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnggPCByW20gLSAxXS54ICsgclttIC0gMV0ud2lkdGgpZm9yICh2YXIgdiA9IHJbbSAtIDFdLnggKyByW20gLSAxXS53aWR0aCArIGMsIHcgPSBNYXRoLmFicyh2IC0gdC54KSwgeCA9IG07IHggPCByLmxlbmd0aDsgeCsrKWkoZS5jaGlsZHMsIHJbeF0sIHcsIDApXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoXCJsZWZ0XCIgPT0gYiB8fCBcInJpZ2h0XCIgPT0gYikgJiYgdC55IDwgclttIC0gMV0ueSArIHJbbSAtIDFdLmhlaWdodClmb3IgKHZhciB5ID0gclttIC0gMV0ueSArIHJbbSAtIDFdLmhlaWdodCArIGMsIHogPSBNYXRoLmFicyh5IC0gdC55KSwgeCA9IG07IHggPCByLmxlbmd0aDsgeCsrKWkoZS5jaGlsZHMsIHJbeF0sIDAsIHopXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBnID0gbnVsbDtcclxuICAgICAgICAgICAgbnVsbCA9PSBjICYmIChnID0gaChlLmNoaWxkcyksIGMgPSBnLndpZHRoLCAoXCJsZWZ0XCIgPT0gYiB8fCBcInJpZ2h0XCIgPT0gYikgJiYgKGMgPSBnLndpZHRoICsgMTApKSwgbnVsbCA9PSBkICYmIChudWxsID09IGcgJiYgKGcgPSBoKGUuY2hpbGRzKSksIGQgPSAyICogZy5oZWlnaHQpLCBudWxsID09IGIgJiYgKGIgPSBcImRvd25cIik7XHJcbiAgICAgICAgICAgIHZhciBrID0gYS5sYXlvdXQuZ2V0Um9vdE5vZGVzKGUuY2hpbGRzKTtcclxuICAgICAgICAgICAgaWYgKGsubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZihlLmNoaWxkcywga1swXSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbCA9IGEudXRpbC5nZXRFbGVtZW50c0JvdW5kKGUuY2hpbGRzKSwgbSA9IGUuZ2V0Q2VudGVyTG9jYXRpb24oKSwgbiA9IG0ueCAtIChsLmxlZnQgKyBsLnJpZ2h0KSAvIDIsIG8gPSBtLnkgLSAobC50b3AgKyBsLmJvdHRvbSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgZS5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGIgaW5zdGFuY2VvZiBhLk5vZGUgJiYgKGIueCArPSBuLCBiLnkgKz0gbylcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbChiKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGQoYSwgYywgZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBxKGEsIGMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gZi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBudWxsID09IGUgJiYgKGUgPSBiKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IDIgKiBNYXRoLlBJIC8gZi5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5mb3JFYWNoKGZ1bmN0aW9uIChiLCBmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoID0gYy54ICsgZSAqIE1hdGguY29zKGcgKiBmKSwgaSA9IGMueSArIGUgKiBNYXRoLnNpbihnICogZik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIuc2V0TG9jYXRpb24oaCwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqID0gZSAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQoYSwgYiwgailcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZSA9IGEubGF5b3V0LmdldFJvb3ROb2RlcyhjLmNoaWxkcyk7XHJcbiAgICAgICAgICAgIGlmIChlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGQoYy5jaGlsZHMsIGVbMF0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBhLnV0aWwuZ2V0RWxlbWVudHNCb3VuZChjLmNoaWxkcyksIGcgPSBjLmdldENlbnRlckxvY2F0aW9uKCksIGggPSBnLnggLSAoZi5sZWZ0ICsgZi5yaWdodCkgLyAyLCBpID0gZy55IC0gKGYudG9wICsgZi5ib3R0b20pIC8gMjtcclxuICAgICAgICAgICAgICAgIGMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICBiIGluc3RhbmNlb2YgYS5Ob2RlICYmIChiLnggKz0gaCwgYi55ICs9IGkpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG0oYSwgYiwgYywgZCwgZSwgZikge1xyXG4gICAgICAgIGZvciAodmFyIGcgPSBbXSwgaCA9IDA7IGMgPiBoOyBoKyspZm9yICh2YXIgaSA9IDA7IGQgPiBpOyBpKyspZy5wdXNoKHt4OiBhICsgaSAqIGUsIHk6IGIgKyBoICogZn0pO1xyXG4gICAgICAgIHJldHVybiBnXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbihhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgdmFyIGcgPSBlID8gZSA6IDAsIGggPSBmID8gZiA6IDIgKiBNYXRoLlBJLCBpID0gaCAtIGcsIGogPSBpIC8gYywgayA9IFtdO1xyXG4gICAgICAgIGcgKz0gaiAvIDI7XHJcbiAgICAgICAgZm9yICh2YXIgbCA9IGc7IGggPj0gbDsgbCArPSBqKSB7XHJcbiAgICAgICAgICAgIHZhciBtID0gYSArIE1hdGguY29zKGwpICogZCwgbiA9IGIgKyBNYXRoLnNpbihsKSAqIGQ7XHJcbiAgICAgICAgICAgIGsucHVzaCh7eDogbSwgeTogbn0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBrXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbyhhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgdmFyIGcgPSBmIHx8IFwiYm90dG9tXCIsIGggPSBbXTtcclxuICAgICAgICBpZiAoXCJib3R0b21cIiA9PSBnKWZvciAodmFyIGkgPSBhIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBpICsgaiAqIGQsXHJcbiAgICAgICAgICAgIHk6IGIgKyBlXHJcbiAgICAgICAgfSk7IGVsc2UgaWYgKFwidG9wXCIgPT0gZylmb3IgKHZhciBpID0gYSAtIGMgLyAyICogZCArIGQgLyAyLCBqID0gMDsgYyA+PSBqOyBqKyspaC5wdXNoKHtcclxuICAgICAgICAgICAgeDogaSArIGogKiBkLFxyXG4gICAgICAgICAgICB5OiBiIC0gZVxyXG4gICAgICAgIH0pOyBlbHNlIGlmIChcInJpZ2h0XCIgPT0gZylmb3IgKHZhciBpID0gYiAtIGMgLyAyICogZCArIGQgLyAyLCBqID0gMDsgYyA+PSBqOyBqKyspaC5wdXNoKHtcclxuICAgICAgICAgICAgeDogYSArIGUsXHJcbiAgICAgICAgICAgIHk6IGkgKyBqICogZFxyXG4gICAgICAgIH0pOyBlbHNlIGlmIChcImxlZnRcIiA9PSBnKWZvciAodmFyIGkgPSBiIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe3g6IGEgLSBlLCB5OiBpICsgaiAqIGR9KTtcclxuICAgICAgICByZXR1cm4gaFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG0oYSwgYiwgYywgZCwgZSwgZikge1xyXG4gICAgICAgIGZvciAodmFyIGcgPSBbXSwgaCA9IDA7IGMgPiBoOyBoKyspZm9yICh2YXIgaSA9IDA7IGQgPiBpOyBpKyspZy5wdXNoKHt4OiBhICsgaSAqIGUsIHk6IGIgKyBoICogZn0pO1xyXG4gICAgICAgIHJldHVybiBnXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcChhLCBiKSB7XHJcbiAgICAgICAgaWYgKGEubGF5b3V0KSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gYS5sYXlvdXQsIGQgPSBjLnR5cGUsIGUgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoXCJjaXJjbGVcIiA9PSBkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGMucmFkaXVzIHx8IE1hdGgubWF4KGEud2lkdGgsIGEuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIGUgPSBuKGEuY3gsIGEuY3ksIGIubGVuZ3RoLCBmLCBhLmxheW91dC5iZWdpbkFuZ2xlLCBhLmxheW91dC5lbmRBbmdsZSlcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcInRyZWVcIiA9PSBkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZyA9IGMud2lkdGggfHwgNTAsIGggPSBjLmhlaWdodCB8fCA1MCwgaSA9IGMuZGlyZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgZSA9IG8oYS5jeCwgYS5jeSwgYi5sZW5ndGgsIGcsIGgsIGkpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoXCJncmlkXCIgIT0gZClyZXR1cm47XHJcbiAgICAgICAgICAgICAgICBlID0gbShhLngsIGEueSwgYy5yb3dzLCBjLmNvbHMsIGMuaG9yaXpvbnRhbCB8fCAwLCBjLnZlcnRpY2FsIHx8IDApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiLmxlbmd0aDsgaisrKWJbal0uc2V0Q2VudGVyTG9jYXRpb24oZVtqXS54LCBlW2pdLnkpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHEoYiwgYykge1xyXG4gICAgICAgIGZvciAodmFyIGQgPSBbXSwgZSA9IDA7IGUgPCBiLmxlbmd0aDsgZSsrKWJbZV0gaW5zdGFuY2VvZiBhLkxpbmsgJiYgYltlXS5ub2RlQSA9PT0gYyAmJiBkLnB1c2goYltlXS5ub2RlWik7XHJcbiAgICAgICAgcmV0dXJuIGRcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByKGEsIGIsIGMpIHtcclxuICAgICAgICB2YXIgZCA9IHEoYS5jaGlsZHMsIGIpO1xyXG4gICAgICAgIGlmICgwID09IGQubGVuZ3RoKXJldHVybiBudWxsO1xyXG4gICAgICAgIGlmIChwKGIsIGQpLCAxID09IGMpZm9yICh2YXIgZSA9IDA7IGUgPCBkLmxlbmd0aDsgZSsrKXIoYSwgZFtlXSwgYyk7XHJcbiAgICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzKGIsIGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBhLnggLSBiLngsIGQgPSBhLnkgLSBiLnk7XHJcbiAgICAgICAgICAgIGkgKz0gYyAqIGYsIGogKz0gZCAqIGYsIGkgKj0gZywgaiAqPSBnLCBqICs9IGgsIGIueCArPSBpLCBiLnkgKz0galxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgaWYgKCEoKytrID4gMTUwKSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBsLmxlbmd0aDsgYSsrKWxbYV0gIT0gYiAmJiBkKGIsIGxbYV0sIGwpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChlLCAxZTMgLyAyNClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGYgPSAuMDEsIGcgPSAuOTUsIGggPSAtNSwgaSA9IDAsIGogPSAwLCBrID0gMCwgbCA9IGMuZ2V0RWxlbWVudHNCeUNsYXNzKGEuTm9kZSk7XHJcbiAgICAgICAgZSgpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdChhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYyhhLCBiLCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBmID0gcShhLCBiKTtcclxuICAgICAgICAgICAgZSA+IGQgJiYgKGQgPSBlKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgZyA9IDA7IGcgPCBmLmxlbmd0aDsgZysrKWMoYSwgZltnXSwgZSArIDEpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZCA9IDA7XHJcbiAgICAgICAgcmV0dXJuIGMoYSwgYiwgMCksIGRcclxuICAgIH1cclxuXHJcbiAgICBhLmxheW91dCA9IGEuTGF5b3V0ID0ge1xyXG4gICAgICAgIGxheW91dE5vZGU6IHIsXHJcbiAgICAgICAgZ2V0Tm9kZUNoaWxkczogcSxcclxuICAgICAgICBhZGp1c3RQb3NpdGlvbjogcCxcclxuICAgICAgICBzcHJpbmdMYXlvdXQ6IHMsXHJcbiAgICAgICAgZ2V0VHJlZURlZXA6IHQsXHJcbiAgICAgICAgZ2V0Um9vdE5vZGVzOiBnLFxyXG4gICAgICAgIEdyaWRMYXlvdXQ6IGQsXHJcbiAgICAgICAgRmxvd0xheW91dDogZSxcclxuICAgICAgICBBdXRvQm91bmRMYXlvdXQ6IGYsXHJcbiAgICAgICAgQ2lyY2xlTGF5b3V0OiBsLFxyXG4gICAgICAgIFRyZWVMYXlvdXQ6IGssXHJcbiAgICAgICAgZ2V0Tm9kZXNDZW50ZXI6IGIsXHJcbiAgICAgICAgY2lyY2xlTGF5b3V0Tm9kZXM6IGNcclxuICAgIH1cclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKCkge1xyXG4gICAgICAgIHZhciBiID0gbmV3IGEuQ2lyY2xlTm9kZTtcclxuICAgICAgICByZXR1cm4gYi5yYWRpdXMgPSAxNTAsIGIuY29sb3JzID0gW1wiIzM2NjZCMFwiLCBcIiMyQ0E4RTBcIiwgXCIjNzdEMUY2XCJdLCBiLmRhdGFzID0gWy4zLCAuMywgLjRdLCBiLnRpdGxlcyA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiXSwgYi5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gMiAqIGIucmFkaXVzLCBkID0gMiAqIGIucmFkaXVzO1xyXG4gICAgICAgICAgICBiLndpZHRoID0gYywgYi5oZWlnaHQgPSBkO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMCwgZiA9IDA7IGYgPCB0aGlzLmRhdGFzLmxlbmd0aDsgZisrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZyA9IHRoaXMuZGF0YXNbZl0gKiBNYXRoLlBJICogMjtcclxuICAgICAgICAgICAgICAgIGEuc2F2ZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZpbGxTdHlsZSA9IGIuY29sb3JzW2ZdLCBhLm1vdmVUbygwLCAwKSwgYS5hcmMoMCwgMCwgdGhpcy5yYWRpdXMsIGUsIGUgKyBnLCAhMSksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKSwgYS5iZWdpblBhdGgoKSwgYS5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICAgICAgdmFyIGggPSB0aGlzLnRpdGxlc1tmXSArIFwiOiBcIiArICgxMDAgKiB0aGlzLmRhdGFzW2ZdKS50b0ZpeGVkKDIpICsgXCIlXCIsIGkgPSBhLm1lYXN1cmVUZXh0KGgpLndpZHRoLCBqID0gKGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGgsIChlICsgZSArIGcpIC8gMiksIGsgPSB0aGlzLnJhZGl1cyAqIE1hdGguY29zKGopLCBsID0gdGhpcy5yYWRpdXMgKiBNYXRoLnNpbihqKTtcclxuICAgICAgICAgICAgICAgIGogPiBNYXRoLlBJIC8gMiAmJiBqIDw9IE1hdGguUEkgPyBrIC09IGkgOiBqID4gTWF0aC5QSSAmJiBqIDwgMiAqIE1hdGguUEkgKiAzIC8gNCA/IGsgLT0gaSA6IGogPiAyICogTWF0aC5QSSAqIC43NSwgYS5maWxsU3R5bGUgPSBcIiNGRkZGRkZcIiwgYS5maWxsVGV4dChoLCBrLCBsKSwgYS5tb3ZlVG8odGhpcy5yYWRpdXMgKiBNYXRoLmNvcyhqKSwgdGhpcy5yYWRpdXMgKiBNYXRoLnNpbihqKSksIGogPiBNYXRoLlBJIC8gMiAmJiBqIDwgMiAqIE1hdGguUEkgKiAzIC8gNCAmJiAoayAtPSBpKSwgaiA+IE1hdGguUEksIGEuZmlsbCgpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBlICs9IGdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgIHZhciBiID0gbmV3IGEuTm9kZTtcclxuICAgICAgICByZXR1cm4gYi5zaG93U2VsZWN0ZWQgPSAhMSwgYi53aWR0aCA9IDI1MCwgYi5oZWlnaHQgPSAxODAsIGIuY29sb3JzID0gW1wiIzM2NjZCMFwiLCBcIiMyQ0E4RTBcIiwgXCIjNzdEMUY2XCJdLCBiLmRhdGFzID0gWy4zLCAuMywgLjRdLCBiLnRpdGxlcyA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiXSwgYi5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gMywgZCA9ICh0aGlzLndpZHRoIC0gYykgLyB0aGlzLmRhdGFzLmxlbmd0aDtcclxuICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCIjRkZGRkZGXCIsIGEuc3Ryb2tlU3R5bGUgPSBcIiNGRkZGRkZcIiwgYS5tb3ZlVG8oLXRoaXMud2lkdGggLyAyIC0gMSwgLXRoaXMuaGVpZ2h0IC8gMiksIGEubGluZVRvKC10aGlzLndpZHRoIC8gMiAtIDEsIHRoaXMuaGVpZ2h0IC8gMiArIDMpLCBhLmxpbmVUbyh0aGlzLndpZHRoIC8gMiArIGMgKyAxLCB0aGlzLmhlaWdodCAvIDIgKyAzKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5kYXRhcy5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gYi5jb2xvcnNbZV07XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IHRoaXMuZGF0YXNbZV0sIGcgPSBlICogKGQgKyBjKSAtIHRoaXMud2lkdGggLyAyLCBoID0gdGhpcy5oZWlnaHQgLSBmIC0gdGhpcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICAgICAgYS5maWxsUmVjdChnLCBoLCBkLCBmKTtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gXCJcIiArIHBhcnNlSW50KHRoaXMuZGF0YXNbZV0pLCBqID0gYS5tZWFzdXJlVGV4dChpKS53aWR0aCwgayA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwiI0ZGRkZGRlwiLCBhLmZpbGxUZXh0KGksIGcgKyAoZCAtIGopIC8gMiwgaCAtIGspLCBhLmZpbGxUZXh0KHRoaXMudGl0bGVzW2VdLCBnICsgKGQgLSBqKSAvIDIsIHRoaXMuaGVpZ2h0IC8gMiArIGspLCBhLmZpbGwoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGJcclxuICAgIH1cclxuXHJcbiAgICBhLkJhckNoYXJ0Tm9kZSA9IGMsIGEuUGllQ2hhcnROb2RlID0gYlxyXG59KEpUb3BvKSwgZnVuY3Rpb24gKGEpIHtcclxuICAgIGZ1bmN0aW9uIGIoYiwgYykge1xyXG4gICAgICAgIHZhciBkLCBlID0gbnVsbDtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZCA/ICh3aW5kb3cuY2xlYXJJbnRlcnZhbChkKSwgZSAmJiBlLnB1Ymxpc2goXCJzdG9wXCIpLCB0aGlzKSA6IHRoaXNcclxuICAgICAgICAgICAgfSwgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHJldHVybiBkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuY2FsbChhKVxyXG4gICAgICAgICAgICAgICAgfSwgYyksIHRoaXNcclxuICAgICAgICAgICAgfSwgb25TdG9wOiBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGwgPT0gZSAmJiAoZSA9IG5ldyBhLnV0aWwuTWVzc2FnZUJ1cyksIGUuc3Vic2NyaWJlKFwic3RvcFwiLCBiKSwgdGhpc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGMoYSwgYykge1xyXG4gICAgICAgIGMgPSBjIHx8IHt9O1xyXG4gICAgICAgIHZhciBkID0gYy5ncmF2aXR5IHx8IC4xLCBlID0gYy5keCB8fCAwLCBmID0gYy5keSB8fCA1LCBnID0gYy5zdG9wLCBoID0gYy5pbnRlcnZhbCB8fCAzMCwgaSA9IG5ldyBiKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZyAmJiBnKCkgPyAoZiA9IC41LCB0aGlzLnN0b3AoKSkgOiAoZiArPSBkLCBhLnNldExvY2F0aW9uKGEueCArIGUsIGEueSArIGYpKVxyXG4gICAgICAgIH0sIGgpO1xyXG4gICAgICAgIHJldHVybiBpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZChhLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgdmFyIGcgPSAxZTMgLyAyNCwgaCA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gYykge1xyXG4gICAgICAgICAgICB2YXIgaiA9IGNbaV0sIGsgPSBqIC0gYVtpXTtcclxuICAgICAgICAgICAgaFtpXSA9IHtcclxuICAgICAgICAgICAgICAgIG9sZFZhbHVlOiBhW2ldLCB0YXJnZXRWYWx1ZTogaiwgc3RlcDogayAvIGQgKiBnLCBpc0RvbmU6IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnN0ZXAgPiAwICYmIGFbYl0gPj0gdGhpcy50YXJnZXRWYWx1ZSB8fCB0aGlzLnN0ZXAgPCAwICYmIGFbYl0gPD0gdGhpcy50YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsID0gbmV3IGIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYiA9ICEwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBkIGluIGMpaFtkXS5pc0RvbmUoZCkgfHwgKGFbZF0gKz0gaFtkXS5zdGVwLCBiID0gITEpO1xyXG4gICAgICAgICAgICBpZiAoYikge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKXJldHVybiB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGQgaW4gYylpZiAoZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBnID0gaFtkXS50YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBoW2RdLnRhcmdldFZhbHVlID0gaFtkXS5vbGRWYWx1ZSwgaFtkXS5vbGRWYWx1ZSA9IGcsIGhbZF0uc3RlcCA9IC1oW2RdLnN0ZXBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBhW2RdID0gaFtkXS5vbGRWYWx1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgfSwgZyk7XHJcbiAgICAgICAgcmV0dXJuIGxcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlKGEpIHtcclxuICAgICAgICBudWxsID09IGEgJiYgKGEgPSB7fSk7XHJcbiAgICAgICAgdmFyIGIgPSBhLnNwcmluZyB8fCAuMSwgYyA9IGEuZnJpY3Rpb24gfHwgLjgsIGQgPSBhLmdyaXZpdHkgfHwgMCwgZSA9IChhLndpbmQgfHwgMCwgYS5taW5MZW5ndGggfHwgMCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaXRlbXM6IFtdLCB0aW1lcjogbnVsbCwgaXNQYXVzZTogITEsIGFkZE5vZGU6IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHtub2RlOiBhLCB0YXJnZXQ6IGIsIHZ4OiAwLCB2eTogMH07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5wdXNoKGMpLCB0aGlzXHJcbiAgICAgICAgICAgIH0sIHBsYXk6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKSwgYSA9IG51bGwgPT0gYSA/IDFlMyAvIDI0IDogYTtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5uZXh0RnJhbWUoKVxyXG4gICAgICAgICAgICAgICAgfSwgYSlcclxuICAgICAgICAgICAgfSwgc3RvcDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbnVsbCAhPSB0aGlzLnRpbWVyICYmIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudGltZXIpXHJcbiAgICAgICAgICAgIH0sIG5leHRGcmFtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCB0aGlzLml0ZW1zLmxlbmd0aDsgYSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSB0aGlzLml0ZW1zW2FdLCBnID0gZi5ub2RlLCBoID0gZi50YXJnZXQsIGkgPSBmLnZ4LCBqID0gZi52eSwgayA9IGgueCAtIGcueCwgbCA9IGgueSAtIGcueSwgbSA9IE1hdGguYXRhbjIobCwgayk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGgueCAtIE1hdGguY29zKG0pICogZSwgbyA9IGgueSAtIE1hdGguc2luKG0pICogZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAobiAtIGcueCkgKiBiLCBqICs9IChvIC0gZy55KSAqIGJcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaSArPSBrICogYiwgaiArPSBsICogYjtcclxuICAgICAgICAgICAgICAgICAgICBpICo9IGMsIGogKj0gYywgaiArPSBkLCBnLnggKz0gaSwgZy55ICs9IGosIGYudnggPSBpLCBmLnZ5ID0galxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGYoYSwgYikge1xyXG4gICAgICAgIGZ1bmN0aW9uIGMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG8gPyB2b2lkIGYuc3RvcCgpIDogKGEucm90YXRlICs9IGcgfHwgLjIsIHZvaWQoYS5yb3RhdGUgPiAyICogTWF0aC5QSSAmJiAoYS5yb3RhdGUgPSAwKSkpXHJcbiAgICAgICAgICAgIH0sIDEwMCksIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuY2xlYXJJbnRlcnZhbChlKSwgZi5vblN0b3AgJiYgZi5vblN0b3AoYSksIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlID0gKGIuY29udGV4dCwgbnVsbCksIGYgPSB7fSwgZyA9IGIudjtcclxuICAgICAgICByZXR1cm4gZi5ydW4gPSBjLCBmLnN0b3AgPSBkLCBmLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmLm9uU3RvcCA9IGEsIGZcclxuICAgICAgICB9LCBmXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZyhhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jbGVhckludGVydmFsKGcpLCBoLm9uU3RvcCAmJiBoLm9uU3RvcChhKSwgaFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBiLmR4IHx8IDAsIGkgPSBiLmR5IHx8IDI7XHJcbiAgICAgICAgICAgIHJldHVybiBnID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG8gPyB2b2lkIGguc3RvcCgpIDogKGkgKz0gZiwgdm9pZChhLnkgKyBhLmhlaWdodCA8IGUuc3RhZ2UuY2FudmFzLmhlaWdodCA/IGEuc2V0TG9jYXRpb24oYS54ICsgZCwgYS55ICsgaSkgOiAoaSA9IDAsIGMoKSkpKVxyXG4gICAgICAgICAgICB9LCAyMCksIGhcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlID0gYi5jb250ZXh0LCBmID0gYi5ncmF2aXR5IHx8IC4xLCBnID0gbnVsbCwgaCA9IHt9O1xyXG4gICAgICAgIHJldHVybiBoLnJ1biA9IGQsIGguc3RvcCA9IGMsIGgub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGgub25TdG9wID0gYSwgaFxyXG4gICAgICAgIH0sIGhcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoKGIsIGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKGMsIGQsIGUsIGYsIGcpIHtcclxuICAgICAgICAgICAgdmFyIGggPSBuZXcgYS5Ob2RlO1xyXG4gICAgICAgICAgICByZXR1cm4gaC5zZXRJbWFnZShiLmltYWdlKSwgaC5zZXRTaXplKGIud2lkdGgsIGIuaGVpZ2h0KSwgaC5zZXRMb2NhdGlvbihjLCBkKSwgaC5zaG93U2VsZWN0ZWQgPSAhMSwgaC5kcmFnYWJsZSA9ICExLCBoLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGEuc2F2ZSgpLCBhLmFyYygwLCAwLCBlLCBmLCBnKSwgYS5jbGlwKCksIGEuYmVnaW5QYXRoKCksIG51bGwgIT0gdGhpcy5pbWFnZSA/IGEuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMikgOiAoYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnN0eWxlLmZpbGxTdHlsZSArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLnJlY3QoLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyLCB0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyKSwgYS5maWxsKCkpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKVxyXG4gICAgICAgICAgICB9LCBoXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlKGMsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBjLCBnID0gYyArIE1hdGguUEksIGggPSBkKGIueCwgYi55LCBiLndpZHRoLCBmLCBnKSwgaiA9IGQoYi54IC0gMiArIDQgKiBNYXRoLnJhbmRvbSgpLCBiLnksIGIud2lkdGgsIGYgKyBNYXRoLlBJLCBmKTtcclxuICAgICAgICAgICAgYi52aXNpYmxlID0gITEsIGUuYWRkKGgpLCBlLmFkZChqKSwgYS5BbmltYXRlLmdyYXZpdHkoaCwge2NvbnRleHQ6IGUsIGR4OiAuM30pLnJ1bigpLm9uU3RvcChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlLnJlbW92ZShoKSwgZS5yZW1vdmUoaiksIGkuc3RvcCgpXHJcbiAgICAgICAgICAgIH0pLCBhLkFuaW1hdGUuZ3Jhdml0eShqLCB7Y29udGV4dDogZSwgZHg6IC0uMn0pLnJ1bigpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZShjLmFuZ2xlLCBoKSwgaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGkub25TdG9wICYmIGkub25TdG9wKGIpLCBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaCA9IGMuY29udGV4dCwgaSA9IChiLnN0eWxlLCB7fSk7XHJcbiAgICAgICAgcmV0dXJuIGkub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGkub25TdG9wID0gYSwgaVxyXG4gICAgICAgIH0sIGkucnVuID0gZiwgaS5zdG9wID0gZywgaVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGkoYSwgYikge1xyXG4gICAgICAgIGZ1bmN0aW9uIGMoYSkge1xyXG4gICAgICAgICAgICBhLnZpc2libGUgPSAhMCwgYS5yb3RhdGUgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICAgICAgICB2YXIgYiA9IGcuc3RhZ2UuY2FudmFzLndpZHRoIC8gMjtcclxuICAgICAgICAgICAgYS54ID0gYiArIE1hdGgucmFuZG9tKCkgKiAoYiAtIDEwMCkgLSBNYXRoLnJhbmRvbSgpICogKGIgLSAxMDApLCBhLnkgPSBnLnN0YWdlLmNhbnZhcy5oZWlnaHQsIGEudnggPSA1ICogTWF0aC5yYW5kb20oKSAtIDUgKiBNYXRoLnJhbmRvbSgpLCBhLnZ5ID0gLTI1XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYyhhKSwgaCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvID8gdm9pZCBpLnN0b3AoKSA6IChhLnZ5ICs9IGYsIGEueCArPSBhLnZ4LCBhLnkgKz0gYS52eSwgdm9pZCgoYS54IDwgMCB8fCBhLnggPiBnLnN0YWdlLmNhbnZhcy53aWR0aCB8fCBhLnkgPiBnLnN0YWdlLmNhbnZhcy5oZWlnaHQpICYmIChpLm9uU3RvcCAmJiBpLm9uU3RvcChhKSwgYyhhKSkpKVxyXG4gICAgICAgICAgICB9LCA1MCksIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKGgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZiA9IC44LCBnID0gYi5jb250ZXh0LCBoID0gbnVsbCwgaSA9IHt9O1xyXG4gICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGEsIGlcclxuICAgICAgICB9LCBpLnJ1biA9IGQsIGkuc3RvcCA9IGUsIGlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBqKCkge1xyXG4gICAgICAgIG8gPSAhMFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGsoKSB7XHJcbiAgICAgICAgbyA9ICExXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbChiLCBjKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG4gPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobylyZXR1cm4gdm9pZCBtLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gZi55ICsgaCArIE1hdGguc2luKGspICogajtcclxuICAgICAgICAgICAgICAgIGIuc2V0TG9jYXRpb24oYi54LCBhKSwgayArPSBsXHJcbiAgICAgICAgICAgIH0sIDEwMCksIG1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKG4pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZiA9IGMucDEsIGcgPSBjLnAyLCBoID0gKGMuY29udGV4dCwgZi54ICsgKGcueCAtIGYueCkgLyAyKSwgaSA9IGYueSArIChnLnkgLSBmLnkpIC8gMiwgaiA9IGEudXRpbC5nZXREaXN0YW5jZShmLCBnKSAvIDIsIGsgPSBNYXRoLmF0YW4yKGksIGgpLCBsID0gYy5zcGVlZCB8fCAuMiwgbSA9IHt9LCBuID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gbS5ydW4gPSBkLCBtLnN0b3AgPSBlLCBtXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbShhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGggPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobylyZXR1cm4gdm9pZCBnLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gZS54IC0gYS54LCBjID0gZS55IC0gYS55LCBoID0gYiAqIGYsIGkgPSBjICogZjtcclxuICAgICAgICAgICAgICAgIGEueCArPSBoLCBhLnkgKz0gaSwgLjAxID4gaCAmJiAuMSA+IGkgJiYgZCgpXHJcbiAgICAgICAgICAgIH0sIDEwMCksIGdcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKGgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZSA9IGIucG9zaXRpb24sIGYgPSAoYi5jb250ZXh0LCBiLmVhc2luZyB8fCAuMiksIGcgPSB7fSwgaCA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGcub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGcub25TdG9wID0gYSwgZ1xyXG4gICAgICAgIH0sIGcucnVuID0gYywgZy5zdG9wID0gZCwgZ1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG4oYSwgYikge1xyXG4gICAgICAgIGZ1bmN0aW9uIGMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBqID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYS5zY2FsZVggKz0gZiwgYS5zY2FsZVkgKz0gZiwgYS5zY2FsZVggPj0gZSAmJiBkKClcclxuICAgICAgICAgICAgfSwgMTAwKSwgaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgaS5vblN0b3AgJiYgaS5vblN0b3AoYSksIGEuc2NhbGVYID0gZywgYS5zY2FsZVkgPSBoLCB3aW5kb3cuY2xlYXJJbnRlcnZhbChqKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGUgPSAoYi5wb3NpdGlvbiwgYi5jb250ZXh0LCBiLnNjYWxlIHx8IDEpLCBmID0gLjA2LCBnID0gYS5zY2FsZVgsIGggPSBhLnNjYWxlWSwgaSA9IHt9LCBqID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBhLCBpXHJcbiAgICAgICAgfSwgaS5ydW4gPSBjLCBpLnN0b3AgPSBkLCBpXHJcbiAgICB9XHJcblxyXG4gICAgYS5BbmltYXRlID0ge30sIGEuRWZmZWN0ID0ge307XHJcbiAgICB2YXIgbyA9ICExO1xyXG4gICAgYS5FZmZlY3Quc3ByaW5nID0gZSwgYS5FZmZlY3QuZ3Jhdml0eSA9IGMsIGEuQW5pbWF0ZS5zdGVwQnlTdGVwID0gZCwgYS5BbmltYXRlLnJvdGF0ZSA9IGYsIGEuQW5pbWF0ZS5zY2FsZSA9IG4sIGEuQW5pbWF0ZS5tb3ZlID0gbSwgYS5BbmltYXRlLmN5Y2xlID0gbCwgYS5BbmltYXRlLnJlcGVhdFRocm93ID0gaSwgYS5BbmltYXRlLmRpdmlkZWRUd29QaWVjZSA9IGgsIGEuQW5pbWF0ZS5ncmF2aXR5ID0gZywgYS5BbmltYXRlLnN0YXJ0QWxsID0gaywgYS5BbmltYXRlLnN0b3BBbGwgPSBqXHJcbn0oSlRvcG8pLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgZnVuY3Rpb24gYihhLCBiKSB7XHJcbiAgICAgICAgdmFyIGMgPSBbXTtcclxuICAgICAgICBpZiAoMCA9PSBhLmxlbmd0aClyZXR1cm4gYztcclxuICAgICAgICB2YXIgZCA9IGIubWF0Y2goL15cXHMqKFxcdyspXFxzKiQvKTtcclxuICAgICAgICBpZiAobnVsbCAhPSBkKSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gYS5maWx0ZXIoZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhLmVsZW1lbnRUeXBlID09IGRbMV1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG51bGwgIT0gZSAmJiBlLmxlbmd0aCA+IDAgJiYgKGMgPSBjLmNvbmNhdChlKSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgZiA9ICExO1xyXG4gICAgICAgICAgICBpZiAoZCA9IGIubWF0Y2goL1xccyooXFx3KylcXHMqXFxbXFxzKihcXHcrKVxccyooWz49PF0pXFxzKlsnXCJdKFxcUyspWydcIl1cXHMqXFxdXFxzKi8pLCAobnVsbCA9PSBkIHx8IGQubGVuZ3RoIDwgNSkgJiYgKGQgPSBiLm1hdGNoKC9cXHMqKFxcdyspXFxzKlxcW1xccyooXFx3KylcXHMqKFs+PTxdKVxccyooXFxkKyhcXC5cXGQrKT8pXFxzKlxcXVxccyovKSwgZiA9ICEwKSwgbnVsbCAhPSBkICYmIGQubGVuZ3RoID49IDUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBnID0gZFsxXSwgaCA9IGRbMl0sIGkgPSBkWzNdLCBqID0gZFs0XTtcclxuICAgICAgICAgICAgICAgIGUgPSBhLmZpbHRlcihmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmVsZW1lbnRUeXBlICE9IGcpcmV0dXJuICExO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gYVtoXTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMSA9PSBmICYmIChiID0gcGFyc2VJbnQoYikpLCBcIj1cIiA9PSBpID8gYiA9PSBqIDogXCI+XCIgPT0gaSA/IGIgPiBqIDogXCI8XCIgPT0gaSA/IGogPiBiIDogXCI8PVwiID09IGkgPyBqID49IGIgOiBcIj49XCIgPT0gaSA/IGIgPj0gaiA6IFwiIT1cIiA9PSBpID8gYiAhPSBqIDogITFcclxuICAgICAgICAgICAgICAgIH0pLCBudWxsICE9IGUgJiYgZS5sZW5ndGggPiAwICYmIChjID0gYy5jb25jYXQoZSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjKGEpIHtcclxuICAgICAgICBpZiAoYS5maW5kID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkLmNhbGwodGhpcywgYSlcclxuICAgICAgICAgICAgfSwgZS5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBhW2JdID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMubGVuZ3RoOyBjKyspdGhpc1tjXVtiXShhKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSwgYS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gYVswXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgYyBpbiBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGJbY107XHJcbiAgICAgICAgICAgICAgICBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGYgJiYgIWZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYVtjXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IFtdLCBkID0gMDsgZCA8IGEubGVuZ3RoOyBkKyspYy5wdXNoKGIuYXBwbHkoYVtkXSwgYXJndW1lbnRzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfShmKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhLmF0dHIgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSBhICYmIG51bGwgIT0gYilmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMubGVuZ3RoOyBjKyspdGhpc1tjXVthXSA9IGI7IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gYSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IFtdLCBjID0gMDsgYyA8IHRoaXMubGVuZ3RoOyBjKyspZC5wdXNoKHRoaXNbY11bYV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBhKWZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5sZW5ndGg7IGMrKylmb3IgKHZhciBlIGluIGEpdGhpc1tjXVtlXSA9IGFbZV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH0sIGFcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkKGQpIHtcclxuICAgICAgICB2YXIgZSA9IFtdLCBmID0gW107XHJcbiAgICAgICAgdGhpcyBpbnN0YW5jZW9mIGEuU3RhZ2UgPyAoZSA9IHRoaXMuY2hpbGRzLCBmID0gZi5jb25jYXQoZSkpIDogdGhpcyBpbnN0YW5jZW9mIGEuU2NlbmUgPyBlID0gW3RoaXNdIDogZiA9IHRoaXMsIGUuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmID0gZi5jb25jYXQoYS5jaGlsZHMpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGcgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBnID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiBkID8gZi5maWx0ZXIoZCkgOiBiKGYsIGQpLCBnID0gYyhnKVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBlID0gXCJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2VkcmFnLGtleWRvd24sa2V5dXBcIi5zcGxpdChcIixcIik7XHJcbiAgICBhLlN0YWdlLnByb3RvdHlwZS5maW5kID0gZCwgYS5TY2VuZS5wcm90b3R5cGUuZmluZCA9IGRcclxufShKVG9wbyksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICBmdW5jdGlvbiBiKGEsIGIpIHtcclxuICAgICAgICB0aGlzLnggPSBhLCB0aGlzLnkgPSBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYyhhKSB7XHJcbiAgICAgICAgdGhpcy5wID0gbmV3IGIoMCwgMCksIHRoaXMudyA9IG5ldyBiKDEsIDApLCB0aGlzLnBhaW50ID0gYVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGQoYSwgYiwgYykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgYiA+IGU7IGUrKylhKCksIGMgJiYgZC50dXJuKGMpLCBkLm1vdmUoMylcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZShhLCBiKSB7XHJcbiAgICAgICAgdmFyIGMgPSAyICogTWF0aC5QSTtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGIgPiBlOyBlKyspYSgpLCBkLnR1cm4oYyAvIGIpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGYoYSwgYiwgYykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgYiA+IGU7IGUrKylhKCksIGQucmVzaXplKGMpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGcoYSkge1xyXG4gICAgICAgIHZhciBiID0gMiAqIE1hdGguUEk7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBhID4gZDsgZCsrKWMuZm9yd2FyZCgxKSwgYy50dXJuKGIgLyBhKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoKGEpIHtcclxuICAgICAgICB2YXIgYiA9IDQgKiBNYXRoLlBJO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBkID0gMDsgYSA+IGQ7IGQrKyljLmZvcndhcmQoMSksIGMudHVybihiIC8gYSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaShhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGYgPSAwOyBiID4gZjsgZisrKWEoKSwgZS5mb3J3YXJkKDEpLCBlLnR1cm4oYyksIGUucmVzaXplKGQpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBqID0ge307XHJcbiAgICBjLnByb3RvdHlwZS5mb3J3YXJkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB2YXIgYiA9IHRoaXMucCwgYyA9IHRoaXMudztcclxuICAgICAgICByZXR1cm4gYi54ID0gYi54ICsgYSAqIGMueCwgYi55ID0gYi55ICsgYSAqIGMueSwgdGhpcy5wYWludCAmJiB0aGlzLnBhaW50KGIueCwgYi55KSwgdGhpc1xyXG4gICAgfSwgYy5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgdmFyIGIgPSB0aGlzLnAsIGMgPSB0aGlzLnc7XHJcbiAgICAgICAgcmV0dXJuIGIueCA9IGIueCArIGEgKiBjLngsIGIueSA9IGIueSArIGEgKiBjLnksIHRoaXNcclxuICAgIH0sIGMucHJvdG90eXBlLm1vdmVUbyA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucC54ID0gYSwgdGhpcy5wLnkgPSBiLCB0aGlzXHJcbiAgICB9LCBjLnByb3RvdHlwZS50dXJuID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB2YXIgYiA9ICh0aGlzLnAsIHRoaXMudyksIGMgPSBNYXRoLmNvcyhhKSAqIGIueCAtIE1hdGguc2luKGEpICogYi55LCBkID0gTWF0aC5zaW4oYSkgKiBiLnggKyBNYXRoLmNvcyhhKSAqIGIueTtcclxuICAgICAgICByZXR1cm4gYi54ID0gYywgYi55ID0gZCwgdGhpc1xyXG4gICAgfSwgYy5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICB2YXIgYiA9IHRoaXMudztcclxuICAgICAgICByZXR1cm4gYi54ID0gYi54ICogYSwgYi55ID0gYi55ICogYSwgdGhpc1xyXG4gICAgfSwgYy5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbCA9PSB0aGlzLl9zdGFjayAmJiAodGhpcy5fc3RhY2sgPSBbXSksIHRoaXMuX3N0YWNrLnB1c2goW3RoaXMucCwgdGhpcy53XSksIHRoaXNcclxuICAgIH0sIGMucHJvdG90eXBlLnJlc3RvcmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5fc3RhY2sgJiYgdGhpcy5fc3RhY2subGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHRoaXMuX3N0YWNrLnBvcCgpO1xyXG4gICAgICAgICAgICB0aGlzLnAgPSBhWzBdLCB0aGlzLncgPSBhWzFdXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzXHJcbiAgICB9LCBqLlRvcnRvaXNlID0gYywgai5zaGlmdCA9IGQsIGouc3BpbiA9IGUsIGoucG9seWdvbiA9IGcsIGouc3BpcmFsID0gaSwgai5zdGFyID0gaCwgai5zY2FsZSA9IGYsIGEuTG9nbyA9IGpcclxufSh3aW5kb3cpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2p0b3BvLW1pbi5qc1xuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9');
},function(module,exports){eval('/**\r\n * Created by qiyc on 2017/2/6.\r\n */\r\nvar ruler;\r\nvar util = {\r\n    toJson:function(json){\r\n        if (typeof json == \'string\') {\r\n            json = $.parseJSON(json.replace(/\'/g, \'"\'));\r\n        }\r\n        return json;\r\n    },\r\n    upFirst: function (string) {\r\n        return string.replace(/(^|\\s+)\\w/g, function (s) {\r\n            return s.toUpperCase();//首字母大寫\r\n        })\r\n    },\r\n    extend: function (base, config) {\r\n        try {\r\n            if (typeof base == "object" && typeof config == "object") {\r\n                deep(base, config);\r\n            }\r\n            else {\r\n                console.error("some extend error:", base, config);\r\n            }\r\n        } catch (e) {\r\n            console.error("extend error", e, base, config);\r\n        }\r\n        function deep(attr, config) {\r\n            $.each(attr, function (key, value) {\r\n                if(base.arrow&&key=="size"){\r\n                }\r\n                if (attr[key]&&typeof attr[key] == "object" && typeof config[key] == "object") {\r\n                    if ($.isArray(attr[key]) && $.isArray(config[key])) {\r\n                        attr[key] = config[key];\r\n                    } else if ($.isFunction(attr[key]) && $.isFunction(config[key])) {\r\n                        attr[key] = config[key];\r\n                    } else {\r\n                        deep(attr[key], config[key]);\r\n                    }\r\n                } else if (typeof attr[key] != "undefined" && typeof config[key] != "undefined") {\r\n                    attr[key] = config[key];\r\n                }\r\n            });\r\n        }\r\n\r\n        return base;\r\n    },\r\n    merge:function(object,config){\r\n        if(object&&config&&typeof object=="object"&&typeof config=="object"){\r\n            deep(object,config);\r\n        }\r\n        function deep(source,target){\r\n            $.each(source,function(k,v){\r\n                if(v&&typeof v=="object"){\r\n                    if(!target[k]){\r\n                        target[k]={};\r\n                        deep(v,target[k]);\r\n                    }\r\n                }else\r\n                if(!target[k]){\r\n                    target[k]=v;\r\n                }\r\n            })\r\n        }\r\n        return config;\r\n    },\r\n    getParameter: function (param) {\r\n        var query = window.location.search;//获取URL地址中？后的所有字符\r\n        var iLen = param.length;//获取你的参数名称长度\r\n        var iStart = query.indexOf(param);//获取你该参数名称的其实索引\r\n        if (iStart == -1)//-1为没有该参数\r\n            return "";\r\n        iStart += iLen + 1;\r\n        var iEnd = query.indexOf("&", iStart);//获取第二个参数的其实索引\r\n        if (iEnd == -1)//只有一个参数\r\n            return query.substring(iStart);//获取单个参数的参数值\r\n        return query.substring(iStart, iEnd);//获取第二个参数的值\r\n    },\r\n    //仅画布全屏展示\r\n    runPrefixMethod: function (element, method) {\r\n        var usablePrefixMethod;\r\n        ["webkit", "moz", "ms", "o", ""].forEach(function (prefix) {\r\n                if (usablePrefixMethod) return;\r\n                if (prefix === "") {\r\n                    // 无前缀，方法首字母小写\r\n                    method = method.slice(0, 1).toLowerCase() + method.slice(1);\r\n                }\r\n                var typePrefixMethod = typeof element[prefix + method];\r\n                if (typePrefixMethod + "" !== "undefined") {\r\n                    if (typePrefixMethod === "function") {\r\n                        usablePrefixMethod = element[prefix + method]();\r\n                    } else {\r\n                        usablePrefixMethod = element[prefix + method];\r\n                    }\r\n                }\r\n            }\r\n        );\r\n    },\r\n    //浏览器全屏展示\r\n    launchFullScreen: function (element) {\r\n        if (element.requestFullscreen) {\r\n            element.requestFullscreen();\r\n        } else if (element.mozRequestFullScreen) {\r\n            element.mozRequestFullScreen();\r\n        } else if (element.webkitRequestFullscreen) {\r\n            element.webkitRequestFullscreen();\r\n        } else if (element.msRequestFullscreen) {\r\n            element.msRequestFullscreen();\r\n        }\r\n    },\r\n    //关闭浏览器全屏\r\n    exitFullScreen: function (doc) {\r\n        if (doc.exitFullscreen) {\r\n            doc.exitFullscreen();\r\n        } else if (doc.mozCancelFullScreen) {\r\n            doc.mozCancelFullScreen();\r\n        } else if (doc.webkitExitFullscreen) {\r\n            doc.webkitExitFullscreen();\r\n        }\r\n    },\r\n    //16进制转换\r\n    transHex: function (color) {\r\n        if (color && color.length == 7 && color.charAt(0) == \'#\') {\r\n            var a = parseInt(color.substr(1, 2), 16);\r\n            var b = parseInt(color.substr(3, 2), 16);\r\n            var c = parseInt(color.substr(5, 2), 16);\r\n            return a + \',\' + b + \',\' + c;\r\n        } else {\r\n            return color;\r\n        }\r\n    },\r\n    //切换隐藏\r\n    toggleElemnts: function (arr, visiable) {\r\n        if (arr && arr instanceof Array) {\r\n            $.each(arr, function (i, v) {\r\n                if (typeof(visiable) == \'boolean\') {\r\n                    visiable ? v.show() : v.hide();\r\n                } else {\r\n                    v.visible ? v.hide() : v.show();\r\n                }\r\n            });\r\n        }\r\n    },\r\n    //如果数组中不存在则存入，否则不做操作\r\n    arrayPush: function (arr, value) {\r\n        if (arr.indexOf(value) < 0) {\r\n            arr.push(value);\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //如果数组中不存在则删除，否则不做操作\r\n    arrayDelete: function (arr, value) {\r\n        var i = arr.indexOf(value);\r\n        if (i >= 0) {\r\n            arr.splice(i, 1);\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //批量设值\r\n    setAttr: function (element, object) {\r\n        $.each(object, function (key, value) {\r\n            element.prop[key] = value;\r\n        });\r\n    }, /**\r\n     * 构造类继承关系\r\n     * @memberOf module:zrender/tool/util\r\n     * @param {Function} clazz 源类\r\n     * @param {Function} baseClazz 基类\r\n     */\r\n    inherits: function (clazz, baseClazz) {\r\n        var clazzPrototype = clazz.prototype;\r\n\r\n        function F() {\r\n        }\r\n\r\n        F.prototype = baseClazz.prototype;\r\n        clazz.prototype = new F();\r\n\r\n        for (var prop in clazzPrototype) {\r\n            clazz.prototype[prop] = clazzPrototype[prop];\r\n        }\r\n        clazz.constructor = clazz;\r\n    },\r\n    //显示名字\r\n    showName: function (element) {\r\n        element.text = element.prop.name;\r\n    },\r\n    hideName: function (element) {\r\n        element.text = \'\';\r\n    },\r\n    //深度克隆对象\r\n    deepClone: function (obj) {\r\n        var result, oClass = isClass(obj);\r\n        //确定result的类型\r\n        if (oClass === "Object") {\r\n            result = {};\r\n        } else if (oClass === "Array") {\r\n            result = [];\r\n        } else {\r\n            return obj;\r\n        }\r\n        for (key in obj) {\r\n            var copy = obj[key];\r\n            if (isClass(copy) == "Object") {\r\n                result[key] = arguments.callee(copy);//递归调用\r\n            } else if (isClass(copy) == "Array") {\r\n                result[key] = arguments.callee(copy);\r\n            } else {\r\n                result[key] = obj[key];\r\n            }\r\n        }\r\n        return result;\r\n        function isClass(o) {\r\n            if (o === null) return "Null";\r\n            if (o === undefined) return "Undefined";\r\n            return Object.prototype.toString.call(o).slice(8, -1);\r\n        }\r\n    },\r\n    //获取当前屏幕正中心\r\n    getCenterPosition: function (scene) {\r\n        return {\r\n            x: -scene.translateX + $(window).width() / 2,\r\n            y: -scene.translateY + $(window).height() / 2\r\n        }\r\n    },\r\n    //闪烁\r\n    nodeFlash: function (node, n) {\r\n        if (n == 0) {\r\n            node.selected = false;\r\n            return;\r\n        }\r\n        node.selected = !node.selected;\r\n        setTimeout(function () {\r\n            util.nodeFlash(node, n - 1);\r\n        }, 300);\r\n    },\r\n    //图层平移到节点上\r\n    nodeAsCenter: function (scene, node) {\r\n        if (node) {\r\n            var location = node.getCenterLocation();\r\n            // 查询到的节点居中显示\r\n            if (scene.childs.indexOf(node) > -1) {\r\n                scene.scaleX = 1;\r\n                scene.scaleY = 1;\r\n                scene.setCenter(location.x, location.y);\r\n                // 闪烁几下\r\n                util.nodeFlash(node, 6);\r\n            }\r\n        }\r\n    },//获取字符串长度\r\n    getStringWidth: function (text, size) {\r\n        if (!ruler) {\r\n            ruler = $("span[name=topo_get_string_Width]");\r\n        }\r\n        ruler.text(text);\r\n        if (size) {\r\n            ruler.css("fontSize", size);\r\n        } else {\r\n            ruler.css("fontSize", "14px");\r\n        }\r\n        return ruler[0].offsetWidth;\r\n    }\r\n};\r\nmodule.exports = util;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL3V0aWwuanM/MjkyNiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwyQ0FBMkM7QUFDM0MsZ0NBQWdDO0FBQ2hDLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQSwyQ0FBMkM7QUFDM0MsNkNBQTZDO0FBQzdDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsZUFBZSxTQUFTO0FBQ3hCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiNi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzYuXHJcbiAqL1xyXG52YXIgcnVsZXI7XHJcbnZhciB1dGlsID0ge1xyXG4gICAgdG9Kc29uOmZ1bmN0aW9uKGpzb24pe1xyXG4gICAgICAgIGlmICh0eXBlb2YganNvbiA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBqc29uID0gJC5wYXJzZUpTT04oanNvbi5yZXBsYWNlKC8nL2csICdcIicpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGpzb247XHJcbiAgICB9LFxyXG4gICAgdXBGaXJzdDogZnVuY3Rpb24gKHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKF58XFxzKylcXHcvZywgZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHMudG9VcHBlckNhc2UoKTsvL+mmluWtl+avjeWkp+Wvq1xyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgZXh0ZW5kOiBmdW5jdGlvbiAoYmFzZSwgY29uZmlnKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBiYXNlID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGNvbmZpZyA9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBkZWVwKGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwic29tZSBleHRlbmQgZXJyb3I6XCIsIGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJleHRlbmQgZXJyb3JcIiwgZSwgYmFzZSwgY29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZGVlcChhdHRyLCBjb25maWcpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGF0dHIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZihiYXNlLmFycm93JiZrZXk9PVwic2l6ZVwiKXtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChhdHRyW2tleV0mJnR5cGVvZiBhdHRyW2tleV0gPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgY29uZmlnW2tleV0gPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoYXR0cltrZXldKSAmJiAkLmlzQXJyYXkoY29uZmlnW2tleV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJC5pc0Z1bmN0aW9uKGF0dHJba2V5XSkgJiYgJC5pc0Z1bmN0aW9uKGNvbmZpZ1trZXldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyW2tleV0gPSBjb25maWdba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWVwKGF0dHJba2V5XSwgY29uZmlnW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGF0dHJba2V5XSAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBjb25maWdba2V5XSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cltrZXldID0gY29uZmlnW2tleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGJhc2U7XHJcbiAgICB9LFxyXG4gICAgbWVyZ2U6ZnVuY3Rpb24ob2JqZWN0LGNvbmZpZyl7XHJcbiAgICAgICAgaWYob2JqZWN0JiZjb25maWcmJnR5cGVvZiBvYmplY3Q9PVwib2JqZWN0XCImJnR5cGVvZiBjb25maWc9PVwib2JqZWN0XCIpe1xyXG4gICAgICAgICAgICBkZWVwKG9iamVjdCxjb25maWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBkZWVwKHNvdXJjZSx0YXJnZXQpe1xyXG4gICAgICAgICAgICAkLmVhY2goc291cmNlLGZ1bmN0aW9uKGssdil7XHJcbiAgICAgICAgICAgICAgICBpZih2JiZ0eXBlb2Ygdj09XCJvYmplY3RcIil7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXRhcmdldFtrXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFtrXT17fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVlcCh2LHRhcmdldFtrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfWVsc2VcclxuICAgICAgICAgICAgICAgIGlmKCF0YXJnZXRba10pe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFtrXT12O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29uZmlnO1xyXG4gICAgfSxcclxuICAgIGdldFBhcmFtZXRlcjogZnVuY3Rpb24gKHBhcmFtKSB7XHJcbiAgICAgICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDsvL+iOt+WPllVSTOWcsOWdgOS4re+8n+WQjueahOaJgOacieWtl+esplxyXG4gICAgICAgIHZhciBpTGVuID0gcGFyYW0ubGVuZ3RoOy8v6I635Y+W5L2g55qE5Y+C5pWw5ZCN56ew6ZW/5bqmXHJcbiAgICAgICAgdmFyIGlTdGFydCA9IHF1ZXJ5LmluZGV4T2YocGFyYW0pOy8v6I635Y+W5L2g6K+l5Y+C5pWw5ZCN56ew55qE5YW25a6e57Si5byVXHJcbiAgICAgICAgaWYgKGlTdGFydCA9PSAtMSkvLy0x5Li65rKh5pyJ6K+l5Y+C5pWwXHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgIGlTdGFydCArPSBpTGVuICsgMTtcclxuICAgICAgICB2YXIgaUVuZCA9IHF1ZXJ5LmluZGV4T2YoXCImXCIsIGlTdGFydCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICBpZiAoaUVuZCA9PSAtMSkvL+WPquacieS4gOS4quWPguaVsFxyXG4gICAgICAgICAgICByZXR1cm4gcXVlcnkuc3Vic3RyaW5nKGlTdGFydCk7Ly/ojrflj5bljZXkuKrlj4LmlbDnmoTlj4LmlbDlgLxcclxuICAgICAgICByZXR1cm4gcXVlcnkuc3Vic3RyaW5nKGlTdGFydCwgaUVuZCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlgLxcclxuICAgIH0sXHJcbiAgICAvL+S7heeUu+W4g+WFqOWxj+WxleekulxyXG4gICAgcnVuUHJlZml4TWV0aG9kOiBmdW5jdGlvbiAoZWxlbWVudCwgbWV0aG9kKSB7XHJcbiAgICAgICAgdmFyIHVzYWJsZVByZWZpeE1ldGhvZDtcclxuICAgICAgICBbXCJ3ZWJraXRcIiwgXCJtb3pcIiwgXCJtc1wiLCBcIm9cIiwgXCJcIl0uZm9yRWFjaChmdW5jdGlvbiAocHJlZml4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNhYmxlUHJlZml4TWV0aG9kKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBpZiAocHJlZml4ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5peg5YmN57yA77yM5pa55rOV6aaW5a2X5q+N5bCP5YaZXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gbWV0aG9kLnNsaWNlKDAsIDEpLnRvTG93ZXJDYXNlKCkgKyBtZXRob2Quc2xpY2UoMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZVByZWZpeE1ldGhvZCA9IHR5cGVvZiBlbGVtZW50W3ByZWZpeCArIG1ldGhvZF07XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZVByZWZpeE1ldGhvZCArIFwiXCIgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZVByZWZpeE1ldGhvZCA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzYWJsZVByZWZpeE1ldGhvZCA9IGVsZW1lbnRbcHJlZml4ICsgbWV0aG9kXSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzYWJsZVByZWZpeE1ldGhvZCA9IGVsZW1lbnRbcHJlZml4ICsgbWV0aG9kXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfSxcclxuICAgIC8v5rWP6KeI5Zmo5YWo5bGP5bGV56S6XHJcbiAgICBsYXVuY2hGdWxsU2NyZWVuOiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIGlmIChlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQubW96UmVxdWVzdEZ1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICBlbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgZWxlbWVudC5tc1JlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5YWz6Zet5rWP6KeI5Zmo5YWo5bGPXHJcbiAgICBleGl0RnVsbFNjcmVlbjogZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIGlmIChkb2MuZXhpdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgZG9jLmV4aXRGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkb2MubW96Q2FuY2VsRnVsbFNjcmVlbikge1xyXG4gICAgICAgICAgICBkb2MubW96Q2FuY2VsRnVsbFNjcmVlbigpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZG9jLndlYmtpdEV4aXRGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgIGRvYy53ZWJraXRFeGl0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLzE26L+b5Yi26L2s5o2iXHJcbiAgICB0cmFuc0hleDogZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICAgICAgaWYgKGNvbG9yICYmIGNvbG9yLmxlbmd0aCA9PSA3ICYmIGNvbG9yLmNoYXJBdCgwKSA9PSAnIycpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBwYXJzZUludChjb2xvci5zdWJzdHIoMSwgMiksIDE2KTtcclxuICAgICAgICAgICAgdmFyIGIgPSBwYXJzZUludChjb2xvci5zdWJzdHIoMywgMiksIDE2KTtcclxuICAgICAgICAgICAgdmFyIGMgPSBwYXJzZUludChjb2xvci5zdWJzdHIoNSwgMiksIDE2KTtcclxuICAgICAgICAgICAgcmV0dXJuIGEgKyAnLCcgKyBiICsgJywnICsgYztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gY29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5YiH5o2i6ZqQ6JePXHJcbiAgICB0b2dnbGVFbGVtbnRzOiBmdW5jdGlvbiAoYXJyLCB2aXNpYWJsZSkge1xyXG4gICAgICAgIGlmIChhcnIgJiYgYXJyIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGFyciwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YodmlzaWFibGUpID09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZpc2lhYmxlID8gdi5zaG93KCkgOiB2LmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdi52aXNpYmxlID8gdi5oaWRlKCkgOiB2LnNob3coKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5a2Y5YWl77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICBhcnJheVB1c2g6IGZ1bmN0aW9uIChhcnIsIHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKGFyci5pbmRleE9mKHZhbHVlKSA8IDApIHtcclxuICAgICAgICAgICAgYXJyLnB1c2godmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8v5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5Yig6Zmk77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICBhcnJheURlbGV0ZTogZnVuY3Rpb24gKGFyciwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgaSA9IGFyci5pbmRleE9mKHZhbHVlKTtcclxuICAgICAgICBpZiAoaSA+PSAwKSB7XHJcbiAgICAgICAgICAgIGFyci5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgLy/mibnph4/orr7lgLxcclxuICAgIHNldEF0dHI6IGZ1bmN0aW9uIChlbGVtZW50LCBvYmplY3QpIHtcclxuICAgICAgICAkLmVhY2gob2JqZWN0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBlbGVtZW50LnByb3Bba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSwgLyoqXHJcbiAgICAgKiDmnoTpgKDnsbvnu6fmib/lhbPns7tcclxuICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6enJlbmRlci90b29sL3V0aWxcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNsYXp6IOa6kOexu1xyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYmFzZUNsYXp6IOWfuuexu1xyXG4gICAgICovXHJcbiAgICBpbmhlcml0czogZnVuY3Rpb24gKGNsYXp6LCBiYXNlQ2xhenopIHtcclxuICAgICAgICB2YXIgY2xhenpQcm90b3R5cGUgPSBjbGF6ei5wcm90b3R5cGU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEYoKSB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBGLnByb3RvdHlwZSA9IGJhc2VDbGF6ei5wcm90b3R5cGU7XHJcbiAgICAgICAgY2xhenoucHJvdG90eXBlID0gbmV3IEYoKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBjbGF6elByb3RvdHlwZSkge1xyXG4gICAgICAgICAgICBjbGF6ei5wcm90b3R5cGVbcHJvcF0gPSBjbGF6elByb3RvdHlwZVtwcm9wXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2xhenouY29uc3RydWN0b3IgPSBjbGF6ejtcclxuICAgIH0sXHJcbiAgICAvL+aYvuekuuWQjeWtl1xyXG4gICAgc2hvd05hbWU6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbWVudC50ZXh0ID0gZWxlbWVudC5wcm9wLm5hbWU7XHJcbiAgICB9LFxyXG4gICAgaGlkZU5hbWU6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbWVudC50ZXh0ID0gJyc7XHJcbiAgICB9LFxyXG4gICAgLy/mt7HluqblhYvpmoblr7nosaFcclxuICAgIGRlZXBDbG9uZTogZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgIHZhciByZXN1bHQsIG9DbGFzcyA9IGlzQ2xhc3Mob2JqKTtcclxuICAgICAgICAvL+ehruWumnJlc3VsdOeahOexu+Wei1xyXG4gICAgICAgIGlmIChvQ2xhc3MgPT09IFwiT2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge307XHJcbiAgICAgICAgfSBlbHNlIGlmIChvQ2xhc3MgPT09IFwiQXJyYXlcIikge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGtleSBpbiBvYmopIHtcclxuICAgICAgICAgICAgdmFyIGNvcHkgPSBvYmpba2V5XTtcclxuICAgICAgICAgICAgaWYgKGlzQ2xhc3MoY29weSkgPT0gXCJPYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBhcmd1bWVudHMuY2FsbGVlKGNvcHkpOy8v6YCS5b2S6LCD55SoXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNDbGFzcyhjb3B5KSA9PSBcIkFycmF5XCIpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gYXJndW1lbnRzLmNhbGxlZShjb3B5KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gb2JqW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICBmdW5jdGlvbiBpc0NsYXNzKG8pIHtcclxuICAgICAgICAgICAgaWYgKG8gPT09IG51bGwpIHJldHVybiBcIk51bGxcIjtcclxuICAgICAgICAgICAgaWYgKG8gPT09IHVuZGVmaW5lZCkgcmV0dXJuIFwiVW5kZWZpbmVkXCI7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+iOt+WPluW9k+WJjeWxj+W5leato+S4reW/g1xyXG4gICAgZ2V0Q2VudGVyUG9zaXRpb246IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHg6IC1zY2VuZS50cmFuc2xhdGVYICsgJCh3aW5kb3cpLndpZHRoKCkgLyAyLFxyXG4gICAgICAgICAgICB5OiAtc2NlbmUudHJhbnNsYXRlWSArICQod2luZG93KS5oZWlnaHQoKSAvIDJcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/pl6rng4FcclxuICAgIG5vZGVGbGFzaDogZnVuY3Rpb24gKG5vZGUsIG4pIHtcclxuICAgICAgICBpZiAobiA9PSAwKSB7XHJcbiAgICAgICAgICAgIG5vZGUuc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBub2RlLnNlbGVjdGVkID0gIW5vZGUuc2VsZWN0ZWQ7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHV0aWwubm9kZUZsYXNoKG5vZGUsIG4gLSAxKTtcclxuICAgICAgICB9LCAzMDApO1xyXG4gICAgfSxcclxuICAgIC8v5Zu+5bGC5bmz56e75Yiw6IqC54K55LiKXHJcbiAgICBub2RlQXNDZW50ZXI6IGZ1bmN0aW9uIChzY2VuZSwgbm9kZSkge1xyXG4gICAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IG5vZGUuZ2V0Q2VudGVyTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgLy8g5p+l6K+i5Yiw55qE6IqC54K55bGF5Lit5pi+56S6XHJcbiAgICAgICAgICAgIGlmIChzY2VuZS5jaGlsZHMuaW5kZXhPZihub2RlKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBzY2VuZS5zY2FsZVggPSAxO1xyXG4gICAgICAgICAgICAgICAgc2NlbmUuc2NhbGVZID0gMTtcclxuICAgICAgICAgICAgICAgIHNjZW5lLnNldENlbnRlcihsb2NhdGlvbi54LCBsb2NhdGlvbi55KTtcclxuICAgICAgICAgICAgICAgIC8vIOmXqueDgeWHoOS4i1xyXG4gICAgICAgICAgICAgICAgdXRpbC5ub2RlRmxhc2gobm9kZSwgNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LC8v6I635Y+W5a2X56ym5Liy6ZW/5bqmXHJcbiAgICBnZXRTdHJpbmdXaWR0aDogZnVuY3Rpb24gKHRleHQsIHNpemUpIHtcclxuICAgICAgICBpZiAoIXJ1bGVyKSB7XHJcbiAgICAgICAgICAgIHJ1bGVyID0gJChcInNwYW5bbmFtZT10b3BvX2dldF9zdHJpbmdfV2lkdGhdXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBydWxlci50ZXh0KHRleHQpO1xyXG4gICAgICAgIGlmIChzaXplKSB7XHJcbiAgICAgICAgICAgIHJ1bGVyLmNzcyhcImZvbnRTaXplXCIsIHNpemUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJ1bGVyLmNzcyhcImZvbnRTaXplXCIsIFwiMTRweFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJ1bGVyWzBdLm9mZnNldFdpZHRoO1xyXG4gICAgfVxyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IHV0aWw7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL3V0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Element=__webpack_require__(1);\r\nContainer.prototype = new Element();\r\nmodule.exports =Container;\r\nfunction Container() {\r\n    this.setName=function(name){\r\n        if(this.attr.textPosition!="hide"){\r\n            this.jtopo.text=name;\r\n            this.attr.name=name;\r\n        }\r\n    };\r\n    this.add = function (element) {\r\n        if (!$.isArray(this.children)) {\r\n            this.children = [];\r\n        }\r\n        if(element.jtopo&&this.children.indexOf(element)<0){\r\n            this.children.push(element);\r\n            this.jtopo.add(element.jtopo);\r\n        }\r\n    };\r\n    this.remove=function(element){\r\n        if($.isArray(this.children)&&this.children.indexOf(element)>0){\r\n            this.children.splice(this.children.indexOf(element),1);\r\n            this.jtopo.remove(element.jtopo);\r\n        }\r\n    };\r\n    this.getChildren=function(){\r\n        var children=[];\r\n        var self=this;\r\n        if(self.jtopo&&self.jtopo.childs){\r\n            $.each(self.jtopo.childs,function(i,v){\r\n                if(v.qtopo){\r\n                    children.push(v.qtopo);\r\n                }else{\r\n                    console.error(this,"the child not wraped by qtopo",v);\r\n                }\r\n            });\r\n        }\r\n        this.children=children;\r\n        return children;\r\n    };\r\n    this.getType = function () {\r\n        return "container"\r\n    };\r\n    this.setColor = function (color) {\r\n        if (color) {\r\n            color = QTopo.util.transHex(color.toLowerCase());\r\n            this.jtopo.fillColor = color;\r\n            this.attr.color=color;\r\n        }\r\n    };\r\n    this.setBorder = function (border) {\r\n        if (border.color && $.isNumeric(border.width) && $.isNumeric(border.radius)) {\r\n            this.jtopo.borderColor = QTopo.util.transHex(border.color.toLowerCase());\r\n            this.jtopo.borderWidth = parseInt(border.width);\r\n            this.jtopo.borderRadius = parseInt(border.radius);\r\n            this.attr.border.color=this.jtopo.borderColor;\r\n            this.attr.border.width=this.jtopo.borderWidth;\r\n            this.attr.border.raidus=this.jtopo.borderRadius;\r\n        } else {\r\n            console.error(this,"setBorder need params", border);\r\n        }\r\n    };\r\n    this.setChildren = function (children) {\r\n        if (children) {\r\n            this.jtopo.childDragble = typeof children.dragble == "boolean" ? children.dragble : true;\r\n            this.attr.children.dragble=this.jtopo.childDragble;\r\n        }\r\n    };\r\n}\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvQ29udGFpbmVyLmpzPzNhZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjcuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxudmFyIEVsZW1lbnQ9cmVxdWlyZShcIi4uL0VsZW1lbnQuanNcIik7XHJcbkNvbnRhaW5lci5wcm90b3R5cGUgPSBuZXcgRWxlbWVudCgpO1xyXG5tb2R1bGUuZXhwb3J0cyA9Q29udGFpbmVyO1xyXG5mdW5jdGlvbiBDb250YWluZXIoKSB7XHJcbiAgICB0aGlzLnNldE5hbWU9ZnVuY3Rpb24obmFtZSl7XHJcbiAgICAgICAgaWYodGhpcy5hdHRyLnRleHRQb3NpdGlvbiE9XCJoaWRlXCIpe1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQ9bmFtZTtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWU9bmFtZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5hZGQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIGlmICghJC5pc0FycmF5KHRoaXMuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZWxlbWVudC5qdG9wbyYmdGhpcy5jaGlsZHJlbi5pbmRleE9mKGVsZW1lbnQpPDApe1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uYWRkKGVsZW1lbnQuanRvcG8pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLnJlbW92ZT1mdW5jdGlvbihlbGVtZW50KXtcclxuICAgICAgICBpZigkLmlzQXJyYXkodGhpcy5jaGlsZHJlbikmJnRoaXMuY2hpbGRyZW4uaW5kZXhPZihlbGVtZW50KT4wKXtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UodGhpcy5jaGlsZHJlbi5pbmRleE9mKGVsZW1lbnQpLDEpO1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnJlbW92ZShlbGVtZW50Lmp0b3BvKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5nZXRDaGlsZHJlbj1mdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBjaGlsZHJlbj1bXTtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIGlmKHNlbGYuanRvcG8mJnNlbGYuanRvcG8uY2hpbGRzKXtcclxuICAgICAgICAgICAgJC5lYWNoKHNlbGYuanRvcG8uY2hpbGRzLGZ1bmN0aW9uKGksdil7XHJcbiAgICAgICAgICAgICAgICBpZih2LnF0b3BvKXtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKHYucXRvcG8pO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLFwidGhlIGNoaWxkIG5vdCB3cmFwZWQgYnkgcXRvcG9cIix2KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hpbGRyZW49Y2hpbGRyZW47XHJcbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCJjb250YWluZXJcIlxyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0Q29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgICAgICBpZiAoY29sb3IpIHtcclxuICAgICAgICAgICAgY29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmZpbGxDb2xvciA9IGNvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuY29sb3I9Y29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0Qm9yZGVyID0gZnVuY3Rpb24gKGJvcmRlcikge1xyXG4gICAgICAgIGlmIChib3JkZXIuY29sb3IgJiYgJC5pc051bWVyaWMoYm9yZGVyLndpZHRoKSAmJiAkLmlzTnVtZXJpYyhib3JkZXIucmFkaXVzKSkge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmJvcmRlckNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChib3JkZXIuY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uYm9yZGVyV2lkdGggPSBwYXJzZUludChib3JkZXIud2lkdGgpO1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmJvcmRlclJhZGl1cyA9IHBhcnNlSW50KGJvcmRlci5yYWRpdXMpO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuYm9yZGVyLmNvbG9yPXRoaXMuanRvcG8uYm9yZGVyQ29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5ib3JkZXIud2lkdGg9dGhpcy5qdG9wby5ib3JkZXJXaWR0aDtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLmJvcmRlci5yYWlkdXM9dGhpcy5qdG9wby5ib3JkZXJSYWRpdXM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLFwic2V0Qm9yZGVyIG5lZWQgcGFyYW1zXCIsIGJvcmRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuc2V0Q2hpbGRyZW4gPSBmdW5jdGlvbiAoY2hpbGRyZW4pIHtcclxuICAgICAgICBpZiAoY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5jaGlsZERyYWdibGUgPSB0eXBlb2YgY2hpbGRyZW4uZHJhZ2JsZSA9PSBcImJvb2xlYW5cIiA/IGNoaWxkcmVuLmRyYWdibGUgOiB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuY2hpbGRyZW4uZHJhZ2JsZT10aGlzLmp0b3BvLmNoaWxkRHJhZ2JsZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L2NvbnRhaW5lci9Db250YWluZXIuanNcbi8vIG1vZHVsZSBpZCA9IDdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){
eval("/**\r\n * Created by qiyc on 2017/2/8.\r\n */\r\nvar Container=__webpack_require__(7);\r\nGroup.prototype = new Container();\r\nmodule.exports = Group;\r\n//曲线\r\nvar defaults = function () {\r\n    return {\r\n        name: 'group',\r\n        font:{\r\n            size:16,\r\n            type:\"微软雅黑\",\r\n            color:'255,255,255'\r\n        },\r\n        color: '10,10,100',\r\n        alpha: 0.5,\r\n        dragable: true,\r\n        zIndex: 10,\r\n        border:{\r\n            width:0,\r\n            radius:30,//最大160 最小0\r\n            color:\"255,0,0\"\r\n        },\r\n        textPosition: 'bottom',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n        layout: \"\",\r\n        children:{\r\n            showLink: false,\r\n            showName: true,\r\n            dragble: true\r\n        }\r\n    };\r\n};\r\n\r\nfunction Group(config) {\r\n    var self = this;\r\n    self.jtopo = new JTopo.Container();\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.children=[];\r\n    self.set(self.attr);\r\n    //改写源码绘制曲线,可由curveOffset指定弧度\r\n    reset(self);\r\n}\r\nvar defaultLayout = function (container, children) {\r\n    if (children.length > 0) {\r\n        var left = 1e7,\r\n            right = -1e7,\r\n            top = 1e7,\r\n            bottom = -1e7,\r\n            width = right - left,\r\n            height = bottom - top;\r\n        for (var i = 0; i < children.length; i++) {\r\n            var child = children[i];\r\n            child.x <= left && (left = child.x);\r\n            (child.x+child.width) >= right && (right = child.x+child.width);\r\n            child.y <= top && (top = child.y);\r\n            (child.y+child.height) >= bottom && (bottom = child.y+child.height);\r\n            width = right - left;\r\n            height = bottom - top;\r\n        }\r\n        container.x = left;\r\n        container.y = top;\r\n        container.width = width;\r\n        container.height = height;\r\n    }\r\n};\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(group) {\r\n    group.jtopo.layout=defaultLayout;\r\n}\r\nGroup.prototype.setLayout=function(layout){\r\n    var selected;\r\n    if (layout) {\r\n        switch (layout.type) {\r\n            case 'flow':\r\n                // 流式布局（水平,垂直间隔)\r\n                selected = JTopo.layout.FlowLayout(layout.row, layout.column);\r\n                this.attr.layout=layout;\r\n                break;\r\n            case 'grid':\r\n                // 网格布局(行,列)\r\n                selected = JTopo.layout.GridLayout(layout.row, layout.column);\r\n                this.attr.layout=layout;\r\n                break;\r\n            default:\r\n                selected = defaultLayout;\r\n                this.attr.layout={};\r\n                this.attr.layout.type=\"set\";\r\n        }\r\n    } else {\r\n        selected = defaultLayout;\r\n        this.attr.layout={};\r\n        this.attr.layout.type=\"set\";\r\n    }\r\n    this.jtopo.layout = selected;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanM/YjdmYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIscUJBQXFCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiOC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzguXHJcbiAqL1xyXG52YXIgQ29udGFpbmVyPXJlcXVpcmUoXCIuL0NvbnRhaW5lci5qc1wiKTtcclxuR3JvdXAucHJvdG90eXBlID0gbmV3IENvbnRhaW5lcigpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IEdyb3VwO1xyXG4vL+absue6v1xyXG52YXIgZGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6ICdncm91cCcsXHJcbiAgICAgICAgZm9udDp7XHJcbiAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgIHR5cGU6XCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICAgICAgY29sb3I6JzI1NSwyNTUsMjU1J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29sb3I6ICcxMCwxMCwxMDAnLFxyXG4gICAgICAgIGFscGhhOiAwLjUsXHJcbiAgICAgICAgZHJhZ2FibGU6IHRydWUsXHJcbiAgICAgICAgekluZGV4OiAxMCxcclxuICAgICAgICBib3JkZXI6e1xyXG4gICAgICAgICAgICB3aWR0aDowLFxyXG4gICAgICAgICAgICByYWRpdXM6MzAsLy/mnIDlpKcxNjAg5pyA5bCPMFxyXG4gICAgICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGV4dFBvc2l0aW9uOiAnYm90dG9tJywvL0JvdHRvbV9DZW50ZXIgVG9wX0NlbnRlciBNaWRkbGVfTGVmdCBNaWRkbGVfUmlnaHQgSGlkZGVuLFxyXG4gICAgICAgIGxheW91dDogXCJcIixcclxuICAgICAgICBjaGlsZHJlbjp7XHJcbiAgICAgICAgICAgIHNob3dMaW5rOiBmYWxzZSxcclxuICAgICAgICAgICAgc2hvd05hbWU6IHRydWUsXHJcbiAgICAgICAgICAgIGRyYWdibGU6IHRydWVcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xyXG5cclxuZnVuY3Rpb24gR3JvdXAoY29uZmlnKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmp0b3BvID0gbmV3IEpUb3BvLkNvbnRhaW5lcigpO1xyXG4gICAgLy/lsIHoo4Xlr7nosaHkuYvpl7Tnm7jkupLkv53mjIHlvJXnlKhcclxuICAgIHNlbGYuanRvcG8ucXRvcG89c2VsZjtcclxuICAgIHNlbGYuYXR0ciA9ICBRVG9wby51dGlsLmV4dGVuZChkZWZhdWx0cygpLCBjb25maWcgfHwge30pO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHNlbGYuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgc2VsZi5jaGlsZHJlbj1bXTtcclxuICAgIHNlbGYuc2V0KHNlbGYuYXR0cik7XHJcbiAgICAvL+aUueWGmea6kOeggee7mOWItuabsue6vyzlj6/nlLFjdXJ2ZU9mZnNldOaMh+WumuW8p+W6plxyXG4gICAgcmVzZXQoc2VsZik7XHJcbn1cclxudmFyIGRlZmF1bHRMYXlvdXQgPSBmdW5jdGlvbiAoY29udGFpbmVyLCBjaGlsZHJlbikge1xyXG4gICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICB2YXIgbGVmdCA9IDFlNyxcclxuICAgICAgICAgICAgcmlnaHQgPSAtMWU3LFxyXG4gICAgICAgICAgICB0b3AgPSAxZTcsXHJcbiAgICAgICAgICAgIGJvdHRvbSA9IC0xZTcsXHJcbiAgICAgICAgICAgIHdpZHRoID0gcmlnaHQgLSBsZWZ0LFxyXG4gICAgICAgICAgICBoZWlnaHQgPSBib3R0b20gLSB0b3A7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGQgPSBjaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgY2hpbGQueCA8PSBsZWZ0ICYmIChsZWZ0ID0gY2hpbGQueCk7XHJcbiAgICAgICAgICAgIChjaGlsZC54K2NoaWxkLndpZHRoKSA+PSByaWdodCAmJiAocmlnaHQgPSBjaGlsZC54K2NoaWxkLndpZHRoKTtcclxuICAgICAgICAgICAgY2hpbGQueSA8PSB0b3AgJiYgKHRvcCA9IGNoaWxkLnkpO1xyXG4gICAgICAgICAgICAoY2hpbGQueStjaGlsZC5oZWlnaHQpID49IGJvdHRvbSAmJiAoYm90dG9tID0gY2hpbGQueStjaGlsZC5oZWlnaHQpO1xyXG4gICAgICAgICAgICB3aWR0aCA9IHJpZ2h0IC0gbGVmdDtcclxuICAgICAgICAgICAgaGVpZ2h0ID0gYm90dG9tIC0gdG9wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250YWluZXIueCA9IGxlZnQ7XHJcbiAgICAgICAgY29udGFpbmVyLnkgPSB0b3A7XHJcbiAgICAgICAgY29udGFpbmVyLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgY29udGFpbmVyLmhlaWdodCA9IGhlaWdodDtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVzZXQoZ3JvdXApIHtcclxuICAgIGdyb3VwLmp0b3BvLmxheW91dD1kZWZhdWx0TGF5b3V0O1xyXG59XHJcbkdyb3VwLnByb3RvdHlwZS5zZXRMYXlvdXQ9ZnVuY3Rpb24obGF5b3V0KXtcclxuICAgIHZhciBzZWxlY3RlZDtcclxuICAgIGlmIChsYXlvdXQpIHtcclxuICAgICAgICBzd2l0Y2ggKGxheW91dC50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Zsb3cnOlxyXG4gICAgICAgICAgICAgICAgLy8g5rWB5byP5biD5bGA77yI5rC05bmzLOWeguebtOmXtOmalClcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gSlRvcG8ubGF5b3V0LkZsb3dMYXlvdXQobGF5b3V0LnJvdywgbGF5b3V0LmNvbHVtbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0PWxheW91dDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdncmlkJzpcclxuICAgICAgICAgICAgICAgIC8vIOe9keagvOW4g+WxgCjooYws5YiXKVxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSBKVG9wby5sYXlvdXQuR3JpZExheW91dChsYXlvdXQucm93LCBsYXlvdXQuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9bGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IGRlZmF1bHRMYXlvdXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0PXt9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyLmxheW91dC50eXBlPVwic2V0XCI7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzZWxlY3RlZCA9IGRlZmF1bHRMYXlvdXQ7XHJcbiAgICAgICAgdGhpcy5hdHRyLmxheW91dD17fTtcclxuICAgICAgICB0aGlzLmF0dHIubGF5b3V0LnR5cGU9XCJzZXRcIjtcclxuICAgIH1cclxuICAgIHRoaXMuanRvcG8ubGF5b3V0ID0gc2VsZWN0ZWQ7XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(0);\r\nCurveLink.prototype=new Link();\r\nmodule.exports = CurveLink;\r\n//曲线\r\nvar defaults =function(){\r\n    return {\r\n        num: 1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        type: \'curve\',\r\n        curveOffset:200\r\n    };\r\n};\r\nfunction CurveLink(config){\r\n    if(!config.start||!config.end){\r\n        console.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.FoldLink(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //改写源码绘制曲线,可由curveOffset指定弧度\r\n    reset(self);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    link.jtopo.getStartPosition = function () {\r\n        var a;\r\n        return (a = (function (thisl) {\r\n            var b = thisl.nodeA, c = thisl.nodeZ;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), a;\r\n    };\r\n    link.jtopo.getEndPosition = function () {\r\n        var a;\r\n        return (a = (function (thisl) {\r\n            var b = thisl.nodeZ, c = thisl.nodeA;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), a;\r\n    };\r\n    link.jtopo.paintPath = function (cx, path) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(cx);\r\n        var s = path[0];\r\n        var t = path[path.length - 1];\r\n        cx.beginPath();\r\n        cx.moveTo(s.x, s.y);\r\n        var angle = Math.atan(Math.abs(t.y - s.y) / Math.abs(t.x - s.x));\r\n        var mX = (s.x + t.x) / 2 + link.attr.curveOffset * Math.cos(angle - Math.PI / 2);\r\n        var mY = (s.y + t.y) / 2 + link.attr.curveOffset * Math.sin(angle - Math.PI / 2);\r\n        cx.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n        cx.lineWidth = this.lineWidth;\r\n        cx.moveTo(s.x, s.cy);\r\n        cx.quadraticCurveTo(mX, mY, t.x, t.y);\r\n        cx.stroke();\r\n        if (cx.stroke(), cx.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(cx, s, t);\r\n            }\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(cx, t, s);\r\n            }\r\n        }\r\n    };\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0N1cnZlLmpzP2QwZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiOS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG52YXIgTGluaz1yZXF1aXJlKFwiLi9MaW5rLmpzXCIpO1xyXG5DdXJ2ZUxpbmsucHJvdG90eXBlPW5ldyBMaW5rKCk7XHJcbm1vZHVsZS5leHBvcnRzID0gQ3VydmVMaW5rO1xyXG4vL+absue6v1xyXG52YXIgZGVmYXVsdHMgPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG51bTogMSxcclxuICAgICAgICBhbHBoYToxLFxyXG4gICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICBzaXplOm51bGwsXHJcbiAgICAgICAgICAgIG9mZnNldDowLFxyXG4gICAgICAgICAgICBzdGFydDpmYWxzZSxcclxuICAgICAgICAgICAgZW5kOnRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdhcDoyMCxcclxuICAgICAgICB3aWR0aDogMixcclxuICAgICAgICBkYXNoZWQ6ICBudWxsLFxyXG4gICAgICAgIHpJbmRleCA6IDEwMCxcclxuICAgICAgICB0ZXh0T2Zmc2V0OlswLDBdLFxyXG4gICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICBzaXplOjE2LFxyXG4gICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHR5cGU6ICdjdXJ2ZScsXHJcbiAgICAgICAgY3VydmVPZmZzZXQ6MjAwXHJcbiAgICB9O1xyXG59O1xyXG5mdW5jdGlvbiBDdXJ2ZUxpbmsoY29uZmlnKXtcclxuICAgIGlmKCFjb25maWcuc3RhcnR8fCFjb25maWcuZW5kKXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ3JlYXRlIExpbmsgbmVlZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuanRvcG8gPSBuZXcgSlRvcG8uRm9sZExpbmsoY29uZmlnLnN0YXJ0Lmp0b3BvLCBjb25maWcuZW5kLmp0b3BvKTtcclxuICAgIC8v5bCB6KOF5a+56LGh5LmL6Ze055u45LqS5L+d5oyB5byV55SoXHJcbiAgICBzZWxmLmp0b3BvLnF0b3BvPXNlbGY7XHJcbiAgICBzZWxmLmF0dHIgPSAgUVRvcG8udXRpbC5leHRlbmQoZGVmYXVsdHMoKSwgY29uZmlnIHx8IHt9KTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICBzZWxmLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHNlbGYuc2V0KHNlbGYuYXR0cik7XHJcbiAgICAvL+aUueWGmea6kOeggee7mOWItuabsue6vyzlj6/nlLFjdXJ2ZU9mZnNldOaMh+WumuW8p+W6plxyXG4gICAgcmVzZXQoc2VsZik7XHJcbn1cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVzZXQobGluayl7XHJcbiAgICBsaW5rLmp0b3BvLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGE7XHJcbiAgICAgICAgcmV0dXJuIChhID0gKGZ1bmN0aW9uICh0aGlzbCkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXNsLm5vZGVBLCBjID0gdGhpc2wubm9kZVo7XHJcbiAgICAgICAgICAgIHZhciBkID0gSlRvcG8udXRpbC5saW5lRihiLmN4LCBiLmN5LCBjLmN4LCBjLmN5KTtcclxuICAgICAgICAgICAgdmFyIGUgPSBiLmdldEJvdW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb25MaW5lQm91bmQoZCwgZSk7XHJcbiAgICAgICAgfSkodGhpcykpLCBhO1xyXG4gICAgfTtcclxuICAgIGxpbmsuanRvcG8uZ2V0RW5kUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGE7XHJcbiAgICAgICAgcmV0dXJuIChhID0gKGZ1bmN0aW9uICh0aGlzbCkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXNsLm5vZGVaLCBjID0gdGhpc2wubm9kZUE7XHJcbiAgICAgICAgICAgIHZhciBkID0gSlRvcG8udXRpbC5saW5lRihiLmN4LCBiLmN5LCBjLmN4LCBjLmN5KTtcclxuICAgICAgICAgICAgdmFyIGUgPSBiLmdldEJvdW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb25MaW5lQm91bmQoZCwgZSk7XHJcbiAgICAgICAgfSkodGhpcykpLCBhO1xyXG4gICAgfTtcclxuICAgIGxpbmsuanRvcG8ucGFpbnRQYXRoID0gZnVuY3Rpb24gKGN4LCBwYXRoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoY3gpO1xyXG4gICAgICAgIHZhciBzID0gcGF0aFswXTtcclxuICAgICAgICB2YXIgdCA9IHBhdGhbcGF0aC5sZW5ndGggLSAxXTtcclxuICAgICAgICBjeC5iZWdpblBhdGgoKTtcclxuICAgICAgICBjeC5tb3ZlVG8ocy54LCBzLnkpO1xyXG4gICAgICAgIHZhciBhbmdsZSA9IE1hdGguYXRhbihNYXRoLmFicyh0LnkgLSBzLnkpIC8gTWF0aC5hYnModC54IC0gcy54KSk7XHJcbiAgICAgICAgdmFyIG1YID0gKHMueCArIHQueCkgLyAyICsgbGluay5hdHRyLmN1cnZlT2Zmc2V0ICogTWF0aC5jb3MoYW5nbGUgLSBNYXRoLlBJIC8gMik7XHJcbiAgICAgICAgdmFyIG1ZID0gKHMueSArIHQueSkgLyAyICsgbGluay5hdHRyLmN1cnZlT2Zmc2V0ICogTWF0aC5zaW4oYW5nbGUgLSBNYXRoLlBJIC8gMik7XHJcbiAgICAgICAgY3guc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnN0cm9rZUNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgY3gubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGg7XHJcbiAgICAgICAgY3gubW92ZVRvKHMueCwgcy5jeSk7XHJcbiAgICAgICAgY3gucXVhZHJhdGljQ3VydmVUbyhtWCwgbVksIHQueCwgdC55KTtcclxuICAgICAgICBjeC5zdHJva2UoKTtcclxuICAgICAgICBpZiAoY3guc3Ryb2tlKCksIGN4LmNsb3NlUGF0aCgpLCBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuZW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coY3gsIHMsIHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhjeCwgdCwgcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0N1cnZlLmpzXG4vLyBtb2R1bGUgaWQgPSA5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(0);\r\nDirectLink.prototype=new Link();\r\nmodule.exports = DirectLink;\r\n//直线\r\nvar defaults =function(){\r\n    return {\r\n        num: 1,\r\n        alpha:1,\r\n        color: '22,124,255',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:\"微软雅黑\",\r\n            color:'255,255,255'\r\n        },\r\n        type: 'direct',\r\n        bundleOffset:60// 多条直线时，线条折线拐角处的长度\r\n    };\r\n};\r\nfunction DirectLink(config) {\r\n    if(!config.start||!config.end){\r\n        console.error(\"Create Link need start and end\");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.Link(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //源码修改\r\n    reset(self);\r\n\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    //双向箭头\r\n    link.jtopo.getStartPosition = function () {\r\n        var a;\r\n        return null != this.arrowsRadius && (a = (function (thisl) {\r\n            var b = thisl.nodeA, c = thisl.nodeZ;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), null == a && (a = {\r\n            x: this.nodeA.cx,\r\n            y: this.nodeA.cy\r\n        }), a;\r\n    };\r\n    link.jtopo.paintPath = function (a, b) {\r\n        if (this.nodeA === this.nodeZ) return void this.paintLoop(a);\r\n        a.beginPath(),\r\n            a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++) {\r\n            null == this.dashedPattern ? (\r\n                (null == this.PointPathColor ? a.lineTo(b[c].x, b[c].y) : a.JtopoDrawPointPath(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, a.strokeStyle, this.PointPathColor))\r\n            ) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern)\r\n        }\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(a, b[0], b[b.length - 1]);\r\n            }//终点箭头\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(a, b[b.length - 1], b[0]);\r\n            }//起点箭头\r\n        }\r\n    };\r\n}\r\nDirectLink.prototype.setBundleOffset=function(bundleOffset){\r\n    this.jtopo.bundleOffset=parseInt(bundleOffset);\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0RpcmVjdC5qcz9jZjVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHFpeWMgb24gMjAxNy8yLzcuXHJcbiAqL1xyXG52YXIgTGluaz1yZXF1aXJlKFwiLi9MaW5rLmpzXCIpO1xyXG5EaXJlY3RMaW5rLnByb3RvdHlwZT1uZXcgTGluaygpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IERpcmVjdExpbms7XHJcbi8v55u057q/XHJcbnZhciBkZWZhdWx0cyA9ZnVuY3Rpb24oKXtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbnVtOiAxLFxyXG4gICAgICAgIGFscGhhOjEsXHJcbiAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICBhcnJvdzp7XHJcbiAgICAgICAgICAgIHNpemU6bnVsbCxcclxuICAgICAgICAgICAgb2Zmc2V0OjAsXHJcbiAgICAgICAgICAgIHN0YXJ0OmZhbHNlLFxyXG4gICAgICAgICAgICBlbmQ6dHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2FwOjIwLFxyXG4gICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgekluZGV4IDogMTAwLFxyXG4gICAgICAgIHRleHRPZmZzZXQ6WzAsMF0sXHJcbiAgICAgICAgZm9udDp7XHJcbiAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgIHR5cGU6XCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICAgICAgY29sb3I6JzI1NSwyNTUsMjU1J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdHlwZTogJ2RpcmVjdCcsXHJcbiAgICAgICAgYnVuZGxlT2Zmc2V0OjYwLy8g5aSa5p2h55u057q/5pe277yM57q/5p2h5oqY57q/5ouQ6KeS5aSE55qE6ZW/5bqmXHJcbiAgICB9O1xyXG59O1xyXG5mdW5jdGlvbiBEaXJlY3RMaW5rKGNvbmZpZykge1xyXG4gICAgaWYoIWNvbmZpZy5zdGFydHx8IWNvbmZpZy5lbmQpe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5qdG9wbyA9IG5ldyBKVG9wby5MaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbyk7XHJcbiAgICAvL+WwgeijheWvueixoeS5i+mXtOebuOS6kuS/neaMgeW8leeUqFxyXG4gICAgc2VsZi5qdG9wby5xdG9wbz1zZWxmO1xyXG4gICAgc2VsZi5hdHRyID0gIFFUb3BvLnV0aWwuZXh0ZW5kKGRlZmF1bHRzKCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgc2VsZi5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICBzZWxmLnNldChzZWxmLmF0dHIpO1xyXG4gICAgLy/mupDnoIHkv67mlLlcclxuICAgIHJlc2V0KHNlbGYpO1xyXG5cclxufVxyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIHNlbGYuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXNldChsaW5rKXtcclxuICAgIC8v5Y+M5ZCR566t5aS0XHJcbiAgICBsaW5rLmp0b3BvLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGE7XHJcbiAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMgJiYgKGEgPSAoZnVuY3Rpb24gKHRoaXNsKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpc2wubm9kZUEsIGMgPSB0aGlzbC5ub2RlWjtcclxuICAgICAgICAgICAgdmFyIGQgPSBKVG9wby51dGlsLmxpbmVGKGIuY3gsIGIuY3ksIGMuY3gsIGMuY3kpO1xyXG4gICAgICAgICAgICB2YXIgZSA9IGIuZ2V0Qm91bmQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGYgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbkxpbmVCb3VuZChkLCBlKTtcclxuICAgICAgICB9KSh0aGlzKSksIG51bGwgPT0gYSAmJiAoYSA9IHtcclxuICAgICAgICAgICAgeDogdGhpcy5ub2RlQS5jeCxcclxuICAgICAgICAgICAgeTogdGhpcy5ub2RlQS5jeVxyXG4gICAgICAgIH0pLCBhO1xyXG4gICAgfTtcclxuICAgIGxpbmsuanRvcG8ucGFpbnRQYXRoID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWikgcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgYS5iZWdpblBhdGgoKSxcclxuICAgICAgICAgICAgYS5tb3ZlVG8oYlswXS54LCBiWzBdLnkpO1xyXG4gICAgICAgIGZvciAodmFyIGMgPSAxOyBjIDwgYi5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICBudWxsID09IHRoaXMuZGFzaGVkUGF0dGVybiA/IChcclxuICAgICAgICAgICAgICAgIChudWxsID09IHRoaXMuUG9pbnRQYXRoQ29sb3IgPyBhLmxpbmVUbyhiW2NdLngsIGJbY10ueSkgOiBhLkp0b3BvRHJhd1BvaW50UGF0aChiW2MgLSAxXS54LCBiW2MgLSAxXS55LCBiW2NdLngsIGJbY10ueSwgYS5zdHJva2VTdHlsZSwgdGhpcy5Qb2ludFBhdGhDb2xvcikpXHJcbiAgICAgICAgICAgICkgOiBhLkpUb3BvRGFzaGVkTGluZVRvKGJbYyAtIDFdLngsIGJbYyAtIDFdLnksIGJbY10ueCwgYltjXS55LCB0aGlzLmRhc2hlZFBhdHRlcm4pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuZW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgYlswXSwgYltiLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICAgICAgfS8v57uI54K5566t5aS0XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhhLCBiW2IubGVuZ3RoIC0gMV0sIGJbMF0pO1xyXG4gICAgICAgICAgICB9Ly/otbfngrnnrq3lpLRcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbkRpcmVjdExpbmsucHJvdG90eXBlLnNldEJ1bmRsZU9mZnNldD1mdW5jdGlvbihidW5kbGVPZmZzZXQpe1xyXG4gICAgdGhpcy5qdG9wby5idW5kbGVPZmZzZXQ9cGFyc2VJbnQoYnVuZGxlT2Zmc2V0KTtcclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L2xpbmsvRGlyZWN0LmpzXG4vLyBtb2R1bGUgaWQgPSAxMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(0);\r\nFlexionalLink.prototype=new Link();\r\nmodule.exports = FlexionalLink;\r\n//二次折线\r\nvar defaults =function(){\r\n    return {\r\n        num: 1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width:2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        type: \'flexional\',\r\n        direction:"horizontal",\r\n        offsetGap:60\r\n    };\r\n};\r\nfunction FlexionalLink(config){\r\n    if(!config.start||!config.end){\r\n        console.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.FlexionalLink(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //修改源码\r\n    reset(self);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    //双向箭头\r\n    link.jtopo.paintPath = function (a, b) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n        a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++)\r\n            null == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(a, b[b.length - 2], b[b.length - 1]);\r\n            }\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(a, b[1], b[0]);//添加双向箭头\r\n            }\r\n        }\r\n    };\r\n}\r\nFlexionalLink.prototype.setOffsetGap=function(offsetGap){\r\n    this.jtopo.offsetGap = parseInt(offsetGap);// 折线拐角处的长度\r\n    this.attr.offsetGap=this.jtopo.offsetGap;\r\n};\r\nFlexionalLink.prototype.setDirection=function(direction){\r\n    //折线方向 horizontal 水平 "vertical"垂直\r\n    this.jtopo.direction=direction;\r\n    this.attr.direction=this.jtopo.direction;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qcz8wMDA2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGNBQWM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMTEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxudmFyIExpbms9cmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxuRmxleGlvbmFsTGluay5wcm90b3R5cGU9bmV3IExpbmsoKTtcclxubW9kdWxlLmV4cG9ydHMgPSBGbGV4aW9uYWxMaW5rO1xyXG4vL+S6jOasoeaKmOe6v1xyXG52YXIgZGVmYXVsdHMgPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG51bTogMSxcclxuICAgICAgICBhbHBoYToxLFxyXG4gICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICBzaXplOm51bGwsXHJcbiAgICAgICAgICAgIG9mZnNldDowLFxyXG4gICAgICAgICAgICBzdGFydDpmYWxzZSxcclxuICAgICAgICAgICAgZW5kOnRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdhcDoyMCxcclxuICAgICAgICB3aWR0aDoyLFxyXG4gICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgekluZGV4IDogMTAwLFxyXG4gICAgICAgIHRleHRPZmZzZXQ6WzAsMF0sXHJcbiAgICAgICAgZm9udDp7XHJcbiAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgIHR5cGU6XCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICAgICAgY29sb3I6JzI1NSwyNTUsMjU1J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdHlwZTogJ2ZsZXhpb25hbCcsXHJcbiAgICAgICAgZGlyZWN0aW9uOlwiaG9yaXpvbnRhbFwiLFxyXG4gICAgICAgIG9mZnNldEdhcDo2MFxyXG4gICAgfTtcclxufTtcclxuZnVuY3Rpb24gRmxleGlvbmFsTGluayhjb25maWcpe1xyXG4gICAgaWYoIWNvbmZpZy5zdGFydHx8IWNvbmZpZy5lbmQpe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5qdG9wbyA9IG5ldyBKVG9wby5GbGV4aW9uYWxMaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbyk7XHJcbiAgICAvL+WwgeijheWvueixoeS5i+mXtOebuOS6kuS/neaMgeW8leeUqFxyXG4gICAgc2VsZi5qdG9wby5xdG9wbz1zZWxmO1xyXG4gICAgc2VsZi5hdHRyID0gIFFUb3BvLnV0aWwuZXh0ZW5kKGRlZmF1bHRzKCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgc2VsZi5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICBzZWxmLnNldChzZWxmLmF0dHIpO1xyXG4gICAgLy/kv67mlLnmupDnoIFcclxuICAgIHJlc2V0KHNlbGYpO1xyXG59XHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlc2V0KGxpbmspe1xyXG4gICAgLy/lj4zlkJHnrq3lpLRcclxuICAgIGxpbmsuanRvcG8ucGFpbnRQYXRoID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gdm9pZCB0aGlzLnBhaW50TG9vcChhKTtcclxuICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLm1vdmVUbyhiWzBdLngsIGJbMF0ueSk7XHJcbiAgICAgICAgZm9yICh2YXIgYyA9IDE7IGMgPCBiLmxlbmd0aDsgYysrKVxyXG4gICAgICAgICAgICBudWxsID09IHRoaXMuZGFzaGVkUGF0dGVybiA/IGEubGluZVRvKGJbY10ueCwgYltjXS55KSA6IGEuSlRvcG9EYXNoZWRMaW5lVG8oYltjIC0gMV0ueCwgYltjIC0gMV0ueSwgYltjXS54LCBiW2NdLnksIHRoaXMuZGFzaGVkUGF0dGVybik7XHJcbiAgICAgICAgaWYgKGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgaWYgKGxpbmsuYXR0ci5hcnJvdy5lbmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhhLCBiW2IubGVuZ3RoIC0gMl0sIGJbYi5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxpbmsuYXR0ci5hcnJvdy5zdGFydCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGEsIGJbMV0sIGJbMF0pOy8v5re75Yqg5Y+M5ZCR566t5aS0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbkZsZXhpb25hbExpbmsucHJvdG90eXBlLnNldE9mZnNldEdhcD1mdW5jdGlvbihvZmZzZXRHYXApe1xyXG4gICAgdGhpcy5qdG9wby5vZmZzZXRHYXAgPSBwYXJzZUludChvZmZzZXRHYXApOy8vIOaKmOe6v+aLkOinkuWkhOeahOmVv+W6plxyXG4gICAgdGhpcy5hdHRyLm9mZnNldEdhcD10aGlzLmp0b3BvLm9mZnNldEdhcDtcclxufTtcclxuRmxleGlvbmFsTGluay5wcm90b3R5cGUuc2V0RGlyZWN0aW9uPWZ1bmN0aW9uKGRpcmVjdGlvbil7XHJcbiAgICAvL+aKmOe6v+aWueWQkSBob3Jpem9udGFsIOawtOW5syBcInZlcnRpY2FsXCLlnoLnm7RcclxuICAgIHRoaXMuanRvcG8uZGlyZWN0aW9uPWRpcmVjdGlvbjtcclxuICAgIHRoaXMuYXR0ci5kaXJlY3Rpb249dGhpcy5qdG9wby5kaXJlY3Rpb247XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qc1xuLy8gbW9kdWxlIGlkID0gMTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Link=__webpack_require__(0);\r\nFoldLink.prototype=new Link();\r\nmodule.exports = FoldLink;\r\n//折线\r\nvar defaults =function(){\r\n    return {\r\n        num:1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        textOffset:[0,0],\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        type: \'fold\',\r\n        direction:"vertical"\r\n    };\r\n};\r\nfunction FoldLink(config){\r\n    if(!config.start||!config.end){\r\n        console.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    var self = this;\r\n    self.jtopo = new JTopo.FoldLink(config.start.jtopo, config.end.jtopo);\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    self.attr =  QTopo.util.extend(defaults(), config || {});\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n    //修改源码\r\n    reset(self);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    //双向箭头\r\n    link.jtopo.paintPath = function (a, b) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n        a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++)\r\n            null == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (link.attr.arrow.end) {\r\n                this.paintArrow(a, b[b.length - 2], b[b.length - 1]);\r\n            }\r\n            if (link.attr.arrow.start) {\r\n                this.paintArrow(a, b[1], b[0]);//添加双向箭头\r\n            }\r\n        }\r\n    };\r\n}\r\nFoldLink.prototype.setDirection=function(direction){\r\n    //折线方向 horizontal 水平 "vertical"垂直\r\n    this.jtopo.direction=direction;\r\n    this.attr.direction=this.jtopo.direction;\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZvbGQuanM/NTBiYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjEyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvNy5cclxuICovXHJcbnZhciBMaW5rPXJlcXVpcmUoXCIuL0xpbmsuanNcIik7XHJcbkZvbGRMaW5rLnByb3RvdHlwZT1uZXcgTGluaygpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IEZvbGRMaW5rO1xyXG4vL+aKmOe6v1xyXG52YXIgZGVmYXVsdHMgPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG51bToxLFxyXG4gICAgICAgIGFscGhhOjEsXHJcbiAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICBhcnJvdzp7XHJcbiAgICAgICAgICAgIHNpemU6bnVsbCxcclxuICAgICAgICAgICAgb2Zmc2V0OjAsXHJcbiAgICAgICAgICAgIHN0YXJ0OmZhbHNlLFxyXG4gICAgICAgICAgICBlbmQ6dHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2FwOjIwLFxyXG4gICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgekluZGV4IDogMTAwLFxyXG4gICAgICAgIHRleHRPZmZzZXQ6WzAsMF0sXHJcbiAgICAgICAgZm9udDp7XHJcbiAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgIHR5cGU6XCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICAgICAgY29sb3I6JzI1NSwyNTUsMjU1J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdHlwZTogJ2ZvbGQnLFxyXG4gICAgICAgIGRpcmVjdGlvbjpcInZlcnRpY2FsXCJcclxuICAgIH07XHJcbn07XHJcbmZ1bmN0aW9uIEZvbGRMaW5rKGNvbmZpZyl7XHJcbiAgICBpZighY29uZmlnLnN0YXJ0fHwhY29uZmlnLmVuZCl7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNyZWF0ZSBMaW5rIG5lZWQgc3RhcnQgYW5kIGVuZFwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmp0b3BvID0gbmV3IEpUb3BvLkZvbGRMaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbyk7XHJcbiAgICAvL+WwgeijheWvueixoeS5i+mXtOebuOS6kuS/neaMgeW8leeUqFxyXG4gICAgc2VsZi5qdG9wby5xdG9wbz1zZWxmO1xyXG4gICAgc2VsZi5hdHRyID0gIFFUb3BvLnV0aWwuZXh0ZW5kKGRlZmF1bHRzKCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgc2VsZi5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICBzZWxmLnNldChzZWxmLmF0dHIpO1xyXG4gICAgLy/kv67mlLnmupDnoIFcclxuICAgIHJlc2V0KHNlbGYpO1xyXG59XHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlc2V0KGxpbmspe1xyXG4gICAgLy/lj4zlkJHnrq3lpLRcclxuICAgIGxpbmsuanRvcG8ucGFpbnRQYXRoID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gdm9pZCB0aGlzLnBhaW50TG9vcChhKTtcclxuICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLm1vdmVUbyhiWzBdLngsIGJbMF0ueSk7XHJcbiAgICAgICAgZm9yICh2YXIgYyA9IDE7IGMgPCBiLmxlbmd0aDsgYysrKVxyXG4gICAgICAgICAgICBudWxsID09IHRoaXMuZGFzaGVkUGF0dGVybiA/IGEubGluZVRvKGJbY10ueCwgYltjXS55KSA6IGEuSlRvcG9EYXNoZWRMaW5lVG8oYltjIC0gMV0ueCwgYltjIC0gMV0ueSwgYltjXS54LCBiW2NdLnksIHRoaXMuZGFzaGVkUGF0dGVybik7XHJcbiAgICAgICAgaWYgKGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgaWYgKGxpbmsuYXR0ci5hcnJvdy5lbmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhhLCBiW2IubGVuZ3RoIC0gMl0sIGJbYi5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxpbmsuYXR0ci5hcnJvdy5zdGFydCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGEsIGJbMV0sIGJbMF0pOy8v5re75Yqg5Y+M5ZCR566t5aS0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbkZvbGRMaW5rLnByb3RvdHlwZS5zZXREaXJlY3Rpb249ZnVuY3Rpb24oZGlyZWN0aW9uKXtcclxuICAgIC8v5oqY57q/5pa55ZCRIGhvcml6b250YWwg5rC05bmzIFwidmVydGljYWxcIuWeguebtFxyXG4gICAgdGhpcy5qdG9wby5kaXJlY3Rpb249ZGlyZWN0aW9uO1xyXG4gICAgdGhpcy5hdHRyLmRpcmVjdGlvbj10aGlzLmp0b3BvLmRpcmVjdGlvbjtcclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZvbGQuanNcbi8vIG1vZHVsZSBpZCA9IDEyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\nvar Node=__webpack_require__(2);\r\nNormalNode.prototype =new Node();\r\nmodule.exports = NormalNode;\r\nvar defaults = function () {\r\n    return {\r\n        image: "",\r\n        size: [30, 30],\r\n        name: "node",\r\n        alpha: 1,\r\n        position: [0, 0],\r\n        font: {\r\n            size: 16,\r\n            type: \'微软雅黑\',\r\n            color: "255,255,255"\r\n        },\r\n        zIndex: 200,//层级(10-999)\r\n        color: JTopo.util.randomColor(),\r\n        textPosition: \'bottom\',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden\r\n        type: \'normal\',\r\n        alarm: {\r\n            show: false,\r\n            text: "",\r\n            color: "255,255,255",\r\n            font: {\r\n                size: 16,\r\n                type: "微软雅黑"\r\n            }\r\n        }\r\n    }\r\n};\r\n//一般节点\r\nfunction NormalNode(config) {\r\n    var self = this;\r\n    self.attr = QTopo.util.extend(defaults(), config || {});\r\n    self.jtopo = new JTopo.Node();\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo = self;\r\n    //告警闪烁\r\n    self.jtopo.alarmFlash=alarmFlash;\r\n    //函数\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n        //处理特殊属性的设置\r\n    }\r\n}\r\nNormalNode.prototype.setImage=function(image) {\r\n    this.jtopo.setImage(image);\r\n    this.attr.image=image;\r\n};\r\nNormalNode.prototype.setAlarm=function(config) {\r\n    var jtopo = this.jtopo;\r\n    alarmAttr(jtopo,this.attr.alarm,config);\r\n};\r\nfunction alarmAttr(jtopo,alarm,config){\r\n    if(typeof config.show=="undefined"){\r\n        config.show=alarm.show;\r\n    }\r\n    if (config.show) {\r\n        jtopo.shadow = true;\r\n        jtopo.alarm = config.text || "";\r\n        alarm.text=jtopo.alarm;\r\n        if(config.color){\r\n            jtopo.alarmColor = QTopo.util.transHex(config.color.toLowerCase());\r\n            alarm.color=jtopo.alarmColor;\r\n        }\r\n        jtopo.alarmAlpha = 1;\r\n        var size=alarm.font.size;\r\n        var font=alarm.font.type;\r\n        if(config.font&&config.font.size){\r\n            size=config.font.size;\r\n        }\r\n        if(config.font&&config.font.type){\r\n            font=config.font.type;\r\n        }\r\n        jtopo.alarmFont =  size+ \'px \' + font;\r\n        alarm.font.size=size;\r\n        alarm.font.type=font;\r\n        toggleAlarmFlash(jtopo,true);\r\n    } else {\r\n        jtopo.alarm = null;\r\n        toggleAlarmFlash(jtopo,false);\r\n    }\r\n    alarm.show=config.show;\r\n}\r\nfunction toggleAlarmFlash(node,show){\r\n    //切换闪烁\r\n    if(show){\r\n        node.shadowOffsetX = 0;\r\n        node.shadowOffsetY = 0;\r\n        node.shadowColor = "rgba(" + node.alarmColor + ",1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=true;\r\n    }else{\r\n        node.shadowOffsetX = 3;\r\n        node.shadowOffsetY = 6;\r\n        node.shadowColor="rgba(0,0,0,0.1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=false;\r\n    }\r\n}\r\nfunction alarmFlash() {\r\n    //插入源码部分代码\r\n    if(this.shadow&&this.allowAlarmFlash){\r\n        if(typeof this.shadowDirection=="undefined"){\r\n            this.shadowDirection=true;\r\n        }\r\n        move(this);\r\n        function move(node){\r\n            if (node.shadowDirection) {\r\n                node.shadowBlur += 5;\r\n                if(node.shadowBlur>100){\r\n                    node.shadowDirection=false;\r\n                }\r\n            }\r\n            else {\r\n                node.shadowBlur -= 5;\r\n                if(node.shadowBlur<=10){\r\n                    node.shadowDirection=true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL05vcm1hbC5qcz8xODQyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBEO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBxaXljIG9uIDIwMTcvMi83LlxyXG4gKi9cclxudmFyIE5vZGU9cmVxdWlyZShcIi4vTm9kZS5qc1wiKTtcclxuTm9ybWFsTm9kZS5wcm90b3R5cGUgPW5ldyBOb2RlKCk7XHJcbm1vZHVsZS5leHBvcnRzID0gTm9ybWFsTm9kZTtcclxudmFyIGRlZmF1bHRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpbWFnZTogXCJcIixcclxuICAgICAgICBzaXplOiBbMzAsIDMwXSxcclxuICAgICAgICBuYW1lOiBcIm5vZGVcIixcclxuICAgICAgICBhbHBoYTogMSxcclxuICAgICAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB6SW5kZXg6IDIwMCwvL+Wxgue6pygxMC05OTkpXHJcbiAgICAgICAgY29sb3I6IEpUb3BvLnV0aWwucmFuZG9tQ29sb3IoKSxcclxuICAgICAgICB0ZXh0UG9zaXRpb246ICdib3R0b20nLC8vQm90dG9tX0NlbnRlciBUb3BfQ2VudGVyIE1pZGRsZV9MZWZ0IE1pZGRsZV9SaWdodCBIaWRkZW5cclxuICAgICAgICB0eXBlOiAnbm9ybWFsJyxcclxuICAgICAgICBhbGFybToge1xyXG4gICAgICAgICAgICBzaG93OiBmYWxzZSxcclxuICAgICAgICAgICAgdGV4dDogXCJcIixcclxuICAgICAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIixcclxuICAgICAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8v5LiA6Iis6IqC54K5XHJcbmZ1bmN0aW9uIE5vcm1hbE5vZGUoY29uZmlnKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChkZWZhdWx0cygpLCBjb25maWcgfHwge30pO1xyXG4gICAgc2VsZi5qdG9wbyA9IG5ldyBKVG9wby5Ob2RlKCk7XHJcbiAgICAvL+WwgeijheWvueixoeS5i+mXtOebuOS6kuS/neaMgeW8leeUqFxyXG4gICAgc2VsZi5qdG9wby5xdG9wbyA9IHNlbGY7XHJcbiAgICAvL+WRiuitpumXqueDgVxyXG4gICAgc2VsZi5qdG9wby5hbGFybUZsYXNoPWFsYXJtRmxhc2g7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgc2VsZi5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICBzZWxmLnNldChzZWxmLmF0dHIpO1xyXG59XHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAvL+WkhOeQhuS4gOiIrOWxnuaAp+eahOiuvue9rlxyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgICAgICAvL+WkhOeQhueJueauiuWxnuaAp+eahOiuvue9rlxyXG4gICAgfVxyXG59XHJcbk5vcm1hbE5vZGUucHJvdG90eXBlLnNldEltYWdlPWZ1bmN0aW9uKGltYWdlKSB7XHJcbiAgICB0aGlzLmp0b3BvLnNldEltYWdlKGltYWdlKTtcclxuICAgIHRoaXMuYXR0ci5pbWFnZT1pbWFnZTtcclxufTtcclxuTm9ybWFsTm9kZS5wcm90b3R5cGUuc2V0QWxhcm09ZnVuY3Rpb24oY29uZmlnKSB7XHJcbiAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgYWxhcm1BdHRyKGp0b3BvLHRoaXMuYXR0ci5hbGFybSxjb25maWcpO1xyXG59O1xyXG5mdW5jdGlvbiBhbGFybUF0dHIoanRvcG8sYWxhcm0sY29uZmlnKXtcclxuICAgIGlmKHR5cGVvZiBjb25maWcuc2hvdz09XCJ1bmRlZmluZWRcIil7XHJcbiAgICAgICAgY29uZmlnLnNob3c9YWxhcm0uc2hvdztcclxuICAgIH1cclxuICAgIGlmIChjb25maWcuc2hvdykge1xyXG4gICAgICAgIGp0b3BvLnNoYWRvdyA9IHRydWU7XHJcbiAgICAgICAganRvcG8uYWxhcm0gPSBjb25maWcudGV4dCB8fCBcIlwiO1xyXG4gICAgICAgIGFsYXJtLnRleHQ9anRvcG8uYWxhcm07XHJcbiAgICAgICAgaWYoY29uZmlnLmNvbG9yKXtcclxuICAgICAgICAgICAganRvcG8uYWxhcm1Db2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29uZmlnLmNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICBhbGFybS5jb2xvcj1qdG9wby5hbGFybUNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBqdG9wby5hbGFybUFscGhhID0gMTtcclxuICAgICAgICB2YXIgc2l6ZT1hbGFybS5mb250LnNpemU7XHJcbiAgICAgICAgdmFyIGZvbnQ9YWxhcm0uZm9udC50eXBlO1xyXG4gICAgICAgIGlmKGNvbmZpZy5mb250JiZjb25maWcuZm9udC5zaXplKXtcclxuICAgICAgICAgICAgc2l6ZT1jb25maWcuZm9udC5zaXplO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihjb25maWcuZm9udCYmY29uZmlnLmZvbnQudHlwZSl7XHJcbiAgICAgICAgICAgIGZvbnQ9Y29uZmlnLmZvbnQudHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAganRvcG8uYWxhcm1Gb250ID0gIHNpemUrICdweCAnICsgZm9udDtcclxuICAgICAgICBhbGFybS5mb250LnNpemU9c2l6ZTtcclxuICAgICAgICBhbGFybS5mb250LnR5cGU9Zm9udDtcclxuICAgICAgICB0b2dnbGVBbGFybUZsYXNoKGp0b3BvLHRydWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBqdG9wby5hbGFybSA9IG51bGw7XHJcbiAgICAgICAgdG9nZ2xlQWxhcm1GbGFzaChqdG9wbyxmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBhbGFybS5zaG93PWNvbmZpZy5zaG93O1xyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUFsYXJtRmxhc2gobm9kZSxzaG93KXtcclxuICAgIC8v5YiH5o2i6Zeq54OBXHJcbiAgICBpZihzaG93KXtcclxuICAgICAgICBub2RlLnNoYWRvd09mZnNldFggPSAwO1xyXG4gICAgICAgIG5vZGUuc2hhZG93T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dDb2xvciA9IFwicmdiYShcIiArIG5vZGUuYWxhcm1Db2xvciArIFwiLDEpXCI7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dCbHVyID0gMTA7XHJcbiAgICAgICAgbm9kZS5hbGxvd0FsYXJtRmxhc2g9dHJ1ZTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIG5vZGUuc2hhZG93T2Zmc2V0WCA9IDM7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dPZmZzZXRZID0gNjtcclxuICAgICAgICBub2RlLnNoYWRvd0NvbG9yPVwicmdiYSgwLDAsMCwwLjEpXCI7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dCbHVyID0gMTA7XHJcbiAgICAgICAgbm9kZS5hbGxvd0FsYXJtRmxhc2g9ZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gYWxhcm1GbGFzaCgpIHtcclxuICAgIC8v5o+S5YWl5rqQ56CB6YOo5YiG5Luj56CBXHJcbiAgICBpZih0aGlzLnNoYWRvdyYmdGhpcy5hbGxvd0FsYXJtRmxhc2gpe1xyXG4gICAgICAgIGlmKHR5cGVvZiB0aGlzLnNoYWRvd0RpcmVjdGlvbj09XCJ1bmRlZmluZWRcIil7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhZG93RGlyZWN0aW9uPXRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1vdmUodGhpcyk7XHJcbiAgICAgICAgZnVuY3Rpb24gbW92ZShub2RlKXtcclxuICAgICAgICAgICAgaWYgKG5vZGUuc2hhZG93RGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLnNoYWRvd0JsdXIgKz0gNTtcclxuICAgICAgICAgICAgICAgIGlmKG5vZGUuc2hhZG93Qmx1cj4xMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuc2hhZG93RGlyZWN0aW9uPWZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5zaGFkb3dCbHVyIC09IDU7XHJcbiAgICAgICAgICAgICAgICBpZihub2RlLnNoYWRvd0JsdXI8PTEwKXtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnNoYWRvd0RpcmVjdGlvbj10cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL05vcm1hbC5qc1xuLy8gbW9kdWxlIGlkID0gMTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval("/**\r\n * Created by qiyc on 2017/2/7.\r\n */\r\n\r\nvar Node=__webpack_require__(2);\r\nTextNode.prototype =new Node();\r\nmodule.exports = TextNode;\r\nvar defaults =function(){\r\n    return {\r\n        position:[0,0],\r\n        font:{\r\n            size:16,\r\n            type: '微软雅黑',\r\n            color:\"255,255,255\"\r\n        },\r\n        zIndex: 200,//层级(10-999)\r\n        alpha: 1,\r\n        text: 'no text here',\r\n        type: 'text'\r\n    };\r\n};\r\n//一般节点\r\nfunction TextNode(config) {\r\n    var self = this;\r\n    self.jtopo = new JTopo.TextNode();\r\n    //封装对象之间相互保持引用\r\n    self.jtopo.qtopo=self;\r\n    //函数\r\n    self.attr= QTopo.util.extend(defaults(), config || {});\r\n    self.set = setJTopo;\r\n    //初始化\r\n    self.set(self.attr);\r\n}\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n    }\r\n}\r\n//私有函数//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1RleHQuanM/MzM5ZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjE0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvNy5cclxuICovXHJcblxyXG52YXIgTm9kZT1yZXF1aXJlKFwiLi9Ob2RlLmpzXCIpO1xyXG5UZXh0Tm9kZS5wcm90b3R5cGUgPW5ldyBOb2RlKCk7XHJcbm1vZHVsZS5leHBvcnRzID0gVGV4dE5vZGU7XHJcbnZhciBkZWZhdWx0cyA9ZnVuY3Rpb24oKXtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcG9zaXRpb246WzAsMF0sXHJcbiAgICAgICAgZm9udDp7XHJcbiAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgICAgICBjb2xvcjpcIjI1NSwyNTUsMjU1XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHpJbmRleDogMjAwLC8v5bGC57qnKDEwLTk5OSlcclxuICAgICAgICBhbHBoYTogMSxcclxuICAgICAgICB0ZXh0OiAnbm8gdGV4dCBoZXJlJyxcclxuICAgICAgICB0eXBlOiAndGV4dCdcclxuICAgIH07XHJcbn07XHJcbi8v5LiA6Iis6IqC54K5XHJcbmZ1bmN0aW9uIFRleHROb2RlKGNvbmZpZykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5qdG9wbyA9IG5ldyBKVG9wby5UZXh0Tm9kZSgpO1xyXG4gICAgLy/lsIHoo4Xlr7nosaHkuYvpl7Tnm7jkupLkv53mjIHlvJXnlKhcclxuICAgIHNlbGYuanRvcG8ucXRvcG89c2VsZjtcclxuICAgIC8v5Ye95pWwXHJcbiAgICBzZWxmLmF0dHI9IFFUb3BvLnV0aWwuZXh0ZW5kKGRlZmF1bHRzKCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBzZWxmLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHNlbGYuc2V0KHNlbGYuYXR0cik7XHJcbn1cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICAvL+WkhOeQhuS4gOiIrOWxnuaAp+eahOiuvue9rlxyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG4vL+engeacieWHveaVsFxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbm9kZS9UZXh0LmpzXG4vLyBtb2R1bGUgaWQgPSAxNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports){eval("// removed by extract-text-webpack-plugin//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvbXBvbmVudC90ZXN0LmNzcz9jNzMyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6IjE1LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29tcG9uZW50L3Rlc3QuY3NzXG4vLyBtb2R1bGUgaWQgPSAxNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports,__webpack_require__){eval('/**\r\n * Created by qiyc on 2017/2/6.\r\n */\r\n    //核心依赖\r\n__webpack_require__(5);\r\n//QTopo\r\nwindow.QTopo = {};\r\nwindow.QTopo.instance=[];\r\nwindow.QTopo.util = __webpack_require__(6);\r\nvar Scene = __webpack_require__(4);\r\nvar windows=__webpack_require__(3);\r\nwindow.QTopo.init = function (dom, config) {\r\n    dom = dom instanceof Array ? dom[0] : dom;\r\n    var canvas=initCanvas(dom,$(dom).width(),$(dom).height());\r\n    var QtopoInstance = {\r\n        scene:new Scene(new JTopo.Stage(canvas),config),\r\n        setOption : setOption,\r\n        document:dom,\r\n        resize:resize(dom,canvas)\r\n    };\r\n    this.instance.push(QtopoInstance);\r\n    return QtopoInstance;\r\n};\r\nfunction setOption(option,clear) {\r\n    var scene = this.scene;\r\n    if(clear){\r\n        scene.clear();\r\n    }\r\n    createNode(scene, option.node);\r\n    createContainer(scene, option.container);\r\n    createLink(scene, option.link);\r\n    drawAlarm(scene,option.alarm);\r\n    scene.center();\r\n}\r\nfunction resize(dom,canvas){\r\n    return function(){\r\n        canvas.setAttribute(\'width\', $(dom).width());\r\n        canvas.setAttribute(\'height\',$(dom).height());\r\n    }\r\n}\r\nfunction initCanvas(dom,width,height){\r\n    if(width<=0||height<=0){\r\n        console.error("The topo need config width and height!");\r\n    }\r\n    dom.style.position=\'relative\';\r\n    dom.style.overflow=\'hidden\';\r\n    var canvas=document.createElement(\'canvas\');\r\n    dom.appendChild(canvas);\r\n    canvas.setAttribute(\'width\', width);\r\n    canvas.setAttribute(\'height\',height);\r\n    canvas.style.position="absolute";\r\n    canvas.style.top=0;\r\n    canvas.style.left=0;\r\n    canvas.style[\'user-select\']= \'none\';\r\n    canvas.style[\'-webkit-tap-highlight-color\']= \'rgba(0, 0, 0, 0)\';\r\n    return canvas;\r\n}\r\nfunction createNode(scene, config) {\r\n    if (config) {\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, v) {\r\n                var node = scene.createNode(v);\r\n                //额外属性添加\r\n                if ($.isArray(config.exprop)) {\r\n                    $.each(config.exprop, function (j, key) {\r\n                        if( v[key]){\r\n                            node[key] = v[key];\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nfunction createContainer(scene, config) {\r\n    if (config) {\r\n        var findChild;\r\n        if (config.children) {\r\n            findChild = config.children;\r\n        }\r\n        if ($.isArray(config.data)) {\r\n            //开始构造分组\r\n            $.each(config.data, function (i, cData) {\r\n                //无论是否有子元素，分组先创造出来\r\n                var container = scene.createContainer(cData);\r\n                //额外属性添加\r\n                if ($.isArray(config.exprop)) {\r\n                    $.each(config.exprop, function (j, key) {\r\n                        if(cData[key]) {\r\n                            container[key] = cData[key];\r\n                        }\r\n                    });\r\n                }\r\n                //确定查找子元素的标记\r\n                var findChild_exact = findChild;\r\n                if (cData.children) {\r\n                    findChild_exact = cData.children;\r\n                }\r\n                //查找子元素并塞入\r\n                if (findChild_exact) {\r\n                    $.each(cData.data, function (j, children) {\r\n                        var child = scene.find(findChild_exact + "=" + children);\r\n                        if (child && child.length > 0) {\r\n                            $.each(child, function (m, one) {\r\n                                container.add(one);\r\n                            });\r\n                        } else {\r\n                            console.error("some child not found : " + j, findChild_exact + "=" + children);\r\n                        }\r\n                    });\r\n                } else {\r\n                    console.error("can\'t find children,need config children");\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nfunction createLink(scene, config) {\r\n    if (config) {\r\n        var path = config.path;\r\n        if ($.isArray(path) && path.length > 0) {\r\n            var findStart;\r\n            var findEnd;\r\n            //path为数组，0为起点条件1为终点条件,确定搜索条件,起始点条件可不同\r\n            if (path.length == 1) {\r\n                findEnd = path[0];\r\n                findStart = findEnd;\r\n            } else {\r\n                findStart = path[0];\r\n                findEnd = path[1];\r\n            }\r\n            if ($.isArray(config.data)) {\r\n                $.each(config.data, function (i, v) {\r\n                    var link;\r\n                    //根据确定的条件进行搜索\r\n                    var start = scene.find(findStart + "=" + v.start)[0];\r\n                    var end = scene.find(findEnd + "=" + v.end)[0];\r\n                    if (start && end) {\r\n                        v.start = start;\r\n                        v.end = end;\r\n                        link = scene.createLink(v);\r\n                        //额外属性添加\r\n                        if (link && $.isArray(config.exprop)) {\r\n                            $.each(config.exprop, function (j, key) {\r\n                                if(v[key]){\r\n                                    link[key] = v[key];\r\n                                }\r\n                            });\r\n                        }\r\n                    } else {\r\n                        console.error("some link path invalid : "+ i, v);\r\n                        if(!start){\r\n                            console.error("start not found : ",v.start);\r\n                        }\r\n                        if(!end){\r\n                            console.error("end not found : ",v.end);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            console.error("can not draw link,need config \'path\' and \'path\' is Array and not empty, path used to find start and end");\r\n        }\r\n    }\r\n}\r\nfunction drawAlarm(scene,config){\r\n    if(config){\r\n        if ($.isArray(config.data)&&config.node) {\r\n            var alarmData=config.data;\r\n            var findNode=config.node;\r\n            var alarmNodes=[];\r\n            $.each(alarmData,function(k,v){\r\n                var node=scene.find(findNode + "=" + v["node"],"node")[0];\r\n                if(node){\r\n                    alarmNodes.push({\r\n                        node:node,\r\n                        alarm:{\r\n                            show: typeof v.show=="undefined"?true: v.show,\r\n                            text: v.text,\r\n                            color: v.color,\r\n                            font: v.font\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            if(config.animate){\r\n                alarmAnimate(config.animate,alarmNodes);\r\n            }else{\r\n                console.info("alarm nodes : "+alarmNodes.length);\r\n                $.each(alarmNodes,function(i,v){\r\n                    v.node.set({\r\n                        alarm:v.alarm\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\nvar animateRuning;\r\nfunction alarmAnimate(animate,alarmNodes){\r\n    if(animate){\r\n        if($.isNumeric(animate.time)){\r\n            clearAnimat();\r\n            console.info("begin alarm animate times : "+alarmNodes.length);\r\n            animateRuning=setInterval(function(){\r\n                if(alarmNodes.length>0){\r\n                    var data=alarmNodes.pop();\r\n                    data.node.set({\r\n                        alarm:data.alarm\r\n                    });\r\n                    if($.isFunction(animate.callBack)){\r\n                        animate.callBack(data.node);\r\n                    }\r\n                }else{\r\n                    clearAnimat();\r\n                }\r\n            },parseInt(animate.time));\r\n        }\r\n    }\r\n}\r\nfunction clearAnimat(){\r\n    if(animateRuning){\r\n        console.info("end alarm animate");\r\n        clearInterval(animateRuning);\r\n        animateRuning="";\r\n    }\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL21haW4uanM/ZjkwOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0IseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjE2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzIvNi5cclxuICovXHJcbiAgICAvL+aguOW/g+S+nei1llxyXG5yZXF1aXJlKFwiLi9jb3JlL2p0b3BvL2p0b3BvLW1pbi5qc1wiKTtcclxuLy9RVG9wb1xyXG53aW5kb3cuUVRvcG8gPSB7fTtcclxud2luZG93LlFUb3BvLmluc3RhbmNlPVtdO1xyXG53aW5kb3cuUVRvcG8udXRpbCA9IHJlcXVpcmUoJy4vdXRpbC5qcycpO1xyXG52YXIgU2NlbmUgPSByZXF1aXJlKCcuL2NvcmUvU2NlbmUuanMnKTtcclxudmFyIHdpbmRvd3M9cmVxdWlyZShcIi4vY29tcG9uZW50L3dpbmRvd3MuanNcIik7XHJcbndpbmRvdy5RVG9wby5pbml0ID0gZnVuY3Rpb24gKGRvbSwgY29uZmlnKSB7XHJcbiAgICBkb20gPSBkb20gaW5zdGFuY2VvZiBBcnJheSA/IGRvbVswXSA6IGRvbTtcclxuICAgIHZhciBjYW52YXM9aW5pdENhbnZhcyhkb20sJChkb20pLndpZHRoKCksJChkb20pLmhlaWdodCgpKTtcclxuICAgIHZhciBRdG9wb0luc3RhbmNlID0ge1xyXG4gICAgICAgIHNjZW5lOm5ldyBTY2VuZShuZXcgSlRvcG8uU3RhZ2UoY2FudmFzKSxjb25maWcpLFxyXG4gICAgICAgIHNldE9wdGlvbiA6IHNldE9wdGlvbixcclxuICAgICAgICBkb2N1bWVudDpkb20sXHJcbiAgICAgICAgcmVzaXplOnJlc2l6ZShkb20sY2FudmFzKVxyXG4gICAgfTtcclxuICAgIHRoaXMuaW5zdGFuY2UucHVzaChRdG9wb0luc3RhbmNlKTtcclxuICAgIHJldHVybiBRdG9wb0luc3RhbmNlO1xyXG59O1xyXG5mdW5jdGlvbiBzZXRPcHRpb24ob3B0aW9uLGNsZWFyKSB7XHJcbiAgICB2YXIgc2NlbmUgPSB0aGlzLnNjZW5lO1xyXG4gICAgaWYoY2xlYXIpe1xyXG4gICAgICAgIHNjZW5lLmNsZWFyKCk7XHJcbiAgICB9XHJcbiAgICBjcmVhdGVOb2RlKHNjZW5lLCBvcHRpb24ubm9kZSk7XHJcbiAgICBjcmVhdGVDb250YWluZXIoc2NlbmUsIG9wdGlvbi5jb250YWluZXIpO1xyXG4gICAgY3JlYXRlTGluayhzY2VuZSwgb3B0aW9uLmxpbmspO1xyXG4gICAgZHJhd0FsYXJtKHNjZW5lLG9wdGlvbi5hbGFybSk7XHJcbiAgICBzY2VuZS5jZW50ZXIoKTtcclxufVxyXG5mdW5jdGlvbiByZXNpemUoZG9tLGNhbnZhcyl7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oKXtcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCd3aWR0aCcsICQoZG9tKS53aWR0aCgpKTtcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCQoZG9tKS5oZWlnaHQoKSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaW5pdENhbnZhcyhkb20sd2lkdGgsaGVpZ2h0KXtcclxuICAgIGlmKHdpZHRoPD0wfHxoZWlnaHQ8PTApe1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaGUgdG9wbyBuZWVkIGNvbmZpZyB3aWR0aCBhbmQgaGVpZ2h0IVwiKTtcclxuICAgIH1cclxuICAgIGRvbS5zdHlsZS5wb3NpdGlvbj0ncmVsYXRpdmUnO1xyXG4gICAgZG9tLnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nO1xyXG4gICAgdmFyIGNhbnZhcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgIGRvbS5hcHBlbmRDaGlsZChjYW52YXMpO1xyXG4gICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB3aWR0aCk7XHJcbiAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLGhlaWdodCk7XHJcbiAgICBjYW52YXMuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO1xyXG4gICAgY2FudmFzLnN0eWxlLnRvcD0wO1xyXG4gICAgY2FudmFzLnN0eWxlLmxlZnQ9MDtcclxuICAgIGNhbnZhcy5zdHlsZVsndXNlci1zZWxlY3QnXT0gJ25vbmUnO1xyXG4gICAgY2FudmFzLnN0eWxlWyctd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3InXT0gJ3JnYmEoMCwgMCwgMCwgMCknO1xyXG4gICAgcmV0dXJuIGNhbnZhcztcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVOb2RlKHNjZW5lLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGNvbmZpZy5kYXRhKSkge1xyXG4gICAgICAgICAgICAkLmVhY2goY29uZmlnLmRhdGEsIGZ1bmN0aW9uIChpLCB2KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHNjZW5lLmNyZWF0ZU5vZGUodik7XHJcbiAgICAgICAgICAgICAgICAvL+mineWkluWxnuaAp+a3u+WKoFxyXG4gICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShjb25maWcuZXhwcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChjb25maWcuZXhwcm9wLCBmdW5jdGlvbiAoaiwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCB2W2tleV0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVtrZXldID0gdltrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVDb250YWluZXIoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBmaW5kQ2hpbGQ7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICBmaW5kQ2hpbGQgPSBjb25maWcuY2hpbGRyZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgICAgIC8v5byA5aeL5p6E6YCg5YiG57uEXHJcbiAgICAgICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIGNEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAvL+aXoOiuuuaYr+WQpuacieWtkOWFg+e0oO+8jOWIhue7hOWFiOWIm+mAoOWHuuadpVxyXG4gICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHNjZW5lLmNyZWF0ZUNvbnRhaW5lcihjRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAvL+mineWkluWxnuaAp+a3u+WKoFxyXG4gICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShjb25maWcuZXhwcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChjb25maWcuZXhwcm9wLCBmdW5jdGlvbiAoaiwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNEYXRhW2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcltrZXldID0gY0RhdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy/noa7lrprmn6Xmib7lrZDlhYPntKDnmoTmoIforrBcclxuICAgICAgICAgICAgICAgIHZhciBmaW5kQ2hpbGRfZXhhY3QgPSBmaW5kQ2hpbGQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoY0RhdGEuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBmaW5kQ2hpbGRfZXhhY3QgPSBjRGF0YS5jaGlsZHJlbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8v5p+l5om+5a2Q5YWD57Sg5bm25aGe5YWlXHJcbiAgICAgICAgICAgICAgICBpZiAoZmluZENoaWxkX2V4YWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGNEYXRhLmRhdGEsIGZ1bmN0aW9uIChqLCBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBzY2VuZS5maW5kKGZpbmRDaGlsZF9leGFjdCArIFwiPVwiICsgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGQgJiYgY2hpbGQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGNoaWxkLCBmdW5jdGlvbiAobSwgb25lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmFkZChvbmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwic29tZSBjaGlsZCBub3QgZm91bmQgOiBcIiArIGosIGZpbmRDaGlsZF9leGFjdCArIFwiPVwiICsgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJjYW4ndCBmaW5kIGNoaWxkcmVuLG5lZWQgY29uZmlnIGNoaWxkcmVuXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlTGluayhzY2VuZSwgY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSBjb25maWcucGF0aDtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KHBhdGgpICYmIHBhdGgubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgZmluZFN0YXJ0O1xyXG4gICAgICAgICAgICB2YXIgZmluZEVuZDtcclxuICAgICAgICAgICAgLy9wYXRo5Li65pWw57uE77yMMOS4uui1t+eCueadoeS7tjHkuLrnu4jngrnmnaHku7Ys56Gu5a6a5pCc57Si5p2h5Lu2LOi1t+Wni+eCueadoeS7tuWPr+S4jeWQjFxyXG4gICAgICAgICAgICBpZiAocGF0aC5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgZmluZEVuZCA9IHBhdGhbMF07XHJcbiAgICAgICAgICAgICAgICBmaW5kU3RhcnQgPSBmaW5kRW5kO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmluZFN0YXJ0ID0gcGF0aFswXTtcclxuICAgICAgICAgICAgICAgIGZpbmRFbmQgPSBwYXRoWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2goY29uZmlnLmRhdGEsIGZ1bmN0aW9uIChpLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbms7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/moLnmja7noa7lrprnmoTmnaHku7bov5vooYzmkJzntKJcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBzY2VuZS5maW5kKGZpbmRTdGFydCArIFwiPVwiICsgdi5zdGFydClbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZCA9IHNjZW5lLmZpbmQoZmluZEVuZCArIFwiPVwiICsgdi5lbmQpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGFydCAmJiBlbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdi5zdGFydCA9IHN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LmVuZCA9IGVuZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGluayA9IHNjZW5lLmNyZWF0ZUxpbmsodik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rICYmICQuaXNBcnJheShjb25maWcuZXhwcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGNvbmZpZy5leHByb3AsIGZ1bmN0aW9uIChqLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih2W2tleV0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rW2tleV0gPSB2W2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwic29tZSBsaW5rIHBhdGggaW52YWxpZCA6IFwiKyBpLCB2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXN0YXJ0KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJzdGFydCBub3QgZm91bmQgOiBcIix2LnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighZW5kKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJlbmQgbm90IGZvdW5kIDogXCIsdi5lbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiY2FuIG5vdCBkcmF3IGxpbmssbmVlZCBjb25maWcgJ3BhdGgnIGFuZCAncGF0aCcgaXMgQXJyYXkgYW5kIG5vdCBlbXB0eSwgcGF0aCB1c2VkIHRvIGZpbmQgc3RhcnQgYW5kIGVuZFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZHJhd0FsYXJtKHNjZW5lLGNvbmZpZyl7XHJcbiAgICBpZihjb25maWcpe1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpJiZjb25maWcubm9kZSkge1xyXG4gICAgICAgICAgICB2YXIgYWxhcm1EYXRhPWNvbmZpZy5kYXRhO1xyXG4gICAgICAgICAgICB2YXIgZmluZE5vZGU9Y29uZmlnLm5vZGU7XHJcbiAgICAgICAgICAgIHZhciBhbGFybU5vZGVzPVtdO1xyXG4gICAgICAgICAgICAkLmVhY2goYWxhcm1EYXRhLGZ1bmN0aW9uKGssdil7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZT1zY2VuZS5maW5kKGZpbmROb2RlICsgXCI9XCIgKyB2W1wibm9kZVwiXSxcIm5vZGVcIilbMF07XHJcbiAgICAgICAgICAgICAgICBpZihub2RlKXtcclxuICAgICAgICAgICAgICAgICAgICBhbGFybU5vZGVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlOm5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHR5cGVvZiB2LnNob3c9PVwidW5kZWZpbmVkXCI/dHJ1ZTogdi5zaG93LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdi50ZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHYuY29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiB2LmZvbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYoY29uZmlnLmFuaW1hdGUpe1xyXG4gICAgICAgICAgICAgICAgYWxhcm1BbmltYXRlKGNvbmZpZy5hbmltYXRlLGFsYXJtTm9kZXMpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcImFsYXJtIG5vZGVzIDogXCIrYWxhcm1Ob2Rlcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGFsYXJtTm9kZXMsZnVuY3Rpb24oaSx2KXtcclxuICAgICAgICAgICAgICAgICAgICB2Lm5vZGUuc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxhcm06di5hbGFybVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxudmFyIGFuaW1hdGVSdW5pbmc7XHJcbmZ1bmN0aW9uIGFsYXJtQW5pbWF0ZShhbmltYXRlLGFsYXJtTm9kZXMpe1xyXG4gICAgaWYoYW5pbWF0ZSl7XHJcbiAgICAgICAgaWYoJC5pc051bWVyaWMoYW5pbWF0ZS50aW1lKSl7XHJcbiAgICAgICAgICAgIGNsZWFyQW5pbWF0KCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcImJlZ2luIGFsYXJtIGFuaW1hdGUgdGltZXMgOiBcIithbGFybU5vZGVzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGFuaW1hdGVSdW5pbmc9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmKGFsYXJtTm9kZXMubGVuZ3RoPjApe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhPWFsYXJtTm9kZXMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOmRhdGEuYWxhcm1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZigkLmlzRnVuY3Rpb24oYW5pbWF0ZS5jYWxsQmFjaykpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlLmNhbGxCYWNrKGRhdGEubm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJBbmltYXQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxwYXJzZUludChhbmltYXRlLnRpbWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY2xlYXJBbmltYXQoKXtcclxuICAgIGlmKGFuaW1hdGVSdW5pbmcpe1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbyhcImVuZCBhbGFybSBhbmltYXRlXCIpO1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwoYW5pbWF0ZVJ1bmluZyk7XHJcbiAgICAgICAgYW5pbWF0ZVJ1bmluZz1cIlwiO1xyXG4gICAgfVxyXG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL21haW4uanNcbi8vIG1vZHVsZSBpZCA9IDE2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=');
}]);