!function(g){function I(A){if(C[A])return C[A].exports;var n=C[A]={i:A,l:!1,exports:{}};return g[A].call(n.exports,n,n.exports,I),n.l=!0,n.exports}var C={};return I.m=g,I.c=C,I.i=function(g){return g},I.d=function(g,C,A){I.o(g,C)||Object.defineProperty(g,C,{configurable:!1,enumerable:!0,get:A})},I.n=function(g){var C=g&&g.__esModule?function(){return g.default}:function(){return g};return I.d(C,"a",C),C},I.o=function(g,I){return Object.prototype.hasOwnProperty.call(g,I)},I.p="",I(I.s=86)}([,function(module,exports){eval('/**\r\n * @module core\r\n */\r\nmodule.exports = Element;\r\n/**\r\n * 元素基类,用以继承\r\n * @class [E] Element\r\n * @constructor\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nfunction Element(jtopo) {\r\n    if (jtopo) {\r\n        /**\r\n         * 核心Jtopo对象\r\n         * @property [E] jtopo {Object}\r\n         */\r\n        this.jtopo = jtopo;\r\n        jtopo.qtopo = this;\r\n    }\r\n    if (!this.attr.jsonId) {\r\n        this.attr.jsonId = QTopo.util.makeId();\r\n    }\r\n    /**\r\n     * 预定义的额外属性,参考实际元素\r\n     * @property [E] extra {object}\r\n     */\r\n    this.extra = {};\r\n    /**\r\n     * 预定义的基本属性，参考实际元素\r\n     * @property [E] attr {object}\r\n     */\r\n}\r\n/**\r\n *  设置jsonId\r\n *  @method [E] setJsonId\r\n *  @param id {string} id\r\n */\r\nElement.prototype.setJsonId = function (id) {\r\n    this.attr.jsonId = id;\r\n};\r\n/**\r\n *  显示元素\r\n *  @method [E] show\r\n */\r\nElement.prototype.show = function () {\r\n    switch (this.getType()) {\r\n        case QTopo.constant.NODE:\r\n            toggleNode.call(this, true);\r\n            break;\r\n        case QTopo.constant.CONTAINER:\r\n            toggleContainer.call(this, true);\r\n            break;\r\n        case QTopo.constant.LINK:\r\n            toggleLink.call(this, true);\r\n    }\r\n};\r\n/**\r\n *  隐藏元素\r\n *  @method [E] hide\r\n */\r\nElement.prototype.hide = function () {\r\n    switch (this.getType()) {\r\n        case QTopo.constant.NODE:\r\n            toggleNode.call(this, false);\r\n            break;\r\n        case QTopo.constant.CONTAINER:\r\n            toggleContainer.call(this, false);\r\n            break;\r\n        case QTopo.constant.LINK:\r\n            toggleLink.call(this, false);\r\n    }\r\n};\r\n/**\r\n *  设置使用类型\r\n *  @method [E] setUseType\r\n *  @param type {string}\r\n */\r\nElement.prototype.setUseType = function (type) {\r\n    this.attr.useType = type;\r\n};\r\n/**\r\n *  获取使用类型\r\n *  @method [E] getUseType\r\n *  @return {string}\r\n */\r\nElement.prototype.getUseType = function () {\r\n    return this.attr.useType;\r\n};\r\n/**\r\n *  设置元素文本\r\n *  @method [E] setText\r\n *  @param text {string}\r\n */\r\nElement.prototype.setText = function (text) {\r\n    if (text) {\r\n        this.jtopo.text = (text + "").trim();\r\n    }\r\n    this.attr.text = this.jtopo.text;\r\n};\r\n/**\r\n *  设置元素边框\r\n *  @method [E] setBorder\r\n *  @param border {object}\r\n *  color:颜色,width:宽度,radius:角弧度\r\n */\r\nElement.prototype.setBorder = function (border) {\r\n    var jtopo = this.jtopo;\r\n    if (border.color) {\r\n        jtopo.borderColor = QTopo.util.transHex(border.color.toLowerCase());\r\n    }\r\n    if ($.isNumeric(border.width)) {\r\n        jtopo.borderWidth = parseInt(border.width);\r\n    }\r\n    if ($.isNumeric(border.radius)) {\r\n        jtopo.borderRadius = parseInt(border.radius);\r\n    }\r\n    this.attr.border.color = jtopo.borderColor;\r\n    this.attr.border.width = jtopo.borderWidth;\r\n    this.attr.border.radius = jtopo.borderRadius;\r\n};\r\n/**\r\n *  绑定事件,可用off删除对应事件\r\n *  @method [E] on\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param fn {function} 处理函数\r\n */\r\nElement.prototype.on = function (name, fn) {\r\n    this.jtopo.addEventListener(name, function (e) {\r\n        if (e.target && e.target.qtopo) {\r\n            fn(e, e.target.qtopo);\r\n        } else {\r\n            fn(e);\r\n        }\r\n    });\r\n};\r\n/**\r\n *  解除事件，可删除on绑定的事件\r\n *  @method [E] off\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *   @param [fn]{function} 处理的函数对象，若无参则删除该事件下所有函数\r\n */\r\nElement.prototype.off = function (name, fn) {\r\n    this.jtopo.removeEventListener(name);\r\n};\r\n/**\r\n *  设置元素层级\r\n *  @method [E] setZIndex\r\n *  @param zIndex {number} 值高的元素覆盖在值低的元素上,默认节点>链接>分组\r\n */\r\nElement.prototype.setZIndex = function (zIndex) {\r\n    if ($.isNumeric(zIndex)) {\r\n        this.jtopo.zIndex = parseInt(zIndex);\r\n    }\r\n    this.attr.zIndex = this.jtopo.zIndex;\r\n};\r\n/**\r\n *  设置元素字体\r\n *  @method [E] setFont\r\n *  @param font {object}\r\n *\r\n *  type:字体,\r\n *  color:颜色,\r\n *  size:大小\r\n */\r\nElement.prototype.setFont = function (font) {\r\n    var type = this.attr.font.type;\r\n    var size = this.attr.font.size;\r\n    if (font) {\r\n        if ($.isNumeric(font.size)) {\r\n            size = font.size;\r\n        }\r\n        if (font.type) {\r\n            type = font.type;\r\n        }\r\n        this.jtopo.font = (size ? size : 14) + "px " + type;\r\n        if (font.color) {\r\n            this.jtopo.fontColor = QTopo.util.transHex(font.color.toLowerCase());\r\n        }\r\n    }\r\n    this.attr.font.type = type;\r\n    this.attr.font.size = size;\r\n    this.attr.font.color = this.jtopo.fontColor;\r\n};\r\n/**\r\n *  设置元素透明度\r\n *  @method [E] setAlpha\r\n *  @param alpha {number} 值域0-1\r\n */\r\nElement.prototype.setAlpha = function (alpha) {\r\n    if ($.isNumeric(alpha) && alpha <= 1 && alpha > 0) {\r\n        this.jtopo.alpha = alpha;\r\n    } else {\r\n        this.jtopo.alpha = 1;\r\n    }\r\n    this.attr.alpha = this.jtopo.alpha;\r\n};\r\n/**\r\n *  设置元素位置\r\n *  @method [E] setPosition\r\n *  @param position {array} [x,y]在图层上的坐标\r\n */\r\nElement.prototype.setPosition = function (position) {\r\n    if ($.isArray(position) && position.length >= 2) {\r\n        if ($.isNumeric(position[0]) && $.isNumeric(position[1])) {\r\n            this.jtopo.setLocation(parseInt(position[0]), parseInt(position[1]));\r\n        }\r\n    }\r\n};\r\n/**\r\n *  设置元素大小\r\n *  @method [E] setSize\r\n *  @param size {array} [width,height]\r\n */\r\nElement.prototype.setSize = function (size) {\r\n    if ($.isArray(size) && $.isNumeric(size[0]) && $.isNumeric(size[1])) {\r\n        this.jtopo.setSize(parseInt(size[0]), parseInt(size[1]));\r\n    } else {\r\n        this.jtopo.setSize(64, 64);\r\n    }\r\n    this.attr.size = [this.jtopo.width, this.jtopo.height];\r\n};\r\n/**\r\n *  元素是否锁定位置\r\n *  @method [E] setDraggable\r\n *  @param draggable {boolean}\r\n */\r\nElement.prototype.setDraggable = function (draggable) {\r\n    if (typeof draggable == \'boolean\') {\r\n        this.jtopo.draggable = draggable;\r\n    }\r\n    this.attr.draggable = this.jtopo.draggable;\r\n};\r\n/**\r\n *  设置元素文字位置\r\n *  @method [E] setNamePosition\r\n *  @param [namePosition] {string} 无参则设为bottom\r\n *\r\n *  hide,bottom,top,left,right,center\r\n *\r\n */\r\nElement.prototype.setNamePosition = function (namePosition) {\r\n    var jtopo = this.jtopo;\r\n    jtopo.text = this.attr.name || "";\r\n    jtopo.textOffsetX = 0;\r\n    jtopo.textOffsetY = 0;\r\n    switch (namePosition) {\r\n        case \'hide\':\r\n            jtopo.text = \'\';\r\n            this.attr.namePosition = "hide";\r\n            break;\r\n        case \'bottom\':\r\n            jtopo.textPosition = "Bottom_Center";\r\n            this.attr.namePosition = "bottom";\r\n            break;\r\n        case \'top\':\r\n            jtopo.textPosition = "Top_Center";\r\n            this.attr.namePosition = "top";\r\n            break;\r\n        case \'left\':\r\n            jtopo.textPosition = "Middle_Left";\r\n            this.attr.namePosition = "left";\r\n            break;\r\n        case \'right\':\r\n            jtopo.textPosition = "Middle_Right";\r\n            this.attr.namePosition = "right";\r\n            break;\r\n        case "center":\r\n            jtopo.textPosition = "Middle_Center";\r\n            this.attr.namePosition = "center";\r\n            break;\r\n        default:\r\n            jtopo.textPosition = \'Bottom_Center\';\r\n            this.attr.namePosition = "bottom";\r\n            QTopo.util.error(this, "set wrong namePosition,default is bottom");\r\n            break;\r\n    }\r\n};\r\n/**\r\n *  私有函数,设置元素属性,只要有对应函数则传入参数设置,不应直接调用\r\n *\r\n *  实际元素中应重写set函数，在set函数中对特殊参数做处理后再调用该函数\r\n *  @method [E] _setAttr\r\n *  @param config {object}\r\n */\r\nElement.prototype._setAttr = function (config) {\r\n    var self = this;\r\n    $.each(config, function (k, v) {\r\n        try {\r\n            var fn = self[\'set\' + QTopo.util.upFirst(k)];\r\n            if (fn) {\r\n                fn.call(self, v);\r\n            }\r\n        } catch (e) {\r\n            QTopo.util.error(self, "Element _setAttr error :" + k, e);\r\n        }\r\n    });\r\n};\r\n/**\r\n * 获取元素基本属性\r\n *  @method [E] get\r\n *  @param name {string} 属性名\r\n *  @example\r\n *          Element.setPosition([100,100])\r\n *          Element.get(\'position\')       //[100,100]\r\n */\r\nElement.prototype.get = function (name) {\r\n    return this.attr[name];\r\n};\r\n/**\r\n * 获取元素的属性,修改/赋值元素额外属性\r\n *  @method [E] val\r\n *  @param key {string} 属性名\r\n *\r\n *  要操作的属性名,与get不同，该函数会在整个对象中查找与key匹配的属性\r\n *\r\n *  无论是额外属性还是基本属性又或是Element.xx属性，只要匹配成功即返回.\r\n *\r\n *  优先级为 额外属性>基本属性>Element.xx属性\r\n *\r\n *  用该函数赋予额外属性时，可以直接传入一个对象作为参数\r\n *\r\n *  该函数会遍历该参数对象将其内容全部覆盖到额外属性上\r\n *\r\n *  @param [value] {string|object|void} 值,无参则为取值\r\n *  @example\r\n *\r\n *       赋值操作   1. Element.val(\'pid\',\'12345\')\r\n *                  2. Element.val({\r\n *                          pid:"12345",\r\n *                          path:[]\r\n *                      })\r\n *       取属性操作 Element.val(\'pid\')       //"12345"\r\n *                  Element.val(\'position\') //[x,y]\r\n *                  Element.val(\'path\')       //[]\r\n *                  Element.val(\'name\')       //""\r\n */\r\nElement.prototype.val = function (key, value) {\r\n    if (QTopo.util.getClass(key) == \'Object\') {\r\n        var self = this;\r\n        $.each(key, function (name, value) {\r\n            self.extra[name] = value;\r\n        })\r\n    } else {\r\n        if (typeof value == \'undefined\') {\r\n            var result;\r\n            if (this.extra[key]) {\r\n                result = this.extra[key];\r\n            } else if (this.attr[key]) {\r\n                result = this.attr[key];\r\n            } else {\r\n                result = this[key];\r\n            }\r\n            return result;\r\n        } else {\r\n            this.extra[key] = value;\r\n        }\r\n    }\r\n};\r\n/*\r\n * 对象links属性内的所有线进行切换\r\n * @links node/container的links属性\r\n * @fnName \'show\'/\'hide\'方法名\r\n */\r\nfunction toggle(links, fnName) {\r\n    try {\r\n        $.each(links, function (name, arr) {\r\n            arr.forEach(function (item) {\r\n                item[fnName]();\r\n            });\r\n        })\r\n    } catch (e) {\r\n        QTopo.util.error("切换隐藏/显示时错误", e);\r\n    }\r\n}\r\n//线的显示只有当其两端节点都显示时才显示\r\nfunction toggleLink(flag) {\r\n    if (flag) {\r\n        if (this.path.start.jtopo && this.path.end.jtopo) {\r\n            if (this.path.start.jtopo.visible && this.path.end.jtopo.visible) {\r\n                this.jtopo.visible = true;\r\n            }\r\n        }\r\n    } else {\r\n        this.jtopo.visible = false;\r\n    }\r\n}\r\nfunction toggleNode(flag) {\r\n    this.jtopo.visible = flag;\r\n    var string = flag ? "show" : "hide";\r\n    toggle(this.links, string);\r\n}\r\nfunction toggleContainer(flag) {\r\n    this.jtopo.visible = flag;\r\n    var string = flag ? "show" : "hide";\r\n    //切换子类显示隐藏\r\n    for (var i = 0; i < this.children.length; i++) {\r\n        this.children[i][string]();\r\n    }\r\n    toggle(this.links, string);\r\n}\r\n/**\r\n * 获取元素中心坐标\r\n *  @method [E] getCenterPosition\r\n *  @return {object} {x,y}\r\n */\r\nElement.prototype.getCenterPosition = function () {\r\n    return {\r\n        x: this.jtopo.cx,\r\n        y: this.jtopo.cy\r\n    }\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9FbGVtZW50LmpzPzg1ZDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLE1BQU07QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixNQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLE9BQU87QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixPQUFPO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUJBQW1CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwwQkFBMEI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU8sRUFBRTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxubW9kdWxlLmV4cG9ydHMgPSBFbGVtZW50O1xyXG4vKipcclxuICog5YWD57Sg5Z+657G7LOeUqOS7pee7p+aJv1xyXG4gKiBAY2xhc3MgW0VdIEVsZW1lbnRcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSBqdG9wbyDlhYPntKDmoLjlv4PnmoRqdG9wb+WvueixoVxyXG4gKi9cclxuZnVuY3Rpb24gRWxlbWVudChqdG9wbykge1xyXG4gICAgaWYgKGp0b3BvKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5qC45b+DSnRvcG/lr7nosaFcclxuICAgICAgICAgKiBAcHJvcGVydHkgW0VdIGp0b3BvIHtPYmplY3R9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5qdG9wbyA9IGp0b3BvO1xyXG4gICAgICAgIGp0b3BvLnF0b3BvID0gdGhpcztcclxuICAgIH1cclxuICAgIGlmICghdGhpcy5hdHRyLmpzb25JZCkge1xyXG4gICAgICAgIHRoaXMuYXR0ci5qc29uSWQgPSBRVG9wby51dGlsLm1ha2VJZCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDpooTlrprkuYnnmoTpop3lpJblsZ7mgKcs5Y+C6ICD5a6e6ZmF5YWD57SgXHJcbiAgICAgKiBAcHJvcGVydHkgW0VdIGV4dHJhIHtvYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHRoaXMuZXh0cmEgPSB7fTtcclxuICAgIC8qKlxyXG4gICAgICog6aKE5a6a5LmJ55qE5Z+65pys5bGe5oCn77yM5Y+C6ICD5a6e6ZmF5YWD57SgXHJcbiAgICAgKiBAcHJvcGVydHkgW0VdIGF0dHIge29iamVjdH1cclxuICAgICAqL1xyXG59XHJcbi8qKlxyXG4gKiAg6K6+572uanNvbklkXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRKc29uSWRcclxuICogIEBwYXJhbSBpZCB7c3RyaW5nfSBpZFxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0SnNvbklkID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICB0aGlzLmF0dHIuanNvbklkID0gaWQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg5pi+56S65YWD57SgXHJcbiAqICBAbWV0aG9kIFtFXSBzaG93XHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc3dpdGNoICh0aGlzLmdldFR5cGUoKSkge1xyXG4gICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuTk9ERTpcclxuICAgICAgICAgICAgdG9nZ2xlTm9kZS5jYWxsKHRoaXMsIHRydWUpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFFUb3BvLmNvbnN0YW50LkNPTlRBSU5FUjpcclxuICAgICAgICAgICAgdG9nZ2xlQ29udGFpbmVyLmNhbGwodGhpcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuTElOSzpcclxuICAgICAgICAgICAgdG9nZ2xlTGluay5jYWxsKHRoaXMsIHRydWUpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOmakOiXj+WFg+e0oFxyXG4gKiAgQG1ldGhvZCBbRV0gaGlkZVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHN3aXRjaCAodGhpcy5nZXRUeXBlKCkpIHtcclxuICAgICAgICBjYXNlIFFUb3BvLmNvbnN0YW50Lk5PREU6XHJcbiAgICAgICAgICAgIHRvZ2dsZU5vZGUuY2FsbCh0aGlzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSOlxyXG4gICAgICAgICAgICB0b2dnbGVDb250YWluZXIuY2FsbCh0aGlzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuTElOSzpcclxuICAgICAgICAgICAgdG9nZ2xlTGluay5jYWxsKHRoaXMsIGZhbHNlKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDorr7nva7kvb/nlKjnsbvlnotcclxuICogIEBtZXRob2QgW0VdIHNldFVzZVR5cGVcclxuICogIEBwYXJhbSB0eXBlIHtzdHJpbmd9XHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5zZXRVc2VUeXBlID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgIHRoaXMuYXR0ci51c2VUeXBlID0gdHlwZTtcclxufTtcclxuLyoqXHJcbiAqICDojrflj5bkvb/nlKjnsbvlnotcclxuICogIEBtZXRob2QgW0VdIGdldFVzZVR5cGVcclxuICogIEByZXR1cm4ge3N0cmluZ31cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLmdldFVzZVR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5hdHRyLnVzZVR5cGU7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg5paH5pysXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRUZXh0XHJcbiAqICBAcGFyYW0gdGV4dCB7c3RyaW5nfVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0VGV4dCA9IGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICBpZiAodGV4dCkge1xyXG4gICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICh0ZXh0ICsgXCJcIikudHJpbSgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLnRleHQgPSB0aGlzLmp0b3BvLnRleHQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg6L655qGGXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRCb3JkZXJcclxuICogIEBwYXJhbSBib3JkZXIge29iamVjdH1cclxuICogIGNvbG9yOuminOiJsix3aWR0aDrlrr3luqYscmFkaXVzOuinkuW8p+W6plxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0Qm9yZGVyID0gZnVuY3Rpb24gKGJvcmRlcikge1xyXG4gICAgdmFyIGp0b3BvID0gdGhpcy5qdG9wbztcclxuICAgIGlmIChib3JkZXIuY29sb3IpIHtcclxuICAgICAgICBqdG9wby5ib3JkZXJDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoYm9yZGVyLmNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgfVxyXG4gICAgaWYgKCQuaXNOdW1lcmljKGJvcmRlci53aWR0aCkpIHtcclxuICAgICAgICBqdG9wby5ib3JkZXJXaWR0aCA9IHBhcnNlSW50KGJvcmRlci53aWR0aCk7XHJcbiAgICB9XHJcbiAgICBpZiAoJC5pc051bWVyaWMoYm9yZGVyLnJhZGl1cykpIHtcclxuICAgICAgICBqdG9wby5ib3JkZXJSYWRpdXMgPSBwYXJzZUludChib3JkZXIucmFkaXVzKTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5ib3JkZXIuY29sb3IgPSBqdG9wby5ib3JkZXJDb2xvcjtcclxuICAgIHRoaXMuYXR0ci5ib3JkZXIud2lkdGggPSBqdG9wby5ib3JkZXJXaWR0aDtcclxuICAgIHRoaXMuYXR0ci5ib3JkZXIucmFkaXVzID0ganRvcG8uYm9yZGVyUmFkaXVzO1xyXG59O1xyXG4vKipcclxuICogIOe7keWumuS6i+S7tizlj6/nlKhvZmbliKDpmaTlr7nlupTkuovku7ZcclxuICogIEBtZXRob2QgW0VdIG9uXHJcbiAqICBAcGFyYW0gbmFtZSB7c3RyaW5nfSDkuovku7blkI1cclxuICpcclxuICogIGNsaWNrLGRiY2xpY2ssbW91c2Vkb3duLG1vdXNldXAsbW91c2VvdmVyLG1vdXNlb3V0LG1vdXNlbW92ZSxtb3VzZWRyYWcsbW91c2V3aGVlbCx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZCxrZXlkb3duLGtleXVwXHJcbiAqXHJcbiAqICBAcGFyYW0gZm4ge2Z1bmN0aW9ufSDlpITnkIblh73mlbBcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKG5hbWUsIGZuKSB7XHJcbiAgICB0aGlzLmp0b3BvLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQucXRvcG8pIHtcclxuICAgICAgICAgICAgZm4oZSwgZS50YXJnZXQucXRvcG8pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZuKGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG4vKipcclxuICogIOino+mZpOS6i+S7tu+8jOWPr+WIoOmZpG9u57uR5a6a55qE5LqL5Lu2XHJcbiAqICBAbWV0aG9kIFtFXSBvZmZcclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9IOS6i+S7tuWQjVxyXG4gKlxyXG4gKiAgY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcclxuICpcclxuICogICBAcGFyYW0gW2ZuXXtmdW5jdGlvbn0g5aSE55CG55qE5Ye95pWw5a+56LGh77yM6Iul5peg5Y+C5YiZ5Yig6Zmk6K+l5LqL5Lu25LiL5omA5pyJ5Ye95pWwXHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgIHRoaXMuanRvcG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lKTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDlsYLnuqdcclxuICogIEBtZXRob2QgW0VdIHNldFpJbmRleFxyXG4gKiAgQHBhcmFtIHpJbmRleCB7bnVtYmVyfSDlgLzpq5jnmoTlhYPntKDopobnm5blnKjlgLzkvY7nmoTlhYPntKDkuIos6buY6K6k6IqC54K5PumTvuaOpT7liIbnu4RcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldFpJbmRleCA9IGZ1bmN0aW9uICh6SW5kZXgpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyh6SW5kZXgpKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby56SW5kZXggPSBwYXJzZUludCh6SW5kZXgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLnpJbmRleCA9IHRoaXMuanRvcG8uekluZGV4O1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWFg+e0oOWtl+S9k1xyXG4gKiAgQG1ldGhvZCBbRV0gc2V0Rm9udFxyXG4gKiAgQHBhcmFtIGZvbnQge29iamVjdH1cclxuICpcclxuICogIHR5cGU65a2X5L2TLFxyXG4gKiAgY29sb3I66aKc6ImyLFxyXG4gKiAgc2l6ZTrlpKflsI9cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldEZvbnQgPSBmdW5jdGlvbiAoZm9udCkge1xyXG4gICAgdmFyIHR5cGUgPSB0aGlzLmF0dHIuZm9udC50eXBlO1xyXG4gICAgdmFyIHNpemUgPSB0aGlzLmF0dHIuZm9udC5zaXplO1xyXG4gICAgaWYgKGZvbnQpIHtcclxuICAgICAgICBpZiAoJC5pc051bWVyaWMoZm9udC5zaXplKSkge1xyXG4gICAgICAgICAgICBzaXplID0gZm9udC5zaXplO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZm9udC50eXBlKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSBmb250LnR5cGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuanRvcG8uZm9udCA9IChzaXplID8gc2l6ZSA6IDE0KSArIFwicHggXCIgKyB0eXBlO1xyXG4gICAgICAgIGlmIChmb250LmNvbG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uZm9udENvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChmb250LmNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5mb250LnR5cGUgPSB0eXBlO1xyXG4gICAgdGhpcy5hdHRyLmZvbnQuc2l6ZSA9IHNpemU7XHJcbiAgICB0aGlzLmF0dHIuZm9udC5jb2xvciA9IHRoaXMuanRvcG8uZm9udENvbG9yO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWFg+e0oOmAj+aYjuW6plxyXG4gKiAgQG1ldGhvZCBbRV0gc2V0QWxwaGFcclxuICogIEBwYXJhbSBhbHBoYSB7bnVtYmVyfSDlgLzln58wLTFcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldEFscGhhID0gZnVuY3Rpb24gKGFscGhhKSB7XHJcbiAgICBpZiAoJC5pc051bWVyaWMoYWxwaGEpICYmIGFscGhhIDw9IDEgJiYgYWxwaGEgPiAwKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5hbHBoYSA9IGFscGhhO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmFscGhhID0gMTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5hbHBoYSA9IHRoaXMuanRvcG8uYWxwaGE7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg5L2N572uXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRQb3NpdGlvblxyXG4gKiAgQHBhcmFtIHBvc2l0aW9uIHthcnJheX0gW3gseV3lnKjlm77lsYLkuIrnmoTlnZDmoIdcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XHJcbiAgICBpZiAoJC5pc0FycmF5KHBvc2l0aW9uKSAmJiBwb3NpdGlvbi5sZW5ndGggPj0gMikge1xyXG4gICAgICAgIGlmICgkLmlzTnVtZXJpYyhwb3NpdGlvblswXSkgJiYgJC5pc051bWVyaWMocG9zaXRpb25bMV0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uc2V0TG9jYXRpb24ocGFyc2VJbnQocG9zaXRpb25bMF0pLCBwYXJzZUludChwb3NpdGlvblsxXSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDlpKflsI9cclxuICogIEBtZXRob2QgW0VdIHNldFNpemVcclxuICogIEBwYXJhbSBzaXplIHthcnJheX0gW3dpZHRoLGhlaWdodF1cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldFNpemUgPSBmdW5jdGlvbiAoc2l6ZSkge1xyXG4gICAgaWYgKCQuaXNBcnJheShzaXplKSAmJiAkLmlzTnVtZXJpYyhzaXplWzBdKSAmJiAkLmlzTnVtZXJpYyhzaXplWzFdKSkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc2V0U2l6ZShwYXJzZUludChzaXplWzBdKSwgcGFyc2VJbnQoc2l6ZVsxXSkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnNldFNpemUoNjQsIDY0KTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5zaXplID0gW3RoaXMuanRvcG8ud2lkdGgsIHRoaXMuanRvcG8uaGVpZ2h0XTtcclxufTtcclxuLyoqXHJcbiAqICDlhYPntKDmmK/lkKbplIHlrprkvY3nva5cclxuICogIEBtZXRob2QgW0VdIHNldERyYWdnYWJsZVxyXG4gKiAgQHBhcmFtIGRyYWdnYWJsZSB7Ym9vbGVhbn1cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldERyYWdnYWJsZSA9IGZ1bmN0aW9uIChkcmFnZ2FibGUpIHtcclxuICAgIGlmICh0eXBlb2YgZHJhZ2dhYmxlID09ICdib29sZWFuJykge1xyXG4gICAgICAgIHRoaXMuanRvcG8uZHJhZ2dhYmxlID0gZHJhZ2dhYmxlO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmRyYWdnYWJsZSA9IHRoaXMuanRvcG8uZHJhZ2dhYmxlO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWFg+e0oOaWh+Wtl+S9jee9rlxyXG4gKiAgQG1ldGhvZCBbRV0gc2V0TmFtZVBvc2l0aW9uXHJcbiAqICBAcGFyYW0gW25hbWVQb3NpdGlvbl0ge3N0cmluZ30g5peg5Y+C5YiZ6K6+5Li6Ym90dG9tXHJcbiAqXHJcbiAqICBoaWRlLGJvdHRvbSx0b3AsbGVmdCxyaWdodCxjZW50ZXJcclxuICpcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldE5hbWVQb3NpdGlvbiA9IGZ1bmN0aW9uIChuYW1lUG9zaXRpb24pIHtcclxuICAgIHZhciBqdG9wbyA9IHRoaXMuanRvcG87XHJcbiAgICBqdG9wby50ZXh0ID0gdGhpcy5hdHRyLm5hbWUgfHwgXCJcIjtcclxuICAgIGp0b3BvLnRleHRPZmZzZXRYID0gMDtcclxuICAgIGp0b3BvLnRleHRPZmZzZXRZID0gMDtcclxuICAgIHN3aXRjaCAobmFtZVBvc2l0aW9uKSB7XHJcbiAgICAgICAgY2FzZSAnaGlkZSc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHQgPSAnJztcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwiaGlkZVwiO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIkJvdHRvbV9DZW50ZXJcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwiYm90dG9tXCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiVG9wX0NlbnRlclwiO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIubmFtZVBvc2l0aW9uID0gXCJ0b3BcIjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiTWlkZGxlX0xlZnRcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwibGVmdFwiO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiTWlkZGxlX1JpZ2h0XCI7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5uYW1lUG9zaXRpb24gPSBcInJpZ2h0XCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJjZW50ZXJcIjpcclxuICAgICAgICAgICAganRvcG8udGV4dFBvc2l0aW9uID0gXCJNaWRkbGVfQ2VudGVyXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5uYW1lUG9zaXRpb24gPSBcImNlbnRlclwiO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSAnQm90dG9tX0NlbnRlcic7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5uYW1lUG9zaXRpb24gPSBcImJvdHRvbVwiO1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKHRoaXMsIFwic2V0IHdyb25nIG5hbWVQb3NpdGlvbixkZWZhdWx0IGlzIGJvdHRvbVwiKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg56eB5pyJ5Ye95pWwLOiuvue9ruWFg+e0oOWxnuaApyzlj6ropoHmnInlr7nlupTlh73mlbDliJnkvKDlhaXlj4LmlbDorr7nva4s5LiN5bqU55u05o6l6LCD55SoXHJcbiAqXHJcbiAqICDlrp7pmYXlhYPntKDkuK3lupTph43lhplzZXTlh73mlbDvvIzlnKhzZXTlh73mlbDkuK3lr7nnibnmrorlj4LmlbDlgZrlpITnkIblkI7lho3osIPnlKjor6Xlh73mlbBcclxuICogIEBtZXRob2QgW0VdIF9zZXRBdHRyXHJcbiAqICBAcGFyYW0gY29uZmlnIHtvYmplY3R9XHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5fc2V0QXR0ciA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICQuZWFjaChjb25maWcsIGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIGZuID0gc2VsZlsnc2V0JyArIFFUb3BvLnV0aWwudXBGaXJzdChrKV07XHJcbiAgICAgICAgICAgIGlmIChmbikge1xyXG4gICAgICAgICAgICAgICAgZm4uY2FsbChzZWxmLCB2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihzZWxmLCBcIkVsZW1lbnQgX3NldEF0dHIgZXJyb3IgOlwiICsgaywgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDln7rmnKzlsZ7mgKdcclxuICogIEBtZXRob2QgW0VdIGdldFxyXG4gKiAgQHBhcmFtIG5hbWUge3N0cmluZ30g5bGe5oCn5ZCNXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICBFbGVtZW50LnNldFBvc2l0aW9uKFsxMDAsMTAwXSlcclxuICogICAgICAgICAgRWxlbWVudC5nZXQoJ3Bvc2l0aW9uJykgICAgICAgLy9bMTAwLDEwMF1cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICByZXR1cm4gdGhpcy5hdHRyW25hbWVdO1xyXG59O1xyXG4vKipcclxuICog6I635Y+W5YWD57Sg55qE5bGe5oCnLOS/ruaUuS/otYvlgLzlhYPntKDpop3lpJblsZ7mgKdcclxuICogIEBtZXRob2QgW0VdIHZhbFxyXG4gKiAgQHBhcmFtIGtleSB7c3RyaW5nfSDlsZ7mgKflkI1cclxuICpcclxuICogIOimgeaTjeS9nOeahOWxnuaAp+WQjSzkuI5nZXTkuI3lkIzvvIzor6Xlh73mlbDkvJrlnKjmlbTkuKrlr7nosaHkuK3mn6Xmib7kuI5rZXnljLnphY3nmoTlsZ7mgKdcclxuICpcclxuICogIOaXoOiuuuaYr+mineWkluWxnuaAp+i/mOaYr+WfuuacrOWxnuaAp+WPiOaIluaYr0VsZW1lbnQueHjlsZ7mgKfvvIzlj6ropoHljLnphY3miJDlip/ljbPov5Tlm54uXHJcbiAqXHJcbiAqICDkvJjlhYjnuqfkuLog6aKd5aSW5bGe5oCnPuWfuuacrOWxnuaApz5FbGVtZW50Lnh45bGe5oCnXHJcbiAqXHJcbiAqICDnlKjor6Xlh73mlbDotYvkuojpop3lpJblsZ7mgKfml7bvvIzlj6/ku6Xnm7TmjqXkvKDlhaXkuIDkuKrlr7nosaHkvZzkuLrlj4LmlbBcclxuICpcclxuICogIOivpeWHveaVsOS8mumBjeWOhuivpeWPguaVsOWvueixoeWwhuWFtuWGheWuueWFqOmDqOimhuebluWIsOmineWkluWxnuaAp+S4ilxyXG4gKlxyXG4gKiAgQHBhcmFtIFt2YWx1ZV0ge3N0cmluZ3xvYmplY3R8dm9pZH0g5YC8LOaXoOWPguWImeS4uuWPluWAvFxyXG4gKiAgQGV4YW1wbGVcclxuICpcclxuICogICAgICAg6LWL5YC85pON5L2cICAgMS4gRWxlbWVudC52YWwoJ3BpZCcsJzEyMzQ1JylcclxuICogICAgICAgICAgICAgICAgICAyLiBFbGVtZW50LnZhbCh7XHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBwaWQ6XCIxMjM0NVwiLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDpbXVxyXG4gKiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gKiAgICAgICDlj5blsZ7mgKfmk43kvZwgRWxlbWVudC52YWwoJ3BpZCcpICAgICAgIC8vXCIxMjM0NVwiXHJcbiAqICAgICAgICAgICAgICAgICAgRWxlbWVudC52YWwoJ3Bvc2l0aW9uJykgLy9beCx5XVxyXG4gKiAgICAgICAgICAgICAgICAgIEVsZW1lbnQudmFsKCdwYXRoJykgICAgICAgLy9bXVxyXG4gKiAgICAgICAgICAgICAgICAgIEVsZW1lbnQudmFsKCduYW1lJykgICAgICAgLy9cIlwiXHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS52YWwgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgaWYgKFFUb3BvLnV0aWwuZ2V0Q2xhc3Moa2V5KSA9PSAnT2JqZWN0Jykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkLmVhY2goa2V5LCBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgc2VsZi5leHRyYVtuYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgIH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZXh0cmFba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5leHRyYVtrZXldO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXR0cltrZXldKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmF0dHJba2V5XTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXh0cmFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLypcclxuICog5a+56LGhbGlua3PlsZ7mgKflhoXnmoTmiYDmnInnur/ov5vooYzliIfmjaJcclxuICogQGxpbmtzIG5vZGUvY29udGFpbmVy55qEbGlua3PlsZ7mgKdcclxuICogQGZuTmFtZSAnc2hvdycvJ2hpZGUn5pa55rOV5ZCNXHJcbiAqL1xyXG5mdW5jdGlvbiB0b2dnbGUobGlua3MsIGZuTmFtZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICAkLmVhY2gobGlua3MsIGZ1bmN0aW9uIChuYW1lLCBhcnIpIHtcclxuICAgICAgICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW1bZm5OYW1lXSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCLliIfmjaLpmpDol48v5pi+56S65pe26ZSZ6K+vXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbi8v57q/55qE5pi+56S65Y+q5pyJ5b2T5YW25Lik56uv6IqC54K56YO95pi+56S65pe25omN5pi+56S6XHJcbmZ1bmN0aW9uIHRvZ2dsZUxpbmsoZmxhZykge1xyXG4gICAgaWYgKGZsYWcpIHtcclxuICAgICAgICBpZiAodGhpcy5wYXRoLnN0YXJ0Lmp0b3BvICYmIHRoaXMucGF0aC5lbmQuanRvcG8pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucGF0aC5zdGFydC5qdG9wby52aXNpYmxlICYmIHRoaXMucGF0aC5lbmQuanRvcG8udmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5qdG9wby52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby52aXNpYmxlID0gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdG9nZ2xlTm9kZShmbGFnKSB7XHJcbiAgICB0aGlzLmp0b3BvLnZpc2libGUgPSBmbGFnO1xyXG4gICAgdmFyIHN0cmluZyA9IGZsYWcgPyBcInNob3dcIiA6IFwiaGlkZVwiO1xyXG4gICAgdG9nZ2xlKHRoaXMubGlua3MsIHN0cmluZyk7XHJcbn1cclxuZnVuY3Rpb24gdG9nZ2xlQ29udGFpbmVyKGZsYWcpIHtcclxuICAgIHRoaXMuanRvcG8udmlzaWJsZSA9IGZsYWc7XHJcbiAgICB2YXIgc3RyaW5nID0gZmxhZyA/IFwic2hvd1wiIDogXCJoaWRlXCI7XHJcbiAgICAvL+WIh+aNouWtkOexu+aYvuekuumakOiXj1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbltpXVtzdHJpbmddKCk7XHJcbiAgICB9XHJcbiAgICB0b2dnbGUodGhpcy5saW5rcywgc3RyaW5nKTtcclxufVxyXG4vKipcclxuICog6I635Y+W5YWD57Sg5Lit5b+D5Z2Q5qCHXHJcbiAqICBAbWV0aG9kIFtFXSBnZXRDZW50ZXJQb3NpdGlvblxyXG4gKiAgQHJldHVybiB7b2JqZWN0fSB7eCx5fVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuZ2V0Q2VudGVyUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHg6IHRoaXMuanRvcG8uY3gsXHJcbiAgICAgICAgeTogdGhpcy5qdG9wby5jeVxyXG4gICAgfVxyXG59O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L0VsZW1lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports,__webpack_require__){eval("/**\r\n * @module core\r\n */\r\n/**\r\n * 链路基类,用以继承 [E]开头继承于Element,[L]开头为自身api\r\n * @class [L] Link\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element = __webpack_require__(1);\r\nmodule.exports = Link;\r\nfunction Link(jtopo) {\r\n    if (!jtopo) {\r\n        QTopo.util.error(\"create Link without jtopo\", this);\r\n        return;\r\n    }\r\n    Element.call(this, jtopo);\r\n    /**\r\n     * 记录链路的首尾元素\r\n     * @property [L] path {object}\r\n     * @param start {object} 起始元素\r\n     * @param end {object} 终点元素\r\n     */\r\n    this.path = {\r\n        start: this.jtopo.nodeA.qtopo,\r\n        end: this.jtopo.nodeZ.qtopo\r\n    };\r\n    //在线路两端的对象上的links属性中更新自己\r\n    if (this.path.start.links && $.isArray(this.path.start.links.out)) {\r\n        if (this.path.start.links.out.indexOf(this) < 0) {\r\n            this.path.start.links.out.push(this);\r\n        }\r\n    }\r\n    if (this.path.end.links && $.isArray(this.path.end.links.in)) {\r\n        if (this.path.end.links.in.indexOf(this) < 0) {\r\n            this.path.end.links.in.push(this);\r\n        }\r\n    }\r\n}\r\nQTopo.util.inherits(Link, Element);\r\n/**\r\n *  获取元素基本类型,详细参考QTopo.constant中的类型定义\r\n *  @method [L] getType\r\n *  @return QTopo.constant.LINK\r\n */\r\nLink.prototype.getType = function () {\r\n    return QTopo.constant.LINK;\r\n};\r\n/**\r\n *  设置颜色\r\n *  @method [L] setColor\r\n *  @param color {string} \"255,255,255\"/\"#ffffff\"\r\n */\r\nLink.prototype.setColor = function (color) {\r\n    if (color) {\r\n        this.jtopo.strokeColor = QTopo.util.transHex(color.toLowerCase());\r\n    }\r\n    this.attr.color = this.jtopo.strokeColor;\r\n};\r\n/**\r\n *  计数设置\r\n *\r\n *  计数大于1时在链路上显示(+number)\r\n *\r\n *  QTopo.constant.link.DIRECT类型的链路可以基于此数展开\r\n *  @method [L] setNumber\r\n *  @param number {number}\r\n */\r\nLink.prototype.setNumber = function (number) {\r\n    if ($.isNumeric(number)) {\r\n        number = parseInt(number);\r\n        if (number > 1) {\r\n            this.jtopo.text = '(+' + number + ')';\r\n        } else {\r\n            number = 1;\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.number = number;\r\n    }\r\n};\r\n/**\r\n *  设置链路宽度,小于0则默认为1\r\n *  @method [L] setWidth\r\n *  @param width {number}\r\n */\r\nLink.prototype.setWidth = function (width) {\r\n    if ($.isNumeric(width)) {\r\n        var newWidth = parseInt(width);\r\n        this.jtopo.lineWidth = newWidth > 0 ? newWidth : 1; // 线宽\r\n    }\r\n    this.attr.width = this.jtopo.lineWidth;\r\n};\r\n/**\r\n *  设置链路两端的箭头属性\r\n *  @method [L] setArrow\r\n *  @param arrow {object}\r\n *\r\n *          arrow={\r\n *              size:箭头大小{number},\r\n *              offset:箭头在链路上的偏移量{number},\r\n *              start:是否显示起点箭头{boolean},\r\n *              end:是否显示终点箭头{boolean},\r\n *          }\r\n */\r\nLink.prototype.setArrow = function (arrow) {\r\n    if (arrow) {\r\n        if(typeof arrow.size!='undefined'){\r\n            this.jtopo.arrowsRadius = $.isNumeric(arrow.size) ? parseInt(arrow.size) : 0;\r\n        }\r\n        if(typeof arrow.offset!='undefined'){\r\n            this.jtopo.arrowsOffset = $.isNumeric(arrow.offset) ? parseInt(arrow.offset) : 0;\r\n        }\r\n        if(typeof arrow.type!='undefined'){\r\n            this.jtopo.arrowsType = arrow.type;\r\n        }\r\n        if (!this.attr.arrow) {\r\n            this.attr.arrow = {};\r\n        }\r\n        if (typeof arrow.start!='undefined') {\r\n            this.attr.arrow.start = typeof arrow.start == \"boolean\" ? arrow.start : arrow.start == \"true\";\r\n        }\r\n        if (typeof arrow.end!='undefined') {\r\n            this.attr.arrow.end = typeof arrow.end == \"boolean\" ? arrow.end : arrow.end == \"true\";\r\n        }\r\n    }\r\n    this.attr.arrow.type=this.jtopo.arrowsType;\r\n    this.attr.arrow.size = this.jtopo.arrowsRadius;\r\n    this.attr.arrow.offset = this.jtopo.arrowsOffset;\r\n};\r\n/**\r\n *  设置相同起点和终点的链路之间的间隔大小\r\n *\r\n *  常用于设置QTopo.constant.link.DIRECT类型的链路展开时,其子链路之间的间距大小\r\n *  @method [L] setGap\r\n *  @param gap {number}\r\n */\r\nLink.prototype.setGap = function (gap) {\r\n    if (gap) {\r\n        this.jtopo.gap = $.isNumeric(gap) ? parseInt(gap) : 0; // 线条之间的间隔\r\n    }\r\n    this.attr.gap = this.jtopo.gap;\r\n};\r\n/**\r\n *  折线类链路两端的偏移线段长度，或曲线相对中轴线的偏移量\r\n *\r\n *  @method setOffset\r\n *  @param offset {number}\r\n */\r\nLink.prototype.setOffset = function (offset) {\r\n    if ($.isNumeric(offset)) {\r\n        this.jtopo.offset = parseInt(offset);\r\n    }\r\n    this.attr.offset = this.jtopo.offset;\r\n};\r\n/**\r\n *  设置链路的虚线线段长度\r\n *\r\n *  设置不为number类型或小于0时，则认为不要虚线\r\n *\r\n *  @method [L] setDashed\r\n *  @param dashedPattern {number|null}\r\n */\r\nLink.prototype.setDashed = function (dashedPattern) {\r\n    if ($.isNumeric(dashedPattern) && dashedPattern > 0) {\r\n        this.jtopo.dashedPattern = parseInt(dashedPattern);\r\n    } else {\r\n        this.jtopo.dashedPattern = null;\r\n    }\r\n    this.attr.dashed = this.jtopo.dashedPattern;\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [L] toJson\r\n *  @return {object}\r\n */\r\nLink.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    json.start=this.path.start.get('jsonId');\r\n    json.end=this.path.end.get('jsonId');\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0xpbmsuanM/NTYwMCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLHFCQUFxQixPQUFPO0FBQzVCLG1CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSwwQkFBMEIsT0FBTztBQUNqQyxrQ0FBa0MsT0FBTztBQUN6QywrQkFBK0IsUUFBUTtBQUN2Qyw2QkFBNkIsUUFBUTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOmTvui3r+WfuuexuyznlKjku6Xnu6fmib8gW0Vd5byA5aS057un5om/5LqORWxlbWVudCxbTF3lvIDlpLTkuLroh6rouqthcGlcclxuICogQGNsYXNzIFtMXSBMaW5rXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcbnZhciBFbGVtZW50ID0gcmVxdWlyZShcIi4uL0VsZW1lbnQuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0gTGluaztcclxuZnVuY3Rpb24gTGluayhqdG9wbykge1xyXG4gICAgaWYgKCFqdG9wbykge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgTGluayB3aXRob3V0IGp0b3BvXCIsIHRoaXMpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIEVsZW1lbnQuY2FsbCh0aGlzLCBqdG9wbyk7XHJcbiAgICAvKipcclxuICAgICAqIOiusOW9lemTvui3r+eahOmmluWwvuWFg+e0oFxyXG4gICAgICogQHByb3BlcnR5IFtMXSBwYXRoIHtvYmplY3R9XHJcbiAgICAgKiBAcGFyYW0gc3RhcnQge29iamVjdH0g6LW35aeL5YWD57SgXHJcbiAgICAgKiBAcGFyYW0gZW5kIHtvYmplY3R9IOe7iOeCueWFg+e0oFxyXG4gICAgICovXHJcbiAgICB0aGlzLnBhdGggPSB7XHJcbiAgICAgICAgc3RhcnQ6IHRoaXMuanRvcG8ubm9kZUEucXRvcG8sXHJcbiAgICAgICAgZW5kOiB0aGlzLmp0b3BvLm5vZGVaLnF0b3BvXHJcbiAgICB9O1xyXG4gICAgLy/lnKjnur/ot6/kuKTnq6/nmoTlr7nosaHkuIrnmoRsaW5rc+WxnuaAp+S4reabtOaWsOiHquW3sVxyXG4gICAgaWYgKHRoaXMucGF0aC5zdGFydC5saW5rcyAmJiAkLmlzQXJyYXkodGhpcy5wYXRoLnN0YXJ0LmxpbmtzLm91dCkpIHtcclxuICAgICAgICBpZiAodGhpcy5wYXRoLnN0YXJ0LmxpbmtzLm91dC5pbmRleE9mKHRoaXMpIDwgMCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhdGguc3RhcnQubGlua3Mub3V0LnB1c2godGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMucGF0aC5lbmQubGlua3MgJiYgJC5pc0FycmF5KHRoaXMucGF0aC5lbmQubGlua3MuaW4pKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGF0aC5lbmQubGlua3MuaW4uaW5kZXhPZih0aGlzKSA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy5wYXRoLmVuZC5saW5rcy5pbi5wdXNoKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKExpbmssIEVsZW1lbnQpO1xyXG4vKipcclxuICogIOiOt+WPluWFg+e0oOWfuuacrOexu+Weiyzor6bnu4blj4LogINRVG9wby5jb25zdGFudOS4reeahOexu+Wei+WumuS5iVxyXG4gKiAgQG1ldGhvZCBbTF0gZ2V0VHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5MSU5LXHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIFFUb3BvLmNvbnN0YW50LkxJTks7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6aKc6ImyXHJcbiAqICBAbWV0aG9kIFtMXSBzZXRDb2xvclxyXG4gKiAgQHBhcmFtIGNvbG9yIHtzdHJpbmd9IFwiMjU1LDI1NSwyNTVcIi9cIiNmZmZmZmZcIlxyXG4gKi9cclxuTGluay5wcm90b3R5cGUuc2V0Q29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc3Ryb2tlQ29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmNvbG9yID0gdGhpcy5qdG9wby5zdHJva2VDb2xvcjtcclxufTtcclxuLyoqXHJcbiAqICDorqHmlbDorr7nva5cclxuICpcclxuICogIOiuoeaVsOWkp+S6jjHml7blnKjpk77ot6/kuIrmmL7npLooK251bWJlcilcclxuICpcclxuICogIFFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNU57G75Z6L55qE6ZO+6Lev5Y+v5Lul5Z+65LqO5q2k5pWw5bGV5byAXHJcbiAqICBAbWV0aG9kIFtMXSBzZXROdW1iZXJcclxuICogIEBwYXJhbSBudW1iZXIge251bWJlcn1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnNldE51bWJlciA9IGZ1bmN0aW9uIChudW1iZXIpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhudW1iZXIpKSB7XHJcbiAgICAgICAgbnVtYmVyID0gcGFyc2VJbnQobnVtYmVyKTtcclxuICAgICAgICBpZiAobnVtYmVyID4gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSAnKCsnICsgbnVtYmVyICsgJyknO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG51bWJlciA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF0dHIubnVtYmVyID0gbnVtYmVyO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiuvue9rumTvui3r+WuveW6pizlsI/kuo4w5YiZ6buY6K6k5Li6MVxyXG4gKiAgQG1ldGhvZCBbTF0gc2V0V2lkdGhcclxuICogIEBwYXJhbSB3aWR0aCB7bnVtYmVyfVxyXG4gKi9cclxuTGluay5wcm90b3R5cGUuc2V0V2lkdGggPSBmdW5jdGlvbiAod2lkdGgpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyh3aWR0aCkpIHtcclxuICAgICAgICB2YXIgbmV3V2lkdGggPSBwYXJzZUludCh3aWR0aCk7XHJcbiAgICAgICAgdGhpcy5qdG9wby5saW5lV2lkdGggPSBuZXdXaWR0aCA+IDAgPyBuZXdXaWR0aCA6IDE7IC8vIOe6v+WuvVxyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLndpZHRoID0gdGhpcy5qdG9wby5saW5lV2lkdGg7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev5Lik56uv55qE566t5aS05bGe5oCnXHJcbiAqICBAbWV0aG9kIFtMXSBzZXRBcnJvd1xyXG4gKiAgQHBhcmFtIGFycm93IHtvYmplY3R9XHJcbiAqXHJcbiAqICAgICAgICAgIGFycm93PXtcclxuICogICAgICAgICAgICAgIHNpemU6566t5aS05aSn5bCPe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBvZmZzZXQ6566t5aS05Zyo6ZO+6Lev5LiK55qE5YGP56e76YePe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBzdGFydDrmmK/lkKbmmL7npLrotbfngrnnrq3lpLR7Ym9vbGVhbn0sXHJcbiAqICAgICAgICAgICAgICBlbmQ65piv5ZCm5pi+56S657uI54K5566t5aS0e2Jvb2xlYW59LFxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS5zZXRBcnJvdyA9IGZ1bmN0aW9uIChhcnJvdykge1xyXG4gICAgaWYgKGFycm93KSB7XHJcbiAgICAgICAgaWYodHlwZW9mIGFycm93LnNpemUhPSd1bmRlZmluZWQnKXtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5hcnJvd3NSYWRpdXMgPSAkLmlzTnVtZXJpYyhhcnJvdy5zaXplKSA/IHBhcnNlSW50KGFycm93LnNpemUpIDogMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodHlwZW9mIGFycm93Lm9mZnNldCE9J3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmFycm93c09mZnNldCA9ICQuaXNOdW1lcmljKGFycm93Lm9mZnNldCkgPyBwYXJzZUludChhcnJvdy5vZmZzZXQpIDogMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodHlwZW9mIGFycm93LnR5cGUhPSd1bmRlZmluZWQnKXtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5hcnJvd3NUeXBlID0gYXJyb3cudHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmF0dHIuYXJyb3cpIHtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLmFycm93ID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJyb3cuc3RhcnQhPSd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5hcnJvdy5zdGFydCA9IHR5cGVvZiBhcnJvdy5zdGFydCA9PSBcImJvb2xlYW5cIiA/IGFycm93LnN0YXJ0IDogYXJyb3cuc3RhcnQgPT0gXCJ0cnVlXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJyb3cuZW5kIT0ndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuYXJyb3cuZW5kID0gdHlwZW9mIGFycm93LmVuZCA9PSBcImJvb2xlYW5cIiA/IGFycm93LmVuZCA6IGFycm93LmVuZCA9PSBcInRydWVcIjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cudHlwZT10aGlzLmp0b3BvLmFycm93c1R5cGU7XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cuc2l6ZSA9IHRoaXMuanRvcG8uYXJyb3dzUmFkaXVzO1xyXG4gICAgdGhpcy5hdHRyLmFycm93Lm9mZnNldCA9IHRoaXMuanRvcG8uYXJyb3dzT2Zmc2V0O1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruebuOWQjOi1t+eCueWSjOe7iOeCueeahOmTvui3r+S5i+mXtOeahOmXtOmalOWkp+Wwj1xyXG4gKlxyXG4gKiAg5bi455So5LqO6K6+572uUVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1TnsbvlnovnmoTpk77ot6/lsZXlvIDml7Ys5YW25a2Q6ZO+6Lev5LmL6Ze055qE6Ze06Led5aSn5bCPXHJcbiAqICBAbWV0aG9kIFtMXSBzZXRHYXBcclxuICogIEBwYXJhbSBnYXAge251bWJlcn1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnNldEdhcCA9IGZ1bmN0aW9uIChnYXApIHtcclxuICAgIGlmIChnYXApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmdhcCA9ICQuaXNOdW1lcmljKGdhcCkgPyBwYXJzZUludChnYXApIDogMDsgLy8g57q/5p2h5LmL6Ze055qE6Ze06ZqUXHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuZ2FwID0gdGhpcy5qdG9wby5nYXA7XHJcbn07XHJcbi8qKlxyXG4gKiAg5oqY57q/57G76ZO+6Lev5Lik56uv55qE5YGP56e757q/5q616ZW/5bqm77yM5oiW5puy57q/55u45a+55Lit6L2057q/55qE5YGP56e76YePXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldE9mZnNldFxyXG4gKiAgQHBhcmFtIG9mZnNldCB7bnVtYmVyfVxyXG4gKi9cclxuTGluay5wcm90b3R5cGUuc2V0T2Zmc2V0ID0gZnVuY3Rpb24gKG9mZnNldCkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKG9mZnNldCkpIHtcclxuICAgICAgICB0aGlzLmp0b3BvLm9mZnNldCA9IHBhcnNlSW50KG9mZnNldCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIub2Zmc2V0ID0gdGhpcy5qdG9wby5vZmZzZXQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev55qE6Jma57q/57q/5q616ZW/5bqmXHJcbiAqXHJcbiAqICDorr7nva7kuI3kuLpudW1iZXLnsbvlnovmiJblsI/kuo4w5pe277yM5YiZ6K6k5Li65LiN6KaB6Jma57q/XHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMXSBzZXREYXNoZWRcclxuICogIEBwYXJhbSBkYXNoZWRQYXR0ZXJuIHtudW1iZXJ8bnVsbH1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnNldERhc2hlZCA9IGZ1bmN0aW9uIChkYXNoZWRQYXR0ZXJuKSB7XHJcbiAgICBpZiAoJC5pc051bWVyaWMoZGFzaGVkUGF0dGVybikgJiYgZGFzaGVkUGF0dGVybiA+IDApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm4gPSBwYXJzZUludChkYXNoZWRQYXR0ZXJuKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuID0gbnVsbDtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kYXNoZWQgPSB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm47XHJcbn07XHJcbi8qKlxyXG4gKiAg5Y2V5Liq5a+56LGh55qE5bGe5oCn5o+Q5Y+WXHJcbiAqICBAbWV0aG9kIFtMXSB0b0pzb25cclxuICogIEByZXR1cm4ge29iamVjdH1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnRvSnNvbj1mdW5jdGlvbigpe1xyXG4gICAgdmFyIGpzb249JC5leHRlbmQoe30sdGhpcy5hdHRyKTtcclxuICAgIGpzb24uZXh0cmE9JC5leHRlbmQoe30sdGhpcy5leHRyYSk7XHJcbiAgICBqc29uLnN0YXJ0PXRoaXMucGF0aC5zdGFydC5nZXQoJ2pzb25JZCcpO1xyXG4gICAganNvbi5lbmQ9dGhpcy5wYXRoLmVuZC5nZXQoJ2pzb25JZCcpO1xyXG4gICAgcmV0dXJuIGpzb247XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0xpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 节点基类,用以继承 [E]开头继承于Element,[N]开头为自身api\r\n * @class [N] Node\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element=__webpack_require__(1);\r\nmodule.exports =Node;\r\n\r\nfunction Node(jtopo) {\r\n    if(jtopo){\r\n        Element.call(this,jtopo);\r\n    }else{\r\n        QTopo.util.error("create Node without jtopo",this);\r\n    }\r\n    /**\r\n     * 链接记录\r\n     * @property [N] links {object}\r\n     * @param in {array} 自身为终点的链路对象\r\n     * @param out {array} 自身为起点的链路对象\r\n     */\r\n    this.links={\r\n        in:[],\r\n        out:[]\r\n    };\r\n}\r\nQTopo.util.inherits(Node,Element);\r\n/**\r\n *  获取元素基本类型,详细参考QTopo.constant中的类型定义\r\n *  @method [N] getType\r\n *  @return QTopo.constant.NODE\r\n */\r\nNode.prototype.getType=function(){\r\n    return QTopo.constant.NODE;\r\n};\r\n/**\r\n *  设置颜色,一般为设置自身填充颜色，节点有图片设置或为文字节点时无效\r\n *  @method [N] setColor\r\n *  @param color {string} "255,255,255"/"#ffffff"\r\n */\r\nNode.prototype.setColor = function (color) {\r\n    if (color) {\r\n        color = QTopo.util.transHex(color.toLowerCase());\r\n        this.jtopo.fillColor = color;\r\n    }\r\n    this.attr.color=this.jtopo.fillColor;\r\n};\r\n/**\r\n *  设置显示名称,删减首尾空格符\r\n *\r\n *  文字节点应调用setText处理文字显示\r\n *\r\n *  其他节点应用该函数处理名称，否则会出现隐藏后再显示而名称不符的Bug\r\n *  @method [N] setName\r\n *  @param name {string}\r\n */\r\nNode.prototype.setName=function(name){\r\n    if(name){\r\n        if (this.attr.namePosition != "hide") {\r\n            this.jtopo.text = (name+"").trim();\r\n        }\r\n        this.attr.name = (name+"").trim();\r\n    }\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [N] toJson\r\n *  @return {object}\r\n */\r\nNode.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    return json;\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL05vZGUuanM/OTA1OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLGtCQUFrQixNQUFNO0FBQ3hCLG1CQUFtQixNQUFNO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQSIsImZpbGUiOiIzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOiKgueCueWfuuexuyznlKjku6Xnu6fmib8gW0Vd5byA5aS057un5om/5LqORWxlbWVudCxbTl3lvIDlpLTkuLroh6rouqthcGlcclxuICogQGNsYXNzIFtOXSBOb2RlXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcbnZhciBFbGVtZW50PXJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9Tm9kZTtcclxuXHJcbmZ1bmN0aW9uIE5vZGUoanRvcG8pIHtcclxuICAgIGlmKGp0b3BvKXtcclxuICAgICAgICBFbGVtZW50LmNhbGwodGhpcyxqdG9wbyk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIE5vZGUgd2l0aG91dCBqdG9wb1wiLHRoaXMpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDpk77mjqXorrDlvZVcclxuICAgICAqIEBwcm9wZXJ0eSBbTl0gbGlua3Mge29iamVjdH1cclxuICAgICAqIEBwYXJhbSBpbiB7YXJyYXl9IOiHqui6q+S4uue7iOeCueeahOmTvui3r+WvueixoVxyXG4gICAgICogQHBhcmFtIG91dCB7YXJyYXl9IOiHqui6q+S4uui1t+eCueeahOmTvui3r+WvueixoVxyXG4gICAgICovXHJcbiAgICB0aGlzLmxpbmtzPXtcclxuICAgICAgICBpbjpbXSxcclxuICAgICAgICBvdXQ6W11cclxuICAgIH07XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhOb2RlLEVsZW1lbnQpO1xyXG4vKipcclxuICogIOiOt+WPluWFg+e0oOWfuuacrOexu+Weiyzor6bnu4blj4LogINRVG9wby5jb25zdGFudOS4reeahOexu+Wei+WumuS5iVxyXG4gKiAgQG1ldGhvZCBbTl0gZ2V0VHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5OT0RFXHJcbiAqL1xyXG5Ob2RlLnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuTk9ERTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7popzoibIs5LiA6Iis5Li66K6+572u6Ieq6Lqr5aGr5YWF6aKc6Imy77yM6IqC54K55pyJ5Zu+54mH6K6+572u5oiW5Li65paH5a2X6IqC54K55pe25peg5pWIXHJcbiAqICBAbWV0aG9kIFtOXSBzZXRDb2xvclxyXG4gKiAgQHBhcmFtIGNvbG9yIHtzdHJpbmd9IFwiMjU1LDI1NSwyNTVcIi9cIiNmZmZmZmZcIlxyXG4gKi9cclxuTm9kZS5wcm90b3R5cGUuc2V0Q29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgIGNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICB0aGlzLmp0b3BvLmZpbGxDb2xvciA9IGNvbG9yO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmNvbG9yPXRoaXMuanRvcG8uZmlsbENvbG9yO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruaYvuekuuWQjeensCzliKDlh4/pppblsL7nqbrmoLznrKZcclxuICpcclxuICogIOaWh+Wtl+iKgueCueW6lOiwg+eUqHNldFRleHTlpITnkIbmloflrZfmmL7npLpcclxuICpcclxuICogIOWFtuS7luiKgueCueW6lOeUqOivpeWHveaVsOWkhOeQhuWQjeensO+8jOWQpuWImeS8muWHuueOsOmakOiXj+WQjuWGjeaYvuekuuiAjOWQjeensOS4jeespueahEJ1Z1xyXG4gKiAgQG1ldGhvZCBbTl0gc2V0TmFtZVxyXG4gKiAgQHBhcmFtIG5hbWUge3N0cmluZ31cclxuICovXHJcbk5vZGUucHJvdG90eXBlLnNldE5hbWU9ZnVuY3Rpb24obmFtZSl7XHJcbiAgICBpZihuYW1lKXtcclxuICAgICAgICBpZiAodGhpcy5hdHRyLm5hbWVQb3NpdGlvbiAhPSBcImhpZGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSAobmFtZStcIlwiKS50cmltKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXR0ci5uYW1lID0gKG5hbWUrXCJcIikudHJpbSgpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOWNleS4quWvueixoeeahOWxnuaAp+aPkOWPllxyXG4gKiAgQG1ldGhvZCBbTl0gdG9Kc29uXHJcbiAqICBAcmV0dXJuIHtvYmplY3R9XHJcbiAqL1xyXG5Ob2RlLnByb3RvdHlwZS50b0pzb249ZnVuY3Rpb24oKXtcclxuICAgIHZhciBqc29uPSQuZXh0ZW5kKHt9LHRoaXMuYXR0cik7XHJcbiAgICBqc29uLmV4dHJhPSQuZXh0ZW5kKHt9LHRoaXMuZXh0cmEpO1xyXG4gICAgcmV0dXJuIGpzb247XHJcbn07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbm9kZS9Ob2RlLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},,,,,function(module,exports){eval('/**\r\n * @module QTopo\r\n */\r\n/**\r\n * @class QTopo\r\n * @static\r\n */\r\n/**\r\n * 定义的通用常量,一般用getType()来区分元素基本类型,getUseType()区分元素具体类型\r\n * @property constant\r\n * @type Object\r\n * @param SCENE {string}\r\n * @param CONTAINER {string}\r\n * @param LINK {string}\r\n * @param LINE {string}\r\n * @param NODE {string}\r\n * @param CASUAL {string} 临时元素，用以元素变换收缩等操作的过渡元素,一般不对其做操作\r\n * @param node.IMAGE {string}\r\n * @param node.TEXT {string}\r\n * @param node.SHAPE {string}\r\n * @param container.GROUP {string}\r\n * @param link.CURVE {string}\r\n * @param link.DIRECT {string}\r\n * @param link.FLEXIONAL {string}\r\n * @param link.FOLD {string}\r\n * @param line.DIRECT {string}\r\n * @param mode.NORMAL {string}\r\n * @param mode.EDIT {string}\r\n * @param mode.DRAG {string}\r\n * @param mode.SELECT {string}\r\n * @example\r\n *      if(node.getType()==QTopo.constant.NODE){.....}\r\n *      if(node.getUseType()!=QTopo.constant.CASUAL){.....}\r\n *      if(node.getUseType()==QTopo.constant.node.IMAGE){.....}\r\n */\r\nmodule.exports = {\r\n    SCENE:\'10\',\r\n    CONTAINER:"100",\r\n    LINK:"1000",\r\n    LINE:"1100",\r\n    NODE:\'10000\',\r\n    CASUAL:"临时工",//\r\n    node:{\r\n        IMAGE:"10010",\r\n        TEXT:"10001",\r\n        SHAPE:"10011"\r\n    },\r\n    container:{\r\n        GROUP:"101"\r\n    },\r\n    link:{\r\n        CURVE:"1001",\r\n        DIRECT:"1002",\r\n        FLEXIONAL:"1003",\r\n        FOLD:"1004"\r\n    },\r\n    line:{\r\n        DIRECT:"1101"\r\n    },\r\n    mode:{\r\n        NORMAL:"normal",\r\n        EDIT:"edit",\r\n        DRAG:"drag",\r\n        SELECT:"select"\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvbnN0YW50LmpzPzhiZDkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixxQkFBcUI7QUFDckIsZ0JBQWdCO0FBQ2hCLGdCQUFnQjtBQUNoQixnQkFBZ0I7QUFDaEIsa0JBQWtCLE9BQU87QUFDekIsc0JBQXNCO0FBQ3RCLHFCQUFxQjtBQUNyQixzQkFBc0I7QUFDdEIsMkJBQTJCO0FBQzNCLHNCQUFzQjtBQUN0Qix1QkFBdUI7QUFDdkIsMEJBQTBCO0FBQzFCLHFCQUFxQjtBQUNyQix1QkFBdUI7QUFDdkIsdUJBQXVCO0FBQ3ZCLHFCQUFxQjtBQUNyQixxQkFBcUI7QUFDckIsdUJBQXVCO0FBQ3ZCO0FBQ0EsZ0RBQWdEO0FBQ2hELHFEQUFxRDtBQUNyRCx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBRVG9wb1xyXG4gKi9cclxuLyoqXHJcbiAqIEBjbGFzcyBRVG9wb1xyXG4gKiBAc3RhdGljXHJcbiAqL1xyXG4vKipcclxuICog5a6a5LmJ55qE6YCa55So5bi46YePLOS4gOiIrOeUqGdldFR5cGUoKeadpeWMuuWIhuWFg+e0oOWfuuacrOexu+WeiyxnZXRVc2VUeXBlKCnljLrliIblhYPntKDlhbfkvZPnsbvlnotcclxuICogQHByb3BlcnR5IGNvbnN0YW50XHJcbiAqIEB0eXBlIE9iamVjdFxyXG4gKiBAcGFyYW0gU0NFTkUge3N0cmluZ31cclxuICogQHBhcmFtIENPTlRBSU5FUiB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gTElOSyB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gTElORSB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gTk9ERSB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gQ0FTVUFMIHtzdHJpbmd9IOS4tOaXtuWFg+e0oO+8jOeUqOS7peWFg+e0oOWPmOaNouaUtue8qeetieaTjeS9nOeahOi/h+a4oeWFg+e0oCzkuIDoiKzkuI3lr7nlhbblgZrmk43kvZxcclxuICogQHBhcmFtIG5vZGUuSU1BR0Uge3N0cmluZ31cclxuICogQHBhcmFtIG5vZGUuVEVYVCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbm9kZS5TSEFQRSB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gY29udGFpbmVyLkdST1VQIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBsaW5rLkNVUlZFIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBsaW5rLkRJUkVDVCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbGluay5GTEVYSU9OQUwge3N0cmluZ31cclxuICogQHBhcmFtIGxpbmsuRk9MRCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbGluZS5ESVJFQ1Qge3N0cmluZ31cclxuICogQHBhcmFtIG1vZGUuTk9STUFMIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBtb2RlLkVESVQge3N0cmluZ31cclxuICogQHBhcmFtIG1vZGUuRFJBRyB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbW9kZS5TRUxFQ1Qge3N0cmluZ31cclxuICogQGV4YW1wbGVcclxuICogICAgICBpZihub2RlLmdldFR5cGUoKT09UVRvcG8uY29uc3RhbnQuTk9ERSl7Li4uLi59XHJcbiAqICAgICAgaWYobm9kZS5nZXRVc2VUeXBlKCkhPVFUb3BvLmNvbnN0YW50LkNBU1VBTCl7Li4uLi59XHJcbiAqICAgICAgaWYobm9kZS5nZXRVc2VUeXBlKCk9PVFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0Upey4uLi4ufVxyXG4gKi9cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBTQ0VORTonMTAnLFxyXG4gICAgQ09OVEFJTkVSOlwiMTAwXCIsXHJcbiAgICBMSU5LOlwiMTAwMFwiLFxyXG4gICAgTElORTpcIjExMDBcIixcclxuICAgIE5PREU6JzEwMDAwJyxcclxuICAgIENBU1VBTDpcIuS4tOaXtuW3pVwiLC8vXHJcbiAgICBub2RlOntcclxuICAgICAgICBJTUFHRTpcIjEwMDEwXCIsXHJcbiAgICAgICAgVEVYVDpcIjEwMDAxXCIsXHJcbiAgICAgICAgU0hBUEU6XCIxMDAxMVwiXHJcbiAgICB9LFxyXG4gICAgY29udGFpbmVyOntcclxuICAgICAgICBHUk9VUDpcIjEwMVwiXHJcbiAgICB9LFxyXG4gICAgbGluazp7XHJcbiAgICAgICAgQ1VSVkU6XCIxMDAxXCIsXHJcbiAgICAgICAgRElSRUNUOlwiMTAwMlwiLFxyXG4gICAgICAgIEZMRVhJT05BTDpcIjEwMDNcIixcclxuICAgICAgICBGT0xEOlwiMTAwNFwiXHJcbiAgICB9LFxyXG4gICAgbGluZTp7XHJcbiAgICAgICAgRElSRUNUOlwiMTEwMVwiXHJcbiAgICB9LFxyXG4gICAgbW9kZTp7XHJcbiAgICAgICAgTk9STUFMOlwibm9ybWFsXCIsXHJcbiAgICAgICAgRURJVDpcImVkaXRcIixcclxuICAgICAgICBEUkFHOlwiZHJhZ1wiLFxyXG4gICAgICAgIFNFTEVDVDpcInNlbGVjdFwiXHJcbiAgICB9XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvbnN0YW50LmpzXG4vLyBtb2R1bGUgaWQgPSA4XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n//-\r\nvar Node = {\r\n    Image: __webpack_require__(35),\r\n    Text: __webpack_require__(37),\r\n    Shape: __webpack_require__(36)\r\n};\r\nvar Link = {\r\n    Curve: __webpack_require__(31),\r\n    Direct: __webpack_require__(32),\r\n    Flexional: __webpack_require__(33),\r\n    Fold: __webpack_require__(34)\r\n};\r\n\r\nvar Line = {\r\n    Direct: __webpack_require__(29)\r\n};\r\nvar Container = {\r\n    Group: __webpack_require__(28)\r\n};\r\nvar events = __webpack_require__(38);\r\nmodule.exports = Scene;\r\n//-\r\n//画布对象\r\nvar defaults = function () {\r\n    return {\r\n        mode: QTopo.constant.mode.NORMAL,\r\n        backgroundImage: ""\r\n    };\r\n};\r\n/**\r\n * 图层对象\r\n * @class Scene\r\n * @constructor\r\n * @param canvas 绘图所在的canvas标签对象\r\n * @param config 图层的基本设置,参见attr属性\r\n */\r\nfunction Scene(canvas, config) {\r\n    var self = this;\r\n    /**\r\n     * 核心Jtopo对象\r\n     * @property jtopo {Object}\r\n     */\r\n    self.jtopo = new JTopo.Scene();\r\n    self.jtopo.qtopo = self;\r\n    /**\r\n     * 图层中有效记录的元素\r\n     * @property children {object}\r\n     * @param node {array}\r\n     * @param link {array}\r\n     * @param container {array}\r\n     * @param line {array}\r\n     */\r\n    self.children = {\r\n        node: [],\r\n        link: [],\r\n        container: [],\r\n        line: []\r\n    };\r\n    /**\r\n     * 图层的主要属性\r\n     * @property attr {objcet}\r\n     * @param [mode=QTopo.constant.mode.NORMAL],\r\n     * @param [backgroundImage=\'\'],\r\n     * @param [backgroundColor=\'\'],\r\n     */\r\n    self.attr = defaults();\r\n    /**\r\n     * 图层的额外属性\r\n     * @property extra {objcet}\r\n     */\r\n    self.extra = config.extra || {};\r\n    new JTopo.Stage(canvas).add(self.jtopo);\r\n    events.init(self);\r\n    //延时执行\r\n    setTimeout(function () {\r\n        if (config) {\r\n            if (config.backgroundImage) {\r\n                self.setBackgroundImage(config.backgroundImage);\r\n            }\r\n            if (config.backgroundColor) {\r\n                self.setBackgroundColor(config.backgroundColor);\r\n            }\r\n            if (config.mode) {\r\n                self.setMode(config.mode);\r\n            }\r\n        }\r\n    });\r\n}\r\n//-\r\n/**\r\n *  获取图层的基本属性\r\n *  @method get\r\n *  @param key {string} 要获取的属性名\r\n *  @returns {string|object} 属性值\r\n *  @example\r\n *          scene.get(\'mode\')       //"normal"\r\n */\r\nScene.prototype.get = function (key) {\r\n    return this.attr[key];\r\n};\r\n/**\r\n *  获取图层的属性,或添加/修改额外属性\r\n *  @method val\r\n *  @param key {string}\r\n *\r\n *  要操作的属性名,与get不同，该函数会在整个对象中查找与key匹配的属性\r\n *  无论是额外属性还是基本属性又或是Scene.xx属性，只要匹配成功即返回.\r\n *  优先级为 额外属性>基本属性>Scene.xx属性\r\n *\r\n *  用该函数赋予额外属性时，可以直接传入一个对象作为参数\r\n *  该函数会遍历该参数对象将其内容全部覆盖到额外属性上\r\n *\r\n *  @param [value] {string|object} 属性值，若无则函数为获取属性，若有则为修改/添加属性\r\n *  @returns {string|object|void}\r\n *  @example\r\n *\r\n *       赋值操作   1. scene.val(\'pid\',\'12345\')\r\n *                  2. scene.val({\r\n *                          pid:"12345",\r\n *                          path:[]\r\n *                      })\r\n *       取属性操作 scene.val(\'pid\')       //"12345"\r\n *                  scene.val(\'position\') //undefined\r\n *                  scene.val(\'path\')       //[]\r\n *                  scene.val(\'mode\')       //"normal"\r\n */\r\nScene.prototype.val = function (key, value) {\r\n    if (QTopo.util.getClass(key) == \'Object\') {\r\n        var self = this;\r\n        $.each(key, function (name, value) {\r\n            self.extra[name] = value;\r\n        })\r\n    } else {\r\n        if (!value) {\r\n            var result;\r\n            if (this.extra[key]) {\r\n                result = this.extra[key];\r\n            } else if (this.attr[key]) {\r\n                result = this.attr[key];\r\n            } else {\r\n                result = this[key];\r\n            }\r\n            return result;\r\n        } else {\r\n            this.extra[key] = value;\r\n        }\r\n    }\r\n};\r\n/**\r\n *  配置图层中元素全局样式\r\n *  @method setDefault\r\n *  @param type {string} 要配置的元素类型 例：QTopo.constant.node.IMAGE\r\n *  @param config {object} 样式属性，可参考对应的元素attr属性\r\n */\r\nScene.prototype.setDefault = function (type, config) {\r\n    if (config) {\r\n        var constant = QTopo.constant;\r\n        switch (type) {\r\n            case constant.node.IMAGE:\r\n                Node.Image.setDefault(config);\r\n                break;\r\n            case constant.node.TEXT:\r\n                Node.Text.setDefault(config);\r\n                break;\r\n            case constant.link.DIRECT:\r\n                Link.Direct.setDefault(config);\r\n                break;\r\n            case constant.link.CURVE:\r\n                Link.Curve.setDefault(config);\r\n                break;\r\n            case constant.link.FLEXIONAL:\r\n                Link.Flexional.setDefault(config);\r\n                break;\r\n            case constant.link.FOLD:\r\n                Link.Fold.setDefault(config);\r\n                break;\r\n            case constant.line.DIRECT:\r\n                Line.Direct.setDefault(config);\r\n                break;\r\n            case constant.container.GROUP:\r\n                Container.Group.setDefault(config);\r\n                break;\r\n        }\r\n    }\r\n};\r\n/**\r\n *  获取图层中元素全局样式\r\n *  @method getDefault\r\n *  @param type {string} 要配置的元素类型 例：QTopo.constant.node.IMAGE\r\n *  @return {object} 样式属性，可参考对应的元素attr属性\r\n */\r\nScene.prototype.getDefault = function (type) {\r\n    if (type) {\r\n        var result;\r\n        var constant = QTopo.constant;\r\n        switch (type) {\r\n            case constant.node.IMAGE:\r\n                result = Node.Image.getDefault();\r\n                break;\r\n            case constant.node.TEXT:\r\n                result = Node.Text.getDefault();\r\n                break;\r\n            case constant.link.DIRECT:\r\n                result = Link.Direct.getDefault();\r\n                break;\r\n            case constant.link.CURVE:\r\n                result = Link.Curve.getDefault();\r\n                break;\r\n            case constant.link.FLEXIONAL:\r\n                result = Link.Flexional.getDefault();\r\n                break;\r\n            case constant.link.FOLD:\r\n                result = Link.Fold.getDefault();\r\n                break;\r\n            case constant.line.DIRECT:\r\n                result = Line.Direct.getDefault();\r\n                break;\r\n            case constant.container.GROUP:\r\n                result = Container.Group.getDefault();\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n};\r\n/**\r\n *  设置图层背景图片，与setBackgroundColor冲突\r\n *  @method setBackgroundImage\r\n *  @param image {string} 图片url\r\n */\r\nScene.prototype.setBackgroundImage = function (image) {\r\n    this.jtopo.background = image;\r\n    this.attr.background = image;\r\n};\r\n/**\r\n *  设置图层背景颜色，与setBackgroundImage冲突\r\n *  @method setBackgroundColor\r\n *  @param color {string} #xxxxxx/255,255,255\r\n */\r\nScene.prototype.setBackgroundColor = function (color) {\r\n    this.jtopo.backgroundColor = QTopo.util.transHex(color);\r\n    this.jtopo.alpha = 1;\r\n    this.attr.background = QTopo.util.transHex(color);\r\n};\r\n/**\r\n *  设置图层模式\r\n *  @method setMode\r\n *  @param mode {string} 例:QTopo.constant.mode.NORMAL\r\n */\r\nScene.prototype.setMode = function (mode) {\r\n    if (["normal", "edit", "drag", "select"].indexOf(mode) > -1) {\r\n        this.attr.mode = mode;\r\n        this.jtopo.mode = mode;\r\n    } else {\r\n        QTopo.util.error("set wrong mode :", mode);\r\n    }\r\n};\r\n/**\r\n *  图层清空，清除图层内所有元素\r\n *  @method clear\r\n */\r\nScene.prototype.clear = function () {\r\n    QTopo.util.info("scene clear");\r\n    this.children = {\r\n        node: [],\r\n        link: [],\r\n        container: [],\r\n        line: []\r\n    };\r\n    this.jtopo.clear();\r\n};\r\n/**\r\n *  获取类型，常用在右键菜单上对触发对象的识别\r\n *  @method getType\r\n *  @return QTopo.constant.SCENE\r\n */\r\nScene.prototype.getType = function () {\r\n    return QTopo.constant.SCENE;\r\n};\r\n/**\r\n *  获取使用类型，常用在右键菜单上对触发对象的识别\r\n *  @method getUseType\r\n *  @return QTopo.constant.SCENE\r\n */\r\nScene.prototype.getUseType = function () {\r\n    return QTopo.constant.SCENE;\r\n};\r\n/**\r\n *  绑定事件，可用off删除对应事件\r\n *  @method on\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param fn {function} 处理函数\r\n */\r\nScene.prototype.on = function (name, fn) {\r\n    this.jtopo.addEventListener(name, fn);\r\n};\r\n/**\r\n *  删除事件，可删除on绑定的事件\r\n *  @method off\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param [fn]{function} 处理的函数对象，若无参则删除该事件下所有函数\r\n */\r\nScene.prototype.off = function (name, fn) {\r\n    this.jtopo.removeEventListener(name, fn);\r\n};\r\n/**\r\n *  根据搜索当前图层，查找基本属性或额外属性满足条件的元素\r\n *  @method find\r\n *  @param scan {string} 查询条件,格式为"key=value,key=value",多个条件用,分割\r\n *  @param [type] {string} 可指定元素类型精确查找\r\n *  @return {array} 返回数组，数组成员为满足至少一个条件的元素\r\n */\r\nScene.prototype.find = function (scan, type) {\r\n    var children = this.children;\r\n    var result = [];\r\n    var condition = typeof scan == "string" ? scan.split(",") : [];\r\n    if (condition.length > 0) {\r\n        $.each(condition, function (i, temp) {\r\n            temp = temp.split("=");\r\n            if (temp.length >= 2) {\r\n                //制定了类型，缩小查找范围，未指定则全部遍历\r\n                if (type) {\r\n                    switch (type) {\r\n                        case "node":\r\n                            scanArr(children.node, temp[0], temp[1]);\r\n                            break;\r\n                        case "link":\r\n                            scanArr(children.link, temp[0], temp[1]);\r\n                            break;\r\n                        case "container":\r\n                            scanArr(children.container, temp[0], temp[1]);\r\n                            break;\r\n                        case "line":\r\n                            scanArr(children.line, temp[0], temp[1]);\r\n                            break;\r\n                    }\r\n                } else {\r\n                    $.each(children, function (j, arr) {\r\n                        scanArr(arr, temp[0], temp[1]);\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n    //扫描数组中对象对应的属性是否相等\r\n    function scanArr(arr, key, value) {\r\n        $.each(arr, function (i, item) {\r\n            //只扫描对象的attr和extra中的属性\r\n            if (equal(item.extra, key, value) || equal(item.attr, key, value)) {\r\n                //排除重复的\r\n                if (result.indexOf(item) < 0) {\r\n                    result.push(item);\r\n                }\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    function equal(object, key, value) {\r\n        return object && object[key] && object[key] == value;\r\n    }\r\n};\r\n/**\r\n *  获取当前图层在正常视角下(未放大缩小)最左上角的坐标\r\n *  @method getOrigin\r\n *  @return {object} 包含 x,y属性\r\n */\r\nScene.prototype.getOrigin = function () {\r\n    return {\r\n        x: 0 - this.jtopo.translateX,\r\n        y: 0 - this.jtopo.translateY\r\n    }\r\n};\r\n//-\r\nfunction addJTopo(element) {\r\n    try {\r\n        this.jtopo.add(element.jtopo);\r\n    } catch (e) {\r\n        QTopo.util.error("In Scene, jtopo add error : ", e);\r\n    }\r\n}\r\nfunction removeJTopo(element) {\r\n    try {\r\n        this.jtopo.remove(element.jtopo);\r\n    } catch (e) {\r\n        QTopo.util.error("In Scene, jtopo remove error : ", e);\r\n    }\r\n}\r\n/**\r\n *  根据配置在当前图层上绘制节点\r\n *  @method createNode\r\n *  @param [config] {object}\r\n *\r\n *  无参则根据全局配置绘制QTopo.constant.node.IMAGE对应的节点,\r\n *\r\n *  config.type可指定绘制节点类型\r\n *\r\n *  参考QTopo.contant.node选择可绘制的种类\r\n *  @return {Node|boolean} 创建成功返回节点对象，失败返回false\r\n */\r\nScene.prototype.createNode = function (config) {\r\n    var newNode;\r\n    var constant = QTopo.constant.node;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case constant.TEXT:\r\n            newNode = new Node.Text.constructor(config);\r\n            break;\r\n        case constant.SHAPE:\r\n            newNode = new Node.Shape.constructor(config);\r\n            break;\r\n        default:\r\n            newNode = new Node.Image.constructor(config);\r\n    }\r\n    if (newNode && newNode.jtopo) {\r\n        addJTopo.call(this, newNode);\r\n        this.children.node.push(newNode);\r\n        return newNode;\r\n    } else {\r\n        QTopo.util.error("create Node error", config);\r\n        return false;\r\n    }\r\n};\r\n/**\r\n *  根据配置在两个元素之间绘制新的链接\r\n *  @method createLink\r\n *  @param [config] {object}\r\n *  无参则根据全局配置绘制QTopo.constant.link.DIRECT对应的链接,\r\n *\r\n *  config.type可指定绘制链接类型\r\n *\r\n *  参考QTopo.contant.link选择可绘制的种类\r\n *  @return {Link|boolean} 创建成功返回链接对象，失败返回false\r\n */\r\nScene.prototype.createLink = function (config) {\r\n    var newLink;\r\n    var constant = QTopo.constant.link;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case constant.CURVE:\r\n            newLink = new Link.Curve.constructor(config);\r\n            break;\r\n        case constant.FLEXIONAL:\r\n            newLink = new Link.Flexional.constructor(config);\r\n            break;\r\n        case constant.FOLD:\r\n            newLink = new Link.Fold.constructor(config);\r\n            break;\r\n        default:\r\n            newLink = new Link.Direct.constructor(config);\r\n    }\r\n    if (newLink && newLink.jtopo) {\r\n        addJTopo.call(this, newLink);\r\n        this.children.link.push(newLink);\r\n        return newLink;\r\n    } else {\r\n        QTopo.util.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\n//--\r\n/**\r\n *  根据配置在两个元素之间创建链接,若两元素已有链接则原链接计数上加1,\r\n *  可操作于有展开功能的链接上，可自适应选择添加新链接或计数+1\r\n *  @method addLink\r\n *  @param config {object} 创建新链接时所依赖的配置，可参考createLink函数\r\n *  @param [fn] {function} 判断两元素间无链接时的可选操作，若无则调用createLink函数建立链接\r\n *  @return {Link|boolean} 创建成功返回链接对象，失败返回false\r\n */\r\nScene.prototype.addLink = function (config, fn) {\r\n    if (config && config.start && config.end) {\r\n        var links = this.linksBetween(config.start, config.end);//按number属性从大到小排列\r\n        if (links.length == 0) {\r\n            if ($.isFunction(fn)) {\r\n                fn();\r\n            } else {\r\n                return this.createLink(config);\r\n            }\r\n        } else {\r\n            //两点之间连线为1则认为是已有链接，超过1则认为是可以展开且已经展开的直线\r\n            var number = 1;\r\n            if ($.isNumeric(config.number)) {\r\n                number = parseInt(config.number);\r\n                if (number < 1) {\r\n                    number = 1;\r\n                }\r\n            }\r\n            if (links.length == 1) {\r\n                links[0].set({\r\n                    number: links[0].attr.number + number\r\n                });\r\n                return links[0];\r\n            } else if (links.length > 1) {\r\n                var parent = links[0].parent;\r\n                if (parent) {\r\n                    parent.attr.number += number;\r\n                    parent.addChild(number);\r\n                }\r\n                return parent;\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n *\r\n *  获取两元素之间所有的链接\r\n *  @method linksBetween\r\n *  @param start {element} 元素，起始无关\r\n *  @param end {element} 元素，起始无关\r\n *  @return {array} 元素间的链接集合，按链接的计数右大到小排列\r\n */\r\nScene.prototype.linksBetween = function (start, end) {\r\n    var result = [];\r\n    var links = start.links;\r\n    //检测两元素间的连线是否已有\r\n    if ($.isArray(links.out)) {\r\n        $.each(links.out, function (i, linkOut) {\r\n            if (linkOut.path.end == end) {\r\n                result.push(linkOut);\r\n            }\r\n        });\r\n    }\r\n    if ($.isArray(links.in)) {\r\n        $.each(links.in, function (j, linkIn) {\r\n            if (linkIn.path.start == end) {\r\n                result.push(linkIn);\r\n            }\r\n        });\r\n    }\r\n    return result.sort(function (a, b) {\r\n        return b.attr.number - a.attr.number;\r\n    });\r\n};\r\n//--\r\n/**\r\n *\r\n *  在图层上绘制不可以移动的线元素\r\n *  @method createLine\r\n *  @param [config] {object} 配置参数,若无则按全局配置创建\r\n *  @return {Line|boolean} 创建成功返回线元素，失败返回false\r\n */\r\nScene.prototype.createLine = function (config) {\r\n    var newLine;\r\n    var constant = QTopo.constant.line;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newLine = new Line.Direct.constructor(config);\r\n    }\r\n    if (newLine && newLine.jtopo) {\r\n        addJTopo.call(this, newLine);\r\n        this.children.line.push(newLine);\r\n        return newLine;\r\n    } else {\r\n        QTopo.util.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\n//--\r\n/**\r\n *\r\n *  在图层上绘制分组元素\r\n *  @method createContainer\r\n *  @param [config] {object} 配置参数,若无则按全局配置创建\r\n *  @return {container|boolean} 创建成功返回线元素，失败返回false\r\n */\r\nScene.prototype.createContainer = function (config) {\r\n    var newContainer;\r\n    var constant = QTopo.constant.container;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newContainer = new Container.Group.constructor(config);\r\n    }\r\n    if (newContainer && newContainer.jtopo) {\r\n        //分组只加入其本身，切换节点不作数\r\n        var nodeConfig = {};\r\n        if (config.toggle) {\r\n            nodeConfig = config.toggle\r\n        }\r\n        //可选禁用分组切换\r\n        if (!(config.toggle && typeof config.toggle.close == "boolean" && config.toggle.close)) {\r\n            addToggle(this, newContainer, nodeConfig);\r\n        }\r\n        this.children.container.push(newContainer);\r\n        addJTopo.call(this, newContainer);\r\n        return newContainer;\r\n    } else {\r\n        QTopo.util.error("create Container error", config);\r\n        return false;\r\n    }\r\n};\r\nfunction addToggle(scene, container, configToggle) {\r\n    configToggle.useType = QTopo.constant.CASUAL;//标记用途\r\n    container.toggleTo = new Node.Image.constructor(configToggle);\r\n    container.toggleTo.toggleTo = container;//互相索引\r\n    container.toggleTo.hide();//初始隐藏\r\n    addJTopo.call(scene, container.toggleTo);//加入画布\r\n}\r\n//--\r\n//-\r\n/**\r\n *\r\n *  删除图层内元素,元素删除其上的链接也会删除和更新\r\n *  @method remove\r\n *  @param element {element}\r\n */\r\nScene.prototype.remove = function (element) {\r\n    var self = this;\r\n    if (element) {\r\n        if ($.isArray(element)) {\r\n            $.each(element, function (i, item) {\r\n                removeOnce(item);\r\n            });\r\n        } else {\r\n            removeOnce(element);\r\n        }\r\n        function removeOnce(oneElement) {\r\n            if (oneElement.jtopo) {\r\n                switch (oneElement.getType()) {\r\n                    case QTopo.constant.NODE:\r\n                        if (QTopo.util.arrayDelete(self.children.node, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeNode.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.LINK:\r\n                        if (QTopo.util.arrayDelete(self.children.link, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeLink.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.LINE:\r\n                        if (QTopo.util.arrayDelete(self.children.line, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeLine.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.CONTAINER:\r\n                        if (QTopo.util.arrayDelete(self.children.container, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeContainer.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nfunction upDataLinks(element) {\r\n    var links = element.links;\r\n    if (links) {\r\n        //更新其上连线的另一方的links属性\r\n        while (links.in.length > 0) {\r\n            this.remove(links.in.pop());\r\n        }\r\n        while (links.out.length > 0) {\r\n            this.remove(links.out.pop());\r\n        }\r\n    }\r\n}\r\n//线上删除时候,要更新node和container中的links属性\r\nfunction removeLink(link) {\r\n    try {\r\n        QTopo.util.arrayDelete(link.path.start.links.out, link);\r\n        QTopo.util.arrayDelete(link.path.end.links.in, link);\r\n        removeJTopo.call(this, link);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeLink error", e);\r\n    }\r\n}\r\nfunction removeLine(line) {\r\n    try {\r\n        removeJTopo.call(this, line);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeLine error", e);\r\n    }\r\n}\r\nfunction removeNode(node) {\r\n    //刷新一下现有的线\r\n    try {\r\n        //更新其上线另一头的links属性\r\n        upDataLinks.call(this, node);\r\n        //要更新其父的children属性,父删除子\r\n        if (node.parent && $.isArray(node.parent.children)) {\r\n            node.parent.remove(node);\r\n        }\r\n        //删除分组切换的节点时同时删除其切换的分组\r\n        if (node.toggleTo) {\r\n            //分组若隐藏了,应该展示\r\n            node.toggleTo.toggle();\r\n            this.remove(node.toggleTo);\r\n        }\r\n        removeJTopo.call(this, node);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeNode error", e);\r\n    }\r\n}\r\n//容器删除时,要更与其相连的线的另一端的links属性,要更新其子类的parent属性\r\nfunction removeContainer(container) {\r\n    try {\r\n        //分组若隐藏了,应该展示\r\n        container.toggle(true);\r\n        //更新其上线另一头的links属性\r\n        upDataLinks.call(this, container);\r\n        //更新子元素的Parent属性\r\n        if ($.isArray(container.children) && container.children.length > 0) {\r\n            for (var i = 0; i < container.children.length; i++) {\r\n                container.children[i].parent = null;\r\n            }\r\n        }\r\n        //删除分组同时删除其切换节点\r\n        if (container.toggleTo) {\r\n            this.remove(container.toggleTo);\r\n        }\r\n        removeJTopo.call(this, container);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeContainer error", e);\r\n    }\r\n}\r\n//-\r\n/**\r\n *\r\n *  图层信息转化为json\r\n *  @method toJson\r\n *  @return {object}\r\n */\r\nScene.prototype.toJson = function () {\r\n    var json = $.extend({}, this.attr);\r\n    json.extra = $.extend({}, this.extra);\r\n    return json;\r\n};\r\n/**\r\n *\r\n *  判断元素是否在当前图层内\r\n *  @method isChildren\r\n *  @param element {element}\r\n *  @return {boolean}\r\n */\r\nScene.prototype.isChildren = function (element) {\r\n    var result = false;\r\n    if (element.jtopo) {\r\n        $.each(this.children, function (name, arr) {\r\n            if (arr.indexOf(element) > -1) {\r\n                result = true;\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n};\r\n/**\r\n *\r\n * 图层缩放,元素一屏显示\r\n *  @method goCenter\r\n */\r\nScene.prototype.goCenter = function () {\r\n    if (this.jtopo.childs && this.jtopo.childs.length > 0) {\r\n        this.jtopo.stage.centerAndZoom();\r\n    }\r\n};\r\n/**\r\n *\r\n * 图层缩放\r\n *  @method resize\r\n *  @param size {number} 根据比例放大或缩小 参数可 0-1缩小 1-n放大\r\n */\r\nScene.prototype.resize = function (size) {\r\n    if ($.isNumeric(size)) {\r\n        this.jtopo.scaleX = size;\r\n        this.jtopo.scaleY = size;\r\n    }\r\n};\r\n/**\r\n *\r\n * 启用/禁用鼠标缩放\r\n *  @method toggleZoom\r\n */\r\nScene.prototype.toggleZoom = function () {\r\n    if (!this.jtopo.stage.wheelZoom) {\r\n        this.jtopo.stage.wheelZoom = 0.85; // 设置鼠标缩放比例\r\n    } else {\r\n        this.jtopo.stage.wheelZoom = null;\r\n    }\r\n};\r\n/**\r\n *\r\n * 启用/禁用鹰眼\r\n *  @method toggleEagleEye\r\n */\r\nScene.prototype.toggleEagleEye = function () {\r\n    this.jtopo.stage.eagleEye.visible = !this.jtopo.stage.eagleEye.visible;\r\n};\r\n/**\r\n *\r\n * 获取当前图层的png格式图片在新的窗口打开\r\n *  @method getPicture\r\n */\r\nScene.prototype.getPicture = function () {\r\n    //stage.saveImageInfo();\r\n    //在新页面打开图片\r\n    var image = this.jtopo.stage.canvas.toDataURL("image/png");\r\n    var w = window.open(\'about:blank\', \'image from canvas\');\r\n    w.document.write("<img src=\'" + image + "\' alt=\'from canvas\'/>");\r\n    //下载图片\r\n    // here is the most important part because if you dont replace you will get a DOM 18 exception.\r\n    // var image =  stage.canvas.toDataURL("image/png").replace("image/png", "image/octet-stream;Content-Disposition: attachment;filename=foobar.png");\r\n    //var image = stage.canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");\r\n    //window.location.href=image; // it will save locally\r\n};\r\n/**\r\n * 切换元素的层次\r\n * @method toggleZIndex\r\n * @param element 待控制元素\r\n * @param [flag] true为降低false为提升，无参则默认提升，若已提升到最高则降至最低\r\n */\r\nScene.prototype.toggleZIndex = function (element, flag) {\r\n    if (element) {\r\n        var jtopo = element.jtopo;\r\n        var scene = this.jtopo;\r\n        if (jtopo && scene) {\r\n            var map = scene.zIndexMap[jtopo.zIndex];\r\n            var index = map.indexOf(jtopo);\r\n            var todo = true;\r\n            if (typeof flag == \'boolean\') {\r\n                todo = flag;\r\n            } else {\r\n                if (index == map.length - 1) {\r\n                    todo = false;\r\n                }\r\n            }\r\n            if (todo) {\r\n                //提升层次\r\n                map.push(map[index]);\r\n                map.splice(index, 1);\r\n\r\n            } else {\r\n                //降低层次\r\n                map.splice(0, 0, map[index]);\r\n                map.splice(index + 1, 1);\r\n            }\r\n        }\r\n    }\r\n};\r\nvar selectedCatch = {\r\n    jtopo: [],\r\n    qtopo: []\r\n};\r\n/**\r\n * 获取被选中的元素\r\n * @method getSelected\r\n * @return {array} 返回图层中被选中的元素\r\n */\r\nScene.prototype.getSelected = function () {\r\n    var jtopo = this.jtopo.selectedElements;\r\n    if ($.isArray(jtopo)) {\r\n        if (selectedCatch.jtopo != jtopo) {\r\n            selectedCatch.jtopo = jtopo;\r\n            selectedCatch.qtopo = [];\r\n            jtopo.forEach(function (el) {\r\n                if (el.qtopo && el.qtopo.getUseType() != QTopo.constant.CASUAL) {\r\n                    selectedCatch.qtopo.push(el.qtopo);\r\n                }\r\n            });\r\n        }\r\n        return selectedCatch.qtopo;\r\n    } else {\r\n        return [];\r\n    }\r\n};\r\n/**\r\n * 高亮目标隐藏其他\r\n * @method toggleLight\r\n * @param [target] 数组或对象,高亮其相关对象,无参则全部高亮\r\n * @param [flag] 若为true则只高亮传入的对象,不选则只对传入对象相关的对象高亮\r\n */\r\nScene.prototype.toggleLight = function (target, flag) {\r\n    try {\r\n        var alpha = 1;\r\n        var lighting;\r\n        if (target) {\r\n            alpha = 0.1;\r\n            if (flag) {\r\n                if ($.isArray(target)) {\r\n                    lighting = target;\r\n                } else {\r\n                    lighting = [target];\r\n                }\r\n            } else {\r\n                if ($.isArray(target)) {\r\n                    lighting = getConnectionLightings(target);\r\n                } else {\r\n                    lighting = getConnectionLightings([target]);\r\n                }\r\n            }\r\n        }\r\n        totalSetAlpha(this.children.node.concat(this.children.link), alpha);\r\n        totalSetAlpha(lighting, 1);\r\n    } catch (e) {\r\n        QTopo.util.error("scene toggleLight error", e);\r\n    }\r\n    function getConnectionLightings(arr) {\r\n        var lighting = [];\r\n        $.each(arr, function (i, target) {\r\n            if (target.getType() == QTopo.constant.NODE && target.getUseType() != QTopo.constant.CASUAL) {\r\n                var links = target.links;\r\n                QTopo.util.arrayPush(lighting, target);\r\n                if (links) {\r\n                    if ($.isArray(links.out)) {\r\n                        $.each(links.out, function (l, outlink) {\r\n                            QTopo.util.arrayPush(lighting, outlink);\r\n                            QTopo.util.arrayPush(lighting, outlink.path.end);\r\n                        });\r\n                    }\r\n                    if ($.isArray(links.in)) {\r\n                        $.each(links.in, function (n, inlink) {\r\n                            QTopo.util.arrayPush(lighting, inlink);\r\n                            QTopo.util.arrayPush(lighting, inlink.path.start);\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return lighting;\r\n    }\r\n\r\n    function totalSetAlpha(total, alpha) {\r\n        //全部隐藏\r\n        if ($.isArray(total)) {\r\n            $.each(total, function (i, element) {\r\n                element.set({\r\n                    alpha: alpha\r\n                });\r\n            });\r\n        }\r\n    }\r\n};\r\n/**\r\n * 正常尺寸展示，并将视角移动到以参数节点为中心的位置\r\n * @method moveToNode\r\n * @param node 节点对象\r\n */\r\nScene.prototype.moveToNode = function (node) {\r\n    // 查询到的节点居中显示\r\n    if (this.children.node.indexOf(node) > -1) {\r\n        var location = node.jtopo.getCenterLocation();\r\n        this.resize(1);\r\n        this.jtopo.setCenter(location.x, location.y);\r\n        // 闪烁几下\r\n        nodeFlash(node.jtopo, 5);\r\n    }\r\n    function nodeFlash(node, num) {\r\n        if ($.isNumeric(num)) {\r\n            if (num == 0) {\r\n                node.selected = false;\r\n            } else {\r\n                node.selected = !node.selected;\r\n                setTimeout(function () {\r\n                    nodeFlash(node, num - 1);\r\n                }, 300);\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n * 自动布局\r\n * @method autoLayout\r\n * @param config 自动布局配置参数\r\n * @example\r\n *      参数配置:\r\n *          config:{\r\n *              type:\r\n *                  1.\'round\'   无需其他配置\r\n *                  2.\'default\' 需配置行数，列间距，行间距\r\n *              rows:行数\r\n *              rowSpace:行间距\r\n *              columnSpace:列间距\r\n *          }\r\n */\r\nScene.prototype.autoLayout = function (config) {\r\n    if (config && config.type) {\r\n        var needSort = [];\r\n        var jtopos = [];\r\n        this.children.node.forEach(function (v) {\r\n            if (!v.parent) {\r\n                needSort.push(v);\r\n                jtopos.push(v.jtopo);\r\n            }\r\n        });\r\n        switch (config.type) {\r\n            case "round":\r\n                layout_round(this.jtopo, jtopos);\r\n                break;\r\n            case "default":\r\n                layout_default(needSort, parseInt(config.rows), parseInt(config.rowSpace), parseInt(config.columnSpace), this.getOrigin());\r\n                break;\r\n        }\r\n    }\r\n};\r\nfunction layout_round(scene, jtopos) {\r\n    JTopo.layout.circleLayoutNodes(jtopos, {animate: {time: 1000}});\r\n}\r\nfunction layout_default(elements, rows, rowSpace, columnSpace, begin) {\r\n    if ($.isNumeric(rows)) {\r\n        rows = parseInt(rows);\r\n        if (rows < 1) {\r\n            rows = 1;\r\n        }\r\n        $.each(elements.sort(function (a, b) {\r\n            return getDegree(b) - getDegree(a);\r\n        }), function (i, v) {\r\n            //v.setLocation(begin.x + (i % rows) * columnSpace, begin.y);\r\n            move(v, begin.x + (i % rows) * columnSpace, begin.y);\r\n            if ((i + 1) % rows == 0) {\r\n                begin.y += rowSpace;\r\n            }\r\n        });\r\n    }\r\n}\r\n//-------工具函数\r\n//获取节点的度\r\nfunction getDegree(node) {\r\n    var inLinks = node.links.in;\r\n    var outLinks = node.links.out;\r\n    var degree = 0;\r\n    if (inLinks.length == 1) {\r\n        degree += inLinks[0].attr.number;\r\n    } else {\r\n        degree += inLinks.length;\r\n    }\r\n    if (outLinks.length == 1) {\r\n        degree += outLinks[0].attr.number;\r\n    } else {\r\n        degree += outLinks.length;\r\n    }\r\n    return degree;\r\n}\r\n//移动动画\r\nfunction move(node, targetX, targetY) {\r\n    targetX = parseInt(targetX);\r\n    targetY = parseInt(targetY);\r\n    var x = node.attr.position[0];\r\n    var y = node.attr.position[1];\r\n    var partX = parseInt((targetX - x)) / 10;\r\n    var partY = parseInt((targetY - y)) / 10;\r\n    var part = 0;\r\n    var temp = setInterval(function () {\r\n        if (Math.abs(targetX - x) > 1) {\r\n            x += partX;\r\n        }\r\n        if (Math.abs(targetY - y) > 1) {\r\n            y += partY;\r\n        }\r\n        node.setPosition([parseInt(x), parseInt(y)]);\r\n        part++;\r\n        if (Math.abs(targetX - x) <= 1 && Math.abs(targetY - y) <= 1) {\r\n            clearInterval(temp);\r\n        } else if (part >= 10) {\r\n            clearInterval(temp);\r\n        }\r\n    }, 100);\r\n}\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvU2NlbmUuanM/OWVjOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0Isb0JBQW9CO0FBQ3BCLG9CQUFvQjtBQUNwQix5QkFBeUI7QUFDekIsb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsT0FBTztBQUN2QixjQUFjLGNBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsY0FBYztBQUNsQyxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QixtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEIsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLE9BQU87QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0EsZUFBZSxTQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QixtQkFBbUIsT0FBTztBQUMxQixhQUFhLE1BQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsYUFBYTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsT0FBTztBQUMxQixpQkFBaUIsU0FBUztBQUMxQixhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixRQUFRO0FBQzFCLGdCQUFnQixRQUFRO0FBQ3hCLGFBQWEsTUFBTTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixPQUFPO0FBQzVCLGFBQWEsYUFBYTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsT0FBTztBQUM1QixhQUFhLGtCQUFrQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pEO0FBQ0EsNENBQTRDO0FBQzVDLDhCQUE4QjtBQUM5Qiw2Q0FBNkM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLCtCQUErQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQiw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUMsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlHQUFpRyxnQ0FBZ0M7QUFDakk7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxNQUFNO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLFVBQVUsWUFBWTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTCIsImZpbGUiOiI5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLy8tXHJcbnZhciBOb2RlID0ge1xyXG4gICAgSW1hZ2U6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbm9kZS9JbWFnZS5qc1wiKSxcclxuICAgIFRleHQ6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbm9kZS9UZXh0LmpzXCIpLFxyXG4gICAgU2hhcGU6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbm9kZS9TaGFwZS5qc1wiKVxyXG59O1xyXG52YXIgTGluayA9IHtcclxuICAgIEN1cnZlOiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvQ3VydmUuanNcIiksXHJcbiAgICBEaXJlY3Q6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluay9EaXJlY3QuanNcIiksXHJcbiAgICBGbGV4aW9uYWw6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluay9GbGV4aW9uYWwuanNcIiksXHJcbiAgICBGb2xkOiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvRm9sZC5qc1wiKVxyXG59O1xyXG5cclxudmFyIExpbmUgPSB7XHJcbiAgICBEaXJlY3Q6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluZS9EaXJlY3QuanNcIilcclxufTtcclxudmFyIENvbnRhaW5lciA9IHtcclxuICAgIEdyb3VwOiByZXF1aXJlKFwiLi9lbGVtZW50L2NvbnRhaW5lci9Hcm91cC5qc1wiKVxyXG59O1xyXG52YXIgZXZlbnRzID0gcmVxdWlyZShcIi4vZXZlbnRzLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IFNjZW5lO1xyXG4vLy1cclxuLy/nlLvluIPlr7nosaFcclxudmFyIGRlZmF1bHRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBtb2RlOiBRVG9wby5jb25zdGFudC5tb2RlLk5PUk1BTCxcclxuICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6IFwiXCJcclxuICAgIH07XHJcbn07XHJcbi8qKlxyXG4gKiDlm77lsYLlr7nosaFcclxuICogQGNsYXNzIFNjZW5lXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAcGFyYW0gY2FudmFzIOe7mOWbvuaJgOWcqOeahGNhbnZhc+agh+etvuWvueixoVxyXG4gKiBAcGFyYW0gY29uZmlnIOWbvuWxgueahOWfuuacrOiuvue9rizlj4Lop4FhdHRy5bGe5oCnXHJcbiAqL1xyXG5mdW5jdGlvbiBTY2VuZShjYW52YXMsIGNvbmZpZykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmoLjlv4NKdG9wb+WvueixoVxyXG4gICAgICogQHByb3BlcnR5IGp0b3BvIHtPYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHNlbGYuanRvcG8gPSBuZXcgSlRvcG8uU2NlbmUoKTtcclxuICAgIHNlbGYuanRvcG8ucXRvcG8gPSBzZWxmO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlm77lsYLkuK3mnInmlYjorrDlvZXnmoTlhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBjaGlsZHJlbiB7b2JqZWN0fVxyXG4gICAgICogQHBhcmFtIG5vZGUge2FycmF5fVxyXG4gICAgICogQHBhcmFtIGxpbmsge2FycmF5fVxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lciB7YXJyYXl9XHJcbiAgICAgKiBAcGFyYW0gbGluZSB7YXJyYXl9XHJcbiAgICAgKi9cclxuICAgIHNlbGYuY2hpbGRyZW4gPSB7XHJcbiAgICAgICAgbm9kZTogW10sXHJcbiAgICAgICAgbGluazogW10sXHJcbiAgICAgICAgY29udGFpbmVyOiBbXSxcclxuICAgICAgICBsaW5lOiBbXVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Zu+5bGC55qE5Li76KaB5bGe5oCnXHJcbiAgICAgKiBAcHJvcGVydHkgYXR0ciB7b2JqY2V0fVxyXG4gICAgICogQHBhcmFtIFttb2RlPVFUb3BvLmNvbnN0YW50Lm1vZGUuTk9STUFMXSxcclxuICAgICAqIEBwYXJhbSBbYmFja2dyb3VuZEltYWdlPScnXSxcclxuICAgICAqIEBwYXJhbSBbYmFja2dyb3VuZENvbG9yPScnXSxcclxuICAgICAqL1xyXG4gICAgc2VsZi5hdHRyID0gZGVmYXVsdHMoKTtcclxuICAgIC8qKlxyXG4gICAgICog5Zu+5bGC55qE6aKd5aSW5bGe5oCnXHJcbiAgICAgKiBAcHJvcGVydHkgZXh0cmEge29iamNldH1cclxuICAgICAqL1xyXG4gICAgc2VsZi5leHRyYSA9IGNvbmZpZy5leHRyYSB8fCB7fTtcclxuICAgIG5ldyBKVG9wby5TdGFnZShjYW52YXMpLmFkZChzZWxmLmp0b3BvKTtcclxuICAgIGV2ZW50cy5pbml0KHNlbGYpO1xyXG4gICAgLy/lu7bml7bmiafooYxcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5iYWNrZ3JvdW5kSW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0QmFja2dyb3VuZEltYWdlKGNvbmZpZy5iYWNrZ3JvdW5kSW1hZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb25maWcuYmFja2dyb3VuZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNldEJhY2tncm91bmRDb2xvcihjb25maWcuYmFja2dyb3VuZENvbG9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29uZmlnLm1vZGUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0TW9kZShjb25maWcubW9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4vLy1cclxuLyoqXHJcbiAqICDojrflj5blm77lsYLnmoTln7rmnKzlsZ7mgKdcclxuICogIEBtZXRob2QgZ2V0XHJcbiAqICBAcGFyYW0ga2V5IHtzdHJpbmd9IOimgeiOt+WPlueahOWxnuaAp+WQjVxyXG4gKiAgQHJldHVybnMge3N0cmluZ3xvYmplY3R9IOWxnuaAp+WAvFxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAgc2NlbmUuZ2V0KCdtb2RlJykgICAgICAgLy9cIm5vcm1hbFwiXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgcmV0dXJuIHRoaXMuYXR0cltrZXldO1xyXG59O1xyXG4vKipcclxuICogIOiOt+WPluWbvuWxgueahOWxnuaApyzmiJbmt7vliqAv5L+u5pS56aKd5aSW5bGe5oCnXHJcbiAqICBAbWV0aG9kIHZhbFxyXG4gKiAgQHBhcmFtIGtleSB7c3RyaW5nfVxyXG4gKlxyXG4gKiAg6KaB5pON5L2c55qE5bGe5oCn5ZCNLOS4jmdldOS4jeWQjO+8jOivpeWHveaVsOS8muWcqOaVtOS4quWvueixoeS4reafpeaJvuS4jmtleeWMuemFjeeahOWxnuaAp1xyXG4gKiAg5peg6K665piv6aKd5aSW5bGe5oCn6L+Y5piv5Z+65pys5bGe5oCn5Y+I5oiW5pivU2NlbmUueHjlsZ7mgKfvvIzlj6ropoHljLnphY3miJDlip/ljbPov5Tlm54uXHJcbiAqICDkvJjlhYjnuqfkuLog6aKd5aSW5bGe5oCnPuWfuuacrOWxnuaApz5TY2VuZS54eOWxnuaAp1xyXG4gKlxyXG4gKiAg55So6K+l5Ye95pWw6LWL5LqI6aKd5aSW5bGe5oCn5pe277yM5Y+v5Lul55u05o6l5Lyg5YWl5LiA5Liq5a+56LGh5L2c5Li65Y+C5pWwXHJcbiAqICDor6Xlh73mlbDkvJrpgY3ljobor6Xlj4LmlbDlr7nosaHlsIblhbblhoXlrrnlhajpg6jopobnm5bliLDpop3lpJblsZ7mgKfkuIpcclxuICpcclxuICogIEBwYXJhbSBbdmFsdWVdIHtzdHJpbmd8b2JqZWN0fSDlsZ7mgKflgLzvvIzoi6Xml6DliJnlh73mlbDkuLrojrflj5blsZ7mgKfvvIzoi6XmnInliJnkuLrkv67mlLkv5re75Yqg5bGe5oCnXHJcbiAqICBAcmV0dXJucyB7c3RyaW5nfG9iamVjdHx2b2lkfVxyXG4gKiAgQGV4YW1wbGVcclxuICpcclxuICogICAgICAg6LWL5YC85pON5L2cICAgMS4gc2NlbmUudmFsKCdwaWQnLCcxMjM0NScpXHJcbiAqICAgICAgICAgICAgICAgICAgMi4gc2NlbmUudmFsKHtcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHBpZDpcIjEyMzQ1XCIsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOltdXHJcbiAqICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAqICAgICAgIOWPluWxnuaAp+aTjeS9nCBzY2VuZS52YWwoJ3BpZCcpICAgICAgIC8vXCIxMjM0NVwiXHJcbiAqICAgICAgICAgICAgICAgICAgc2NlbmUudmFsKCdwb3NpdGlvbicpIC8vdW5kZWZpbmVkXHJcbiAqICAgICAgICAgICAgICAgICAgc2NlbmUudmFsKCdwYXRoJykgICAgICAgLy9bXVxyXG4gKiAgICAgICAgICAgICAgICAgIHNjZW5lLnZhbCgnbW9kZScpICAgICAgIC8vXCJub3JtYWxcIlxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnZhbCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICBpZiAoUVRvcG8udXRpbC5nZXRDbGFzcyhrZXkpID09ICdPYmplY3QnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQuZWFjaChrZXksIGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBzZWxmLmV4dHJhW25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgfSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5leHRyYVtrZXldKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmV4dHJhW2tleV07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hdHRyW2tleV0pIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuYXR0cltrZXldO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5leHRyYVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOmFjee9ruWbvuWxguS4reWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiAgQG1ldGhvZCBzZXREZWZhdWx0XHJcbiAqICBAcGFyYW0gdHlwZSB7c3RyaW5nfSDopoHphY3nva7nmoTlhYPntKDnsbvlnosg5L6L77yaUVRvcG8uY29uc3RhbnQubm9kZS5JTUFHRVxyXG4gKiAgQHBhcmFtIGNvbmZpZyB7b2JqZWN0fSDmoLflvI/lsZ7mgKfvvIzlj6/lj4LogIPlr7nlupTnmoTlhYPntKBhdHRy5bGe5oCnXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuc2V0RGVmYXVsdCA9IGZ1bmN0aW9uICh0eXBlLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudDtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLklNQUdFOlxyXG4gICAgICAgICAgICAgICAgTm9kZS5JbWFnZS5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLlRFWFQ6XHJcbiAgICAgICAgICAgICAgICBOb2RlLlRleHQuc2V0RGVmYXVsdChjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5ESVJFQ1Q6XHJcbiAgICAgICAgICAgICAgICBMaW5rLkRpcmVjdC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkNVUlZFOlxyXG4gICAgICAgICAgICAgICAgTGluay5DdXJ2ZS5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkZMRVhJT05BTDpcclxuICAgICAgICAgICAgICAgIExpbmsuRmxleGlvbmFsLnNldERlZmF1bHQoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmxpbmsuRk9MRDpcclxuICAgICAgICAgICAgICAgIExpbmsuRm9sZC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5lLkRJUkVDVDpcclxuICAgICAgICAgICAgICAgIExpbmUuRGlyZWN0LnNldERlZmF1bHQoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmNvbnRhaW5lci5HUk9VUDpcclxuICAgICAgICAgICAgICAgIENvbnRhaW5lci5Hcm91cC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5Zu+5bGC5Lit5YWD57Sg5YWo5bGA5qC35byPXHJcbiAqICBAbWV0aG9kIGdldERlZmF1bHRcclxuICogIEBwYXJhbSB0eXBlIHtzdHJpbmd9IOimgemFjee9rueahOWFg+e0oOexu+WeiyDkvovvvJpRVG9wby5jb25zdGFudC5ub2RlLklNQUdFXHJcbiAqICBAcmV0dXJuIHtvYmplY3R9IOagt+W8j+WxnuaAp++8jOWPr+WPguiAg+WvueW6lOeahOWFg+e0oGF0dHLlsZ7mgKdcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgIGlmICh0eXBlKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudDtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLklNQUdFOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTm9kZS5JbWFnZS5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLlRFWFQ6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBOb2RlLlRleHQuZ2V0RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5ESVJFQ1Q6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBMaW5rLkRpcmVjdC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkNVUlZFOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTGluay5DdXJ2ZS5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkZMRVhJT05BTDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IExpbmsuRmxleGlvbmFsLmdldERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmxpbmsuRk9MRDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IExpbmsuRm9sZC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5lLkRJUkVDVDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IExpbmUuRGlyZWN0LmdldERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmNvbnRhaW5lci5HUk9VUDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IENvbnRhaW5lci5Hcm91cC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lm77lsYLog4zmma/lm77niYfvvIzkuI5zZXRCYWNrZ3JvdW5kQ29sb3LlhrLnqoFcclxuICogIEBtZXRob2Qgc2V0QmFja2dyb3VuZEltYWdlXHJcbiAqICBAcGFyYW0gaW1hZ2Uge3N0cmluZ30g5Zu+54mHdXJsXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuc2V0QmFja2dyb3VuZEltYWdlID0gZnVuY3Rpb24gKGltYWdlKSB7XHJcbiAgICB0aGlzLmp0b3BvLmJhY2tncm91bmQgPSBpbWFnZTtcclxuICAgIHRoaXMuYXR0ci5iYWNrZ3JvdW5kID0gaW1hZ2U7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5Zu+5bGC6IOM5pmv6aKc6Imy77yM5LiOc2V0QmFja2dyb3VuZEltYWdl5Yay56qBXHJcbiAqICBAbWV0aG9kIHNldEJhY2tncm91bmRDb2xvclxyXG4gKiAgQHBhcmFtIGNvbG9yIHtzdHJpbmd9ICN4eHh4eHgvMjU1LDI1NSwyNTVcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5zZXRCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgIHRoaXMuanRvcG8uYmFja2dyb3VuZENvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvcik7XHJcbiAgICB0aGlzLmp0b3BvLmFscGhhID0gMTtcclxuICAgIHRoaXMuYXR0ci5iYWNrZ3JvdW5kID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvcik7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5Zu+5bGC5qih5byPXHJcbiAqICBAbWV0aG9kIHNldE1vZGVcclxuICogIEBwYXJhbSBtb2RlIHtzdHJpbmd9IOS+izpRVG9wby5jb25zdGFudC5tb2RlLk5PUk1BTFxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnNldE1vZGUgPSBmdW5jdGlvbiAobW9kZSkge1xyXG4gICAgaWYgKFtcIm5vcm1hbFwiLCBcImVkaXRcIiwgXCJkcmFnXCIsIFwic2VsZWN0XCJdLmluZGV4T2YobW9kZSkgPiAtMSkge1xyXG4gICAgICAgIHRoaXMuYXR0ci5tb2RlID0gbW9kZTtcclxuICAgICAgICB0aGlzLmp0b3BvLm1vZGUgPSBtb2RlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic2V0IHdyb25nIG1vZGUgOlwiLCBtb2RlKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDlm77lsYLmuIXnqbrvvIzmuIXpmaTlm77lsYLlhoXmiYDmnInlhYPntKBcclxuICogIEBtZXRob2QgY2xlYXJcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIFFUb3BvLnV0aWwuaW5mbyhcInNjZW5lIGNsZWFyXCIpO1xyXG4gICAgdGhpcy5jaGlsZHJlbiA9IHtcclxuICAgICAgICBub2RlOiBbXSxcclxuICAgICAgICBsaW5rOiBbXSxcclxuICAgICAgICBjb250YWluZXI6IFtdLFxyXG4gICAgICAgIGxpbmU6IFtdXHJcbiAgICB9O1xyXG4gICAgdGhpcy5qdG9wby5jbGVhcigpO1xyXG59O1xyXG4vKipcclxuICogIOiOt+WPluexu+Wei++8jOW4uOeUqOWcqOWPs+mUruiPnOWNleS4iuWvueinpuWPkeWvueixoeeahOivhuWIq1xyXG4gKiAgQG1ldGhvZCBnZXRUeXBlXHJcbiAqICBAcmV0dXJuIFFUb3BvLmNvbnN0YW50LlNDRU5FXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBRVG9wby5jb25zdGFudC5TQ0VORTtcclxufTtcclxuLyoqXHJcbiAqICDojrflj5bkvb/nlKjnsbvlnovvvIzluLjnlKjlnKjlj7PplK7oj5zljZXkuIrlr7nop6blj5Hlr7nosaHnmoTor4bliKtcclxuICogIEBtZXRob2QgZ2V0VXNlVHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5TQ0VORVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdldFVzZVR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuU0NFTkU7XHJcbn07XHJcbi8qKlxyXG4gKiAg57uR5a6a5LqL5Lu277yM5Y+v55Sob2Zm5Yig6Zmk5a+55bqU5LqL5Lu2XHJcbiAqICBAbWV0aG9kIG9uXHJcbiAqICBAcGFyYW0gbmFtZSB7c3RyaW5nfSDkuovku7blkI1cclxuICpcclxuICogIGNsaWNrLGRiY2xpY2ssbW91c2Vkb3duLG1vdXNldXAsbW91c2VvdmVyLG1vdXNlb3V0LG1vdXNlbW92ZSxtb3VzZWRyYWcsbW91c2V3aGVlbCx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZCxrZXlkb3duLGtleXVwXHJcbiAqXHJcbiAqICBAcGFyYW0gZm4ge2Z1bmN0aW9ufSDlpITnkIblh73mlbBcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChuYW1lLCBmbikge1xyXG4gICAgdGhpcy5qdG9wby5hZGRFdmVudExpc3RlbmVyKG5hbWUsIGZuKTtcclxufTtcclxuLyoqXHJcbiAqICDliKDpmaTkuovku7bvvIzlj6/liKDpmaRvbue7keWumueahOS6i+S7tlxyXG4gKiAgQG1ldGhvZCBvZmZcclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9IOS6i+S7tuWQjVxyXG4gKlxyXG4gKiAgY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcclxuICpcclxuICogIEBwYXJhbSBbZm5de2Z1bmN0aW9ufSDlpITnkIbnmoTlh73mlbDlr7nosaHvvIzoi6Xml6Dlj4LliJnliKDpmaTor6Xkuovku7bkuIvmiYDmnInlh73mlbBcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgIHRoaXMuanRvcG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBmbik7XHJcbn07XHJcbi8qKlxyXG4gKiAg5qC55o2u5pCc57Si5b2T5YmN5Zu+5bGC77yM5p+l5om+5Z+65pys5bGe5oCn5oiW6aKd5aSW5bGe5oCn5ruh6Laz5p2h5Lu255qE5YWD57SgXHJcbiAqICBAbWV0aG9kIGZpbmRcclxuICogIEBwYXJhbSBzY2FuIHtzdHJpbmd9IOafpeivouadoeS7tizmoLzlvI/kuLpcImtleT12YWx1ZSxrZXk9dmFsdWVcIizlpJrkuKrmnaHku7bnlKgs5YiG5YmyXHJcbiAqICBAcGFyYW0gW3R5cGVdIHtzdHJpbmd9IOWPr+aMh+WumuWFg+e0oOexu+Wei+eyvuehruafpeaJvlxyXG4gKiAgQHJldHVybiB7YXJyYXl9IOi/lOWbnuaVsOe7hO+8jOaVsOe7hOaIkOWRmOS4uua7oei2s+iHs+WwkeS4gOS4quadoeS7tueahOWFg+e0oFxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAoc2NhbiwgdHlwZSkge1xyXG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcclxuICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgIHZhciBjb25kaXRpb24gPSB0eXBlb2Ygc2NhbiA9PSBcInN0cmluZ1wiID8gc2Nhbi5zcGxpdChcIixcIikgOiBbXTtcclxuICAgIGlmIChjb25kaXRpb24ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICQuZWFjaChjb25kaXRpb24sIGZ1bmN0aW9uIChpLCB0ZW1wKSB7XHJcbiAgICAgICAgICAgIHRlbXAgPSB0ZW1wLnNwbGl0KFwiPVwiKTtcclxuICAgICAgICAgICAgaWYgKHRlbXAubGVuZ3RoID49IDIpIHtcclxuICAgICAgICAgICAgICAgIC8v5Yi25a6a5LqG57G75Z6L77yM57yp5bCP5p+l5om+6IyD5Zu077yM5pyq5oyH5a6a5YiZ5YWo6YOo6YGN5Y6GXHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm9kZVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5ub2RlLCB0ZW1wWzBdLCB0ZW1wWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibGlua1wiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5saW5rLCB0ZW1wWzBdLCB0ZW1wWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY29udGFpbmVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGNoaWxkcmVuLmNvbnRhaW5lciwgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxpbmVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYW5BcnIoY2hpbGRyZW4ubGluZSwgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChjaGlsZHJlbiwgZnVuY3Rpb24gKGosIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGFyciwgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAvL+aJq+aPj+aVsOe7hOS4reWvueixoeWvueW6lOeahOWxnuaAp+aYr+WQpuebuOetiVxyXG4gICAgZnVuY3Rpb24gc2NhbkFycihhcnIsIGtleSwgdmFsdWUpIHtcclxuICAgICAgICAkLmVhY2goYXJyLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICAvL+WPquaJq+aPj+WvueixoeeahGF0dHLlkoxleHRyYeS4reeahOWxnuaAp1xyXG4gICAgICAgICAgICBpZiAoZXF1YWwoaXRlbS5leHRyYSwga2V5LCB2YWx1ZSkgfHwgZXF1YWwoaXRlbS5hdHRyLCBrZXksIHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgLy/mjpLpmaTph43lpI3nmoRcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuaW5kZXhPZihpdGVtKSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZXF1YWwob2JqZWN0LCBrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIG9iamVjdCAmJiBvYmplY3Rba2V5XSAmJiBvYmplY3Rba2V5XSA9PSB2YWx1ZTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDojrflj5blvZPliY3lm77lsYLlnKjmraPluLjop4bop5LkuIso5pyq5pS+5aSn57yp5bCPKeacgOW3puS4iuinkueahOWdkOagh1xyXG4gKiAgQG1ldGhvZCBnZXRPcmlnaW5cclxuICogIEByZXR1cm4ge29iamVjdH0g5YyF5ZCrIHgseeWxnuaAp1xyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdldE9yaWdpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgeDogMCAtIHRoaXMuanRvcG8udHJhbnNsYXRlWCxcclxuICAgICAgICB5OiAwIC0gdGhpcy5qdG9wby50cmFuc2xhdGVZXHJcbiAgICB9XHJcbn07XHJcbi8vLVxyXG5mdW5jdGlvbiBhZGRKVG9wbyhlbGVtZW50KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uYWRkKGVsZW1lbnQuanRvcG8pO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJJbiBTY2VuZSwganRvcG8gYWRkIGVycm9yIDogXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlbW92ZUpUb3BvKGVsZW1lbnQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5yZW1vdmUoZWxlbWVudC5qdG9wbyk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIkluIFNjZW5lLCBqdG9wbyByZW1vdmUgZXJyb3IgOiBcIiwgZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqICDmoLnmja7phY3nva7lnKjlvZPliY3lm77lsYLkuIrnu5jliLboioLngrlcclxuICogIEBtZXRob2QgY3JlYXRlTm9kZVxyXG4gKiAgQHBhcmFtIFtjb25maWddIHtvYmplY3R9XHJcbiAqXHJcbiAqICDml6Dlj4LliJnmoLnmja7lhajlsYDphY3nva7nu5jliLZRVG9wby5jb25zdGFudC5ub2RlLklNQUdF5a+55bqU55qE6IqC54K5LFxyXG4gKlxyXG4gKiAgY29uZmlnLnR5cGXlj6/mjIflrprnu5jliLboioLngrnnsbvlnotcclxuICpcclxuICogIOWPguiAg1FUb3BvLmNvbnRhbnQubm9kZemAieaLqeWPr+e7mOWItueahOenjeexu1xyXG4gKiAgQHJldHVybiB7Tm9kZXxib29sZWFufSDliJvlu7rmiJDlip/ov5Tlm57oioLngrnlr7nosaHvvIzlpLHotKXov5Tlm55mYWxzZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmNyZWF0ZU5vZGUgPSBmdW5jdGlvbiAoY29uZmlnKSB7XHJcbiAgICB2YXIgbmV3Tm9kZTtcclxuICAgIHZhciBjb25zdGFudCA9IFFUb3BvLmNvbnN0YW50Lm5vZGU7XHJcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSBjb25zdGFudC5URVhUOlxyXG4gICAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUuVGV4dC5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIGNvbnN0YW50LlNIQVBFOlxyXG4gICAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUuU2hhcGUuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlLkltYWdlLmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAobmV3Tm9kZSAmJiBuZXdOb2RlLmp0b3BvKSB7XHJcbiAgICAgICAgYWRkSlRvcG8uY2FsbCh0aGlzLCBuZXdOb2RlKTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLm5vZGUucHVzaChuZXdOb2RlKTtcclxuICAgICAgICByZXR1cm4gbmV3Tm9kZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNyZWF0ZSBOb2RlIGVycm9yXCIsIGNvbmZpZyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOagueaNrumFjee9ruWcqOS4pOS4quWFg+e0oOS5i+mXtOe7mOWItuaWsOeahOmTvuaOpVxyXG4gKiAgQG1ldGhvZCBjcmVhdGVMaW5rXHJcbiAqICBAcGFyYW0gW2NvbmZpZ10ge29iamVjdH1cclxuICogIOaXoOWPguWImeagueaNruWFqOWxgOmFjee9rue7mOWItlFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNU5a+55bqU55qE6ZO+5o6lLFxyXG4gKlxyXG4gKiAgY29uZmlnLnR5cGXlj6/mjIflrprnu5jliLbpk77mjqXnsbvlnotcclxuICpcclxuICogIOWPguiAg1FUb3BvLmNvbnRhbnQubGlua+mAieaLqeWPr+e7mOWItueahOenjeexu1xyXG4gKiAgQHJldHVybiB7TGlua3xib29sZWFufSDliJvlu7rmiJDlip/ov5Tlm57pk77mjqXlr7nosaHvvIzlpLHotKXov5Tlm55mYWxzZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmNyZWF0ZUxpbmsgPSBmdW5jdGlvbiAoY29uZmlnKSB7XHJcbiAgICB2YXIgbmV3TGluaztcclxuICAgIHZhciBjb25zdGFudCA9IFFUb3BvLmNvbnN0YW50Lmxpbms7XHJcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSBjb25zdGFudC5DVVJWRTpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkN1cnZlLmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgY29uc3RhbnQuRkxFWElPTkFMOlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuRmxleGlvbmFsLmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgY29uc3RhbnQuRk9MRDpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkZvbGQuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3TGluayA9IG5ldyBMaW5rLkRpcmVjdC5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG5ld0xpbmsgJiYgbmV3TGluay5qdG9wbykge1xyXG4gICAgICAgIGFkZEpUb3BvLmNhbGwodGhpcywgbmV3TGluayk7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5saW5rLnB1c2gobmV3TGluayk7XHJcbiAgICAgICAgcmV0dXJuIG5ld0xpbms7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgTGluayBlcnJvclwiLCBjb25maWcpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuLy8tLVxyXG4vKipcclxuICogIOagueaNrumFjee9ruWcqOS4pOS4quWFg+e0oOS5i+mXtOWIm+W7uumTvuaOpSzoi6XkuKTlhYPntKDlt7LmnInpk77mjqXliJnljp/pk77mjqXorqHmlbDkuIrliqAxLFxyXG4gKiAg5Y+v5pON5L2c5LqO5pyJ5bGV5byA5Yqf6IO955qE6ZO+5o6l5LiK77yM5Y+v6Ieq6YCC5bqU6YCJ5oup5re75Yqg5paw6ZO+5o6l5oiW6K6h5pWwKzFcclxuICogIEBtZXRob2QgYWRkTGlua1xyXG4gKiAgQHBhcmFtIGNvbmZpZyB7b2JqZWN0fSDliJvlu7rmlrDpk77mjqXml7bmiYDkvp3otZbnmoTphY3nva7vvIzlj6/lj4LogINjcmVhdGVMaW5r5Ye95pWwXHJcbiAqICBAcGFyYW0gW2ZuXSB7ZnVuY3Rpb259IOWIpOaWreS4pOWFg+e0oOmXtOaXoOmTvuaOpeaXtueahOWPr+mAieaTjeS9nO+8jOiLpeaXoOWImeiwg+eUqGNyZWF0ZUxpbmvlh73mlbDlu7rnq4vpk77mjqVcclxuICogIEByZXR1cm4ge0xpbmt8Ym9vbGVhbn0g5Yib5bu65oiQ5Yqf6L+U5Zue6ZO+5o6l5a+56LGh77yM5aSx6LSl6L+U5ZueZmFsc2VcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5hZGRMaW5rID0gZnVuY3Rpb24gKGNvbmZpZywgZm4pIHtcclxuICAgIGlmIChjb25maWcgJiYgY29uZmlnLnN0YXJ0ICYmIGNvbmZpZy5lbmQpIHtcclxuICAgICAgICB2YXIgbGlua3MgPSB0aGlzLmxpbmtzQmV0d2Vlbihjb25maWcuc3RhcnQsIGNvbmZpZy5lbmQpOy8v5oyJbnVtYmVy5bGe5oCn5LuO5aSn5Yiw5bCP5o6S5YiXXHJcbiAgICAgICAgaWYgKGxpbmtzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIGlmICgkLmlzRnVuY3Rpb24oZm4pKSB7XHJcbiAgICAgICAgICAgICAgICBmbigpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlTGluayhjb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy/kuKTngrnkuYvpl7Tov57nur/kuLox5YiZ6K6k5Li65piv5bey5pyJ6ZO+5o6l77yM6LaF6L+HMeWImeiupOS4uuaYr+WPr+S7peWxleW8gOS4lOW3sue7j+WxleW8gOeahOebtOe6v1xyXG4gICAgICAgICAgICB2YXIgbnVtYmVyID0gMTtcclxuICAgICAgICAgICAgaWYgKCQuaXNOdW1lcmljKGNvbmZpZy5udW1iZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBudW1iZXIgPSBwYXJzZUludChjb25maWcubnVtYmVyKTtcclxuICAgICAgICAgICAgICAgIGlmIChudW1iZXIgPCAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyID0gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobGlua3MubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgIGxpbmtzWzBdLnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiBsaW5rc1swXS5hdHRyLm51bWJlciArIG51bWJlclxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlua3NbMF07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobGlua3MubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IGxpbmtzWzBdLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYXR0ci5udW1iZXIgKz0gbnVtYmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5hZGRDaGlsZChudW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqXHJcbiAqICDojrflj5bkuKTlhYPntKDkuYvpl7TmiYDmnInnmoTpk77mjqVcclxuICogIEBtZXRob2QgbGlua3NCZXR3ZWVuXHJcbiAqICBAcGFyYW0gc3RhcnQge2VsZW1lbnR9IOWFg+e0oO+8jOi1t+Wni+aXoOWFs1xyXG4gKiAgQHBhcmFtIGVuZCB7ZWxlbWVudH0g5YWD57Sg77yM6LW35aeL5peg5YWzXHJcbiAqICBAcmV0dXJuIHthcnJheX0g5YWD57Sg6Ze055qE6ZO+5o6l6ZuG5ZCI77yM5oyJ6ZO+5o6l55qE6K6h5pWw5Y+z5aSn5Yiw5bCP5o6S5YiXXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUubGlua3NCZXR3ZWVuID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcclxuICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgIHZhciBsaW5rcyA9IHN0YXJ0LmxpbmtzO1xyXG4gICAgLy/mo4DmtYvkuKTlhYPntKDpl7TnmoTov57nur/mmK/lkKblt7LmnIlcclxuICAgIGlmICgkLmlzQXJyYXkobGlua3Mub3V0KSkge1xyXG4gICAgICAgICQuZWFjaChsaW5rcy5vdXQsIGZ1bmN0aW9uIChpLCBsaW5rT3V0KSB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rT3V0LnBhdGguZW5kID09IGVuZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobGlua091dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGlmICgkLmlzQXJyYXkobGlua3MuaW4pKSB7XHJcbiAgICAgICAgJC5lYWNoKGxpbmtzLmluLCBmdW5jdGlvbiAoaiwgbGlua0luKSB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rSW4ucGF0aC5zdGFydCA9PSBlbmQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxpbmtJbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgIHJldHVybiBiLmF0dHIubnVtYmVyIC0gYS5hdHRyLm51bWJlcjtcclxuICAgIH0pO1xyXG59O1xyXG4vLy0tXHJcbi8qKlxyXG4gKlxyXG4gKiAg5Zyo5Zu+5bGC5LiK57uY5Yi25LiN5Y+v5Lul56e75Yqo55qE57q/5YWD57SgXHJcbiAqICBAbWV0aG9kIGNyZWF0ZUxpbmVcclxuICogIEBwYXJhbSBbY29uZmlnXSB7b2JqZWN0fSDphY3nva7lj4LmlbAs6Iul5peg5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqICBAcmV0dXJuIHtMaW5lfGJvb2xlYW59IOWIm+W7uuaIkOWKn+i/lOWbnue6v+WFg+e0oO+8jOWksei0pei/lOWbnmZhbHNlXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuY3JlYXRlTGluZSA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgIHZhciBuZXdMaW5lO1xyXG4gICAgdmFyIGNvbnN0YW50ID0gUVRvcG8uY29uc3RhbnQubGluZTtcclxuICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcclxuICAgIHN3aXRjaCAoY29uZmlnLnR5cGUpIHtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBuZXdMaW5lID0gbmV3IExpbmUuRGlyZWN0LmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAobmV3TGluZSAmJiBuZXdMaW5lLmp0b3BvKSB7XHJcbiAgICAgICAgYWRkSlRvcG8uY2FsbCh0aGlzLCBuZXdMaW5lKTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLmxpbmUucHVzaChuZXdMaW5lKTtcclxuICAgICAgICByZXR1cm4gbmV3TGluZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNyZWF0ZSBMaW5rIGVycm9yXCIsIGNvbmZpZyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG4vLy0tXHJcbi8qKlxyXG4gKlxyXG4gKiAg5Zyo5Zu+5bGC5LiK57uY5Yi25YiG57uE5YWD57SgXHJcbiAqICBAbWV0aG9kIGNyZWF0ZUNvbnRhaW5lclxyXG4gKiAgQHBhcmFtIFtjb25maWddIHtvYmplY3R9IOmFjee9ruWPguaVsCzoi6Xml6DliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICogIEByZXR1cm4ge2NvbnRhaW5lcnxib29sZWFufSDliJvlu7rmiJDlip/ov5Tlm57nur/lhYPntKDvvIzlpLHotKXov5Tlm55mYWxzZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmNyZWF0ZUNvbnRhaW5lciA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgIHZhciBuZXdDb250YWluZXI7XHJcbiAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudC5jb250YWluZXI7XHJcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3Q29udGFpbmVyID0gbmV3IENvbnRhaW5lci5Hcm91cC5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG5ld0NvbnRhaW5lciAmJiBuZXdDb250YWluZXIuanRvcG8pIHtcclxuICAgICAgICAvL+WIhue7hOWPquWKoOWFpeWFtuacrOi6q++8jOWIh+aNouiKgueCueS4jeS9nOaVsFxyXG4gICAgICAgIHZhciBub2RlQ29uZmlnID0ge307XHJcbiAgICAgICAgaWYgKGNvbmZpZy50b2dnbGUpIHtcclxuICAgICAgICAgICAgbm9kZUNvbmZpZyA9IGNvbmZpZy50b2dnbGVcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/lj6/pgInnpoHnlKjliIbnu4TliIfmjaJcclxuICAgICAgICBpZiAoIShjb25maWcudG9nZ2xlICYmIHR5cGVvZiBjb25maWcudG9nZ2xlLmNsb3NlID09IFwiYm9vbGVhblwiICYmIGNvbmZpZy50b2dnbGUuY2xvc2UpKSB7XHJcbiAgICAgICAgICAgIGFkZFRvZ2dsZSh0aGlzLCBuZXdDb250YWluZXIsIG5vZGVDb25maWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoaWxkcmVuLmNvbnRhaW5lci5wdXNoKG5ld0NvbnRhaW5lcik7XHJcbiAgICAgICAgYWRkSlRvcG8uY2FsbCh0aGlzLCBuZXdDb250YWluZXIpO1xyXG4gICAgICAgIHJldHVybiBuZXdDb250YWluZXI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgQ29udGFpbmVyIGVycm9yXCIsIGNvbmZpZyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBhZGRUb2dnbGUoc2NlbmUsIGNvbnRhaW5lciwgY29uZmlnVG9nZ2xlKSB7XHJcbiAgICBjb25maWdUb2dnbGUudXNlVHlwZSA9IFFUb3BvLmNvbnN0YW50LkNBU1VBTDsvL+agh+iusOeUqOmAlFxyXG4gICAgY29udGFpbmVyLnRvZ2dsZVRvID0gbmV3IE5vZGUuSW1hZ2UuY29uc3RydWN0b3IoY29uZmlnVG9nZ2xlKTtcclxuICAgIGNvbnRhaW5lci50b2dnbGVUby50b2dnbGVUbyA9IGNvbnRhaW5lcjsvL+S6kuebuOe0ouW8lVxyXG4gICAgY29udGFpbmVyLnRvZ2dsZVRvLmhpZGUoKTsvL+WIneWni+makOiXj1xyXG4gICAgYWRkSlRvcG8uY2FsbChzY2VuZSwgY29udGFpbmVyLnRvZ2dsZVRvKTsvL+WKoOWFpeeUu+W4g1xyXG59XHJcbi8vLS1cclxuLy8tXHJcbi8qKlxyXG4gKlxyXG4gKiAg5Yig6Zmk5Zu+5bGC5YaF5YWD57SgLOWFg+e0oOWIoOmZpOWFtuS4iueahOmTvuaOpeS5n+S8muWIoOmZpOWSjOabtOaWsFxyXG4gKiAgQG1ldGhvZCByZW1vdmVcclxuICogIEBwYXJhbSBlbGVtZW50IHtlbGVtZW50fVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGVsZW1lbnQsIGZ1bmN0aW9uIChpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVPbmNlKGl0ZW0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZW1vdmVPbmNlKGVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiByZW1vdmVPbmNlKG9uZUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKG9uZUVsZW1lbnQuanRvcG8pIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAob25lRWxlbWVudC5nZXRUeXBlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFFUb3BvLmNvbnN0YW50Lk5PREU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChRVG9wby51dGlsLmFycmF5RGVsZXRlKHNlbGYuY2hpbGRyZW4ubm9kZSwgb25lRWxlbWVudCkgfHwgb25lRWxlbWVudC5nZXRVc2VUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVOb2RlLmNhbGwoc2VsZiwgb25lRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5MSU5LOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoUVRvcG8udXRpbC5hcnJheURlbGV0ZShzZWxmLmNoaWxkcmVuLmxpbmssIG9uZUVsZW1lbnQpIHx8IG9uZUVsZW1lbnQuZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlTGluay5jYWxsKHNlbGYsIG9uZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuTElORTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFFUb3BvLnV0aWwuYXJyYXlEZWxldGUoc2VsZi5jaGlsZHJlbi5saW5lLCBvbmVFbGVtZW50KSB8fCBvbmVFbGVtZW50LmdldFVzZVR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUxpbmUuY2FsbChzZWxmLCBvbmVFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFFUb3BvLmNvbnN0YW50LkNPTlRBSU5FUjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFFUb3BvLnV0aWwuYXJyYXlEZWxldGUoc2VsZi5jaGlsZHJlbi5jb250YWluZXIsIG9uZUVsZW1lbnQpIHx8IG9uZUVsZW1lbnQuZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ29udGFpbmVyLmNhbGwoc2VsZiwgb25lRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIHVwRGF0YUxpbmtzKGVsZW1lbnQpIHtcclxuICAgIHZhciBsaW5rcyA9IGVsZW1lbnQubGlua3M7XHJcbiAgICBpZiAobGlua3MpIHtcclxuICAgICAgICAvL+abtOaWsOWFtuS4iui/nue6v+eahOWPpuS4gOaWueeahGxpbmtz5bGe5oCnXHJcbiAgICAgICAgd2hpbGUgKGxpbmtzLmluLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUobGlua3MuaW4ucG9wKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3aGlsZSAobGlua3Mub3V0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUobGlua3Mub3V0LnBvcCgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLy/nur/kuIrliKDpmaTml7blgJks6KaB5pu05pawbm9kZeWSjGNvbnRhaW5lcuS4reeahGxpbmtz5bGe5oCnXHJcbmZ1bmN0aW9uIHJlbW92ZUxpbmsobGluaykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBRVG9wby51dGlsLmFycmF5RGVsZXRlKGxpbmsucGF0aC5zdGFydC5saW5rcy5vdXQsIGxpbmspO1xyXG4gICAgICAgIFFUb3BvLnV0aWwuYXJyYXlEZWxldGUobGluay5wYXRoLmVuZC5saW5rcy5pbiwgbGluayk7XHJcbiAgICAgICAgcmVtb3ZlSlRvcG8uY2FsbCh0aGlzLCBsaW5rKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiU2NlbmUgcmVtb3ZlTGluayBlcnJvclwiLCBlKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZW1vdmVMaW5lKGxpbmUpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmVtb3ZlSlRvcG8uY2FsbCh0aGlzLCBsaW5lKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiU2NlbmUgcmVtb3ZlTGluZSBlcnJvclwiLCBlKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZW1vdmVOb2RlKG5vZGUpIHtcclxuICAgIC8v5Yi35paw5LiA5LiL546w5pyJ55qE57q/XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8v5pu05paw5YW25LiK57q/5Y+m5LiA5aS055qEbGlua3PlsZ7mgKdcclxuICAgICAgICB1cERhdGFMaW5rcy5jYWxsKHRoaXMsIG5vZGUpO1xyXG4gICAgICAgIC8v6KaB5pu05paw5YW254i255qEY2hpbGRyZW7lsZ7mgKcs54i25Yig6Zmk5a2QXHJcbiAgICAgICAgaWYgKG5vZGUucGFyZW50ICYmICQuaXNBcnJheShub2RlLnBhcmVudC5jaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgbm9kZS5wYXJlbnQucmVtb3ZlKG5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+WIoOmZpOWIhue7hOWIh+aNoueahOiKgueCueaXtuWQjOaXtuWIoOmZpOWFtuWIh+aNoueahOWIhue7hFxyXG4gICAgICAgIGlmIChub2RlLnRvZ2dsZVRvKSB7XHJcbiAgICAgICAgICAgIC8v5YiG57uE6Iul6ZqQ6JeP5LqGLOW6lOivpeWxleekulxyXG4gICAgICAgICAgICBub2RlLnRvZ2dsZVRvLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZShub2RlLnRvZ2dsZVRvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVtb3ZlSlRvcG8uY2FsbCh0aGlzLCBub2RlKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiU2NlbmUgcmVtb3ZlTm9kZSBlcnJvclwiLCBlKTtcclxuICAgIH1cclxufVxyXG4vL+WuueWZqOWIoOmZpOaXtizopoHmm7TkuI7lhbbnm7jov57nmoTnur/nmoTlj6bkuIDnq6/nmoRsaW5rc+WxnuaApyzopoHmm7TmlrDlhbblrZDnsbvnmoRwYXJlbnTlsZ7mgKdcclxuZnVuY3Rpb24gcmVtb3ZlQ29udGFpbmVyKGNvbnRhaW5lcikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICAvL+WIhue7hOiLpemakOiXj+S6hizlupTor6XlsZXnpLpcclxuICAgICAgICBjb250YWluZXIudG9nZ2xlKHRydWUpO1xyXG4gICAgICAgIC8v5pu05paw5YW25LiK57q/5Y+m5LiA5aS055qEbGlua3PlsZ7mgKdcclxuICAgICAgICB1cERhdGFMaW5rcy5jYWxsKHRoaXMsIGNvbnRhaW5lcik7XHJcbiAgICAgICAgLy/mm7TmlrDlrZDlhYPntKDnmoRQYXJlbnTlsZ7mgKdcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGNvbnRhaW5lci5jaGlsZHJlbikgJiYgY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jaGlsZHJlbltpXS5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5Yig6Zmk5YiG57uE5ZCM5pe25Yig6Zmk5YW25YiH5o2i6IqC54K5XHJcbiAgICAgICAgaWYgKGNvbnRhaW5lci50b2dnbGVUbykge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZShjb250YWluZXIudG9nZ2xlVG8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZW1vdmVKVG9wby5jYWxsKHRoaXMsIGNvbnRhaW5lcik7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIlNjZW5lIHJlbW92ZUNvbnRhaW5lciBlcnJvclwiLCBlKTtcclxuICAgIH1cclxufVxyXG4vLy1cclxuLyoqXHJcbiAqXHJcbiAqICDlm77lsYLkv6Hmga/ovazljJbkuLpqc29uXHJcbiAqICBAbWV0aG9kIHRvSnNvblxyXG4gKiAgQHJldHVybiB7b2JqZWN0fVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnRvSnNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBqc29uID0gJC5leHRlbmQoe30sIHRoaXMuYXR0cik7XHJcbiAgICBqc29uLmV4dHJhID0gJC5leHRlbmQoe30sIHRoaXMuZXh0cmEpO1xyXG4gICAgcmV0dXJuIGpzb247XHJcbn07XHJcbi8qKlxyXG4gKlxyXG4gKiAg5Yik5pat5YWD57Sg5piv5ZCm5Zyo5b2T5YmN5Zu+5bGC5YaFXHJcbiAqICBAbWV0aG9kIGlzQ2hpbGRyZW5cclxuICogIEBwYXJhbSBlbGVtZW50IHtlbGVtZW50fVxyXG4gKiAgQHJldHVybiB7Ym9vbGVhbn1cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5pc0NoaWxkcmVuID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgIHZhciByZXN1bHQgPSBmYWxzZTtcclxuICAgIGlmIChlbGVtZW50Lmp0b3BvKSB7XHJcbiAgICAgICAgJC5lYWNoKHRoaXMuY2hpbGRyZW4sIGZ1bmN0aW9uIChuYW1lLCBhcnIpIHtcclxuICAgICAgICAgICAgaWYgKGFyci5pbmRleE9mKGVsZW1lbnQpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn07XHJcbi8qKlxyXG4gKlxyXG4gKiDlm77lsYLnvKnmlL4s5YWD57Sg5LiA5bGP5pi+56S6XHJcbiAqICBAbWV0aG9kIGdvQ2VudGVyXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ29DZW50ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGhpcy5qdG9wby5jaGlsZHMgJiYgdGhpcy5qdG9wby5jaGlsZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc3RhZ2UuY2VudGVyQW5kWm9vbSgpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICpcclxuICog5Zu+5bGC57yp5pS+XHJcbiAqICBAbWV0aG9kIHJlc2l6ZVxyXG4gKiAgQHBhcmFtIHNpemUge251bWJlcn0g5qC55o2u5q+U5L6L5pS+5aSn5oiW57yp5bCPIOWPguaVsOWPryAwLTHnvKnlsI8gMS1u5pS+5aSnXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKHNpemUpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhzaXplKSkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc2NhbGVYID0gc2l6ZTtcclxuICAgICAgICB0aGlzLmp0b3BvLnNjYWxlWSA9IHNpemU7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKlxyXG4gKiDlkK/nlKgv56aB55So6byg5qCH57yp5pS+XHJcbiAqICBAbWV0aG9kIHRvZ2dsZVpvb21cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS50b2dnbGVab29tID0gZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCF0aGlzLmp0b3BvLnN0YWdlLndoZWVsWm9vbSkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc3RhZ2Uud2hlZWxab29tID0gMC44NTsgLy8g6K6+572u6byg5qCH57yp5pS+5q+U5L6LXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc3RhZ2Uud2hlZWxab29tID0gbnVsbDtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqXHJcbiAqIOWQr+eUqC/npoHnlKjpubDnnLxcclxuICogIEBtZXRob2QgdG9nZ2xlRWFnbGVFeWVcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS50b2dnbGVFYWdsZUV5ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuanRvcG8uc3RhZ2UuZWFnbGVFeWUudmlzaWJsZSA9ICF0aGlzLmp0b3BvLnN0YWdlLmVhZ2xlRXllLnZpc2libGU7XHJcbn07XHJcbi8qKlxyXG4gKlxyXG4gKiDojrflj5blvZPliY3lm77lsYLnmoRwbmfmoLzlvI/lm77niYflnKjmlrDnmoTnqpflj6PmiZPlvIBcclxuICogIEBtZXRob2QgZ2V0UGljdHVyZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdldFBpY3R1cmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvL3N0YWdlLnNhdmVJbWFnZUluZm8oKTtcclxuICAgIC8v5Zyo5paw6aG16Z2i5omT5byA5Zu+54mHXHJcbiAgICB2YXIgaW1hZ2UgPSB0aGlzLmp0b3BvLnN0YWdlLmNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIik7XHJcbiAgICB2YXIgdyA9IHdpbmRvdy5vcGVuKCdhYm91dDpibGFuaycsICdpbWFnZSBmcm9tIGNhbnZhcycpO1xyXG4gICAgdy5kb2N1bWVudC53cml0ZShcIjxpbWcgc3JjPSdcIiArIGltYWdlICsgXCInIGFsdD0nZnJvbSBjYW52YXMnLz5cIik7XHJcbiAgICAvL+S4i+i9veWbvueJh1xyXG4gICAgLy8gaGVyZSBpcyB0aGUgbW9zdCBpbXBvcnRhbnQgcGFydCBiZWNhdXNlIGlmIHlvdSBkb250IHJlcGxhY2UgeW91IHdpbGwgZ2V0IGEgRE9NIDE4IGV4Y2VwdGlvbi5cclxuICAgIC8vIHZhciBpbWFnZSA9ICBzdGFnZS5jYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpLnJlcGxhY2UoXCJpbWFnZS9wbmdcIiwgXCJpbWFnZS9vY3RldC1zdHJlYW07Q29udGVudC1EaXNwb3NpdGlvbjogYXR0YWNobWVudDtmaWxlbmFtZT1mb29iYXIucG5nXCIpO1xyXG4gICAgLy92YXIgaW1hZ2UgPSBzdGFnZS5jYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpLnJlcGxhY2UoXCJpbWFnZS9wbmdcIiwgXCJpbWFnZS9vY3RldC1zdHJlYW1cIik7XHJcbiAgICAvL3dpbmRvdy5sb2NhdGlvbi5ocmVmPWltYWdlOyAvLyBpdCB3aWxsIHNhdmUgbG9jYWxseVxyXG59O1xyXG4vKipcclxuICog5YiH5o2i5YWD57Sg55qE5bGC5qyhXHJcbiAqIEBtZXRob2QgdG9nZ2xlWkluZGV4XHJcbiAqIEBwYXJhbSBlbGVtZW50IOW+heaOp+WItuWFg+e0oFxyXG4gKiBAcGFyYW0gW2ZsYWddIHRydWXkuLrpmY3kvY5mYWxzZeS4uuaPkOWNh++8jOaXoOWPguWImem7mOiupOaPkOWNh++8jOiLpeW3suaPkOWNh+WIsOacgOmrmOWImemZjeiHs+acgOS9jlxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnRvZ2dsZVpJbmRleCA9IGZ1bmN0aW9uIChlbGVtZW50LCBmbGFnKSB7XHJcbiAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgIHZhciBqdG9wbyA9IGVsZW1lbnQuanRvcG87XHJcbiAgICAgICAgdmFyIHNjZW5lID0gdGhpcy5qdG9wbztcclxuICAgICAgICBpZiAoanRvcG8gJiYgc2NlbmUpIHtcclxuICAgICAgICAgICAgdmFyIG1hcCA9IHNjZW5lLnpJbmRleE1hcFtqdG9wby56SW5kZXhdO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBtYXAuaW5kZXhPZihqdG9wbyk7XHJcbiAgICAgICAgICAgIHZhciB0b2RvID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBmbGFnID09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgdG9kbyA9IGZsYWc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT0gbWFwLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0b2RvID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRvZG8pIHtcclxuICAgICAgICAgICAgICAgIC8v5o+Q5Y2H5bGC5qyhXHJcbiAgICAgICAgICAgICAgICBtYXAucHVzaChtYXBbaW5kZXhdKTtcclxuICAgICAgICAgICAgICAgIG1hcC5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8v6ZmN5L2O5bGC5qyhXHJcbiAgICAgICAgICAgICAgICBtYXAuc3BsaWNlKDAsIDAsIG1hcFtpbmRleF0pO1xyXG4gICAgICAgICAgICAgICAgbWFwLnNwbGljZShpbmRleCArIDEsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG52YXIgc2VsZWN0ZWRDYXRjaCA9IHtcclxuICAgIGp0b3BvOiBbXSxcclxuICAgIHF0b3BvOiBbXVxyXG59O1xyXG4vKipcclxuICog6I635Y+W6KKr6YCJ5Lit55qE5YWD57SgXHJcbiAqIEBtZXRob2QgZ2V0U2VsZWN0ZWRcclxuICogQHJldHVybiB7YXJyYXl9IOi/lOWbnuWbvuWxguS4reiiq+mAieS4reeahOWFg+e0oFxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdldFNlbGVjdGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGp0b3BvID0gdGhpcy5qdG9wby5zZWxlY3RlZEVsZW1lbnRzO1xyXG4gICAgaWYgKCQuaXNBcnJheShqdG9wbykpIHtcclxuICAgICAgICBpZiAoc2VsZWN0ZWRDYXRjaC5qdG9wbyAhPSBqdG9wbykge1xyXG4gICAgICAgICAgICBzZWxlY3RlZENhdGNoLmp0b3BvID0ganRvcG87XHJcbiAgICAgICAgICAgIHNlbGVjdGVkQ2F0Y2gucXRvcG8gPSBbXTtcclxuICAgICAgICAgICAganRvcG8uZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbC5xdG9wbyAmJiBlbC5xdG9wby5nZXRVc2VUeXBlKCkgIT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYXRjaC5xdG9wby5wdXNoKGVsLnF0b3BvKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzZWxlY3RlZENhdGNoLnF0b3BvO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDpq5jkuq7nm67moIfpmpDol4/lhbbku5ZcclxuICogQG1ldGhvZCB0b2dnbGVMaWdodFxyXG4gKiBAcGFyYW0gW3RhcmdldF0g5pWw57uE5oiW5a+56LGhLOmrmOS6ruWFtuebuOWFs+WvueixoSzml6Dlj4LliJnlhajpg6jpq5jkuq5cclxuICogQHBhcmFtIFtmbGFnXSDoi6XkuLp0cnVl5YiZ5Y+q6auY5Lqu5Lyg5YWl55qE5a+56LGhLOS4jemAieWImeWPquWvueS8oOWFpeWvueixoeebuOWFs+eahOWvueixoemrmOS6rlxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnRvZ2dsZUxpZ2h0ID0gZnVuY3Rpb24gKHRhcmdldCwgZmxhZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgYWxwaGEgPSAxO1xyXG4gICAgICAgIHZhciBsaWdodGluZztcclxuICAgICAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIGFscGhhID0gMC4xO1xyXG4gICAgICAgICAgICBpZiAoZmxhZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheSh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlnaHRpbmcgPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpZ2h0aW5nID0gW3RhcmdldF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJC5pc0FycmF5KHRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsaWdodGluZyA9IGdldENvbm5lY3Rpb25MaWdodGluZ3ModGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlnaHRpbmcgPSBnZXRDb25uZWN0aW9uTGlnaHRpbmdzKFt0YXJnZXRdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0b3RhbFNldEFscGhhKHRoaXMuY2hpbGRyZW4ubm9kZS5jb25jYXQodGhpcy5jaGlsZHJlbi5saW5rKSwgYWxwaGEpO1xyXG4gICAgICAgIHRvdGFsU2V0QWxwaGEobGlnaHRpbmcsIDEpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJzY2VuZSB0b2dnbGVMaWdodCBlcnJvclwiLCBlKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldENvbm5lY3Rpb25MaWdodGluZ3MoYXJyKSB7XHJcbiAgICAgICAgdmFyIGxpZ2h0aW5nID0gW107XHJcbiAgICAgICAgJC5lYWNoKGFyciwgZnVuY3Rpb24gKGksIHRhcmdldCkge1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0LmdldFR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5OT0RFICYmIHRhcmdldC5nZXRVc2VUeXBlKCkgIT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSB0YXJnZXQubGlua3M7XHJcbiAgICAgICAgICAgICAgICBRVG9wby51dGlsLmFycmF5UHVzaChsaWdodGluZywgdGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIGlmIChsaW5rcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkobGlua3Mub3V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gobGlua3Mub3V0LCBmdW5jdGlvbiAobCwgb3V0bGluaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUVRvcG8udXRpbC5hcnJheVB1c2gobGlnaHRpbmcsIG91dGxpbmspO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUVRvcG8udXRpbC5hcnJheVB1c2gobGlnaHRpbmcsIG91dGxpbmsucGF0aC5lbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShsaW5rcy5pbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGxpbmtzLmluLCBmdW5jdGlvbiAobiwgaW5saW5rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmFycmF5UHVzaChsaWdodGluZywgaW5saW5rKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuYXJyYXlQdXNoKGxpZ2h0aW5nLCBpbmxpbmsucGF0aC5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBsaWdodGluZztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0b3RhbFNldEFscGhhKHRvdGFsLCBhbHBoYSkge1xyXG4gICAgICAgIC8v5YWo6YOo6ZqQ6JePXHJcbiAgICAgICAgaWYgKCQuaXNBcnJheSh0b3RhbCkpIHtcclxuICAgICAgICAgICAgJC5lYWNoKHRvdGFsLCBmdW5jdGlvbiAoaSwgZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgIGFscGhhOiBhbHBoYVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOato+W4uOWwuuWvuOWxleekuu+8jOW5tuWwhuinhuinkuenu+WKqOWIsOS7peWPguaVsOiKgueCueS4uuS4reW/g+eahOS9jee9rlxyXG4gKiBAbWV0aG9kIG1vdmVUb05vZGVcclxuICogQHBhcmFtIG5vZGUg6IqC54K55a+56LGhXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUubW92ZVRvTm9kZSA9IGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAvLyDmn6Xor6LliLDnmoToioLngrnlsYXkuK3mmL7npLpcclxuICAgIGlmICh0aGlzLmNoaWxkcmVuLm5vZGUuaW5kZXhPZihub2RlKSA+IC0xKSB7XHJcbiAgICAgICAgdmFyIGxvY2F0aW9uID0gbm9kZS5qdG9wby5nZXRDZW50ZXJMb2NhdGlvbigpO1xyXG4gICAgICAgIHRoaXMucmVzaXplKDEpO1xyXG4gICAgICAgIHRoaXMuanRvcG8uc2V0Q2VudGVyKGxvY2F0aW9uLngsIGxvY2F0aW9uLnkpO1xyXG4gICAgICAgIC8vIOmXqueDgeWHoOS4i1xyXG4gICAgICAgIG5vZGVGbGFzaChub2RlLmp0b3BvLCA1KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG5vZGVGbGFzaChub2RlLCBudW0pIHtcclxuICAgICAgICBpZiAoJC5pc051bWVyaWMobnVtKSkge1xyXG4gICAgICAgICAgICBpZiAobnVtID09IDApIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuc2VsZWN0ZWQgPSAhbm9kZS5zZWxlY3RlZDtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVGbGFzaChub2RlLCBudW0gLSAxKTtcclxuICAgICAgICAgICAgICAgIH0sIDMwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDoh6rliqjluIPlsYBcclxuICogQG1ldGhvZCBhdXRvTGF5b3V0XHJcbiAqIEBwYXJhbSBjb25maWcg6Ieq5Yqo5biD5bGA6YWN572u5Y+C5pWwXHJcbiAqIEBleGFtcGxlXHJcbiAqICAgICAg5Y+C5pWw6YWN572uOlxyXG4gKiAgICAgICAgICBjb25maWc6e1xyXG4gKiAgICAgICAgICAgICAgdHlwZTpcclxuICogICAgICAgICAgICAgICAgICAxLidyb3VuZCcgICDml6DpnIDlhbbku5bphY3nva5cclxuICogICAgICAgICAgICAgICAgICAyLidkZWZhdWx0JyDpnIDphY3nva7ooYzmlbDvvIzliJfpl7Tot53vvIzooYzpl7Tot51cclxuICogICAgICAgICAgICAgIHJvd3M66KGM5pWwXHJcbiAqICAgICAgICAgICAgICByb3dTcGFjZTrooYzpl7Tot51cclxuICogICAgICAgICAgICAgIGNvbHVtblNwYWNlOuWIl+mXtOi3nVxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuYXV0b0xheW91dCA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgIGlmIChjb25maWcgJiYgY29uZmlnLnR5cGUpIHtcclxuICAgICAgICB2YXIgbmVlZFNvcnQgPSBbXTtcclxuICAgICAgICB2YXIganRvcG9zID0gW107XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5ub2RlLmZvckVhY2goZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgaWYgKCF2LnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgbmVlZFNvcnQucHVzaCh2KTtcclxuICAgICAgICAgICAgICAgIGp0b3Bvcy5wdXNoKHYuanRvcG8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwicm91bmRcIjpcclxuICAgICAgICAgICAgICAgIGxheW91dF9yb3VuZCh0aGlzLmp0b3BvLCBqdG9wb3MpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJkZWZhdWx0XCI6XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRfZGVmYXVsdChuZWVkU29ydCwgcGFyc2VJbnQoY29uZmlnLnJvd3MpLCBwYXJzZUludChjb25maWcucm93U3BhY2UpLCBwYXJzZUludChjb25maWcuY29sdW1uU3BhY2UpLCB0aGlzLmdldE9yaWdpbigpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gbGF5b3V0X3JvdW5kKHNjZW5lLCBqdG9wb3MpIHtcclxuICAgIEpUb3BvLmxheW91dC5jaXJjbGVMYXlvdXROb2RlcyhqdG9wb3MsIHthbmltYXRlOiB7dGltZTogMTAwMH19KTtcclxufVxyXG5mdW5jdGlvbiBsYXlvdXRfZGVmYXVsdChlbGVtZW50cywgcm93cywgcm93U3BhY2UsIGNvbHVtblNwYWNlLCBiZWdpbikge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHJvd3MpKSB7XHJcbiAgICAgICAgcm93cyA9IHBhcnNlSW50KHJvd3MpO1xyXG4gICAgICAgIGlmIChyb3dzIDwgMSkge1xyXG4gICAgICAgICAgICByb3dzID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJC5lYWNoKGVsZW1lbnRzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGdldERlZ3JlZShiKSAtIGdldERlZ3JlZShhKTtcclxuICAgICAgICB9KSwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgLy92LnNldExvY2F0aW9uKGJlZ2luLnggKyAoaSAlIHJvd3MpICogY29sdW1uU3BhY2UsIGJlZ2luLnkpO1xyXG4gICAgICAgICAgICBtb3ZlKHYsIGJlZ2luLnggKyAoaSAlIHJvd3MpICogY29sdW1uU3BhY2UsIGJlZ2luLnkpO1xyXG4gICAgICAgICAgICBpZiAoKGkgKyAxKSAlIHJvd3MgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgYmVnaW4ueSArPSByb3dTcGFjZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbi8vLS0tLS0tLeW3peWFt+WHveaVsFxyXG4vL+iOt+WPluiKgueCueeahOW6plxyXG5mdW5jdGlvbiBnZXREZWdyZWUobm9kZSkge1xyXG4gICAgdmFyIGluTGlua3MgPSBub2RlLmxpbmtzLmluO1xyXG4gICAgdmFyIG91dExpbmtzID0gbm9kZS5saW5rcy5vdXQ7XHJcbiAgICB2YXIgZGVncmVlID0gMDtcclxuICAgIGlmIChpbkxpbmtzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgZGVncmVlICs9IGluTGlua3NbMF0uYXR0ci5udW1iZXI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRlZ3JlZSArPSBpbkxpbmtzLmxlbmd0aDtcclxuICAgIH1cclxuICAgIGlmIChvdXRMaW5rcy5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIGRlZ3JlZSArPSBvdXRMaW5rc1swXS5hdHRyLm51bWJlcjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVncmVlICs9IG91dExpbmtzLmxlbmd0aDtcclxuICAgIH1cclxuICAgIHJldHVybiBkZWdyZWU7XHJcbn1cclxuLy/np7vliqjliqjnlLtcclxuZnVuY3Rpb24gbW92ZShub2RlLCB0YXJnZXRYLCB0YXJnZXRZKSB7XHJcbiAgICB0YXJnZXRYID0gcGFyc2VJbnQodGFyZ2V0WCk7XHJcbiAgICB0YXJnZXRZID0gcGFyc2VJbnQodGFyZ2V0WSk7XHJcbiAgICB2YXIgeCA9IG5vZGUuYXR0ci5wb3NpdGlvblswXTtcclxuICAgIHZhciB5ID0gbm9kZS5hdHRyLnBvc2l0aW9uWzFdO1xyXG4gICAgdmFyIHBhcnRYID0gcGFyc2VJbnQoKHRhcmdldFggLSB4KSkgLyAxMDtcclxuICAgIHZhciBwYXJ0WSA9IHBhcnNlSW50KCh0YXJnZXRZIC0geSkpIC8gMTA7XHJcbiAgICB2YXIgcGFydCA9IDA7XHJcbiAgICB2YXIgdGVtcCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoTWF0aC5hYnModGFyZ2V0WCAtIHgpID4gMSkge1xyXG4gICAgICAgICAgICB4ICs9IHBhcnRYO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoTWF0aC5hYnModGFyZ2V0WSAtIHkpID4gMSkge1xyXG4gICAgICAgICAgICB5ICs9IHBhcnRZO1xyXG4gICAgICAgIH1cclxuICAgICAgICBub2RlLnNldFBvc2l0aW9uKFtwYXJzZUludCh4KSwgcGFyc2VJbnQoeSldKTtcclxuICAgICAgICBwYXJ0Kys7XHJcbiAgICAgICAgaWYgKE1hdGguYWJzKHRhcmdldFggLSB4KSA8PSAxICYmIE1hdGguYWJzKHRhcmdldFkgLSB5KSA8PSAxKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGVtcCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXJ0ID49IDEwKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGVtcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgMTAwKTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9TY2VuZS5qc1xuLy8gbW9kdWxlIGlkID0gOVxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9');
},function(module,exports,__webpack_require__){eval("var JTopo=__webpack_require__(39);\r\n__webpack_require__(49)(JTopo);\r\n__webpack_require__(48)(JTopo);\r\n__webpack_require__(47)(JTopo);\r\n__webpack_require__(46)(JTopo);\r\n__webpack_require__(44)(JTopo);\r\n__webpack_require__(40)(JTopo);\r\n__webpack_require__(43)(JTopo);\r\n__webpack_require__(42)(JTopo);\r\n__webpack_require__(41)(JTopo);\r\n__webpack_require__(45)(JTopo);\r\nwindow.JTopo = JTopo;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vaW5kZXguanM/MmE3OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgSlRvcG89cmVxdWlyZSgnLi9iYXNlLmpzJyk7XHJcbnJlcXVpcmUoJy4vdG9vbHMvdXRpbC5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi90b29scy9sYXlvdXQuanMnKShKVG9wbyk7XHJcbnJlcXVpcmUoJy4vdG9vbHMvYW5pbWF0ZS5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9lbGVtZW50cy9zdGFnZS5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9lbGVtZW50cy9zY2VuZS5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9lbGVtZW50cy9iYXNlRWxlbWVudC5qcycpKEpUb3BvKTtcclxucmVxdWlyZSgnLi9lbGVtZW50cy9ub2RlLmpzJykoSlRvcG8pO1xyXG5yZXF1aXJlKCcuL2VsZW1lbnRzL2xpbmsuanMnKShKVG9wbyk7XHJcbnJlcXVpcmUoJy4vZWxlbWVudHMvY29udGFpbmVyLmpzJykoSlRvcG8pO1xyXG5yZXF1aXJlKCcuL2VsZW1lbnRzL3NwZWNpYWxOb2RlLmpzJykoSlRvcG8pO1xyXG53aW5kb3cuSlRvcG8gPSBKVG9wbztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMTBcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports){eval('/**\r\n * @module QTopo\r\n */\r\n/**\r\n * QTopo通用工具包\r\n * @class QTopo.util\r\n * @static\r\n */\r\nfunction cached(fn) {\r\n    var cache = Object.create(null);\r\n    return (function cachedFn(str) {\r\n        var hit = cache[str];\r\n        return hit || (cache[str] = fn(str))\r\n    })\r\n}\r\n\r\nvar util = {\r\n        /**\r\n         *  给函数添加缓存机制\r\n         *  @method cached\r\n         *  @param fn {function} 需处理的函数\r\n         *  @returns {function} 处理过的函数\r\n         */\r\n        cached:cached,\r\n        /**\r\n         * 字符串转化json\r\n         * @method toJson\r\n         * @param json {string|object}\r\n         * @returns json对象 {json}\r\n         */\r\n        toJson: function (json) {\r\n            if (typeof json == \'string\') {\r\n                json = $.parseJSON(json.replace(/\'/g, \'"\'));\r\n            }\r\n            return json;\r\n        },\r\n        /**\r\n         * 首字母大写\r\n         * @method upFirst\r\n         * @param string 字符串\r\n         * @returns {string} 首字母大写的字符串\r\n         */\r\n        upFirst: cached(function (str) {\r\n            return str.charAt(0).toUpperCase() + str.slice(1);\r\n        }),\r\n        /**\r\n         * 对象深度合并，只继承原对象有的属性\r\n         * @method extend\r\n         * @param base 原对象\r\n         * @param config 合并对象\r\n         * @returns {object} 处理完的原对象\r\n         */\r\n        extend: function (base, config) {\r\n            try {\r\n                if (typeof base == "object" && typeof config == "object") {\r\n                    deep(base, config);\r\n                }\r\n                else {\r\n                    QTopo.util.error("some extend error:", base, config);\r\n                }\r\n            } catch (e) {\r\n                QTopo.util.error("extend error", e, base, config);\r\n            }\r\n            function deep(attr, config) {\r\n                $.each(attr, function (key, value) {\r\n                    if (attr[key] && typeof attr[key] == "object" && typeof config[key] == "object") {\r\n                        if ($.isArray(attr[key]) && $.isArray(config[key])) {\r\n                            attr[key] = config[key];\r\n                        } else if ($.isFunction(attr[key]) && $.isFunction(config[key])) {\r\n                            attr[key] = config[key];\r\n                        } else {\r\n                            deep(attr[key], config[key]);\r\n                        }\r\n                    } else if (typeof attr[key] != "undefined" && typeof config[key] != "undefined") {\r\n                        attr[key] = config[key];\r\n                    }\r\n                });\r\n            }\r\n\r\n            return base;\r\n        },\r\n        /**\r\n         * 获取浏览器连接上的参数\r\n         * @method getParameter\r\n         * @param param 参数名\r\n         * @returns {string}\r\n         */\r\n        getParameter: function (param) {\r\n            var query = window.location.search;//获取URL地址中？后的所有字符\r\n            var iLen = param.length;//获取你的参数名称长度\r\n            var iStart = query.indexOf(param);//获取你该参数名称的其实索引\r\n            if (iStart == -1)//-1为没有该参数\r\n                return "";\r\n            iStart += iLen + 1;\r\n            var iEnd = query.indexOf("&", iStart);//获取第二个参数的其实索引\r\n            if (iEnd == -1)//只有一个参数\r\n                return query.substring(iStart);//获取单个参数的参数值\r\n            return query.substring(iStart, iEnd);//获取第二个参数的值\r\n        },\r\n        /**\r\n         * 仅画布全屏展示\r\n         * @method runPrefixMethod\r\n         * @param element {document} 例:canvas\r\n         * @param method {string} "RequestFullScreen"全屏的模式\r\n         */\r\n        runPrefixMethod: function (element, method) {\r\n            var usablePrefixMethod;\r\n            ["webkit", "moz", "ms", "o", ""].forEach(function (prefix) {\r\n                    if (usablePrefixMethod) return;\r\n                    if (prefix === "") {\r\n                        // 无前缀，方法首字母小写\r\n                        method = method.slice(0, 1).toLowerCase() + method.slice(1);\r\n                    }\r\n                    var typePrefixMethod = typeof element[prefix + method];\r\n                    if (typePrefixMethod + "" !== "undefined") {\r\n                        if (typePrefixMethod === "function") {\r\n                            usablePrefixMethod = element[prefix + method]();\r\n                        } else {\r\n                            usablePrefixMethod = element[prefix + method];\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n        },\r\n        /**\r\n         * 浏览器全屏展示\r\n         * @method launchFullScreen\r\n         * @param element {document} 例:document.documentElement\r\n         */\r\n        launchFullScreen: function (element) {\r\n            if (element.requestFullscreen) {\r\n                element.requestFullscreen();\r\n            } else if (element.mozRequestFullScreen) {\r\n                element.mozRequestFullScreen();\r\n            } else if (element.webkitRequestFullscreen) {\r\n                element.webkitRequestFullscreen();\r\n            } else if (element.msRequestFullscreen) {\r\n                element.msRequestFullscreen();\r\n            }\r\n        },\r\n        /**\r\n         * 关闭浏览器全屏\r\n         * @method exitFullScreen\r\n         * @param document {document} 例:window.document\r\n         */\r\n        exitFullScreen: function (document) {\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.mozCancelFullScreen) {\r\n                document.mozCancelFullScreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n                document.webkitExitFullscreen();\r\n            }\r\n        },\r\n        /**\r\n         * 颜色字符串转换成rgb 16进制\r\n         * @method transHex\r\n         * @param color {string} 例:"#asdd00"\r\n         * @return {string} 16进制 例:"255,255,255"\r\n         */\r\n        transHex: cached(function (color) {\r\n            if (color && color.length == 7 && color.charAt(0) == \'#\') {\r\n                return [\r\n                    parseInt(color.substr(1, 2), 16),\r\n                    parseInt(color.substr(3, 2), 16),\r\n                    parseInt(color.substr(5, 2), 16)\r\n                ].join(\',\');\r\n            } else {\r\n                return color;\r\n            }\r\n        }),\r\n        /**\r\n         * 数组添加元素,如果数组中不存在则存入，否则不做操作\r\n         * @method arrayPush\r\n         * @param arr 操作的数组\r\n         * @param value 操作的元素\r\n         * @return {boolean} 操作是否成功\r\n         */\r\n        arrayPush: function (arr, value) {\r\n            if (arr.indexOf(value) < 0) {\r\n                arr.push(value);\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 数组删除元素,如果数组中不存在则删除，否则不做操作\r\n         * @method arrayDelete\r\n         * @param arr 操作的数组\r\n         * @param value 操作的元素\r\n         * @return {boolean} 操作是否成功\r\n         */\r\n        arrayDelete: function (arr, value) {\r\n            var i = arr.indexOf(value);\r\n            if (i >= 0) {\r\n                arr.splice(i, 1);\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 构造类继承关系\r\n         * @method inherits\r\n         * @param {Function} clazz 源类\r\n         * @param {Function} baseClazz 基类\r\n         */\r\n        inherits: function (clazz, baseClazz) {\r\n            var clazzPrototype = clazz.prototype;\r\n\r\n            function F() {\r\n            }\r\n\r\n            F.prototype = baseClazz.prototype;\r\n            clazz.prototype = new F();\r\n\r\n            for (var prop in clazzPrototype) {\r\n                clazz.prototype[prop] = clazzPrototype[prop];\r\n            }\r\n            clazz.constructor = clazz;\r\n        },\r\n        /**\r\n         * 深度克隆对象\r\n         * @method deepClone\r\n         * @param {object} obj 待克隆对象\r\n         * @return {object} 克隆后的新对象\r\n         */\r\n        deepClone: function (obj) {\r\n            var result, oClass = util.getClass(obj);\r\n            //确定result的类型\r\n            if (oClass === "Object") {\r\n                result = {};\r\n            } else if (oClass === "Array") {\r\n                result = [];\r\n            } else {\r\n                return obj;\r\n            }\r\n            for (key in obj) {\r\n                var copy = obj[key];\r\n                if (util.getClass(copy) == "Object") {\r\n                    result[key] = arguments.callee(copy);//递归调用\r\n                } else if ($.isArray(copy)) {\r\n                    result[key] = arguments.callee(copy);\r\n                } else {\r\n                    result[key] = obj[key];\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n        /**\r\n         * 获取对象的类\r\n         * @method getClass\r\n         * @param {object} o 待处理对象\r\n         * @return {string} 类名，如"Object","Array"\r\n         */\r\n        getClass: function (o) {\r\n            if (o === null) return "Null";\r\n            if (o === undefined) return "Undefined";\r\n            return Object.prototype.toString.call(o).slice(8, -1);\r\n        },\r\n        /**\r\n         * 加入时间戳的信息日志\r\n         * @method info\r\n         * @param {arguments} arguments\r\n         */\r\n        info: function () {\r\n            if (QTopo.log.info) {\r\n                console.info.apply(console, $.merge([util.dateFormat(new Date(), "hh:mm:ss")], arguments));\r\n            }\r\n        },\r\n        /**\r\n         * 加入时间戳的错误日志\r\n         * @method error\r\n         * @param {arguments} arguments\r\n         */\r\n        error: function () {\r\n            if (QTopo.log.error) {\r\n                console.error.apply(console, $.merge([util.dateFormat(new Date(), "hh:mm:ss")], arguments));\r\n            }\r\n        },\r\n        /**\r\n         * 格式化Date对象\r\n         * @method dateFormat\r\n         * @param {Date} date Date对象\r\n         * @param {string} ftString 格式化字符串,如"hh:mm:ss"\r\n         * @return {string}\r\n         */\r\n        dateFormat: function (date, ftString) {\r\n            if (date instanceof Date) {\r\n                var fomat = {\r\n                    "M+": date.getMonth() + 1, //月份\r\n                    "d+": date.getDate(), //日\r\n                    "h+": date.getHours(), //小时\r\n                    "m+": date.getMinutes(), //分\r\n                    "s+": date.getSeconds(), //秒\r\n                    "q+": Math.floor((date.getMonth() + 3) / 3), //季度\r\n                    "S": date.getMilliseconds() //毫秒\r\n                };\r\n                if (/(y+)/.test(ftString)) {\r\n                    ftString = ftString.replace(RegExp.$1, (date.getFullYear() + "")\r\n                        .substr(4 - RegExp.$1.length));\r\n                }\r\n                for (var type in fomat) {\r\n                    if (new RegExp("(" + type + ")").test(ftString)) {\r\n                        var temp;\r\n                        if (RegExp.$1.length == 1) {\r\n                            temp = fomat[type];\r\n                        } else {\r\n                            temp = ("00" + fomat[type]).substr(("" + fomat[type]).length);\r\n                        }\r\n                        ftString = ftString.replace(RegExp.$1, temp);\r\n                    }\r\n                }\r\n            }\r\n            return ftString;\r\n        },\r\n        /**\r\n         * 构造唯一Id字符串\r\n         * @method makeId\r\n         * @return {string}\r\n         */\r\n        makeId: function () {\r\n            return S4() + "-" + S4() + "-" + S4();\r\n        },\r\n        /**\r\n         * 判断对象是否是元素\r\n         * @method isElement\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isElement: function (target) {\r\n            return target &&target.getType &&target.getType() != QTopo.constant.SCENE && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是图层\r\n         * @method isScene\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isScene: function (target) {\r\n            return !target || target.getType() == QTopo.constant.SCENE;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是节点\r\n         * @method isNode\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isNode: function (target) {\r\n            return target && target.getType() == QTopo.constant.NODE && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是分组\r\n         * @method isContainer\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isContainer: function (target) {\r\n            return target && target.getType() == QTopo.constant.CONTAINER && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是链接\r\n         * @method isLink\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isLink: function (target) {\r\n            return target && target.getType() == QTopo.constant.LINK && target.getUseType() != QTopo.constant.CASUAL;\r\n        }\r\n    }\r\n    ;\r\nfunction S4() {\r\n    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n}\r\nmodule.exports = util;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL3V0aWwuanM/MjkyNiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixTQUFTO0FBQ2hDLHNCQUFzQixTQUFTO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEIsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DLG9DQUFvQztBQUNwQyw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0Esa0RBQWtEO0FBQ2xEO0FBQ0EsK0NBQStDO0FBQy9DLGlEQUFpRDtBQUNqRCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFNBQVM7QUFDcEMsMEJBQTBCLE9BQU87QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsU0FBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixTQUFTO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLE9BQU87QUFDaEMsb0JBQW9CLE9BQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsU0FBUztBQUM1QixtQkFBbUIsU0FBUztBQUM1QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlEO0FBQ3pELGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsT0FBTztBQUMxQixvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixVQUFVO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFVBQVU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsS0FBSztBQUN4QixtQkFBbUIsT0FBTztBQUMxQixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIFFUb3BvXHJcbiAqL1xyXG4vKipcclxuICogUVRvcG/pgJrnlKjlt6XlhbfljIVcclxuICogQGNsYXNzIFFUb3BvLnV0aWxcclxuICogQHN0YXRpY1xyXG4gKi9cclxuZnVuY3Rpb24gY2FjaGVkKGZuKSB7XHJcbiAgICB2YXIgY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgcmV0dXJuIChmdW5jdGlvbiBjYWNoZWRGbihzdHIpIHtcclxuICAgICAgICB2YXIgaGl0ID0gY2FjaGVbc3RyXTtcclxuICAgICAgICByZXR1cm4gaGl0IHx8IChjYWNoZVtzdHJdID0gZm4oc3RyKSlcclxuICAgIH0pXHJcbn1cclxuXHJcbnZhciB1dGlsID0ge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICDnu5nlh73mlbDmt7vliqDnvJPlrZjmnLrliLZcclxuICAgICAgICAgKiAgQG1ldGhvZCBjYWNoZWRcclxuICAgICAgICAgKiAgQHBhcmFtIGZuIHtmdW5jdGlvbn0g6ZyA5aSE55CG55qE5Ye95pWwXHJcbiAgICAgICAgICogIEByZXR1cm5zIHtmdW5jdGlvbn0g5aSE55CG6L+H55qE5Ye95pWwXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2FjaGVkOmNhY2hlZCxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlrZfnrKbkuLLovazljJZqc29uXHJcbiAgICAgICAgICogQG1ldGhvZCB0b0pzb25cclxuICAgICAgICAgKiBAcGFyYW0ganNvbiB7c3RyaW5nfG9iamVjdH1cclxuICAgICAgICAgKiBAcmV0dXJucyBqc29u5a+56LGhIHtqc29ufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvSnNvbjogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBqc29uID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICBqc29uID0gJC5wYXJzZUpTT04oanNvbi5yZXBsYWNlKC8nL2csICdcIicpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ganNvbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmmluWtl+avjeWkp+WGmVxyXG4gICAgICAgICAqIEBtZXRob2QgdXBGaXJzdFxyXG4gICAgICAgICAqIEBwYXJhbSBzdHJpbmcg5a2X56ym5LiyXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ30g6aaW5a2X5q+N5aSn5YaZ55qE5a2X56ym5LiyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdXBGaXJzdDogY2FjaGVkKGZ1bmN0aW9uIChzdHIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcclxuICAgICAgICB9KSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlr7nosaHmt7HluqblkIjlubbvvIzlj6rnu6fmib/ljp/lr7nosaHmnInnmoTlsZ7mgKdcclxuICAgICAgICAgKiBAbWV0aG9kIGV4dGVuZFxyXG4gICAgICAgICAqIEBwYXJhbSBiYXNlIOWOn+WvueixoVxyXG4gICAgICAgICAqIEBwYXJhbSBjb25maWcg5ZCI5bm25a+56LGhXHJcbiAgICAgICAgICogQHJldHVybnMge29iamVjdH0g5aSE55CG5a6M55qE5Y6f5a+56LGhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZXh0ZW5kOiBmdW5jdGlvbiAoYmFzZSwgY29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJhc2UgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgY29uZmlnID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWVwKGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic29tZSBleHRlbmQgZXJyb3I6XCIsIGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJleHRlbmQgZXJyb3JcIiwgZSwgYmFzZSwgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWVwKGF0dHIsIGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGF0dHIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJba2V5XSAmJiB0eXBlb2YgYXR0cltrZXldID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGNvbmZpZ1trZXldID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShhdHRyW2tleV0pICYmICQuaXNBcnJheShjb25maWdba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCQuaXNGdW5jdGlvbihhdHRyW2tleV0pICYmICQuaXNGdW5jdGlvbihjb25maWdba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVlcChhdHRyW2tleV0sIGNvbmZpZ1trZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGF0dHJba2V5XSAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBjb25maWdba2V5XSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gYmFzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlua1j+iniOWZqOi/nuaOpeS4iueahOWPguaVsFxyXG4gICAgICAgICAqIEBtZXRob2QgZ2V0UGFyYW1ldGVyXHJcbiAgICAgICAgICogQHBhcmFtIHBhcmFtIOWPguaVsOWQjVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0UGFyYW1ldGVyOiBmdW5jdGlvbiAocGFyYW0pIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDsvL+iOt+WPllVSTOWcsOWdgOS4re+8n+WQjueahOaJgOacieWtl+esplxyXG4gICAgICAgICAgICB2YXIgaUxlbiA9IHBhcmFtLmxlbmd0aDsvL+iOt+WPluS9oOeahOWPguaVsOWQjeensOmVv+W6plxyXG4gICAgICAgICAgICB2YXIgaVN0YXJ0ID0gcXVlcnkuaW5kZXhPZihwYXJhbSk7Ly/ojrflj5bkvaDor6Xlj4LmlbDlkI3np7DnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICAgICAgaWYgKGlTdGFydCA9PSAtMSkvLy0x5Li65rKh5pyJ6K+l5Y+C5pWwXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgaVN0YXJ0ICs9IGlMZW4gKyAxO1xyXG4gICAgICAgICAgICB2YXIgaUVuZCA9IHF1ZXJ5LmluZGV4T2YoXCImXCIsIGlTdGFydCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICAgICAgaWYgKGlFbmQgPT0gLTEpLy/lj6rmnInkuIDkuKrlj4LmlbBcclxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5zdWJzdHJpbmcoaVN0YXJ0KTsvL+iOt+WPluWNleS4quWPguaVsOeahOWPguaVsOWAvFxyXG4gICAgICAgICAgICByZXR1cm4gcXVlcnkuc3Vic3RyaW5nKGlTdGFydCwgaUVuZCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlgLxcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOS7heeUu+W4g+WFqOWxj+WxleekulxyXG4gICAgICAgICAqIEBtZXRob2QgcnVuUHJlZml4TWV0aG9kXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2RvY3VtZW50fSDkvos6Y2FudmFzXHJcbiAgICAgICAgICogQHBhcmFtIG1ldGhvZCB7c3RyaW5nfSBcIlJlcXVlc3RGdWxsU2NyZWVuXCLlhajlsY/nmoTmqKHlvI9cclxuICAgICAgICAgKi9cclxuICAgICAgICBydW5QcmVmaXhNZXRob2Q6IGZ1bmN0aW9uIChlbGVtZW50LCBtZXRob2QpIHtcclxuICAgICAgICAgICAgdmFyIHVzYWJsZVByZWZpeE1ldGhvZDtcclxuICAgICAgICAgICAgW1wid2Via2l0XCIsIFwibW96XCIsIFwibXNcIiwgXCJvXCIsIFwiXCJdLmZvckVhY2goZnVuY3Rpb24gKHByZWZpeCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2FibGVQcmVmaXhNZXRob2QpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJlZml4ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaXoOWJjee8gO+8jOaWueazlemmluWtl+avjeWwj+WGmVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSBtZXRob2Quc2xpY2UoMCwgMSkudG9Mb3dlckNhc2UoKSArIG1ldGhvZC5zbGljZSgxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGVQcmVmaXhNZXRob2QgPSB0eXBlb2YgZWxlbWVudFtwcmVmaXggKyBtZXRob2RdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlUHJlZml4TWV0aG9kICsgXCJcIiAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZVByZWZpeE1ldGhvZCA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FibGVQcmVmaXhNZXRob2QgPSBlbGVtZW50W3ByZWZpeCArIG1ldGhvZF0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWJsZVByZWZpeE1ldGhvZCA9IGVsZW1lbnRbcHJlZml4ICsgbWV0aG9kXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa1j+iniOWZqOWFqOWxj+WxleekulxyXG4gICAgICAgICAqIEBtZXRob2QgbGF1bmNoRnVsbFNjcmVlblxyXG4gICAgICAgICAqIEBwYXJhbSBlbGVtZW50IHtkb2N1bWVudH0g5L6LOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxhdW5jaEZ1bGxTY3JlZW46IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlhbPpl63mtY/op4jlmajlhajlsY9cclxuICAgICAgICAgKiBAbWV0aG9kIGV4aXRGdWxsU2NyZWVuXHJcbiAgICAgICAgICogQHBhcmFtIGRvY3VtZW50IHtkb2N1bWVudH0g5L6LOndpbmRvdy5kb2N1bWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGV4aXRGdWxsU2NyZWVuOiBmdW5jdGlvbiAoZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6aKc6Imy5a2X56ym5Liy6L2s5o2i5oiQcmdiIDE26L+b5Yi2XHJcbiAgICAgICAgICogQG1ldGhvZCB0cmFuc0hleFxyXG4gICAgICAgICAqIEBwYXJhbSBjb2xvciB7c3RyaW5nfSDkvos6XCIjYXNkZDAwXCJcclxuICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IDE26L+b5Yi2IOS+izpcIjI1NSwyNTUsMjU1XCJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmFuc0hleDogY2FjaGVkKGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgICAgICAgICBpZiAoY29sb3IgJiYgY29sb3IubGVuZ3RoID09IDcgJiYgY29sb3IuY2hhckF0KDApID09ICcjJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoMSwgMiksIDE2KSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoMywgMiksIDE2KSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoNSwgMiksIDE2KVxyXG4gICAgICAgICAgICAgICAgXS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29sb3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmlbDnu4Tmt7vliqDlhYPntKAs5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5a2Y5YWl77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICAgICAgICogQG1ldGhvZCBhcnJheVB1c2hcclxuICAgICAgICAgKiBAcGFyYW0gYXJyIOaTjeS9nOeahOaVsOe7hFxyXG4gICAgICAgICAqIEBwYXJhbSB2YWx1ZSDmk43kvZznmoTlhYPntKBcclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSDmk43kvZzmmK/lkKbmiJDlip9cclxuICAgICAgICAgKi9cclxuICAgICAgICBhcnJheVB1c2g6IGZ1bmN0aW9uIChhcnIsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChhcnIuaW5kZXhPZih2YWx1ZSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBhcnIucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmlbDnu4TliKDpmaTlhYPntKAs5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5Yig6Zmk77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICAgICAgICogQG1ldGhvZCBhcnJheURlbGV0ZVxyXG4gICAgICAgICAqIEBwYXJhbSBhcnIg5pON5L2c55qE5pWw57uEXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlIOaTjeS9nOeahOWFg+e0oFxyXG4gICAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IOaTjeS9nOaYr+WQpuaIkOWKn1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFycmF5RGVsZXRlOiBmdW5jdGlvbiAoYXJyLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IGFyci5pbmRleE9mKHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKGkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgYXJyLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaehOmAoOexu+e7p+aJv+WFs+ezu1xyXG4gICAgICAgICAqIEBtZXRob2QgaW5oZXJpdHNcclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjbGF6eiDmupDnsbtcclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBiYXNlQ2xhenog5Z+657G7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5oZXJpdHM6IGZ1bmN0aW9uIChjbGF6eiwgYmFzZUNsYXp6KSB7XHJcbiAgICAgICAgICAgIHZhciBjbGF6elByb3RvdHlwZSA9IGNsYXp6LnByb3RvdHlwZTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIEYoKSB7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIEYucHJvdG90eXBlID0gYmFzZUNsYXp6LnByb3RvdHlwZTtcclxuICAgICAgICAgICAgY2xhenoucHJvdG90eXBlID0gbmV3IEYoKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gY2xhenpQcm90b3R5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNsYXp6LnByb3RvdHlwZVtwcm9wXSA9IGNsYXp6UHJvdG90eXBlW3Byb3BdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNsYXp6LmNvbnN0cnVjdG9yID0gY2xheno7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmt7HluqblhYvpmoblr7nosaFcclxuICAgICAgICAgKiBAbWV0aG9kIGRlZXBDbG9uZVxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmog5b6F5YWL6ZqG5a+56LGhXHJcbiAgICAgICAgICogQHJldHVybiB7b2JqZWN0fSDlhYvpmoblkI7nmoTmlrDlr7nosaFcclxuICAgICAgICAgKi9cclxuICAgICAgICBkZWVwQ2xvbmU6IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCwgb0NsYXNzID0gdXRpbC5nZXRDbGFzcyhvYmopO1xyXG4gICAgICAgICAgICAvL+ehruWumnJlc3VsdOeahOexu+Wei1xyXG4gICAgICAgICAgICBpZiAob0NsYXNzID09PSBcIk9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChvQ2xhc3MgPT09IFwiQXJyYXlcIikge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvcHkgPSBvYmpba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICh1dGlsLmdldENsYXNzKGNvcHkpID09IFwiT2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGFyZ3VtZW50cy5jYWxsZWUoY29weSk7Ly/pgJLlvZLosIPnlKhcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJC5pc0FycmF5KGNvcHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBhcmd1bWVudHMuY2FsbGVlKGNvcHkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IG9ialtrZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blr7nosaHnmoTnsbtcclxuICAgICAgICAgKiBAbWV0aG9kIGdldENsYXNzXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IG8g5b6F5aSE55CG5a+56LGhXHJcbiAgICAgICAgICogQHJldHVybiB7c3RyaW5nfSDnsbvlkI3vvIzlpoJcIk9iamVjdFwiLFwiQXJyYXlcIlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldENsYXNzOiBmdW5jdGlvbiAobykge1xyXG4gICAgICAgICAgICBpZiAobyA9PT0gbnVsbCkgcmV0dXJuIFwiTnVsbFwiO1xyXG4gICAgICAgICAgICBpZiAobyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gXCJVbmRlZmluZWRcIjtcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliqDlhaXml7bpl7TmiLPnmoTkv6Hmga/ml6Xlv5dcclxuICAgICAgICAgKiBAbWV0aG9kIGluZm9cclxuICAgICAgICAgKiBAcGFyYW0ge2FyZ3VtZW50c30gYXJndW1lbnRzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5mbzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoUVRvcG8ubG9nLmluZm8pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mby5hcHBseShjb25zb2xlLCAkLm1lcmdlKFt1dGlsLmRhdGVGb3JtYXQobmV3IERhdGUoKSwgXCJoaDptbTpzc1wiKV0sIGFyZ3VtZW50cykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliqDlhaXml7bpl7TmiLPnmoTplJnor6/ml6Xlv5dcclxuICAgICAgICAgKiBAbWV0aG9kIGVycm9yXHJcbiAgICAgICAgICogQHBhcmFtIHthcmd1bWVudHN9IGFyZ3VtZW50c1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChRVG9wby5sb2cuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IuYXBwbHkoY29uc29sZSwgJC5tZXJnZShbdXRpbC5kYXRlRm9ybWF0KG5ldyBEYXRlKCksIFwiaGg6bW06c3NcIildLCBhcmd1bWVudHMpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5qC85byP5YyWRGF0ZeWvueixoVxyXG4gICAgICAgICAqIEBtZXRob2QgZGF0ZUZvcm1hdFxyXG4gICAgICAgICAqIEBwYXJhbSB7RGF0ZX0gZGF0ZSBEYXRl5a+56LGhXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGZ0U3RyaW5nIOagvOW8j+WMluWtl+espuS4sizlpoJcImhoOm1tOnNzXCJcclxuICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZGF0ZUZvcm1hdDogZnVuY3Rpb24gKGRhdGUsIGZ0U3RyaW5nKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvbWF0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiTStcIjogZGF0ZS5nZXRNb250aCgpICsgMSwgLy/mnIjku71cclxuICAgICAgICAgICAgICAgICAgICBcImQrXCI6IGRhdGUuZ2V0RGF0ZSgpLCAvL+aXpVxyXG4gICAgICAgICAgICAgICAgICAgIFwiaCtcIjogZGF0ZS5nZXRIb3VycygpLCAvL+Wwj+aXtlxyXG4gICAgICAgICAgICAgICAgICAgIFwibStcIjogZGF0ZS5nZXRNaW51dGVzKCksIC8v5YiGXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzK1wiOiBkYXRlLmdldFNlY29uZHMoKSwgLy/np5JcclxuICAgICAgICAgICAgICAgICAgICBcInErXCI6IE1hdGguZmxvb3IoKGRhdGUuZ2V0TW9udGgoKSArIDMpIC8gMyksIC8v5a2j5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgXCJTXCI6IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCkgLy/mr6vnp5JcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAoLyh5KykvLnRlc3QoZnRTdHJpbmcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnRTdHJpbmcgPSBmdFN0cmluZy5yZXBsYWNlKFJlZ0V4cC4kMSwgKGRhdGUuZ2V0RnVsbFllYXIoKSArIFwiXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWJzdHIoNCAtIFJlZ0V4cC4kMS5sZW5ndGgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gZm9tYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChcIihcIiArIHR5cGUgKyBcIilcIikudGVzdChmdFN0cmluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChSZWdFeHAuJDEubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBmb21hdFt0eXBlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSAoXCIwMFwiICsgZm9tYXRbdHlwZV0pLnN1YnN0cigoXCJcIiArIGZvbWF0W3R5cGVdKS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ0U3RyaW5nID0gZnRTdHJpbmcucmVwbGFjZShSZWdFeHAuJDEsIHRlbXApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZnRTdHJpbmc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmnoTpgKDllK/kuIBJZOWtl+espuS4slxyXG4gICAgICAgICAqIEBtZXRob2QgbWFrZUlkXHJcbiAgICAgICAgICogQHJldHVybiB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG1ha2VJZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUzQoKSArIFwiLVwiICsgUzQoKSArIFwiLVwiICsgUzQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIpOaWreWvueixoeaYr+WQpuaYr+WFg+e0oFxyXG4gICAgICAgICAqIEBtZXRob2QgaXNFbGVtZW50XHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0VsZW1lbnQ6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldCAmJnRhcmdldC5nZXRUeXBlICYmdGFyZ2V0LmdldFR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5TQ0VORSAmJiB0YXJnZXQuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIpOaWrVFUb3Bv5a+56LGh5piv5ZCm5piv5Zu+5bGCXHJcbiAgICAgICAgICogQG1ldGhvZCBpc1NjZW5lXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc1NjZW5lOiBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhdGFyZ2V0IHx8IHRhcmdldC5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuU0NFTkU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliKTmlq1RVG9wb+WvueixoeaYr+WQpuaYr+iKgueCuVxyXG4gICAgICAgICAqIEBtZXRob2QgaXNOb2RlXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc05vZGU6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldCAmJiB0YXJnZXQuZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50Lk5PREUgJiYgdGFyZ2V0LmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliKTmlq1RVG9wb+WvueixoeaYr+WQpuaYr+WIhue7hFxyXG4gICAgICAgICAqIEBtZXRob2QgaXNDb250YWluZXJcclxuICAgICAgICAgKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzQ29udGFpbmVyOiBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQgJiYgdGFyZ2V0LmdldFR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5DT05UQUlORVIgJiYgdGFyZ2V0LmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliKTmlq1RVG9wb+WvueixoeaYr+WQpuaYr+mTvuaOpVxyXG4gICAgICAgICAqIEBtZXRob2QgaXNMaW5rXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0xpbms6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldCAmJiB0YXJnZXQuZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkxJTksgJiYgdGFyZ2V0LmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgO1xyXG5mdW5jdGlvbiBTNCgpIHtcclxuICAgIHJldHVybiAoKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKSB8IDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSB1dGlsO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC91dGlsLmpzXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9');
},,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 容器基类,用以继承 [E]开头继承于Element,[C]开头为自身api\r\n * @class [C] Container\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\n\r\nvar Element = __webpack_require__(1);\r\nmodule.exports = Container;\r\nfunction Container(jtopo) {\r\n    if (jtopo) {\r\n        Element.call(this, jtopo);\r\n    } else {\r\n        QTopo.util.error("create Container without jtopo", this);\r\n    }\r\n    /**\r\n     * 记录容器内的元素\r\n     * @property [C] children {array}\r\n     */\r\n    this.children = [];\r\n    /**\r\n     * 记录容器上的链路\r\n     * @property [C] links {array}\r\n     * @param in 以容器为终点的链路\r\n     * @param out 以容器为起点的链路\r\n     */\r\n    this.links = {\r\n        in: [],\r\n        out: []\r\n    };\r\n}\r\nQTopo.util.inherits(Container, Element);\r\n/**\r\n *  设置容器名称\r\n *  @method [C] setName\r\n *  @param name {string}\r\n */\r\nContainer.prototype.setName = function (name) {\r\n    if (name) {\r\n        if (this.attr.namePosition != "hide") {\r\n            this.jtopo.text = name.trim();\r\n        }\r\n        this.attr.name = name.trim();\r\n    }\r\n};\r\n/**\r\n *  将元素加入容器内\r\n *  @method [C] add\r\n *  @param element {element|array} 一般为节点类型对象或数组，容器加入容器容易产生Bug\r\n */\r\nContainer.prototype.add = function (element) {\r\n    var self=this;\r\n    if (!$.isArray(this.children)) {\r\n        this.children = [];\r\n    }\r\n    if ($.isArray(element)) {\r\n        $.each(element,function(i,el){\r\n            addOnce(el);\r\n        });\r\n    }else{\r\n        addOnce(element);\r\n    }\r\n    function addOnce(element){\r\n        if (element&&check(element)&&!self.isChild(element)) {\r\n            self.children.push(element);\r\n            element.parent = self;\r\n            self.jtopo.add(element.jtopo);\r\n            if (self.attr.children && typeof self.attr.children.draggable == "boolean") {\r\n                //若分组不允许移动组内元素，手动设置元素不可移动\r\n                element.setDraggable(self.attr.children.draggable);\r\n            }\r\n        }\r\n    }\r\n    function check(element){\r\n        return element.getType()==QTopo.constant.NODE&&element.getUseType()!=QTopo.constant.CASUAL&&!element.parent;\r\n    }\r\n};\r\n/**\r\n * 将子元素从容器中删除\r\n * @method [C] remove\r\n * @param element {element}\r\n */\r\nContainer.prototype.remove = function (element) {\r\n    if ($.isArray(this.children) && this.isChild(element)) {\r\n        this.children.splice(this.children.indexOf(element), 1);\r\n        delete element.parent;\r\n        this.jtopo.remove(element.jtopo);\r\n        //移除元素，应手动设回元素可移动\r\n        element.setDraggable(true);\r\n    }\r\n};\r\n/**\r\n * 获取容器基本类型\r\n * @method [C] getType\r\n * @return QTopo.constant.CONTAINER\r\n */\r\nContainer.prototype.getType = function () {\r\n    return QTopo.constant.CONTAINER;\r\n};\r\n/**\r\n * 设置容器背景色\r\n * @method [C] setColor\r\n * @param color {string} "255,255,255"/"#ffffff"\r\n */\r\nContainer.prototype.setColor = function (color) {\r\n    if (color) {\r\n        color = QTopo.util.transHex(color.toLowerCase());\r\n        this.jtopo.fillColor = color;\r\n    }\r\n    this.attr.color = this.jtopo.fillColor;\r\n};\r\n/**\r\n * 设置容器内子元素一般行为,未完全实现\r\n * @method [C] setChildren\r\n * @param children {object}\r\n *          children={\r\n *                  draggable:是否可移动{boolean}\r\n *          }\r\n */\r\nContainer.prototype.setChildren = function (children) {\r\n    var jtopo = this.jtopo;\r\n    if (children) {\r\n        if (typeof children.draggable == "boolean") {\r\n            this.jtopo.childDraggable = children.draggable;\r\n            for (var i = 0; i < this.children.length; i++) {\r\n                this.children[i].setDraggable(children.draggable);\r\n            }\r\n        }\r\n    }\r\n    this.attr.children.draggable = jtopo.childDraggable;\r\n};\r\n/**\r\n * 容器缩放切换,在scene创建时可选是否提供切换\r\n *\r\n * 可在创建时增加参数 toggle:{close:true}来创建一个不可切换的容器\r\n *\r\n * 若无切换对象，则该方法无动作\r\n * @method [C] toggle\r\n * @param [flag] 为true则强制缩放，为false则强制展开，无值则自适应切换,\r\n */\r\nContainer.prototype.toggle = function (flag) {\r\n    if (this.toggleTo) {\r\n        var gJtopo = this.jtopo;\r\n        var nJtopo = this.toggleTo.jtopo;\r\n        var todo = typeof flag == "boolean" ? flag : gJtopo.visible;\r\n        if (todo) {\r\n            //缩放\r\n            this.hide();\r\n            this.toggleTo.show();\r\n            this.toggleTo.setPosition([gJtopo.cx - nJtopo.width / 2, gJtopo.cy - nJtopo.height / 2]);\r\n        } else {\r\n            //展开\r\n            this.show();\r\n            this.toggleTo.hide();\r\n            this.setPosition([nJtopo.cx - gJtopo.width / 2, nJtopo.cy - gJtopo.height / 2]);\r\n        }\r\n    }\r\n};\r\n/**\r\n * 判断元素是否已是子元素\r\n * @method [C] isChild\r\n * @param element 判断的子元素\r\n * @return {boolean}\r\n */\r\nContainer.prototype.isChild = function (element) {\r\n    if ($.isArray(this.children)) {\r\n        var index=this.children.indexOf(element);\r\n        if (element.parent != this&& index> -1) {\r\n            QTopo.util.error("some group get error,the child\'s parent is not it and the child in its children,index is "+index, this,element);\r\n        }\r\n        return index>-1;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n/**\r\n * 判断元素是否在分组覆盖的范围内,临时元素不考虑\r\n * @method [C] isInside\r\n * @param element 判断的元素\r\n * @return {boolean}\r\n */\r\nContainer.prototype.isInside = function (element) {\r\n    if (element && element.getType() != QTopo.constant.CASUAL) {\r\n        var center = element.getCenterPosition();\r\n        return !this.isChild(element) && center.x > this.x && center.x < (this.x + this.width) && center.y > this.y && center.y < (this.y + this.height);\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n/**\r\n * 分组属性提取\r\n * @method [C] toJson\r\n * @return {object}\r\n */\r\nContainer.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    json.children=[];\r\n    this.children.map(function(child){\r\n        json.children.push(child.get(\'jsonId\'));\r\n    });\r\n    json.toggle=this.toggleTo.toJson();\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvQ29udGFpbmVyLmpzPzNhZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGNBQWM7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMEJBQTBCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixXQUFXO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSIsImZpbGUiOiIyNy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlrrnlmajln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW0Nd5byA5aS05Li66Ieq6LqrYXBpXHJcbiAqIEBjbGFzcyBbQ10gQ29udGFpbmVyXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcblxyXG52YXIgRWxlbWVudCA9IHJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRhaW5lcjtcclxuZnVuY3Rpb24gQ29udGFpbmVyKGp0b3BvKSB7XHJcbiAgICBpZiAoanRvcG8pIHtcclxuICAgICAgICBFbGVtZW50LmNhbGwodGhpcywganRvcG8pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIENvbnRhaW5lciB3aXRob3V0IGp0b3BvXCIsIHRoaXMpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDorrDlvZXlrrnlmajlhoXnmoTlhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBbQ10gY2hpbGRyZW4ge2FycmF5fVxyXG4gICAgICovXHJcbiAgICB0aGlzLmNoaWxkcmVuID0gW107XHJcbiAgICAvKipcclxuICAgICAqIOiusOW9leWuueWZqOS4iueahOmTvui3r1xyXG4gICAgICogQHByb3BlcnR5IFtDXSBsaW5rcyB7YXJyYXl9XHJcbiAgICAgKiBAcGFyYW0gaW4g5Lul5a655Zmo5Li657uI54K555qE6ZO+6LevXHJcbiAgICAgKiBAcGFyYW0gb3V0IOS7peWuueWZqOS4uui1t+eCueeahOmTvui3r1xyXG4gICAgICovXHJcbiAgICB0aGlzLmxpbmtzID0ge1xyXG4gICAgICAgIGluOiBbXSxcclxuICAgICAgICBvdXQ6IFtdXHJcbiAgICB9O1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoQ29udGFpbmVyLCBFbGVtZW50KTtcclxuLyoqXHJcbiAqICDorr7nva7lrrnlmajlkI3np7BcclxuICogIEBtZXRob2QgW0NdIHNldE5hbWVcclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9XHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnNldE5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgaWYgKG5hbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5hdHRyLm5hbWVQb3NpdGlvbiAhPSBcImhpZGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSBuYW1lLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLm5hbWUgPSBuYW1lLnRyaW0oKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDlsIblhYPntKDliqDlhaXlrrnlmajlhoVcclxuICogIEBtZXRob2QgW0NdIGFkZFxyXG4gKiAgQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR8YXJyYXl9IOS4gOiIrOS4uuiKgueCueexu+Wei+WvueixoeaIluaVsOe7hO+8jOWuueWZqOWKoOWFpeWuueWZqOWuueaYk+S6p+eUn0J1Z1xyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgdmFyIHNlbGY9dGhpcztcclxuICAgIGlmICghJC5pc0FycmF5KHRoaXMuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xyXG4gICAgfVxyXG4gICAgaWYgKCQuaXNBcnJheShlbGVtZW50KSkge1xyXG4gICAgICAgICQuZWFjaChlbGVtZW50LGZ1bmN0aW9uKGksZWwpe1xyXG4gICAgICAgICAgICBhZGRPbmNlKGVsKTtcclxuICAgICAgICB9KTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGFkZE9uY2UoZWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBhZGRPbmNlKGVsZW1lbnQpe1xyXG4gICAgICAgIGlmIChlbGVtZW50JiZjaGVjayhlbGVtZW50KSYmIXNlbGYuaXNDaGlsZChlbGVtZW50KSkge1xyXG4gICAgICAgICAgICBzZWxmLmNoaWxkcmVuLnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50ID0gc2VsZjtcclxuICAgICAgICAgICAgc2VsZi5qdG9wby5hZGQoZWxlbWVudC5qdG9wbyk7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLmF0dHIuY2hpbGRyZW4gJiYgdHlwZW9mIHNlbGYuYXR0ci5jaGlsZHJlbi5kcmFnZ2FibGUgPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgICAgIC8v6Iul5YiG57uE5LiN5YWB6K6456e75Yqo57uE5YaF5YWD57Sg77yM5omL5Yqo6K6+572u5YWD57Sg5LiN5Y+v56e75YqoXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldERyYWdnYWJsZShzZWxmLmF0dHIuY2hpbGRyZW4uZHJhZ2dhYmxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNoZWNrKGVsZW1lbnQpe1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50LmdldFR5cGUoKT09UVRvcG8uY29uc3RhbnQuTk9ERSYmZWxlbWVudC5nZXRVc2VUeXBlKCkhPVFUb3BvLmNvbnN0YW50LkNBU1VBTCYmIWVsZW1lbnQucGFyZW50O1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog5bCG5a2Q5YWD57Sg5LuO5a655Zmo5Lit5Yig6ZmkXHJcbiAqIEBtZXRob2QgW0NdIHJlbW92ZVxyXG4gKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgIGlmICgkLmlzQXJyYXkodGhpcy5jaGlsZHJlbikgJiYgdGhpcy5pc0NoaWxkKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UodGhpcy5jaGlsZHJlbi5pbmRleE9mKGVsZW1lbnQpLCAxKTtcclxuICAgICAgICBkZWxldGUgZWxlbWVudC5wYXJlbnQ7XHJcbiAgICAgICAgdGhpcy5qdG9wby5yZW1vdmUoZWxlbWVudC5qdG9wbyk7XHJcbiAgICAgICAgLy/np7vpmaTlhYPntKDvvIzlupTmiYvliqjorr7lm57lhYPntKDlj6/np7vliqhcclxuICAgICAgICBlbGVtZW50LnNldERyYWdnYWJsZSh0cnVlKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWuueWZqOWfuuacrOexu+Wei1xyXG4gKiBAbWV0aG9kIFtDXSBnZXRUeXBlXHJcbiAqIEByZXR1cm4gUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSXHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSO1xyXG59O1xyXG4vKipcclxuICog6K6+572u5a655Zmo6IOM5pmv6ImyXHJcbiAqIEBtZXRob2QgW0NdIHNldENvbG9yXHJcbiAqIEBwYXJhbSBjb2xvciB7c3RyaW5nfSBcIjI1NSwyNTUsMjU1XCIvXCIjZmZmZmZmXCJcclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUuc2V0Q29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgIGNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvci50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICB0aGlzLmp0b3BvLmZpbGxDb2xvciA9IGNvbG9yO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmNvbG9yID0gdGhpcy5qdG9wby5maWxsQ29sb3I7XHJcbn07XHJcbi8qKlxyXG4gKiDorr7nva7lrrnlmajlhoXlrZDlhYPntKDkuIDoiKzooYzkuLos5pyq5a6M5YWo5a6e546wXHJcbiAqIEBtZXRob2QgW0NdIHNldENoaWxkcmVuXHJcbiAqIEBwYXJhbSBjaGlsZHJlbiB7b2JqZWN0fVxyXG4gKiAgICAgICAgICBjaGlsZHJlbj17XHJcbiAqICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlOuaYr+WQpuWPr+enu+WKqHtib29sZWFufVxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnNldENoaWxkcmVuID0gZnVuY3Rpb24gKGNoaWxkcmVuKSB7XHJcbiAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgaWYgKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBjaGlsZHJlbi5kcmFnZ2FibGUgPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5jaGlsZERyYWdnYWJsZSA9IGNoaWxkcmVuLmRyYWdnYWJsZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLnNldERyYWdnYWJsZShjaGlsZHJlbi5kcmFnZ2FibGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmNoaWxkcmVuLmRyYWdnYWJsZSA9IGp0b3BvLmNoaWxkRHJhZ2dhYmxlO1xyXG59O1xyXG4vKipcclxuICog5a655Zmo57yp5pS+5YiH5o2iLOWcqHNjZW5l5Yib5bu65pe25Y+v6YCJ5piv5ZCm5o+Q5L6b5YiH5o2iXHJcbiAqXHJcbiAqIOWPr+WcqOWIm+W7uuaXtuWinuWKoOWPguaVsCB0b2dnbGU6e2Nsb3NlOnRydWV95p2l5Yib5bu65LiA5Liq5LiN5Y+v5YiH5o2i55qE5a655ZmoXHJcbiAqXHJcbiAqIOiLpeaXoOWIh+aNouWvueixoe+8jOWImeivpeaWueazleaXoOWKqOS9nFxyXG4gKiBAbWV0aG9kIFtDXSB0b2dnbGVcclxuICogQHBhcmFtIFtmbGFnXSDkuLp0cnVl5YiZ5by65Yi257yp5pS+77yM5Li6ZmFsc2XliJnlvLrliLblsZXlvIDvvIzml6DlgLzliJnoh6rpgILlupTliIfmjaIsXHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICBpZiAodGhpcy50b2dnbGVUbykge1xyXG4gICAgICAgIHZhciBnSnRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgICAgIHZhciBuSnRvcG8gPSB0aGlzLnRvZ2dsZVRvLmp0b3BvO1xyXG4gICAgICAgIHZhciB0b2RvID0gdHlwZW9mIGZsYWcgPT0gXCJib29sZWFuXCIgPyBmbGFnIDogZ0p0b3BvLnZpc2libGU7XHJcbiAgICAgICAgaWYgKHRvZG8pIHtcclxuICAgICAgICAgICAgLy/nvKnmlL5cclxuICAgICAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlVG8uc2hvdygpO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRvLnNldFBvc2l0aW9uKFtnSnRvcG8uY3ggLSBuSnRvcG8ud2lkdGggLyAyLCBnSnRvcG8uY3kgLSBuSnRvcG8uaGVpZ2h0IC8gMl0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8v5bGV5byAXHJcbiAgICAgICAgICAgIHRoaXMuc2hvdygpO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRvLmhpZGUoKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvbihbbkp0b3BvLmN4IC0gZ0p0b3BvLndpZHRoIC8gMiwgbkp0b3BvLmN5IC0gZ0p0b3BvLmhlaWdodCAvIDJdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDliKTmlq3lhYPntKDmmK/lkKblt7LmmK/lrZDlhYPntKBcclxuICogQG1ldGhvZCBbQ10gaXNDaGlsZFxyXG4gKiBAcGFyYW0gZWxlbWVudCDliKTmlq3nmoTlrZDlhYPntKBcclxuICogQHJldHVybiB7Ym9vbGVhbn1cclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUuaXNDaGlsZCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICBpZiAoJC5pc0FycmF5KHRoaXMuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgdmFyIGluZGV4PXRoaXMuY2hpbGRyZW4uaW5kZXhPZihlbGVtZW50KTtcclxuICAgICAgICBpZiAoZWxlbWVudC5wYXJlbnQgIT0gdGhpcyYmIGluZGV4PiAtMSkge1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic29tZSBncm91cCBnZXQgZXJyb3IsdGhlIGNoaWxkJ3MgcGFyZW50IGlzIG5vdCBpdCBhbmQgdGhlIGNoaWxkIGluIGl0cyBjaGlsZHJlbixpbmRleCBpcyBcIitpbmRleCwgdGhpcyxlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGluZGV4Pi0xO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDliKTmlq3lhYPntKDmmK/lkKblnKjliIbnu4Topobnm5bnmoTojIPlm7TlhoUs5Li05pe25YWD57Sg5LiN6ICD6JmRXHJcbiAqIEBtZXRob2QgW0NdIGlzSW5zaWRlXHJcbiAqIEBwYXJhbSBlbGVtZW50IOWIpOaWreeahOWFg+e0oFxyXG4gKiBAcmV0dXJuIHtib29sZWFufVxyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS5pc0luc2lkZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50LmdldFR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICB2YXIgY2VudGVyID0gZWxlbWVudC5nZXRDZW50ZXJQb3NpdGlvbigpO1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5pc0NoaWxkKGVsZW1lbnQpICYmIGNlbnRlci54ID4gdGhpcy54ICYmIGNlbnRlci54IDwgKHRoaXMueCArIHRoaXMud2lkdGgpICYmIGNlbnRlci55ID4gdGhpcy55ICYmIGNlbnRlci55IDwgKHRoaXMueSArIHRoaXMuaGVpZ2h0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog5YiG57uE5bGe5oCn5o+Q5Y+WXHJcbiAqIEBtZXRob2QgW0NdIHRvSnNvblxyXG4gKiBAcmV0dXJuIHtvYmplY3R9XHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnRvSnNvbj1mdW5jdGlvbigpe1xyXG4gICAgdmFyIGpzb249JC5leHRlbmQoe30sdGhpcy5hdHRyKTtcclxuICAgIGpzb24uZXh0cmE9JC5leHRlbmQoe30sdGhpcy5leHRyYSk7XHJcbiAgICBqc29uLmNoaWxkcmVuPVtdO1xyXG4gICAgdGhpcy5jaGlsZHJlbi5tYXAoZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIGpzb24uY2hpbGRyZW4ucHVzaChjaGlsZC5nZXQoJ2pzb25JZCcpKTtcclxuICAgIH0pO1xyXG4gICAganNvbi50b2dnbGU9dGhpcy50b2dnbGVUby50b0pzb24oKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvY29udGFpbmVyL0NvbnRhaW5lci5qc1xuLy8gbW9kdWxlIGlkID0gMjdcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  Group\r\n * @constructor\r\n * @extends [C] Container\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Container=__webpack_require__(27);\r\nmodule.exports =  {\r\n    constructor:Group,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n        name: \'group\',\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        color: \'10,10,100\',\r\n        alpha: 0.5,\r\n        draggable: true,\r\n        zIndex: 10,\r\n        jsonId:"",\r\n        border:{\r\n            width:0,\r\n            radius:30,//最大160 最小0\r\n            color:"255,0,0"\r\n        },\r\n        size:[500,500],\r\n        position:[0,0],\r\n        namePosition: \'bottom\',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n        layout: {\r\n            type:"default"\r\n        },\r\n        children:{\r\n            showLink: false,\r\n            showName: true,\r\n            draggable: true\r\n        },\r\n        useType:QTopo.constant.container.GROUP\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//----\r\n//----\r\nfunction Group(config) {\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    Container.call(this, new JTopo.Container());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(Group,Container);\r\n//-\r\nvar fixedLayout=function(group, children){\r\n    if(this.qtopo){\r\n        if(group.width==0||group.height==0){\r\n            group.width=this.qtopo.attr.size[0];\r\n            group.height=this.qtopo.attr.size[1];\r\n        }\r\n        if(group.width>0&&group.height>0){\r\n            var groupBound=group.getBound();\r\n            children.map(function(child){\r\n                resetLocation(groupBound,child);\r\n            });\r\n        }else{\r\n            //若未设置高宽则运行一次自动布局设置高宽\r\n            JTopo.Layout.AutoBoundLayout()(group, children);\r\n        }\r\n    }else{\r\n        QTopo.util.error("the container not wrap with qtopo",this);\r\n    }\r\n};\r\nfunction resetLocation(groupBound,child){\r\n    var childBound=child.getBound();\r\n    var location=child.getLocation();\r\n    if(childBound.bottom>groupBound.bottom){\r\n        location.y=groupBound.bottom-childBound.height;\r\n    }\r\n    if(childBound.right>groupBound.right){\r\n        location.x=groupBound.right-childBound.width;\r\n    }\r\n    if(childBound.left<groupBound.left){\r\n        location.x=groupBound.left;\r\n    }\r\n    if(childBound.top<groupBound.top){\r\n        location.y=groupBound.top;\r\n    }\r\n    child.setLocation(location.x,location.y);\r\n}\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n *\r\n *  @method setLayout\r\n *  @param layout {object} 图片相对路径\r\n *      @param layout.type {string} flow(固定宽高,组员流式布局), grid(固定宽高,组员行列布局), fixed(固定宽高,组员可拖动), default(宽高自适应)\r\n *      @param [layout.row] {number} 当type=flow时,用以设置水平间隔 ,当type=grid时,用以设置行数\r\n *      @param [layout.column] {number} 当type=flow时,用以设置垂直间隔 ,当type=grid时,用以设置列数\r\n */\r\nGroup.prototype.setLayout=function(layout){\r\n    var selected;\r\n    if (layout) {\r\n        switch (layout.type) {\r\n            case \'flow\':\r\n                // 流式布局（水平,垂直间隔)\r\n                selected = JTopo.layout.FlowLayout(parseInt(layout.row), parseInt(layout.column));\r\n                this.attr.layout=layout;\r\n                break;\r\n            case \'grid\':\r\n                // 网格布局(行,列)\r\n                var rows=parseInt(layout.row);\r\n                var columns=parseInt(layout.column);\r\n                if(rows*columns<this.children.length){\r\n                    QTopo.util.error("GridLayout\'s row*column need bigger than group\'s children length");\r\n                    columns=rows= Math.ceil(Math.sqrt(todo.target.children.length));\r\n                }\r\n                selected = JTopo.layout.GridLayout(rows,columns);\r\n                this.attr.layout=layout;\r\n                break;\r\n            case \'fixed\':\r\n                //固定长宽布局\r\n                selected = fixedLayout;\r\n                this.attr.layout=layout;\r\n                break;\r\n            default:\r\n                selected = JTopo.Layout.AutoBoundLayout();\r\n                this.attr.layout={};\r\n                this.attr.layout.type="default";\r\n        }\r\n    } else {\r\n        selected = JTopo.Layout.AutoBoundLayout();\r\n        this.attr.layout={};\r\n        this.attr.layout.type="default";\r\n    }\r\n    this.jtopo.layout = selected;\r\n};\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT = {\r\n                                name: \'group\',\r\n                                font:{\r\n                                    size:16,\r\n                                    type:"微软雅黑",\r\n                                    color:\'255,255,255\'\r\n                                },\r\n                                color: \'10,10,100\',\r\n                                alpha: 0.5,\r\n                                draggable: true,\r\n                                zIndex: 10,\r\n                                jsonId:"",\r\n                                border:{\r\n                                    width:0,\r\n                                    radius:30,//最大160 最小0\r\n                                    color:"255,0,0"\r\n                                },\r\n                                size:[500,500],\r\n                                position:[0,0],\r\n                                namePosition: \'bottom\',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n                                layout: {\r\n                                    type:"default"\r\n                                },\r\n                                children:{//待定设置，未完全实现\r\n                                    showLink: false,\r\n                                    showName: true,\r\n                                    draggable: true\r\n                                },\r\n                                useType:QTopo.constant.container.GROUP\r\n                        };\r\n */\r\nGroup.prototype.getDefault=getDefault;\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanM/YjdmYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCLDRCQUE0QixPQUFPO0FBQ25DLDZCQUE2QixPQUFPO0FBQ3BDLGdDQUFnQyxPQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjI4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOWbvuW9ouiKgueCuVxyXG4gKiBAY2xhc3MgIEdyb3VwXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbQ10gQ29udGFpbmVyXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBDb250YWluZXI9cmVxdWlyZShcIi4vQ29udGFpbmVyLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9ICB7XHJcbiAgICBjb25zdHJ1Y3RvcjpHcm91cCxcclxuICAgIHNldERlZmF1bHQ6c2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6Z2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQgPSB7XHJcbiAgICAgICAgbmFtZTogJ2dyb3VwJyxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb2xvcjogJzEwLDEwLDEwMCcsXHJcbiAgICAgICAgYWxwaGE6IDAuNSxcclxuICAgICAgICBkcmFnZ2FibGU6IHRydWUsXHJcbiAgICAgICAgekluZGV4OiAxMCxcclxuICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICBib3JkZXI6e1xyXG4gICAgICAgICAgICB3aWR0aDowLFxyXG4gICAgICAgICAgICByYWRpdXM6MzAsLy/mnIDlpKcxNjAg5pyA5bCPMFxyXG4gICAgICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2l6ZTpbNTAwLDUwMF0sXHJcbiAgICAgICAgcG9zaXRpb246WzAsMF0sXHJcbiAgICAgICAgbmFtZVBvc2l0aW9uOiAnYm90dG9tJywvL0JvdHRvbV9DZW50ZXIgVG9wX0NlbnRlciBNaWRkbGVfTGVmdCBNaWRkbGVfUmlnaHQgSGlkZGVuLFxyXG4gICAgICAgIGxheW91dDoge1xyXG4gICAgICAgICAgICB0eXBlOlwiZGVmYXVsdFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjaGlsZHJlbjp7XHJcbiAgICAgICAgICAgIHNob3dMaW5rOiBmYWxzZSxcclxuICAgICAgICAgICAgc2hvd05hbWU6IHRydWUsXHJcbiAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXNlVHlwZTpRVG9wby5jb25zdGFudC5jb250YWluZXIuR1JPVVBcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpe1xyXG4gICAgUVRvcG8udXRpbC5leHRlbmQoREVGQVVMVCwgY29uZmlnIHx8IHt9KTtcclxufVxyXG5mdW5jdGlvbiBnZXREZWZhdWx0KCl7XHJcbiAgICByZXR1cm4gUVRvcG8udXRpbC5kZWVwQ2xvbmUoREVGQVVMVCk7XHJcbn1cclxuLy8tXHJcbi8vLS0tLVxyXG4vLy0tLS1cclxuZnVuY3Rpb24gR3JvdXAoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSAgUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgQ29udGFpbmVyLmNhbGwodGhpcywgbmV3IEpUb3BvLkNvbnRhaW5lcigpKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhHcm91cCxDb250YWluZXIpO1xyXG4vLy1cclxudmFyIGZpeGVkTGF5b3V0PWZ1bmN0aW9uKGdyb3VwLCBjaGlsZHJlbil7XHJcbiAgICBpZih0aGlzLnF0b3BvKXtcclxuICAgICAgICBpZihncm91cC53aWR0aD09MHx8Z3JvdXAuaGVpZ2h0PT0wKXtcclxuICAgICAgICAgICAgZ3JvdXAud2lkdGg9dGhpcy5xdG9wby5hdHRyLnNpemVbMF07XHJcbiAgICAgICAgICAgIGdyb3VwLmhlaWdodD10aGlzLnF0b3BvLmF0dHIuc2l6ZVsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZ3JvdXAud2lkdGg+MCYmZ3JvdXAuaGVpZ2h0PjApe1xyXG4gICAgICAgICAgICB2YXIgZ3JvdXBCb3VuZD1ncm91cC5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5tYXAoZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgICAgICAgICAgcmVzZXRMb2NhdGlvbihncm91cEJvdW5kLGNoaWxkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8v6Iul5pyq6K6+572u6auY5a695YiZ6L+Q6KGM5LiA5qyh6Ieq5Yqo5biD5bGA6K6+572u6auY5a69XHJcbiAgICAgICAgICAgIEpUb3BvLkxheW91dC5BdXRvQm91bmRMYXlvdXQoKShncm91cCwgY2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH1lbHNle1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJ0aGUgY29udGFpbmVyIG5vdCB3cmFwIHdpdGggcXRvcG9cIix0aGlzKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gcmVzZXRMb2NhdGlvbihncm91cEJvdW5kLGNoaWxkKXtcclxuICAgIHZhciBjaGlsZEJvdW5kPWNoaWxkLmdldEJvdW5kKCk7XHJcbiAgICB2YXIgbG9jYXRpb249Y2hpbGQuZ2V0TG9jYXRpb24oKTtcclxuICAgIGlmKGNoaWxkQm91bmQuYm90dG9tPmdyb3VwQm91bmQuYm90dG9tKXtcclxuICAgICAgICBsb2NhdGlvbi55PWdyb3VwQm91bmQuYm90dG9tLWNoaWxkQm91bmQuaGVpZ2h0O1xyXG4gICAgfVxyXG4gICAgaWYoY2hpbGRCb3VuZC5yaWdodD5ncm91cEJvdW5kLnJpZ2h0KXtcclxuICAgICAgICBsb2NhdGlvbi54PWdyb3VwQm91bmQucmlnaHQtY2hpbGRCb3VuZC53aWR0aDtcclxuICAgIH1cclxuICAgIGlmKGNoaWxkQm91bmQubGVmdDxncm91cEJvdW5kLmxlZnQpe1xyXG4gICAgICAgIGxvY2F0aW9uLng9Z3JvdXBCb3VuZC5sZWZ0O1xyXG4gICAgfVxyXG4gICAgaWYoY2hpbGRCb3VuZC50b3A8Z3JvdXBCb3VuZC50b3Ape1xyXG4gICAgICAgIGxvY2F0aW9uLnk9Z3JvdXBCb3VuZC50b3A7XHJcbiAgICB9XHJcbiAgICBjaGlsZC5zZXRMb2NhdGlvbihsb2NhdGlvbi54LGxvY2F0aW9uLnkpO1xyXG59XHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuLy8tXHJcbi8qKlxyXG4gKlxyXG4gKiAgQG1ldGhvZCBzZXRMYXlvdXRcclxuICogIEBwYXJhbSBsYXlvdXQge29iamVjdH0g5Zu+54mH55u45a+56Lev5b6EXHJcbiAqICAgICAgQHBhcmFtIGxheW91dC50eXBlIHtzdHJpbmd9IGZsb3co5Zu65a6a5a696auYLOe7hOWRmOa1geW8j+W4g+WxgCksIGdyaWQo5Zu65a6a5a696auYLOe7hOWRmOihjOWIl+W4g+WxgCksIGZpeGVkKOWbuuWumuWuvemrmCznu4TlkZjlj6/mi5bliqgpLCBkZWZhdWx0KOWuvemrmOiHqumAguW6lClcclxuICogICAgICBAcGFyYW0gW2xheW91dC5yb3ddIHtudW1iZXJ9IOW9k3R5cGU9Zmxvd+aXtiznlKjku6Xorr7nva7msLTlubPpl7TpmpQgLOW9k3R5cGU9Z3JpZOaXtiznlKjku6Xorr7nva7ooYzmlbBcclxuICogICAgICBAcGFyYW0gW2xheW91dC5jb2x1bW5dIHtudW1iZXJ9IOW9k3R5cGU9Zmxvd+aXtiznlKjku6Xorr7nva7lnoLnm7Tpl7TpmpQgLOW9k3R5cGU9Z3JpZOaXtiznlKjku6Xorr7nva7liJfmlbBcclxuICovXHJcbkdyb3VwLnByb3RvdHlwZS5zZXRMYXlvdXQ9ZnVuY3Rpb24obGF5b3V0KXtcclxuICAgIHZhciBzZWxlY3RlZDtcclxuICAgIGlmIChsYXlvdXQpIHtcclxuICAgICAgICBzd2l0Y2ggKGxheW91dC50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Zsb3cnOlxyXG4gICAgICAgICAgICAgICAgLy8g5rWB5byP5biD5bGA77yI5rC05bmzLOWeguebtOmXtOmalClcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gSlRvcG8ubGF5b3V0LkZsb3dMYXlvdXQocGFyc2VJbnQobGF5b3V0LnJvdyksIHBhcnNlSW50KGxheW91dC5jb2x1bW4pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9bGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2dyaWQnOlxyXG4gICAgICAgICAgICAgICAgLy8g572R5qC85biD5bGAKOihjCzliJcpXHJcbiAgICAgICAgICAgICAgICB2YXIgcm93cz1wYXJzZUludChsYXlvdXQucm93KTtcclxuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5zPXBhcnNlSW50KGxheW91dC5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgaWYocm93cypjb2x1bW5zPHRoaXMuY2hpbGRyZW4ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiR3JpZExheW91dCdzIHJvdypjb2x1bW4gbmVlZCBiaWdnZXIgdGhhbiBncm91cCdzIGNoaWxkcmVuIGxlbmd0aFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zPXJvd3M9IE1hdGguY2VpbChNYXRoLnNxcnQodG9kby50YXJnZXQuY2hpbGRyZW4ubGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLmxheW91dC5HcmlkTGF5b3V0KHJvd3MsY29sdW1ucyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0PWxheW91dDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdmaXhlZCc6XHJcbiAgICAgICAgICAgICAgICAvL+WbuuWumumVv+WuveW4g+WxgFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSBmaXhlZExheW91dDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9bGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLkxheW91dC5BdXRvQm91bmRMYXlvdXQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9e307XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0LnR5cGU9XCJkZWZhdWx0XCI7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLkxheW91dC5BdXRvQm91bmRMYXlvdXQoKTtcclxuICAgICAgICB0aGlzLmF0dHIubGF5b3V0PXt9O1xyXG4gICAgICAgIHRoaXMuYXR0ci5sYXlvdXQudHlwZT1cImRlZmF1bHRcIjtcclxuICAgIH1cclxuICAgIHRoaXMuanRvcG8ubGF5b3V0ID0gc2VsZWN0ZWQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5YWo5bGA6K6+572uXHJcbiAqICBAbWV0aG9kIGdldERlZmF1bHRcclxuICogIEByZXR1cm4gY29uZmlnIHtvYmplY3R9IOWFqOWxgOmFjee9rueahOWFi+mahuWvueixoVvlj6ror7td77yM5L+u5pS56K+l5a+56LGh5LiN5Lya55u05o6l5L+u5pS55YWo5bGA6YWN572u77yM6Iul6KaB5L+u5pS55YWo5bGA6YWN572u6K+35L2/55Soc2NlbmUuc2V0RGVmYXVsdFxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg6buY6K6k5YWo5bGA5Y+C5pWwOlxyXG4gKiAgICAgICAgICAgICAgdmFyIERFRkFVTFQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2dyb3VwJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzEwLDEwLDEwMCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDAuNSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcmFnZ2FibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDowLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MzAsLy/mnIDlpKcxNjAg5pyA5bCPMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTpbNTAwLDUwMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246WzAsMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVBvc2l0aW9uOiAnYm90dG9tJywvL0JvdHRvbV9DZW50ZXIgVG9wX0NlbnRlciBNaWRkbGVfTGVmdCBNaWRkbGVfUmlnaHQgSGlkZGVuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOlwiZGVmYXVsdFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjp7Ly/lvoXlrprorr7nva7vvIzmnKrlrozlhajlrp7njrBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0xpbms6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOlFUb3BvLmNvbnN0YW50LmNvbnRhaW5lci5HUk9VUFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuR3JvdXAucHJvdG90eXBlLmdldERlZmF1bHQ9Z2V0RGVmYXVsdDtcclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanNcbi8vIG1vZHVsZSBpZCA9IDI4XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  DirectLine\r\n * @constructor\r\n * @extends [LE] Line\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Line=__webpack_require__(30);\r\nmodule.exports =  {\r\n    constructor:DirectLine,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT={\r\n        num: 1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        jsonId:"",\r\n        gap:20,\r\n        position:{\r\n            start:[0,0],\r\n            end:[0,100]\r\n        },\r\n        path:{\r\n            start:{},\r\n            end:{}\r\n        },\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 80,\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        useType: QTopo.constant.line.DIRECT,\r\n        offset:60// 多条直线时，线条折线拐角处的长度\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction DirectLine(config) {\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    //line基于不加入画布的节点之间的线生成\r\n    Line.call(this,new JTopo.Link(new JTopo.Node(), new JTopo.Node()));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(DirectLine,Line);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                position:{\r\n                                    start:[0,0],\r\n                                    end:[0,100]\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 3,\r\n                                dashed: null,\r\n                                zIndex: 100,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                expendAble: true,\r\n                                useType: QTopo.constant.line.DIRECT,\r\n                                offset: 60\r\n                            };\r\n */\r\nDirectLine.prototype.getDefault=getDefault;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5lL0RpcmVjdC5qcz85OTFmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIyOS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlm77lvaLoioLngrlcclxuICogQGNsYXNzICBEaXJlY3RMaW5lXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTEVdIExpbmVcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIExpbmU9cmVxdWlyZShcIi4vTGluZS5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSAge1xyXG4gICAgY29uc3RydWN0b3I6RGlyZWN0TGluZSxcclxuICAgIHNldERlZmF1bHQ6c2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6Z2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQ9e1xyXG4gICAgICAgIG51bTogMSxcclxuICAgICAgICBhbHBoYToxLFxyXG4gICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICBzaXplOm51bGwsXHJcbiAgICAgICAgICAgIG9mZnNldDowLFxyXG4gICAgICAgICAgICBzdGFydDpmYWxzZSxcclxuICAgICAgICAgICAgZW5kOnRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgIGdhcDoyMCxcclxuICAgICAgICBwb3NpdGlvbjp7XHJcbiAgICAgICAgICAgIHN0YXJ0OlswLDBdLFxyXG4gICAgICAgICAgICBlbmQ6WzAsMTAwXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGF0aDp7XHJcbiAgICAgICAgICAgIHN0YXJ0Ont9LFxyXG4gICAgICAgICAgICBlbmQ6e31cclxuICAgICAgICB9LFxyXG4gICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgekluZGV4IDogODAsXHJcbiAgICAgICAgZm9udDp7XHJcbiAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgIHR5cGU6XCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICAgICAgY29sb3I6JzI1NSwyNTUsMjU1J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubGluZS5ESVJFQ1QsXHJcbiAgICAgICAgb2Zmc2V0OjYwLy8g5aSa5p2h55u057q/5pe277yM57q/5p2h5oqY57q/5ouQ6KeS5aSE55qE6ZW/5bqmXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKXtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpe1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG5mdW5jdGlvbiBEaXJlY3RMaW5lKGNvbmZpZykge1xyXG4gICAgdGhpcy5hdHRyID0gIFFUb3BvLnV0aWwuZXh0ZW5kKGdldERlZmF1bHQoKSwgY29uZmlnIHx8IHt9KTtcclxuICAgIC8vbGluZeWfuuS6juS4jeWKoOWFpeeUu+W4g+eahOiKgueCueS5i+mXtOeahOe6v+eUn+aIkFxyXG4gICAgTGluZS5jYWxsKHRoaXMsbmV3IEpUb3BvLkxpbmsobmV3IEpUb3BvLk5vZGUoKSwgbmV3IEpUb3BvLk5vZGUoKSkpO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHRoaXMuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgdGhpcy5zZXQodGhpcy5hdHRyKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKERpcmVjdExpbmUsTGluZSk7XHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6WzAsMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDpbMCwxMDBdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXA6IDIwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hlZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDEwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzI1NSwyNTUsMjU1J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZW5kQWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5lLkRJUkVDVCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDYwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuRGlyZWN0TGluZS5wcm90b3R5cGUuZ2V0RGVmYXVsdD1nZXREZWZhdWx0O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluZS9EaXJlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDI5XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval("/**\r\n * @module core\r\n */\r\n/**\r\n * 线段基类,用以继承 [E]开头继承于Element,[LE]开头为自身api\r\n * @class [LE] Line\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element=__webpack_require__(1);\r\nmodule.exports =Line;\r\nfunction Line(jtopo) {\r\n    if(jtopo){\r\n        Element.call(this,jtopo);\r\n    }else{\r\n        QTopo.util.error(\"create Line without jtopo\",this);\r\n    }\r\n    /**\r\n     * 记录线段的首尾元素,首尾元素一般隐藏，且为jtopo对象，仅作为绘制的坐标点\r\n     * @property [LE] path {object}\r\n     * @param start {object} 起始元素\r\n     * @param end {object} 终点元素\r\n     */\r\n    this.attr.path={\r\n        start:this.jtopo.nodeA,\r\n        end:this.jtopo.nodeZ\r\n    };\r\n}\r\nQTopo.util.inherits(Line,Element);\r\n/**\r\n *  设置线段位置,原理是设置线段首尾处隐藏jtopo节点的位置\r\n *  @method [LE] setPosition\r\n *  @param position {object}\r\n *\r\n *          position={\r\n *              start:[x,y],\r\n *              end:[x,y]\r\n *          }\r\n */\r\nLine.prototype.setPosition=function(position){\r\n    var start=this.attr.path.start;\r\n    var end=this.attr.path.end;\r\n    if($.isArray(position.start)&&$.isNumeric(position.start[0])&&$.isNumeric(position.start[1])){\r\n        start.setLocation(parseInt(position.start[0]), parseInt(position.start[1]));\r\n    }\r\n    if($.isArray(position.end)&&$.isNumeric(position.end[0])&&$.isNumeric(position.end[1])){\r\n        end.setLocation(parseInt(position.end[0]), parseInt(position.end[1]));\r\n    }\r\n    this.attr.position={\r\n        start:[start.x,start.y],\r\n        end:[end.x,end.y]\r\n    };\r\n};\r\n/**\r\n *  获取基本类型\r\n *  @method [LE] getType\r\n *  @return QTopo.constant.Line {string}\r\n */\r\nLine.prototype.getType=function(){\r\n    return QTopo.constant.Line;\r\n};\r\n/**\r\n *  设置线段颜色\r\n *  @method [LE] setColor\r\n *  @param color{string} \"255,255,255\"/\"#ffffff\"\r\n */\r\nLine.prototype.setColor = function (color) {\r\n    if (color) {\r\n        this.jtopo.strokeColor = QTopo.util.transHex(color.toLowerCase());\r\n    }\r\n    this.attr.color=this.jtopo.strokeColor;\r\n};\r\n/**\r\n *  设置线段计数\r\n *  @method [LE] setNum\r\n *  @param {number} num\r\n */\r\nLine.prototype.setNum = function (num) {\r\n    if ($.isNumeric(num)) {\r\n        if(num > 1){\r\n            this.jtopo.text = '(+' + num + ')';\r\n        }else {\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.num=num;\r\n    }\r\n};\r\n/**\r\n *  设置线段宽度\r\n *  @method [LE] setWidth\r\n *  @param {number} width\r\n */\r\nLine.prototype.setWidth=function(width){\r\n    if($.isNumeric(width)){\r\n        this.jtopo.lineWidth = width; // 线宽\r\n    }\r\n    this.attr.width=this.jtopo.lineWidth;\r\n};\r\n/**\r\n *  设置线段两端箭头参数\r\n *  @method [LE] setArrow\r\n *  @param arrow {object}\r\n *\r\n *          arrow={\r\n *              size:箭头大小{number},\r\n *              offset:箭头在链路上的偏移量{number},\r\n *              start:是否显示起点箭头{boolean},\r\n *              end:是否显示终点箭头{boolean},\r\n *          }\r\n */\r\nLine.prototype.setArrow = function(arrow){\r\n    if(arrow){\r\n        this.jtopo.arrowsRadius = $.isNumeric(arrow.size)?arrow.size:0;\r\n        this.jtopo.arrowsOffset = $.isNumeric(arrow.offset)?arrow.offset:0;\r\n    }\r\n    if(!this.attr.arrow){\r\n        this.attr.arrow={};\r\n    }\r\n    this.attr.arrow.size=this.jtopo.arrowsRadius;\r\n    this.attr.arrow.offset=this.jtopo.arrowsOffset;\r\n};\r\n/**\r\n *  设置相同起点和终点的链路之间的间隔大小\r\n *\r\n *  @method [LE] setGap\r\n *  @param gap {number}\r\n */\r\nLine.prototype.setGap=function(gap){\r\n    if(gap){\r\n        this.jtopo.bundleGap = $.isNumeric(gap)?gap:0; // 线条之间的间隔\r\n    }\r\n    this.attr.gap=this.jtopo.bundleGap;\r\n};\r\n/**\r\n *  设置链路的虚线线段长度\r\n *\r\n *  设置不为number类型或小于0时，则认为不要虚线\r\n *\r\n *  @method [LE] setDashed\r\n *  @param dashedPattern {number|null}\r\n */\r\nLine.prototype.setDashed=function(dashedPattern){\r\n    if($.isNumeric(dashedPattern)&&dashedPattern>0){\r\n        this.jtopo.dashedPattern=parseInt(dashedPattern);\r\n    }else{\r\n        this.jtopo.dashedPattern=null;\r\n    }\r\n    this.attr.dashed=this.jtopo.dashedPattern;\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [LE] toJson\r\n *  @return {object}\r\n */\r\nLine.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5lL0xpbmUuanM/YjkwZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIscUJBQXFCLE9BQU87QUFDNUIsbUJBQW1CLE9BQU87QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSwwQkFBMEIsT0FBTztBQUNqQyxrQ0FBa0MsT0FBTztBQUN6QywrQkFBK0IsUUFBUTtBQUN2Qyw2QkFBNkIsUUFBUTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQSIsImZpbGUiOiIzMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDnur/mrrXln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW0xFXeW8gOWktOS4uuiHqui6q2FwaVxyXG4gKiBAY2xhc3MgW0xFXSBMaW5lXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcbnZhciBFbGVtZW50PXJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9TGluZTtcclxuZnVuY3Rpb24gTGluZShqdG9wbykge1xyXG4gICAgaWYoanRvcG8pe1xyXG4gICAgICAgIEVsZW1lbnQuY2FsbCh0aGlzLGp0b3BvKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgTGluZSB3aXRob3V0IGp0b3BvXCIsdGhpcyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiusOW9lee6v+auteeahOmmluWwvuWFg+e0oCzpppblsL7lhYPntKDkuIDoiKzpmpDol4/vvIzkuJTkuLpqdG9wb+Wvueixoe+8jOS7heS9nOS4uue7mOWItueahOWdkOagh+eCuVxyXG4gICAgICogQHByb3BlcnR5IFtMRV0gcGF0aCB7b2JqZWN0fVxyXG4gICAgICogQHBhcmFtIHN0YXJ0IHtvYmplY3R9IOi1t+Wni+WFg+e0oFxyXG4gICAgICogQHBhcmFtIGVuZCB7b2JqZWN0fSDnu4jngrnlhYPntKBcclxuICAgICAqL1xyXG4gICAgdGhpcy5hdHRyLnBhdGg9e1xyXG4gICAgICAgIHN0YXJ0OnRoaXMuanRvcG8ubm9kZUEsXHJcbiAgICAgICAgZW5kOnRoaXMuanRvcG8ubm9kZVpcclxuICAgIH07XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhMaW5lLEVsZW1lbnQpO1xyXG4vKipcclxuICogIOiuvue9rue6v+auteS9jee9rizljp/nkIbmmK/orr7nva7nur/mrrXpppblsL7lpITpmpDol49qdG9wb+iKgueCueeahOS9jee9rlxyXG4gKiAgQG1ldGhvZCBbTEVdIHNldFBvc2l0aW9uXHJcbiAqICBAcGFyYW0gcG9zaXRpb24ge29iamVjdH1cclxuICpcclxuICogICAgICAgICAgcG9zaXRpb249e1xyXG4gKiAgICAgICAgICAgICAgc3RhcnQ6W3gseV0sXHJcbiAqICAgICAgICAgICAgICBlbmQ6W3gseV1cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUuc2V0UG9zaXRpb249ZnVuY3Rpb24ocG9zaXRpb24pe1xyXG4gICAgdmFyIHN0YXJ0PXRoaXMuYXR0ci5wYXRoLnN0YXJ0O1xyXG4gICAgdmFyIGVuZD10aGlzLmF0dHIucGF0aC5lbmQ7XHJcbiAgICBpZigkLmlzQXJyYXkocG9zaXRpb24uc3RhcnQpJiYkLmlzTnVtZXJpYyhwb3NpdGlvbi5zdGFydFswXSkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLnN0YXJ0WzFdKSl7XHJcbiAgICAgICAgc3RhcnQuc2V0TG9jYXRpb24ocGFyc2VJbnQocG9zaXRpb24uc3RhcnRbMF0pLCBwYXJzZUludChwb3NpdGlvbi5zdGFydFsxXSkpO1xyXG4gICAgfVxyXG4gICAgaWYoJC5pc0FycmF5KHBvc2l0aW9uLmVuZCkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLmVuZFswXSkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLmVuZFsxXSkpe1xyXG4gICAgICAgIGVuZC5zZXRMb2NhdGlvbihwYXJzZUludChwb3NpdGlvbi5lbmRbMF0pLCBwYXJzZUludChwb3NpdGlvbi5lbmRbMV0pKTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5wb3NpdGlvbj17XHJcbiAgICAgICAgc3RhcnQ6W3N0YXJ0Lngsc3RhcnQueV0sXHJcbiAgICAgICAgZW5kOltlbmQueCxlbmQueV1cclxuICAgIH07XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5Z+65pys57G75Z6LXHJcbiAqICBAbWV0aG9kIFtMRV0gZ2V0VHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5MaW5lIHtzdHJpbmd9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuTGluZTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXpopzoibJcclxuICogIEBtZXRob2QgW0xFXSBzZXRDb2xvclxyXG4gKiAgQHBhcmFtIGNvbG9ye3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiXHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdHJva2VDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuY29sb3I9dGhpcy5qdG9wby5zdHJva2VDb2xvcjtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXorqHmlbBcclxuICogIEBtZXRob2QgW0xFXSBzZXROdW1cclxuICogIEBwYXJhbSB7bnVtYmVyfSBudW1cclxuICovXHJcbkxpbmUucHJvdG90eXBlLnNldE51bSA9IGZ1bmN0aW9uIChudW0pIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhudW0pKSB7XHJcbiAgICAgICAgaWYobnVtID4gMSl7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICcoKycgKyBudW0gKyAnKSc7XHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLm51bT1udW07XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u57q/5q615a695bqmXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0V2lkdGhcclxuICogIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUuc2V0V2lkdGg9ZnVuY3Rpb24od2lkdGgpe1xyXG4gICAgaWYoJC5pc051bWVyaWMod2lkdGgpKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmxpbmVXaWR0aCA9IHdpZHRoOyAvLyDnur/lrr1cclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci53aWR0aD10aGlzLmp0b3BvLmxpbmVXaWR0aDtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXkuKTnq6/nrq3lpLTlj4LmlbBcclxuICogIEBtZXRob2QgW0xFXSBzZXRBcnJvd1xyXG4gKiAgQHBhcmFtIGFycm93IHtvYmplY3R9XHJcbiAqXHJcbiAqICAgICAgICAgIGFycm93PXtcclxuICogICAgICAgICAgICAgIHNpemU6566t5aS05aSn5bCPe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBvZmZzZXQ6566t5aS05Zyo6ZO+6Lev5LiK55qE5YGP56e76YePe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBzdGFydDrmmK/lkKbmmL7npLrotbfngrnnrq3lpLR7Ym9vbGVhbn0sXHJcbiAqICAgICAgICAgICAgICBlbmQ65piv5ZCm5pi+56S657uI54K5566t5aS0e2Jvb2xlYW59LFxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRBcnJvdyA9IGZ1bmN0aW9uKGFycm93KXtcclxuICAgIGlmKGFycm93KXtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c1JhZGl1cyA9ICQuaXNOdW1lcmljKGFycm93LnNpemUpP2Fycm93LnNpemU6MDtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c09mZnNldCA9ICQuaXNOdW1lcmljKGFycm93Lm9mZnNldCk/YXJyb3cub2Zmc2V0OjA7XHJcbiAgICB9XHJcbiAgICBpZighdGhpcy5hdHRyLmFycm93KXtcclxuICAgICAgICB0aGlzLmF0dHIuYXJyb3c9e307XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cuc2l6ZT10aGlzLmp0b3BvLmFycm93c1JhZGl1cztcclxuICAgIHRoaXMuYXR0ci5hcnJvdy5vZmZzZXQ9dGhpcy5qdG9wby5hcnJvd3NPZmZzZXQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u55u45ZCM6LW354K55ZKM57uI54K555qE6ZO+6Lev5LmL6Ze055qE6Ze06ZqU5aSn5bCPXHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0R2FwXHJcbiAqICBAcGFyYW0gZ2FwIHtudW1iZXJ9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRHYXA9ZnVuY3Rpb24oZ2FwKXtcclxuICAgIGlmKGdhcCl7XHJcbiAgICAgICAgdGhpcy5qdG9wby5idW5kbGVHYXAgPSAkLmlzTnVtZXJpYyhnYXApP2dhcDowOyAvLyDnur/mnaHkuYvpl7TnmoTpl7TpmpRcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5nYXA9dGhpcy5qdG9wby5idW5kbGVHYXA7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev55qE6Jma57q/57q/5q616ZW/5bqmXHJcbiAqXHJcbiAqICDorr7nva7kuI3kuLpudW1iZXLnsbvlnovmiJblsI/kuo4w5pe277yM5YiZ6K6k5Li65LiN6KaB6Jma57q/XHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0RGFzaGVkXHJcbiAqICBAcGFyYW0gZGFzaGVkUGF0dGVybiB7bnVtYmVyfG51bGx9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXREYXNoZWQ9ZnVuY3Rpb24oZGFzaGVkUGF0dGVybil7XHJcbiAgICBpZigkLmlzTnVtZXJpYyhkYXNoZWRQYXR0ZXJuKSYmZGFzaGVkUGF0dGVybj4wKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm49cGFyc2VJbnQoZGFzaGVkUGF0dGVybik7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm49bnVsbDtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kYXNoZWQ9dGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuO1xyXG59O1xyXG4vKipcclxuICogIOWNleS4quWvueixoeeahOWxnuaAp+aPkOWPllxyXG4gKiAgQG1ldGhvZCBbTEVdIHRvSnNvblxyXG4gKiAgQHJldHVybiB7b2JqZWN0fVxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUudG9Kc29uPWZ1bmN0aW9uKCl7XHJcbiAgICB2YXIganNvbj0kLmV4dGVuZCh7fSx0aGlzLmF0dHIpO1xyXG4gICAganNvbi5leHRyYT0kLmV4dGVuZCh7fSx0aGlzLmV4dHJhKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluZS9MaW5lLmpzXG4vLyBtb2R1bGUgaWQgPSAzMFxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 曲线链路\r\n * @class  CurveLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(2);\r\nmodule.exports = {\r\n    constructor: CurveLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        type:\'close\',\r\n        size: 10,\r\n        offset: 2,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId:"",\r\n    gap: 20,\r\n    width: 2,\r\n    dashed: null,\r\n    zIndex: 100,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    useType: QTopo.constant.link.CURVE,\r\n    offset: 200    //可由curveOffset指定弧度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction CurveLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.CurveLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(CurveLink, Link);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 2,\r\n                                dashed: null,\r\n                                zIndex: 100,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                useType: QTopo.constant.link.CURVE,\r\n                                offset: 200\r\n                            };\r\n */\r\nCurveLink.prototype.getDefault = getDefault;\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0N1cnZlLmpzP2QwZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDmm7Lnur/pk77ot69cclxuICogQGNsYXNzICBDdXJ2ZUxpbmtcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtMXSBMaW5rXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBMaW5rID0gcmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBjb25zdHJ1Y3RvcjogQ3VydmVMaW5rLFxyXG4gICAgc2V0RGVmYXVsdDogc2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6IGdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID0ge1xyXG4gICAgbnVtYmVyOiAxLFxyXG4gICAgYWxwaGE6IDEsXHJcbiAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgYXJyb3c6IHtcclxuICAgICAgICB0eXBlOidjbG9zZScsXHJcbiAgICAgICAgc2l6ZTogMTAsXHJcbiAgICAgICAgb2Zmc2V0OiAyLFxyXG4gICAgICAgIHN0YXJ0OiBmYWxzZSxcclxuICAgICAgICBlbmQ6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAganNvbklkOlwiXCIsXHJcbiAgICBnYXA6IDIwLFxyXG4gICAgd2lkdGg6IDIsXHJcbiAgICBkYXNoZWQ6IG51bGwsXHJcbiAgICB6SW5kZXg6IDEwMCxcclxuICAgIGZvbnQ6IHtcclxuICAgICAgICBzaXplOiAxNixcclxuICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICB9LFxyXG4gICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubGluay5DVVJWRSxcclxuICAgIG9mZnNldDogMjAwICAgIC8v5Y+v55SxY3VydmVPZmZzZXTmjIflrprlvKfluqZcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpIHtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuZnVuY3Rpb24gQ3VydmVMaW5rKGNvbmZpZykge1xyXG4gICAgaWYgKCFjb25maWcuc3RhcnQgfHwgIWNvbmZpZy5lbmQgfHwgIWNvbmZpZy5zdGFydC5qdG9wbyB8fCAhY29uZmlnLmVuZC5qdG9wbykge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTGluay5jYWxsKHRoaXMsIG5ldyBKVG9wby5DdXJ2ZUxpbmsoY29uZmlnLnN0YXJ0Lmp0b3BvLCBjb25maWcuZW5kLmp0b3BvKSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoQ3VydmVMaW5rLCBMaW5rKTtcclxuLy8tXHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG4vLy1cclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcDogMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGVkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMTAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkNVUlZFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogMjAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuQ3VydmVMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0N1cnZlLmpzXG4vLyBtb2R1bGUgaWQgPSAzMVxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 直线链路\r\n * @class  DirectLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(2);\r\nmodule.exports = {\r\n    constructor: DirectLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        type:\'close\',\r\n        size: 10,\r\n        offset: 2,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId: "",\r\n    gap: 20,\r\n    width: 3,\r\n    dashed: null,\r\n    zIndex: 100,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    expendAble: true,\r\n    useType: QTopo.constant.link.DIRECT,\r\n    offset: 60// 多条直线时，线条折线拐角处的长度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//------\r\n//------\r\n//-\r\nfunction DirectLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.Link(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(DirectLink, Link);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 3,\r\n                                dashed: null,\r\n                                zIndex: 100,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                expendAble: true,\r\n                                useType: QTopo.constant.link.DIRECT,\r\n                                offset: 60\r\n                            };\r\n */\r\nDirectLink.prototype.getDefault = getDefault;\r\n/**\r\n * 开启链路展开模式,为链路生成toggle函数\r\n * @method openToggle\r\n * @param scene {scene}链路所在图层\r\n */\r\nDirectLink.prototype.openToggle = function (scene) {\r\n    this.attr.expendAble = true;\r\n    var jtopo = scene.jtopo;\r\n    /**\r\n     * 链路展开/合并切换\r\n     * @method toggle\r\n     * @param [flag] {boolean}为true则展开为false则缩放，无值则根据现状自适应切换,\r\n     */\r\n    this.toggle = function (flag) {\r\n        var todo = !(this.getUseType() == QTopo.constant.CASUAL && this.parent);\r\n        if (typeof flag == "boolean" && (flag ^ todo)) {\r\n            return;\r\n        }\r\n        if (todo) {\r\n            //展开\r\n            //复制属性\r\n            if (this.attr.number > 1 && this.attr.expendAble) {\r\n                var childSet = QTopo.util.deepClone(this.attr);\r\n                childSet.start = this.path.start;\r\n                childSet.end = this.path.end;\r\n                childSet.useType = QTopo.constant.CASUAL;\r\n                childSet.number = 1;\r\n                var parent = {\r\n                    attr: this.attr,\r\n                    extra: this.extra,\r\n                    path: this.path,\r\n                    addChild: function (num) {\r\n                        if ($.isNumeric(num)) {\r\n                            num = parseInt(num);\r\n                            for (var i = 0; i < num; i++) {\r\n                                var link = scene.createLink(childSet);\r\n                                parent.children.push(link);\r\n                                link.parent = parent;\r\n                                link.extra = parent.extra;\r\n                            }\r\n                        }\r\n                    },\r\n                    children: []\r\n                };\r\n                scene.remove(this);\r\n                parent.addChild(parent.attr.number);\r\n            }\r\n        } else {\r\n            //聚合\r\n            var father = this.parent;\r\n            scene.remove(father.children);\r\n            var config = father.attr;\r\n            config.start = father.path.start;\r\n            config.end = father.path.end;\r\n            scene.createLink(config).extra = father.extra;\r\n        }\r\n    };\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0RpcmVjdC5qcz9jZjVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixNQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLFFBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsU0FBUztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDnm7Tnur/pk77ot69cclxuICogQGNsYXNzICBEaXJlY3RMaW5rXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTF0gTGlua1xyXG4gKiBAcGFyYW0gW2NvbmZpZ10g6YWN572u5Y+C5pWw77yM5peg5Y+C5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqL1xyXG52YXIgTGluayA9IHJlcXVpcmUoXCIuL0xpbmsuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6IERpcmVjdExpbmssXHJcbiAgICBzZXREZWZhdWx0OiBzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDogZ2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQgPSB7XHJcbiAgICBudW1iZXI6IDEsXHJcbiAgICBhbHBoYTogMSxcclxuICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICBhcnJvdzoge1xyXG4gICAgICAgIHR5cGU6J2Nsb3NlJyxcclxuICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICBvZmZzZXQ6IDIsXHJcbiAgICAgICAgc3RhcnQ6IGZhbHNlLFxyXG4gICAgICAgIGVuZDogZmFsc2VcclxuICAgIH0sXHJcbiAgICBqc29uSWQ6IFwiXCIsXHJcbiAgICBnYXA6IDIwLFxyXG4gICAgd2lkdGg6IDMsXHJcbiAgICBkYXNoZWQ6IG51bGwsXHJcbiAgICB6SW5kZXg6IDEwMCxcclxuICAgIGZvbnQ6IHtcclxuICAgICAgICBzaXplOiAxNixcclxuICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICB9LFxyXG4gICAgZXhwZW5kQWJsZTogdHJ1ZSxcclxuICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNULFxyXG4gICAgb2Zmc2V0OiA2MC8vIOWkmuadoeebtOe6v+aXtu+8jOe6v+adoeaKmOe6v+aLkOinkuWkhOeahOmVv+W6plxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZykge1xyXG4gICAgUVRvcG8udXRpbC5leHRlbmQoREVGQVVMVCwgY29uZmlnIHx8IHt9KTtcclxufVxyXG5mdW5jdGlvbiBnZXREZWZhdWx0KCkge1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLS0tLS0tXHJcbi8vLS0tLS0tXHJcbi8vLVxyXG5mdW5jdGlvbiBEaXJlY3RMaW5rKGNvbmZpZykge1xyXG4gICAgaWYgKCFjb25maWcuc3RhcnQgfHwgIWNvbmZpZy5lbmQgfHwgIWNvbmZpZy5zdGFydC5qdG9wbyB8fCAhY29uZmlnLmVuZC5qdG9wbykge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTGluay5jYWxsKHRoaXMsIG5ldyBKVG9wby5MaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbykpO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHRoaXMuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgdGhpcy5zZXQodGhpcy5hdHRyKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKERpcmVjdExpbmssIExpbmspO1xyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcDogMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGVkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMTAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlbmRBYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNULFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogNjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5EaXJlY3RMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcclxuLyoqXHJcbiAqIOW8gOWQr+mTvui3r+WxleW8gOaooeW8jyzkuLrpk77ot6/nlJ/miJB0b2dnbGXlh73mlbBcclxuICogQG1ldGhvZCBvcGVuVG9nZ2xlXHJcbiAqIEBwYXJhbSBzY2VuZSB7c2NlbmV96ZO+6Lev5omA5Zyo5Zu+5bGCXHJcbiAqL1xyXG5EaXJlY3RMaW5rLnByb3RvdHlwZS5vcGVuVG9nZ2xlID0gZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICB0aGlzLmF0dHIuZXhwZW5kQWJsZSA9IHRydWU7XHJcbiAgICB2YXIganRvcG8gPSBzY2VuZS5qdG9wbztcclxuICAgIC8qKlxyXG4gICAgICog6ZO+6Lev5bGV5byAL+WQiOW5tuWIh+aNolxyXG4gICAgICogQG1ldGhvZCB0b2dnbGVcclxuICAgICAqIEBwYXJhbSBbZmxhZ10ge2Jvb2xlYW595Li6dHJ1ZeWImeWxleW8gOS4umZhbHNl5YiZ57yp5pS+77yM5peg5YC85YiZ5qC55o2u546w54q26Ieq6YCC5bqU5YiH5o2iLFxyXG4gICAgICovXHJcbiAgICB0aGlzLnRvZ2dsZSA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgICAgdmFyIHRvZG8gPSAhKHRoaXMuZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCAmJiB0aGlzLnBhcmVudCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBmbGFnID09IFwiYm9vbGVhblwiICYmIChmbGFnIF4gdG9kbykpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9kbykge1xyXG4gICAgICAgICAgICAvL+WxleW8gFxyXG4gICAgICAgICAgICAvL+WkjeWItuWxnuaAp1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hdHRyLm51bWJlciA+IDEgJiYgdGhpcy5hdHRyLmV4cGVuZEFibGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZFNldCA9IFFUb3BvLnV0aWwuZGVlcENsb25lKHRoaXMuYXR0cik7XHJcbiAgICAgICAgICAgICAgICBjaGlsZFNldC5zdGFydCA9IHRoaXMucGF0aC5zdGFydDtcclxuICAgICAgICAgICAgICAgIGNoaWxkU2V0LmVuZCA9IHRoaXMucGF0aC5lbmQ7XHJcbiAgICAgICAgICAgICAgICBjaGlsZFNldC51c2VUeXBlID0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMO1xyXG4gICAgICAgICAgICAgICAgY2hpbGRTZXQubnVtYmVyID0gMTtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cjogdGhpcy5hdHRyLFxyXG4gICAgICAgICAgICAgICAgICAgIGV4dHJhOiB0aGlzLmV4dHJhLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IHRoaXMucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICBhZGRDaGlsZDogZnVuY3Rpb24gKG51bSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc051bWVyaWMobnVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gcGFyc2VJbnQobnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IHNjZW5lLmNyZWF0ZUxpbmsoY2hpbGRTZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jaGlsZHJlbi5wdXNoKGxpbmspO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuZXh0cmEgPSBwYXJlbnQuZXh0cmE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHNjZW5lLnJlbW92ZSh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5hZGRDaGlsZChwYXJlbnQuYXR0ci5udW1iZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy/ogZrlkIhcclxuICAgICAgICAgICAgdmFyIGZhdGhlciA9IHRoaXMucGFyZW50O1xyXG4gICAgICAgICAgICBzY2VuZS5yZW1vdmUoZmF0aGVyLmNoaWxkcmVuKTtcclxuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IGZhdGhlci5hdHRyO1xyXG4gICAgICAgICAgICBjb25maWcuc3RhcnQgPSBmYXRoZXIucGF0aC5zdGFydDtcclxuICAgICAgICAgICAgY29uZmlnLmVuZCA9IGZhdGhlci5wYXRoLmVuZDtcclxuICAgICAgICAgICAgc2NlbmUuY3JlYXRlTGluayhjb25maWcpLmV4dHJhID0gZmF0aGVyLmV4dHJhO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0RpcmVjdC5qc1xuLy8gbW9kdWxlIGlkID0gMzJcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 二次折线链路\r\n * @class  FlexionalLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(2);\r\nmodule.exports = {\r\n    constructor: FlexionalLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        type:\'close\',\r\n        size: 10,\r\n        offset: 0,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId: "",\r\n    radius: 0,\r\n    gap: 20,\r\n    width: 2,\r\n    dashed: null,\r\n    zIndex: 100,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    useType: QTopo.constant.link.FLEXIONAL,\r\n    direction: "horizontal",\r\n    offset: 60//折线处长度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction FlexionalLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.FlexionalLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(FlexionalLink, Link);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\n/**\r\n *  设置折线方向\r\n *\r\n *  @method setDirection\r\n *  @param direction {string} horizontal 水平 "vertical"垂直\r\n */\r\nFlexionalLink.prototype.setDirection = function (direction) {\r\n    //折线方向 horizontal 水平 "vertical"垂直\r\n    if (direction) {\r\n        this.jtopo.direction = direction;\r\n    }\r\n    this.attr.direction = this.jtopo.direction;\r\n};\r\n/**\r\n *  设置折角弧度\r\n *\r\n *  @method setRadius\r\n *  @param radius {number}\r\n */\r\nFlexionalLink.prototype.setRadius = function (radius) {\r\n    if ($.isNumeric(radius)) {\r\n        radius = parseInt(radius);\r\n        if (radius > 20) {\r\n            radius = 20;\r\n        } else if (radius < 0) {\r\n            radius = 0;\r\n        }\r\n        this.attr.radius = radius;\r\n    }\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *         var DEFAULT = {\r\n                            number: 1,\r\n                            alpha: 1,\r\n                            color: \'22,124,255\',\r\n                            arrow: {\r\n                                size: 10,\r\n                                offset: 0,\r\n                                start: false,\r\n                                end: false\r\n                            },\r\n                            jsonId:"",\r\n                            radius: 0,\r\n                            gap: 20,\r\n                            width: 2,\r\n                            dashed: null,\r\n                            zIndex: 100,\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑",\r\n                                color: \'255,255,255\'\r\n                            },\r\n                            useType: QTopo.constant.link.FLEXIONAL,\r\n                            direction: "horizontal",\r\n                            offset: 60//两端折线线段的长度\r\n                        };\r\n */\r\nFlexionalLink.prototype.getDefault = getDefault;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qcz8wMDA2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTREO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjMzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOS6jOasoeaKmOe6v+mTvui3r1xyXG4gKiBAY2xhc3MgIEZsZXhpb25hbExpbmtcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtMXSBMaW5rXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBMaW5rID0gcmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBjb25zdHJ1Y3RvcjogRmxleGlvbmFsTGluayxcclxuICAgIHNldERlZmF1bHQ6IHNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OiBnZXREZWZhdWx0XHJcbn07XHJcbi8vLVxyXG52YXIgREVGQVVMVCA9IHtcclxuICAgIG51bWJlcjogMSxcclxuICAgIGFscGhhOiAxLFxyXG4gICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgIGFycm93OiB7XHJcbiAgICAgICAgdHlwZTonY2xvc2UnLFxyXG4gICAgICAgIHNpemU6IDEwLFxyXG4gICAgICAgIG9mZnNldDogMCxcclxuICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgZW5kOiBmYWxzZVxyXG4gICAgfSxcclxuICAgIGpzb25JZDogXCJcIixcclxuICAgIHJhZGl1czogMCxcclxuICAgIGdhcDogMjAsXHJcbiAgICB3aWR0aDogMixcclxuICAgIGRhc2hlZDogbnVsbCxcclxuICAgIHpJbmRleDogMTAwLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgY29sb3I6ICcyNTUsMjU1LDI1NSdcclxuICAgIH0sXHJcbiAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkZMRVhJT05BTCxcclxuICAgIGRpcmVjdGlvbjogXCJob3Jpem9udGFsXCIsXHJcbiAgICBvZmZzZXQ6IDYwLy/mipjnur/lpITplb/luqZcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpIHtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuZnVuY3Rpb24gRmxleGlvbmFsTGluayhjb25maWcpIHtcclxuICAgIGlmICghY29uZmlnLnN0YXJ0IHx8ICFjb25maWcuZW5kIHx8ICFjb25maWcuc3RhcnQuanRvcG8gfHwgIWNvbmZpZy5lbmQuanRvcG8pIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiQ3JlYXRlIExpbmsgbmVlZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ciA9IFFUb3BvLnV0aWwuZXh0ZW5kKGdldERlZmF1bHQoKSwgY29uZmlnIHx8IHt9KTtcclxuICAgIExpbmsuY2FsbCh0aGlzLCBuZXcgSlRvcG8uRmxleGlvbmFsTGluayhjb25maWcuc3RhcnQuanRvcG8sIGNvbmZpZy5lbmQuanRvcG8pKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhGbGV4aW9uYWxMaW5rLCBMaW5rKTtcclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiAg6K6+572u5oqY57q/5pa55ZCRXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldERpcmVjdGlvblxyXG4gKiAgQHBhcmFtIGRpcmVjdGlvbiB7c3RyaW5nfSBob3Jpem9udGFsIOawtOW5syBcInZlcnRpY2FsXCLlnoLnm7RcclxuICovXHJcbkZsZXhpb25hbExpbmsucHJvdG90eXBlLnNldERpcmVjdGlvbiA9IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcclxuICAgIC8v5oqY57q/5pa55ZCRIGhvcml6b250YWwg5rC05bmzIFwidmVydGljYWxcIuWeguebtFxyXG4gICAgaWYgKGRpcmVjdGlvbikge1xyXG4gICAgICAgIHRoaXMuanRvcG8uZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmRpcmVjdGlvbiA9IHRoaXMuanRvcG8uZGlyZWN0aW9uO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruaKmOinkuW8p+W6plxyXG4gKlxyXG4gKiAgQG1ldGhvZCBzZXRSYWRpdXNcclxuICogIEBwYXJhbSByYWRpdXMge251bWJlcn1cclxuICovXHJcbkZsZXhpb25hbExpbmsucHJvdG90eXBlLnNldFJhZGl1cyA9IGZ1bmN0aW9uIChyYWRpdXMpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhyYWRpdXMpKSB7XHJcbiAgICAgICAgcmFkaXVzID0gcGFyc2VJbnQocmFkaXVzKTtcclxuICAgICAgICBpZiAocmFkaXVzID4gMjApIHtcclxuICAgICAgICAgICAgcmFkaXVzID0gMjA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyYWRpdXMgPCAwKSB7XHJcbiAgICAgICAgICAgIHJhZGl1cyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXR0ci5yYWRpdXMgPSByYWRpdXM7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDlhajlsYDmoLflvI9cclxuICogQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqIEByZXR1cm4ge29iamVjdH1cclxuICogQGV4YW1wbGVcclxuICogICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycm93OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXA6IDIwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoZWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDEwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubGluay5GTEVYSU9OQUwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246IFwiaG9yaXpvbnRhbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiA2MC8v5Lik56uv5oqY57q/57q/5q6155qE6ZW/5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5GbGV4aW9uYWxMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qc1xuLy8gbW9kdWxlIGlkID0gMzNcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 折线链路\r\n * @class  FoldLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link=__webpack_require__(2);\r\nmodule.exports =  {\r\n    constructor:FoldLink,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT ={\r\n        number:1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            type:\'close\',\r\n            size:10,\r\n            offset:0,\r\n            start:false,\r\n            end:false\r\n        },\r\n        jsonId:"",\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        radius:0,\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        useType: QTopo.constant.link.FOLD,\r\n        direction:"vertical"\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction FoldLink(config){\r\n    if(!config.start||!config.end||!config.start.jtopo||!config.end.jtopo){\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.FoldLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(FoldLink,Link);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n *  设置折线方向\r\n *\r\n *  @method setDirection\r\n *  @param direction {string} /horizontal 水平 "vertical"垂直\r\n */\r\nFoldLink.prototype.setDirection=function(direction){\r\n    if(direction){\r\n        this.jtopo.direction=direction;\r\n    }\r\n    this.attr.direction=this.jtopo.direction;\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *        var DEFAULT ={\r\n                            number:1,\r\n                            alpha:1,\r\n                            color: \'22,124,255\',\r\n                            arrow:{\r\n                                size:10,\r\n                                offset:0,\r\n                                start:false,\r\n                                end:false\r\n                            },\r\n                            jsonId:"",\r\n                            gap:20,\r\n                            width: 2,\r\n                            dashed:  null,\r\n                            zIndex : 100,\r\n                            radius:0,\r\n                            font:{\r\n                                size:16,\r\n                                type:"微软雅黑",\r\n                                color:\'255,255,255\'\r\n                            },\r\n                            useType: QTopo.constant.link.FOLD,\r\n                            direction:"vertical"\r\n                    };\r\n */\r\nFoldLink.prototype.getDefault=getDefault;\r\n/**\r\n *  设置折角弧度\r\n *\r\n *  @method setRadius\r\n *  @param radius {number}\r\n */\r\nFoldLink.prototype.setRadius = function (radius) {\r\n    if ($.isNumeric(radius)) {\r\n        radius = parseInt(radius);\r\n        if (radius > 20) {\r\n            radius = 20;\r\n        } else if (radius < 0) {\r\n            radius = 0;\r\n        }\r\n        this.attr.radius = radius;\r\n    }\r\n};\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZvbGQuanM/NTBiYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzNC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDmipjnur/pk77ot69cclxuICogQGNsYXNzICBGb2xkTGlua1xyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0xdIExpbmtcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIExpbms9cmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSAge1xyXG4gICAgY29uc3RydWN0b3I6Rm9sZExpbmssXHJcbiAgICBzZXREZWZhdWx0OnNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OmdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID17XHJcbiAgICAgICAgbnVtYmVyOjEsXHJcbiAgICAgICAgYWxwaGE6MSxcclxuICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgdHlwZTonY2xvc2UnLFxyXG4gICAgICAgICAgICBzaXplOjEwLFxyXG4gICAgICAgICAgICBvZmZzZXQ6MCxcclxuICAgICAgICAgICAgc3RhcnQ6ZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZDpmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgZ2FwOjIwLFxyXG4gICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgekluZGV4IDogMTAwLFxyXG4gICAgICAgIHJhZGl1czowLFxyXG4gICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICBzaXplOjE2LFxyXG4gICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuRk9MRCxcclxuICAgICAgICBkaXJlY3Rpb246XCJ2ZXJ0aWNhbFwiXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKXtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpe1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG5mdW5jdGlvbiBGb2xkTGluayhjb25maWcpe1xyXG4gICAgaWYoIWNvbmZpZy5zdGFydHx8IWNvbmZpZy5lbmR8fCFjb25maWcuc3RhcnQuanRvcG98fCFjb25maWcuZW5kLmp0b3BvKXtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiQ3JlYXRlIExpbmsgbmVlZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ciA9ICBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBMaW5rLmNhbGwodGhpcywgbmV3IEpUb3BvLkZvbGRMaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbykpO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHRoaXMuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgdGhpcy5zZXQodGhpcy5hdHRyKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKEZvbGRMaW5rLExpbmspO1xyXG4vLy1cclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG4vLy1cclxuLyoqXHJcbiAqICDorr7nva7mipjnur/mlrnlkJFcclxuICpcclxuICogIEBtZXRob2Qgc2V0RGlyZWN0aW9uXHJcbiAqICBAcGFyYW0gZGlyZWN0aW9uIHtzdHJpbmd9IC9ob3Jpem9udGFsIOawtOW5syBcInZlcnRpY2FsXCLlnoLnm7RcclxuICovXHJcbkZvbGRMaW5rLnByb3RvdHlwZS5zZXREaXJlY3Rpb249ZnVuY3Rpb24oZGlyZWN0aW9uKXtcclxuICAgIGlmKGRpcmVjdGlvbil7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kaXJlY3Rpb249ZGlyZWN0aW9uO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmRpcmVjdGlvbj10aGlzLmp0b3BvLmRpcmVjdGlvbjtcclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgdmFyIERFRkFVTFQgPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjoxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6MSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdzp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZToxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDpmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6ZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcDoyMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGVkOiAgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleCA6IDEwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czowLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6JzI1NSwyNTUsMjU1J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuRk9MRCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjpcInZlcnRpY2FsXCJcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuRm9sZExpbmsucHJvdG90eXBlLmdldERlZmF1bHQ9Z2V0RGVmYXVsdDtcclxuLyoqXHJcbiAqICDorr7nva7mipjop5LlvKfluqZcclxuICpcclxuICogIEBtZXRob2Qgc2V0UmFkaXVzXHJcbiAqICBAcGFyYW0gcmFkaXVzIHtudW1iZXJ9XHJcbiAqL1xyXG5Gb2xkTGluay5wcm90b3R5cGUuc2V0UmFkaXVzID0gZnVuY3Rpb24gKHJhZGl1cykge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHJhZGl1cykpIHtcclxuICAgICAgICByYWRpdXMgPSBwYXJzZUludChyYWRpdXMpO1xyXG4gICAgICAgIGlmIChyYWRpdXMgPiAyMCkge1xyXG4gICAgICAgICAgICByYWRpdXMgPSAyMDtcclxuICAgICAgICB9IGVsc2UgaWYgKHJhZGl1cyA8IDApIHtcclxuICAgICAgICAgICAgcmFkaXVzID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLnJhZGl1cyA9IHJhZGl1cztcclxuICAgIH1cclxufTtcclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZvbGQuanNcbi8vIG1vZHVsZSBpZCA9IDM0XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  ImageNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Node=__webpack_require__(3);\r\nmodule.exports = {\r\n    constructor:ImageNode,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT= {\r\n    image: "",\r\n    size: [60, 60],\r\n    name: "node",\r\n    alpha: 1,\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    draggable: true,\r\n    jsonId:"",\r\n    border:{\r\n        width:0,\r\n        radius:0,//最大160 最小0\r\n        color:"255,0,0"\r\n    },\r\n    zIndex: 200,//层级(10-999)\r\n    color: JTopo.util.randomColor(),\r\n    namePosition: \'bottom\',\r\n    useType: QTopo.constant.node.IMAGE,\r\n    alarm: {\r\n        show: false,\r\n        text: "",\r\n        color: "255,255,255",\r\n        font: {\r\n            size: 16,\r\n            type: "微软雅黑"\r\n        }\r\n    }\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//------\r\nfunction ImageNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this,new JTopo.Node());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(ImageNode,Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n        //处理特殊属性的设置\r\n    }\r\n}\r\n//-\r\n/**\r\n *  设置节点图片,与setColor冲突，设了图片则颜色无效\r\n *\r\n *  未设置图片则显示方形节点，内部填充颜色\r\n *  @method setImage\r\n *  @param image {string} 图片相对路径\r\n */\r\nImageNode.prototype.setImage=function(image) {\r\n    if(image){\r\n        this.jtopo.setImage(image);\r\n        this.attr.image=image;\r\n    }\r\n};\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT= {\r\n                        image: "",\r\n                        size: [60, 60],\r\n                        name: "node",\r\n                        alpha: 1,\r\n                        position: [0, 0],\r\n                        font: {\r\n                            size: 16,\r\n                            type: \'微软雅黑\',\r\n                            color: "255,255,255"\r\n                        },\r\n                        jsonId:"",\r\n                        border:{\r\n                            width:0,\r\n                            radius:0,//最大160 最小0\r\n                            color:"255,0,0"\r\n                        },\r\n                        zIndex: 200,//层级(10-999)\r\n                        color: JTopo.util.randomColor(),\r\n                        namePosition: \'bottom\',\r\n                        useType: QTopo.constant.node.IMAGE,\r\n                        alarm: {\r\n                            show: false,\r\n                            text: "",\r\n                            color: "255,255,255",\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑"\r\n                            }\r\n                        }\r\n                    };\r\n */\r\nImageNode.prototype.getDefault=getDefault;\r\n//--\r\n/**\r\n *  设置告警\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method setAlarm\r\n *  @param config {object}\r\n *  @example\r\n *          config={\r\n *              show: 是否显示告警{boolean},\r\n                text: 节点右上角告警板中内容,可为空{string},\r\n                color: 告警颜色{string} "255,255,255"/"#ffffff",\r\n                font: {\r\n                    size: 告警字体大小{number},\r\n                    type: 告警字体类型{string} 如"微软雅黑"\r\n                }\r\n *          }\r\n */\r\nImageNode.prototype.setAlarm=function(config) {\r\n    alarmAttr(this,this.attr.alarm,config);\r\n};\r\nfunction alarmAttr(qtopo,alarm,config){\r\n    var jtopo=qtopo.jtopo;\r\n    if(typeof config.show=="undefined"){\r\n        config.show=alarm.show;\r\n    }\r\n    if ((typeof config.show=="boolean"&&config.show)||(config.show=="true")) {\r\n        qtopo.setAlpha(1);\r\n        jtopo.shadow = true;\r\n        jtopo.alarm = config.text || "";\r\n        alarm.text=jtopo.alarm;\r\n        if(config.color){\r\n            jtopo.alarmColor = QTopo.util.transHex(config.color.toLowerCase());\r\n            alarm.color=jtopo.alarmColor;\r\n        }\r\n        var size=alarm.font.size;\r\n        var font=alarm.font.type;\r\n        if(config.font&&$.isNumeric(config.font.size)){\r\n            size=config.font.size;\r\n        }\r\n        if(config.font&&config.font.type){\r\n            font=config.font.type;\r\n        }\r\n        jtopo.alarmFont =  size+ \'px \' + font;\r\n        alarm.font.size=size;\r\n        alarm.font.type=font;\r\n        toggleAlarmFlash(jtopo,true);\r\n    } else {\r\n        jtopo.alarm = null;\r\n        toggleAlarmFlash(jtopo,false);\r\n    }\r\n    alarm.show=config.show;\r\n}\r\nfunction toggleAlarmFlash(node,show){\r\n    //切换闪烁\r\n    if(show){\r\n        node.shadowOffsetX = 0;\r\n        node.shadowOffsetY = 0;\r\n        node.shadowColor = "rgba(" + node.alarmColor + ",1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=true;\r\n    }else{\r\n        node.shadowOffsetX = 3;\r\n        node.shadowOffsetY = 6;\r\n        node.shadowColor="rgba(0,0,0,0.1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=false;\r\n    }\r\n}\r\n//--\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL0ltYWdlLmpzPzczNWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLE9BQU87QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0EsNkJBQTZCLFFBQVE7QUFDckMsc0NBQXNDLE9BQU87QUFDN0MsNEJBQTRCLE9BQU87QUFDbkM7QUFDQSxpQ0FBaUMsT0FBTztBQUN4QyxpQ0FBaUMsT0FBTztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzNS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlm77lvaLoioLngrlcclxuICogQGNsYXNzICBJbWFnZU5vZGVcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtOXSBOb2RlXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBOb2RlPXJlcXVpcmUoXCIuL05vZGUuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6SW1hZ2VOb2RlLFxyXG4gICAgc2V0RGVmYXVsdDpzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDpnZXREZWZhdWx0XHJcbn07XHJcbi8vLVxyXG52YXIgREVGQVVMVD0ge1xyXG4gICAgaW1hZ2U6IFwiXCIsXHJcbiAgICBzaXplOiBbNjAsIDYwXSxcclxuICAgIG5hbWU6IFwibm9kZVwiLFxyXG4gICAgYWxwaGE6IDEsXHJcbiAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgIGNvbG9yOiBcIjI1NSwyNTUsMjU1XCJcclxuICAgIH0sXHJcbiAgICBkcmFnZ2FibGU6IHRydWUsXHJcbiAgICBqc29uSWQ6XCJcIixcclxuICAgIGJvcmRlcjp7XHJcbiAgICAgICAgd2lkdGg6MCxcclxuICAgICAgICByYWRpdXM6MCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgY29sb3I6XCIyNTUsMCwwXCJcclxuICAgIH0sXHJcbiAgICB6SW5kZXg6IDIwMCwvL+Wxgue6pygxMC05OTkpXHJcbiAgICBjb2xvcjogSlRvcG8udXRpbC5yYW5kb21Db2xvcigpLFxyXG4gICAgbmFtZVBvc2l0aW9uOiAnYm90dG9tJyxcclxuICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0UsXHJcbiAgICBhbGFybToge1xyXG4gICAgICAgIHNob3c6IGZhbHNlLFxyXG4gICAgICAgIHRleHQ6IFwiXCIsXHJcbiAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIixcclxuICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZyl7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKXtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuLy8tLS0tLS1cclxuZnVuY3Rpb24gSW1hZ2VOb2RlKGNvbmZpZykge1xyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTm9kZS5jYWxsKHRoaXMsbmV3IEpUb3BvLk5vZGUoKSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoSW1hZ2VOb2RlLE5vZGUpO1xyXG4vLy1cclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAvL+WkhOeQhuS4gOiIrOWxnuaAp+eahOiuvue9rlxyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgICAgICAvL+WkhOeQhueJueauiuWxnuaAp+eahOiuvue9rlxyXG4gICAgfVxyXG59XHJcbi8vLVxyXG4vKipcclxuICogIOiuvue9ruiKgueCueWbvueJhyzkuI5zZXRDb2xvcuWGsueqge+8jOiuvuS6huWbvueJh+WImeminOiJsuaXoOaViFxyXG4gKlxyXG4gKiAg5pyq6K6+572u5Zu+54mH5YiZ5pi+56S65pa55b2i6IqC54K577yM5YaF6YOo5aGr5YWF6aKc6ImyXHJcbiAqICBAbWV0aG9kIHNldEltYWdlXHJcbiAqICBAcGFyYW0gaW1hZ2Uge3N0cmluZ30g5Zu+54mH55u45a+56Lev5b6EXHJcbiAqL1xyXG5JbWFnZU5vZGUucHJvdG90eXBlLnNldEltYWdlPWZ1bmN0aW9uKGltYWdlKSB7XHJcbiAgICBpZihpbWFnZSl7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zZXRJbWFnZShpbWFnZSk7XHJcbiAgICAgICAgdGhpcy5hdHRyLmltYWdlPWltYWdlO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiOt+WPluWFqOWxgOiuvue9rlxyXG4gKiAgQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqICBAcmV0dXJuIGNvbmZpZyB7b2JqZWN0fSDlhajlsYDphY3nva7nmoTlhYvpmoblr7nosaFb5Y+q6K+7Xe+8jOS/ruaUueivpeWvueixoeS4jeS8muebtOaOpeS/ruaUueWFqOWxgOmFjee9ru+8jOiLpeimgeS/ruaUueWFqOWxgOmFjee9ruivt+S9v+eUqHNjZW5lLnNldERlZmF1bHRcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOm7mOiupOWFqOWxgOWPguaVsDpcclxuICogICAgICAgICAgICAgIHZhciBERUZBVUxUPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbNjAsIDYwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJub2RlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDIwMCwvL+Wxgue6pygxMC05OTkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBKVG9wby51dGlsLnJhbmRvbUNvbG9yKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQb3NpdGlvbjogJ2JvdHRvbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5JbWFnZU5vZGUucHJvdG90eXBlLmdldERlZmF1bHQ9Z2V0RGVmYXVsdDtcclxuLy8tLVxyXG4vKipcclxuICogIOiuvue9ruWRiuitplxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRBbGFybVxyXG4gKiAgQHBhcmFtIGNvbmZpZyB7b2JqZWN0fVxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHNob3c6IOaYr+WQpuaYvuekuuWRiuitpntib29sZWFufSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IOiKgueCueWPs+S4iuinkuWRiuitpuadv+S4reWGheWuuSzlj6/kuLrnqbp7c3RyaW5nfSxcclxuICAgICAgICAgICAgICAgIGNvbG9yOiDlkYrorabpopzoibJ7c3RyaW5nfSBcIjI1NSwyNTUsMjU1XCIvXCIjZmZmZmZmXCIsXHJcbiAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTog5ZGK6K2m5a2X5L2T5aSn5bCPe251bWJlcn0sXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTog5ZGK6K2m5a2X5L2T57G75Z6Le3N0cmluZ30g5aaCXCLlvq7ova/pm4Xpu5FcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5JbWFnZU5vZGUucHJvdG90eXBlLnNldEFsYXJtPWZ1bmN0aW9uKGNvbmZpZykge1xyXG4gICAgYWxhcm1BdHRyKHRoaXMsdGhpcy5hdHRyLmFsYXJtLGNvbmZpZyk7XHJcbn07XHJcbmZ1bmN0aW9uIGFsYXJtQXR0cihxdG9wbyxhbGFybSxjb25maWcpe1xyXG4gICAgdmFyIGp0b3BvPXF0b3BvLmp0b3BvO1xyXG4gICAgaWYodHlwZW9mIGNvbmZpZy5zaG93PT1cInVuZGVmaW5lZFwiKXtcclxuICAgICAgICBjb25maWcuc2hvdz1hbGFybS5zaG93O1xyXG4gICAgfVxyXG4gICAgaWYgKCh0eXBlb2YgY29uZmlnLnNob3c9PVwiYm9vbGVhblwiJiZjb25maWcuc2hvdyl8fChjb25maWcuc2hvdz09XCJ0cnVlXCIpKSB7XHJcbiAgICAgICAgcXRvcG8uc2V0QWxwaGEoMSk7XHJcbiAgICAgICAganRvcG8uc2hhZG93ID0gdHJ1ZTtcclxuICAgICAgICBqdG9wby5hbGFybSA9IGNvbmZpZy50ZXh0IHx8IFwiXCI7XHJcbiAgICAgICAgYWxhcm0udGV4dD1qdG9wby5hbGFybTtcclxuICAgICAgICBpZihjb25maWcuY29sb3Ipe1xyXG4gICAgICAgICAgICBqdG9wby5hbGFybUNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb25maWcuY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIGFsYXJtLmNvbG9yPWp0b3BvLmFsYXJtQ29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzaXplPWFsYXJtLmZvbnQuc2l6ZTtcclxuICAgICAgICB2YXIgZm9udD1hbGFybS5mb250LnR5cGU7XHJcbiAgICAgICAgaWYoY29uZmlnLmZvbnQmJiQuaXNOdW1lcmljKGNvbmZpZy5mb250LnNpemUpKXtcclxuICAgICAgICAgICAgc2l6ZT1jb25maWcuZm9udC5zaXplO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihjb25maWcuZm9udCYmY29uZmlnLmZvbnQudHlwZSl7XHJcbiAgICAgICAgICAgIGZvbnQ9Y29uZmlnLmZvbnQudHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAganRvcG8uYWxhcm1Gb250ID0gIHNpemUrICdweCAnICsgZm9udDtcclxuICAgICAgICBhbGFybS5mb250LnNpemU9c2l6ZTtcclxuICAgICAgICBhbGFybS5mb250LnR5cGU9Zm9udDtcclxuICAgICAgICB0b2dnbGVBbGFybUZsYXNoKGp0b3BvLHRydWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBqdG9wby5hbGFybSA9IG51bGw7XHJcbiAgICAgICAgdG9nZ2xlQWxhcm1GbGFzaChqdG9wbyxmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBhbGFybS5zaG93PWNvbmZpZy5zaG93O1xyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUFsYXJtRmxhc2gobm9kZSxzaG93KXtcclxuICAgIC8v5YiH5o2i6Zeq54OBXHJcbiAgICBpZihzaG93KXtcclxuICAgICAgICBub2RlLnNoYWRvd09mZnNldFggPSAwO1xyXG4gICAgICAgIG5vZGUuc2hhZG93T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dDb2xvciA9IFwicmdiYShcIiArIG5vZGUuYWxhcm1Db2xvciArIFwiLDEpXCI7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dCbHVyID0gMTA7XHJcbiAgICAgICAgbm9kZS5hbGxvd0FsYXJtRmxhc2g9dHJ1ZTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIG5vZGUuc2hhZG93T2Zmc2V0WCA9IDM7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dPZmZzZXRZID0gNjtcclxuICAgICAgICBub2RlLnNoYWRvd0NvbG9yPVwicmdiYSgwLDAsMCwwLjEpXCI7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dCbHVyID0gMTA7XHJcbiAgICAgICAgbm9kZS5hbGxvd0FsYXJtRmxhc2g9ZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuLy8tLVxyXG4vLy1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L25vZGUvSW1hZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDM1XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\nvar Node=__webpack_require__(3);\r\nmodule.exports = {\r\n    constructor:ShapeNode,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT= {\r\n    size: [200, 100],\r\n    name: "shape",\r\n    alpha: 1,\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    jsonId:"",\r\n    border:{\r\n        width:0,\r\n        radius:0,//最大160 最小0\r\n        color:"255,0,0"\r\n    },\r\n    shapeType:\'ellipse\',\r\n    zIndex: 200,//层级(10-999)\r\n    color: JTopo.util.randomColor(),\r\n    namePosition: \'bottom\',\r\n    useType: QTopo.constant.node.SHAPE\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n/**\r\n * 形状节点\r\n * @class  ShapeNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nfunction ShapeNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this,new JTopo.Node());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(ShapeNode,Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n        //处理特殊属性的设置\r\n    }\r\n}\r\n\r\n//-\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT= {\r\n                        image: "",\r\n                        size: [60, 60],\r\n                        name: "node",\r\n                        alpha: 1,\r\n                        position: [0, 0],\r\n                        font: {\r\n                            size: 16,\r\n                            type: \'微软雅黑\',\r\n                            color: "255,255,255"\r\n                        },\r\n                        jsonId:"",\r\n                        border:{\r\n                            width:0,\r\n                            radius:0,//最大160 最小0\r\n                            color:"255,0,0"\r\n                        },\r\n                        zIndex: 200,//层级(10-999)\r\n                        color: JTopo.util.randomColor(),\r\n                        namePosition: \'bottom\',\r\n                        useType: QTopo.constant.node.IMAGE,\r\n                        alarm: {\r\n                            show: false,\r\n                            text: "",\r\n                            color: "255,255,255",\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑"\r\n                            }\r\n                        }\r\n                    };\r\n */\r\nShapeNode.prototype.getDefault=getDefault;\r\n//-\r\nShapeNode.prototype.setShapeType=function(type){\r\n    var jtopo=this.jtopo;\r\n    switch (type){\r\n        case \'ellipse\':\r\n            this.attr.shapeType=\'ellipse\';\r\n            jtopo.paint=paintEllipse;\r\n            break;\r\n    }\r\n};\r\nfunction paintEllipse(ctx){\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    var radiusX = (this.width/0.75)/2,\r\n        radiusY = this.height/2;\r\n    ctx.moveTo(0, -radiusY);\r\n    ctx.bezierCurveTo(radiusX, -radiusY, radiusX, radiusY, 0, radiusY);//右半边\r\n    ctx.bezierCurveTo(-radiusX, radiusY, -radiusX, -radiusY, 0, -radiusY);//左半边\r\n    ctx.closePath();\r\n    if(this.jtopo.gradien){\r\n        ctx.fillStyle=this.jtopo.gradien;\r\n    }else{\r\n        ctx.fillStyle = \'rgba(\'+this.fillColor+"," + this.alpha + ")";\r\n    }\r\n    ctx.fill();\r\n    ctx.restore();\r\n    this.paintCtrl(ctx);\r\n    this.paintAlarmText(ctx);\r\n    this.paintText(ctx);\r\n}\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1NoYXBlLmpzP2ZkMDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFO0FBQ3ZFLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjM2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxudmFyIE5vZGU9cmVxdWlyZShcIi4vTm9kZS5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBjb25zdHJ1Y3RvcjpTaGFwZU5vZGUsXHJcbiAgICBzZXREZWZhdWx0OnNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OmdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUPSB7XHJcbiAgICBzaXplOiBbMjAwLCAxMDBdLFxyXG4gICAgbmFtZTogXCJzaGFwZVwiLFxyXG4gICAgYWxwaGE6IDEsXHJcbiAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgIGNvbG9yOiBcIjI1NSwyNTUsMjU1XCJcclxuICAgIH0sXHJcbiAgICBqc29uSWQ6XCJcIixcclxuICAgIGJvcmRlcjp7XHJcbiAgICAgICAgd2lkdGg6MCxcclxuICAgICAgICByYWRpdXM6MCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgY29sb3I6XCIyNTUsMCwwXCJcclxuICAgIH0sXHJcbiAgICBzaGFwZVR5cGU6J2VsbGlwc2UnLFxyXG4gICAgekluZGV4OiAyMDAsLy/lsYLnuqcoMTAtOTk5KVxyXG4gICAgY29sb3I6IEpUb3BvLnV0aWwucmFuZG9tQ29sb3IoKSxcclxuICAgIG5hbWVQb3NpdGlvbjogJ2JvdHRvbScsXHJcbiAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5ub2RlLlNIQVBFXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKXtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpe1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG4vKipcclxuICog5b2i54q26IqC54K5XHJcbiAqIEBjbGFzcyAgU2hhcGVOb2RlXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTl0gTm9kZVxyXG4gKiBAcGFyYW0gW2NvbmZpZ10g6YWN572u5Y+C5pWw77yM5peg5Y+C5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqL1xyXG5mdW5jdGlvbiBTaGFwZU5vZGUoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBOb2RlLmNhbGwodGhpcyxuZXcgSlRvcG8uTm9kZSgpKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhTaGFwZU5vZGUsTm9kZSk7XHJcbi8vLVxyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIC8v5aSE55CG5LiA6Iis5bGe5oCn55qE6K6+572uXHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgICAgIC8v5aSE55CG54m55q6K5bGe5oCn55qE6K6+572uXHJcbiAgICB9XHJcbn1cclxuXHJcbi8vLVxyXG4vKipcclxuICogIOiOt+WPluWFqOWxgOiuvue9rlxyXG4gKiAgQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqICBAcmV0dXJuIGNvbmZpZyB7b2JqZWN0fSDlhajlsYDphY3nva7nmoTlhYvpmoblr7nosaFb5Y+q6K+7Xe+8jOS/ruaUueivpeWvueixoeS4jeS8muebtOaOpeS/ruaUueWFqOWxgOmFjee9ru+8jOiLpeimgeS/ruaUueWFqOWxgOmFjee9ruivt+S9v+eUqHNjZW5lLnNldERlZmF1bHRcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOm7mOiupOWFqOWxgOWPguaVsDpcclxuICogICAgICAgICAgICAgIHZhciBERUZBVUxUPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbNjAsIDYwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJub2RlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDIwMCwvL+Wxgue6pygxMC05OTkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBKVG9wby51dGlsLnJhbmRvbUNvbG9yKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQb3NpdGlvbjogJ2JvdHRvbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5TaGFwZU5vZGUucHJvdG90eXBlLmdldERlZmF1bHQ9Z2V0RGVmYXVsdDtcclxuLy8tXHJcblNoYXBlTm9kZS5wcm90b3R5cGUuc2V0U2hhcGVUeXBlPWZ1bmN0aW9uKHR5cGUpe1xyXG4gICAgdmFyIGp0b3BvPXRoaXMuanRvcG87XHJcbiAgICBzd2l0Y2ggKHR5cGUpe1xyXG4gICAgICAgIGNhc2UgJ2VsbGlwc2UnOlxyXG4gICAgICAgICAgICB0aGlzLmF0dHIuc2hhcGVUeXBlPSdlbGxpcHNlJztcclxuICAgICAgICAgICAganRvcG8ucGFpbnQ9cGFpbnRFbGxpcHNlO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gcGFpbnRFbGxpcHNlKGN0eCl7XHJcbiAgICBjdHguc2F2ZSgpO1xyXG4gICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgdmFyIHJhZGl1c1ggPSAodGhpcy53aWR0aC8wLjc1KS8yLFxyXG4gICAgICAgIHJhZGl1c1kgPSB0aGlzLmhlaWdodC8yO1xyXG4gICAgY3R4Lm1vdmVUbygwLCAtcmFkaXVzWSk7XHJcbiAgICBjdHguYmV6aWVyQ3VydmVUbyhyYWRpdXNYLCAtcmFkaXVzWSwgcmFkaXVzWCwgcmFkaXVzWSwgMCwgcmFkaXVzWSk7Ly/lj7PljYrovrlcclxuICAgIGN0eC5iZXppZXJDdXJ2ZVRvKC1yYWRpdXNYLCByYWRpdXNZLCAtcmFkaXVzWCwgLXJhZGl1c1ksIDAsIC1yYWRpdXNZKTsvL+W3puWNiui+uVxyXG4gICAgY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgaWYodGhpcy5qdG9wby5ncmFkaWVuKXtcclxuICAgICAgICBjdHguZmlsbFN0eWxlPXRoaXMuanRvcG8uZ3JhZGllbjtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSAncmdiYSgnK3RoaXMuZmlsbENvbG9yK1wiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgfVxyXG4gICAgY3R4LmZpbGwoKTtcclxuICAgIGN0eC5yZXN0b3JlKCk7XHJcbiAgICB0aGlzLnBhaW50Q3RybChjdHgpO1xyXG4gICAgdGhpcy5wYWludEFsYXJtVGV4dChjdHgpO1xyXG4gICAgdGhpcy5wYWludFRleHQoY3R4KTtcclxufVxyXG4vLy1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L25vZGUvU2hhcGUuanNcbi8vIG1vZHVsZSBpZCA9IDM2XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 文本节点\r\n * @class  TextNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Node = __webpack_require__(3);\r\nmodule.exports = {\r\n    constructor: TextNode,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    jsonId:"",\r\n    border: {\r\n        width: 0,\r\n        radius: 0,//最大160 最小0\r\n        color: "255,0,0"\r\n    },\r\n    zIndex: 200,//层级(10-999)\r\n    alpha: 1,\r\n    text: \'no text here\',\r\n    useType: QTopo.constant.node.TEXT\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\nfunction TextNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this, new JTopo.TextNode());\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(TextNode, Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *\r\n *  若传入参数的text未配置，则显示为  "not set text"\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        if (!this.attr.text&&!config.text) {\r\n            config.text = "not set text";\r\n        }\r\n        this._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT = {\r\n                    position: [0, 0],\r\n                    font: {\r\n                        size: 16,\r\n                        type: \'微软雅黑\',\r\n                        color: "255,255,255"\r\n                    },\r\n                    jsonId:"",\r\n                    border: {\r\n                        width: 0,\r\n                        radius: 0,//最大160 最小0\r\n                        color: "255,0,0"\r\n                    },\r\n                    zIndex: 200,//层级(10-999)\r\n                    alpha: 1,\r\n                    text: \'no text here\',\r\n                    useType: QTopo.constant.node.TEXT\r\n                };\r\n */\r\nTextNode.prototype.getDefault = getDefault;\r\n//-\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1RleHQuanM/MzM5ZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjM3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOaWh+acrOiKgueCuVxyXG4gKiBAY2xhc3MgIFRleHROb2RlXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTl0gTm9kZVxyXG4gKiBAcGFyYW0gW2NvbmZpZ10g6YWN572u5Y+C5pWw77yM5peg5Y+C5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqL1xyXG52YXIgTm9kZSA9IHJlcXVpcmUoXCIuL05vZGUuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6IFRleHROb2RlLFxyXG4gICAgc2V0RGVmYXVsdDogc2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6IGdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID0ge1xyXG4gICAgcG9zaXRpb246IFswLCAwXSxcclxuICAgIGZvbnQ6IHtcclxuICAgICAgICBzaXplOiAxNixcclxuICAgICAgICB0eXBlOiAn5b6u6L2v6ZuF6buRJyxcclxuICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICB9LFxyXG4gICAganNvbklkOlwiXCIsXHJcbiAgICBib3JkZXI6IHtcclxuICAgICAgICB3aWR0aDogMCxcclxuICAgICAgICByYWRpdXM6IDAsLy/mnIDlpKcxNjAg5pyA5bCPMFxyXG4gICAgICAgIGNvbG9yOiBcIjI1NSwwLDBcIlxyXG4gICAgfSxcclxuICAgIHpJbmRleDogMjAwLC8v5bGC57qnKDEwLTk5OSlcclxuICAgIGFscGhhOiAxLFxyXG4gICAgdGV4dDogJ25vIHRleHQgaGVyZScsXHJcbiAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5ub2RlLlRFWFRcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpIHtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuZnVuY3Rpb24gVGV4dE5vZGUoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBOb2RlLmNhbGwodGhpcywgbmV3IEpUb3BvLlRleHROb2RlKCkpO1xyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoVGV4dE5vZGUsIE5vZGUpO1xyXG4vLy1cclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICpcclxuICogIOiLpeS8oOWFpeWPguaVsOeahHRleHTmnKrphY3nva7vvIzliJnmmL7npLrkuLogIFwibm90IHNldCB0ZXh0XCJcclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAvL+WkhOeQhuS4gOiIrOWxnuaAp+eahOiuvue9rlxyXG4gICAgICAgIGlmICghdGhpcy5hdHRyLnRleHQmJiFjb25maWcudGV4dCkge1xyXG4gICAgICAgICAgICBjb25maWcudGV4dCA9IFwibm90IHNldCB0ZXh0XCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG4vLy1cclxuLyoqXHJcbiAqICDojrflj5blhajlsYDorr7nva5cclxuICogIEBtZXRob2QgZ2V0RGVmYXVsdFxyXG4gKiAgQHJldHVybiBjb25maWcge29iamVjdH0g5YWo5bGA6YWN572u55qE5YWL6ZqG5a+56LGhW+WPquivu13vvIzkv67mlLnor6Xlr7nosaHkuI3kvJrnm7TmjqXkv67mlLnlhajlsYDphY3nva7vvIzoi6XopoHkv67mlLnlhajlsYDphY3nva7or7fkvb/nlKhzY2VuZS5zZXREZWZhdWx0XHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDpu5jorqTlhajlsYDlj4LmlbA6XHJcbiAqICAgICAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czogMCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcIjI1NSwwLDBcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgekluZGV4OiAyMDAsLy/lsYLnuqcoMTAtOTk5KVxyXG4gICAgICAgICAgICAgICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdubyB0ZXh0IGhlcmUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50Lm5vZGUuVEVYVFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICovXHJcblRleHROb2RlLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcclxuLy8tXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbm9kZS9UZXh0LmpzXG4vLyBtb2R1bGUgaWQgPSAzN1xuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * @class Scene\r\n */\r\nvar events = {\r\n    init: function (scene) {\r\n        /**\r\n         * 在图层上双击时\r\n         *\r\n         * 目标是分组,则分组可进行缩放和还原\r\n         *\r\n         * 目标为链路,QTopo.constant.link.DIRECT类型的链路计数大于1时可展开和合并\r\n         * @event dbclick\r\n         */\r\n        scene.on("dbclick", dbClick(scene));\r\n    }\r\n};\r\nfunction dbClick(scene) {\r\n    return function (e, qtopo) {\r\n        toggleGroup(e, qtopo, scene);\r\n        toggleLink(e, qtopo, scene);\r\n    }\r\n}\r\nfunction toggleGroup(e, qtopo, scene) {\r\n    //分组隐藏，显示缩放节点，节点位置根据分组长宽计算\r\n    if (qtopo) {\r\n        if (qtopo.getType() == QTopo.constant.CONTAINER) {\r\n            qtopo.toggle();\r\n        } else if (qtopo.getType() == QTopo.constant.NODE && qtopo.getUseType() == QTopo.constant.CASUAL) {\r\n            //分组显示，隐藏缩放节点，分组新位置根据节点位置和分组长宽计算\r\n            if (qtopo.toggleTo) {\r\n                qtopo.toggleTo.toggle();\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction toggleLink(e, qtopo, scene) {\r\n    if (qtopo && qtopo.getType() == QTopo.constant.LINK && qtopo.attr.expendAble) {\r\n        if (!$.isFunction(qtopo.toggle)) {\r\n            qtopo.openToggle(scene);\r\n        }\r\n        qtopo.toggle();\r\n    }\r\n}\r\nmodule.exports = events;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZXZlbnRzLmpzP2FmNWMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjM4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIEBjbGFzcyBTY2VuZVxyXG4gKi9cclxudmFyIGV2ZW50cyA9IHtcclxuICAgIGluaXQ6IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWcqOWbvuWxguS4iuWPjOWHu+aXtlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICog55uu5qCH5piv5YiG57uELOWImeWIhue7hOWPr+i/m+ihjOe8qeaUvuWSjOi/mOWOn1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICog55uu5qCH5Li66ZO+6LevLFFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNU57G75Z6L55qE6ZO+6Lev6K6h5pWw5aSn5LqOMeaXtuWPr+WxleW8gOWSjOWQiOW5tlxyXG4gICAgICAgICAqIEBldmVudCBkYmNsaWNrXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2NlbmUub24oXCJkYmNsaWNrXCIsIGRiQ2xpY2soc2NlbmUpKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gZGJDbGljayhzY2VuZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlLCBxdG9wbykge1xyXG4gICAgICAgIHRvZ2dsZUdyb3VwKGUsIHF0b3BvLCBzY2VuZSk7XHJcbiAgICAgICAgdG9nZ2xlTGluayhlLCBxdG9wbywgc2NlbmUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUdyb3VwKGUsIHF0b3BvLCBzY2VuZSkge1xyXG4gICAgLy/liIbnu4TpmpDol4/vvIzmmL7npLrnvKnmlL7oioLngrnvvIzoioLngrnkvY3nva7moLnmja7liIbnu4Tplb/lrr3orqHnrpdcclxuICAgIGlmIChxdG9wbykge1xyXG4gICAgICAgIGlmIChxdG9wby5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSKSB7XHJcbiAgICAgICAgICAgIHF0b3BvLnRvZ2dsZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXRvcG8uZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50Lk5PREUgJiYgcXRvcG8uZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAvL+WIhue7hOaYvuekuu+8jOmakOiXj+e8qeaUvuiKgueCue+8jOWIhue7hOaWsOS9jee9ruagueaNruiKgueCueS9jee9ruWSjOWIhue7hOmVv+Wuveiuoeeul1xyXG4gICAgICAgICAgICBpZiAocXRvcG8udG9nZ2xlVG8pIHtcclxuICAgICAgICAgICAgICAgIHF0b3BvLnRvZ2dsZVRvLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUxpbmsoZSwgcXRvcG8sIHNjZW5lKSB7XHJcbiAgICBpZiAocXRvcG8gJiYgcXRvcG8uZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkxJTksgJiYgcXRvcG8uYXR0ci5leHBlbmRBYmxlKSB7XHJcbiAgICAgICAgaWYgKCEkLmlzRnVuY3Rpb24ocXRvcG8udG9nZ2xlKSkge1xyXG4gICAgICAgICAgICBxdG9wby5vcGVuVG9nZ2xlKHNjZW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcXRvcG8udG9nZ2xlKCk7XHJcbiAgICB9XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBldmVudHM7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2V2ZW50cy5qc1xuLy8gbW9kdWxlIGlkID0gMzhcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('/**\r\n * Created by qiyc on 2017/4/12.\r\n */\r\nfunction Element() {\r\n    this.initialize = function () {\r\n        this.elementType = "element";\r\n        this.serializedProperties = ["elementType"];\r\n        this.propertiesStack = [];\r\n        this._id = "" + (new Date).getTime();\r\n    };\r\n    this.distroy = function () {\r\n    };\r\n    this.removeHandler = function () {\r\n    };\r\n    this.attr = function (a, b) {\r\n        if (null != a && null != b)this[a] = b; else if (null != a)return this[a];\r\n        return this\r\n    };\r\n    this.save = function () {\r\n        var a = this;\r\n        var b = {};\r\n        this.serializedProperties.forEach(function (properties) {\r\n            b[properties] = a[properties];\r\n        });\r\n        this.propertiesStack.push(b);\r\n    };\r\n    this.restore = function () {\r\n        if (null != this.propertiesStack && 0 != this.propertiesStack.length) {\r\n            var a = this, b = this.propertiesStack.pop();\r\n            this.serializedProperties.forEach(function (c) {\r\n                a[c] = b[c]\r\n            })\r\n        }\r\n    };\r\n}\r\n\r\n/*a=this.x - this.borderWidth / 2 b=this.y - this.borderWidth / 2,*/\r\nCanvasRenderingContext2D.prototype.JTopoRoundRect = function (startX, startY, w_borderWidth, h_borderWidth, borderRadius) {\r\n    //画元素圆角边框\r\n    if ("undefined" == typeof borderRadius) {\r\n        borderRadius = 5;\r\n    }\r\n    this.beginPath();\r\n    this.moveTo(startX + borderRadius, startY);\r\n    this.lineTo(startX + w_borderWidth - borderRadius, startY);\r\n    this.quadraticCurveTo(startX + w_borderWidth, startY, startX + w_borderWidth, startY + borderRadius);\r\n    this.lineTo(startX + w_borderWidth, startY + h_borderWidth - borderRadius);\r\n    this.quadraticCurveTo(startX + w_borderWidth, startY + h_borderWidth, startX + w_borderWidth - borderRadius, startY + h_borderWidth);\r\n    this.lineTo(startX + borderRadius, startY + h_borderWidth);\r\n    this.quadraticCurveTo(startX, startY + h_borderWidth, startX, startY + h_borderWidth - borderRadius);\r\n    this.lineTo(startX, startY + borderRadius);\r\n    this.quadraticCurveTo(startX, startY, startX + borderRadius, startY);\r\n    this.closePath();\r\n};\r\nCanvasRenderingContext2D.prototype.JTopoDashedLineTo = function (sX, sY, eX, eY, dashedPattern) {\r\n    //画虚线\r\n    if ("undefined" == typeof dashedPattern) {\r\n        dashedPattern = 5;\r\n    }\r\n    var dX = eX - sX;\r\n    var dY = eY - sY;\r\n    var length = Math.floor(Math.sqrt(dX * dX + dY * dY));\r\n    var dashL = 0 >= dashedPattern ? length : length / dashedPattern;\r\n    var tY = dY / length * dashedPattern;\r\n    var tX = dX / length * dashedPattern;\r\n    this.beginPath();\r\n    for (var m = 0; dashL > m; m++) {\r\n        if (m % 2) {\r\n            this.lineTo(sX + m * tX, sY + m * tY);\r\n        } else {\r\n            this.moveTo(sX + m * tX, sY + m * tY);\r\n        }\r\n    }\r\n    this.stroke();\r\n};\r\nvar JTopo = {\r\n    version: "0.4.8_01",\r\n    zIndex_Container: 1,\r\n    zIndex_Link: 2,\r\n    zIndex_Node: 3,\r\n    SceneMode: {normal: "normal", drag: "drag", edit: "edit", select: "select"},\r\n    MouseCursor: {\r\n        normal: "default",\r\n        pointer: "pointer",\r\n        top_left: "nw-resize",\r\n        top_center: "n-resize",\r\n        top_right: "ne-resize",\r\n        middle_left: "e-resize",\r\n        middle_right: "e-resize",\r\n        bottom_left: "ne-resize",\r\n        bottom_center: "n-resize",\r\n        bottom_right: "nw-resize",\r\n        move: "move",\r\n        open_hand: "default",\r\n        closed_hand: "default"\r\n    }\r\n};\r\nJTopo.Element = Element;\r\nmodule.exports = JTopo;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vYmFzZS5qcz8wOTVjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFdBQVc7QUFDOUI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwrREFBK0Q7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjM5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgcWl5YyBvbiAyMDE3LzQvMTIuXHJcbiAqL1xyXG5mdW5jdGlvbiBFbGVtZW50KCkge1xyXG4gICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImVsZW1lbnRcIjtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gW1wiZWxlbWVudFR5cGVcIl07XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzU3RhY2sgPSBbXTtcclxuICAgICAgICB0aGlzLl9pZCA9IFwiXCIgKyAobmV3IERhdGUpLmdldFRpbWUoKTtcclxuICAgIH07XHJcbiAgICB0aGlzLmRpc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5yZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgfTtcclxuICAgIHRoaXMuYXR0ciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gYSAmJiBudWxsICE9IGIpdGhpc1thXSA9IGI7IGVsc2UgaWYgKG51bGwgIT0gYSlyZXR1cm4gdGhpc1thXTtcclxuICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgfTtcclxuICAgIHRoaXMuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYSA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGIgPSB7fTtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgYltwcm9wZXJ0aWVzXSA9IGFbcHJvcGVydGllc107XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzU3RhY2sucHVzaChiKTtcclxuICAgIH07XHJcbiAgICB0aGlzLnJlc3RvcmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5wcm9wZXJ0aWVzU3RhY2sgJiYgMCAhPSB0aGlzLnByb3BlcnRpZXNTdGFjay5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSB0aGlzLCBiID0gdGhpcy5wcm9wZXJ0aWVzU3RhY2sucG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgYVtjXSA9IGJbY11cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG4vKmE9dGhpcy54IC0gdGhpcy5ib3JkZXJXaWR0aCAvIDIgYj10aGlzLnkgLSB0aGlzLmJvcmRlcldpZHRoIC8gMiwqL1xyXG5DYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLkpUb3BvUm91bmRSZWN0ID0gZnVuY3Rpb24gKHN0YXJ0WCwgc3RhcnRZLCB3X2JvcmRlcldpZHRoLCBoX2JvcmRlcldpZHRoLCBib3JkZXJSYWRpdXMpIHtcclxuICAgIC8v55S75YWD57Sg5ZyG6KeS6L655qGGXHJcbiAgICBpZiAoXCJ1bmRlZmluZWRcIiA9PSB0eXBlb2YgYm9yZGVyUmFkaXVzKSB7XHJcbiAgICAgICAgYm9yZGVyUmFkaXVzID0gNTtcclxuICAgIH1cclxuICAgIHRoaXMuYmVnaW5QYXRoKCk7XHJcbiAgICB0aGlzLm1vdmVUbyhzdGFydFggKyBib3JkZXJSYWRpdXMsIHN0YXJ0WSk7XHJcbiAgICB0aGlzLmxpbmVUbyhzdGFydFggKyB3X2JvcmRlcldpZHRoIC0gYm9yZGVyUmFkaXVzLCBzdGFydFkpO1xyXG4gICAgdGhpcy5xdWFkcmF0aWNDdXJ2ZVRvKHN0YXJ0WCArIHdfYm9yZGVyV2lkdGgsIHN0YXJ0WSwgc3RhcnRYICsgd19ib3JkZXJXaWR0aCwgc3RhcnRZICsgYm9yZGVyUmFkaXVzKTtcclxuICAgIHRoaXMubGluZVRvKHN0YXJ0WCArIHdfYm9yZGVyV2lkdGgsIHN0YXJ0WSArIGhfYm9yZGVyV2lkdGggLSBib3JkZXJSYWRpdXMpO1xyXG4gICAgdGhpcy5xdWFkcmF0aWNDdXJ2ZVRvKHN0YXJ0WCArIHdfYm9yZGVyV2lkdGgsIHN0YXJ0WSArIGhfYm9yZGVyV2lkdGgsIHN0YXJ0WCArIHdfYm9yZGVyV2lkdGggLSBib3JkZXJSYWRpdXMsIHN0YXJ0WSArIGhfYm9yZGVyV2lkdGgpO1xyXG4gICAgdGhpcy5saW5lVG8oc3RhcnRYICsgYm9yZGVyUmFkaXVzLCBzdGFydFkgKyBoX2JvcmRlcldpZHRoKTtcclxuICAgIHRoaXMucXVhZHJhdGljQ3VydmVUbyhzdGFydFgsIHN0YXJ0WSArIGhfYm9yZGVyV2lkdGgsIHN0YXJ0WCwgc3RhcnRZICsgaF9ib3JkZXJXaWR0aCAtIGJvcmRlclJhZGl1cyk7XHJcbiAgICB0aGlzLmxpbmVUbyhzdGFydFgsIHN0YXJ0WSArIGJvcmRlclJhZGl1cyk7XHJcbiAgICB0aGlzLnF1YWRyYXRpY0N1cnZlVG8oc3RhcnRYLCBzdGFydFksIHN0YXJ0WCArIGJvcmRlclJhZGl1cywgc3RhcnRZKTtcclxuICAgIHRoaXMuY2xvc2VQYXRoKCk7XHJcbn07XHJcbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuSlRvcG9EYXNoZWRMaW5lVG8gPSBmdW5jdGlvbiAoc1gsIHNZLCBlWCwgZVksIGRhc2hlZFBhdHRlcm4pIHtcclxuICAgIC8v55S76Jma57q/XHJcbiAgICBpZiAoXCJ1bmRlZmluZWRcIiA9PSB0eXBlb2YgZGFzaGVkUGF0dGVybikge1xyXG4gICAgICAgIGRhc2hlZFBhdHRlcm4gPSA1O1xyXG4gICAgfVxyXG4gICAgdmFyIGRYID0gZVggLSBzWDtcclxuICAgIHZhciBkWSA9IGVZIC0gc1k7XHJcbiAgICB2YXIgbGVuZ3RoID0gTWF0aC5mbG9vcihNYXRoLnNxcnQoZFggKiBkWCArIGRZICogZFkpKTtcclxuICAgIHZhciBkYXNoTCA9IDAgPj0gZGFzaGVkUGF0dGVybiA/IGxlbmd0aCA6IGxlbmd0aCAvIGRhc2hlZFBhdHRlcm47XHJcbiAgICB2YXIgdFkgPSBkWSAvIGxlbmd0aCAqIGRhc2hlZFBhdHRlcm47XHJcbiAgICB2YXIgdFggPSBkWCAvIGxlbmd0aCAqIGRhc2hlZFBhdHRlcm47XHJcbiAgICB0aGlzLmJlZ2luUGF0aCgpO1xyXG4gICAgZm9yICh2YXIgbSA9IDA7IGRhc2hMID4gbTsgbSsrKSB7XHJcbiAgICAgICAgaWYgKG0gJSAyKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGluZVRvKHNYICsgbSAqIHRYLCBzWSArIG0gKiB0WSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tb3ZlVG8oc1ggKyBtICogdFgsIHNZICsgbSAqIHRZKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnN0cm9rZSgpO1xyXG59O1xyXG52YXIgSlRvcG8gPSB7XHJcbiAgICB2ZXJzaW9uOiBcIjAuNC44XzAxXCIsXHJcbiAgICB6SW5kZXhfQ29udGFpbmVyOiAxLFxyXG4gICAgekluZGV4X0xpbms6IDIsXHJcbiAgICB6SW5kZXhfTm9kZTogMyxcclxuICAgIFNjZW5lTW9kZToge25vcm1hbDogXCJub3JtYWxcIiwgZHJhZzogXCJkcmFnXCIsIGVkaXQ6IFwiZWRpdFwiLCBzZWxlY3Q6IFwic2VsZWN0XCJ9LFxyXG4gICAgTW91c2VDdXJzb3I6IHtcclxuICAgICAgICBub3JtYWw6IFwiZGVmYXVsdFwiLFxyXG4gICAgICAgIHBvaW50ZXI6IFwicG9pbnRlclwiLFxyXG4gICAgICAgIHRvcF9sZWZ0OiBcIm53LXJlc2l6ZVwiLFxyXG4gICAgICAgIHRvcF9jZW50ZXI6IFwibi1yZXNpemVcIixcclxuICAgICAgICB0b3BfcmlnaHQ6IFwibmUtcmVzaXplXCIsXHJcbiAgICAgICAgbWlkZGxlX2xlZnQ6IFwiZS1yZXNpemVcIixcclxuICAgICAgICBtaWRkbGVfcmlnaHQ6IFwiZS1yZXNpemVcIixcclxuICAgICAgICBib3R0b21fbGVmdDogXCJuZS1yZXNpemVcIixcclxuICAgICAgICBib3R0b21fY2VudGVyOiBcIm4tcmVzaXplXCIsXHJcbiAgICAgICAgYm90dG9tX3JpZ2h0OiBcIm53LXJlc2l6ZVwiLFxyXG4gICAgICAgIG1vdmU6IFwibW92ZVwiLFxyXG4gICAgICAgIG9wZW5faGFuZDogXCJkZWZhdWx0XCIsXHJcbiAgICAgICAgY2xvc2VkX2hhbmQ6IFwiZGVmYXVsdFwiXHJcbiAgICB9XHJcbn07XHJcbkpUb3BvLkVsZW1lbnQgPSBFbGVtZW50O1xyXG5tb2R1bGUuZXhwb3J0cyA9IEpUb3BvO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2Jhc2UuanNcbi8vIG1vZHVsZSBpZCA9IDM5XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports){eval('module.exports = function (jtopo) {\r\n    function DisplayElement() {\r\n        this.initialize = function () {\r\n            DisplayElement.prototype.initialize.apply(this, arguments);\r\n            this.elementType = "displayElement";\r\n            this.x = 0;\r\n            this.y = 0;\r\n            this.width = 32;\r\n            this.height = 32;\r\n            this.visible = !0;\r\n            this.alpha = 1;\r\n            this.rotate = 0;\r\n            this.scaleX = 1;\r\n            this.scaleY = 1;\r\n            this.strokeColor = "22,124,255";\r\n            this.borderColor = "22,124,255";\r\n            this.fillColor = "22,124,255";\r\n            this.shadow = !1;\r\n            this.shadowBlur = 5;\r\n            this.shadowColor = "rgba(0,0,0,0.5)";\r\n            this.shadowOffsetX = 3;\r\n            this.shadowOffsetY = 6;\r\n            this.transformAble = !1;\r\n            this.zIndex = 0;\r\n            var a = "x,y,width,height,visible,alpha,rotate,scaleX,scaleY,strokeColor,fillColor,shadow,shadowColor,shadowOffsetX,shadowOffsetY,transformAble,zIndex".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(a)\r\n        };\r\n        this.initialize();\r\n        this.paint = function (a) {\r\n            a.beginPath();\r\n            a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n            a.rect(-this.width / 2, -this.height / 2, this.width, this.height);\r\n            a.fill();\r\n            a.stroke();\r\n            a.closePath();\r\n        };\r\n        this.getLocation = function () {\r\n            return {\r\n                x: this.x,\r\n                y: this.y\r\n            }\r\n        };\r\n        this.setLocation = function (a, b) {\r\n            if (this.qtopo && this.qtopo.attr && this.qtopo.attr.position) {\r\n                this.qtopo.attr.position[0] = a;\r\n                this.qtopo.attr.position[1] = b;\r\n            }\r\n            return this.x = a, this.y = b, this\r\n        };\r\n        this.getCenterLocation = function () {\r\n            return {\r\n                x: this.x + this.width / 2,\r\n                y: this.y + this.height / 2\r\n            }\r\n        };\r\n        this.setCenterLocation = function (a, b) {\r\n            this.x = a - this.width / 2;\r\n            this.y = b - this.height / 2;\r\n            return this;\r\n        };\r\n        this.getSize = function () {\r\n            return {\r\n                width: this.width,\r\n                height: this.heith\r\n            }\r\n        };\r\n        this.setSize = function (a, b) {\r\n            this.width = a;\r\n            this.height = b;\r\n            return this;\r\n        };\r\n        this.getBound = function () {\r\n            return {\r\n                left: this.x,\r\n                top: this.y,\r\n                right: this.x + this.width,\r\n                bottom: this.y + this.height,\r\n                width: this.width,\r\n                height: this.height\r\n            }\r\n        };\r\n        this.setBound = function (a, b, c, d) {\r\n            this.setLocation(a, b);\r\n            this.setSize(c, d);\r\n            return this;\r\n        };\r\n        this.getDisplayBound = function () {\r\n            return {\r\n                left: this.x,\r\n                top: this.y,\r\n                right: this.x + this.width * this.scaleX,\r\n                bottom: this.y + this.height * this.scaleY\r\n            }\r\n        };\r\n        this.getDisplaySize = function () {\r\n            return {\r\n                width: this.width * this.scaleX,\r\n                height: this.height * this.scaleY\r\n            }\r\n        };\r\n        this.getPosition = function (a) {\r\n            var position,\r\n                c = this.getBound();\r\n            switch (a) {\r\n                case "Top_Left":\r\n                    position = {x: c.left, y: c.top};\r\n                    break;\r\n                case "Top_Center":\r\n                    position = {x: this.cx, y: c.top};\r\n                    break;\r\n                case "Top_Right":\r\n                    position = {x: c.right, y: c.top};\r\n                    break;\r\n                case "Middle_Left":\r\n                    position = {x: c.left, y: this.cy};\r\n                    break;\r\n                case "Middle_Center":\r\n                    position = {x: this.cx, y: this.cy};\r\n                    break;\r\n                case "Middle_Right":\r\n                    position = {x: c.right, y: this.cy};\r\n                    break;\r\n                case "Bottom_Left":\r\n                    position = {x: c.left, y: c.bottom};\r\n                    break;\r\n                case "Bottom_Center":\r\n                    position = {x: this.cx, y: c.bottom};\r\n                    break;\r\n                case  "Bottom_Right":\r\n                    position = {x: c.right, y: c.bottom};\r\n                    break;\r\n                default:\r\n                    position = {x: c.left, y: c.top};\r\n            }\r\n            return position;\r\n        };\r\n    }\r\n\r\n    function interactiveElement() {\r\n        this.initialize = function () {\r\n            interactiveElement.prototype.initialize.apply(this, arguments);\r\n            this.elementType = "interactiveElement";\r\n            this.draggable = !1;\r\n            this.selected = !1;\r\n            this.showSelected = !0;\r\n            this.selectedLocation = null;\r\n            this.isMouseOver = !1;\r\n            var a = "draggable,selected,showSelected,isMouseOver".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(a);\r\n        };\r\n        this.initialize();\r\n        this.paintSelected = function (a) {\r\n            a.save();\r\n            a.beginPath();\r\n            a.strokeStyle = "rgba(168,202,255, 0.9)";\r\n            a.fillStyle = "rgba(168,202,236,0.7)";\r\n            a.rect(-this.width / 2 - 3, -this.height / 2 - 3, this.width + 6, this.height + 6);\r\n            a.fill();\r\n            a.stroke();\r\n            a.closePath();\r\n            a.restore();\r\n            return this;\r\n        };\r\n        this.paintMouseover = function (a) {\r\n            return this.paintSelected(a);\r\n        };\r\n        this.isInBound = function (pointX, pointY) {\r\n            return pointX > this.x && pointX < this.x + this.width * Math.abs(this.scaleX) && pointY > this.y && pointY < this.y + this.height * Math.abs(this.scaleY)\r\n        };\r\n        this.selectedHandler = function () {\r\n            this.selected = !0;\r\n            this.selectedLocation = {\r\n                x: this.x,\r\n                y: this.y\r\n            };\r\n            return this;\r\n        };\r\n        this.unselectedHandler = function () {\r\n            this.selected = !1;\r\n            this.selectedLocation = null;\r\n            return this;\r\n        };\r\n        this.dbclickHandler = function (a) {\r\n            this.dispatchEvent("dbclick", a);\r\n            return this;\r\n        };\r\n        this.clickHandler = function (a) {\r\n            this.dispatchEvent("click", a);\r\n            return this;\r\n        };\r\n        this.mousedownHander = function (a) {\r\n            this.dispatchEvent("mousedown", a);\r\n            return this;\r\n        };\r\n        this.mouseupHandler = function (a) {\r\n            this.dispatchEvent("mouseup", a);\r\n            return this;\r\n        };\r\n        this.mouseoverHandler = function (a) {\r\n            this.isMouseOver = !0;\r\n            this.dispatchEvent("mouseover", a);\r\n            return this;\r\n        };\r\n        this.mousemoveHandler = function (a) {\r\n            this.dispatchEvent("mousemove", a);\r\n            return this;\r\n        };\r\n        this.mouseoutHandler = function (a) {\r\n            this.isMouseOver = !1;\r\n            this.dispatchEvent("mouseout", a);\r\n            return this;\r\n        };\r\n        this.mousedragHandler = function (a) {\r\n            var b = this.selectedLocation.x + a.dx;\r\n            var c = this.selectedLocation.y + a.dy;\r\n            this.setLocation(b, c);\r\n            this.dispatchEvent("mousedrag", a);\r\n            return this;\r\n        };\r\n        this.addEventListener = function (event, fn) {\r\n            if (!this.messageBus) {\r\n                this.messageBus = new jtopo.util.MessageBus;\r\n            }\r\n            this.messageBus.subscribe(event, fn);\r\n            return this;\r\n        };\r\n        this.dispatchEvent = function (event, e) {\r\n            if (this.messageBus) {\r\n                this.messageBus.publish(event, e);\r\n                return this;\r\n            }\r\n        };\r\n        this.removeEventListener = function (event, fn) {\r\n            this.messageBus.unsubscribe(event, fn);\r\n        };\r\n        this.removeAllEventListener = function () {\r\n            this.messageBus = new jtopo.util.MessageBus\r\n        };\r\n        var self = this;\r\n        "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,touchstart,touchmove,touchend".split(",")\r\n            .forEach(function (eventName) {\r\n                self[eventName] = function (e) {\r\n                    if (null != e) {\r\n                        this.addEventListener(eventName, e);\r\n                    } else {\r\n                        this.dispatchEvent(eventName);\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n    function EditableElement() {\r\n        this.initialize = function () {\r\n            EditableElement.prototype.initialize.apply(this, arguments);\r\n            this.editAble = !1;\r\n            this.selectedPoint = null;\r\n        };\r\n        this.getCtrlPosition = function (a) {\r\n            var b = 5;\r\n            var c = 5;\r\n            var d = this.getPosition(a);\r\n            return {\r\n                left: d.x - b,\r\n                top: d.y - c,\r\n                right: d.x + b,\r\n                bottom: d.y + c\r\n            }\r\n        };\r\n        this.selectedHandler = function (b) {\r\n            EditableElement.prototype.selectedHandler.apply(this, arguments), this.selectedSize = {\r\n                width: this.width,\r\n                height: this.height\r\n            };\r\n            if (b.scene.mode == jtopo.SceneMode.edit) {\r\n                this.editAble = !0\r\n            }\r\n        };\r\n        this.unselectedHandler = function () {\r\n            EditableElement.prototype.unselectedHandler.apply(this, arguments);\r\n            this.selectedSize = null;\r\n            this.editAble = !1;\r\n        };\r\n        var b = ["Top_Left", "Top_Center", "Top_Right", "Middle_Left", "Middle_Right", "Bottom_Left", "Bottom_Center", "Bottom_Right"];\r\n        this.paintCtrl = function (cx) {\r\n            if (0 != this.editAble) {\r\n                cx.save();\r\n                for (var c = 0; c < b.length; c++) {\r\n                    var d = this.getCtrlPosition(b[c]);\r\n                    d.left -= this.cx;\r\n                    d.right -= this.cx;\r\n                    d.top -= this.cy;\r\n                    d.bottom -= this.cy;\r\n                    var e = d.right - d.left;\r\n                    var f = d.bottom - d.top;\r\n                    cx.beginPath();\r\n                    cx.strokeStyle = "rgba(0,0,0,0.8)";\r\n                    cx.rect(d.left, d.top, e, f);\r\n                    cx.stroke();\r\n                    cx.closePath();\r\n                    cx.beginPath();\r\n                    cx.strokeStyle = "rgba(255,255,255,0.3)";\r\n                    cx.rect(d.left + 1, d.top + 1, e - 2, f - 2);\r\n                    cx.stroke();\r\n                    cx.closePath();\r\n                }\r\n                cx.restore();\r\n            }\r\n        };\r\n        this.isInBound = function (a, c) {\r\n            if (this.selectedPoint = null, 1 == this.editAble)for (var e = 0; e < b.length; e++) {\r\n                var f = this.getCtrlPosition(b[e]);\r\n                if (a > f.left && a < f.right && c > f.top && c < f.bottom)return this.selectedPoint = b[e], !0\r\n            }\r\n            return EditableElement.prototype.isInBound.apply(this, arguments)\r\n        };\r\n        this.mousedragHandler = function (a) {\r\n            if (null == this.selectedPoint) {\r\n                var b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                this.setLocation(b, c), this.dispatchEvent("mousedrag", a)\r\n            } else {\r\n                if ("Top_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, e = this.selectedSize.height - a.dy, b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                    b < this.x + this.width && (this.x = b, this.width = d), c < this.y + this.height && (this.y = c, this.height = e)\r\n                } else if ("Top_Center" == this.selectedPoint) {\r\n                    var e = this.selectedSize.height - a.dy, c = this.selectedLocation.y + a.dy;\r\n                    c < this.y + this.height && (this.y = c, this.height = e)\r\n                } else if ("Top_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx, c = this.selectedLocation.y + a.dy;\r\n                    c < this.y + this.height && (this.y = c, this.height = this.selectedSize.height - a.dy), d > 1 && (this.width = d)\r\n                } else if ("Middle_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                    b < this.x + this.width && (this.x = b), d > 1 && (this.width = d)\r\n                } else if ("Middle_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx;\r\n                    d > 1 && (this.width = d)\r\n                } else if ("Bottom_Left" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                    d > 1 && (this.x = b, this.width = d);\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                } else if ("Bottom_Center" == this.selectedPoint) {\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                } else if ("Bottom_Right" == this.selectedPoint) {\r\n                    var d = this.selectedSize.width + a.dx;\r\n                    d > 1 && (this.width = d);\r\n                    var e = this.selectedSize.height + a.dy;\r\n                    e > 1 && (this.height = e)\r\n                }\r\n                this.dispatchEvent("resize", a)\r\n            }\r\n        }\r\n    }\r\n\r\n    DisplayElement.prototype = new jtopo.Element, Object.defineProperties(DisplayElement.prototype, {\r\n        cx: {\r\n            get: function () {\r\n                return this.x + this.width / 2\r\n            }, set: function (a) {\r\n                this.x = a - this.width / 2\r\n            }\r\n        }, cy: {\r\n            get: function () {\r\n                return this.y + this.height / 2\r\n            }, set: function (a) {\r\n                this.y = a - this.height / 2\r\n            }\r\n        }\r\n    });\r\n    interactiveElement.prototype = new DisplayElement;\r\n    EditableElement.prototype = new interactiveElement;\r\n    jtopo.DisplayElement = DisplayElement;\r\n    jtopo.InteractiveElement = interactiveElement;\r\n    jtopo.EditableElement = EditableElement;\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvYmFzZUVsZW1lbnQuanM/Yzc3MCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxjQUFjO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI0MC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBmdW5jdGlvbiBEaXNwbGF5RWxlbWVudCgpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIERpc3BsYXlFbGVtZW50LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImRpc3BsYXlFbGVtZW50XCI7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSAzMjtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSAzMjtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMuYWxwaGEgPSAxO1xyXG4gICAgICAgICAgICB0aGlzLnJvdGF0ZSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuc2NhbGVYID0gMTtcclxuICAgICAgICAgICAgdGhpcy5zY2FsZVkgPSAxO1xyXG4gICAgICAgICAgICB0aGlzLnN0cm9rZUNvbG9yID0gXCIyMiwxMjQsMjU1XCI7XHJcbiAgICAgICAgICAgIHRoaXMuYm9yZGVyQ29sb3IgPSBcIjIyLDEyNCwyNTVcIjtcclxuICAgICAgICAgICAgdGhpcy5maWxsQ29sb3IgPSBcIjIyLDEyNCwyNTVcIjtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3cgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dCbHVyID0gNTtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dDb2xvciA9IFwicmdiYSgwLDAsMCwwLjUpXCI7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhZG93T2Zmc2V0WCA9IDM7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhZG93T2Zmc2V0WSA9IDY7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtQWJsZSA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLnpJbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHZhciBhID0gXCJ4LHksd2lkdGgsaGVpZ2h0LHZpc2libGUsYWxwaGEscm90YXRlLHNjYWxlWCxzY2FsZVksc3Ryb2tlQ29sb3IsZmlsbENvbG9yLHNoYWRvdyxzaGFkb3dDb2xvcixzaGFkb3dPZmZzZXRYLHNoYWRvd09mZnNldFksdHJhbnNmb3JtQWJsZSx6SW5kZXhcIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChhKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgYS5yZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBhLmZpbGwoKTtcclxuICAgICAgICAgICAgYS5zdHJva2UoKTtcclxuICAgICAgICAgICAgYS5jbG9zZVBhdGgoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB4OiB0aGlzLngsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnF0b3BvICYmIHRoaXMucXRvcG8uYXR0ciAmJiB0aGlzLnF0b3BvLmF0dHIucG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucXRvcG8uYXR0ci5wb3NpdGlvblswXSA9IGE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnF0b3BvLmF0dHIucG9zaXRpb25bMV0gPSBiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnggPSBhLCB0aGlzLnkgPSBiLCB0aGlzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldENlbnRlckxvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zZXRDZW50ZXJMb2NhdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IGEgLSB0aGlzLndpZHRoIC8gMjtcclxuICAgICAgICAgICAgdGhpcy55ID0gYiAtIHRoaXMuaGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWl0aFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNldFNpemUgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gYTtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBiO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0Qm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBsZWZ0OiB0aGlzLngsXHJcbiAgICAgICAgICAgICAgICB0b3A6IHRoaXMueSxcclxuICAgICAgICAgICAgICAgIHJpZ2h0OiB0aGlzLnggKyB0aGlzLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgYm90dG9tOiB0aGlzLnkgKyB0aGlzLmhlaWdodCxcclxuICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNldEJvdW5kID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRMb2NhdGlvbihhLCBiKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTaXplKGMsIGQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RGlzcGxheUJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbGVmdDogdGhpcy54LFxyXG4gICAgICAgICAgICAgICAgdG9wOiB0aGlzLnksXHJcbiAgICAgICAgICAgICAgICByaWdodDogdGhpcy54ICsgdGhpcy53aWR0aCAqIHRoaXMuc2NhbGVYLFxyXG4gICAgICAgICAgICAgICAgYm90dG9tOiB0aGlzLnkgKyB0aGlzLmhlaWdodCAqIHRoaXMuc2NhbGVZXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RGlzcGxheVNpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCAqIHRoaXMuc2NhbGVYLFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCAqIHRoaXMuc2NhbGVZXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgcG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBjID0gdGhpcy5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGEpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJUb3BfTGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMubGVmdCwgeTogYy50b3B9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIlRvcF9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiB0aGlzLmN4LCB5OiBjLnRvcH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiVG9wX1JpZ2h0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogYy5yaWdodCwgeTogYy50b3B9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIk1pZGRsZV9MZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogYy5sZWZ0LCB5OiB0aGlzLmN5fTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJNaWRkbGVfQ2VudGVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogdGhpcy5jeCwgeTogdGhpcy5jeX07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiTWlkZGxlX1JpZ2h0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogYy5yaWdodCwgeTogdGhpcy5jeX07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiQm90dG9tX0xlZnRcIjpcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiBjLmxlZnQsIHk6IGMuYm90dG9tfTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJCb3R0b21fQ2VudGVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogdGhpcy5jeCwgeTogYy5ib3R0b219O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAgXCJCb3R0b21fUmlnaHRcIjpcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiBjLnJpZ2h0LCB5OiBjLmJvdHRvbX07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMubGVmdCwgeTogYy50b3B9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbjtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGludGVyYWN0aXZlRWxlbWVudCgpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGludGVyYWN0aXZlRWxlbWVudC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRUeXBlID0gXCJpbnRlcmFjdGl2ZUVsZW1lbnRcIjtcclxuICAgICAgICAgICAgdGhpcy5kcmFnZ2FibGUgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLnNob3dTZWxlY3RlZCA9ICEwO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTG9jYXRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmlzTW91c2VPdmVyID0gITE7XHJcbiAgICAgICAgICAgIHZhciBhID0gXCJkcmFnZ2FibGUsc2VsZWN0ZWQsc2hvd1NlbGVjdGVkLGlzTW91c2VPdmVyXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoYSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICAgICAgICB0aGlzLnBhaW50U2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLnNhdmUoKTtcclxuICAgICAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgYS5zdHJva2VTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDI1NSwgMC45KVwiO1xyXG4gICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDIzNiwwLjcpXCI7XHJcbiAgICAgICAgICAgIGEucmVjdCgtdGhpcy53aWR0aCAvIDIgLSAzLCAtdGhpcy5oZWlnaHQgLyAyIC0gMywgdGhpcy53aWR0aCArIDYsIHRoaXMuaGVpZ2h0ICsgNik7XHJcbiAgICAgICAgICAgIGEuZmlsbCgpO1xyXG4gICAgICAgICAgICBhLnN0cm9rZSgpO1xyXG4gICAgICAgICAgICBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICBhLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50TW91c2VvdmVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFpbnRTZWxlY3RlZChhKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuaXNJbkJvdW5kID0gZnVuY3Rpb24gKHBvaW50WCwgcG9pbnRZKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwb2ludFggPiB0aGlzLnggJiYgcG9pbnRYIDwgdGhpcy54ICsgdGhpcy53aWR0aCAqIE1hdGguYWJzKHRoaXMuc2NhbGVYKSAmJiBwb2ludFkgPiB0aGlzLnkgJiYgcG9pbnRZIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgKiBNYXRoLmFicyh0aGlzLnNjYWxlWSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMueCxcclxuICAgICAgICAgICAgICAgIHk6IHRoaXMueVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMudW5zZWxlY3RlZEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZExvY2F0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmRiY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwiZGJjbGlja1wiLCBhKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImNsaWNrXCIsIGEpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2Vkb3duSGFuZGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2Vkb3duXCIsIGEpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2V1cEhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZXVwXCIsIGEpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2VvdmVySGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNb3VzZU92ZXIgPSAhMDtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdmVyXCIsIGEpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2Vtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlbW92ZVwiLCBhKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1vdXNlb3V0SGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNb3VzZU92ZXIgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5tb3VzZWRyYWdIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueCArIGEuZHg7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICB0aGlzLnNldExvY2F0aW9uKGIsIGMpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRyYWdcIiwgYSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMubWVzc2FnZUJ1cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGV2ZW50LCBmbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1lc3NhZ2VCdXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy5wdWJsaXNoKGV2ZW50LCBlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy51bnN1YnNjcmliZShldmVudCwgZm4pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcganRvcG8udXRpbC5NZXNzYWdlQnVzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgXCJjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kXCIuc3BsaXQoXCIsXCIpXHJcbiAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChldmVudE5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGZbZXZlbnROYW1lXSA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBlKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnROYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIEVkaXRhYmxlRWxlbWVudCgpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIEVkaXRhYmxlRWxlbWVudC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLmVkaXRBYmxlID0gITE7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQb2ludCA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldEN0cmxQb3NpdGlvbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gNTtcclxuICAgICAgICAgICAgdmFyIGMgPSA1O1xyXG4gICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0UG9zaXRpb24oYSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBsZWZ0OiBkLnggLSBiLFxyXG4gICAgICAgICAgICAgICAgdG9wOiBkLnkgLSBjLFxyXG4gICAgICAgICAgICAgICAgcmlnaHQ6IGQueCArIGIsXHJcbiAgICAgICAgICAgICAgICBib3R0b206IGQueSArIGNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEhhbmRsZXIgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICBFZGl0YWJsZUVsZW1lbnQucHJvdG90eXBlLnNlbGVjdGVkSGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLnNlbGVjdGVkU2l6ZSA9IHtcclxuICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoYi5zY2VuZS5tb2RlID09IGp0b3BvLlNjZW5lTW9kZS5lZGl0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRBYmxlID0gITBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy51bnNlbGVjdGVkSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgRWRpdGFibGVFbGVtZW50LnByb3RvdHlwZS51bnNlbGVjdGVkSGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkU2l6ZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdEFibGUgPSAhMTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBiID0gW1wiVG9wX0xlZnRcIiwgXCJUb3BfQ2VudGVyXCIsIFwiVG9wX1JpZ2h0XCIsIFwiTWlkZGxlX0xlZnRcIiwgXCJNaWRkbGVfUmlnaHRcIiwgXCJCb3R0b21fTGVmdFwiLCBcIkJvdHRvbV9DZW50ZXJcIiwgXCJCb3R0b21fUmlnaHRcIl07XHJcbiAgICAgICAgdGhpcy5wYWludEN0cmwgPSBmdW5jdGlvbiAoY3gpIHtcclxuICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy5lZGl0QWJsZSkge1xyXG4gICAgICAgICAgICAgICAgY3guc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBiLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmdldEN0cmxQb3NpdGlvbihiW2NdKTtcclxuICAgICAgICAgICAgICAgICAgICBkLmxlZnQgLT0gdGhpcy5jeDtcclxuICAgICAgICAgICAgICAgICAgICBkLnJpZ2h0IC09IHRoaXMuY3g7XHJcbiAgICAgICAgICAgICAgICAgICAgZC50b3AgLT0gdGhpcy5jeTtcclxuICAgICAgICAgICAgICAgICAgICBkLmJvdHRvbSAtPSB0aGlzLmN5O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gZC5yaWdodCAtIGQubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGQuYm90dG9tIC0gZC50b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgY3guYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3guc3Ryb2tlU3R5bGUgPSBcInJnYmEoMCwwLDAsMC44KVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGN4LnJlY3QoZC5sZWZ0LCBkLnRvcCwgZSwgZik7XHJcbiAgICAgICAgICAgICAgICAgICAgY3guc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3guY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3guYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3guc3Ryb2tlU3R5bGUgPSBcInJnYmEoMjU1LDI1NSwyNTUsMC4zKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGN4LnJlY3QoZC5sZWZ0ICsgMSwgZC50b3AgKyAxLCBlIC0gMiwgZiAtIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN4LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3gucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmlzSW5Cb3VuZCA9IGZ1bmN0aW9uIChhLCBjKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUG9pbnQgPSBudWxsLCAxID09IHRoaXMuZWRpdEFibGUpZm9yICh2YXIgZSA9IDA7IGUgPCBiLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IHRoaXMuZ2V0Q3RybFBvc2l0aW9uKGJbZV0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEgPiBmLmxlZnQgJiYgYSA8IGYucmlnaHQgJiYgYyA+IGYudG9wICYmIGMgPCBmLmJvdHRvbSlyZXR1cm4gdGhpcy5zZWxlY3RlZFBvaW50ID0gYltlXSwgITBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gRWRpdGFibGVFbGVtZW50LnByb3RvdHlwZS5pc0luQm91bmQuYXBwbHkodGhpcywgYXJndW1lbnRzKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5tb3VzZWRyYWdIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keCwgYyA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi55ICsgYS5keTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0TG9jYXRpb24oYiwgYyksIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZHJhZ1wiLCBhKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKFwiVG9wX0xlZnRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoIC0gYS5keCwgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCAtIGEuZHksIGIgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueCArIGEuZHgsIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgYiA8IHRoaXMueCArIHRoaXMud2lkdGggJiYgKHRoaXMueCA9IGIsIHRoaXMud2lkdGggPSBkKSwgYyA8IHRoaXMueSArIHRoaXMuaGVpZ2h0ICYmICh0aGlzLnkgPSBjLCB0aGlzLmhlaWdodCA9IGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiVG9wX0NlbnRlclwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0IC0gYS5keSwgYyA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi55ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICBjIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgJiYgKHRoaXMueSA9IGMsIHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJUb3BfUmlnaHRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoICsgYS5keCwgYyA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi55ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICBjIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgJiYgKHRoaXMueSA9IGMsIHRoaXMuaGVpZ2h0ID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0IC0gYS5keSksIGQgPiAxICYmICh0aGlzLndpZHRoID0gZClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJNaWRkbGVfTGVmdFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZFNpemUud2lkdGggLSBhLmR4LCBiID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnggKyBhLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgIGIgPCB0aGlzLnggKyB0aGlzLndpZHRoICYmICh0aGlzLnggPSBiKSwgZCA+IDEgJiYgKHRoaXMud2lkdGggPSBkKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIk1pZGRsZV9SaWdodFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZFNpemUud2lkdGggKyBhLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPiAxICYmICh0aGlzLndpZHRoID0gZClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJCb3R0b21fTGVmdFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZFNpemUud2lkdGggLSBhLmR4LCBiID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnggKyBhLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPiAxICYmICh0aGlzLnggPSBiLCB0aGlzLndpZHRoID0gZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPiAxICYmICh0aGlzLmhlaWdodCA9IGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiQm90dG9tX0NlbnRlclwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICBlID4gMSAmJiAodGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIkJvdHRvbV9SaWdodFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZFNpemUud2lkdGggKyBhLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPiAxICYmICh0aGlzLndpZHRoID0gZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPiAxICYmICh0aGlzLmhlaWdodCA9IGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJyZXNpemVcIiwgYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUgPSBuZXcganRvcG8uRWxlbWVudCwgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoRGlzcGxheUVsZW1lbnQucHJvdG90eXBlLCB7XHJcbiAgICAgICAgY3g6IHtcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy54ICsgdGhpcy53aWR0aCAvIDJcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy54ID0gYSAtIHRoaXMud2lkdGggLyAyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBjeToge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDJcclxuICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy55ID0gYSAtIHRoaXMuaGVpZ2h0IC8gMlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBpbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlID0gbmV3IERpc3BsYXlFbGVtZW50O1xyXG4gICAgRWRpdGFibGVFbGVtZW50LnByb3RvdHlwZSA9IG5ldyBpbnRlcmFjdGl2ZUVsZW1lbnQ7XHJcbiAgICBqdG9wby5EaXNwbGF5RWxlbWVudCA9IERpc3BsYXlFbGVtZW50O1xyXG4gICAganRvcG8uSW50ZXJhY3RpdmVFbGVtZW50ID0gaW50ZXJhY3RpdmVFbGVtZW50O1xyXG4gICAganRvcG8uRWRpdGFibGVFbGVtZW50ID0gRWRpdGFibGVFbGVtZW50O1xyXG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvYmFzZUVsZW1lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDQwXG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports){eval('module.exports = function (jtopo) {\r\n    function Container(c) {\r\n        this.initialize = function (c) {\r\n            Container.prototype.initialize.apply(this, null);\r\n                this.elementType = "container";\r\n            this.zIndex = jtopo.zIndex_Container;\r\n            this.width = 100;\r\n            this.height = 100;\r\n            this.childs = [];\r\n            this.alpha = .5;\r\n            this.draggable = !0;\r\n            this.childDraggable = !0;\r\n            this.visible = !0;\r\n            this.fillColor = "10,100,80";\r\n            this.borderWidth = 0;\r\n            this.borderColor = "255,255,255";\r\n            this.borderRadius = null;\r\n            this.font = "12px Consolas";\r\n            this.fontColor = "255,255,255";\r\n            this.text = c;\r\n            this.textPosition = "Bottom_Center";\r\n            this.textOffsetX = 0;\r\n            this.textOffsetY = 0;\r\n            this.layout = new jtopo.layout.AutoBoundLayout;\r\n        };\r\n        this.initialize(c);\r\n        this.add = function (element) {\r\n            this.childs.push(element);\r\n            element.draggable = this.childDraggable;\r\n        };\r\n        this.remove = function (a) {\r\n            for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a) {\r\n                a.parentContainer = null;\r\n                this.childs = this.childs.del(b);\r\n                a.lastParentContainer = this;\r\n                break;\r\n            }\r\n        };\r\n        this.removeAll = function () {\r\n            this.childs = []\r\n        };\r\n        this.setLocation = function (setX, setY) {\r\n            var oX = setX - this.x;\r\n            var oY = setY - this.y;\r\n            this.x = setX;\r\n            this.y = setY;\r\n            if (this.qtopo && this.qtopo.attr && this.qtopo.attr.position) {\r\n                this.qtopo.attr.position[0] = setX;\r\n                this.qtopo.attr.position[1] = setY;\r\n            }\r\n            for (var e = 0; e < this.childs.length; e++) {\r\n                var child = this.childs[e];\r\n                child.setLocation(child.x + oX, child.y + oY)\r\n            }\r\n        };\r\n        this.doLayout = function (a) {\r\n            a && a(this, this.childs)\r\n        };\r\n        this.paint = function (a) {\r\n            if (this.visible) {\r\n                if (this.layout) {\r\n                    this.layout(this, this.childs);\r\n                }\r\n                a.beginPath();\r\n                a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                    a.rect(this.x, this.y, this.width, this.height);\r\n                } else {\r\n                    a.JTopoRoundRect(this.x, this.y, this.width, this.height, this.borderRadius);\r\n                }\r\n                a.fill();\r\n                a.closePath();\r\n                this.paintText(a);\r\n                this.paintBorder(a);\r\n            }\r\n        };\r\n        this.paintBorder = function (a) {\r\n            if (0 != this.borderWidth) {\r\n                a.beginPath(), a.lineWidth = this.borderWidth, a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                var b = this.borderWidth / 2;\r\n                null == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth) : a.JTopoRoundRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius), a.stroke(), a.closePath()\r\n            }\r\n        };\r\n        this.paintText = function (a) {\r\n            var text = this.text;\r\n            if (null != text && "" != text) {\r\n                a.beginPath();\r\n                a.font = this.font;\r\n                var fontWidth = a.measureText("田").width;\r\n                var maxWidth = fontWidth;\r\n                a.fillStyle = "rgba(" + this.fontColor + ",1)"; //", " + this.alpha + ")";名称永远不透明\r\n                //换行检测\r\n                var textlines = text.split("\\n");\r\n                for (var i = 0; i < textlines.length; i++) {\r\n                    var width = a.measureText(textlines[i]).width;\r\n                    if (width > maxWidth) {\r\n                        maxWidth = width;\r\n                    }\r\n                }\r\n                var e = this.getTextPostion(this.textPosition, maxWidth, fontWidth, textlines.length);\r\n                for (var j = 0; j < textlines.length; j++) {\r\n                    var textWidth = a.measureText(textlines[j]).width;\r\n                    a.fillText(textlines[j], e.x + (maxWidth - textWidth) / 2, e.y + j * fontWidth);\r\n                }\r\n\r\n                a.closePath();\r\n            }\r\n        };\r\n        this.getTextPostion = function (textPosition, maxWidth, fontWidth, textLines) {\r\n            var position = null;\r\n            switch (textPosition) {\r\n                case\'Top_Center\':\r\n                    position = {\r\n                        x: this.x + this.width / 2 - maxWidth / 2,\r\n                        y: this.y - fontWidth / 2 - fontWidth * (textLines - 1)\r\n                    };\r\n                    break;\r\n                case\'Top_Right\':\r\n                    position = {x: this.x + this.width - maxWidth, y: this.y - fontWidth / 2};\r\n                    break;\r\n                case\'Top_Left\':\r\n                    position = {\r\n                        x: this.x,\r\n                        y: this.y - fontWidth / 2\r\n                    };\r\n                    break;\r\n                case\'Bottom_Right\':\r\n                    position = {\r\n                        x: this.x + this.width - maxWidth,\r\n                        y: this.y + this.height + fontWidth\r\n                    };\r\n                    break;\r\n                case\'Bottom_Left\':\r\n                    position = {x: this.x, y: this.y + this.height + fontWidth};\r\n                    break;\r\n                case\'Middle_Center\':\r\n                    position = {\r\n                        x: this.x + this.width / 2 - maxWidth / 2,\r\n                        y: this.y + this.height / 2 + fontWidth / 2\r\n                    };\r\n                    break;\r\n                case\'Middle_Right\':\r\n                    position = {\r\n                        x: this.x + this.width,\r\n                        y: this.y + this.height / 2 + fontWidth / 2\r\n                    };\r\n                    break;\r\n                case\'Middle_Left\':\r\n                    position = {\r\n                        x: this.x-maxWidth,\r\n                        y: this.y + this.height / 2 + fontWidth / 2\r\n                    };\r\n                    break;\r\n                default://\'Bottom_Center\'\r\n                    position = {\r\n                        x: this.x + this.width / 2 - maxWidth / 2,\r\n                        y: this.y + this.height + fontWidth\r\n                    };\r\n            }\r\n            if (null != this.textOffsetX) {\r\n                position.x += this.textOffsetX;\r\n            }\r\n            if (null != this.textOffsetY) {\r\n                position.y += this.textOffsetY;\r\n            }\r\n            return position\r\n        };\r\n        this.paintMouseover = function () {\r\n        };\r\n        this.paintSelected = function (a) {\r\n            a.shadowBlur = 10, a.shadowColor = "rgba(0,0,0,1)", a.shadowOffsetX = 0, a.shadowOffsetY = 0\r\n        }\r\n    }\r\n\r\n    Container.prototype = new jtopo.InteractiveElement;\r\n    jtopo.Container = Container;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvY29udGFpbmVyLmpzP2VmNDQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsd0JBQXdCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix3QkFBd0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsMkJBQTJCO0FBQzFGO0FBQ0E7QUFDQSwrQkFBK0Isc0JBQXNCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixzQkFBc0I7QUFDckQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSIsImZpbGUiOiI0MS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBmdW5jdGlvbiBDb250YWluZXIoYykge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIENvbnRhaW5lci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImNvbnRhaW5lclwiO1xyXG4gICAgICAgICAgICB0aGlzLnpJbmRleCA9IGp0b3BvLnpJbmRleF9Db250YWluZXI7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSAxMDA7XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gMTAwO1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmFscGhhID0gLjU7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhZ2dhYmxlID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGREcmFnZ2FibGUgPSAhMDtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsbENvbG9yID0gXCIxMCwxMDAsODBcIjtcclxuICAgICAgICAgICAgdGhpcy5ib3JkZXJXaWR0aCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuYm9yZGVyQ29sb3IgPSBcIjI1NSwyNTUsMjU1XCI7XHJcbiAgICAgICAgICAgIHRoaXMuYm9yZGVyUmFkaXVzID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5mb250ID0gXCIxMnB4IENvbnNvbGFzXCI7XHJcbiAgICAgICAgICAgIHRoaXMuZm9udENvbG9yID0gXCIyNTUsMjU1LDI1NVwiO1xyXG4gICAgICAgICAgICB0aGlzLnRleHQgPSBjO1xyXG4gICAgICAgICAgICB0aGlzLnRleHRQb3NpdGlvbiA9IFwiQm90dG9tX0NlbnRlclwiO1xyXG4gICAgICAgICAgICB0aGlzLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAgdGhpcy50ZXh0T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubGF5b3V0ID0gbmV3IGp0b3BvLmxheW91dC5BdXRvQm91bmRMYXlvdXQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoYyk7XHJcbiAgICAgICAgdGhpcy5hZGQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5wdXNoKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmRyYWdnYWJsZSA9IHRoaXMuY2hpbGREcmFnZ2FibGU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBiKyspaWYgKHRoaXMuY2hpbGRzW2JdID09PSBhKSB7XHJcbiAgICAgICAgICAgICAgICBhLnBhcmVudENvbnRhaW5lciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcyA9IHRoaXMuY2hpbGRzLmRlbChiKTtcclxuICAgICAgICAgICAgICAgIGEubGFzdFBhcmVudENvbnRhaW5lciA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gW11cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoc2V0WCwgc2V0WSkge1xyXG4gICAgICAgICAgICB2YXIgb1ggPSBzZXRYIC0gdGhpcy54O1xyXG4gICAgICAgICAgICB2YXIgb1kgPSBzZXRZIC0gdGhpcy55O1xyXG4gICAgICAgICAgICB0aGlzLnggPSBzZXRYO1xyXG4gICAgICAgICAgICB0aGlzLnkgPSBzZXRZO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5xdG9wbyAmJiB0aGlzLnF0b3BvLmF0dHIgJiYgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnF0b3BvLmF0dHIucG9zaXRpb25bMF0gPSBzZXRYO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uWzFdID0gc2V0WTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmNoaWxkc1tlXTtcclxuICAgICAgICAgICAgICAgIGNoaWxkLnNldExvY2F0aW9uKGNoaWxkLnggKyBvWCwgY2hpbGQueSArIG9ZKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmRvTGF5b3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYSAmJiBhKHRoaXMsIHRoaXMuY2hpbGRzKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxheW91dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGF5b3V0KHRoaXMsIHRoaXMuY2hpbGRzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5yZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGEuSlRvcG9Sb3VuZFJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmJvcmRlclJhZGl1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhLmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIGEuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50VGV4dChhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRCb3JkZXIoYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFpbnRCb3JkZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBpZiAoMCAhPSB0aGlzLmJvcmRlcldpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmxpbmVXaWR0aCA9IHRoaXMuYm9yZGVyV2lkdGgsIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmJvcmRlckNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuYm9yZGVyV2lkdGggLyAyO1xyXG4gICAgICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzID8gYS5yZWN0KHRoaXMueCAtIGIsIHRoaXMueSAtIGIsIHRoaXMud2lkdGggKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmhlaWdodCArIHRoaXMuYm9yZGVyV2lkdGgpIDogYS5KVG9wb1JvdW5kUmVjdCh0aGlzLnggLSBiLCB0aGlzLnkgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmJvcmRlclJhZGl1cyksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYWludFRleHQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgdGV4dCA9IHRoaXMudGV4dDtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGV4dCAmJiBcIlwiICE9IHRleHQpIHtcclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgZm9udFdpZHRoID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciBtYXhXaWR0aCA9IGZvbnRXaWR0aDtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwxKVwiOyAvL1wiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjvlkI3np7DmsLjov5zkuI3pgI/mmI5cclxuICAgICAgICAgICAgICAgIC8v5o2i6KGM5qOA5rWLXHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dGxpbmVzID0gdGV4dC5zcGxpdChcIlxcblwiKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dGxpbmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gYS5tZWFzdXJlVGV4dCh0ZXh0bGluZXNbaV0pLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmdldFRleHRQb3N0aW9uKHRoaXMudGV4dFBvc2l0aW9uLCBtYXhXaWR0aCwgZm9udFdpZHRoLCB0ZXh0bGluZXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGV4dGxpbmVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHRXaWR0aCA9IGEubWVhc3VyZVRleHQodGV4dGxpbmVzW2pdKS53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBhLmZpbGxUZXh0KHRleHRsaW5lc1tqXSwgZS54ICsgKG1heFdpZHRoIC0gdGV4dFdpZHRoKSAvIDIsIGUueSArIGogKiBmb250V2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGEuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0VGV4dFBvc3Rpb24gPSBmdW5jdGlvbiAodGV4dFBvc2l0aW9uLCBtYXhXaWR0aCwgZm9udFdpZHRoLCB0ZXh0TGluZXMpIHtcclxuICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgc3dpdGNoICh0ZXh0UG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UnVG9wX0NlbnRlcic6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyIC0gbWF4V2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgLSBmb250V2lkdGggLyAyIC0gZm9udFdpZHRoICogKHRleHRMaW5lcyAtIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UnVG9wX1JpZ2h0JzpcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiB0aGlzLnggKyB0aGlzLndpZHRoIC0gbWF4V2lkdGgsIHk6IHRoaXMueSAtIGZvbnRXaWR0aCAvIDJ9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSdUb3BfTGVmdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55IC0gZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlJ0JvdHRvbV9SaWdodCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLSBtYXhXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgKyBmb250V2lkdGhcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSdCb3R0b21fTGVmdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogdGhpcy54LCB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCArIGZvbnRXaWR0aH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlJ01pZGRsZV9DZW50ZXInOlxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyB0aGlzLndpZHRoIC8gMiAtIG1heFdpZHRoIC8gMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlJ01pZGRsZV9SaWdodCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMiArIGZvbnRXaWR0aCAvIDJcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSdNaWRkbGVfTGVmdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueC1tYXhXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0Oi8vJ0JvdHRvbV9DZW50ZXInXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyIC0gbWF4V2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCArIGZvbnRXaWR0aFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WCkge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24ueCArPSB0aGlzLnRleHRPZmZzZXRYO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMudGV4dE9mZnNldFkpIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uLnkgKz0gdGhpcy50ZXh0T2Zmc2V0WTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcG9zaXRpb25cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFpbnRNb3VzZW92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50U2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLnNoYWRvd0JsdXIgPSAxMCwgYS5zaGFkb3dDb2xvciA9IFwicmdiYSgwLDAsMCwxKVwiLCBhLnNoYWRvd09mZnNldFggPSAwLCBhLnNoYWRvd09mZnNldFkgPSAwXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIENvbnRhaW5lci5wcm90b3R5cGUgPSBuZXcganRvcG8uSW50ZXJhY3RpdmVFbGVtZW50O1xyXG4gICAganRvcG8uQ29udGFpbmVyID0gQ29udGFpbmVyO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2VsZW1lbnRzL2NvbnRhaW5lci5qc1xuLy8gbW9kdWxlIGlkID0gNDFcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==')},function(module,exports){eval('module.exports = function (jtopo) {\r\n    Link.prototype = new jtopo.InteractiveElement;\r\n    FoldLink.prototype = new Link;\r\n    FlexionalLink.prototype = new Link;\r\n    CurveLink.prototype = new Link;\r\n    jtopo.Link = Link;\r\n    jtopo.FoldLink = FoldLink;\r\n    jtopo.FlexionalLink = FlexionalLink;\r\n    jtopo.CurveLink = CurveLink;\r\n\r\n    function getPublicLink(elementA, elementB) {\r\n        var result = [];\r\n        if (null == elementA || null == elementB)return result;\r\n        if (elementA && elementB && elementA.outLinks && elementB.inLinks)\r\n            for (var i = 0; i < elementA.outLinks.length; i++) {\r\n                var outLink = elementA.outLinks[i];\r\n                for (var f = 0; f < elementB.inLinks.length; f++) {\r\n                    var inlink = elementB.inLinks[f];\r\n                    if (outLink === inlink) {\r\n                        result.push(inlink);\r\n                    }\r\n                }\r\n            }\r\n        return result\r\n    }\r\n\r\n    function getLinksBetween(start, end) {\r\n        var d = getPublicLink(start, end);\r\n        var e = getPublicLink(end, start);\r\n        return d.concat(e);\r\n    }\r\n\r\n    function getLinkNotThis(link) {\r\n        var b = getLinksBetween(link.nodeA, link.nodeZ);\r\n        return b = b.filter(function (b) {\r\n            return link !== b\r\n        })\r\n    }\r\n\r\n    function getNums(a, b) {\r\n        return getLinksBetween(a, b).length\r\n    }\r\n\r\n    /*计算二次线的右侧固定坐标,待定*/\r\n    function getfixedRight(start, end) {\r\n        //重写线的绘制路径\r\n        var littleSize = 50;\r\n        var startRight = {\r\n            x: start.x + start.width,\r\n            y: start.y + start.height / 2\r\n        };\r\n        var endRight = {\r\n            x: end.x + end.width,\r\n            y: end.y + end.height / 2\r\n        };\r\n        var middleA = {};\r\n        var middleB = {};\r\n        if (startRight.x > endRight.x) {\r\n            middleA.x = startRight.x + littleSize;\r\n            middleA.y = startRight.y;\r\n            middleB.x = startRight.x + littleSize;\r\n            middleB.y = endRight.y;\r\n        } else {\r\n            middleA.x = endRight.x + littleSize;\r\n            middleA.y = startRight.y;\r\n            middleB.x = endRight.x + littleSize;\r\n            middleB.y = endRight.y;\r\n        }\r\n        return [startRight, middleA, middleB, endRight];\r\n    }\r\n\r\n    function getBorderPoint(start, end) {\r\n        var lineFn = jtopo.util.lineF(start.cx, start.cy, end.cx, end.cy);\r\n        var bound = start.getBound();\r\n        return jtopo.util.intersectionLineBound(lineFn, bound);\r\n    }\r\n\r\n    function linkArrow(context, startPoint, endPoint, radius, offset, type) {\r\n        var atanAngle = Math.atan2(endPoint.y - startPoint.y, endPoint.x - startPoint.x);\r\n        var length = jtopo.util.getDistance(startPoint, endPoint) - radius;\r\n        var COS = startPoint.x + (length + offset) * Math.cos(atanAngle);\r\n        var SIN = startPoint.y + (length + offset) * Math.sin(atanAngle);\r\n        var m = endPoint.x + offset * Math.cos(atanAngle);\r\n        var n = endPoint.y + offset * Math.sin(atanAngle);\r\n        atanAngle -= Math.PI / 2;\r\n        var o = {\r\n            x: COS + (radius / 2) * Math.cos(atanAngle),\r\n            y: SIN + (radius / 2) * Math.sin(atanAngle)\r\n        };\r\n        var p = {\r\n            x: COS + (radius / 2) * Math.cos(atanAngle - Math.PI),\r\n            y: SIN + (radius / 2) * Math.sin(atanAngle - Math.PI)\r\n        };\r\n        context.moveTo(o.x, o.y);\r\n        context.lineTo(m, n);\r\n        context.lineTo(p.x, p.y);\r\n        if (type) {\r\n            context.fill();\r\n        } else {\r\n            context.stroke();\r\n        }\r\n    }\r\n\r\n    function Link(start, end, text) {\r\n        this.initialize = function (start, end, text) {\r\n            Link.prototype.initialize.apply(this, arguments);\r\n            this.elementType = "link";\r\n            this.zIndex = jtopo.zIndex_Link;\r\n            if (0 != arguments.length) {\r\n                this.text = text;\r\n                this.nodeA = start;\r\n                this.nodeZ = end;\r\n                this.nodeA && null == this.nodeA.outLinks && (this.nodeA.outLinks = []);\r\n                this.nodeA && null == this.nodeA.inLinks && (this.nodeA.inLinks = []);\r\n                this.nodeZ && null == this.nodeZ.inLinks && (this.nodeZ.inLinks = []);\r\n                this.nodeZ && null == this.nodeZ.outLinks && (this.nodeZ.outLinks = []);\r\n                null != this.nodeA && this.nodeA.outLinks.push(this);\r\n                null != this.nodeZ && this.nodeZ.inLinks.push(this);\r\n                this.caculateIndex();\r\n                this.font = "12px Consolas";\r\n                this.fontColor = "255,255,255";\r\n                this.lineWidth = 2;\r\n                this.lineJoin = "miter";\r\n                this.transformAble = !1;\r\n                this.offset = 20;\r\n                this.gap = 12;\r\n                this.textOffsetX = 0;\r\n                this.textOffsetY = 0;\r\n                this.arrowsRadius = null;\r\n                this.arrowsOffset = 0;\r\n                this.arrowsType = "close";\r\n                this.dashedPattern = null;\r\n                this.path = [];\r\n                var e = "text,font,fontColor,lineWidth,lineJoin".split(",");\r\n                this.serializedProperties = this.serializedProperties.concat(e)\r\n            }\r\n        };\r\n        this.caculateIndex = function () {\r\n            var a = getNums(this.nodeA, this.nodeZ);\r\n            if (a > 0) {\r\n                this.nodeIndex = a - 1;\r\n            }\r\n        };\r\n        this.initialize(start, end, text);\r\n        this.removeHandler = function () {\r\n            var a = this;\r\n            this.nodeA && this.nodeA.outLinks && (this.nodeA.outLinks = this.nodeA.outLinks.filter(function (b) {\r\n                return b !== a\r\n            }));\r\n            this.nodeZ && this.nodeZ.inLinks && (this.nodeZ.inLinks = this.nodeZ.inLinks.filter(function (b) {\r\n                return b !== a\r\n            }));\r\n            var b = getLinkNotThis(this);\r\n            b.forEach(function (a, b) {\r\n                a.nodeIndex = b\r\n            })\r\n        };\r\n        this.getStartPosition = function () {\r\n            return getBorderPoint(this.nodeA, this.nodeZ);\r\n        };\r\n        this.getEndPosition = function () {\r\n            return getBorderPoint(this.nodeZ, this.nodeA);\r\n        };\r\n        this.getPath = function () {\r\n            var path=[];\r\n            var self = this;\r\n            var start = this.getStartPosition();\r\n            var end = this.getEndPosition();\r\n            if(start&&end){\r\n                var NUMS = getNums(this.nodeA, this.nodeZ);\r\n                if ((this.nodeA === this.nodeZ)||1 == NUMS){\r\n                    path.push(start);\r\n                    path.push(end);\r\n                }else{\r\n                    getPathWidthGap(path);\r\n                }\r\n            }\r\n            return path;\r\n\r\n            function getPathWidthGap(path) {\r\n                var tanAngle = Math.atan2(end.y - start.y, end.x - start.x);\r\n                var offsetStart = {\r\n                    x: start.x + self.offset * Math.cos(tanAngle),\r\n                    y: start.y + self.offset * Math.sin(tanAngle)\r\n                };\r\n                var offsetEnd = {\r\n                    x: end.x + self.offset * Math.cos(tanAngle - Math.PI),\r\n                    y: end.y + self.offset * Math.sin(tanAngle - Math.PI)\r\n                };\r\n                var i = tanAngle - Math.PI / 2;\r\n                var j = tanAngle - Math.PI / 2;\r\n                var gap = NUMS * self.gap / 2 - self.gap / 2;\r\n                var beginGap = self.gap * self.nodeIndex;\r\n                var firstMiddle = {\r\n                    x: offsetStart.x + beginGap * Math.cos(i),\r\n                    y: offsetStart.y + beginGap * Math.sin(i)\r\n                };\r\n                var secondMiddle = {\r\n                    x: offsetEnd.x + beginGap * Math.cos(j),\r\n                    y: offsetEnd.y + beginGap * Math.sin(j)\r\n                };\r\n                firstMiddle = {\r\n                    x: firstMiddle.x + gap * Math.cos(i - Math.PI),\r\n                    y: firstMiddle.y + gap * Math.sin(i - Math.PI)\r\n                };\r\n                secondMiddle = {\r\n                    x: secondMiddle.x + gap * Math.cos(j - Math.PI),\r\n                    y: secondMiddle.y + gap * Math.sin(j - Math.PI)\r\n                };\r\n                path.push({\r\n                    x: start.x,\r\n                    y: start.y\r\n                });\r\n                path.push({\r\n                    x: firstMiddle.x,\r\n                    y: firstMiddle.y\r\n                });\r\n                path.push({\r\n                    x: secondMiddle.x,\r\n                    y: secondMiddle.y\r\n                });\r\n                path.push({\r\n                    x: end.x,\r\n                    y: end.y\r\n                });\r\n            }\r\n        };\r\n        this.paintPath = function (context, path) {\r\n            var attr = this.qtopo.attr;\r\n            if (this.nodeA === this.nodeZ) {\r\n                return void this.paintLoop(context);\r\n            }\r\n            context.beginPath();\r\n            context.moveTo(path[0].x, path[0].y);\r\n            for (var i = 1; i < path.length; i++) {\r\n                if (null == this.dashedPattern) {\r\n                    if (attr.radius > 0) {\r\n                        if (i < path.length - 1) {\r\n                            context.arcTo(path[i].x, path[i].y, path[i + 1].x, path[i + 1].y, attr.radius);//增加折线弧度\r\n                        } else {\r\n                            context.lineTo(path[i].x, path[i].y);\r\n                        }\r\n                    } else {\r\n                        context.lineTo(path[i].x, path[i].y);\r\n                    }\r\n                } else {\r\n                    context.JTopoDashedLineTo(path[i - 1].x, path[i - 1].y, path[i].x, path[i].y, this.dashedPattern);\r\n                }\r\n            }\r\n            context.stroke();\r\n            context.closePath();\r\n            if (null != this.arrowsRadius) {\r\n                if (attr.arrow.end) {//终点箭头\r\n                    this.paintArrow(context, path[path.length - 2], path[path.length - 1]);\r\n                }\r\n                if (attr.arrow.start) {//起点箭头\r\n                    this.paintArrow(context, path[1], path[0]);\r\n                }\r\n            }\r\n        };\r\n        this.paintLoop = function (a) {\r\n            a.beginPath();\r\n            var radius = this.gap * (this.nodeIndex + 1) / 2;\r\n            a.arc(this.nodeA.x, this.nodeA.y, radius, Math.PI / 2, 2 * Math.PI);\r\n            a.stroke();\r\n            a.closePath();\r\n        };\r\n        this.paintArrow = function (context, startPoint, endPoint) {\r\n            context.save();\r\n            context.beginPath();\r\n            context.fillStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n            switch (this.arrowsType) {\r\n                case\'close\':\r\n                    linkArrow(context, startPoint, endPoint, this.arrowsRadius, this.arrowsOffset, true);\r\n                    break;\r\n                default:\r\n                    linkArrow(context, startPoint, endPoint, this.arrowsRadius, this.arrowsOffset, false);\r\n                    this.arrowsType = \'open\';\r\n            }\r\n            context.closePath();\r\n            context.restore();\r\n        };\r\n        this.paint = function (context) {\r\n            if (null != this.nodeA && null != !this.nodeZ) {\r\n                var path = this.getPath(this.nodeIndex);\r\n                this.path = path;\r\n                context.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n                context.lineWidth = this.lineWidth;\r\n                if (path && path.length > 0) {\r\n                    this.paintPath(context, path);\r\n                    this.paintText(context, path);\r\n                }\r\n            }\r\n        };\r\n        var i = -(Math.PI / 2 + Math.PI / 4);\r\n        this.paintText = function (context, path) {\r\n            var textStart = path[0];\r\n            var textEnd = path[path.length - 1];\r\n            if (4 == path.length) {\r\n                textStart = path[1];\r\n                textEnd = path[2];\r\n            }\r\n            if (this.text && this.text.length > 0) {\r\n                var textX = (textEnd.x + textStart.x) / 2 + this.textOffsetX;\r\n                var textY = (textEnd.y + textStart.y) / 2 + this.textOffsetY;\r\n                context.save();\r\n                context.beginPath();\r\n                context.font = this.font;\r\n                var totalWidth = context.measureText(this.text).width;\r\n                var fontWidth = context.measureText("田").width;\r\n                context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                if (this.nodeA === this.nodeZ) {\r\n                    var GAP = this.gap * (this.nodeIndex + 1) / 2;\r\n                    textX = this.nodeA.x + GAP * Math.cos(i);\r\n                    textY = this.nodeA.y + GAP * Math.sin(i);\r\n                    context.fillText(this.text, textX, textY);\r\n                } else {\r\n                    context.fillText(this.text, textX - totalWidth / 2, textY - fontWidth / 2);\r\n                }\r\n                context.stroke();\r\n                context.closePath();\r\n                context.restore();\r\n            }\r\n        };\r\n        this.paintSelected = function (context) {\r\n            context.shadowBlur = 10;\r\n            context.shadowColor = "rgba(255,255,255,1)";\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        };\r\n        this.isInBound = function (mouseX, mouseY) {\r\n            if (this.nodeA === this.nodeZ) {\r\n                var d = this.gap * (this.nodeIndex + 1) / 2;\r\n                var e = jtopo.util.getDistance(this.nodeA, {\r\n                        x: mouseX,\r\n                        y: mouseY\r\n                    }) - d;\r\n                return Math.abs(e) <= 3;\r\n            }\r\n            var inBound = !1;\r\n            for (var i = 1; i < this.path.length; i++) {\r\n                var start = this.path[i - 1];\r\n                var end = this.path[i];\r\n                if (1 == jtopo.util.isPointInLine({x: mouseX, y: mouseY}, start, end)) {\r\n                    inBound = !0;\r\n                    break;\r\n                }\r\n            }\r\n            return inBound;\r\n        }\r\n    }\r\n\r\n    function FoldLink(a, b, c) {\r\n        this.initialize = function () {\r\n            FoldLink.prototype.initialize.apply(this, arguments);\r\n            this.direction = "horizontal";\r\n        };\r\n        this.initialize(a, b, c);\r\n        this.getStartPosition = function () {\r\n            var position = {\r\n                x: this.nodeA.cx,\r\n                y: this.nodeA.cy\r\n            };\r\n            if ("horizontal" == this.direction) {\r\n                if (this.nodeZ.cx > position.x) {\r\n                    position.x += this.nodeA.width / 2;\r\n                } else {\r\n                    position.x -= this.nodeA.width / 2;\r\n                }\r\n            } else {\r\n                if (this.nodeZ.cy > position.y) {\r\n                    position.y += this.nodeA.height / 2;\r\n                } else {\r\n                    position.y -= this.nodeA.height / 2;\r\n                }\r\n            }\r\n            return position;\r\n        };\r\n        this.getEndPosition = function () {\r\n            var position = {\r\n                x: this.nodeZ.cx,\r\n                y: this.nodeZ.cy\r\n            };\r\n            if ("horizontal" == this.direction) {\r\n                if (this.nodeA.cy < position.y) {\r\n                    position.y -= this.nodeZ.height / 2\r\n                } else {\r\n                    position.y += this.nodeZ.height / 2;\r\n                }\r\n            } else {\r\n                if (this.nodeA.cx < position.x) {\r\n                    position.x = this.nodeZ.x;\r\n                } else {\r\n                    position.x = this.nodeZ.x + this.nodeZ.width;\r\n                }\r\n            }\r\n            return position;\r\n        };\r\n        this.getPath = function (Index) {\r\n            var start = this.getStartPosition();\r\n            var end = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ) {\r\n                return [start, end];\r\n            }\r\n            var path = [];\r\n            var middleX;\r\n            var middleY;\r\n            var NUMS = getNums(this.nodeA, this.nodeZ);\r\n            var benginGap = (NUMS - 1) * this.gap;\r\n            var totalGap = this.gap * Index - benginGap / 2;\r\n            if ("horizontal" == this.direction) {\r\n                middleX = end.x + totalGap;\r\n                middleY = start.y - totalGap;\r\n                path.push({x: start.x, y: middleY});\r\n                path.push({x: middleX, y: middleY});\r\n                path.push({x: middleX, y: end.y});\r\n            } else {\r\n                middleX = start.x + totalGap;\r\n                middleY = end.y - totalGap;\r\n                path.push({x: middleX, y: start.y});\r\n                path.push({x: middleX, y: middleY});\r\n                path.push({x: end.x, y: middleY});\r\n            }\r\n            return path\r\n        };\r\n        this.paintText = function (context, path) {\r\n            if (this.text && this.text.length > 0) {\r\n                var textStart = path[1];\r\n                var textX = textStart.x + this.textOffsetX;\r\n                var textY = textStart.y + this.textOffsetY;\r\n                context.save();\r\n                context.beginPath();\r\n                context.font = this.font;\r\n                var totalWidth = context.measureText(this.text).width;\r\n                var fontWidth = context.measureText("田").width;\r\n                context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                context.fillText(this.text, textX - totalWidth / 2, textY - fontWidth / 2);\r\n                context.stroke();\r\n                context.closePath();\r\n                context.restore();\r\n            }\r\n        }\r\n    }\r\n\r\n    function FlexionalLink(a, b, c) {\r\n        this.initialize = function () {\r\n            FlexionalLink.prototype.initialize.apply(this, arguments);\r\n            this.direction = "vertical";\r\n            this.offset = 44;\r\n        };\r\n        this.initialize(a, b, c);\r\n        this.getStartPosition = function () {\r\n            var position = {\r\n                x: this.nodeA.cx,\r\n                y: this.nodeA.cy\r\n            };\r\n            if ("horizontal" == this.direction) {\r\n                if (this.nodeZ.cx < position.x) {\r\n                    position.x = this.nodeA.x;\r\n                } else {\r\n                    position.x = this.nodeA.x + this.nodeA.width\r\n                }\r\n            } else {\r\n                if (this.nodeZ.cy < position.y) {\r\n                    position.y = this.nodeA.y;\r\n                } else {\r\n                    position.y = this.nodeA.y + this.nodeA.height;\r\n                }\r\n            }\r\n            return position;\r\n        };\r\n        this.getEndPosition = function () {\r\n            var position = {\r\n                x: this.nodeZ.cx,\r\n                y: this.nodeZ.cy\r\n            };\r\n            if ("horizontal" == this.direction) {\r\n                if (this.nodeA.cx < position.x) {\r\n                    position.x = this.nodeZ.x;\r\n                } else {\r\n                    position.x = this.nodeZ.x + this.nodeZ.width;\r\n                }\r\n            } else {\r\n                if (this.nodeA.cy < position.y) {\r\n                    position.y = this.nodeZ.y;\r\n                } else {\r\n                    position.y = this.nodeZ.y + this.nodeZ.height;\r\n                }\r\n            }\r\n            return position;\r\n        };\r\n        this.getPath = function (index) {\r\n            var start = this.getStartPosition();\r\n            var end = this.getEndPosition();\r\n            if (this.nodeA === this.nodeZ) {\r\n                return [start, end];\r\n            }\r\n            var path = [];\r\n            var totalLinks = getNums(this.nodeA, this.nodeZ);\r\n            var totalGap = (totalLinks - 1) * this.gap;\r\n            var gap = this.gap * index - totalGap / 2;\r\n            var linkOffset = this.offset;\r\n            if ("horizontal" == this.direction) {\r\n                if (this.nodeA.cx > this.nodeZ.cx) {\r\n                    linkOffset = -linkOffset\r\n                }\r\n                path.push({x: start.x, y: start.y + gap});\r\n                path.push({x: start.x + linkOffset, y: start.y + gap});\r\n                path.push({x: end.x - linkOffset, y: end.y + gap});\r\n                path.push({x: end.x, y: end.y + gap})\r\n            } else {\r\n                if (this.nodeA.cy > this.nodeZ.cy) {\r\n                    linkOffset = -linkOffset\r\n                }\r\n                path.push({x: start.x + gap, y: start.y});\r\n                path.push({x: start.x + gap, y: start.y + linkOffset});\r\n                path.push({x: end.x + gap,y: end.y - linkOffset});\r\n                path.push({x: end.x + gap, y: end.y});\r\n            }\r\n            return path;\r\n        }\r\n    }\r\n\r\n\r\n    //制造一个二次贝塞尔曲线的阶段点\r\n    function makeQuadraticPoint(start, middle, end, time) {\r\n        return {\r\n            x: (1 - time) * (1 - time) * start.x + 2 * time * (1 - time) * middle.x + time * time * end.x,\r\n            y: (1 - time) * (1 - time) * start.y + 2 * time * (1 - time) * middle.y + time * time * end.y\r\n        }\r\n    }\r\n\r\n    function CurveLink(a, b, c) {\r\n        this.initialize = function () {\r\n            CurveLink.prototype.initialize.apply(this, arguments)\r\n        };\r\n        this.initialize(a, b, c);\r\n        this.paintPath = function (context, path) {\r\n            if (this.nodeA === this.nodeZ)return void this.paintLoop(context);\r\n            var start = path[0];\r\n            var end = path[path.length - 1];\r\n            var middle = path.middle;\r\n            if (start && end && middle) {\r\n                context.beginPath();\r\n                context.moveTo(start.x, start.y);\r\n                context.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n                context.lineWidth = this.lineWidth;\r\n                context.moveTo(start.x, start.y);\r\n                context.quadraticCurveTo(middle.x, middle.y, end.x, end.y);\r\n                context.stroke();\r\n                context.closePath();\r\n                if (null != this.arrowsRadius) {\r\n                    if (this.qtopo.attr.arrow.end) {\r\n                        this.paintArrow(context, start, end);\r\n                    }\r\n                    if (this.qtopo.attr.arrow.start) {\r\n                        this.paintArrow(context, end, start);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.getPath = function () {\r\n            var path = [];\r\n            var start = this.getStartPosition();\r\n            var end = this.getEndPosition();\r\n            if (start && end) {\r\n                if (this.nodeA === this.nodeZ) {\r\n                    path.push(start);\r\n                    path.push(end);\r\n                }else{\r\n                    var angle = Math.atan(Math.abs(end.y - start.y) / Math.abs(end.x - start.x));\r\n                    path.middle = {\r\n                        x: (start.x + end.x) / 2 + this.offset * Math.cos(angle - Math.PI / 2),\r\n                        y: (start.y + end.y) / 2 + this.offset * Math.sin(angle - Math.PI / 2)\r\n                    };\r\n                    path.text = makeQuadraticPoint(start, path.middle, end, 1 / 2);\r\n                    path.angle = angle;\r\n                    path.push(start);\r\n                    for (var i = 1; i <= 5; i++) {\r\n                        path.push(makeQuadraticPoint(start, path.middle, end, i / 5));//取样份与选取难度相关\r\n                    }\r\n                    path.push(end);\r\n                }\r\n            }\r\n            return path\r\n        };\r\n        this.paintText = function (cx, path) {\r\n            if (this.text && this.text.length > 0) {\r\n                var textX = path.text.x + this.textOffsetX;\r\n                var textY = path.text.y + this.textOffsetY;\r\n                cx.save();\r\n                cx.beginPath();\r\n                cx.font = this.font;\r\n                var totalWidth = cx.measureText(this.text).width;\r\n                var fontWidth = cx.measureText("田").width;\r\n                cx.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                cx.fillText(this.text, textX - totalWidth / 2, textY - fontWidth / 2);\r\n                cx.stroke();\r\n                cx.closePath();\r\n                cx.restore();\r\n            }\r\n        };\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvbGluay5qcz9mZWQ0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw4QkFBOEI7QUFDekQ7QUFDQSwrQkFBK0IsNkJBQTZCO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsaUJBQWlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLDJHQUEyRztBQUMzRyx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0JBQXNCO0FBQ2pEO0FBQ0E7QUFDQSxtREFBbUQscUJBQXFCO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVCQUF1QjtBQUNsRCwyQkFBMkIsdUJBQXVCO0FBQ2xELDJCQUEyQixxQkFBcUI7QUFDaEQsYUFBYTtBQUNiO0FBQ0E7QUFDQSwyQkFBMkIsdUJBQXVCO0FBQ2xELDJCQUEyQix1QkFBdUI7QUFDbEQsMkJBQTJCLHFCQUFxQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2QkFBNkI7QUFDeEQsMkJBQTJCLDBDQUEwQztBQUNyRSwyQkFBMkIsc0NBQXNDO0FBQ2pFLDJCQUEyQix5QkFBeUI7QUFDcEQsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2QkFBNkI7QUFDeEQsMkJBQTJCLDBDQUEwQztBQUNyRSwyQkFBMkIscUNBQXFDO0FBQ2hFLDJCQUEyQix5QkFBeUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsUUFBUTtBQUMzQyxzRkFBc0Y7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjQyLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoanRvcG8pIHtcclxuICAgIExpbmsucHJvdG90eXBlID0gbmV3IGp0b3BvLkludGVyYWN0aXZlRWxlbWVudDtcclxuICAgIEZvbGRMaW5rLnByb3RvdHlwZSA9IG5ldyBMaW5rO1xyXG4gICAgRmxleGlvbmFsTGluay5wcm90b3R5cGUgPSBuZXcgTGluaztcclxuICAgIEN1cnZlTGluay5wcm90b3R5cGUgPSBuZXcgTGluaztcclxuICAgIGp0b3BvLkxpbmsgPSBMaW5rO1xyXG4gICAganRvcG8uRm9sZExpbmsgPSBGb2xkTGluaztcclxuICAgIGp0b3BvLkZsZXhpb25hbExpbmsgPSBGbGV4aW9uYWxMaW5rO1xyXG4gICAganRvcG8uQ3VydmVMaW5rID0gQ3VydmVMaW5rO1xyXG5cclxuICAgIGZ1bmN0aW9uIGdldFB1YmxpY0xpbmsoZWxlbWVudEEsIGVsZW1lbnRCKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGlmIChudWxsID09IGVsZW1lbnRBIHx8IG51bGwgPT0gZWxlbWVudEIpcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICBpZiAoZWxlbWVudEEgJiYgZWxlbWVudEIgJiYgZWxlbWVudEEub3V0TGlua3MgJiYgZWxlbWVudEIuaW5MaW5rcylcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50QS5vdXRMaW5rcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG91dExpbmsgPSBlbGVtZW50QS5vdXRMaW5rc1tpXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGYgPSAwOyBmIDwgZWxlbWVudEIuaW5MaW5rcy5sZW5ndGg7IGYrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmxpbmsgPSBlbGVtZW50Qi5pbkxpbmtzW2ZdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRMaW5rID09PSBpbmxpbmspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaW5saW5rKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0TGlua3NCZXR3ZWVuKHN0YXJ0LCBlbmQpIHtcclxuICAgICAgICB2YXIgZCA9IGdldFB1YmxpY0xpbmsoc3RhcnQsIGVuZCk7XHJcbiAgICAgICAgdmFyIGUgPSBnZXRQdWJsaWNMaW5rKGVuZCwgc3RhcnQpO1xyXG4gICAgICAgIHJldHVybiBkLmNvbmNhdChlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRMaW5rTm90VGhpcyhsaW5rKSB7XHJcbiAgICAgICAgdmFyIGIgPSBnZXRMaW5rc0JldHdlZW4obGluay5ub2RlQSwgbGluay5ub2RlWik7XHJcbiAgICAgICAgcmV0dXJuIGIgPSBiLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICByZXR1cm4gbGluayAhPT0gYlxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0TnVtcyhhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIGdldExpbmtzQmV0d2VlbihhLCBiKS5sZW5ndGhcclxuICAgIH1cclxuXHJcbiAgICAvKuiuoeeul+S6jOasoee6v+eahOWPs+S+p+WbuuWumuWdkOaghyzlvoXlrpoqL1xyXG4gICAgZnVuY3Rpb24gZ2V0Zml4ZWRSaWdodChzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgLy/ph43lhpnnur/nmoTnu5jliLbot6/lvoRcclxuICAgICAgICB2YXIgbGl0dGxlU2l6ZSA9IDUwO1xyXG4gICAgICAgIHZhciBzdGFydFJpZ2h0ID0ge1xyXG4gICAgICAgICAgICB4OiBzdGFydC54ICsgc3RhcnQud2lkdGgsXHJcbiAgICAgICAgICAgIHk6IHN0YXJ0LnkgKyBzdGFydC5oZWlnaHQgLyAyXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW5kUmlnaHQgPSB7XHJcbiAgICAgICAgICAgIHg6IGVuZC54ICsgZW5kLndpZHRoLFxyXG4gICAgICAgICAgICB5OiBlbmQueSArIGVuZC5oZWlnaHQgLyAyXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgbWlkZGxlQSA9IHt9O1xyXG4gICAgICAgIHZhciBtaWRkbGVCID0ge307XHJcbiAgICAgICAgaWYgKHN0YXJ0UmlnaHQueCA+IGVuZFJpZ2h0LngpIHtcclxuICAgICAgICAgICAgbWlkZGxlQS54ID0gc3RhcnRSaWdodC54ICsgbGl0dGxlU2l6ZTtcclxuICAgICAgICAgICAgbWlkZGxlQS55ID0gc3RhcnRSaWdodC55O1xyXG4gICAgICAgICAgICBtaWRkbGVCLnggPSBzdGFydFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgICAgICBtaWRkbGVCLnkgPSBlbmRSaWdodC55O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1pZGRsZUEueCA9IGVuZFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgICAgICBtaWRkbGVBLnkgPSBzdGFydFJpZ2h0Lnk7XHJcbiAgICAgICAgICAgIG1pZGRsZUIueCA9IGVuZFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgICAgICBtaWRkbGVCLnkgPSBlbmRSaWdodC55O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gW3N0YXJ0UmlnaHQsIG1pZGRsZUEsIG1pZGRsZUIsIGVuZFJpZ2h0XTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRCb3JkZXJQb2ludChzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgdmFyIGxpbmVGbiA9IGp0b3BvLnV0aWwubGluZUYoc3RhcnQuY3gsIHN0YXJ0LmN5LCBlbmQuY3gsIGVuZC5jeSk7XHJcbiAgICAgICAgdmFyIGJvdW5kID0gc3RhcnQuZ2V0Qm91bmQoKTtcclxuICAgICAgICByZXR1cm4ganRvcG8udXRpbC5pbnRlcnNlY3Rpb25MaW5lQm91bmQobGluZUZuLCBib3VuZCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbGlua0Fycm93KGNvbnRleHQsIHN0YXJ0UG9pbnQsIGVuZFBvaW50LCByYWRpdXMsIG9mZnNldCwgdHlwZSkge1xyXG4gICAgICAgIHZhciBhdGFuQW5nbGUgPSBNYXRoLmF0YW4yKGVuZFBvaW50LnkgLSBzdGFydFBvaW50LnksIGVuZFBvaW50LnggLSBzdGFydFBvaW50LngpO1xyXG4gICAgICAgIHZhciBsZW5ndGggPSBqdG9wby51dGlsLmdldERpc3RhbmNlKHN0YXJ0UG9pbnQsIGVuZFBvaW50KSAtIHJhZGl1cztcclxuICAgICAgICB2YXIgQ09TID0gc3RhcnRQb2ludC54ICsgKGxlbmd0aCArIG9mZnNldCkgKiBNYXRoLmNvcyhhdGFuQW5nbGUpO1xyXG4gICAgICAgIHZhciBTSU4gPSBzdGFydFBvaW50LnkgKyAobGVuZ3RoICsgb2Zmc2V0KSAqIE1hdGguc2luKGF0YW5BbmdsZSk7XHJcbiAgICAgICAgdmFyIG0gPSBlbmRQb2ludC54ICsgb2Zmc2V0ICogTWF0aC5jb3MoYXRhbkFuZ2xlKTtcclxuICAgICAgICB2YXIgbiA9IGVuZFBvaW50LnkgKyBvZmZzZXQgKiBNYXRoLnNpbihhdGFuQW5nbGUpO1xyXG4gICAgICAgIGF0YW5BbmdsZSAtPSBNYXRoLlBJIC8gMjtcclxuICAgICAgICB2YXIgbyA9IHtcclxuICAgICAgICAgICAgeDogQ09TICsgKHJhZGl1cyAvIDIpICogTWF0aC5jb3MoYXRhbkFuZ2xlKSxcclxuICAgICAgICAgICAgeTogU0lOICsgKHJhZGl1cyAvIDIpICogTWF0aC5zaW4oYXRhbkFuZ2xlKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHAgPSB7XHJcbiAgICAgICAgICAgIHg6IENPUyArIChyYWRpdXMgLyAyKSAqIE1hdGguY29zKGF0YW5BbmdsZSAtIE1hdGguUEkpLFxyXG4gICAgICAgICAgICB5OiBTSU4gKyAocmFkaXVzIC8gMikgKiBNYXRoLnNpbihhdGFuQW5nbGUgLSBNYXRoLlBJKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29udGV4dC5tb3ZlVG8oby54LCBvLnkpO1xyXG4gICAgICAgIGNvbnRleHQubGluZVRvKG0sIG4pO1xyXG4gICAgICAgIGNvbnRleHQubGluZVRvKHAueCwgcC55KTtcclxuICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBMaW5rKHN0YXJ0LCBlbmQsIHRleHQpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCwgdGV4dCkge1xyXG4gICAgICAgICAgICBMaW5rLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImxpbmtcIjtcclxuICAgICAgICAgICAgdGhpcy56SW5kZXggPSBqdG9wby56SW5kZXhfTGluaztcclxuICAgICAgICAgICAgaWYgKDAgIT0gYXJndW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZUEgPSBzdGFydDtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVogPSBlbmQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVBICYmIG51bGwgPT0gdGhpcy5ub2RlQS5vdXRMaW5rcyAmJiAodGhpcy5ub2RlQS5vdXRMaW5rcyA9IFtdKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZUEgJiYgbnVsbCA9PSB0aGlzLm5vZGVBLmluTGlua3MgJiYgKHRoaXMubm9kZUEuaW5MaW5rcyA9IFtdKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVogJiYgbnVsbCA9PSB0aGlzLm5vZGVaLmluTGlua3MgJiYgKHRoaXMubm9kZVouaW5MaW5rcyA9IFtdKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVogJiYgbnVsbCA9PSB0aGlzLm5vZGVaLm91dExpbmtzICYmICh0aGlzLm5vZGVaLm91dExpbmtzID0gW10pO1xyXG4gICAgICAgICAgICAgICAgbnVsbCAhPSB0aGlzLm5vZGVBICYmIHRoaXMubm9kZUEub3V0TGlua3MucHVzaCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gdGhpcy5ub2RlWiAmJiB0aGlzLm5vZGVaLmluTGlua3MucHVzaCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjdWxhdGVJbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb250ID0gXCIxMnB4IENvbnNvbGFzXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvbnRDb2xvciA9IFwiMjU1LDI1NSwyNTVcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMubGluZVdpZHRoID0gMjtcclxuICAgICAgICAgICAgICAgIHRoaXMubGluZUpvaW4gPSBcIm1pdGVyXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybUFibGUgPSAhMTtcclxuICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0ID0gMjA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhcCA9IDEyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0T2Zmc2V0WCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXJyb3dzUmFkaXVzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXJyb3dzT2Zmc2V0ID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXJyb3dzVHlwZSA9IFwiY2xvc2VcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGFzaGVkUGF0dGVybiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhdGggPSBbXTtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gXCJ0ZXh0LGZvbnQsZm9udENvbG9yLGxpbmVXaWR0aCxsaW5lSm9pblwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNhY3VsYXRlSW5kZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gZ2V0TnVtcyh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKTtcclxuICAgICAgICAgICAgaWYgKGEgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVJbmRleCA9IGEgLSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoc3RhcnQsIGVuZCwgdGV4dCk7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZUEgJiYgdGhpcy5ub2RlQS5vdXRMaW5rcyAmJiAodGhpcy5ub2RlQS5vdXRMaW5rcyA9IHRoaXMubm9kZUEub3V0TGlua3MuZmlsdGVyKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYiAhPT0gYVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZVogJiYgdGhpcy5ub2RlWi5pbkxpbmtzICYmICh0aGlzLm5vZGVaLmluTGlua3MgPSB0aGlzLm5vZGVaLmluTGlua3MuZmlsdGVyKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYiAhPT0gYVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHZhciBiID0gZ2V0TGlua05vdFRoaXModGhpcyk7XHJcbiAgICAgICAgICAgIGIuZm9yRWFjaChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgYS5ub2RlSW5kZXggPSBiXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRCb3JkZXJQb2ludCh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RW5kUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRCb3JkZXJQb2ludCh0aGlzLm5vZGVaLCB0aGlzLm5vZGVBKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0UGF0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGg9W107XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmKHN0YXJ0JiZlbmQpe1xyXG4gICAgICAgICAgICAgICAgdmFyIE5VTVMgPSBnZXROdW1zKHRoaXMubm9kZUEsIHRoaXMubm9kZVopO1xyXG4gICAgICAgICAgICAgICAgaWYgKCh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKXx8MSA9PSBOVU1TKXtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChlbmQpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0UGF0aFdpZHRoR2FwKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwYXRoO1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UGF0aFdpZHRoR2FwKHBhdGgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0YW5BbmdsZSA9IE1hdGguYXRhbjIoZW5kLnkgLSBzdGFydC55LCBlbmQueCAtIHN0YXJ0LngpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldFN0YXJ0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHN0YXJ0LnggKyBzZWxmLm9mZnNldCAqIE1hdGguY29zKHRhbkFuZ2xlKSxcclxuICAgICAgICAgICAgICAgICAgICB5OiBzdGFydC55ICsgc2VsZi5vZmZzZXQgKiBNYXRoLnNpbih0YW5BbmdsZSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0RW5kID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IGVuZC54ICsgc2VsZi5vZmZzZXQgKiBNYXRoLmNvcyh0YW5BbmdsZSAtIE1hdGguUEkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IGVuZC55ICsgc2VsZi5vZmZzZXQgKiBNYXRoLnNpbih0YW5BbmdsZSAtIE1hdGguUEkpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSB0YW5BbmdsZSAtIE1hdGguUEkgLyAyO1xyXG4gICAgICAgICAgICAgICAgdmFyIGogPSB0YW5BbmdsZSAtIE1hdGguUEkgLyAyO1xyXG4gICAgICAgICAgICAgICAgdmFyIGdhcCA9IE5VTVMgKiBzZWxmLmdhcCAvIDIgLSBzZWxmLmdhcCAvIDI7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmVnaW5HYXAgPSBzZWxmLmdhcCAqIHNlbGYubm9kZUluZGV4O1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0TWlkZGxlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IG9mZnNldFN0YXJ0LnggKyBiZWdpbkdhcCAqIE1hdGguY29zKGkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IG9mZnNldFN0YXJ0LnkgKyBiZWdpbkdhcCAqIE1hdGguc2luKGkpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlY29uZE1pZGRsZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBvZmZzZXRFbmQueCArIGJlZ2luR2FwICogTWF0aC5jb3MoaiksXHJcbiAgICAgICAgICAgICAgICAgICAgeTogb2Zmc2V0RW5kLnkgKyBiZWdpbkdhcCAqIE1hdGguc2luKGopXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgZmlyc3RNaWRkbGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogZmlyc3RNaWRkbGUueCArIGdhcCAqIE1hdGguY29zKGkgLSBNYXRoLlBJKSxcclxuICAgICAgICAgICAgICAgICAgICB5OiBmaXJzdE1pZGRsZS55ICsgZ2FwICogTWF0aC5zaW4oaSAtIE1hdGguUEkpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgc2Vjb25kTWlkZGxlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHNlY29uZE1pZGRsZS54ICsgZ2FwICogTWF0aC5jb3MoaiAtIE1hdGguUEkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHNlY29uZE1pZGRsZS55ICsgZ2FwICogTWF0aC5zaW4oaiAtIE1hdGguUEkpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBzdGFydC54LFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHN0YXJ0LnlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBmaXJzdE1pZGRsZS54LFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IGZpcnN0TWlkZGxlLnlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBzZWNvbmRNaWRkbGUueCxcclxuICAgICAgICAgICAgICAgICAgICB5OiBzZWNvbmRNaWRkbGUueVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IGVuZC54LFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IGVuZC55XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYWludFBhdGggPSBmdW5jdGlvbiAoY29udGV4dCwgcGF0aCkge1xyXG4gICAgICAgICAgICB2YXIgYXR0ciA9IHRoaXMucXRvcG8uYXR0cjtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMucGFpbnRMb29wKGNvbnRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHBhdGhbMF0ueCwgcGF0aFswXS55KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLmRhc2hlZFBhdHRlcm4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ci5yYWRpdXMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpIDwgcGF0aC5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmFyY1RvKHBhdGhbaV0ueCwgcGF0aFtpXS55LCBwYXRoW2kgKyAxXS54LCBwYXRoW2kgKyAxXS55LCBhdHRyLnJhZGl1cyk7Ly/lop7liqDmipjnur/lvKfluqZcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHBhdGhbaV0ueCwgcGF0aFtpXS55KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHBhdGhbaV0ueCwgcGF0aFtpXS55KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuSlRvcG9EYXNoZWRMaW5lVG8ocGF0aFtpIC0gMV0ueCwgcGF0aFtpIC0gMV0ueSwgcGF0aFtpXS54LCBwYXRoW2ldLnksIHRoaXMuZGFzaGVkUGF0dGVybik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhdHRyLmFycm93LmVuZCkgey8v57uI54K5566t5aS0XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGNvbnRleHQsIHBhdGhbcGF0aC5sZW5ndGggLSAyXSwgcGF0aFtwYXRoLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChhdHRyLmFycm93LnN0YXJ0KSB7Ly/otbfngrnnrq3lpLRcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coY29udGV4dCwgcGF0aFsxXSwgcGF0aFswXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFpbnRMb29wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgdmFyIHJhZGl1cyA9IHRoaXMuZ2FwICogKHRoaXMubm9kZUluZGV4ICsgMSkgLyAyO1xyXG4gICAgICAgICAgICBhLmFyYyh0aGlzLm5vZGVBLngsIHRoaXMubm9kZUEueSwgcmFkaXVzLCBNYXRoLlBJIC8gMiwgMiAqIE1hdGguUEkpO1xyXG4gICAgICAgICAgICBhLnN0cm9rZSgpO1xyXG4gICAgICAgICAgICBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYWludEFycm93ID0gZnVuY3Rpb24gKGNvbnRleHQsIHN0YXJ0UG9pbnQsIGVuZFBvaW50KSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3Ryb2tlQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLmFycm93c1R5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UnY2xvc2UnOlxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmtBcnJvdyhjb250ZXh0LCBzdGFydFBvaW50LCBlbmRQb2ludCwgdGhpcy5hcnJvd3NSYWRpdXMsIHRoaXMuYXJyb3dzT2Zmc2V0LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgbGlua0Fycm93KGNvbnRleHQsIHN0YXJ0UG9pbnQsIGVuZFBvaW50LCB0aGlzLmFycm93c1JhZGl1cywgdGhpcy5hcnJvd3NPZmZzZXQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFycm93c1R5cGUgPSAnb3Blbic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5ub2RlQSAmJiBudWxsICE9ICF0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuZ2V0UGF0aCh0aGlzLm5vZGVJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3Ryb2tlQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGg7XHJcbiAgICAgICAgICAgICAgICBpZiAocGF0aCAmJiBwYXRoLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50UGF0aChjb250ZXh0LCBwYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50VGV4dChjb250ZXh0LCBwYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGkgPSAtKE1hdGguUEkgLyAyICsgTWF0aC5QSSAvIDQpO1xyXG4gICAgICAgIHRoaXMucGFpbnRUZXh0ID0gZnVuY3Rpb24gKGNvbnRleHQsIHBhdGgpIHtcclxuICAgICAgICAgICAgdmFyIHRleHRTdGFydCA9IHBhdGhbMF07XHJcbiAgICAgICAgICAgIHZhciB0ZXh0RW5kID0gcGF0aFtwYXRoLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBpZiAoNCA9PSBwYXRoLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGV4dFN0YXJ0ID0gcGF0aFsxXTtcclxuICAgICAgICAgICAgICAgIHRleHRFbmQgPSBwYXRoWzJdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHQgJiYgdGhpcy50ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0WCA9ICh0ZXh0RW5kLnggKyB0ZXh0U3RhcnQueCkgLyAyICsgdGhpcy50ZXh0T2Zmc2V0WDtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0WSA9ICh0ZXh0RW5kLnkgKyB0ZXh0U3RhcnQueSkgLyAyICsgdGhpcy50ZXh0T2Zmc2V0WTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgIHZhciB0b3RhbFdpZHRoID0gY29udGV4dC5tZWFzdXJlVGV4dCh0aGlzLnRleHQpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvbnRXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgR0FQID0gdGhpcy5nYXAgKiAodGhpcy5ub2RlSW5kZXggKyAxKSAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dFggPSB0aGlzLm5vZGVBLnggKyBHQVAgKiBNYXRoLmNvcyhpKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0WSA9IHRoaXMubm9kZUEueSArIEdBUCAqIE1hdGguc2luKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFRleHQodGhpcy50ZXh0LCB0ZXh0WCwgdGV4dFkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMudGV4dCwgdGV4dFggLSB0b3RhbFdpZHRoIC8gMiwgdGV4dFkgLSBmb250V2lkdGggLyAyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IDEwO1xyXG4gICAgICAgICAgICBjb250ZXh0LnNoYWRvd0NvbG9yID0gXCJyZ2JhKDI1NSwyNTUsMjU1LDEpXCI7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WCA9IDA7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmlzSW5Cb3VuZCA9IGZ1bmN0aW9uIChtb3VzZVgsIG1vdXNlWSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmdhcCAqICh0aGlzLm5vZGVJbmRleCArIDEpIC8gMjtcclxuICAgICAgICAgICAgICAgIHZhciBlID0ganRvcG8udXRpbC5nZXREaXN0YW5jZSh0aGlzLm5vZGVBLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IG1vdXNlWCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogbW91c2VZXHJcbiAgICAgICAgICAgICAgICAgICAgfSkgLSBkO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKGUpIDw9IDM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGluQm91bmQgPSAhMTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLnBhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IHRoaXMucGF0aFtpIC0gMV07XHJcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gdGhpcy5wYXRoW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKDEgPT0ganRvcG8udXRpbC5pc1BvaW50SW5MaW5lKHt4OiBtb3VzZVgsIHk6IG1vdXNlWX0sIHN0YXJ0LCBlbmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5Cb3VuZCA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpbkJvdW5kO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBGb2xkTGluayhhLCBiLCBjKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBGb2xkTGluay5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IFwiaG9yaXpvbnRhbFwiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplKGEsIGIsIGMpO1xyXG4gICAgICAgIHRoaXMuZ2V0U3RhcnRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgeDogdGhpcy5ub2RlQS5jeCxcclxuICAgICAgICAgICAgICAgIHk6IHRoaXMubm9kZUEuY3lcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2RlWi5jeCA+IHBvc2l0aW9uLngpIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi54ICs9IHRoaXMubm9kZUEud2lkdGggLyAyO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi54IC09IHRoaXMubm9kZUEud2lkdGggLyAyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZVouY3kgPiBwb3NpdGlvbi55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ueSArPSB0aGlzLm5vZGVBLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnkgLT0gdGhpcy5ub2RlQS5oZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RW5kUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMubm9kZVouY3gsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLm5vZGVaLmN5XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmIChcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEuY3kgPCBwb3NpdGlvbi55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ueSAtPSB0aGlzLm5vZGVaLmhlaWdodCAvIDJcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ueSArPSB0aGlzLm5vZGVaLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2RlQS5jeCA8IHBvc2l0aW9uLngpIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi54ID0gdGhpcy5ub2RlWi54O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi54ID0gdGhpcy5ub2RlWi54ICsgdGhpcy5ub2RlWi53aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFBhdGggPSBmdW5jdGlvbiAoSW5kZXgpIHtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3N0YXJ0LCBlbmRdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gW107XHJcbiAgICAgICAgICAgIHZhciBtaWRkbGVYO1xyXG4gICAgICAgICAgICB2YXIgbWlkZGxlWTtcclxuICAgICAgICAgICAgdmFyIE5VTVMgPSBnZXROdW1zKHRoaXMubm9kZUEsIHRoaXMubm9kZVopO1xyXG4gICAgICAgICAgICB2YXIgYmVuZ2luR2FwID0gKE5VTVMgLSAxKSAqIHRoaXMuZ2FwO1xyXG4gICAgICAgICAgICB2YXIgdG90YWxHYXAgPSB0aGlzLmdhcCAqIEluZGV4IC0gYmVuZ2luR2FwIC8gMjtcclxuICAgICAgICAgICAgaWYgKFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBtaWRkbGVYID0gZW5kLnggKyB0b3RhbEdhcDtcclxuICAgICAgICAgICAgICAgIG1pZGRsZVkgPSBzdGFydC55IC0gdG90YWxHYXA7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IHN0YXJ0LngsIHk6IG1pZGRsZVl9KTtcclxuICAgICAgICAgICAgICAgIHBhdGgucHVzaCh7eDogbWlkZGxlWCwgeTogbWlkZGxlWX0pO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBtaWRkbGVYLCB5OiBlbmQueX0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbWlkZGxlWCA9IHN0YXJ0LnggKyB0b3RhbEdhcDtcclxuICAgICAgICAgICAgICAgIG1pZGRsZVkgPSBlbmQueSAtIHRvdGFsR2FwO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBtaWRkbGVYLCB5OiBzdGFydC55fSk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IG1pZGRsZVgsIHk6IG1pZGRsZVl9KTtcclxuICAgICAgICAgICAgICAgIHBhdGgucHVzaCh7eDogZW5kLngsIHk6IG1pZGRsZVl9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcGF0aFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYWludFRleHQgPSBmdW5jdGlvbiAoY29udGV4dCwgcGF0aCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dFN0YXJ0ID0gcGF0aFsxXTtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0WCA9IHRleHRTdGFydC54ICsgdGhpcy50ZXh0T2Zmc2V0WDtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0WSA9IHRleHRTdGFydC55ICsgdGhpcy50ZXh0T2Zmc2V0WTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgIHZhciB0b3RhbFdpZHRoID0gY29udGV4dC5tZWFzdXJlVGV4dCh0aGlzLnRleHQpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvbnRXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dCh0aGlzLnRleHQsIHRleHRYIC0gdG90YWxXaWR0aCAvIDIsIHRleHRZIC0gZm9udFdpZHRoIC8gMik7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIEZsZXhpb25hbExpbmsoYSwgYiwgYykge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgRmxleGlvbmFsTGluay5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IFwidmVydGljYWxcIjtcclxuICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSA0NDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZShhLCBiLCBjKTtcclxuICAgICAgICB0aGlzLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMubm9kZUEuY3gsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLm5vZGVBLmN5XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmIChcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZVouY3ggPCBwb3NpdGlvbi54KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ueCA9IHRoaXMubm9kZUEueDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ueCA9IHRoaXMubm9kZUEueCArIHRoaXMubm9kZUEud2lkdGhcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVaLmN5IDwgcG9zaXRpb24ueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnkgPSB0aGlzLm5vZGVBLnk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnkgPSB0aGlzLm5vZGVBLnkgKyB0aGlzLm5vZGVBLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldEVuZFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICB4OiB0aGlzLm5vZGVaLmN4LFxyXG4gICAgICAgICAgICAgICAgeTogdGhpcy5ub2RlWi5jeVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBLmN4IDwgcG9zaXRpb24ueCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnggPSB0aGlzLm5vZGVaLng7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnggPSB0aGlzLm5vZGVaLnggKyB0aGlzLm5vZGVaLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEuY3kgPCBwb3NpdGlvbi55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ueSA9IHRoaXMubm9kZVoueTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ueSA9IHRoaXMubm9kZVoueSArIHRoaXMubm9kZVouaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0UGF0aCA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLmdldFN0YXJ0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgdmFyIGVuZCA9IHRoaXMuZ2V0RW5kUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbc3RhcnQsIGVuZF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHBhdGggPSBbXTtcclxuICAgICAgICAgICAgdmFyIHRvdGFsTGlua3MgPSBnZXROdW1zKHRoaXMubm9kZUEsIHRoaXMubm9kZVopO1xyXG4gICAgICAgICAgICB2YXIgdG90YWxHYXAgPSAodG90YWxMaW5rcyAtIDEpICogdGhpcy5nYXA7XHJcbiAgICAgICAgICAgIHZhciBnYXAgPSB0aGlzLmdhcCAqIGluZGV4IC0gdG90YWxHYXAgLyAyO1xyXG4gICAgICAgICAgICB2YXIgbGlua09mZnNldCA9IHRoaXMub2Zmc2V0O1xyXG4gICAgICAgICAgICBpZiAoXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBLmN4ID4gdGhpcy5ub2RlWi5jeCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmtPZmZzZXQgPSAtbGlua09mZnNldFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBzdGFydC54LCB5OiBzdGFydC55ICsgZ2FwfSk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IHN0YXJ0LnggKyBsaW5rT2Zmc2V0LCB5OiBzdGFydC55ICsgZ2FwfSk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IGVuZC54IC0gbGlua09mZnNldCwgeTogZW5kLnkgKyBnYXB9KTtcclxuICAgICAgICAgICAgICAgIHBhdGgucHVzaCh7eDogZW5kLngsIHk6IGVuZC55ICsgZ2FwfSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBLmN5ID4gdGhpcy5ub2RlWi5jeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmtPZmZzZXQgPSAtbGlua09mZnNldFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBzdGFydC54ICsgZ2FwLCB5OiBzdGFydC55fSk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IHN0YXJ0LnggKyBnYXAsIHk6IHN0YXJ0LnkgKyBsaW5rT2Zmc2V0fSk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnB1c2goe3g6IGVuZC54ICsgZ2FwLHk6IGVuZC55IC0gbGlua09mZnNldH0pO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wdXNoKHt4OiBlbmQueCArIGdhcCwgeTogZW5kLnl9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8v5Yi26YCg5LiA5Liq5LqM5qyh6LSd5aGe5bCU5puy57q/55qE6Zi25q6154K5XHJcbiAgICBmdW5jdGlvbiBtYWtlUXVhZHJhdGljUG9pbnQoc3RhcnQsIG1pZGRsZSwgZW5kLCB0aW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogKDEgLSB0aW1lKSAqICgxIC0gdGltZSkgKiBzdGFydC54ICsgMiAqIHRpbWUgKiAoMSAtIHRpbWUpICogbWlkZGxlLnggKyB0aW1lICogdGltZSAqIGVuZC54LFxyXG4gICAgICAgICAgICB5OiAoMSAtIHRpbWUpICogKDEgLSB0aW1lKSAqIHN0YXJ0LnkgKyAyICogdGltZSAqICgxIC0gdGltZSkgKiBtaWRkbGUueSArIHRpbWUgKiB0aW1lICogZW5kLnlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gQ3VydmVMaW5rKGEsIGIsIGMpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIEN1cnZlTGluay5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoYSwgYiwgYyk7XHJcbiAgICAgICAgdGhpcy5wYWludFBhdGggPSBmdW5jdGlvbiAoY29udGV4dCwgcGF0aCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gdm9pZCB0aGlzLnBhaW50TG9vcChjb250ZXh0KTtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gcGF0aFswXTtcclxuICAgICAgICAgICAgdmFyIGVuZCA9IHBhdGhbcGF0aC5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgdmFyIG1pZGRsZSA9IHBhdGgubWlkZGxlO1xyXG4gICAgICAgICAgICBpZiAoc3RhcnQgJiYgZW5kICYmIG1pZGRsZSkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHN0YXJ0LngsIHN0YXJ0LnkpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3Ryb2tlQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyhzdGFydC54LCBzdGFydC55KTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyhtaWRkbGUueCwgbWlkZGxlLnksIGVuZC54LCBlbmQueSk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucXRvcG8uYXR0ci5hcnJvdy5lbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGNvbnRleHQsIHN0YXJ0LCBlbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5xdG9wby5hdHRyLmFycm93LnN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhjb250ZXh0LCBlbmQsIHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0UGF0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBbXTtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmIChzdGFydCAmJiBlbmQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goZW5kKTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmdsZSA9IE1hdGguYXRhbihNYXRoLmFicyhlbmQueSAtIHN0YXJ0LnkpIC8gTWF0aC5hYnMoZW5kLnggLSBzdGFydC54KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5taWRkbGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IChzdGFydC54ICsgZW5kLngpIC8gMiArIHRoaXMub2Zmc2V0ICogTWF0aC5jb3MoYW5nbGUgLSBNYXRoLlBJIC8gMiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IChzdGFydC55ICsgZW5kLnkpIC8gMiArIHRoaXMub2Zmc2V0ICogTWF0aC5zaW4oYW5nbGUgLSBNYXRoLlBJIC8gMilcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGgudGV4dCA9IG1ha2VRdWFkcmF0aWNQb2ludChzdGFydCwgcGF0aC5taWRkbGUsIGVuZCwgMSAvIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGguYW5nbGUgPSBhbmdsZTtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IDU7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2gobWFrZVF1YWRyYXRpY1BvaW50KHN0YXJ0LCBwYXRoLm1pZGRsZSwgZW5kLCBpIC8gNSkpOy8v5Y+W5qC35Lu95LiO6YCJ5Y+W6Zq+5bqm55u45YWzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChlbmQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwYXRoXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChjeCwgcGF0aCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dFggPSBwYXRoLnRleHQueCArIHRoaXMudGV4dE9mZnNldFg7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dFkgPSBwYXRoLnRleHQueSArIHRoaXMudGV4dE9mZnNldFk7XHJcbiAgICAgICAgICAgICAgICBjeC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICBjeC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN4LmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgdG90YWxXaWR0aCA9IGN4Lm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB2YXIgZm9udFdpZHRoID0gY3gubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjeC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIGN4LmZpbGxUZXh0KHRoaXMudGV4dCwgdGV4dFggLSB0b3RhbFdpZHRoIC8gMiwgdGV4dFkgLSBmb250V2lkdGggLyAyKTtcclxuICAgICAgICAgICAgICAgIGN4LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgY3guY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjeC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2VsZW1lbnRzL2xpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDQyXG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports){eval('module.exports = function (jtopo) {\r\n    var imageCache = {};\r\n    BaseNode.prototype = new jtopo.EditableElement();\r\n    Node.prototype = new BaseNode();\r\n    Object.defineProperties(Node.prototype, {\r\n        alarmColor: {\r\n            get: function () {\r\n                return this._alarmColor;\r\n            },\r\n            set: function (color) {\r\n                this._alarmColor = color;\r\n                if (null != this.image) {\r\n                    var c = jtopo.util.genImageAlarm(this.image, color);\r\n                    if (c) {\r\n                        this.alarmImage = c;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    });\r\n    TextNode.prototype = new Node();\r\n    LinkNode.prototype = new TextNode();\r\n    CircleNode.prototype = new Node();\r\n    Object.defineProperties(CircleNode.prototype, {\r\n        radius: {\r\n            get: function () {\r\n                return this._radius\r\n            },\r\n            set: function (a) {\r\n                this._radius = a;\r\n                var b = 2 * this.radius;\r\n                var c = 2 * this.radius;\r\n                this.width = b;\r\n                this.height = c;\r\n            }\r\n        }, width: {\r\n            get: function () {\r\n                return this._width\r\n            },\r\n            set: function (a) {\r\n                this._radius = a / 2;\r\n                this._width = a;\r\n            }\r\n        }, height: {\r\n            get: function () {\r\n                return this._height;\r\n            },\r\n            set: function (a) {\r\n                this._radius = a / 2;\r\n                this._height = a;\r\n            }\r\n        }\r\n    });\r\n    animateBaseNodeA.prototype = new Node();\r\n    animateBaseNodeB.prototype = new Node();\r\n    AnimateNode.prototype = new Node();\r\n    jtopo.Node = Node;\r\n    jtopo.TextNode = TextNode;\r\n    jtopo.LinkNode = LinkNode;\r\n    jtopo.CircleNode = CircleNode;\r\n    jtopo.AnimateNode = AnimateNode;\r\n\r\n    function BaseNode(text) {\r\n        this.initialize = function (text) {\r\n            BaseNode.prototype.initialize.apply(this, arguments);\r\n            this.elementType = "node";\r\n            this.zIndex = jtopo.zIndex_Node;\r\n            this.text = text;\r\n            this.font = "12px Consolas";\r\n            this.fontColor = "255,255,255";\r\n            this.borderWidth = 0;\r\n            this.borderColor = "255,255,255";\r\n            this.borderRadius = null;\r\n            this.draggable = !0;\r\n            this.textPosition = "Bottom_Center";\r\n            this.textOffsetX = 0;\r\n            this.textOffsetY = 0;\r\n            this.transformAble = !0;\r\n            this.inLinks = null;\r\n            this.outLinks = null;\r\n            var d = "text,font,fontColor,textPosition,textOffsetX,textOffsetY,borderRadius".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(d);\r\n        };\r\n        this.initialize(text);\r\n        this.paint = function (context) {\r\n            this.paintAlarmFlash(context);\r\n            if (this.image) {\r\n                var gobalAlpha = context.globalAlpha;\r\n                context.globalAlpha = this.alpha;\r\n                if (null != this.alarmImage && null != this.alarm) {\r\n                    context.drawImage(this.alarmImage, -this.width / 2, -this.height / 2, this.width, this.height)\r\n                } else {\r\n                    context.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height)\r\n                }\r\n                context.globalAlpha = gobalAlpha;\r\n            } else {\r\n                context.beginPath();\r\n                context.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                    context.rect(-this.width / 2, -this.height / 2, this.width, this.height)\r\n                } else {\r\n                    context.JTopoRoundRect(-this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius);\r\n                }\r\n                context.fill();\r\n                context.closePath();\r\n            }\r\n            this.paintText(context);\r\n            this.paintBorder(context);\r\n            this.paintCtrl(context);\r\n            this.paintAlarmText(context);\r\n        };\r\n        this.paintAlarmText = function (context) {\r\n            if (null != this.alarm && "" != this.alarm) {\r\n                var b = this.alarmColor || "255,0,0", c = this.alarmAlpha || .5;\r\n                context.beginPath(), context.font = this.alarmFont || "10px 微软雅黑";\r\n                var d = context.measureText(this.alarm).width + 6, e = context.measureText("田").width + 6, f = this.width / 2 - d / 2, g = -this.height / 2 - e - 8;\r\n                context.strokeStyle = "rgba(" + b + ", " + c + ")", context.fillStyle = "rgba(" + b + ", " + c + ")", context.lineCap = "round", context.lineWidth = 1, context.moveTo(f, g), context.lineTo(f + d, g), context.lineTo(f + d, g + e), context.lineTo(f + d / 2 + 6, g + e), context.lineTo(f + d / 2, g + e + 8), context.lineTo(f + d / 2 - 6, g + e), context.lineTo(f, g + e), context.lineTo(f, g), context.fill(), context.stroke(), context.closePath(), context.beginPath(), context.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", context.fillText(this.alarm, f + 2, g + e - 4), context.closePath()\r\n            }\r\n        };\r\n        //自定义新增,启用告警后每次绘画执行修改阴影\r\n        this.paintAlarmFlash = function (context) {\r\n            if (this.shadow == 1 && this.allowAlarmFlash == 1) {\r\n                if (this.shadowDirection == null) {\r\n                    this.shadowDirection = true;\r\n                }\r\n                move(this);\r\n                context.shadowBlur = this.shadowBlur;\r\n                function move(node) {\r\n                    if (node.shadowDirection) {\r\n                        node.shadowBlur += 5;\r\n                        if (node.shadowBlur > 100) {\r\n                            node.shadowDirection = false;\r\n                        }\r\n                    }\r\n                    else {\r\n                        node.shadowBlur -= 5;\r\n                        if (node.shadowBlur <= 10) {\r\n                            node.shadowDirection = true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.paintText = function (context) {\r\n            var text = this.text;\r\n            if (null != text && "" != text) {\r\n                context.beginPath();\r\n                context.font = this.font;\r\n                var fontWidth = context.measureText("田").width;\r\n                var maxWidth = fontWidth;\r\n                context.fillStyle = "rgba(" + this.fontColor + "," + this.alpha + ")";\r\n                //换行检测\r\n                var textlines = text.split("\\n");\r\n                for (var i = 0; i < textlines.length; i++) {\r\n                    var width = context.measureText(textlines[i]).width;\r\n                    if (width > maxWidth) {\r\n                        maxWidth = width;\r\n                    }\r\n                }\r\n                var e = this.getTextPostion(this.textPosition, maxWidth, fontWidth, textlines.length);\r\n                for (var j = 0; j < textlines.length; j++) {\r\n                    var textWidth = context.measureText(textlines[j]).width;\r\n                    context.fillText(textlines[j], e.x + (maxWidth - textWidth) / 2, e.y + j * fontWidth);\r\n                }\r\n\r\n                context.closePath();\r\n            }\r\n        };\r\n        this.paintBorder = function (context) {\r\n            if (0 != this.borderWidth) {\r\n                context.beginPath();\r\n                context.lineWidth = this.borderWidth;\r\n                context.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                var b = this.borderWidth / 2;\r\n                if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                    context.rect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth);\r\n                } else {\r\n                    context.JTopoRoundRect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius);\r\n                }\r\n                context.stroke();\r\n                context.closePath();\r\n            }\r\n        };\r\n        this.getTextPostion = function (position, maxWidth, fontWidth, textLines) {\r\n            var d = null;\r\n            switch (position) {\r\n                case "Bottom_Center":\r\n                    d = {\r\n                        x: -this.width / 2 + (this.width - maxWidth) / 2,\r\n                        y: this.height / 2 + fontWidth\r\n                    };\r\n                    break;\r\n                case "Top_Center":\r\n                    d = {\r\n                        x: -this.width / 2 + (this.width - maxWidth) / 2,\r\n                        y: -this.height / 2 - fontWidth / 2 - fontWidth * (textLines - 1)\r\n                    };\r\n                    break;\r\n                case "Top_Right":\r\n                    d = {\r\n                        x: this.width / 2,\r\n                        y: -this.height / 2 - fontWidth / 2\r\n                    };\r\n                    break;\r\n                case "Top_Left":\r\n                    d = {\r\n                        x: -this.width / 2 - maxWidth,\r\n                        y: -this.height / 2 - fontWidth / 2\r\n                    };\r\n                    break;\r\n                case "Bottom_Right":\r\n                    d = {\r\n                        x: this.width / 2,\r\n                        y: this.height / 2 + fontWidth\r\n                    };\r\n                    break;\r\n                case "Bottom_Left":\r\n                    d = {\r\n                        x: -this.width / 2 - maxWidth,\r\n                        y: this.height / 2 + fontWidth\r\n                    };\r\n                    break;\r\n                case "Middle_Center":\r\n                    d = {\r\n                        x: -this.width / 2 + (this.width - maxWidth) / 2,\r\n                        y: fontWidth / 2\r\n                    };\r\n                    break;\r\n                case "Middle_Right":\r\n                    d = {\r\n                        x: this.width / 2,\r\n                        y: fontWidth / 2\r\n                    };\r\n                    break;\r\n                default:\r\n                    d = {//"Middle_Left"\r\n                        x: -this.width / 2 - maxWidth,\r\n                        y: fontWidth / 2\r\n                    };\r\n            }\r\n            if (null != this.textOffsetX) {\r\n                d.x += this.textOffsetX\r\n            }\r\n            if (null != this.textOffsetY) {\r\n                d.y += this.textOffsetY\r\n            }\r\n            return d;\r\n        };\r\n        this.setImage = function (paramImage, asImageSize) {\r\n            if (null == paramImage)throw new Error("Node.setImage(): 参数Image对象为空!");\r\n            var self = this;\r\n            if ("string" == typeof paramImage) {\r\n                var image = imageCache[paramImage];\r\n                if (null == image) {\r\n                    image = new Image();\r\n                    image.src = paramImage;\r\n                    image.onload = function () {\r\n                        imageCache[paramImage] = image;\r\n                        initImage(image);\r\n                    }\r\n                } else {\r\n                    initImage(image);\r\n                }\r\n            } else {\r\n                initImage(paramImage)\r\n            }\r\n            function initImage(newImage){\r\n                self.image = newImage;\r\n                self.alarmColor = self.alarmColor || "255,0,0";\r\n                if (asImageSize==1) {\r\n                    self.setSize(newImage.width, newImage.height)\r\n                }\r\n            }\r\n        };\r\n        this.removeHandler = function (scene) {\r\n            var self = this;\r\n            if (this.outLinks) {\r\n                this.outLinks.forEach(function (c) {\r\n                    if (c.nodeA === self) {\r\n                        scene.remove(c)\r\n                    }\r\n                });\r\n                this.outLinks = null;\r\n            }\r\n            if (this.inLinks) {\r\n                this.inLinks.forEach(function (c) {\r\n                    c.nodeZ === self && scene.remove(c)\r\n                });\r\n                this.inLinks = null;\r\n            }\r\n        };\r\n    }\r\n\r\n    function Node() {\r\n        Node.prototype.initialize.apply(this, arguments)\r\n    }\r\n\r\n    function TextNode(text) {\r\n        this.initialize();\r\n        this.text = text;\r\n        this.elementType = "TextNode";\r\n        this.paint = function (context) {\r\n            //自动换行\r\n            var texts = this.text.split("\\n");\r\n            context.beginPath();\r\n            context.font = this.font;\r\n            var fontWidth = context.measureText("田").width;\r\n            this.width = 0;\r\n            for (var j = 0; j < texts.length; j++) {\r\n                var width = context.measureText(texts[j]).width;\r\n                if (width > this.width) {\r\n                    this.width = width;\r\n                }\r\n            }\r\n            this.height = texts.length * fontWidth;\r\n            context.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n            if (texts.length > 1) {\r\n                for (var i = 0; i < texts.length; i++) {\r\n                    context.fillText(texts[i], -this.width / 2 + 0.15 * fontWidth, this.height / 2 + (i - texts.length + 0.85) * fontWidth);\r\n                }\r\n            } else {\r\n                context.fillText(texts, -this.width / 2 + 0.03 * fontWidth, this.height / 2 - 0.15 * fontWidth);\r\n            }\r\n            context.closePath();\r\n            this.paintBorder(context);\r\n            this.paintCtrl(context);\r\n            this.paintAlarmText(context);\r\n        }\r\n    }\r\n\r\n    function LinkNode(a, b, c) {\r\n        this.initialize();\r\n        this.text = a;\r\n        this.href = b;\r\n        this.target = c;\r\n        this.elementType = "LinkNode";\r\n        this.isVisited = !1;\r\n        this.visitedColor = null;\r\n        this.paint = function (a) {\r\n            a.beginPath();\r\n            a.font = this.font;\r\n            this.width = a.measureText(this.text).width;\r\n            this.height = a.measureText("田").width;\r\n            if (this.isVisited && null != this.visitedColor) {\r\n                a.strokeStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")";\r\n                a.fillStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")";\r\n            } else {\r\n                a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n            }\r\n            a.fillText(this.text, -this.width / 2, this.height / 2);\r\n            if (this.isMouseOver) {\r\n                a.moveTo(-this.width / 2, this.height);\r\n                a.lineTo(this.width / 2, this.height);\r\n                a.stroke();\r\n            }\r\n            a.closePath();\r\n            this.paintBorder(a);\r\n            this.paintCtrl(a);\r\n            this.paintAlarmText(a);\r\n        };\r\n        this.mousemove(function () {\r\n            var a = document.getElementsByTagName("canvas");\r\n            if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "pointer"\r\n        });\r\n        this.mouseout(function () {\r\n            var a = document.getElementsByTagName("canvas");\r\n            if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "default"\r\n        });\r\n        this.click(function () {\r\n            "_blank" == this.target ? window.open(this.href) : location = this.href, this.isVisited = !0\r\n        })\r\n    }\r\n\r\n    function CircleNode(text) {\r\n        this.initialize(arguments);\r\n        this._radius = 20;\r\n        this.beginDegree = 0;\r\n        this.endDegree = 2 * Math.PI;\r\n        this.text = text;\r\n        this.paint = function (context) {\r\n            context.save();\r\n            context.beginPath();\r\n            context.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n            context.arc(0, 0, this.radius, this.beginDegree, this.endDegree, !0);\r\n            context.fill();\r\n            context.closePath();\r\n            context.restore();\r\n            this.paintText(context);\r\n            this.paintBorder(context);\r\n            this.paintCtrl(context);\r\n            this.paintAlarmText(context);\r\n        };\r\n        this.paintSelected = function (context) {\r\n            context.save();\r\n            context.beginPath();\r\n            context.strokeStyle = "rgba(168,202,255, 0.9)";\r\n            context.fillStyle = "rgba(168,202,236,0.7)";\r\n            context.arc(0, 0, this.radius + 3, this.beginDegree, this.endDegree, !0);\r\n            context.fill();\r\n            context.stroke();\r\n            context.closePath();\r\n            context.restore();\r\n        }\r\n    }\r\n\r\n    function animateBaseNodeA(frameImages, b, c) {\r\n        this.initialize();\r\n        this.frameImages = frameImages || [];\r\n        this.frameIndex = 0;\r\n        this.isStop = !0;\r\n        var d = b || 1e3;\r\n        this.repeatPlay = !1;\r\n        var e = this;\r\n        this.nextFrame = function () {\r\n            if (!this.isStop && null != this.frameImages.length) {\r\n                this.frameIndex++;\r\n                if (this.frameIndex >= this.frameImages.length) {\r\n                    if (!this.repeatPlay)return;\r\n                    this.frameIndex = 0;\r\n                }\r\n                this.setImage(this.frameImages[this.frameIndex], c);\r\n                setTimeout(function () {\r\n                    e.nextFrame();\r\n                }, d / frameImages.length);\r\n            }\r\n        }\r\n    }\r\n\r\n    function animateBaseNodeB(a, b, c, d, e) {\r\n        this.initialize();\r\n        var f = this;\r\n        this.setImage(a), this.frameIndex = 0, this.isPause = !0, this.repeatPlay = !1;\r\n        var g = d || 1e3;\r\n        e = e || 0, this.paint = function (a) {\r\n            if (this.image) {\r\n                var b = this.width, d = this.height;\r\n                a.save(), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                var f = (Math.floor(this.frameIndex / c) + e) * d, g = Math.floor(this.frameIndex % c) * b;\r\n                a.drawImage(this.image, g, f, b, d, -b / 2, -d / 2, b, d), a.fill(), a.closePath(), a.restore(), this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n            }\r\n        }, this.nextFrame = function () {\r\n            if (!this.isStop) {\r\n                if (this.frameIndex++, this.frameIndex >= b * c) {\r\n                    if (!this.repeatPlay)return;\r\n                    this.frameIndex = 0\r\n                }\r\n                setTimeout(function () {\r\n                    f.isStop || f.nextFrame()\r\n                }, g / (b * c))\r\n            }\r\n        }\r\n    }\r\n\r\n    function AnimateNode() {\r\n        var a = null;\r\n        if (arguments.length <= 3) {\r\n            a = new animateBaseNodeA(arguments[0], arguments[1], arguments[2]);\r\n        } else {\r\n            a = new animateBaseNodeB(arguments[0], arguments[1], arguments[2], arguments[3], arguments[4], arguments[5]);\r\n        }\r\n        a.stop = function () {\r\n            a.isStop = !0\r\n        };\r\n        a.play = function () {\r\n            a.isStop = !1;\r\n            a.frameIndex = 0;\r\n            a.nextFrame();\r\n        };\r\n        return a\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvbm9kZS5qcz8xNmJmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixzQkFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHNCQUFzQjtBQUNyRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsa0JBQWtCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isa0JBQWtCO0FBQ2pEO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxjQUFjO0FBQy9ELFNBQVM7QUFDVDtBQUNBO0FBQ0EsaURBQWlELGNBQWM7QUFDL0QsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjQzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoanRvcG8pIHtcclxuICAgIHZhciBpbWFnZUNhY2hlID0ge307XHJcbiAgICBCYXNlTm9kZS5wcm90b3R5cGUgPSBuZXcganRvcG8uRWRpdGFibGVFbGVtZW50KCk7XHJcbiAgICBOb2RlLnByb3RvdHlwZSA9IG5ldyBCYXNlTm9kZSgpO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTm9kZS5wcm90b3R5cGUsIHtcclxuICAgICAgICBhbGFybUNvbG9yOiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FsYXJtQ29sb3I7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hbGFybUNvbG9yID0gY29sb3I7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBqdG9wby51dGlsLmdlbkltYWdlQWxhcm0odGhpcy5pbWFnZSwgY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWxhcm1JbWFnZSA9IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBUZXh0Tm9kZS5wcm90b3R5cGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgTGlua05vZGUucHJvdG90eXBlID0gbmV3IFRleHROb2RlKCk7XHJcbiAgICBDaXJjbGVOb2RlLnByb3RvdHlwZSA9IG5ldyBOb2RlKCk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDaXJjbGVOb2RlLnByb3RvdHlwZSwge1xyXG4gICAgICAgIHJhZGl1czoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yYWRpdXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFkaXVzID0gYTtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gMiAqIHRoaXMucmFkaXVzO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSAyICogdGhpcy5yYWRpdXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gYjtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gYztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHdpZHRoOiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JhZGl1cyA9IGEgLyAyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fd2lkdGggPSBhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgaGVpZ2h0OiB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlaWdodDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFkaXVzID0gYSAvIDI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oZWlnaHQgPSBhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhbmltYXRlQmFzZU5vZGVBLnByb3RvdHlwZSA9IG5ldyBOb2RlKCk7XHJcbiAgICBhbmltYXRlQmFzZU5vZGVCLnByb3RvdHlwZSA9IG5ldyBOb2RlKCk7XHJcbiAgICBBbmltYXRlTm9kZS5wcm90b3R5cGUgPSBuZXcgTm9kZSgpO1xyXG4gICAganRvcG8uTm9kZSA9IE5vZGU7XHJcbiAgICBqdG9wby5UZXh0Tm9kZSA9IFRleHROb2RlO1xyXG4gICAganRvcG8uTGlua05vZGUgPSBMaW5rTm9kZTtcclxuICAgIGp0b3BvLkNpcmNsZU5vZGUgPSBDaXJjbGVOb2RlO1xyXG4gICAganRvcG8uQW5pbWF0ZU5vZGUgPSBBbmltYXRlTm9kZTtcclxuXHJcbiAgICBmdW5jdGlvbiBCYXNlTm9kZSh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICAgICAgQmFzZU5vZGUucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50VHlwZSA9IFwibm9kZVwiO1xyXG4gICAgICAgICAgICB0aGlzLnpJbmRleCA9IGp0b3BvLnpJbmRleF9Ob2RlO1xyXG4gICAgICAgICAgICB0aGlzLnRleHQgPSB0ZXh0O1xyXG4gICAgICAgICAgICB0aGlzLmZvbnQgPSBcIjEycHggQ29uc29sYXNcIjtcclxuICAgICAgICAgICAgdGhpcy5mb250Q29sb3IgPSBcIjI1NSwyNTUsMjU1XCI7XHJcbiAgICAgICAgICAgIHRoaXMuYm9yZGVyV2lkdGggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmJvcmRlckNvbG9yID0gXCIyNTUsMjU1LDI1NVwiO1xyXG4gICAgICAgICAgICB0aGlzLmJvcmRlclJhZGl1cyA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhZ2dhYmxlID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dFBvc2l0aW9uID0gXCJCb3R0b21fQ2VudGVyXCI7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dE9mZnNldFggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm1BYmxlID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMuaW5MaW5rcyA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMub3V0TGlua3MgPSBudWxsO1xyXG4gICAgICAgICAgICB2YXIgZCA9IFwidGV4dCxmb250LGZvbnRDb2xvcix0ZXh0UG9zaXRpb24sdGV4dE9mZnNldFgsdGV4dE9mZnNldFksYm9yZGVyUmFkaXVzXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5jb25jYXQoZCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUodGV4dCk7XHJcbiAgICAgICAgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRBbGFybUZsYXNoKGNvbnRleHQpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGdvYmFsQWxwaGEgPSBjb250ZXh0Lmdsb2JhbEFscGhhO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5nbG9iYWxBbHBoYSA9IHRoaXMuYWxwaGE7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmFsYXJtSW1hZ2UgJiYgbnVsbCAhPSB0aGlzLmFsYXJtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UodGhpcy5hbGFybUltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZSh0aGlzLmltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5nbG9iYWxBbHBoYSA9IGdvYmFsQWxwaGE7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5ib3JkZXJSYWRpdXMgfHwgMCA9PSB0aGlzLmJvcmRlclJhZGl1cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LkpUb3BvUm91bmRSZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuYm9yZGVyUmFkaXVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBhaW50VGV4dChjb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEJvcmRlcihjb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEN0cmwoY29udGV4dCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRBbGFybVRleHQoY29udGV4dCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50QWxhcm1UZXh0ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5hbGFybSAmJiBcIlwiICE9IHRoaXMuYWxhcm0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5hbGFybUNvbG9yIHx8IFwiMjU1LDAsMFwiLCBjID0gdGhpcy5hbGFybUFscGhhIHx8IC41O1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKSwgY29udGV4dC5mb250ID0gdGhpcy5hbGFybUZvbnQgfHwgXCIxMHB4IOW+rui9r+mbhem7kVwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBjb250ZXh0Lm1lYXN1cmVUZXh0KHRoaXMuYWxhcm0pLndpZHRoICsgNiwgZSA9IGNvbnRleHQubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGggKyA2LCBmID0gdGhpcy53aWR0aCAvIDIgLSBkIC8gMiwgZyA9IC10aGlzLmhlaWdodCAvIDIgLSBlIC0gODtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyBiICsgXCIsIFwiICsgYyArIFwiKVwiLCBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIGIgKyBcIiwgXCIgKyBjICsgXCIpXCIsIGNvbnRleHQubGluZUNhcCA9IFwicm91bmRcIiwgY29udGV4dC5saW5lV2lkdGggPSAxLCBjb250ZXh0Lm1vdmVUbyhmLCBnKSwgY29udGV4dC5saW5lVG8oZiArIGQsIGcpLCBjb250ZXh0LmxpbmVUbyhmICsgZCwgZyArIGUpLCBjb250ZXh0LmxpbmVUbyhmICsgZCAvIDIgKyA2LCBnICsgZSksIGNvbnRleHQubGluZVRvKGYgKyBkIC8gMiwgZyArIGUgKyA4KSwgY29udGV4dC5saW5lVG8oZiArIGQgLyAyIC0gNiwgZyArIGUpLCBjb250ZXh0LmxpbmVUbyhmLCBnICsgZSksIGNvbnRleHQubGluZVRvKGYsIGcpLCBjb250ZXh0LmZpbGwoKSwgY29udGV4dC5zdHJva2UoKSwgY29udGV4dC5jbG9zZVBhdGgoKSwgY29udGV4dC5iZWdpblBhdGgoKSwgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBjb250ZXh0LmZpbGxUZXh0KHRoaXMuYWxhcm0sIGYgKyAyLCBnICsgZSAtIDQpLCBjb250ZXh0LmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8v6Ieq5a6a5LmJ5paw5aKeLOWQr+eUqOWRiuitpuWQjuavj+asoee7mOeUu+aJp+ihjOS/ruaUuemYtOW9sVxyXG4gICAgICAgIHRoaXMucGFpbnRBbGFybUZsYXNoID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2hhZG93ID09IDEgJiYgdGhpcy5hbGxvd0FsYXJtRmxhc2ggPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hhZG93RGlyZWN0aW9uID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYWRvd0RpcmVjdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtb3ZlKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dCbHVyID0gdGhpcy5zaGFkb3dCbHVyO1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gbW92ZShub2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuc2hhZG93RGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2hhZG93Qmx1ciArPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5zaGFkb3dCbHVyID4gMTAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNoYWRvd0RpcmVjdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNoYWRvd0JsdXIgLT0gNTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuc2hhZG93Qmx1ciA8PSAxMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zaGFkb3dEaXJlY3Rpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy50ZXh0O1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0ZXh0ICYmIFwiXCIgIT0gdGV4dCkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgIHZhciBmb250V2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1heFdpZHRoID0gZm9udFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgLy/mjaLooYzmo4DmtYtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0bGluZXMgPSB0ZXh0LnNwbGl0KFwiXFxuXCIpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0bGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KHRleHRsaW5lc1tpXSkud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdpZHRoID4gbWF4V2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0VGV4dFBvc3Rpb24odGhpcy50ZXh0UG9zaXRpb24sIG1heFdpZHRoLCBmb250V2lkdGgsIHRleHRsaW5lcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0ZXh0bGluZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dFdpZHRoID0gY29udGV4dC5tZWFzdXJlVGV4dCh0ZXh0bGluZXNbal0pLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFRleHQodGV4dGxpbmVzW2pdLCBlLnggKyAobWF4V2lkdGggLSB0ZXh0V2lkdGgpIC8gMiwgZS55ICsgaiAqIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYWludEJvcmRlciA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHRoaXMuYm9yZGVyV2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IHRoaXMuYm9yZGVyV2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5ib3JkZXJDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmJvcmRlcldpZHRoIC8gMjtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsID09IHRoaXMuYm9yZGVyUmFkaXVzIHx8IDAgPT0gdGhpcy5ib3JkZXJSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJlY3QoLXRoaXMud2lkdGggLyAyIC0gYiwgLXRoaXMuaGVpZ2h0IC8gMiAtIGIsIHRoaXMud2lkdGggKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmhlaWdodCArIHRoaXMuYm9yZGVyV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LkpUb3BvUm91bmRSZWN0KC10aGlzLndpZHRoIC8gMiAtIGIsIC10aGlzLmhlaWdodCAvIDIgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoLCB0aGlzLmJvcmRlclJhZGl1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRUZXh0UG9zdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbiwgbWF4V2lkdGgsIGZvbnRXaWR0aCwgdGV4dExpbmVzKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gbnVsbDtcclxuICAgICAgICAgICAgc3dpdGNoIChwb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIkJvdHRvbV9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgICAgICBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OiAtdGhpcy53aWR0aCAvIDIgKyAodGhpcy53aWR0aCAtIG1heFdpZHRoKSAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuaGVpZ2h0IC8gMiArIGZvbnRXaWR0aFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiVG9wX0NlbnRlclwiOlxyXG4gICAgICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IC10aGlzLndpZHRoIC8gMiArICh0aGlzLndpZHRoIC0gbWF4V2lkdGgpIC8gMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogLXRoaXMuaGVpZ2h0IC8gMiAtIGZvbnRXaWR0aCAvIDIgLSBmb250V2lkdGggKiAodGV4dExpbmVzIC0gMSlcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIlRvcF9SaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiAtdGhpcy5oZWlnaHQgLyAyIC0gZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiVG9wX0xlZnRcIjpcclxuICAgICAgICAgICAgICAgICAgICBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OiAtdGhpcy53aWR0aCAvIDIgLSBtYXhXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogLXRoaXMuaGVpZ2h0IC8gMiAtIGZvbnRXaWR0aCAvIDJcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIkJvdHRvbV9SaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmhlaWdodCAvIDIgKyBmb250V2lkdGhcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIkJvdHRvbV9MZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogLXRoaXMud2lkdGggLyAyIC0gbWF4V2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuaGVpZ2h0IC8gMiArIGZvbnRXaWR0aFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiTWlkZGxlX0NlbnRlclwiOlxyXG4gICAgICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IC10aGlzLndpZHRoIC8gMiArICh0aGlzLndpZHRoIC0gbWF4V2lkdGgpIC8gMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogZm9udFdpZHRoIC8gMlxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiTWlkZGxlX1JpZ2h0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IGZvbnRXaWR0aCAvIDJcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBkID0gey8vXCJNaWRkbGVfTGVmdFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IC10aGlzLndpZHRoIC8gMiAtIG1heFdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiBmb250V2lkdGggLyAyXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLnRleHRPZmZzZXRYKSB7XHJcbiAgICAgICAgICAgICAgICBkLnggKz0gdGhpcy50ZXh0T2Zmc2V0WFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMudGV4dE9mZnNldFkpIHtcclxuICAgICAgICAgICAgICAgIGQueSArPSB0aGlzLnRleHRPZmZzZXRZXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNldEltYWdlID0gZnVuY3Rpb24gKHBhcmFtSW1hZ2UsIGFzSW1hZ2VTaXplKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IHBhcmFtSW1hZ2UpdGhyb3cgbmV3IEVycm9yKFwiTm9kZS5zZXRJbWFnZSgpOiDlj4LmlbBJbWFnZeWvueixoeS4uuepuiFcIik7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHBhcmFtSW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbWFnZSA9IGltYWdlQ2FjaGVbcGFyYW1JbWFnZV07XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBpbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2Uuc3JjID0gcGFyYW1JbWFnZTtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlQ2FjaGVbcGFyYW1JbWFnZV0gPSBpbWFnZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdEltYWdlKGltYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGluaXRJbWFnZShpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpbml0SW1hZ2UocGFyYW1JbWFnZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBpbml0SW1hZ2UobmV3SW1hZ2Upe1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbWFnZSA9IG5ld0ltYWdlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5hbGFybUNvbG9yID0gc2VsZi5hbGFybUNvbG9yIHx8IFwiMjU1LDAsMFwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFzSW1hZ2VTaXplPT0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRTaXplKG5ld0ltYWdlLndpZHRoLCBuZXdJbWFnZS5oZWlnaHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucmVtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm91dExpbmtzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm91dExpbmtzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYy5ub2RlQSA9PT0gc2VsZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUoYylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3V0TGlua3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmluTGlua3MpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5MaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYy5ub2RlWiA9PT0gc2VsZiAmJiBzY2VuZS5yZW1vdmUoYylcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbkxpbmtzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gTm9kZSgpIHtcclxuICAgICAgICBOb2RlLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBUZXh0Tm9kZSh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcclxuICAgICAgICB0aGlzLmVsZW1lbnRUeXBlID0gXCJUZXh0Tm9kZVwiO1xyXG4gICAgICAgIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgICAgICAvL+iHquWKqOaNouihjFxyXG4gICAgICAgICAgICB2YXIgdGV4dHMgPSB0aGlzLnRleHQuc3BsaXQoXCJcXG5cIik7XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgdmFyIGZvbnRXaWR0aCA9IGNvbnRleHQubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSAwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRleHRzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KHRleHRzW2pdKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGlmICh3aWR0aCA+IHRoaXMud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0ZXh0cy5sZW5ndGggKiBmb250V2lkdGg7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgIGlmICh0ZXh0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRleHRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dCh0ZXh0c1tpXSwgLXRoaXMud2lkdGggLyAyICsgMC4xNSAqIGZvbnRXaWR0aCwgdGhpcy5oZWlnaHQgLyAyICsgKGkgLSB0ZXh0cy5sZW5ndGggKyAwLjg1KSAqIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRleHRzLCAtdGhpcy53aWR0aCAvIDIgKyAwLjAzICogZm9udFdpZHRoLCB0aGlzLmhlaWdodCAvIDIgLSAwLjE1ICogZm9udFdpZHRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Qm9yZGVyKGNvbnRleHQpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Q3RybChjb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEFsYXJtVGV4dChjb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gTGlua05vZGUoYSwgYiwgYykge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIHRoaXMudGV4dCA9IGE7XHJcbiAgICAgICAgdGhpcy5ocmVmID0gYjtcclxuICAgICAgICB0aGlzLnRhcmdldCA9IGM7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50VHlwZSA9IFwiTGlua05vZGVcIjtcclxuICAgICAgICB0aGlzLmlzVmlzaXRlZCA9ICExO1xyXG4gICAgICAgIHRoaXMudmlzaXRlZENvbG9yID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgYS5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gYS5tZWFzdXJlVGV4dCh0aGlzLnRleHQpLndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVmlzaXRlZCAmJiBudWxsICE9IHRoaXMudmlzaXRlZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy52aXNpdGVkQ29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMudmlzaXRlZENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhLmZpbGxUZXh0KHRoaXMudGV4dCwgLXRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc01vdXNlT3Zlcikge1xyXG4gICAgICAgICAgICAgICAgYS5tb3ZlVG8oLXRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBhLmxpbmVUbyh0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgYS5zdHJva2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Qm9yZGVyKGEpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Q3RybChhKTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEFsYXJtVGV4dChhKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2Vtb3ZlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgaWYgKGEgJiYgYS5sZW5ndGggPiAwKWZvciAodmFyIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKylhW2JdLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5tb3VzZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICAgIGlmIChhICYmIGEubGVuZ3RoID4gMClmb3IgKHZhciBiID0gMDsgYiA8IGEubGVuZ3RoOyBiKyspYVtiXS5zdHlsZS5jdXJzb3IgPSBcImRlZmF1bHRcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBcIl9ibGFua1wiID09IHRoaXMudGFyZ2V0ID8gd2luZG93Lm9wZW4odGhpcy5ocmVmKSA6IGxvY2F0aW9uID0gdGhpcy5ocmVmLCB0aGlzLmlzVmlzaXRlZCA9ICEwXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBDaXJjbGVOb2RlKHRleHQpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLl9yYWRpdXMgPSAyMDtcclxuICAgICAgICB0aGlzLmJlZ2luRGVncmVlID0gMDtcclxuICAgICAgICB0aGlzLmVuZERlZ3JlZSA9IDIgKiBNYXRoLlBJO1xyXG4gICAgICAgIHRoaXMudGV4dCA9IHRleHQ7XHJcbiAgICAgICAgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMucmFkaXVzLCB0aGlzLmJlZ2luRGVncmVlLCB0aGlzLmVuZERlZ3JlZSwgITApO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRUZXh0KGNvbnRleHQpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Qm9yZGVyKGNvbnRleHQpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Q3RybChjb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEFsYXJtVGV4dChjb250ZXh0KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCJyZ2JhKDE2OCwyMDIsMjU1LCAwLjkpXCI7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKDE2OCwyMDIsMjM2LDAuNylcIjtcclxuICAgICAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5yYWRpdXMgKyAzLCB0aGlzLmJlZ2luRGVncmVlLCB0aGlzLmVuZERlZ3JlZSwgITApO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFuaW1hdGVCYXNlTm9kZUEoZnJhbWVJbWFnZXMsIGIsIGMpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICAgICAgICB0aGlzLmZyYW1lSW1hZ2VzID0gZnJhbWVJbWFnZXMgfHwgW107XHJcbiAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLmlzU3RvcCA9ICEwO1xyXG4gICAgICAgIHZhciBkID0gYiB8fCAxZTM7XHJcbiAgICAgICAgdGhpcy5yZXBlYXRQbGF5ID0gITE7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubmV4dEZyYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNTdG9wICYmIG51bGwgIT0gdGhpcy5mcmFtZUltYWdlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZnJhbWVJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZnJhbWVJbmRleCA+PSB0aGlzLmZyYW1lSW1hZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yZXBlYXRQbGF5KXJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lSW5kZXggPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRJbWFnZSh0aGlzLmZyYW1lSW1hZ2VzW3RoaXMuZnJhbWVJbmRleF0sIGMpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5uZXh0RnJhbWUoKTtcclxuICAgICAgICAgICAgICAgIH0sIGQgLyBmcmFtZUltYWdlcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFuaW1hdGVCYXNlTm9kZUIoYSwgYiwgYywgZCwgZSkge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIHZhciBmID0gdGhpcztcclxuICAgICAgICB0aGlzLnNldEltYWdlKGEpLCB0aGlzLmZyYW1lSW5kZXggPSAwLCB0aGlzLmlzUGF1c2UgPSAhMCwgdGhpcy5yZXBlYXRQbGF5ID0gITE7XHJcbiAgICAgICAgdmFyIGcgPSBkIHx8IDFlMztcclxuICAgICAgICBlID0gZSB8fCAwLCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy53aWR0aCwgZCA9IHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gKE1hdGguZmxvb3IodGhpcy5mcmFtZUluZGV4IC8gYykgKyBlKSAqIGQsIGcgPSBNYXRoLmZsb29yKHRoaXMuZnJhbWVJbmRleCAlIGMpICogYjtcclxuICAgICAgICAgICAgICAgIGEuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIGcsIGYsIGIsIGQsIC1iIC8gMiwgLWQgLyAyLCBiLCBkKSwgYS5maWxsKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpLCB0aGlzLnBhaW50VGV4dChhKSwgdGhpcy5wYWludEJvcmRlcihhKSwgdGhpcy5wYWludEN0cmwoYSksIHRoaXMucGFpbnRBbGFybVRleHQoYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMubmV4dEZyYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNTdG9wKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mcmFtZUluZGV4KyssIHRoaXMuZnJhbWVJbmRleCA+PSBiICogYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yZXBlYXRQbGF5KXJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lSW5kZXggPSAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmLmlzU3RvcCB8fCBmLm5leHRGcmFtZSgpXHJcbiAgICAgICAgICAgICAgICB9LCBnIC8gKGIgKiBjKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBBbmltYXRlTm9kZSgpIHtcclxuICAgICAgICB2YXIgYSA9IG51bGw7XHJcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPD0gMykge1xyXG4gICAgICAgICAgICBhID0gbmV3IGFuaW1hdGVCYXNlTm9kZUEoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYSA9IG5ldyBhbmltYXRlQmFzZU5vZGVCKGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0sIGFyZ3VtZW50c1szXSwgYXJndW1lbnRzWzRdLCBhcmd1bWVudHNbNV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhLnN0b3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGEuaXNTdG9wID0gITBcclxuICAgICAgICB9O1xyXG4gICAgICAgIGEucGxheSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYS5pc1N0b3AgPSAhMTtcclxuICAgICAgICAgICAgYS5mcmFtZUluZGV4ID0gMDtcclxuICAgICAgICAgICAgYS5uZXh0RnJhbWUoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBhXHJcbiAgICB9XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvbm9kZS5qc1xuLy8gbW9kdWxlIGlkID0gNDNcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval('module.exports = function (jtopo) {\r\n    function Scene(c) {\r\n        function d(a, b, c, d) {\r\n            return function (context) {\r\n                context.beginPath();\r\n                context.strokeStyle = "rgba(0,0,236,0.5)";\r\n                context.fillStyle = "rgba(0,0,236,0.1)";\r\n                context.rect(a, b, c, d);\r\n                context.fill();\r\n                context.stroke();\r\n                context.closePath();\r\n            }\r\n        }\r\n\r\n        var scene_self = this;\r\n        this.initialize = function () {\r\n            Scene.prototype.initialize.apply(this, arguments);\r\n            this.messageBus = new jtopo.util.MessageBus;\r\n            this.elementType = "scene";\r\n            this.childs = [];\r\n            this.zIndexMap = {};\r\n            this.zIndexArray = [];\r\n            this.backgroundColor = "255,255,255";\r\n            this.visible = !0;\r\n            this.alpha = 0;\r\n            this.scaleX = 1;\r\n            this.scaleY = 1;\r\n            this.mode = jtopo.SceneMode.normal;\r\n            this.translate = !0;\r\n            this.translateX = 0;\r\n            this.translateY = 0;\r\n            this.lastTranslateX = 0;\r\n            this.lastTranslateY = 0;\r\n            this.mouseDown = !1;\r\n            this.mouseDownX = null;\r\n            this.mouseDownY = null;\r\n            this.mouseDownEvent = null;\r\n            this.areaSelect = !0;\r\n            this.operations = [];\r\n            this.selectedElements = [];\r\n            this.paintAll = !1;\r\n            var c = "background,backgroundColor,mode,paintAll,areaSelect,translate,translateX,translateY,lastTranslatedX,lastTranslatedY,alpha,visible,scaleX,scaleY".split(",");\r\n            this.serializedProperties = this.serializedProperties.concat(c);\r\n        };\r\n        this.initialize();\r\n        this.setBackground = function (a) {\r\n            this.background = a\r\n        };\r\n        this.addTo = function (a) {\r\n            this.stage !== a && null != a && (this.stage = a)\r\n        };\r\n        null != c && (c.add(this), this.addTo(c)), this.show = function () {\r\n            this.visible = !0\r\n        };\r\n        this.hide = function () {\r\n            this.visible = !1\r\n        };\r\n        this.paint = function (context) {\r\n            if (0 != this.visible && null != this.stage) {\r\n                context.save();\r\n                this.paintBackgroud(context);\r\n                context.restore();\r\n                context.save();\r\n                context.scale(this.scaleX, this.scaleY);\r\n                if (1 == this.translate) {\r\n                    var b = this.getOffsetTranslate();\r\n                    context.translate(b.translateX, b.translateY)\r\n                }\r\n                this.paintChilds(context);\r\n                context.restore();\r\n                context.save();\r\n                this.paintOperations(context, this.operations);\r\n                context.restore();\r\n            }\r\n        };\r\n        this.repaint = function (a) {\r\n            0 != this.visible && this.paint(a)\r\n        };\r\n        this.paintBackgroud = function (a) {\r\n            null != this.background ? a.drawImage(this.background, 0, 0, a.canvas.width, a.canvas.height) : (a.beginPath(), a.fillStyle = "rgba(" + this.backgroundColor + "," + this.alpha + ")", a.fillRect(0, 0, a.canvas.width, a.canvas.height), a.closePath())\r\n        };\r\n        this.getDisplayedElements = function () {\r\n            for (var a = [], b = 0; b < this.zIndexArray.length; b++)for (var c = this.zIndexArray[b], d = this.zIndexMap[c], e = 0; e < d.length; e++) {\r\n                var f = d[e];\r\n                this.isVisiable(f) && a.push(f)\r\n            }\r\n            return a\r\n        };\r\n        this.getDisplayedNodes = function () {\r\n            for (var b = [], c = 0; c < this.childs.length; c++) {\r\n                var d = this.childs[c];\r\n                d instanceof jtopo.Node && this.isVisiable(d) && b.push(d)\r\n            }\r\n            return b\r\n        };\r\n        this.paintChilds = function (context) {\r\n            for (var i = 0; i < this.zIndexArray.length; i++) {\r\n                var zIndex = this.zIndexArray[i];\r\n                var zIndexElements = this.zIndexMap[zIndex];\r\n                for (var j = 0; j < zIndexElements.length; j++) {\r\n                    var element = zIndexElements[j];\r\n                    if (1 == this.paintAll || this.isVisiable(element)) {\r\n                        context.save();\r\n                        if (1 == element.transformAble) {\r\n                            var center = element.getCenterLocation();\r\n                            context.translate(center.x, center.y);\r\n                            if (element.rotate) {\r\n                                context.rotate(element.rotate);\r\n                            }\r\n                            if (element.scaleX && element.scaleY) {\r\n                                context.scale(element.scaleX, element.scaleY)\r\n                            } else if (element.scaleX) {\r\n                                context.scale(element.scaleX, 1);\r\n                            } else if (element.scaleY) {\r\n                                context.scale(1, element.scaleY);\r\n                            }\r\n                        }\r\n                        if (1 == element.shadow) {\r\n                            context.shadowBlur = element.shadowBlur;\r\n                            context.shadowColor = element.shadowColor;\r\n                            context.shadowOffsetX = element.shadowOffsetX;\r\n                            context.shadowOffsetY = element.shadowOffsetY;\r\n                        }\r\n                        if (element instanceof jtopo.InteractiveElement) {\r\n                            if (element.selected && 1 == element.showSelected) {\r\n                                element.paintSelected(context)\r\n                            }\r\n                            if (1 == element.isMouseOver) {\r\n                                element.paintMouseover(context)\r\n                            }\r\n                        }\r\n                        element.paint(context);\r\n                        context.restore();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.getOffsetTranslate = function () {\r\n            var width = this.stage.canvas.width;\r\n            var height = this.stage.canvas.height;\r\n            var centerX = width / this.scaleX / 2;\r\n            var centerY = height / this.scaleY / 2;\r\n            return {\r\n                translateX: this.translateX + (centerX - centerX * this.scaleX),\r\n                translateY: this.translateY + (centerY - centerY * this.scaleY)\r\n            };\r\n        };\r\n        this.isVisiable = function (element) {\r\n            if (1 != element.visible) {\r\n                return !1;\r\n            }\r\n            if (element instanceof jtopo.Link) {\r\n                return !0;\r\n            }\r\n            var sceneOffset = this.getOffsetTranslate();\r\n            var positionX = element.x + sceneOffset.translateX;\r\n            var positionY = element.y + sceneOffset.translateY;\r\n            positionX *= this.scaleX;\r\n            positionY *= this.scaleY;\r\n            var rightX = positionX + element.width * this.scaleX;\r\n            var rightY = positionY + element.height * this.scaleY;\r\n            if (positionX > this.stage.canvas.width || positionY > this.stage.canvas.height || 0 > rightX || 0 > rightY) {\r\n                return !1\r\n            }\r\n            return !0\r\n        };\r\n        this.paintOperations = function (context, options) {\r\n            for (var i = 0; i < options.length; i++) {\r\n                options[i](context);\r\n            }\r\n        };\r\n        this.findElements = function (fn) {\r\n            var result = [];\r\n            for (var i = 0; i < this.childs.length; i++) {\r\n                if (1 == fn(this.childs[i])) {\r\n                    result.push(this.childs[i]);\r\n                }\r\n            }\r\n            return result\r\n        };\r\n        this.getElementsByClass = function (clazz) {\r\n            return this.findElements(function (element) {\r\n                return element instanceof clazz\r\n            })\r\n        };\r\n        this.addOperation = function (a) {\r\n            this.operations.push(a);\r\n            return this;\r\n        };\r\n        this.clearOperations = function () {\r\n            this.operations = [];\r\n            return this;\r\n        };\r\n        this.getElementByXY = function (x, c) {\r\n            var element = null;\r\n            for (var i = this.zIndexArray.length - 1; i >= 0; i--) {\r\n                var zindex = this.zIndexArray[i];\r\n                var elements = this.zIndexMap[zindex];\r\n                for (var h = elements.length - 1; h >= 0; h--) {\r\n                    var el = elements[h];\r\n                    if (el instanceof jtopo.InteractiveElement && this.isVisiable(el) && el.isInBound(x, c)) {\r\n                        return el;\r\n                    }\r\n                }\r\n            }\r\n            return element\r\n        };\r\n        this.add = function (a) {\r\n            this.childs.push(a);\r\n            if (null == this.zIndexMap[a.zIndex]) {\r\n                this.zIndexMap[a.zIndex] = [];\r\n                this.zIndexArray.push(a.zIndex);\r\n                this.zIndexArray.sort(function (a, b) {\r\n                    return a - b\r\n                });\r\n            }\r\n            this.zIndexMap["" + a.zIndex].push(a);\r\n        };\r\n        this.remove = function (item) {\r\n            this.childs = jtopo.util.removeFromArray(this.childs, item);\r\n            var elements = this.zIndexMap[item.zIndex];\r\n            if (elements) {\r\n                this.zIndexMap[item.zIndex] = jtopo.util.removeFromArray(elements, item);\r\n            }\r\n            item.removeHandler(this);\r\n        };\r\n        this.clear = function () {\r\n            var self = this;\r\n            this.childs.forEach(function (child) {\r\n                child.removeHandler(self);\r\n            });\r\n            this.childs = [];\r\n            this.operations = [];\r\n            this.zIndexArray = [];\r\n            this.zIndexMap = {};\r\n        };\r\n        this.addToSelected = function (element) {\r\n            this.selectedElements.push(element);\r\n        };\r\n        this.cancleAllSelected = function (context) {\r\n            for (var i = 0; i < this.selectedElements.length; i++) {\r\n                this.selectedElements[i].unselectedHandler(context);\r\n            }\r\n            this.selectedElements = []\r\n        };\r\n        this.notInSelectedNodes = function (element) {\r\n            for (var i = 0; i < this.selectedElements.length; i++) {\r\n                if (element === this.selectedElements[i]) {\r\n                    return !1;\r\n                }\r\n            }\r\n            return !0\r\n        };\r\n        this.removeFromSelected = function (element) {\r\n            for (var i = 0; i < this.selectedElements.length; i++) {\r\n                if (element === this.selectedElements[i]) {\r\n                    this.selectedElements = this.selectedElements.del(i);\r\n                }\r\n            }\r\n        };\r\n        this.toSceneEvent = function (event) {\r\n            event = jtopo.util.clone(event);\r\n            event.x /= this.scaleX;\r\n            event.y /= this.scaleY;\r\n            if (1 == this.translate) {\r\n                var d = this.getOffsetTranslate();\r\n                event.x -= d.translateX;\r\n                event.y -= d.translateY;\r\n            }\r\n            if (null != event.dx) {\r\n                event.dx /= this.scaleX;\r\n                event.dy /= this.scaleY;\r\n            }\r\n            if (null != this.currentElement) {\r\n                event.target = this.currentElement;\r\n            }\r\n            event.scene = this;\r\n            return event\r\n        };\r\n        this.selectElement = function (event) {\r\n            var element = scene_self.getElementByXY(event.x, event.y);\r\n            if (null != element) {\r\n                event.target = element;\r\n                element.mousedownHander(event);\r\n                element.selectedHandler(event);\r\n                if (scene_self.notInSelectedNodes(element)) {\r\n                    event.ctrlKey || scene_self.cancleAllSelected();\r\n                    scene_self.addToSelected(element);\r\n                } else {\r\n                    if (1 == event.ctrlKey) {\r\n                        element.unselectedHandler();\r\n                        this.removeFromSelected(element);\r\n                    }\r\n                    for (var i = 0; i < this.selectedElements.length; i++) {\r\n                        var selectedElement = this.selectedElements[i];\r\n                        selectedElement.selectedHandler(event)\r\n                    }\r\n                }\r\n            } else {\r\n                event.ctrlKey || scene_self.cancleAllSelected();\r\n            }\r\n            this.currentElement = element\r\n        };\r\n        this.mousedownHandler = function (event) {\r\n            event = this.toSceneEvent(event);\r\n            this.mouseDown = !0;\r\n            this.mouseDownX = event.x;\r\n            this.mouseDownY = event.y;\r\n            this.mouseDownEvent = event;\r\n            switch (this.mode) {\r\n                case jtopo.SceneMode.normal:\r\n                    this.selectElement(event);\r\n                    if ((null == this.currentElement || this.currentElement instanceof jtopo.Link) && 1 == this.translate) {\r\n                        this.lastTranslateX = this.translateX;\r\n                        this.lastTranslateY = this.translateY;\r\n                    }\r\n                    break;\r\n                case jtopo.SceneMode.drag:\r\n                    if (1 == this.translate) {\r\n                        this.lastTranslateX = this.translateX;\r\n                        this.lastTranslateY = this.translateY;\r\n                    }\r\n                    break;\r\n                case jtopo.SceneMode.select:\r\n                    this.selectElement(event);\r\n                    break;\r\n                case jtopo.SceneMode.edit:\r\n                    if ((null == this.currentElement || this.currentElement instanceof jtopo.Link) && 1 == this.translate) {\r\n                        this.lastTranslateX = this.translateX;\r\n                        this.lastTranslateY = this.translateY;\r\n                    }\r\n                    break;\r\n            }\r\n            scene_self.dispatchEvent("mousedown", event)\r\n        };\r\n        this.mouseupHandler = function (event) {\r\n            if (this.stage.cursor != jtopo.MouseCursor.normal) {\r\n                this.stage.cursor = jtopo.MouseCursor.normal;\r\n            }\r\n            scene_self.clearOperations();\r\n            event = this.toSceneEvent(event);\r\n            if (null != this.currentElement) {\r\n                event.target = scene_self.currentElement;\r\n                this.currentElement.mouseupHandler(event);\r\n            }\r\n            this.dispatchEvent("mouseup", event);\r\n            this.mouseDown = !1;\r\n        };\r\n        this.dragElements = function (event) {\r\n            if (null != this.currentElement && 1 == this.currentElement.draggable) {\r\n                for (var i = 0; i < this.selectedElements.length; i++) {\r\n                    var element = this.selectedElements[i];\r\n                    if (0 != element.draggable) {\r\n                        var elEvent = jtopo.util.clone(event);\r\n                        elEvent.target = element;\r\n                        element.mousedragHandler(elEvent);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.mousedragHandler = function (event) {\r\n            var c = this.toSceneEvent(event);\r\n            if (this.mode == jtopo.SceneMode.normal) {\r\n                if (null == this.currentElement || this.currentElement instanceof jtopo.Link) {\r\n                    if (1 == this.translate) {\r\n                        this.stage.cursor = jtopo.MouseCursor.closed_hand;\r\n                        this.translateX = this.lastTranslateX + c.dx;\r\n                        this.translateY = this.lastTranslateY + c.dy;\r\n                    }\r\n                } else {\r\n                    this.dragElements(c);\r\n                }\r\n            } else {\r\n                if (this.mode == jtopo.SceneMode.drag) {\r\n                    if (1 == this.translate) {\r\n                        this.stage.cursor = jtopo.MouseCursor.closed_hand;\r\n                        this.translateX = this.lastTranslateX + c.dx;\r\n                        this.translateY = this.lastTranslateY + c.dy;\r\n                    }\r\n                } else {\r\n                    if (this.mode == jtopo.SceneMode.select) {\r\n                        if (null != this.currentElement) {\r\n                            1 == this.currentElement.draggable && this.dragElements(c);\r\n                        } else {\r\n                            1 == this.areaSelect && this.areaSelectHandle(c);\r\n                        }\r\n                    } else {\r\n                        if (this.mode == jtopo.SceneMode.edit) {\r\n                            if (null == this.currentElement || this.currentElement instanceof jtopo.Link) {\r\n                                if (1 == this.translate) {\r\n                                    this.stage.cursor = jtopo.MouseCursor.closed_hand;\r\n                                    this.translateX = this.lastTranslateX + c.dx;\r\n                                    this.translateY = this.lastTranslateY + c.dy;\r\n                                }\r\n                            } else {\r\n                                this.dragElements(c)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.dispatchEvent("mousedrag", c);\r\n            //this.mode == jtopo.SceneMode.normal ?\r\n            //    null == this.currentElement || this.currentElement instanceof jtopo.Link ? 1 == this.translate && (this.stage.cursor = jtopo.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy)\r\n            //    : this.dragElements(c)\r\n            //    : this.mode == jtopo.SceneMode.drag ? 1 == this.translate && (this.stage.cursor = jtopo.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.mode == jtopo.SceneMode.select ? null != this.currentElement ? 1 == this.currentElement.draggable && this.dragElements(c) : 1 == this.areaSelect && this.areaSelectHandle(c) : this.mode == jtopo.SceneMode.edit && (null == this.currentElement || this.currentElement instanceof jtopo.Link ? 1 == this.translate && (this.stage.cursor = jtopo.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c)), this.dispatchEvent("mousedrag", c)\r\n            //\r\n        };\r\n        this.areaSelectHandle = function (a) {\r\n            var b = a.offsetLeft;\r\n            var c = a.offsetTop;\r\n            var f = this.mouseDownEvent.offsetLeft;\r\n            var g = this.mouseDownEvent.offsetTop;\r\n            var h = b >= f ? f : b;\r\n            var i = c >= g ? g : c;\r\n            var j = Math.abs(a.dx) * this.scaleX;\r\n            var k = Math.abs(a.dy) * this.scaleY;\r\n            var l = new d(h, i, j, k);\r\n            scene_self.clearOperations().addOperation(l), b = a.x, c = a.y, f = this.mouseDownEvent.x, g = this.mouseDownEvent.y, h = b >= f ? f : b, i = c >= g ? g : c, j = Math.abs(a.dx), k = Math.abs(a.dy);\r\n            for (var m = h + j, n = i + k, o = 0; o < scene_self.childs.length; o++) {\r\n                var p = scene_self.childs[o];\r\n                p.x > h && p.x + p.width < m && p.y > i && p.y + p.height < n && scene_self.notInSelectedNodes(p) && (p.selectedHandler(a), scene_self.addToSelected(p))\r\n            }\r\n        };\r\n        this.mousemoveHandler = function (e) {\r\n            this.mousecoord = {\r\n                x: e.x,\r\n                y: e.y\r\n            };\r\n            var event = this.toSceneEvent(e);\r\n            if (this.mode == jtopo.SceneMode.drag) {\r\n                return void(this.stage.cursor = jtopo.MouseCursor.open_hand);\r\n            }\r\n            if (this.mode == jtopo.SceneMode.normal) {\r\n                this.stage.cursor = jtopo.MouseCursor.normal;\r\n            } else if (this.mode == jtopo.SceneMode.select) {\r\n                this.stage.cursor = jtopo.MouseCursor.normal;\r\n            }\r\n\r\n            var element = scene_self.getElementByXY(event.x, event.y);\r\n            if (null != element) {\r\n                if (scene_self.mouseOverelement && scene_self.mouseOverelement !== element) {\r\n                    event.target = element;\r\n                    scene_self.mouseOverelement.mouseoutHandler(event);\r\n                }\r\n                scene_self.mouseOverelement = element;\r\n                if (0 == element.isMouseOver) {\r\n                    event.target = element;\r\n                    element.mouseoverHandler(event);\r\n                    scene_self.dispatchEvent("mouseover", event);\r\n                } else {\r\n                    event.target = element;\r\n                    element.mousemoveHandler(event);\r\n                    scene_self.dispatchEvent("mousemove", event);\r\n                }\r\n            } else {\r\n                if (scene_self.mouseOverelement) {\r\n                    event.target = element;\r\n                    scene_self.mouseOverelement.mouseoutHandler(event);\r\n                    scene_self.mouseOverelement = null;\r\n                    scene_self.dispatchEvent("mouseout", event);\r\n                } else {\r\n                    event.target = null;\r\n                    scene_self.dispatchEvent("mousemove", event)\r\n                }\r\n            }\r\n        };\r\n        this.mouseoverHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mouseover", b)\r\n        };\r\n        this.mouseoutHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mouseout", b)\r\n        };\r\n        this.clickHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.currentElement && (b.target = this.currentElement, this.currentElement.clickHandler(b)), this.dispatchEvent("click", b)\r\n        };\r\n        this.dbclickHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.currentElement ? (b.target = this.currentElement, this.currentElement.dbclickHandler(b)) : scene_self.cancleAllSelected(), this.dispatchEvent("dbclick", b)\r\n        };\r\n        this.mousewheelHandler = function (a) {\r\n            var b = this.toSceneEvent(a);\r\n            this.dispatchEvent("mousewheel", b)\r\n        };\r\n        this.touchstart = this.mousedownHander, this.touchmove = this.mousedragHandler, this.touchend = this.mousedownHander, this.keydownHandler = function (a) {\r\n            this.dispatchEvent("keydown", a)\r\n        };\r\n        this.keyupHandler = function (a) {\r\n            this.dispatchEvent("keyup", a)\r\n        };\r\n        this.addEventListener = function (eventName, fn) {\r\n            var self = this;\r\n            var b = function (e) {\r\n                fn.call(self, e);\r\n            };\r\n            this.messageBus.subscribe(eventName, fn);\r\n            return this;\r\n        };\r\n        this.removeEventListener = function (a, f) {\r\n            this.messageBus.unsubscribe(a, f)\r\n        };\r\n        this.removeAllEventListener = function () {\r\n            this.messageBus = new jtopo.util.MessageBus\r\n        };\r\n        this.dispatchEvent = function (a, b) {\r\n            return this.messageBus.publish(a, b), this\r\n        };\r\n        var f = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), g = this;\r\n        f.forEach(function (a) {\r\n            g[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        });\r\n        this.zoom = function (a, b) {\r\n            null != a && 0 != a && (this.scaleX = a), null != b && 0 != b && (this.scaleY = b)\r\n        };\r\n        this.zoomOut = function (a) {\r\n            0 != a && (null == a && (a = .8), this.scaleX /= a, this.scaleY /= a)\r\n        };\r\n        this.zoomIn = function (a) {\r\n            0 != a && (null == a && (a = .8), this.scaleX *= a, this.scaleY *= a)\r\n        };\r\n        this.getBound = function () {\r\n            return {left: 0, top: 0, right: this.stage.canvas.width, bottom: this.stage.canvas.height, width: this.stage.canvas.width, height: this.stage.canvas.height}\r\n        };\r\n        this.getElementsBound = function () {\r\n            return jtopo.util.getElementsBound(this.childs)\r\n        };\r\n        this.translateToCenter = function (a) {\r\n            var b = this.getElementsBound(), c = this.stage.canvas.width / 2 - (b.left + b.right) / 2, d = this.stage.canvas.height / 2 - (b.top + b.bottom) / 2;\r\n            a && (c = a.canvas.width / 2 - (b.left + b.right) / 2, d = a.canvas.height / 2 - (b.top + b.bottom) / 2), this.translateX = c, this.translateY = d\r\n        };\r\n        this.setCenter = function (a, b) {\r\n            var c = a - this.stage.canvas.width / 2, d = b - this.stage.canvas.height / 2;\r\n            this.translateX = -c, this.translateY = -d\r\n        };\r\n        this.centerAndZoom = function (a, b, c) {\r\n            if (this.translateToCenter(c), null == a || null == b) {\r\n                var d = this.getElementsBound(), e = d.right - d.left, f = d.bottom - d.top, g = this.stage.canvas.width / e, h = this.stage.canvas.height / f;\r\n                c && (g = c.canvas.width / e, h = c.canvas.height / f);\r\n                var i = Math.min(g, h);\r\n                if (i > 1)return;\r\n                this.zoom(i, i)\r\n            }\r\n            this.zoom(a, b)\r\n        };\r\n        this.getCenterLocation = function () {\r\n            return {x: scene_self.stage.canvas.width / 2, y: scene_self.stage.canvas.height / 2}\r\n        };\r\n        this.doLayout = function (a) {\r\n            a && a(this, this.childs)\r\n        };\r\n        return scene_self\r\n    }\r\n\r\n    Scene.prototype = new jtopo.Element;\r\n    var c = {};\r\n    Object.defineProperties(Scene.prototype, {\r\n        background: {\r\n            get: function () {\r\n                return this._background\r\n            },\r\n            set: function (a) {\r\n                if ("string" == typeof a) {\r\n                    var b = c[a];\r\n                    null == b && (b = new Image, b.src = a, b.onload = function () {\r\n                        c[a] = b\r\n                    }), this._background = b\r\n                } else this._background = a\r\n            }\r\n        }\r\n    });\r\n    jtopo.Scene = Scene\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvc2NlbmUuanM/M2JhYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDZCQUE2QixvRUFBb0UsY0FBYztBQUNsSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsd0JBQXdCO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2QkFBNkI7QUFDeEQ7QUFDQTtBQUNBLCtCQUErQiwyQkFBMkI7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLG9CQUFvQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHdCQUF3QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxRQUFRO0FBQzdEO0FBQ0E7QUFDQSxpREFBaUQsUUFBUTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixrQ0FBa0M7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixrQ0FBa0M7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsa0NBQWtDO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxrQ0FBa0M7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGtDQUFrQztBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELDhCQUE4QjtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBIiwiZmlsZSI6IjQ0LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoanRvcG8pIHtcclxuICAgIGZ1bmN0aW9uIFNjZW5lKGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMjM2LDAuNSlcIjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKDAsMCwyMzYsMC4xKVwiO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5yZWN0KGEsIGIsIGMsIGQpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHNjZW5lX3NlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1cztcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50VHlwZSA9IFwic2NlbmVcIjtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy56SW5kZXhNYXAgPSB7fTtcclxuICAgICAgICAgICAgdGhpcy56SW5kZXhBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tncm91bmRDb2xvciA9IFwiMjU1LDI1NSwyNTVcIjtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMuYWxwaGEgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnNjYWxlWCA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMuc2NhbGVZID0gMTtcclxuICAgICAgICAgICAgdGhpcy5tb2RlID0ganRvcG8uU2NlbmVNb2RlLm5vcm1hbDtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUgPSAhMDtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2xhdGVYID0gMDtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2xhdGVZID0gMDtcclxuICAgICAgICAgICAgdGhpcy5sYXN0VHJhbnNsYXRlWCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFRyYW5zbGF0ZVkgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlRG93biA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlRG93blggPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlRG93blkgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlRG93bkV2ZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5hcmVhU2VsZWN0ID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRWxlbWVudHMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEFsbCA9ICExO1xyXG4gICAgICAgICAgICB2YXIgYyA9IFwiYmFja2dyb3VuZCxiYWNrZ3JvdW5kQ29sb3IsbW9kZSxwYWludEFsbCxhcmVhU2VsZWN0LHRyYW5zbGF0ZSx0cmFuc2xhdGVYLHRyYW5zbGF0ZVksbGFzdFRyYW5zbGF0ZWRYLGxhc3RUcmFuc2xhdGVkWSxhbHBoYSx2aXNpYmxlLHNjYWxlWCxzY2FsZVlcIi5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChjKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIHRoaXMuc2V0QmFja2dyb3VuZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IGFcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYWRkVG8gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YWdlICE9PSBhICYmIG51bGwgIT0gYSAmJiAodGhpcy5zdGFnZSA9IGEpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBudWxsICE9IGMgJiYgKGMuYWRkKHRoaXMpLCB0aGlzLmFkZFRvKGMpKSwgdGhpcy5zaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSAhMFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5oaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSAhMVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIGlmICgwICE9IHRoaXMudmlzaWJsZSAmJiBudWxsICE9IHRoaXMuc3RhZ2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEJhY2tncm91ZChjb250ZXh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNjYWxlKHRoaXMuc2NhbGVYLCB0aGlzLnNjYWxlWSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoMSA9PSB0aGlzLnRyYW5zbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5nZXRPZmZzZXRUcmFuc2xhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShiLnRyYW5zbGF0ZVgsIGIudHJhbnNsYXRlWSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRDaGlsZHMoY29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludE9wZXJhdGlvbnMoY29udGV4dCwgdGhpcy5vcGVyYXRpb25zKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlcGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAwICE9IHRoaXMudmlzaWJsZSAmJiB0aGlzLnBhaW50KGEpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50QmFja2dyb3VkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgbnVsbCAhPSB0aGlzLmJhY2tncm91bmQgPyBhLmRyYXdJbWFnZSh0aGlzLmJhY2tncm91bmQsIDAsIDAsIGEuY2FudmFzLndpZHRoLCBhLmNhbnZhcy5oZWlnaHQpIDogKGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsUmVjdCgwLCAwLCBhLmNhbnZhcy53aWR0aCwgYS5jYW52YXMuaGVpZ2h0KSwgYS5jbG9zZVBhdGgoKSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RGlzcGxheWVkRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCB0aGlzLnpJbmRleEFycmF5Lmxlbmd0aDsgYisrKWZvciAodmFyIGMgPSB0aGlzLnpJbmRleEFycmF5W2JdLCBkID0gdGhpcy56SW5kZXhNYXBbY10sIGUgPSAwOyBlIDwgZC5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBkW2VdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1Zpc2lhYmxlKGYpICYmIGEucHVzaChmKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBhXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldERpc3BsYXllZE5vZGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5jaGlsZHNbY107XHJcbiAgICAgICAgICAgICAgICBkIGluc3RhbmNlb2YganRvcG8uTm9kZSAmJiB0aGlzLmlzVmlzaWFibGUoZCkgJiYgYi5wdXNoKGQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFpbnRDaGlsZHMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuekluZGV4QXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciB6SW5kZXggPSB0aGlzLnpJbmRleEFycmF5W2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIHpJbmRleEVsZW1lbnRzID0gdGhpcy56SW5kZXhNYXBbekluZGV4XTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgekluZGV4RWxlbWVudHMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHpJbmRleEVsZW1lbnRzW2pdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgxID09IHRoaXMucGFpbnRBbGwgfHwgdGhpcy5pc1Zpc2lhYmxlKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBlbGVtZW50LnRyYW5zZm9ybUFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBlbGVtZW50LmdldENlbnRlckxvY2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShjZW50ZXIueCwgY2VudGVyLnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucm90YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5yb3RhdGUoZWxlbWVudC5yb3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc2NhbGVYICYmIGVsZW1lbnQuc2NhbGVZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZShlbGVtZW50LnNjYWxlWCwgZWxlbWVudC5zY2FsZVkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuc2NhbGVYKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZShlbGVtZW50LnNjYWxlWCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuc2NhbGVZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZSgxLCBlbGVtZW50LnNjYWxlWSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0gZWxlbWVudC5zaGFkb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IGVsZW1lbnQuc2hhZG93Qmx1cjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Q29sb3IgPSBlbGVtZW50LnNoYWRvd0NvbG9yO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRYID0gZWxlbWVudC5zaGFkb3dPZmZzZXRYO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRZID0gZWxlbWVudC5zaGFkb3dPZmZzZXRZO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YganRvcG8uSW50ZXJhY3RpdmVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5zZWxlY3RlZCAmJiAxID09IGVsZW1lbnQuc2hvd1NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYWludFNlbGVjdGVkKGNvbnRleHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBlbGVtZW50LmlzTW91c2VPdmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYWludE1vdXNlb3Zlcihjb250ZXh0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGFpbnQoY29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRPZmZzZXRUcmFuc2xhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoO1xyXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICB2YXIgY2VudGVyWCA9IHdpZHRoIC8gdGhpcy5zY2FsZVggLyAyO1xyXG4gICAgICAgICAgICB2YXIgY2VudGVyWSA9IGhlaWdodCAvIHRoaXMuc2NhbGVZIC8gMjtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRyYW5zbGF0ZVg6IHRoaXMudHJhbnNsYXRlWCArIChjZW50ZXJYIC0gY2VudGVyWCAqIHRoaXMuc2NhbGVYKSxcclxuICAgICAgICAgICAgICAgIHRyYW5zbGF0ZVk6IHRoaXMudHJhbnNsYXRlWSArIChjZW50ZXJZIC0gY2VudGVyWSAqIHRoaXMuc2NhbGVZKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5pc1Zpc2lhYmxlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKDEgIT0gZWxlbWVudC52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gITE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5MaW5rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gITA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNjZW5lT2Zmc2V0ID0gdGhpcy5nZXRPZmZzZXRUcmFuc2xhdGUoKTtcclxuICAgICAgICAgICAgdmFyIHBvc2l0aW9uWCA9IGVsZW1lbnQueCArIHNjZW5lT2Zmc2V0LnRyYW5zbGF0ZVg7XHJcbiAgICAgICAgICAgIHZhciBwb3NpdGlvblkgPSBlbGVtZW50LnkgKyBzY2VuZU9mZnNldC50cmFuc2xhdGVZO1xyXG4gICAgICAgICAgICBwb3NpdGlvblggKj0gdGhpcy5zY2FsZVg7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uWSAqPSB0aGlzLnNjYWxlWTtcclxuICAgICAgICAgICAgdmFyIHJpZ2h0WCA9IHBvc2l0aW9uWCArIGVsZW1lbnQud2lkdGggKiB0aGlzLnNjYWxlWDtcclxuICAgICAgICAgICAgdmFyIHJpZ2h0WSA9IHBvc2l0aW9uWSArIGVsZW1lbnQuaGVpZ2h0ICogdGhpcy5zY2FsZVk7XHJcbiAgICAgICAgICAgIGlmIChwb3NpdGlvblggPiB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCB8fCBwb3NpdGlvblkgPiB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgfHwgMCA+IHJpZ2h0WCB8fCAwID4gcmlnaHRZKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gITFcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gITBcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGFpbnRPcGVyYXRpb25zID0gZnVuY3Rpb24gKGNvbnRleHQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zW2ldKGNvbnRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmZpbmRFbGVtZW50cyA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICgxID09IGZuKHRoaXMuY2hpbGRzW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRoaXMuY2hpbGRzW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldEVsZW1lbnRzQnlDbGFzcyA9IGZ1bmN0aW9uIChjbGF6eikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kRWxlbWVudHMoZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50IGluc3RhbmNlb2YgY2xhenpcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYWRkT3BlcmF0aW9uID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25zLnB1c2goYSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5jbGVhck9wZXJhdGlvbnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RWxlbWVudEJ5WFkgPSBmdW5jdGlvbiAoeCwgYykge1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSB0aGlzLnpJbmRleEFycmF5Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgemluZGV4ID0gdGhpcy56SW5kZXhBcnJheVtpXTtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IHRoaXMuekluZGV4TWFwW3ppbmRleF07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBoID0gZWxlbWVudHMubGVuZ3RoIC0gMTsgaCA+PSAwOyBoLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSBlbGVtZW50c1toXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBqdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQgJiYgdGhpcy5pc1Zpc2lhYmxlKGVsKSAmJiBlbC5pc0luQm91bmQoeCwgYykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hZGQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5wdXNoKGEpO1xyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLnpJbmRleE1hcFthLnpJbmRleF0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuekluZGV4TWFwW2EuekluZGV4XSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy56SW5kZXhBcnJheS5wdXNoKGEuekluZGV4KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuekluZGV4QXJyYXkuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhIC0gYlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy56SW5kZXhNYXBbXCJcIiArIGEuekluZGV4XS5wdXNoKGEpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZW1vdmUgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcyA9IGp0b3BvLnV0aWwucmVtb3ZlRnJvbUFycmF5KHRoaXMuY2hpbGRzLCBpdGVtKTtcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gdGhpcy56SW5kZXhNYXBbaXRlbS56SW5kZXhdO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudHMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuekluZGV4TWFwW2l0ZW0uekluZGV4XSA9IGp0b3BvLnV0aWwucmVtb3ZlRnJvbUFycmF5KGVsZW1lbnRzLCBpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdGVtLnJlbW92ZUhhbmRsZXIodGhpcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5yZW1vdmVIYW5kbGVyKHNlbGYpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25zID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuekluZGV4QXJyYXkgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy56SW5kZXhNYXAgPSB7fTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYWRkVG9TZWxlY3RlZCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5jYW5jbGVBbGxTZWxlY3RlZCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRWxlbWVudHNbaV0udW5zZWxlY3RlZEhhbmRsZXIoY29udGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEVsZW1lbnRzID0gW11cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubm90SW5TZWxlY3RlZE5vZGVzID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50ID09PSB0aGlzLnNlbGVjdGVkRWxlbWVudHNbaV0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gITE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICEwXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlbW92ZUZyb21TZWxlY3RlZCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCA9PT0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEVsZW1lbnRzID0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmRlbChpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy50b1NjZW5lRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQgPSBqdG9wby51dGlsLmNsb25lKGV2ZW50KTtcclxuICAgICAgICAgICAgZXZlbnQueCAvPSB0aGlzLnNjYWxlWDtcclxuICAgICAgICAgICAgZXZlbnQueSAvPSB0aGlzLnNjYWxlWTtcclxuICAgICAgICAgICAgaWYgKDEgPT0gdGhpcy50cmFuc2xhdGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5nZXRPZmZzZXRUcmFuc2xhdGUoKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnggLT0gZC50cmFuc2xhdGVYO1xyXG4gICAgICAgICAgICAgICAgZXZlbnQueSAtPSBkLnRyYW5zbGF0ZVk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gZXZlbnQuZHgpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LmR4IC89IHRoaXMuc2NhbGVYO1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuZHkgLz0gdGhpcy5zY2FsZVk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5jdXJyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gdGhpcy5jdXJyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBldmVudC5zY2VuZSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiBldmVudFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zZWxlY3RFbGVtZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gc2NlbmVfc2VsZi5nZXRFbGVtZW50QnlYWShldmVudC54LCBldmVudC55KTtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQubW91c2Vkb3duSGFuZGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2VsZWN0ZWRIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIGlmIChzY2VuZV9zZWxmLm5vdEluU2VsZWN0ZWROb2RlcyhlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LmN0cmxLZXkgfHwgc2NlbmVfc2VsZi5jYW5jbGVBbGxTZWxlY3RlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYuYWRkVG9TZWxlY3RlZChlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0gZXZlbnQuY3RybEtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnVuc2VsZWN0ZWRIYW5kbGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRnJvbVNlbGVjdGVkKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRFbGVtZW50ID0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEVsZW1lbnQuc2VsZWN0ZWRIYW5kbGVyKGV2ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LmN0cmxLZXkgfHwgc2NlbmVfc2VsZi5jYW5jbGVBbGxTZWxlY3RlZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVsZW1lbnQgPSBlbGVtZW50XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1vdXNlZG93bkhhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQgPSB0aGlzLnRvU2NlbmVFdmVudChldmVudCk7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VEb3duID0gITA7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VEb3duWCA9IGV2ZW50Lng7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VEb3duWSA9IGV2ZW50Lnk7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VEb3duRXZlbnQgPSBldmVudDtcclxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLm1vZGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UganRvcG8uU2NlbmVNb2RlLm5vcm1hbDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEVsZW1lbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgobnVsbCA9PSB0aGlzLmN1cnJlbnRFbGVtZW50IHx8IHRoaXMuY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5MaW5rKSAmJiAxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFRyYW5zbGF0ZVggPSB0aGlzLnRyYW5zbGF0ZVg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFRyYW5zbGF0ZVkgPSB0aGlzLnRyYW5zbGF0ZVk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBqdG9wby5TY2VuZU1vZGUuZHJhZzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSB0aGlzLnRyYW5zbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RUcmFuc2xhdGVYID0gdGhpcy50cmFuc2xhdGVYO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RUcmFuc2xhdGVZID0gdGhpcy50cmFuc2xhdGVZO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UganRvcG8uU2NlbmVNb2RlLnNlbGVjdDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEVsZW1lbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBqdG9wby5TY2VuZU1vZGUuZWRpdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YganRvcG8uTGluaykgJiYgMSA9PSB0aGlzLnRyYW5zbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RUcmFuc2xhdGVYID0gdGhpcy50cmFuc2xhdGVYO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RUcmFuc2xhdGVZID0gdGhpcy50cmFuc2xhdGVZO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzY2VuZV9zZWxmLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRvd25cIiwgZXZlbnQpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1vdXNldXBIYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YWdlLmN1cnNvciAhPSBqdG9wby5Nb3VzZUN1cnNvci5ub3JtYWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhZ2UuY3Vyc29yID0ganRvcG8uTW91c2VDdXJzb3Iubm9ybWFsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNjZW5lX3NlbGYuY2xlYXJPcGVyYXRpb25zKCk7XHJcbiAgICAgICAgICAgIGV2ZW50ID0gdGhpcy50b1NjZW5lRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC50YXJnZXQgPSBzY2VuZV9zZWxmLmN1cnJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudC5tb3VzZXVwSGFuZGxlcihldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2V1cFwiLCBldmVudCk7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VEb3duID0gITE7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmRyYWdFbGVtZW50cyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50ICYmIDEgPT0gdGhpcy5jdXJyZW50RWxlbWVudC5kcmFnZ2FibGUpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RlZEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT0gZWxlbWVudC5kcmFnZ2FibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsRXZlbnQgPSBqdG9wby51dGlsLmNsb25lKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxFdmVudC50YXJnZXQgPSBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm1vdXNlZHJhZ0hhbmRsZXIoZWxFdmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1vdXNlZHJhZ0hhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChldmVudCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLm5vcm1hbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YganRvcG8uTGluaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhZ2UuY3Vyc29yID0ganRvcG8uTW91c2VDdXJzb3IuY2xvc2VkX2hhbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBjLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmxhc3RUcmFuc2xhdGVZICsgYy5keTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhZ0VsZW1lbnRzKGMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZHJhZykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhZ2UuY3Vyc29yID0ganRvcG8uTW91c2VDdXJzb3IuY2xvc2VkX2hhbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBjLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmxhc3RUcmFuc2xhdGVZICsgYy5keTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLnNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxID09IHRoaXMuY3VycmVudEVsZW1lbnQuZHJhZ2dhYmxlICYmIHRoaXMuZHJhZ0VsZW1lbnRzKGMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA9PSB0aGlzLmFyZWFTZWxlY3QgJiYgdGhpcy5hcmVhU2VsZWN0SGFuZGxlKGMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZWRpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YganRvcG8uTGluaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhZ2UuY3Vyc29yID0ganRvcG8uTW91c2VDdXJzb3IuY2xvc2VkX2hhbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBjLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmxhc3RUcmFuc2xhdGVZICsgYy5keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhZ0VsZW1lbnRzKGMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VkcmFnXCIsIGMpO1xyXG4gICAgICAgICAgICAvL3RoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUubm9ybWFsID9cclxuICAgICAgICAgICAgLy8gICAgbnVsbCA9PSB0aGlzLmN1cnJlbnRFbGVtZW50IHx8IHRoaXMuY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5MaW5rID8gMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBqdG9wby5Nb3VzZUN1cnNvci5jbG9zZWRfaGFuZCwgdGhpcy50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCArIGMuZHgsIHRoaXMudHJhbnNsYXRlWSA9IHRoaXMubGFzdFRyYW5zbGF0ZVkgKyBjLmR5KVxyXG4gICAgICAgICAgICAvLyAgICA6IHRoaXMuZHJhZ0VsZW1lbnRzKGMpXHJcbiAgICAgICAgICAgIC8vICAgIDogdGhpcy5tb2RlID09IGp0b3BvLlNjZW5lTW9kZS5kcmFnID8gMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBqdG9wby5Nb3VzZUN1cnNvci5jbG9zZWRfaGFuZCwgdGhpcy50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCArIGMuZHgsIHRoaXMudHJhbnNsYXRlWSA9IHRoaXMubGFzdFRyYW5zbGF0ZVkgKyBjLmR5KSA6IHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuc2VsZWN0ID8gbnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50ID8gMSA9PSB0aGlzLmN1cnJlbnRFbGVtZW50LmRyYWdnYWJsZSAmJiB0aGlzLmRyYWdFbGVtZW50cyhjKSA6IDEgPT0gdGhpcy5hcmVhU2VsZWN0ICYmIHRoaXMuYXJlYVNlbGVjdEhhbmRsZShjKSA6IHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZWRpdCAmJiAobnVsbCA9PSB0aGlzLmN1cnJlbnRFbGVtZW50IHx8IHRoaXMuY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5MaW5rID8gMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBqdG9wby5Nb3VzZUN1cnNvci5jbG9zZWRfaGFuZCwgdGhpcy50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCArIGMuZHgsIHRoaXMudHJhbnNsYXRlWSA9IHRoaXMubGFzdFRyYW5zbGF0ZVkgKyBjLmR5KSA6IHRoaXMuZHJhZ0VsZW1lbnRzKGMpKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VkcmFnXCIsIGMpXHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFyZWFTZWxlY3RIYW5kbGUgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IGEub2Zmc2V0TGVmdDtcclxuICAgICAgICAgICAgdmFyIGMgPSBhLm9mZnNldFRvcDtcclxuICAgICAgICAgICAgdmFyIGYgPSB0aGlzLm1vdXNlRG93bkV2ZW50Lm9mZnNldExlZnQ7XHJcbiAgICAgICAgICAgIHZhciBnID0gdGhpcy5tb3VzZURvd25FdmVudC5vZmZzZXRUb3A7XHJcbiAgICAgICAgICAgIHZhciBoID0gYiA+PSBmID8gZiA6IGI7XHJcbiAgICAgICAgICAgIHZhciBpID0gYyA+PSBnID8gZyA6IGM7XHJcbiAgICAgICAgICAgIHZhciBqID0gTWF0aC5hYnMoYS5keCkgKiB0aGlzLnNjYWxlWDtcclxuICAgICAgICAgICAgdmFyIGsgPSBNYXRoLmFicyhhLmR5KSAqIHRoaXMuc2NhbGVZO1xyXG4gICAgICAgICAgICB2YXIgbCA9IG5ldyBkKGgsIGksIGosIGspO1xyXG4gICAgICAgICAgICBzY2VuZV9zZWxmLmNsZWFyT3BlcmF0aW9ucygpLmFkZE9wZXJhdGlvbihsKSwgYiA9IGEueCwgYyA9IGEueSwgZiA9IHRoaXMubW91c2VEb3duRXZlbnQueCwgZyA9IHRoaXMubW91c2VEb3duRXZlbnQueSwgaCA9IGIgPj0gZiA/IGYgOiBiLCBpID0gYyA+PSBnID8gZyA6IGMsIGogPSBNYXRoLmFicyhhLmR4KSwgayA9IE1hdGguYWJzKGEuZHkpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBtID0gaCArIGosIG4gPSBpICsgaywgbyA9IDA7IG8gPCBzY2VuZV9zZWxmLmNoaWxkcy5sZW5ndGg7IG8rKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHAgPSBzY2VuZV9zZWxmLmNoaWxkc1tvXTtcclxuICAgICAgICAgICAgICAgIHAueCA+IGggJiYgcC54ICsgcC53aWR0aCA8IG0gJiYgcC55ID4gaSAmJiBwLnkgKyBwLmhlaWdodCA8IG4gJiYgc2NlbmVfc2VsZi5ub3RJblNlbGVjdGVkTm9kZXMocCkgJiYgKHAuc2VsZWN0ZWRIYW5kbGVyKGEpLCBzY2VuZV9zZWxmLmFkZFRvU2VsZWN0ZWQocCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2Vtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2Vjb29yZCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IGUueCxcclxuICAgICAgICAgICAgICAgIHk6IGUueVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgZXZlbnQgPSB0aGlzLnRvU2NlbmVFdmVudChlKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZHJhZykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQodGhpcy5zdGFnZS5jdXJzb3IgPSBqdG9wby5Nb3VzZUN1cnNvci5vcGVuX2hhbmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLm5vcm1hbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFnZS5jdXJzb3IgPSBqdG9wby5Nb3VzZUN1cnNvci5ub3JtYWw7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09IGp0b3BvLlNjZW5lTW9kZS5zZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhZ2UuY3Vyc29yID0ganRvcG8uTW91c2VDdXJzb3Iubm9ybWFsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHNjZW5lX3NlbGYuZ2V0RWxlbWVudEJ5WFkoZXZlbnQueCwgZXZlbnQueSk7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzY2VuZV9zZWxmLm1vdXNlT3ZlcmVsZW1lbnQgJiYgc2NlbmVfc2VsZi5tb3VzZU92ZXJlbGVtZW50ICE9PSBlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZV9zZWxmLm1vdXNlT3ZlcmVsZW1lbnQubW91c2VvdXRIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYubW91c2VPdmVyZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoMCA9PSBlbGVtZW50LmlzTW91c2VPdmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm1vdXNlb3ZlckhhbmRsZXIoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBldmVudCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5tb3VzZW1vdmVIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZV9zZWxmLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW1vdmVcIiwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNjZW5lX3NlbGYubW91c2VPdmVyZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmVfc2VsZi5tb3VzZU92ZXJlbGVtZW50Lm1vdXNlb3V0SGFuZGxlcihldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmVfc2VsZi5tb3VzZU92ZXJlbGVtZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZV9zZWxmLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW91dFwiLCBldmVudCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmVfc2VsZi5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGV2ZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1vdXNlb3ZlckhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMudG9TY2VuZUV2ZW50KGEpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW92ZXJcIiwgYilcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW91c2VvdXRIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYilcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudCAmJiAoYi50YXJnZXQgPSB0aGlzLmN1cnJlbnRFbGVtZW50LCB0aGlzLmN1cnJlbnRFbGVtZW50LmNsaWNrSGFuZGxlcihiKSksIHRoaXMuZGlzcGF0Y2hFdmVudChcImNsaWNrXCIsIGIpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmRiY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudCA/IChiLnRhcmdldCA9IHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMuY3VycmVudEVsZW1lbnQuZGJjbGlja0hhbmRsZXIoYikpIDogc2NlbmVfc2VsZi5jYW5jbGVBbGxTZWxlY3RlZCgpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJkYmNsaWNrXCIsIGIpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1vdXNld2hlZWxIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2V3aGVlbFwiLCBiKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy50b3VjaHN0YXJ0ID0gdGhpcy5tb3VzZWRvd25IYW5kZXIsIHRoaXMudG91Y2htb3ZlID0gdGhpcy5tb3VzZWRyYWdIYW5kbGVyLCB0aGlzLnRvdWNoZW5kID0gdGhpcy5tb3VzZWRvd25IYW5kZXIsIHRoaXMua2V5ZG93bkhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJrZXlkb3duXCIsIGEpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmtleXVwSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImtleXVwXCIsIGEpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBmbikge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBiID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIGZuLmNhbGwoc2VsZiwgZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy5zdWJzY3JpYmUoZXZlbnROYW1lLCBmbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGEsIGYpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnVuc3Vic2NyaWJlKGEsIGYpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlbW92ZUFsbEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyA9IG5ldyBqdG9wby51dGlsLk1lc3NhZ2VCdXNcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VCdXMucHVibGlzaChhLCBiKSwgdGhpc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGYgPSBcImNsaWNrLGRiY2xpY2ssbW91c2Vkb3duLG1vdXNldXAsbW91c2VvdmVyLG1vdXNlb3V0LG1vdXNlbW92ZSxtb3VzZWRyYWcsbW91c2V3aGVlbCx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZCxrZXlkb3duLGtleXVwXCIuc3BsaXQoXCIsXCIpLCBnID0gdGhpcztcclxuICAgICAgICBmLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZ1thXSA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBudWxsICE9IGIgPyB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoYSwgYikgOiB0aGlzLmRpc3BhdGNoRXZlbnQoYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuem9vbSA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIG51bGwgIT0gYSAmJiAwICE9IGEgJiYgKHRoaXMuc2NhbGVYID0gYSksIG51bGwgIT0gYiAmJiAwICE9IGIgJiYgKHRoaXMuc2NhbGVZID0gYilcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuem9vbU91dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIDAgIT0gYSAmJiAobnVsbCA9PSBhICYmIChhID0gLjgpLCB0aGlzLnNjYWxlWCAvPSBhLCB0aGlzLnNjYWxlWSAvPSBhKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy56b29tSW4gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAwICE9IGEgJiYgKG51bGwgPT0gYSAmJiAoYSA9IC44KSwgdGhpcy5zY2FsZVggKj0gYSwgdGhpcy5zY2FsZVkgKj0gYSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0Qm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7bGVmdDogMCwgdG9wOiAwLCByaWdodDogdGhpcy5zdGFnZS5jYW52YXMud2lkdGgsIGJvdHRvbTogdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0LCB3aWR0aDogdGhpcy5zdGFnZS5jYW52YXMud2lkdGgsIGhlaWdodDogdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0fVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRFbGVtZW50c0JvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ganRvcG8udXRpbC5nZXRFbGVtZW50c0JvdW5kKHRoaXMuY2hpbGRzKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy50cmFuc2xhdGVUb0NlbnRlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy5nZXRFbGVtZW50c0JvdW5kKCksIGMgPSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCAvIDIgLSAoYi5sZWZ0ICsgYi5yaWdodCkgLyAyLCBkID0gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0IC8gMiAtIChiLnRvcCArIGIuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgICAgIGEgJiYgKGMgPSBhLmNhbnZhcy53aWR0aCAvIDIgLSAoYi5sZWZ0ICsgYi5yaWdodCkgLyAyLCBkID0gYS5jYW52YXMuaGVpZ2h0IC8gMiAtIChiLnRvcCArIGIuYm90dG9tKSAvIDIpLCB0aGlzLnRyYW5zbGF0ZVggPSBjLCB0aGlzLnRyYW5zbGF0ZVkgPSBkXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNldENlbnRlciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gYSAtIHRoaXMuc3RhZ2UuY2FudmFzLndpZHRoIC8gMiwgZCA9IGIgLSB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVggPSAtYywgdGhpcy50cmFuc2xhdGVZID0gLWRcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY2VudGVyQW5kWm9vbSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zbGF0ZVRvQ2VudGVyKGMpLCBudWxsID09IGEgfHwgbnVsbCA9PSBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0RWxlbWVudHNCb3VuZCgpLCBlID0gZC5yaWdodCAtIGQubGVmdCwgZiA9IGQuYm90dG9tIC0gZC50b3AsIGcgPSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCAvIGUsIGggPSB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyBmO1xyXG4gICAgICAgICAgICAgICAgYyAmJiAoZyA9IGMuY2FudmFzLndpZHRoIC8gZSwgaCA9IGMuY2FudmFzLmhlaWdodCAvIGYpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBNYXRoLm1pbihnLCBoKTtcclxuICAgICAgICAgICAgICAgIGlmIChpID4gMSlyZXR1cm47XHJcbiAgICAgICAgICAgICAgICB0aGlzLnpvb20oaSwgaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnpvb20oYSwgYilcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0Q2VudGVyTG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7eDogc2NlbmVfc2VsZi5zdGFnZS5jYW52YXMud2lkdGggLyAyLCB5OiBzY2VuZV9zZWxmLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyAyfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5kb0xheW91dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGEgJiYgYSh0aGlzLCB0aGlzLmNoaWxkcylcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzY2VuZV9zZWxmXHJcbiAgICB9XHJcblxyXG4gICAgU2NlbmUucHJvdG90eXBlID0gbmV3IGp0b3BvLkVsZW1lbnQ7XHJcbiAgICB2YXIgYyA9IHt9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoU2NlbmUucHJvdG90eXBlLCB7XHJcbiAgICAgICAgYmFja2dyb3VuZDoge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBjW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgIG51bGwgPT0gYiAmJiAoYiA9IG5ldyBJbWFnZSwgYi5zcmMgPSBhLCBiLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY1thXSA9IGJcclxuICAgICAgICAgICAgICAgICAgICB9KSwgdGhpcy5fYmFja2dyb3VuZCA9IGJcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB0aGlzLl9iYWNrZ3JvdW5kID0gYVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBqdG9wby5TY2VuZSA9IFNjZW5lXHJcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9qdG9wby9lbGVtZW50cy9zY2VuZS5qc1xuLy8gbW9kdWxlIGlkID0gNDRcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval('module.exports=function (jtopo) {\r\n    function PieChartNode() {\r\n        var b = new jtopo.CircleNode;\r\n        return b.radius = 150, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n            var c = 2 * b.radius, d = 2 * b.radius;\r\n            b.width = c, b.height = d;\r\n            for (var e = 0, f = 0; f < this.datas.length; f++) {\r\n                var g = this.datas[f] * Math.PI * 2;\r\n                a.save(), a.beginPath(), a.fillStyle = b.colors[f], a.moveTo(0, 0), a.arc(0, 0, this.radius, e, e + g, !1), a.fill(), a.closePath(), a.restore(), a.beginPath(), a.font = this.font;\r\n                var h = this.titles[f] + ": " + (100 * this.datas[f]).toFixed(2) + "%", i = a.measureText(h).width, j = (a.measureText("田").width, (e + e + g) / 2), k = this.radius * Math.cos(j), l = this.radius * Math.sin(j);\r\n                j > Math.PI / 2 && j <= Math.PI ? k -= i : j > Math.PI && j < 2 * Math.PI * 3 / 4 ? k -= i : j > 2 * Math.PI * .75, a.fillStyle = "#FFFFFF", a.fillText(h, k, l), a.moveTo(this.radius * Math.cos(j), this.radius * Math.sin(j)), j > Math.PI / 2 && j < 2 * Math.PI * 3 / 4 && (k -= i), j > Math.PI, a.fill(), a.stroke(), a.closePath(), e += g\r\n            }\r\n        }, b\r\n    }\r\n\r\n    function BarChartNode() {\r\n        var b = new jtopo.Node;\r\n        return b.showSelected = !1, b.width = 250, b.height = 180, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n            var c = 3, d = (this.width - c) / this.datas.length;\r\n            a.save(), a.beginPath(), a.fillStyle = "#FFFFFF", a.strokeStyle = "#FFFFFF", a.moveTo(-this.width / 2 - 1, -this.height / 2), a.lineTo(-this.width / 2 - 1, this.height / 2 + 3), a.lineTo(this.width / 2 + c + 1, this.height / 2 + 3), a.stroke(), a.closePath(), a.restore();\r\n            for (var e = 0; e < this.datas.length; e++) {\r\n                a.save(), a.beginPath(), a.fillStyle = b.colors[e];\r\n                var f = this.datas[e], g = e * (d + c) - this.width / 2, h = this.height - f - this.height / 2;\r\n                a.fillRect(g, h, d, f);\r\n                var i = "" + parseInt(this.datas[e]), j = a.measureText(i).width, k = a.measureText("田").width;\r\n                a.fillStyle = "#FFFFFF", a.fillText(i, g + (d - j) / 2, h - k), a.fillText(this.titles[e], g + (d - j) / 2, this.height / 2 + k), a.fill(), a.closePath(), a.restore()\r\n            }\r\n        }, b\r\n    }\r\n\r\n    jtopo.BarChartNode = BarChartNode;\r\n    jtopo.PieChartNode = PieChartNode;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvc3BlY2lhbE5vZGUuanM/YTgxOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsdUJBQXVCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix1QkFBdUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQSIsImZpbGUiOiI0NS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzPWZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAgZnVuY3Rpb24gUGllQ2hhcnROb2RlKCkge1xyXG4gICAgICAgIHZhciBiID0gbmV3IGp0b3BvLkNpcmNsZU5vZGU7XHJcbiAgICAgICAgcmV0dXJuIGIucmFkaXVzID0gMTUwLCBiLmNvbG9ycyA9IFtcIiMzNjY2QjBcIiwgXCIjMkNBOEUwXCIsIFwiIzc3RDFGNlwiXSwgYi5kYXRhcyA9IFsuMywgLjMsIC40XSwgYi50aXRsZXMgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIl0sIGIucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IDIgKiBiLnJhZGl1cywgZCA9IDIgKiBiLnJhZGl1cztcclxuICAgICAgICAgICAgYi53aWR0aCA9IGMsIGIuaGVpZ2h0ID0gZDtcclxuICAgICAgICAgICAgZm9yICh2YXIgZSA9IDAsIGYgPSAwOyBmIDwgdGhpcy5kYXRhcy5sZW5ndGg7IGYrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGcgPSB0aGlzLmRhdGFzW2ZdICogTWF0aC5QSSAqIDI7XHJcbiAgICAgICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBiLmNvbG9yc1tmXSwgYS5tb3ZlVG8oMCwgMCksIGEuYXJjKDAsIDAsIHRoaXMucmFkaXVzLCBlLCBlICsgZywgITEpLCBhLmZpbGwoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKCksIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgIHZhciBoID0gdGhpcy50aXRsZXNbZl0gKyBcIjogXCIgKyAoMTAwICogdGhpcy5kYXRhc1tmXSkudG9GaXhlZCgyKSArIFwiJVwiLCBpID0gYS5tZWFzdXJlVGV4dChoKS53aWR0aCwgaiA9IChhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoLCAoZSArIGUgKyBnKSAvIDIpLCBrID0gdGhpcy5yYWRpdXMgKiBNYXRoLmNvcyhqKSwgbCA9IHRoaXMucmFkaXVzICogTWF0aC5zaW4oaik7XHJcbiAgICAgICAgICAgICAgICBqID4gTWF0aC5QSSAvIDIgJiYgaiA8PSBNYXRoLlBJID8gayAtPSBpIDogaiA+IE1hdGguUEkgJiYgaiA8IDIgKiBNYXRoLlBJICogMyAvIDQgPyBrIC09IGkgOiBqID4gMiAqIE1hdGguUEkgKiAuNzUsIGEuZmlsbFN0eWxlID0gXCIjRkZGRkZGXCIsIGEuZmlsbFRleHQoaCwgaywgbCksIGEubW92ZVRvKHRoaXMucmFkaXVzICogTWF0aC5jb3MoaiksIHRoaXMucmFkaXVzICogTWF0aC5zaW4oaikpLCBqID4gTWF0aC5QSSAvIDIgJiYgaiA8IDIgKiBNYXRoLlBJICogMyAvIDQgJiYgKGsgLT0gaSksIGogPiBNYXRoLlBJLCBhLmZpbGwoKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgZSArPSBnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gQmFyQ2hhcnROb2RlKCkge1xyXG4gICAgICAgIHZhciBiID0gbmV3IGp0b3BvLk5vZGU7XHJcbiAgICAgICAgcmV0dXJuIGIuc2hvd1NlbGVjdGVkID0gITEsIGIud2lkdGggPSAyNTAsIGIuaGVpZ2h0ID0gMTgwLCBiLmNvbG9ycyA9IFtcIiMzNjY2QjBcIiwgXCIjMkNBOEUwXCIsIFwiIzc3RDFGNlwiXSwgYi5kYXRhcyA9IFsuMywgLjMsIC40XSwgYi50aXRsZXMgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIl0sIGIucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IDMsIGQgPSAodGhpcy53aWR0aCAtIGMpIC8gdGhpcy5kYXRhcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIGEuc2F2ZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZpbGxTdHlsZSA9IFwiI0ZGRkZGRlwiLCBhLnN0cm9rZVN0eWxlID0gXCIjRkZGRkZGXCIsIGEubW92ZVRvKC10aGlzLndpZHRoIC8gMiAtIDEsIC10aGlzLmhlaWdodCAvIDIpLCBhLmxpbmVUbygtdGhpcy53aWR0aCAvIDIgLSAxLCB0aGlzLmhlaWdodCAvIDIgKyAzKSwgYS5saW5lVG8odGhpcy53aWR0aCAvIDIgKyBjICsgMSwgdGhpcy5oZWlnaHQgLyAyICsgMyksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHRoaXMuZGF0YXMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgIGEuc2F2ZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZpbGxTdHlsZSA9IGIuY29sb3JzW2VdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSB0aGlzLmRhdGFzW2VdLCBnID0gZSAqIChkICsgYykgLSB0aGlzLndpZHRoIC8gMiwgaCA9IHRoaXMuaGVpZ2h0IC0gZiAtIHRoaXMuaGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFJlY3QoZywgaCwgZCwgZik7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IFwiXCIgKyBwYXJzZUludCh0aGlzLmRhdGFzW2VdKSwgaiA9IGEubWVhc3VyZVRleHQoaSkud2lkdGgsIGsgPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYS5maWxsU3R5bGUgPSBcIiNGRkZGRkZcIiwgYS5maWxsVGV4dChpLCBnICsgKGQgLSBqKSAvIDIsIGggLSBrKSwgYS5maWxsVGV4dCh0aGlzLnRpdGxlc1tlXSwgZyArIChkIC0gaikgLyAyLCB0aGlzLmhlaWdodCAvIDIgKyBrKSwgYS5maWxsKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBiXHJcbiAgICB9XHJcblxyXG4gICAganRvcG8uQmFyQ2hhcnROb2RlID0gQmFyQ2hhcnROb2RlO1xyXG4gICAganRvcG8uUGllQ2hhcnROb2RlID0gUGllQ2hhcnROb2RlO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2VsZW1lbnRzL3NwZWNpYWxOb2RlLmpzXG4vLyBtb2R1bGUgaWQgPSA0NVxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports){eval('module.exports = function (jtopo) {\r\n    function initEagleEye(stage) {\r\n        return {\r\n            hgap: 16,\r\n            visible: !1,\r\n            exportCanvas: document.createElement("canvas"),\r\n            getImage: function (b, c) {\r\n                var d = stage.getBound();\r\n                var e = 1;\r\n                var f = 1;\r\n                this.exportCanvas.width = stage.canvas.width;\r\n                this.exportCanvas.height = stage.canvas.height;\r\n                if (null != b && null != c) {\r\n                    this.exportCanvas.width = b;\r\n                    this.exportCanvas.height = c;\r\n                    e = b / d.width;\r\n                    f = c / d.height;\r\n                } else {\r\n                    if (d.width > stage.canvas.width) {\r\n                        this.exportCanvas.width = d.width;\r\n                    }\r\n                    if (d.height > stage.canvas.height) {\r\n                        this.exportCanvas.height = d.height;\r\n                    }\r\n                }\r\n                var g = this.exportCanvas.getContext("2d");\r\n                if (stage.childs.length > 0) {\r\n                    g.save();\r\n                    g.clearRect(0, 0, this.exportCanvas.width, this.exportCanvas.height);\r\n                    stage.childs.forEach(function (a) {\r\n                        if (1 == a.visible) {\r\n                            a.save();\r\n                            a.translateX = 0;\r\n                            a.translateY = 0;\r\n                            a.scaleX = 1;\r\n                            a.scaleY = 1;\r\n                            g.scale(e, f);\r\n                            if (d.left < 0) {\r\n                                a.translateX = Math.abs(d.left)\r\n                            }\r\n                            if (d.top < 0) {\r\n                                a.translateY = Math.abs(d.top)\r\n                            }\r\n                            a.paintAll = !0;\r\n                            a.repaint(g);\r\n                            a.paintAll = !1;\r\n                            a.restore();\r\n                        }\r\n                    });\r\n                    g.restore();\r\n                }\r\n                return this.exportCanvas.toDataURL("image/png");\r\n            },\r\n            canvas: document.createElement("canvas"),\r\n            update: function () {\r\n                this.eagleImageDatas = this.getData(stage);\r\n            },\r\n            setSize: function (a, b) {\r\n                this.width = this.canvas.width = a;\r\n                this.height = this.canvas.height = b;\r\n            },\r\n            getData: function (b, c) {\r\n                function d(a) {\r\n                    var b = a.stage.canvas.width, c = a.stage.canvas.height, d = b / a.scaleX / 2, e = c / a.scaleY / 2;\r\n                    return {translateX: a.translateX + d - d * a.scaleX, translateY: a.translateY + e - e * a.scaleY}\r\n                }\r\n\r\n                null != j && null != k ? this.setSize(b, c) : this.setSize(200, 160);\r\n                var e = this.canvas.getContext("2d");\r\n                if (stage.childs.length > 0) {\r\n                    e.save(), e.clearRect(0, 0, this.canvas.width, this.canvas.height), stage.childs.forEach(function (a) {\r\n                        1 == a.visible && (a.save(), a.centerAndZoom(null, null, e), a.repaint(e), a.restore())\r\n                    });\r\n                    var f = d(stage.childs[0]), g = f.translateX * (this.canvas.width / stage.canvas.width) * stage.childs[0].scaleX, h = f.translateY * (this.canvas.height / stage.canvas.height) * stage.childs[0].scaleY, i = stage.getBound(), j = stage.canvas.width / stage.childs[0].scaleX / i.width, k = stage.canvas.height / stage.childs[0].scaleY / i.height;\r\n                    j > 1 && (j = 1), k > 1 && (j = 1), g *= j, h *= k, i.left < 0 && (g -= Math.abs(i.left) * (this.width / i.width)), i.top < 0 && (h -= Math.abs(i.top) * (this.height / i.height)), e.save(), e.lineWidth = 1, e.strokeStyle = "rgba(255,0,0,1)", e.strokeRect(-g, -h, e.canvas.width * j, e.canvas.height * k), e.restore();\r\n                    var l = null;\r\n                    try {\r\n                        l = e.getImageData(0, 0, e.canvas.width, e.canvas.height)\r\n                    } catch (m) {\r\n                    }\r\n                    return l\r\n                }\r\n                return null\r\n            },\r\n            paint: function () {\r\n                if (null != this.eagleImageDatas) {\r\n                    var b = stage.graphics;\r\n                    b.save();\r\n                    b.fillStyle = "rgba(211,211,211,0.3)";\r\n                    b.fillRect(stage.canvas.width - this.canvas.width - 2 * this.hgap, stage.canvas.height - this.canvas.height - 1, stage.canvas.width - this.canvas.width, this.canvas.height + 1);\r\n                    b.fill();\r\n                    b.save();\r\n                    b.lineWidth = 1;\r\n                    b.strokeStyle = "rgba(0,0,0,1)";\r\n                    b.rect(stage.canvas.width - this.canvas.width - 2 * this.hgap, stage.canvas.height - this.canvas.height - 1, stage.canvas.width - this.canvas.width, this.canvas.height + 1);\r\n                    b.stroke();\r\n                    b.restore();\r\n                    b.putImageData(this.eagleImageDatas, stage.canvas.width - this.canvas.width - this.hgap, stage.canvas.height - this.canvas.height);\r\n                    b.restore()\r\n                } else {\r\n                    this.eagleImageDatas = this.getData(stage);\r\n                }\r\n            },\r\n            eventHandler: function (a, b, c) {\r\n                var d = b.x, e = b.y;\r\n                if (d > c.canvas.width - this.canvas.width && e > c.canvas.height - this.canvas.height) {\r\n                    if (d = b.x - this.canvas.width, e = b.y - this.canvas.height, "mousedown" == a && (this.lastTranslateX = c.childs[0].translateX, this.lastTranslateY = c.childs[0].translateY), "mousedrag" == a && c.childs.length > 0) {\r\n                        var f = b.dx, g = b.dy, h = c.getBound(), i = this.canvas.width / c.childs[0].scaleX / h.width, j = this.canvas.height / c.childs[0].scaleY / h.height;\r\n                        c.childs[0].translateX = this.lastTranslateX - f / i, c.childs[0].translateY = this.lastTranslateY - g / j\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function stage(canvas) {\r\n        function getEventObject(event) {\r\n            var eventPosition = jtopo.util.getEventPosition(event);\r\n            var offsetPosition = jtopo.util.getOffsetPosition(self.canvas);\r\n            eventPosition.offsetLeft = eventPosition.pageX - offsetPosition.left;\r\n            eventPosition.offsetTop = eventPosition.pageY - offsetPosition.top;\r\n            eventPosition.x = eventPosition.offsetLeft;\r\n            eventPosition.y = eventPosition.offsetTop;\r\n            eventPosition.target = null;\r\n            return eventPosition;\r\n        }\r\n\r\n        function mouseOver(event) {\r\n            document.onselectstart = function () {\r\n                return !1\r\n            }, this.mouseOver = !0;\r\n            var b = getEventObject(event);\r\n            self.dispatchEventToScenes("mouseover", b), self.dispatchEvent("mouseover", b)\r\n        }\r\n\r\n        function mouseOut(a) {\r\n            p = setTimeout(function () {\r\n                o = !0\r\n            }, 500), document.onselectstart = function () {\r\n                return !0\r\n            };\r\n            var b = getEventObject(a);\r\n            self.dispatchEventToScenes("mouseout", b), self.dispatchEvent("mouseout", b), self.needRepaint = 0 == self.animate ? !1 : !0\r\n        }\r\n\r\n        function mouseDown(a) {\r\n            var b = getEventObject(a);\r\n            self.mouseDown = !0, self.mouseDownX = b.x, self.mouseDownY = b.y, self.dispatchEventToScenes("mousedown", b), self.dispatchEvent("mousedown", b)\r\n        }\r\n\r\n        function mouseUp(a) {\r\n            var b = getEventObject(a);\r\n            self.dispatchEventToScenes("mouseup", b), self.dispatchEvent("mouseup", b), self.mouseDown = !1, self.needRepaint = 0 == self.animate ? !1 : !0\r\n        }\r\n\r\n        function mouseMove(event) {\r\n            if (p) {\r\n                window.clearTimeout(p);\r\n                p = null;\r\n            }\r\n            o = !1;\r\n            var b = getEventObject(event);\r\n            if (self.mouseDown) {\r\n                if (0 == event.button) {\r\n                    b.dx = b.x - self.mouseDownX;\r\n                    b.dy = b.y - self.mouseDownY;\r\n                    self.dispatchEventToScenes("mousedrag", b);\r\n                    self.dispatchEvent("mousedrag", b);\r\n                    if (1 == self.eagleEye.visible) {\r\n                        self.eagleEye.update();\r\n                    }\r\n                }\r\n            } else {\r\n                self.dispatchEventToScenes("mousemove", b);\r\n                self.dispatchEvent("mousemove", b);\r\n            }\r\n        }\r\n\r\n        function click(a) {\r\n            var b = getEventObject(a);\r\n            self.dispatchEventToScenes("click", b), self.dispatchEvent("click", b)\r\n        }\r\n\r\n        function dbclick(a) {\r\n            var b = getEventObject(a);\r\n            self.dispatchEventToScenes("dbclick", b), self.dispatchEvent("dbclick", b)\r\n        }\r\n\r\n        function mouseWheel(a) {\r\n            var b = getEventObject(a);\r\n            self.dispatchEventToScenes("mousewheel", b), self.dispatchEvent("mousewheel", b), null != self.wheelZoom && (a.preventDefault ? a.preventDefault() : (a = a || window.event, a.returnValue = !1), 1 == self.eagleEye.visible && self.eagleEye.update())\r\n        }\r\n\r\n        function addEventInCanvas(canvas) {\r\n            if (jtopo.util.isIE || !window.addEventListener) {\r\n                canvas.onmouseout = mouseOut;\r\n                canvas.onmouseover = mouseOver;\r\n                canvas.onmousedown = mouseDown;\r\n                canvas.onmouseup = mouseUp;\r\n                canvas.onmousemove = mouseMove;\r\n                canvas.onclick = click;\r\n                canvas.ondblclick = dbclick;\r\n                canvas.onmousewheel = mouseWheel;\r\n                canvas.touchstart = mouseDown;\r\n                canvas.touchmove = mouseMove;\r\n                canvas.touchend = mouseUp;\r\n            } else {\r\n                canvas.addEventListener("mouseout", mouseOut);\r\n                canvas.addEventListener("mouseover", mouseOver);\r\n                canvas.addEventListener("mousedown", mouseDown);\r\n                canvas.addEventListener("mouseup", mouseUp);\r\n                canvas.addEventListener("mousemove", mouseMove);\r\n                canvas.addEventListener("click", click);\r\n                canvas.addEventListener("dblclick", dbclick);\r\n                if (jtopo.util.isFirefox) {\r\n                    canvas.addEventListener("DOMMouseScroll", mouseWheel);\r\n                } else {\r\n                    canvas.addEventListener("mousewheel", mouseWheel);\r\n                }\r\n            }\r\n            if (window.addEventListener) {\r\n                window.addEventListener("keydown", function (event) {\r\n                    self.dispatchEventToScenes("keydown", jtopo.util.cloneEvent(event));\r\n                    var keyCode = event.keyCode;\r\n                    if (37 == keyCode || 38 == keyCode || 39 == keyCode || 40 == keyCode) {\r\n                        if (event.preventDefault) {\r\n                            event.preventDefault()\r\n                        } else {\r\n                            event = event || window.event;\r\n                            event.returnValue = !1;\r\n                        }\r\n                    }\r\n                }, !0);\r\n                window.addEventListener("keyup", function (event) {\r\n                    self.dispatchEventToScenes("keyup", jtopo.util.cloneEvent(event));\r\n                    var keyCode = event.keyCode;\r\n                    if (37 == keyCode || 38 == keyCode || 39 == keyCode || 40 == keyCode) {\r\n                        if (event.preventDefault) {\r\n                            event.preventDefault()\r\n                        } else {\r\n                            event = event || window.event;\r\n                            event.returnValue = !1;\r\n                        }\r\n                    }\r\n                }, !0);\r\n            }\r\n        }\r\n\r\n        jtopo.stage = this;\r\n        var self = this;\r\n        this.initialize = function (canvas) {\r\n            addEventInCanvas(canvas);\r\n            this.canvas = canvas;\r\n            this.graphics = canvas.getContext("2d");\r\n            this.childs = [];\r\n            this.frames = 24;\r\n            this.messageBus = new jtopo.util.MessageBus;\r\n            this.eagleEye = initEagleEye(this);\r\n            this.wheelZoom = null;\r\n            this.mouseDownX = 0;\r\n            this.mouseDownY = 0;\r\n            this.mouseDown = !1;\r\n            this.mouseOver = !1;\r\n            this.needRepaint = !0;\r\n            this.serializedProperties = ["frames", "wheelZoom"];\r\n        };\r\n        if (null != canvas) {\r\n            this.initialize(canvas);\r\n        }\r\n        var o = !0, p = null;\r\n        document.oncontextmenu = function () {\r\n            return o\r\n        };\r\n        this.dispatchEventToScenes = function (a, b) {\r\n            if (0 != this.frames && (this.needRepaint = !0), 1 == this.eagleEye.visible && -1 != a.indexOf("mouse")) {\r\n                var c = b.x, d = b.y;\r\n                if (c > this.width - this.eagleEye.width && d > this.height - this.eagleEye.height)return void this.eagleEye.eventHandler(a, b, this)\r\n            }\r\n            this.childs.forEach(function (c) {\r\n                if (1 == c.visible) {\r\n                    var d = c[a + "Handler"];\r\n                    if (null == d)throw new Error("Function not found:" + a + "Handler");\r\n                    d.call(c, b)\r\n                }\r\n            })\r\n        };\r\n        this.add = function (scene) {\r\n            for (var i = 0; i < this.childs.length; i++){\r\n                if (this.childs[i] === scene){\r\n                    return;\r\n                }\r\n            }\r\n            scene.addTo(this);\r\n            this.childs.push(scene);\r\n        };\r\n        this.remove = function (scene) {\r\n            if (null == scene)throw new Error("Stage.remove出错: 参数为null!");\r\n            for (var i = 0; i < this.childs.length; i++){\r\n                if (this.childs[i] === scene){\r\n                    scene.stage = null;\r\n                    this.childs = this.childs.del(i);\r\n                    return  this;\r\n                }\r\n            }\r\n            return this\r\n        };\r\n        this.clear = function () {\r\n            this.childs = []\r\n        };\r\n        this.addEventListener = function (eventName, fn) {\r\n            var self = this;\r\n            var b = function (e) {\r\n                fn.call(self, e);\r\n            };\r\n            this.messageBus.subscribe(eventName, fn);\r\n            return this;\r\n        };\r\n        this.removeEventListener = function (a, f) {\r\n            this.messageBus.unsubscribe(a, f)\r\n        };\r\n        this.removeAllEventListener = function () {\r\n            this.messageBus = new jtopo.util.MessageBus();\r\n        };\r\n        this.dispatchEvent = function (a, b) {\r\n            this.messageBus.publish(a, b);\r\n            return this;\r\n        };\r\n        var q = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), r = this;\r\n        q.forEach(function (a) {\r\n            r[a] = function (b) {\r\n                null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n            }\r\n        });\r\n        this.saveImageInfo = function (a, b) {\r\n            var c = this.eagleEye.getImage(a, b), d = window.open("about:blank");\r\n            return d.document.write("<img src=\'" + c + "\' alt=\'from canvas\'/>"), this\r\n        };\r\n        this.saveAsLocalImage = function (a, b) {\r\n            var c = this.eagleEye.getImage(a, b);\r\n            return c.replace("image/png", "image/octet-stream"), window.location.href = c, this\r\n        };\r\n        this.paint = function () {\r\n            if(null != this.canvas){\r\n                this.graphics.save();\r\n                this.graphics.clearRect(0, 0, this.width, this.height);\r\n                this.childs.forEach(function (scene) {\r\n                    if(1 == scene.visible){\r\n                        scene.repaint(self.graphics);\r\n                    }\r\n                });\r\n                if(1 == this.eagleEye.visible){\r\n                    this.eagleEye.paint(this)\r\n                }\r\n                this.graphics.restore();\r\n            }\r\n        };\r\n        this.repaint = function () {\r\n            if(0 != this.frames){\r\n                if(this.frames > 0 || 1 == this.needRepaint){\r\n                    this.paint();\r\n                    if(this.frames < 0){\r\n                        this.needRepaint = !1;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.zoom = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoom(a)\r\n            })\r\n        };\r\n        this.zoomOut = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoomOut(a)\r\n            })\r\n        };\r\n        this.zoomIn = function (a) {\r\n            this.childs.forEach(function (b) {\r\n                0 != b.visible && b.zoomIn(a)\r\n            })\r\n        };\r\n        this.centerAndZoom = function () {\r\n            this.childs.forEach(function (a) {\r\n                0 != a.visible && a.centerAndZoom()\r\n            })\r\n        };\r\n        this.setCenter = function (a, b) {\r\n            var c = this;\r\n            this.childs.forEach(function (d) {\r\n                var e = a - c.canvas.width / 2, f = b - c.canvas.height / 2;\r\n                d.translateX = -e, d.translateY = -f\r\n            })\r\n        };\r\n        this.getBound = function () {\r\n            var bound = {\r\n                left: Number.MAX_VALUE,\r\n                right: Number.MIN_VALUE,\r\n                top: Number.MAX_VALUE,\r\n                bottom: Number.MIN_VALUE\r\n            };\r\n            this.childs.forEach(function (child) {\r\n                var childBound = child.getElementsBound();\r\n                if (childBound.left < bound.left) {\r\n                    bound.left = childBound.left;\r\n                    bound.leftNode = childBound.leftNode\r\n                }\r\n                if (childBound.top < bound.top) {\r\n                    bound.top = childBound.top;\r\n                    bound.topNode = childBound.topNode\r\n                }\r\n                if (childBound.right > bound.right) {\r\n                    bound.right = childBound.right;\r\n                    bound.rightNode = childBound.rightNode\r\n                }\r\n                if (childBound.bottom > bound.bottom) {\r\n                    bound.bottom = childBound.bottom;\r\n                    bound.bottomNode = childBound.bottomNode;\r\n                }\r\n            });\r\n            bound.width = bound.right - bound.left;\r\n            bound.height = bound.bottom - bound.top;\r\n            return bound;\r\n        };\r\n        !function () {\r\n            if (0 == self.frames) {\r\n                setTimeout(arguments.callee, 100);\r\n            } else if (self.frames < 0) {\r\n                self.repaint();\r\n                setTimeout(arguments.callee, 1e3 / -self.frames);\r\n            } else {\r\n                self.repaint();\r\n                setTimeout(arguments.callee, 1e3 / self.frames);\r\n            }\r\n        }();\r\n        self.mousewheel(function (a) {\r\n            var direction = null == a.wheelDelta ? a.detail : a.wheelDelta;\r\n            if (null != self.wheelZoom) {\r\n                if (direction < 0) {\r\n                    self.zoomIn(self.wheelZoom);\r\n                } else {\r\n                    self.zoomOut(self.wheelZoom);\r\n                }\r\n            }\r\n        });\r\n        self.paint();\r\n    }\r\n\r\n    stage.prototype = {\r\n        get width() {\r\n            return this.canvas.width\r\n        }, get height() {\r\n            return this.canvas.height\r\n        }, set cursor(a) {\r\n            this.canvas.style.cursor = a\r\n        }, get cursor() {\r\n            return this.canvas.style.cursor\r\n        }, set mode(a) {\r\n            this.childs.forEach(function (b) {\r\n                b.mode = a\r\n            })\r\n        }\r\n    };\r\n    jtopo.Stage = stage;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvc3RhZ2UuanM/Yjg2MyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsMkJBQTJCLHdCQUF3QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsd0JBQXdCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiNDYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAgZnVuY3Rpb24gaW5pdEVhZ2xlRXllKHN0YWdlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaGdhcDogMTYsXHJcbiAgICAgICAgICAgIHZpc2libGU6ICExLFxyXG4gICAgICAgICAgICBleHBvcnRDYW52YXM6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksXHJcbiAgICAgICAgICAgIGdldEltYWdlOiBmdW5jdGlvbiAoYiwgYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBzdGFnZS5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSAxO1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSAxO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMud2lkdGggPSBzdGFnZS5jYW52YXMud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydENhbnZhcy5oZWlnaHQgPSBzdGFnZS5jYW52YXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gYiAmJiBudWxsICE9IGMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydENhbnZhcy53aWR0aCA9IGI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0ID0gYztcclxuICAgICAgICAgICAgICAgICAgICBlID0gYiAvIGQud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGMgLyBkLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQud2lkdGggPiBzdGFnZS5jYW52YXMud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMud2lkdGggPSBkLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZC5oZWlnaHQgPiBzdGFnZS5jYW52YXMuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0Q2FudmFzLmhlaWdodCA9IGQuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy5leHBvcnRDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YWdlLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZy5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZy5jbGVhclJlY3QoMCwgMCwgdGhpcy5leHBvcnRDYW52YXMud2lkdGgsIHRoaXMuZXhwb3J0Q2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhZ2UuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0gYS52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEudHJhbnNsYXRlWCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnRyYW5zbGF0ZVkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zY2FsZVggPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zY2FsZVkgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5zY2FsZShlLCBmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmxlZnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS50cmFuc2xhdGVYID0gTWF0aC5hYnMoZC5sZWZ0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQudG9wIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEudHJhbnNsYXRlWSA9IE1hdGguYWJzKGQudG9wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5wYWludEFsbCA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5yZXBhaW50KGcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5wYWludEFsbCA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBnLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmV4cG9ydENhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIik7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNhbnZhczogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxcclxuICAgICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVhZ2xlSW1hZ2VEYXRhcyA9IHRoaXMuZ2V0RGF0YShzdGFnZSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldFNpemU6IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5jYW52YXMud2lkdGggPSBhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQgPSBiO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXREYXRhOiBmdW5jdGlvbiAoYiwgYykge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhLnN0YWdlLmNhbnZhcy53aWR0aCwgYyA9IGEuc3RhZ2UuY2FudmFzLmhlaWdodCwgZCA9IGIgLyBhLnNjYWxlWCAvIDIsIGUgPSBjIC8gYS5zY2FsZVkgLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7dHJhbnNsYXRlWDogYS50cmFuc2xhdGVYICsgZCAtIGQgKiBhLnNjYWxlWCwgdHJhbnNsYXRlWTogYS50cmFuc2xhdGVZICsgZSAtIGUgKiBhLnNjYWxlWX1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBudWxsICE9IGogJiYgbnVsbCAhPSBrID8gdGhpcy5zZXRTaXplKGIsIGMpIDogdGhpcy5zZXRTaXplKDIwMCwgMTYwKTtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YWdlLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zYXZlKCksIGUuY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpLCBzdGFnZS5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAxID09IGEudmlzaWJsZSAmJiAoYS5zYXZlKCksIGEuY2VudGVyQW5kWm9vbShudWxsLCBudWxsLCBlKSwgYS5yZXBhaW50KGUpLCBhLnJlc3RvcmUoKSlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGQoc3RhZ2UuY2hpbGRzWzBdKSwgZyA9IGYudHJhbnNsYXRlWCAqICh0aGlzLmNhbnZhcy53aWR0aCAvIHN0YWdlLmNhbnZhcy53aWR0aCkgKiBzdGFnZS5jaGlsZHNbMF0uc2NhbGVYLCBoID0gZi50cmFuc2xhdGVZICogKHRoaXMuY2FudmFzLmhlaWdodCAvIHN0YWdlLmNhbnZhcy5oZWlnaHQpICogc3RhZ2UuY2hpbGRzWzBdLnNjYWxlWSwgaSA9IHN0YWdlLmdldEJvdW5kKCksIGogPSBzdGFnZS5jYW52YXMud2lkdGggLyBzdGFnZS5jaGlsZHNbMF0uc2NhbGVYIC8gaS53aWR0aCwgayA9IHN0YWdlLmNhbnZhcy5oZWlnaHQgLyBzdGFnZS5jaGlsZHNbMF0uc2NhbGVZIC8gaS5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaiA+IDEgJiYgKGogPSAxKSwgayA+IDEgJiYgKGogPSAxKSwgZyAqPSBqLCBoICo9IGssIGkubGVmdCA8IDAgJiYgKGcgLT0gTWF0aC5hYnMoaS5sZWZ0KSAqICh0aGlzLndpZHRoIC8gaS53aWR0aCkpLCBpLnRvcCA8IDAgJiYgKGggLT0gTWF0aC5hYnMoaS50b3ApICogKHRoaXMuaGVpZ2h0IC8gaS5oZWlnaHQpKSwgZS5zYXZlKCksIGUubGluZVdpZHRoID0gMSwgZS5zdHJva2VTdHlsZSA9IFwicmdiYSgyNTUsMCwwLDEpXCIsIGUuc3Ryb2tlUmVjdCgtZywgLWgsIGUuY2FudmFzLndpZHRoICogaiwgZS5jYW52YXMuaGVpZ2h0ICogayksIGUucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsID0gZS5nZXRJbWFnZURhdGEoMCwgMCwgZS5jYW52YXMud2lkdGgsIGUuY2FudmFzLmhlaWdodClcclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwYWludDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5lYWdsZUltYWdlRGF0YXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHN0YWdlLmdyYXBoaWNzO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuZmlsbFN0eWxlID0gXCJyZ2JhKDIxMSwyMTEsMjExLDAuMylcIjtcclxuICAgICAgICAgICAgICAgICAgICBiLmZpbGxSZWN0KHN0YWdlLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoIC0gMiAqIHRoaXMuaGdhcCwgc3RhZ2UuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCAtIDEsIHN0YWdlLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICBiLmZpbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICBiLnNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBiLmxpbmVXaWR0aCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMCwxKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGIucmVjdChzdGFnZS5jYW52YXMud2lkdGggLSB0aGlzLmNhbnZhcy53aWR0aCAtIDIgKiB0aGlzLmhnYXAsIHN0YWdlLmNhbnZhcy5oZWlnaHQgLSB0aGlzLmNhbnZhcy5oZWlnaHQgLSAxLCBzdGFnZS5jYW52YXMud2lkdGggLSB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0ICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBiLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBiLnB1dEltYWdlRGF0YSh0aGlzLmVhZ2xlSW1hZ2VEYXRhcywgc3RhZ2UuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggLSB0aGlzLmhnYXAsIHN0YWdlLmNhbnZhcy5oZWlnaHQgLSB0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGIucmVzdG9yZSgpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWFnbGVJbWFnZURhdGFzID0gdGhpcy5nZXREYXRhKHN0YWdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXZlbnRIYW5kbGVyOiBmdW5jdGlvbiAoYSwgYiwgYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiLngsIGUgPSBiLnk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZCA+IGMuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggJiYgZSA+IGMuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkID0gYi54IC0gdGhpcy5jYW52YXMud2lkdGgsIGUgPSBiLnkgLSB0aGlzLmNhbnZhcy5oZWlnaHQsIFwibW91c2Vkb3duXCIgPT0gYSAmJiAodGhpcy5sYXN0VHJhbnNsYXRlWCA9IGMuY2hpbGRzWzBdLnRyYW5zbGF0ZVgsIHRoaXMubGFzdFRyYW5zbGF0ZVkgPSBjLmNoaWxkc1swXS50cmFuc2xhdGVZKSwgXCJtb3VzZWRyYWdcIiA9PSBhICYmIGMuY2hpbGRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBiLmR4LCBnID0gYi5keSwgaCA9IGMuZ2V0Qm91bmQoKSwgaSA9IHRoaXMuY2FudmFzLndpZHRoIC8gYy5jaGlsZHNbMF0uc2NhbGVYIC8gaC53aWR0aCwgaiA9IHRoaXMuY2FudmFzLmhlaWdodCAvIGMuY2hpbGRzWzBdLnNjYWxlWSAvIGguaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjLmNoaWxkc1swXS50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCAtIGYgLyBpLCBjLmNoaWxkc1swXS50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSAtIGcgLyBqXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHN0YWdlKGNhbnZhcykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldEV2ZW50T2JqZWN0KGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBldmVudFBvc2l0aW9uID0ganRvcG8udXRpbC5nZXRFdmVudFBvc2l0aW9uKGV2ZW50KTtcclxuICAgICAgICAgICAgdmFyIG9mZnNldFBvc2l0aW9uID0ganRvcG8udXRpbC5nZXRPZmZzZXRQb3NpdGlvbihzZWxmLmNhbnZhcyk7XHJcbiAgICAgICAgICAgIGV2ZW50UG9zaXRpb24ub2Zmc2V0TGVmdCA9IGV2ZW50UG9zaXRpb24ucGFnZVggLSBvZmZzZXRQb3NpdGlvbi5sZWZ0O1xyXG4gICAgICAgICAgICBldmVudFBvc2l0aW9uLm9mZnNldFRvcCA9IGV2ZW50UG9zaXRpb24ucGFnZVkgLSBvZmZzZXRQb3NpdGlvbi50b3A7XHJcbiAgICAgICAgICAgIGV2ZW50UG9zaXRpb24ueCA9IGV2ZW50UG9zaXRpb24ub2Zmc2V0TGVmdDtcclxuICAgICAgICAgICAgZXZlbnRQb3NpdGlvbi55ID0gZXZlbnRQb3NpdGlvbi5vZmZzZXRUb3A7XHJcbiAgICAgICAgICAgIGV2ZW50UG9zaXRpb24udGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50UG9zaXRpb247XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtb3VzZU92ZXIoZXZlbnQpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhMVxyXG4gICAgICAgICAgICB9LCB0aGlzLm1vdXNlT3ZlciA9ICEwO1xyXG4gICAgICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGV2ZW50KTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZW92ZXJcIiwgYiksIHNlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbW91c2VPdXQoYSkge1xyXG4gICAgICAgICAgICBwID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBvID0gITBcclxuICAgICAgICAgICAgfSwgNTAwKSwgZG9jdW1lbnQub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGEpO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlb3V0XCIsIGIpLCBzZWxmLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW91dFwiLCBiKSwgc2VsZi5uZWVkUmVwYWludCA9IDAgPT0gc2VsZi5hbmltYXRlID8gITEgOiAhMFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbW91c2VEb3duKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBnZXRFdmVudE9iamVjdChhKTtcclxuICAgICAgICAgICAgc2VsZi5tb3VzZURvd24gPSAhMCwgc2VsZi5tb3VzZURvd25YID0gYi54LCBzZWxmLm1vdXNlRG93blkgPSBiLnksIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2Vkb3duXCIsIGIpLCBzZWxmLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRvd25cIiwgYilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1vdXNlVXAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGEpO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNldXBcIiwgYiksIHNlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNldXBcIiwgYiksIHNlbGYubW91c2VEb3duID0gITEsIHNlbGYubmVlZFJlcGFpbnQgPSAwID09IHNlbGYuYW5pbWF0ZSA/ICExIDogITBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1vdXNlTW92ZShldmVudCkge1xyXG4gICAgICAgICAgICBpZiAocCkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChwKTtcclxuICAgICAgICAgICAgICAgIHAgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG8gPSAhMTtcclxuICAgICAgICAgICAgdmFyIGIgPSBnZXRFdmVudE9iamVjdChldmVudCk7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLm1vdXNlRG93bikge1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgPT0gZXZlbnQuYnV0dG9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5keCA9IGIueCAtIHNlbGYubW91c2VEb3duWDtcclxuICAgICAgICAgICAgICAgICAgICBiLmR5ID0gYi55IC0gc2VsZi5tb3VzZURvd25ZO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2VkcmFnXCIsIGIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlZHJhZ1wiLCBiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBzZWxmLmVhZ2xlRXllLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5lYWdsZUV5ZS51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlbW92ZVwiLCBiKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlbW92ZVwiLCBiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xpY2soYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGEpO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcImNsaWNrXCIsIGIpLCBzZWxmLmRpc3BhdGNoRXZlbnQoXCJjbGlja1wiLCBiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGJjbGljayhhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gZ2V0RXZlbnRPYmplY3QoYSk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwiZGJjbGlja1wiLCBiKSwgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZGJjbGlja1wiLCBiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbW91c2VXaGVlbChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gZ2V0RXZlbnRPYmplY3QoYSk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2V3aGVlbFwiLCBiKSwgc2VsZi5kaXNwYXRjaEV2ZW50KFwibW91c2V3aGVlbFwiLCBiKSwgbnVsbCAhPSBzZWxmLndoZWVsWm9vbSAmJiAoYS5wcmV2ZW50RGVmYXVsdCA/IGEucHJldmVudERlZmF1bHQoKSA6IChhID0gYSB8fCB3aW5kb3cuZXZlbnQsIGEucmV0dXJuVmFsdWUgPSAhMSksIDEgPT0gc2VsZi5lYWdsZUV5ZS52aXNpYmxlICYmIHNlbGYuZWFnbGVFeWUudXBkYXRlKCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhZGRFdmVudEluQ2FudmFzKGNhbnZhcykge1xyXG4gICAgICAgICAgICBpZiAoanRvcG8udXRpbC5pc0lFIHx8ICF3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9ubW91c2VvdXQgPSBtb3VzZU91dDtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNlb3ZlciA9IG1vdXNlT3ZlcjtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNlZG93biA9IG1vdXNlRG93bjtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNldXAgPSBtb3VzZVVwO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9ubW91c2Vtb3ZlID0gbW91c2VNb3ZlO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9uY2xpY2sgPSBjbGljaztcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbmRibGNsaWNrID0gZGJjbGljaztcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNld2hlZWwgPSBtb3VzZVdoZWVsO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLnRvdWNoc3RhcnQgPSBtb3VzZURvd247XHJcbiAgICAgICAgICAgICAgICBjYW52YXMudG91Y2htb3ZlID0gbW91c2VNb3ZlO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLnRvdWNoZW5kID0gbW91c2VVcDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgbW91c2VPdXQpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgbW91c2VPdmVyKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vdXNlRG93bik7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgbW91c2VVcCk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3VzZU1vdmUpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbGljayk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIGRiY2xpY2spO1xyXG4gICAgICAgICAgICAgICAgaWYgKGp0b3BvLnV0aWwuaXNGaXJlZm94KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Nb3VzZVNjcm9sbFwiLCBtb3VzZVdoZWVsKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXdoZWVsXCIsIG1vdXNlV2hlZWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwia2V5ZG93blwiLCBqdG9wby51dGlsLmNsb25lRXZlbnQoZXZlbnQpKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDM3ID09IGtleUNvZGUgfHwgMzggPT0ga2V5Q29kZSB8fCAzOSA9PSBrZXlDb2RlIHx8IDQwID09IGtleUNvZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnJldHVyblZhbHVlID0gITE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCAhMCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwia2V5dXBcIiwganRvcG8udXRpbC5jbG9uZUV2ZW50KGV2ZW50KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleUNvZGUgPSBldmVudC5rZXlDb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgzNyA9PSBrZXlDb2RlIHx8IDM4ID09IGtleUNvZGUgfHwgMzkgPT0ga2V5Q29kZSB8fCA0MCA9PSBrZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5wcmV2ZW50RGVmYXVsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgITApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBqdG9wby5zdGFnZSA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjYW52YXMpIHtcclxuICAgICAgICAgICAgYWRkRXZlbnRJbkNhbnZhcyhjYW52YXMpO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcclxuICAgICAgICAgICAgdGhpcy5ncmFwaGljcyA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWVzID0gMjQ7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyA9IG5ldyBqdG9wby51dGlsLk1lc3NhZ2VCdXM7XHJcbiAgICAgICAgICAgIHRoaXMuZWFnbGVFeWUgPSBpbml0RWFnbGVFeWUodGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMud2hlZWxab29tID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZURvd25YID0gMDtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZURvd25ZID0gMDtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZURvd24gPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZU92ZXIgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5uZWVkUmVwYWludCA9ICEwO1xyXG4gICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gW1wiZnJhbWVzXCIsIFwid2hlZWxab29tXCJdO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG51bGwgIT0gY2FudmFzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZShjYW52YXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbyA9ICEwLCBwID0gbnVsbDtcclxuICAgICAgICBkb2N1bWVudC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50VG9TY2VuZXMgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAoMCAhPSB0aGlzLmZyYW1lcyAmJiAodGhpcy5uZWVkUmVwYWludCA9ICEwKSwgMSA9PSB0aGlzLmVhZ2xlRXllLnZpc2libGUgJiYgLTEgIT0gYS5pbmRleE9mKFwibW91c2VcIikpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gYi54LCBkID0gYi55O1xyXG4gICAgICAgICAgICAgICAgaWYgKGMgPiB0aGlzLndpZHRoIC0gdGhpcy5lYWdsZUV5ZS53aWR0aCAmJiBkID4gdGhpcy5oZWlnaHQgLSB0aGlzLmVhZ2xlRXllLmhlaWdodClyZXR1cm4gdm9pZCB0aGlzLmVhZ2xlRXllLmV2ZW50SGFuZGxlcihhLCBiLCB0aGlzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIGlmICgxID09IGMudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gY1thICsgXCJIYW5kbGVyXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IGQpdGhyb3cgbmV3IEVycm9yKFwiRnVuY3Rpb24gbm90IGZvdW5kOlwiICsgYSArIFwiSGFuZGxlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICBkLmNhbGwoYywgYilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYWRkID0gZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRzW2ldID09PSBzY2VuZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNjZW5lLmFkZFRvKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5wdXNoKHNjZW5lKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucmVtb3ZlID0gZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IHNjZW5lKXRocm93IG5ldyBFcnJvcihcIlN0YWdlLnJlbW92ZeWHuumUmTog5Y+C5pWw5Li6bnVsbCFcIik7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRzW2ldID09PSBzY2VuZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUuc3RhZ2UgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gdGhpcy5jaGlsZHMuZGVsKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAgdGhpcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMgPSBbXVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgZm4pIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgYiA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBmbi5jYWxsKHNlbGYsIGUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGV2ZW50TmFtZSwgZm4pO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhLCBmKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy51bnN1YnNjcmliZShhLCBmKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcganRvcG8udXRpbC5NZXNzYWdlQnVzKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMucHVibGlzaChhLCBiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgcSA9IFwiY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcIi5zcGxpdChcIixcIiksIHIgPSB0aGlzO1xyXG4gICAgICAgIHEuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByW2FdID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gYiA/IHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihhLCBiKSA6IHRoaXMuZGlzcGF0Y2hFdmVudChhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zYXZlSW1hZ2VJbmZvID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmVhZ2xlRXllLmdldEltYWdlKGEsIGIpLCBkID0gd2luZG93Lm9wZW4oXCJhYm91dDpibGFua1wiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGQuZG9jdW1lbnQud3JpdGUoXCI8aW1nIHNyYz0nXCIgKyBjICsgXCInIGFsdD0nZnJvbSBjYW52YXMnLz5cIiksIHRoaXNcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc2F2ZUFzTG9jYWxJbWFnZSA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5lYWdsZUV5ZS5nZXRJbWFnZShhLCBiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGMucmVwbGFjZShcImltYWdlL3BuZ1wiLCBcImltYWdlL29jdGV0LXN0cmVhbVwiKSwgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBjLCB0aGlzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZihudWxsICE9IHRoaXMuY2FudmFzKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhcGhpY3Muc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaGljcy5jbGVhclJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZigxID09IHNjZW5lLnZpc2libGUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5yZXBhaW50KHNlbGYuZ3JhcGhpY3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYoMSA9PSB0aGlzLmVhZ2xlRXllLnZpc2libGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWFnbGVFeWUucGFpbnQodGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhcGhpY3MucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlcGFpbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmKDAgIT0gdGhpcy5mcmFtZXMpe1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5mcmFtZXMgPiAwIHx8IDEgPT0gdGhpcy5uZWVkUmVwYWludCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWludCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZnJhbWVzIDwgMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmVlZFJlcGFpbnQgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuem9vbSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIDAgIT0gYi52aXNpYmxlICYmIGIuem9vbShhKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy56b29tT3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgMCAhPSBiLnZpc2libGUgJiYgYi56b29tT3V0KGEpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnpvb21JbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIDAgIT0gYi52aXNpYmxlICYmIGIuem9vbUluKGEpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNlbnRlckFuZFpvb20gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIDAgIT0gYS52aXNpYmxlICYmIGEuY2VudGVyQW5kWm9vbSgpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNldENlbnRlciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSBhIC0gYy5jYW52YXMud2lkdGggLyAyLCBmID0gYiAtIGMuY2FudmFzLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgICAgICBkLnRyYW5zbGF0ZVggPSAtZSwgZC50cmFuc2xhdGVZID0gLWZcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0Qm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBib3VuZCA9IHtcclxuICAgICAgICAgICAgICAgIGxlZnQ6IE51bWJlci5NQVhfVkFMVUUsXHJcbiAgICAgICAgICAgICAgICByaWdodDogTnVtYmVyLk1JTl9WQUxVRSxcclxuICAgICAgICAgICAgICAgIHRvcDogTnVtYmVyLk1BWF9WQUxVRSxcclxuICAgICAgICAgICAgICAgIGJvdHRvbTogTnVtYmVyLk1JTl9WQUxVRVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkQm91bmQgPSBjaGlsZC5nZXRFbGVtZW50c0JvdW5kKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRCb3VuZC5sZWZ0IDwgYm91bmQubGVmdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvdW5kLmxlZnQgPSBjaGlsZEJvdW5kLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYm91bmQubGVmdE5vZGUgPSBjaGlsZEJvdW5kLmxlZnROb2RlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRCb3VuZC50b3AgPCBib3VuZC50b3ApIHtcclxuICAgICAgICAgICAgICAgICAgICBib3VuZC50b3AgPSBjaGlsZEJvdW5kLnRvcDtcclxuICAgICAgICAgICAgICAgICAgICBib3VuZC50b3BOb2RlID0gY2hpbGRCb3VuZC50b3BOb2RlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRCb3VuZC5yaWdodCA+IGJvdW5kLnJpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm91bmQucmlnaHQgPSBjaGlsZEJvdW5kLnJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGJvdW5kLnJpZ2h0Tm9kZSA9IGNoaWxkQm91bmQucmlnaHROb2RlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRCb3VuZC5ib3R0b20gPiBib3VuZC5ib3R0b20pIHtcclxuICAgICAgICAgICAgICAgICAgICBib3VuZC5ib3R0b20gPSBjaGlsZEJvdW5kLmJvdHRvbTtcclxuICAgICAgICAgICAgICAgICAgICBib3VuZC5ib3R0b21Ob2RlID0gY2hpbGRCb3VuZC5ib3R0b21Ob2RlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYm91bmQud2lkdGggPSBib3VuZC5yaWdodCAtIGJvdW5kLmxlZnQ7XHJcbiAgICAgICAgICAgIGJvdW5kLmhlaWdodCA9IGJvdW5kLmJvdHRvbSAtIGJvdW5kLnRvcDtcclxuICAgICAgICAgICAgcmV0dXJuIGJvdW5kO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgIWZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKDAgPT0gc2VsZi5mcmFtZXMpIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXJndW1lbnRzLmNhbGxlZSwgMTAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLmZyYW1lcyA8IDApIHtcclxuICAgICAgICAgICAgICAgIHNlbGYucmVwYWludCgpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLCAxZTMgLyAtc2VsZi5mcmFtZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yZXBhaW50KCk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFyZ3VtZW50cy5jYWxsZWUsIDFlMyAvIHNlbGYuZnJhbWVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0oKTtcclxuICAgICAgICBzZWxmLm1vdXNld2hlZWwoZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IG51bGwgPT0gYS53aGVlbERlbHRhID8gYS5kZXRhaWwgOiBhLndoZWVsRGVsdGE7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHNlbGYud2hlZWxab29tKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGlyZWN0aW9uIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuem9vbUluKHNlbGYud2hlZWxab29tKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi56b29tT3V0KHNlbGYud2hlZWxab29tKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNlbGYucGFpbnQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGFnZS5wcm90b3R5cGUgPSB7XHJcbiAgICAgICAgZ2V0IHdpZHRoKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXMud2lkdGhcclxuICAgICAgICB9LCBnZXQgaGVpZ2h0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXMuaGVpZ2h0XHJcbiAgICAgICAgfSwgc2V0IGN1cnNvcihhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmN1cnNvciA9IGFcclxuICAgICAgICB9LCBnZXQgY3Vyc29yKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXMuc3R5bGUuY3Vyc29yXHJcbiAgICAgICAgfSwgc2V0IG1vZGUoYSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBiLm1vZGUgPSBhXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGp0b3BvLlN0YWdlID0gc3RhZ2U7XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vZWxlbWVudHMvc3RhZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDQ2XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},function(module,exports){eval('module.exports=function (jtopo) {\r\n    function AnimateObject(fn, time) {\r\n        var intervalId;\r\n        var messageBus = null;\r\n        return {\r\n            stop: function () {\r\n                var self;\r\n                if (intervalId) {\r\n                    window.clearInterval(intervalId);\r\n                    if (messageBus) {\r\n                        messageBus.publish("stop");\r\n                    }\r\n                }\r\n                return this;\r\n            },\r\n            start: function () {\r\n                var self = this;\r\n                intervalId = setInterval(function () {\r\n                    fn.call(self)\r\n                }, time);\r\n                return this\r\n            },\r\n            onStop: function (fn) {\r\n                if (null == messageBus) {\r\n                    messageBus = new jtopo.util.MessageBus();\r\n                }\r\n                messageBus.subscribe("stop", fn);\r\n                return this;\r\n            }\r\n        }\r\n    }\r\n\r\n    function ef_gravity(element, config) {\r\n        config = config || {};\r\n        var gravity = config.gravity || 0.1;\r\n        var DX = config.dx || 0;\r\n        var DY = config.dy || 5;\r\n        var stop = config.stop;\r\n        var h = config.interval || 30;\r\n        return new AnimateObject(function () {\r\n            if (stop && stop()) {\r\n                DY = 0.5;\r\n                this.stop();\r\n            } else {\r\n                DY += gravity;\r\n                element.setLocation(element.x + DX, element.y + DY);\r\n            }\r\n        }, h);\r\n    }\r\n\r\n    function an_stepByStep(target, configs, time, e, f) {\r\n        var intervalTime = 1e3 / 24;\r\n        var temp = {};\r\n        for (var config in configs) {\r\n            var targetValue = configs[config];\r\n            var needValue = targetValue - target[config];\r\n            temp[config] = {\r\n                oldValue: target[config],\r\n                targetValue: targetValue,\r\n                step: needValue / time * intervalTime,\r\n                isDone: function (b) {\r\n                    return this.step > 0 && target[b] >= this.targetValue || this.step < 0 && target[b] <= this.targetValue;\r\n                }\r\n            }\r\n        }\r\n        return new AnimateObject(function () {\r\n            var notDone = !0;\r\n            for (var config in configs) {\r\n                if (!temp[config].isDone(config)) {\r\n                    target[config] += temp[config].step;\r\n                    notDone = !1;\r\n                }\r\n            }\r\n            if (notDone) {\r\n                if (!e) {\r\n                    return this.stop();\r\n                }\r\n                for (var item in configs) {\r\n                    if (f) {\r\n                        var g = temp[item].targetValue;\r\n                        temp[item].targetValue = temp[item].oldValue;\r\n                        temp[item].oldValue = g;\r\n                        temp[item].step = -temp[item].step;\r\n                    } else {\r\n                        target[item] = temp[item].oldValue;\r\n                    }\r\n                }\r\n            }\r\n            return this\r\n        }, intervalTime);\r\n    }\r\n\r\n    function ef_spring(config) {\r\n        config = config || {};\r\n        var sping = config.spring || .1; // 弹性系数\r\n        var friction = config.friction || .8;// 摩擦系数\r\n        var grivity = config.grivity || 0; // 引力大小\r\n        var wind = config.minLength || 0;\r\n        return {\r\n            items: [],\r\n            id: null,\r\n            isPause: !1,\r\n            addNode: function (node, target) {\r\n                var item = {\r\n                    node: node,\r\n                    target: target,\r\n                    vx: 0,\r\n                    vy: 0\r\n                };\r\n                this.items.push(item);\r\n                return this\r\n            },\r\n            play: function (interval) {\r\n                this.stop();\r\n                interval = interval || 1e3 / 24;\r\n                var self = this;\r\n                this.id = setInterval(function () {\r\n                    self.nextFrame()\r\n                }, interval)\r\n            },\r\n            stop: function () {\r\n                window.clearInterval(this.id);\r\n                this.id = null;\r\n            },\r\n            nextFrame: function () {\r\n                for (var i = 0; i < this.items.length; i++) {\r\n                    var item = this.items[i],\r\n                        node = item.node,\r\n                        target = item.target,\r\n                        vx = item.vx,\r\n                        vy = item.vy,\r\n                        disX = target.x - node.x,\r\n                        disY = target.y - node.y,\r\n                        angle = Math.atan2(disY, disX);\r\n                    if (0 != wind) {\r\n                        var n = target.x - Math.cos(angle) * wind,\r\n                            o = target.y - Math.sin(angle) * wind;\r\n                        vx += (n - node.x) * sping;\r\n                        vy += (o - node.y) * sping;\r\n                    } else {\r\n                        vx += disX * sping;\r\n                        vy += disY * sping;\r\n                    }\r\n                    vx *= friction;\r\n                    vy *= friction;\r\n                    vy += grivity;\r\n                    node.x += vx;\r\n                    node.y += vy;\r\n                    item.vx = vx;\r\n                    item.vy = vy;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function an_rotate(a, b) {\r\n        function c() {\r\n            return e = setInterval(function () {\r\n                return stopAnimate ? void f.stop() : (a.rotate += g || .2, void(a.rotate > 2 * Math.PI && (a.rotate = 0)))\r\n            }, 100), f\r\n        }\r\n\r\n        function d() {\r\n            return window.clearInterval(e), f.onStop && f.onStop(a), f\r\n        }\r\n\r\n        var e = (b.context, null), f = {}, g = b.v;\r\n        return f.run = c, f.stop = d, f.onStop = function (a) {\r\n            return f.onStop = a, f\r\n        }, f\r\n    }\r\n\r\n    function an_gravity(a, b) {\r\n        function c() {\r\n            return window.clearInterval(g), h.onStop && h.onStop(a), h\r\n        }\r\n\r\n        function d() {\r\n            var d = b.dx || 0, i = b.dy || 2;\r\n            return g = setInterval(function () {\r\n                return stopAnimate ? void h.stop() : (i += f, void(a.y + a.height < e.stage.canvas.height ? a.setLocation(a.x + d, a.y + i) : (i = 0, c())))\r\n            }, 20), h\r\n        }\r\n\r\n        var e = b.context, f = b.gravity || .1, g = null, h = {};\r\n        return h.run = d, h.stop = c, h.onStop = function (a) {\r\n            return h.onStop = a, h\r\n        }, h\r\n    }\r\n\r\n    function an_dividedTwoPiece(b, c) {\r\n        function d(c, d, e, f, g) {\r\n            var h = new jtopo.Node;\r\n            return h.setImage(b.image), h.setSize(b.width, b.height), h.setLocation(c, d), h.showSelected = !1, h.draggable = !1, h.paint = function (a) {\r\n                a.save(), a.arc(0, 0, e, f, g), a.clip(), a.beginPath(), null != this.image ? a.drawImage(this.image, -this.width / 2, -this.height / 2) : (a.fillStyle = "rgba(" + this.style.fillStyle + "," + this.alpha + ")", a.rect(-this.width / 2, -this.height / 2, this.width / 2, this.height / 2), a.fill()), a.closePath(), a.restore()\r\n            }, h\r\n        }\r\n\r\n        function e(c, e) {\r\n            var f = c, g = c + Math.PI, h = d(b.x, b.y, b.width, f, g), j = d(b.x - 2 + 4 * Math.random(), b.y, b.width, f + Math.PI, f);\r\n            b.visible = !1, e.add(h), e.add(j), jtopo.Animate.gravity(h, {context: e, dx: .3}).run().onStop(function () {\r\n                e.remove(h), e.remove(j), i.stop()\r\n            }), jtopo.Animate.gravity(j, {context: e, dx: -.2}).run()\r\n        }\r\n\r\n        function f() {\r\n            return e(c.angle, h), i\r\n        }\r\n\r\n        function g() {\r\n            return i.onStop && i.onStop(b), i\r\n        }\r\n\r\n        var h = c.context, i = (b.style, {});\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = f, i.stop = g, i\r\n    }\r\n\r\n    function an_repeatThrow(a, b) {\r\n        function c(a) {\r\n            a.visible = !0, a.rotate = Math.random();\r\n            var b = g.stage.canvas.width / 2;\r\n            a.x = b + Math.random() * (b - 100) - Math.random() * (b - 100), a.y = g.stage.canvas.height, a.vx = 5 * Math.random() - 5 * Math.random(), a.vy = -25\r\n        }\r\n\r\n        function d() {\r\n            return c(a), h = setInterval(function () {\r\n                return stopAnimate ? void i.stop() : (a.vy += f, a.x += a.vx, a.y += a.vy, void((a.x < 0 || a.x > g.stage.canvas.width || a.y > g.stage.canvas.height) && (i.onStop && i.onStop(a), c(a))))\r\n            }, 50), i\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(h)\r\n        }\r\n\r\n        var f = .8, g = b.context, h = null, i = {};\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = d, i.stop = e, i\r\n    }\r\n\r\n    function an_stopAll() {\r\n        stopAnimate = !0\r\n    }\r\n\r\n    function an_startAll() {\r\n        stopAnimate = !1\r\n    }\r\n\r\n    function an_cycle(b, c) {\r\n        function d() {\r\n            return n = setInterval(function () {\r\n                if (stopAnimate)return void m.stop();\r\n                var a = f.y + h + Math.sin(k) * j;\r\n                b.setLocation(b.x, a), k += l\r\n            }, 100), m\r\n        }\r\n\r\n        function e() {\r\n            window.clearInterval(n)\r\n        }\r\n\r\n        var f = c.p1, g = c.p2, h = (c.context, f.x + (g.x - f.x) / 2), i = f.y + (g.y - f.y) / 2, j = jtopo.util.getDistance(f, g) / 2, k = Math.atan2(i, h), l = c.speed || .2, m = {}, n = null;\r\n        return m.run = d, m.stop = e, m\r\n    }\r\n\r\n    function an_move(element, config) {\r\n        config = config || {};\r\n        var position = config.position;\r\n        var easing = config.easing || 0.2;\r\n        return {\r\n            id: null,\r\n            run: function () {\r\n                var self = this;\r\n                if (self.id == null) {\r\n                    self.id = setInterval(function () {\r\n                        if (!stopAnimate) {\r\n                            var totalX = position.x - element.x;\r\n                            var totalY = position.y - element.y;\r\n                            var stepX = totalX * easing;\r\n                            var stepY = totalY * easing;\r\n                            element.x += stepX;\r\n                            element.y += stepY;\r\n                            if (0.1 > stepX && 0.1 > stepY) {\r\n                                self.stop();\r\n                            }\r\n                        } else {\r\n                            self.stop()\r\n                        }\r\n                    }, 100);\r\n                }\r\n                return self;\r\n            },\r\n            stop: function () {\r\n                window.clearInterval(this.id);\r\n                this.id = null;\r\n                if (this.onStop && typeof this.onStop == \'function\') {\r\n                    this.onStop();\r\n                }\r\n                return this;\r\n            }\r\n        };\r\n    }\r\n\r\n    function an_scale(a, b) {\r\n        function c() {\r\n            return j = setInterval(function () {\r\n                a.scaleX += f, a.scaleY += f, a.scaleX >= e && d()\r\n            }, 100), i\r\n        }\r\n\r\n        function d() {\r\n            i.onStop && i.onStop(a), a.scaleX = g, a.scaleY = h, window.clearInterval(j)\r\n        }\r\n\r\n        var e = (b.position, b.context, b.scale || 1), f = .06, g = a.scaleX, h = a.scaleY, i = {}, j = null;\r\n        return i.onStop = function (a) {\r\n            return i.onStop = a, i\r\n        }, i.run = c, i.stop = d, i\r\n    }\r\n\r\n    jtopo.Animate = {}, jtopo.Effect = {};\r\n    var stopAnimate = !1;\r\n    jtopo.Effect.spring = ef_spring;\r\n    jtopo.Effect.gravity = ef_gravity;\r\n    jtopo.Animate.stepByStep = an_stepByStep;\r\n    jtopo.Animate.rotate = an_rotate;\r\n    jtopo.Animate.scale = an_scale;\r\n    jtopo.Animate.move = an_move;\r\n    jtopo.Animate.cycle = an_cycle;\r\n    jtopo.Animate.repeatThrow = an_repeatThrow;\r\n    jtopo.Animate.dividedTwoPiece = an_dividedTwoPiece;\r\n    jtopo.Animate.gravity = an_gravity;\r\n    jtopo.Animate.startAll = an_startAll;\r\n    jtopo.Animate.stopAll = an_stopAll;\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvYW5pbWF0ZS5qcz8xZWM2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEMsNkNBQTZDO0FBQzdDLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsK0JBQStCLHVCQUF1QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0EsMEVBQTBFLG1CQUFtQjtBQUM3RjtBQUNBLGFBQWEsNkJBQTZCLG9CQUFvQjtBQUM5RDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsd0xBQXdMO0FBQ3hMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGtHQUFrRztBQUNsRztBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjQ3LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBmdW5jdGlvbiBBbmltYXRlT2JqZWN0KGZuLCB0aW1lKSB7XHJcbiAgICAgICAgdmFyIGludGVydmFsSWQ7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VCdXMgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmO1xyXG4gICAgICAgICAgICAgICAgaWYgKGludGVydmFsSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJ1cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQnVzLnB1Ymxpc2goXCJzdG9wXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdGFydDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbi5jYWxsKHNlbGYpXHJcbiAgICAgICAgICAgICAgICB9LCB0aW1lKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uU3RvcDogZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBtZXNzYWdlQnVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUJ1cyA9IG5ldyBqdG9wby51dGlsLk1lc3NhZ2VCdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VCdXMuc3Vic2NyaWJlKFwic3RvcFwiLCBmbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlZl9ncmF2aXR5KGVsZW1lbnQsIGNvbmZpZykge1xyXG4gICAgICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcclxuICAgICAgICB2YXIgZ3Jhdml0eSA9IGNvbmZpZy5ncmF2aXR5IHx8IDAuMTtcclxuICAgICAgICB2YXIgRFggPSBjb25maWcuZHggfHwgMDtcclxuICAgICAgICB2YXIgRFkgPSBjb25maWcuZHkgfHwgNTtcclxuICAgICAgICB2YXIgc3RvcCA9IGNvbmZpZy5zdG9wO1xyXG4gICAgICAgIHZhciBoID0gY29uZmlnLmludGVydmFsIHx8IDMwO1xyXG4gICAgICAgIHJldHVybiBuZXcgQW5pbWF0ZU9iamVjdChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChzdG9wICYmIHN0b3AoKSkge1xyXG4gICAgICAgICAgICAgICAgRFkgPSAwLjU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIERZICs9IGdyYXZpdHk7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldExvY2F0aW9uKGVsZW1lbnQueCArIERYLCBlbGVtZW50LnkgKyBEWSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhbl9zdGVwQnlTdGVwKHRhcmdldCwgY29uZmlncywgdGltZSwgZSwgZikge1xyXG4gICAgICAgIHZhciBpbnRlcnZhbFRpbWUgPSAxZTMgLyAyNDtcclxuICAgICAgICB2YXIgdGVtcCA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGNvbmZpZyBpbiBjb25maWdzKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRWYWx1ZSA9IGNvbmZpZ3NbY29uZmlnXTtcclxuICAgICAgICAgICAgdmFyIG5lZWRWYWx1ZSA9IHRhcmdldFZhbHVlIC0gdGFyZ2V0W2NvbmZpZ107XHJcbiAgICAgICAgICAgIHRlbXBbY29uZmlnXSA9IHtcclxuICAgICAgICAgICAgICAgIG9sZFZhbHVlOiB0YXJnZXRbY29uZmlnXSxcclxuICAgICAgICAgICAgICAgIHRhcmdldFZhbHVlOiB0YXJnZXRWYWx1ZSxcclxuICAgICAgICAgICAgICAgIHN0ZXA6IG5lZWRWYWx1ZSAvIHRpbWUgKiBpbnRlcnZhbFRpbWUsXHJcbiAgICAgICAgICAgICAgICBpc0RvbmU6IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RlcCA+IDAgJiYgdGFyZ2V0W2JdID49IHRoaXMudGFyZ2V0VmFsdWUgfHwgdGhpcy5zdGVwIDwgMCAmJiB0YXJnZXRbYl0gPD0gdGhpcy50YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEFuaW1hdGVPYmplY3QoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbm90RG9uZSA9ICEwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjb25maWcgaW4gY29uZmlncykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0ZW1wW2NvbmZpZ10uaXNEb25lKGNvbmZpZykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRbY29uZmlnXSArPSB0ZW1wW2NvbmZpZ10uc3RlcDtcclxuICAgICAgICAgICAgICAgICAgICBub3REb25lID0gITE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG5vdERvbmUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGl0ZW0gaW4gY29uZmlncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gdGVtcFtpdGVtXS50YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFtpdGVtXS50YXJnZXRWYWx1ZSA9IHRlbXBbaXRlbV0ub2xkVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBbaXRlbV0ub2xkVmFsdWUgPSBnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wW2l0ZW1dLnN0ZXAgPSAtdGVtcFtpdGVtXS5zdGVwO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFtpdGVtXSA9IHRlbXBbaXRlbV0ub2xkVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgfSwgaW50ZXJ2YWxUaW1lKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlZl9zcHJpbmcoY29uZmlnKSB7XHJcbiAgICAgICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgICAgIHZhciBzcGluZyA9IGNvbmZpZy5zcHJpbmcgfHwgLjE7IC8vIOW8ueaAp+ezu+aVsFxyXG4gICAgICAgIHZhciBmcmljdGlvbiA9IGNvbmZpZy5mcmljdGlvbiB8fCAuODsvLyDmkanmk6bns7vmlbBcclxuICAgICAgICB2YXIgZ3Jpdml0eSA9IGNvbmZpZy5ncml2aXR5IHx8IDA7IC8vIOW8leWKm+Wkp+Wwj1xyXG4gICAgICAgIHZhciB3aW5kID0gY29uZmlnLm1pbkxlbmd0aCB8fCAwO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGl0ZW1zOiBbXSxcclxuICAgICAgICAgICAgaWQ6IG51bGwsXHJcbiAgICAgICAgICAgIGlzUGF1c2U6ICExLFxyXG4gICAgICAgICAgICBhZGROb2RlOiBmdW5jdGlvbiAobm9kZSwgdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlOiBub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxyXG4gICAgICAgICAgICAgICAgICAgIHZ4OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHZ5OiAwXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcGxheTogZnVuY3Rpb24gKGludGVydmFsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIGludGVydmFsID0gaW50ZXJ2YWwgfHwgMWUzIC8gMjQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubmV4dEZyYW1lKClcclxuICAgICAgICAgICAgICAgIH0sIGludGVydmFsKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmlkKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaWQgPSBudWxsO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBuZXh0RnJhbWU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGl0ZW0ubm9kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gaXRlbS50YXJnZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZ4ID0gaXRlbS52eCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdnkgPSBpdGVtLnZ5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNYID0gdGFyZ2V0LnggLSBub2RlLngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc1kgPSB0YXJnZXQueSAtIG5vZGUueSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW5nbGUgPSBNYXRoLmF0YW4yKGRpc1ksIGRpc1gpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgwICE9IHdpbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSB0YXJnZXQueCAtIE1hdGguY29zKGFuZ2xlKSAqIHdpbmQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gdGFyZ2V0LnkgLSBNYXRoLnNpbihhbmdsZSkgKiB3aW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2eCArPSAobiAtIG5vZGUueCkgKiBzcGluZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdnkgKz0gKG8gLSBub2RlLnkpICogc3Bpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdnggKz0gZGlzWCAqIHNwaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2eSArPSBkaXNZICogc3Bpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZ4ICo9IGZyaWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIHZ5ICo9IGZyaWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIHZ5ICs9IGdyaXZpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS54ICs9IHZ4O1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUueSArPSB2eTtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnZ4ID0gdng7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS52eSA9IHZ5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFuX3JvdGF0ZShhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RvcEFuaW1hdGUgPyB2b2lkIGYuc3RvcCgpIDogKGEucm90YXRlICs9IGcgfHwgLjIsIHZvaWQoYS5yb3RhdGUgPiAyICogTWF0aC5QSSAmJiAoYS5yb3RhdGUgPSAwKSkpXHJcbiAgICAgICAgICAgIH0sIDEwMCksIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuY2xlYXJJbnRlcnZhbChlKSwgZi5vblN0b3AgJiYgZi5vblN0b3AoYSksIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlID0gKGIuY29udGV4dCwgbnVsbCksIGYgPSB7fSwgZyA9IGIudjtcclxuICAgICAgICByZXR1cm4gZi5ydW4gPSBjLCBmLnN0b3AgPSBkLCBmLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmLm9uU3RvcCA9IGEsIGZcclxuICAgICAgICB9LCBmXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYW5fZ3Jhdml0eShhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jbGVhckludGVydmFsKGcpLCBoLm9uU3RvcCAmJiBoLm9uU3RvcChhKSwgaFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBiLmR4IHx8IDAsIGkgPSBiLmR5IHx8IDI7XHJcbiAgICAgICAgICAgIHJldHVybiBnID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0b3BBbmltYXRlID8gdm9pZCBoLnN0b3AoKSA6IChpICs9IGYsIHZvaWQoYS55ICsgYS5oZWlnaHQgPCBlLnN0YWdlLmNhbnZhcy5oZWlnaHQgPyBhLnNldExvY2F0aW9uKGEueCArIGQsIGEueSArIGkpIDogKGkgPSAwLCBjKCkpKSlcclxuICAgICAgICAgICAgfSwgMjApLCBoXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZSA9IGIuY29udGV4dCwgZiA9IGIuZ3Jhdml0eSB8fCAuMSwgZyA9IG51bGwsIGggPSB7fTtcclxuICAgICAgICByZXR1cm4gaC5ydW4gPSBkLCBoLnN0b3AgPSBjLCBoLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBoLm9uU3RvcCA9IGEsIGhcclxuICAgICAgICB9LCBoXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYW5fZGl2aWRlZFR3b1BpZWNlKGIsIGMpIHtcclxuICAgICAgICBmdW5jdGlvbiBkKGMsIGQsIGUsIGYsIGcpIHtcclxuICAgICAgICAgICAgdmFyIGggPSBuZXcganRvcG8uTm9kZTtcclxuICAgICAgICAgICAgcmV0dXJuIGguc2V0SW1hZ2UoYi5pbWFnZSksIGguc2V0U2l6ZShiLndpZHRoLCBiLmhlaWdodCksIGguc2V0TG9jYXRpb24oYywgZCksIGguc2hvd1NlbGVjdGVkID0gITEsIGguZHJhZ2dhYmxlID0gITEsIGgucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYXJjKDAsIDAsIGUsIGYsIGcpLCBhLmNsaXAoKSwgYS5iZWdpblBhdGgoKSwgbnVsbCAhPSB0aGlzLmltYWdlID8gYS5kcmF3SW1hZ2UodGhpcy5pbWFnZSwgLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyKSA6IChhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3R5bGUuZmlsbFN0eWxlICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEucmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIpLCBhLmZpbGwoKSksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgIH0sIGhcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoYywgZSkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGMsIGcgPSBjICsgTWF0aC5QSSwgaCA9IGQoYi54LCBiLnksIGIud2lkdGgsIGYsIGcpLCBqID0gZChiLnggLSAyICsgNCAqIE1hdGgucmFuZG9tKCksIGIueSwgYi53aWR0aCwgZiArIE1hdGguUEksIGYpO1xyXG4gICAgICAgICAgICBiLnZpc2libGUgPSAhMSwgZS5hZGQoaCksIGUuYWRkKGopLCBqdG9wby5BbmltYXRlLmdyYXZpdHkoaCwge2NvbnRleHQ6IGUsIGR4OiAuM30pLnJ1bigpLm9uU3RvcChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlLnJlbW92ZShoKSwgZS5yZW1vdmUoaiksIGkuc3RvcCgpXHJcbiAgICAgICAgICAgIH0pLCBqdG9wby5BbmltYXRlLmdyYXZpdHkoaiwge2NvbnRleHQ6IGUsIGR4OiAtLjJ9KS5ydW4oKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUoYy5hbmdsZSwgaCksIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGcoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpLm9uU3RvcCAmJiBpLm9uU3RvcChiKSwgaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGggPSBjLmNvbnRleHQsIGkgPSAoYi5zdHlsZSwge30pO1xyXG4gICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGEsIGlcclxuICAgICAgICB9LCBpLnJ1biA9IGYsIGkuc3RvcCA9IGcsIGlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhbl9yZXBlYXRUaHJvdyhhLCBiKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYyhhKSB7XHJcbiAgICAgICAgICAgIGEudmlzaWJsZSA9ICEwLCBhLnJvdGF0ZSA9IE1hdGgucmFuZG9tKCk7XHJcbiAgICAgICAgICAgIHZhciBiID0gZy5zdGFnZS5jYW52YXMud2lkdGggLyAyO1xyXG4gICAgICAgICAgICBhLnggPSBiICsgTWF0aC5yYW5kb20oKSAqIChiIC0gMTAwKSAtIE1hdGgucmFuZG9tKCkgKiAoYiAtIDEwMCksIGEueSA9IGcuc3RhZ2UuY2FudmFzLmhlaWdodCwgYS52eCA9IDUgKiBNYXRoLnJhbmRvbSgpIC0gNSAqIE1hdGgucmFuZG9tKCksIGEudnkgPSAtMjVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjKGEpLCBoID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0b3BBbmltYXRlID8gdm9pZCBpLnN0b3AoKSA6IChhLnZ5ICs9IGYsIGEueCArPSBhLnZ4LCBhLnkgKz0gYS52eSwgdm9pZCgoYS54IDwgMCB8fCBhLnggPiBnLnN0YWdlLmNhbnZhcy53aWR0aCB8fCBhLnkgPiBnLnN0YWdlLmNhbnZhcy5oZWlnaHQpICYmIChpLm9uU3RvcCAmJiBpLm9uU3RvcChhKSwgYyhhKSkpKVxyXG4gICAgICAgICAgICB9LCA1MCksIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKGgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZiA9IC44LCBnID0gYi5jb250ZXh0LCBoID0gbnVsbCwgaSA9IHt9O1xyXG4gICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGEsIGlcclxuICAgICAgICB9LCBpLnJ1biA9IGQsIGkuc3RvcCA9IGUsIGlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhbl9zdG9wQWxsKCkge1xyXG4gICAgICAgIHN0b3BBbmltYXRlID0gITBcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhbl9zdGFydEFsbCgpIHtcclxuICAgICAgICBzdG9wQW5pbWF0ZSA9ICExXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYW5fY3ljbGUoYiwgYykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0b3BBbmltYXRlKXJldHVybiB2b2lkIG0uc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBmLnkgKyBoICsgTWF0aC5zaW4oaykgKiBqO1xyXG4gICAgICAgICAgICAgICAgYi5zZXRMb2NhdGlvbihiLngsIGEpLCBrICs9IGxcclxuICAgICAgICAgICAgfSwgMTAwKSwgbVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwobilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBmID0gYy5wMSwgZyA9IGMucDIsIGggPSAoYy5jb250ZXh0LCBmLnggKyAoZy54IC0gZi54KSAvIDIpLCBpID0gZi55ICsgKGcueSAtIGYueSkgLyAyLCBqID0ganRvcG8udXRpbC5nZXREaXN0YW5jZShmLCBnKSAvIDIsIGsgPSBNYXRoLmF0YW4yKGksIGgpLCBsID0gYy5zcGVlZCB8fCAuMiwgbSA9IHt9LCBuID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gbS5ydW4gPSBkLCBtLnN0b3AgPSBlLCBtXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYW5fbW92ZShlbGVtZW50LCBjb25maWcpIHtcclxuICAgICAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gY29uZmlnLnBvc2l0aW9uO1xyXG4gICAgICAgIHZhciBlYXNpbmcgPSBjb25maWcuZWFzaW5nIHx8IDAuMjtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogbnVsbCxcclxuICAgICAgICAgICAgcnVuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5pZCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pZCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdG9wQW5pbWF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvdGFsWCA9IHBvc2l0aW9uLnggLSBlbGVtZW50Lng7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG90YWxZID0gcG9zaXRpb24ueSAtIGVsZW1lbnQueTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwWCA9IHRvdGFsWCAqIGVhc2luZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwWSA9IHRvdGFsWSAqIGVhc2luZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQueCArPSBzdGVwWDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQueSArPSBzdGVwWTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwLjEgPiBzdGVwWCAmJiAwLjEgPiBzdGVwWSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zdG9wKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3RvcDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5pZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9uU3RvcCAmJiB0eXBlb2YgdGhpcy5vblN0b3AgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25TdG9wKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYW5fc2NhbGUoYSwgYikge1xyXG4gICAgICAgIGZ1bmN0aW9uIGMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBqID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYS5zY2FsZVggKz0gZiwgYS5zY2FsZVkgKz0gZiwgYS5zY2FsZVggPj0gZSAmJiBkKClcclxuICAgICAgICAgICAgfSwgMTAwKSwgaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgaS5vblN0b3AgJiYgaS5vblN0b3AoYSksIGEuc2NhbGVYID0gZywgYS5zY2FsZVkgPSBoLCB3aW5kb3cuY2xlYXJJbnRlcnZhbChqKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGUgPSAoYi5wb3NpdGlvbiwgYi5jb250ZXh0LCBiLnNjYWxlIHx8IDEpLCBmID0gLjA2LCBnID0gYS5zY2FsZVgsIGggPSBhLnNjYWxlWSwgaSA9IHt9LCBqID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBhLCBpXHJcbiAgICAgICAgfSwgaS5ydW4gPSBjLCBpLnN0b3AgPSBkLCBpXHJcbiAgICB9XHJcblxyXG4gICAganRvcG8uQW5pbWF0ZSA9IHt9LCBqdG9wby5FZmZlY3QgPSB7fTtcclxuICAgIHZhciBzdG9wQW5pbWF0ZSA9ICExO1xyXG4gICAganRvcG8uRWZmZWN0LnNwcmluZyA9IGVmX3NwcmluZztcclxuICAgIGp0b3BvLkVmZmVjdC5ncmF2aXR5ID0gZWZfZ3Jhdml0eTtcclxuICAgIGp0b3BvLkFuaW1hdGUuc3RlcEJ5U3RlcCA9IGFuX3N0ZXBCeVN0ZXA7XHJcbiAgICBqdG9wby5BbmltYXRlLnJvdGF0ZSA9IGFuX3JvdGF0ZTtcclxuICAgIGp0b3BvLkFuaW1hdGUuc2NhbGUgPSBhbl9zY2FsZTtcclxuICAgIGp0b3BvLkFuaW1hdGUubW92ZSA9IGFuX21vdmU7XHJcbiAgICBqdG9wby5BbmltYXRlLmN5Y2xlID0gYW5fY3ljbGU7XHJcbiAgICBqdG9wby5BbmltYXRlLnJlcGVhdFRocm93ID0gYW5fcmVwZWF0VGhyb3c7XHJcbiAgICBqdG9wby5BbmltYXRlLmRpdmlkZWRUd29QaWVjZSA9IGFuX2RpdmlkZWRUd29QaWVjZTtcclxuICAgIGp0b3BvLkFuaW1hdGUuZ3Jhdml0eSA9IGFuX2dyYXZpdHk7XHJcbiAgICBqdG9wby5BbmltYXRlLnN0YXJ0QWxsID0gYW5fc3RhcnRBbGw7XHJcbiAgICBqdG9wby5BbmltYXRlLnN0b3BBbGwgPSBhbl9zdG9wQWxsO1xyXG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvYW5pbWF0ZS5qc1xuLy8gbW9kdWxlIGlkID0gNDdcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval('module.exports = function (jtopo) {\r\n    function getNodesCenter(a) {\r\n        var b = 0, c = 0;\r\n        a.forEach(function (a) {\r\n            b += a.cx, c += a.cy\r\n        });\r\n        var d = {x: b / a.length, y: c / a.length};\r\n        return d\r\n    }\r\n\r\n    function circleLayoutNodes(nodeArray, animateConfig) {\r\n        null == animateConfig && (animateConfig = {});\r\n        var e = animateConfig.cx,\r\n            f = animateConfig.cy,\r\n            g = animateConfig.minRadius,\r\n            h = animateConfig.nodeDiameter,\r\n            i = animateConfig.hScale || 1,\r\n            j = animateConfig.vScale || 1;\r\n        if (null == e || null == f) {\r\n            var k = getNodesCenter(nodeArray);\r\n            e = k.x, f = k.y\r\n        }\r\n        var l = 0, m = [], n = [];\r\n        nodeArray.forEach(function (node) {\r\n            null == animateConfig.nodeDiameter ? (node.diameter && (h = node.diameter),\r\n                h = node.radius ? 2 * node.radius : Math.sqrt(2 * node.width * node.height),\r\n                n.push(h)) : n.push(h), l += h\r\n        }), nodeArray.forEach(function (a, b) {\r\n            var c = n[b] / l;\r\n            m.push(Math.PI * c)\r\n        });\r\n        var o = (nodeArray.length, m[0] + m[1]), p = n[0] / 2 + n[1] / 2, q = p / 2 / Math.sin(o / 2);\r\n        null != g && g > q && (q = g);\r\n        var r = q * i, s = q * j, t = animateConfig.animate;\r\n        if (t) {\r\n            var time = t.time || 1e3, v = 0;\r\n            nodeArray.forEach(function (node, c) {\r\n                v += 0 == c ? m[c] : m[c - 1] + m[c];\r\n                var d = e + Math.cos(v) * r, g = f + Math.sin(v) * s;\r\n                jtopo.Animate.stepByStep(node,\r\n                    {\r\n                        x: d - node.width / 2,\r\n                        y: g - node.height / 2\r\n                    }, time\r\n                ).start();\r\n            })\r\n        } else {\r\n            var v = 0;\r\n            nodeArray.forEach(function (a, b) {\r\n                v += 0 == b ? m[b] : m[b - 1] + m[b];\r\n                var c = e + Math.cos(v) * r, d = f + Math.sin(v) * s;\r\n                a.cx = c, a.cy = d\r\n            })\r\n        }\r\n        return {cx: e, cy: f, radius: r, radiusA: r, radiusB: s}\r\n    }\r\n\r\n    function GridLayout(row, column) {\r\n        return function (container) {\r\n            var childs = container.childs;\r\n            if (!(childs.length <= 0)) {\r\n                var cBound = container.getBound();\r\n                var childNode = childs[0];\r\n                var columSpace = (cBound.width - childNode.width) / column;\r\n                var rowSpace = (cBound.height - childNode.height) / row;\r\n                for (var childIndex = 0, rowsIndex = 0; row > rowsIndex; rowsIndex++) {\r\n                    for (var columnIndex = 0; column > columnIndex; columnIndex++) {\r\n                        var node = childs[childIndex++];\r\n                        var x = cBound.left + columSpace / 2 + columnIndex * columSpace;\r\n                        var y = cBound.top + rowSpace / 2 + rowsIndex * rowSpace;\r\n                        node.setLocation(x, y);\r\n                        if (childIndex >= childs.length) {\r\n                            return\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    function FlowLayout(row, column) {\r\n        if (null == column) {\r\n            column = 0;\r\n        }\r\n        if (null == row) {\r\n            row = 0;\r\n        }\r\n        return function (container) {\r\n            var childs = container.childs;\r\n            if (!(childs.length <= 0)) {\r\n                var bound = container.getBound();\r\n                var left = bound.left;\r\n                var top = bound.top;\r\n                for (var i = 0; i < childs.length; i++) {\r\n                    var child = childs[i];\r\n                    if (left + child.width >= bound.right) {\r\n                        left = bound.left;\r\n                        top += row + child.height;\r\n                    }\r\n                    child.setLocation(left, top);\r\n                    left += column + child.width;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function AutoBoundLayout() {\r\n        return function (container, children) {\r\n            if (children.length > 0) {\r\n                var left = 1e7,\r\n                    right = -1e7,\r\n                    top = 1e7,\r\n                    bottom = -1e7,\r\n                    width = right - left,\r\n                    height = bottom - top;\r\n                for (var i = 0; i < children.length; i++) {\r\n                    var child = children[i];\r\n                    child.x <= left && (left = child.x);\r\n                    (child.x + child.width) >= right && (right = child.x + child.width);\r\n                    child.y <= top && (top = child.y);\r\n                    (child.y + child.height) >= bottom && (bottom = child.y + child.height);\r\n                    width = right - left;\r\n                    height = bottom - top;\r\n                }\r\n                container.x = left;\r\n                container.y = top;\r\n                container.width = width;\r\n                container.height = height;\r\n            } else {\r\n                container.width = 100;\r\n                container.height = 100;\r\n            }\r\n            if (container.qtopo) {\r\n                container.qtopo.attr.size[0] = container.width;\r\n                container.qtopo.attr.size[1] = container.height;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 找到可以作为根的节点\r\n     * */\r\n    function getRootNodes(elements) {\r\n        return elements.filter(function (element) {\r\n            return (element instanceof jtopo.Node) &&\r\n                (!element.inLinks || element.inLinks.length == 0) &&\r\n                (element.outLinks && element.outLinks.length > 0);\r\n        });\r\n    }\r\n\r\n    function getGap(arr) {\r\n        var totalWidth = 0, totalHeight = 0;\r\n        arr.forEach(function (a) {\r\n            totalWidth += a.width;\r\n            totalHeight += a.height;\r\n        });\r\n        return {\r\n            width: totalWidth / arr.length,\r\n            height: totalHeight / arr.length\r\n        }\r\n    }\r\n\r\n    function i(a, b, c, d) {\r\n        b.x += c, b.y += d;\r\n        for (var e = getRootChilds(a, b), f = 0; f < e.length; f++)i(a, e[f], c, d)\r\n    }\r\n\r\n    function j(a, b) {\r\n        function c(b, e) {\r\n            var f = getRootChilds(a, b);\r\n            null == d[e] && (d[e] = {}, d[e].nodes = [], d[e].childs = []), d[e].nodes.push(b), d[e].childs.push(f);\r\n            for (var g = 0; g < f.length; g++)c(f[g], e + 1), f[g].parent = b\r\n        }\r\n\r\n        var d = [];\r\n        return c(b, 0), d\r\n    }\r\n\r\n    function TreeLayout(direction, gap, top) {\r\n        return function (scene) {\r\n            function f(childs, root) {\r\n                var h = jtopo.layout.getTreeDeep(childs, root);\r\n                var k = j(childs, root);\r\n                var l = k["" + h].nodes;\r\n                for (var m = 0; m < l.length; m++) {\r\n                    var n = l[m], o = (m + 1) * (gap + 10), p = h * top;\r\n                    "down" == direction || ("up" == direction ? p = -p : "left" == direction ? (o = -h * top, p = (m + 1) * (gap + 10)) : "right" == direction && (o = h * top, p = (m + 1) * (gap + 10))), n.setLocation(o, p)\r\n                }\r\n                for (var q = h - 1; q >= 0; q--)for (var r = k["" + q].nodes, s = k["" + q].childs, m = 0; m < r.length; m++) {\r\n                    var t = r[m], u = s[m];\r\n                    if ("down" == direction ? t.y = q * top : "up" == direction ? t.y = -q * top : "left" == direction ? t.x = -q * top : "right" == direction && (t.x = q * top), u.length > 0 ? "down" == direction || "up" == direction ? t.x = (u[0].x + u[u.length - 1].x) / 2 : ("left" == direction || "right" == direction) && (t.y = (u[0].y + u[u.length - 1].y) / 2) : m > 0 && ("down" == direction || "up" == direction ? t.x = r[m - 1].x + r[m - 1].width + gap : ("left" == direction || "right" == direction) && (t.y = r[m - 1].y + r[m - 1].height + gap)), m > 0)if ("down" == direction || "up" == direction) {\r\n                        if (t.x < r[m - 1].x + r[m - 1].width)for (var v = r[m - 1].x + r[m - 1].width + gap, w = Math.abs(v - t.x), x = m; x < r.length; x++)i(scene.childs, r[x], w, 0)\r\n                    } else if (("left" == direction || "right" == direction) && t.y < r[m - 1].y + r[m - 1].height)for (var y = r[m - 1].y + r[m - 1].height + gap, z = Math.abs(y - t.y), x = m; x < r.length; x++)i(scene.childs, r[x], 0, z)\r\n                }\r\n            }\r\n\r\n            var realGap = null;\r\n            if (null == gap) {\r\n                realGap = getGap(scene.childs);\r\n                gap = realGap.width;\r\n                if ("left" == direction || "right" == direction) {\r\n                    gap = realGap.width + 10;\r\n                }\r\n            }\r\n            if (null == top) {\r\n                if (null == realGap) {\r\n                    realGap = getGap(scene.childs)\r\n                }\r\n                top = 2 * realGap.height;\r\n            }\r\n            direction = direction || "down";\r\n            var roots = jtopo.layout.getRootNodes(scene.childs);\r\n            if (roots.length > 0) {\r\n                f(scene.childs, roots[0]);\r\n                var bound = jtopo.util.getElementsBound(scene.childs);\r\n                var center = scene.getCenterLocation();\r\n                var startX = center.x - (bound.left + bound.right) / 2,\r\n                    startY = center.y - (bound.top + bound.bottom) / 2;\r\n                scene.childs.forEach(function (element) {\r\n                    if (element instanceof jtopo.Node) {\r\n                        element.x += startX;\r\n                        element.y += startY;\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    //必须得是有向无环图才可以布局\r\n    function CircleLayout(radius) {\r\n        return function (scene) {\r\n            function locationSet(allChilds, root, ra) {\r\n                var rootsArr = getRootChilds(allChilds, root);\r\n                if (0 != rootsArr.length) {\r\n                    if (null == ra) {\r\n                        ra = radius;\r\n                    }\r\n                    var step = 2 * Math.PI / rootsArr.length;\r\n                    rootsArr.forEach(function (child, i) {\r\n                        child.setLocation(\r\n                            root.x + ra * Math.cos(step * i),\r\n                            root.y + ra * Math.sin(step * i)\r\n                        );\r\n                        locationSet(allChilds, child, ra / 2);\r\n                    })\r\n                }\r\n            }\r\n\r\n            var roots = jtopo.layout.getRootNodes(scene.childs);\r\n            if (roots.length > 0) {\r\n                locationSet(scene.childs, roots[0]);\r\n                var bound = jtopo.util.getElementsBound(scene.childs);\r\n                var center = scene.getCenterLocation();\r\n                var left = center.x - (bound.left + bound.right) / 2;\r\n                var top = center.y - (bound.top + bound.bottom) / 2;\r\n                scene.childs.forEach(function (b) {\r\n                    if (b instanceof jtopo.Node) {\r\n                        b.x += left;\r\n                        b.y += top;\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    function m(a, b, c, d, e, f) {\r\n        for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n        return g\r\n    }\r\n\r\n    function circlePosition(centerX, centerY, total, raidus, beginAngle, endAngle) {\r\n        var begin = beginAngle ? beginAngle : 0;\r\n        var end = endAngle ? endAngle : 2 * Math.PI;\r\n        var totalAngle = end - begin;\r\n        var step = totalAngle / total;\r\n        var position = [];\r\n        begin += step / 2;\r\n        for (var i = begin; end >= i; i += step) {\r\n            position.push({\r\n                x: centerX + Math.cos(i) * raidus,\r\n                y: centerY + Math.sin(i) * raidus\r\n            });\r\n        }\r\n        return position\r\n    }\r\n\r\n    function treePostion(a, b, c, d, e, f) {\r\n        var g = f || "bottom", h = [];\r\n        if ("bottom" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b + e\r\n        }); else if ("top" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: i + j * d,\r\n            y: b - e\r\n        }); else if ("right" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n            x: a + e,\r\n            y: i + j * d\r\n        }); else if ("left" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({x: a - e, y: i + j * d});\r\n        return h\r\n    }\r\n\r\n    function gridPosition(a, b, c, d, e, f) {\r\n        for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n        return g\r\n    }\r\n\r\n    function adjustPosition(root, rootChilds) {\r\n        if (root.layout) {\r\n            var layout = root.layout;\r\n            var locationArr = null;\r\n            switch (layout.type) {\r\n                case \'circle\':\r\n                    var radius = layout.radius || Math.max(root.width, root.height);\r\n                    locationArr = circlePosition(\r\n                        root.cx,\r\n                        root.cy,\r\n                        rootChilds.length,\r\n                        radius,\r\n                        root.layout.beginAngle,\r\n                        root.layout.endAngle\r\n                    );\r\n                    break;\r\n                case \'tree\':\r\n                    locationArr = treePostion(\r\n                        root.cx,\r\n                        root.cy,\r\n                        rootChilds.length,\r\n                        layout.width || 50,\r\n                        layout.height || 50,\r\n                        layout.direction\r\n                    );\r\n                    break;\r\n                case \'grid\':\r\n                    locationArr = gridPosition(\r\n                        root.x,\r\n                        root.y,\r\n                        layout.rows,\r\n                        layout.cols,\r\n                        layout.horizontal || 0,\r\n                        layout.vertical || 0\r\n                    );\r\n                    break;\r\n            }\r\n            for (var i = 0; i < rootChilds.length; i++) {\r\n                rootChilds[i].setCenterLocation(locationArr[i].x, locationArr[i].y);\r\n            }\r\n        }\r\n    }\r\n\r\n    function getRootChilds(allChilds, rootNode) {\r\n        var rootChilds;\r\n        if (rootNode.outLinks instanceof Array && rootNode.outLinks.length > 0) {\r\n            rootChilds = rootNode.outLinks.map(function (link) {\r\n                return link.nodeZ;\r\n            });\r\n        }\r\n        return rootChilds || [];\r\n    }\r\n\r\n    function layoutNode(scene, root, recursion) {\r\n        var rootChilds = getRootChilds(scene.childs, root);\r\n        if (0 != rootChilds.length) {\r\n            adjustPosition(root, rootChilds);\r\n            if (1 == recursion) {\r\n                for (var e = 0; e < rootChilds.length; e++) {\r\n                    layoutNode(scene, rootChilds[e], recursion);\r\n                }\r\n            }\r\n        }\r\n        return null\r\n    }\r\n\r\n    function springLayout(root, scene) {\r\n        var keyA = 0.01;//移动幅度\r\n        var keyB = 0.95;\r\n        var temp = -5;\r\n        var stepX = 0;\r\n        var stepY = 0;\r\n        var times = 0;\r\n        var nodes = scene.getElementsByClass(jtopo.Node);\r\n        annimate();\r\n\r\n        function change(root, node) {\r\n            var disX = root.x - node.x;\r\n            var disY = root.y - node.y;\r\n            stepX += disX * keyA;\r\n            stepY += disY * keyA;\r\n            stepX *= keyB;\r\n            stepY *= keyB;\r\n            stepY += temp;\r\n            node.x += stepX;\r\n            node.y += stepY;\r\n        }\r\n\r\n        function annimate() {\r\n            ++times;\r\n            if (times < 150) {\r\n                for (var i = 0; i < nodes.length; i++) {\r\n                    if (nodes[i] != root) {\r\n                        change(root, nodes[i]);\r\n                    }\r\n                }\r\n                setTimeout(annimate, 1e3 / 24)\r\n            }\r\n        }\r\n    }\r\n\r\n    function getTreeDeep(childs, root) {\r\n        function reDeep(childs, root, deep) {\r\n            var rootChilds = getRootChilds(childs, root);\r\n            if (deep > d) {\r\n                d = deep;\r\n            }\r\n            for (var g = 0; g < rootChilds.length; g++) {\r\n                reDeep(childs, rootChilds[g], deep + 1);\r\n            }\r\n        }\r\n\r\n        var d = 0;\r\n        reDeep(childs, root, 0);\r\n        return d;\r\n    }\r\n\r\n    jtopo.layout = jtopo.Layout = {\r\n        layoutNode: layoutNode,\r\n        getNodeChilds: getRootChilds,\r\n        adjustPosition: adjustPosition,\r\n        springLayout: springLayout,\r\n        getTreeDeep: getTreeDeep,\r\n        getRootNodes: getRootNodes,\r\n        GridLayout: GridLayout,\r\n        FlowLayout: FlowLayout,\r\n        AutoBoundLayout: AutoBoundLayout,\r\n        CircleLayout: CircleLayout,\r\n        TreeLayout: TreeLayout,\r\n        getNodesCenter: getNodesCenter,\r\n        circleLayoutNodes: circleLayoutNodes\r\n    }\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvbGF5b3V0LmpzP2E2MGIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxnQkFBZ0I7QUFDaEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxpQkFBaUI7QUFDeEUsNkNBQTZDLHNCQUFzQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLG1CQUFtQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixxQkFBcUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0RBQWdELGNBQWM7QUFDOUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDLDJCQUEyQixjQUFjO0FBQ3pDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsUUFBUSwrREFBK0QsY0FBYztBQUN4SDtBQUNBO0FBQ0EsMklBQTJJLGNBQWM7QUFDekoscUJBQXFCLDRLQUE0SyxjQUFjO0FBQy9NO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwrQkFBK0IsT0FBTyxvQkFBb0IsT0FBTyxhQUFhLDJCQUEyQjtBQUN6RztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFVBQVU7QUFDckM7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0VBQW9FLFFBQVE7QUFDNUU7QUFDQTtBQUNBLFNBQVMsRUFBRSwrREFBK0QsUUFBUTtBQUNsRjtBQUNBO0FBQ0EsU0FBUyxFQUFFLGlFQUFpRSxRQUFRO0FBQ3BGO0FBQ0E7QUFDQSxTQUFTLEVBQUUsZ0VBQWdFLFFBQVEsYUFBYSx1QkFBdUI7QUFDdkg7QUFDQTs7QUFFQTtBQUNBLCtCQUErQixPQUFPLG9CQUFvQixPQUFPLGFBQWEsMkJBQTJCO0FBQ3pHO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdUJBQXVCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsdUJBQXVCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixrQkFBa0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdUJBQXVCO0FBQ2xEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI0OC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICBmdW5jdGlvbiBnZXROb2Rlc0NlbnRlcihhKSB7XHJcbiAgICAgICAgdmFyIGIgPSAwLCBjID0gMDtcclxuICAgICAgICBhLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgYiArPSBhLmN4LCBjICs9IGEuY3lcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZCA9IHt4OiBiIC8gYS5sZW5ndGgsIHk6IGMgLyBhLmxlbmd0aH07XHJcbiAgICAgICAgcmV0dXJuIGRcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjaXJjbGVMYXlvdXROb2Rlcyhub2RlQXJyYXksIGFuaW1hdGVDb25maWcpIHtcclxuICAgICAgICBudWxsID09IGFuaW1hdGVDb25maWcgJiYgKGFuaW1hdGVDb25maWcgPSB7fSk7XHJcbiAgICAgICAgdmFyIGUgPSBhbmltYXRlQ29uZmlnLmN4LFxyXG4gICAgICAgICAgICBmID0gYW5pbWF0ZUNvbmZpZy5jeSxcclxuICAgICAgICAgICAgZyA9IGFuaW1hdGVDb25maWcubWluUmFkaXVzLFxyXG4gICAgICAgICAgICBoID0gYW5pbWF0ZUNvbmZpZy5ub2RlRGlhbWV0ZXIsXHJcbiAgICAgICAgICAgIGkgPSBhbmltYXRlQ29uZmlnLmhTY2FsZSB8fCAxLFxyXG4gICAgICAgICAgICBqID0gYW5pbWF0ZUNvbmZpZy52U2NhbGUgfHwgMTtcclxuICAgICAgICBpZiAobnVsbCA9PSBlIHx8IG51bGwgPT0gZikge1xyXG4gICAgICAgICAgICB2YXIgayA9IGdldE5vZGVzQ2VudGVyKG5vZGVBcnJheSk7XHJcbiAgICAgICAgICAgIGUgPSBrLngsIGYgPSBrLnlcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGwgPSAwLCBtID0gW10sIG4gPSBbXTtcclxuICAgICAgICBub2RlQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICBudWxsID09IGFuaW1hdGVDb25maWcubm9kZURpYW1ldGVyID8gKG5vZGUuZGlhbWV0ZXIgJiYgKGggPSBub2RlLmRpYW1ldGVyKSxcclxuICAgICAgICAgICAgICAgIGggPSBub2RlLnJhZGl1cyA/IDIgKiBub2RlLnJhZGl1cyA6IE1hdGguc3FydCgyICogbm9kZS53aWR0aCAqIG5vZGUuaGVpZ2h0KSxcclxuICAgICAgICAgICAgICAgIG4ucHVzaChoKSkgOiBuLnB1c2goaCksIGwgKz0gaFxyXG4gICAgICAgIH0pLCBub2RlQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IG5bYl0gLyBsO1xyXG4gICAgICAgICAgICBtLnB1c2goTWF0aC5QSSAqIGMpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIG8gPSAobm9kZUFycmF5Lmxlbmd0aCwgbVswXSArIG1bMV0pLCBwID0gblswXSAvIDIgKyBuWzFdIC8gMiwgcSA9IHAgLyAyIC8gTWF0aC5zaW4obyAvIDIpO1xyXG4gICAgICAgIG51bGwgIT0gZyAmJiBnID4gcSAmJiAocSA9IGcpO1xyXG4gICAgICAgIHZhciByID0gcSAqIGksIHMgPSBxICogaiwgdCA9IGFuaW1hdGVDb25maWcuYW5pbWF0ZTtcclxuICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICB2YXIgdGltZSA9IHQudGltZSB8fCAxZTMsIHYgPSAwO1xyXG4gICAgICAgICAgICBub2RlQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAobm9kZSwgYykge1xyXG4gICAgICAgICAgICAgICAgdiArPSAwID09IGMgPyBtW2NdIDogbVtjIC0gMV0gKyBtW2NdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBlICsgTWF0aC5jb3ModikgKiByLCBnID0gZiArIE1hdGguc2luKHYpICogcztcclxuICAgICAgICAgICAgICAgIGp0b3BvLkFuaW1hdGUuc3RlcEJ5U3RlcChub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogZCAtIG5vZGUud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiBnIC0gbm9kZS5oZWlnaHQgLyAyXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgdGltZVxyXG4gICAgICAgICAgICAgICAgKS5zdGFydCgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB2ID0gMDtcclxuICAgICAgICAgICAgbm9kZUFycmF5LmZvckVhY2goZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHYgKz0gMCA9PSBiID8gbVtiXSA6IG1bYiAtIDFdICsgbVtiXTtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gZSArIE1hdGguY29zKHYpICogciwgZCA9IGYgKyBNYXRoLnNpbih2KSAqIHM7XHJcbiAgICAgICAgICAgICAgICBhLmN4ID0gYywgYS5jeSA9IGRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtjeDogZSwgY3k6IGYsIHJhZGl1czogciwgcmFkaXVzQTogciwgcmFkaXVzQjogc31cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBHcmlkTGF5b3V0KHJvdywgY29sdW1uKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkcyA9IGNvbnRhaW5lci5jaGlsZHM7XHJcbiAgICAgICAgICAgIGlmICghKGNoaWxkcy5sZW5ndGggPD0gMCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjQm91bmQgPSBjb250YWluZXIuZ2V0Qm91bmQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZE5vZGUgPSBjaGlsZHNbMF07XHJcbiAgICAgICAgICAgICAgICB2YXIgY29sdW1TcGFjZSA9IChjQm91bmQud2lkdGggLSBjaGlsZE5vZGUud2lkdGgpIC8gY29sdW1uO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJvd1NwYWNlID0gKGNCb3VuZC5oZWlnaHQgLSBjaGlsZE5vZGUuaGVpZ2h0KSAvIHJvdztcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGNoaWxkSW5kZXggPSAwLCByb3dzSW5kZXggPSAwOyByb3cgPiByb3dzSW5kZXg7IHJvd3NJbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgY29sdW1uSW5kZXggPSAwOyBjb2x1bW4gPiBjb2x1bW5JbmRleDsgY29sdW1uSW5kZXgrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IGNoaWxkc1tjaGlsZEluZGV4KytdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGNCb3VuZC5sZWZ0ICsgY29sdW1TcGFjZSAvIDIgKyBjb2x1bW5JbmRleCAqIGNvbHVtU3BhY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gY0JvdW5kLnRvcCArIHJvd1NwYWNlIC8gMiArIHJvd3NJbmRleCAqIHJvd1NwYWNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNldExvY2F0aW9uKHgsIHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRJbmRleCA+PSBjaGlsZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gRmxvd0xheW91dChyb3csIGNvbHVtbikge1xyXG4gICAgICAgIGlmIChudWxsID09IGNvbHVtbikge1xyXG4gICAgICAgICAgICBjb2x1bW4gPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobnVsbCA9PSByb3cpIHtcclxuICAgICAgICAgICAgcm93ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkcyA9IGNvbnRhaW5lci5jaGlsZHM7XHJcbiAgICAgICAgICAgIGlmICghKGNoaWxkcy5sZW5ndGggPD0gMCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBib3VuZCA9IGNvbnRhaW5lci5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBib3VuZC5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvcCA9IGJvdW5kLnRvcDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gY2hpbGRzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsZWZ0ICsgY2hpbGQud2lkdGggPj0gYm91bmQucmlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IGJvdW5kLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCArPSByb3cgKyBjaGlsZC5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLnNldExvY2F0aW9uKGxlZnQsIHRvcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdCArPSBjb2x1bW4gKyBjaGlsZC53aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBBdXRvQm91bmRMYXlvdXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250YWluZXIsIGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVmdCA9IDFlNyxcclxuICAgICAgICAgICAgICAgICAgICByaWdodCA9IC0xZTcsXHJcbiAgICAgICAgICAgICAgICAgICAgdG9wID0gMWU3LFxyXG4gICAgICAgICAgICAgICAgICAgIGJvdHRvbSA9IC0xZTcsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSByaWdodCAtIGxlZnQsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gYm90dG9tIC0gdG9wO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLnggPD0gbGVmdCAmJiAobGVmdCA9IGNoaWxkLngpO1xyXG4gICAgICAgICAgICAgICAgICAgIChjaGlsZC54ICsgY2hpbGQud2lkdGgpID49IHJpZ2h0ICYmIChyaWdodCA9IGNoaWxkLnggKyBjaGlsZC53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQueSA8PSB0b3AgJiYgKHRvcCA9IGNoaWxkLnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIChjaGlsZC55ICsgY2hpbGQuaGVpZ2h0KSA+PSBib3R0b20gJiYgKGJvdHRvbSA9IGNoaWxkLnkgKyBjaGlsZC5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IGJvdHRvbSAtIHRvcDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci54ID0gbGVmdDtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci55ID0gdG9wO1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLndpZHRoID0gMTAwO1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmhlaWdodCA9IDEwMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLnF0b3BvKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIucXRvcG8uYXR0ci5zaXplWzBdID0gY29udGFpbmVyLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnF0b3BvLmF0dHIuc2l6ZVsxXSA9IGNvbnRhaW5lci5oZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmib7liLDlj6/ku6XkvZzkuLrmoLnnmoToioLngrlcclxuICAgICAqICovXHJcbiAgICBmdW5jdGlvbiBnZXRSb290Tm9kZXMoZWxlbWVudHMpIHtcclxuICAgICAgICByZXR1cm4gZWxlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZWxlbWVudCBpbnN0YW5jZW9mIGp0b3BvLk5vZGUpICYmXHJcbiAgICAgICAgICAgICAgICAoIWVsZW1lbnQuaW5MaW5rcyB8fCBlbGVtZW50LmluTGlua3MubGVuZ3RoID09IDApICYmXHJcbiAgICAgICAgICAgICAgICAoZWxlbWVudC5vdXRMaW5rcyAmJiBlbGVtZW50Lm91dExpbmtzLmxlbmd0aCA+IDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEdhcChhcnIpIHtcclxuICAgICAgICB2YXIgdG90YWxXaWR0aCA9IDAsIHRvdGFsSGVpZ2h0ID0gMDtcclxuICAgICAgICBhcnIuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB0b3RhbFdpZHRoICs9IGEud2lkdGg7XHJcbiAgICAgICAgICAgIHRvdGFsSGVpZ2h0ICs9IGEuaGVpZ2h0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHdpZHRoOiB0b3RhbFdpZHRoIC8gYXJyLmxlbmd0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiB0b3RhbEhlaWdodCAvIGFyci5sZW5ndGhcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaShhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgYi54ICs9IGMsIGIueSArPSBkO1xyXG4gICAgICAgIGZvciAodmFyIGUgPSBnZXRSb290Q2hpbGRzKGEsIGIpLCBmID0gMDsgZiA8IGUubGVuZ3RoOyBmKyspaShhLCBlW2ZdLCBjLCBkKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGooYSwgYikge1xyXG4gICAgICAgIGZ1bmN0aW9uIGMoYiwgZSkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGdldFJvb3RDaGlsZHMoYSwgYik7XHJcbiAgICAgICAgICAgIG51bGwgPT0gZFtlXSAmJiAoZFtlXSA9IHt9LCBkW2VdLm5vZGVzID0gW10sIGRbZV0uY2hpbGRzID0gW10pLCBkW2VdLm5vZGVzLnB1c2goYiksIGRbZV0uY2hpbGRzLnB1c2goZik7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgZi5sZW5ndGg7IGcrKyljKGZbZ10sIGUgKyAxKSwgZltnXS5wYXJlbnQgPSBiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZCA9IFtdO1xyXG4gICAgICAgIHJldHVybiBjKGIsIDApLCBkXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gVHJlZUxheW91dChkaXJlY3Rpb24sIGdhcCwgdG9wKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBmKGNoaWxkcywgcm9vdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGggPSBqdG9wby5sYXlvdXQuZ2V0VHJlZURlZXAoY2hpbGRzLCByb290KTtcclxuICAgICAgICAgICAgICAgIHZhciBrID0gaihjaGlsZHMsIHJvb3QpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGwgPSBrW1wiXCIgKyBoXS5ub2RlcztcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG0gPSAwOyBtIDwgbC5sZW5ndGg7IG0rKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuID0gbFttXSwgbyA9IChtICsgMSkgKiAoZ2FwICsgMTApLCBwID0gaCAqIHRvcDtcclxuICAgICAgICAgICAgICAgICAgICBcImRvd25cIiA9PSBkaXJlY3Rpb24gfHwgKFwidXBcIiA9PSBkaXJlY3Rpb24gPyBwID0gLXAgOiBcImxlZnRcIiA9PSBkaXJlY3Rpb24gPyAobyA9IC1oICogdG9wLCBwID0gKG0gKyAxKSAqIChnYXAgKyAxMCkpIDogXCJyaWdodFwiID09IGRpcmVjdGlvbiAmJiAobyA9IGggKiB0b3AsIHAgPSAobSArIDEpICogKGdhcCArIDEwKSkpLCBuLnNldExvY2F0aW9uKG8sIHApXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBxID0gaCAtIDE7IHEgPj0gMDsgcS0tKWZvciAodmFyIHIgPSBrW1wiXCIgKyBxXS5ub2RlcywgcyA9IGtbXCJcIiArIHFdLmNoaWxkcywgbSA9IDA7IG0gPCByLmxlbmd0aDsgbSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSByW21dLCB1ID0gc1ttXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJkb3duXCIgPT0gZGlyZWN0aW9uID8gdC55ID0gcSAqIHRvcCA6IFwidXBcIiA9PSBkaXJlY3Rpb24gPyB0LnkgPSAtcSAqIHRvcCA6IFwibGVmdFwiID09IGRpcmVjdGlvbiA/IHQueCA9IC1xICogdG9wIDogXCJyaWdodFwiID09IGRpcmVjdGlvbiAmJiAodC54ID0gcSAqIHRvcCksIHUubGVuZ3RoID4gMCA/IFwiZG93blwiID09IGRpcmVjdGlvbiB8fCBcInVwXCIgPT0gZGlyZWN0aW9uID8gdC54ID0gKHVbMF0ueCArIHVbdS5sZW5ndGggLSAxXS54KSAvIDIgOiAoXCJsZWZ0XCIgPT0gZGlyZWN0aW9uIHx8IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24pICYmICh0LnkgPSAodVswXS55ICsgdVt1Lmxlbmd0aCAtIDFdLnkpIC8gMikgOiBtID4gMCAmJiAoXCJkb3duXCIgPT0gZGlyZWN0aW9uIHx8IFwidXBcIiA9PSBkaXJlY3Rpb24gPyB0LnggPSByW20gLSAxXS54ICsgclttIC0gMV0ud2lkdGggKyBnYXAgOiAoXCJsZWZ0XCIgPT0gZGlyZWN0aW9uIHx8IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24pICYmICh0LnkgPSByW20gLSAxXS55ICsgclttIC0gMV0uaGVpZ2h0ICsgZ2FwKSksIG0gPiAwKWlmIChcImRvd25cIiA9PSBkaXJlY3Rpb24gfHwgXCJ1cFwiID09IGRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC54IDwgclttIC0gMV0ueCArIHJbbSAtIDFdLndpZHRoKWZvciAodmFyIHYgPSByW20gLSAxXS54ICsgclttIC0gMV0ud2lkdGggKyBnYXAsIHcgPSBNYXRoLmFicyh2IC0gdC54KSwgeCA9IG07IHggPCByLmxlbmd0aDsgeCsrKWkoc2NlbmUuY2hpbGRzLCByW3hdLCB3LCAwKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKFwibGVmdFwiID09IGRpcmVjdGlvbiB8fCBcInJpZ2h0XCIgPT0gZGlyZWN0aW9uKSAmJiB0LnkgPCByW20gLSAxXS55ICsgclttIC0gMV0uaGVpZ2h0KWZvciAodmFyIHkgPSByW20gLSAxXS55ICsgclttIC0gMV0uaGVpZ2h0ICsgZ2FwLCB6ID0gTWF0aC5hYnMoeSAtIHQueSksIHggPSBtOyB4IDwgci5sZW5ndGg7IHgrKylpKHNjZW5lLmNoaWxkcywgclt4XSwgMCwgeilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHJlYWxHYXAgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSBnYXApIHtcclxuICAgICAgICAgICAgICAgIHJlYWxHYXAgPSBnZXRHYXAoc2NlbmUuY2hpbGRzKTtcclxuICAgICAgICAgICAgICAgIGdhcCA9IHJlYWxHYXAud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBpZiAoXCJsZWZ0XCIgPT0gZGlyZWN0aW9uIHx8IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBnYXAgPSByZWFsR2FwLndpZHRoICsgMTA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG51bGwgPT0gdG9wKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSByZWFsR2FwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVhbEdhcCA9IGdldEdhcChzY2VuZS5jaGlsZHMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0b3AgPSAyICogcmVhbEdhcC5oZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGlyZWN0aW9uID0gZGlyZWN0aW9uIHx8IFwiZG93blwiO1xyXG4gICAgICAgICAgICB2YXIgcm9vdHMgPSBqdG9wby5sYXlvdXQuZ2V0Um9vdE5vZGVzKHNjZW5lLmNoaWxkcyk7XHJcbiAgICAgICAgICAgIGlmIChyb290cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmKHNjZW5lLmNoaWxkcywgcm9vdHNbMF0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGJvdW5kID0ganRvcG8udXRpbC5nZXRFbGVtZW50c0JvdW5kKHNjZW5lLmNoaWxkcyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gc2NlbmUuZ2V0Q2VudGVyTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHZhciBzdGFydFggPSBjZW50ZXIueCAtIChib3VuZC5sZWZ0ICsgYm91bmQucmlnaHQpIC8gMixcclxuICAgICAgICAgICAgICAgICAgICBzdGFydFkgPSBjZW50ZXIueSAtIChib3VuZC50b3AgKyBib3VuZC5ib3R0b20pIC8gMjtcclxuICAgICAgICAgICAgICAgIHNjZW5lLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5Ob2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQueCArPSBzdGFydFg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQueSArPSBzdGFydFk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL+W/hemhu+W+l+aYr+acieWQkeaXoOeOr+WbvuaJjeWPr+S7peW4g+WxgFxyXG4gICAgZnVuY3Rpb24gQ2lyY2xlTGF5b3V0KHJhZGl1cykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gbG9jYXRpb25TZXQoYWxsQ2hpbGRzLCByb290LCByYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJvb3RzQXJyID0gZ2V0Um9vdENoaWxkcyhhbGxDaGlsZHMsIHJvb3QpO1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gcm9vdHNBcnIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gcmEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmEgPSByYWRpdXM7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGVwID0gMiAqIE1hdGguUEkgLyByb290c0Fyci5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgcm9vdHNBcnIuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuc2V0TG9jYXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290LnggKyByYSAqIE1hdGguY29zKHN0ZXAgKiBpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QueSArIHJhICogTWF0aC5zaW4oc3RlcCAqIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uU2V0KGFsbENoaWxkcywgY2hpbGQsIHJhIC8gMik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHJvb3RzID0ganRvcG8ubGF5b3V0LmdldFJvb3ROb2RlcyhzY2VuZS5jaGlsZHMpO1xyXG4gICAgICAgICAgICBpZiAocm9vdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25TZXQoc2NlbmUuY2hpbGRzLCByb290c1swXSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm91bmQgPSBqdG9wby51dGlsLmdldEVsZW1lbnRzQm91bmQoc2NlbmUuY2hpbGRzKTtcclxuICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBzY2VuZS5nZXRDZW50ZXJMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBjZW50ZXIueCAtIChib3VuZC5sZWZ0ICsgYm91bmQucmlnaHQpIC8gMjtcclxuICAgICAgICAgICAgICAgIHZhciB0b3AgPSBjZW50ZXIueSAtIChib3VuZC50b3AgKyBib3VuZC5ib3R0b20pIC8gMjtcclxuICAgICAgICAgICAgICAgIHNjZW5lLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGIgaW5zdGFuY2VvZiBqdG9wby5Ob2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIueCArPSBsZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnkgKz0gdG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbShhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZyA9IFtdLCBoID0gMDsgYyA+IGg7IGgrKylmb3IgKHZhciBpID0gMDsgZCA+IGk7IGkrKylnLnB1c2goe3g6IGEgKyBpICogZSwgeTogYiArIGggKiBmfSk7XHJcbiAgICAgICAgcmV0dXJuIGdcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjaXJjbGVQb3NpdGlvbihjZW50ZXJYLCBjZW50ZXJZLCB0b3RhbCwgcmFpZHVzLCBiZWdpbkFuZ2xlLCBlbmRBbmdsZSkge1xyXG4gICAgICAgIHZhciBiZWdpbiA9IGJlZ2luQW5nbGUgPyBiZWdpbkFuZ2xlIDogMDtcclxuICAgICAgICB2YXIgZW5kID0gZW5kQW5nbGUgPyBlbmRBbmdsZSA6IDIgKiBNYXRoLlBJO1xyXG4gICAgICAgIHZhciB0b3RhbEFuZ2xlID0gZW5kIC0gYmVnaW47XHJcbiAgICAgICAgdmFyIHN0ZXAgPSB0b3RhbEFuZ2xlIC8gdG90YWw7XHJcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gW107XHJcbiAgICAgICAgYmVnaW4gKz0gc3RlcCAvIDI7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IGJlZ2luOyBlbmQgPj0gaTsgaSArPSBzdGVwKSB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgeDogY2VudGVyWCArIE1hdGguY29zKGkpICogcmFpZHVzLFxyXG4gICAgICAgICAgICAgICAgeTogY2VudGVyWSArIE1hdGguc2luKGkpICogcmFpZHVzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcG9zaXRpb25cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0cmVlUG9zdGlvbihhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgdmFyIGcgPSBmIHx8IFwiYm90dG9tXCIsIGggPSBbXTtcclxuICAgICAgICBpZiAoXCJib3R0b21cIiA9PSBnKWZvciAodmFyIGkgPSBhIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICB4OiBpICsgaiAqIGQsXHJcbiAgICAgICAgICAgIHk6IGIgKyBlXHJcbiAgICAgICAgfSk7IGVsc2UgaWYgKFwidG9wXCIgPT0gZylmb3IgKHZhciBpID0gYSAtIGMgLyAyICogZCArIGQgLyAyLCBqID0gMDsgYyA+PSBqOyBqKyspaC5wdXNoKHtcclxuICAgICAgICAgICAgeDogaSArIGogKiBkLFxyXG4gICAgICAgICAgICB5OiBiIC0gZVxyXG4gICAgICAgIH0pOyBlbHNlIGlmIChcInJpZ2h0XCIgPT0gZylmb3IgKHZhciBpID0gYiAtIGMgLyAyICogZCArIGQgLyAyLCBqID0gMDsgYyA+PSBqOyBqKyspaC5wdXNoKHtcclxuICAgICAgICAgICAgeDogYSArIGUsXHJcbiAgICAgICAgICAgIHk6IGkgKyBqICogZFxyXG4gICAgICAgIH0pOyBlbHNlIGlmIChcImxlZnRcIiA9PSBnKWZvciAodmFyIGkgPSBiIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe3g6IGEgLSBlLCB5OiBpICsgaiAqIGR9KTtcclxuICAgICAgICByZXR1cm4gaFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdyaWRQb3NpdGlvbihhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZyA9IFtdLCBoID0gMDsgYyA+IGg7IGgrKylmb3IgKHZhciBpID0gMDsgZCA+IGk7IGkrKylnLnB1c2goe3g6IGEgKyBpICogZSwgeTogYiArIGggKiBmfSk7XHJcbiAgICAgICAgcmV0dXJuIGdcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZGp1c3RQb3NpdGlvbihyb290LCByb290Q2hpbGRzKSB7XHJcbiAgICAgICAgaWYgKHJvb3QubGF5b3V0KSB7XHJcbiAgICAgICAgICAgIHZhciBsYXlvdXQgPSByb290LmxheW91dDtcclxuICAgICAgICAgICAgdmFyIGxvY2F0aW9uQXJyID0gbnVsbDtcclxuICAgICAgICAgICAgc3dpdGNoIChsYXlvdXQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2lyY2xlJzpcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbGF5b3V0LnJhZGl1cyB8fCBNYXRoLm1heChyb290LndpZHRoLCByb290LmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25BcnIgPSBjaXJjbGVQb3NpdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5jeCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5jeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdENoaWxkcy5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5sYXlvdXQuYmVnaW5BbmdsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5sYXlvdXQuZW5kQW5nbGVcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndHJlZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25BcnIgPSB0cmVlUG9zdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5jeCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5jeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdENoaWxkcy5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dC53aWR0aCB8fCA1MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LmhlaWdodCB8fCA1MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LmRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdncmlkJzpcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkFyciA9IGdyaWRQb3NpdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb290LnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dC5yb3dzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQuY29scyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0Lmhvcml6b250YWwgfHwgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LnZlcnRpY2FsIHx8IDBcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm9vdENoaWxkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgcm9vdENoaWxkc1tpXS5zZXRDZW50ZXJMb2NhdGlvbihsb2NhdGlvbkFycltpXS54LCBsb2NhdGlvbkFycltpXS55KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRSb290Q2hpbGRzKGFsbENoaWxkcywgcm9vdE5vZGUpIHtcclxuICAgICAgICB2YXIgcm9vdENoaWxkcztcclxuICAgICAgICBpZiAocm9vdE5vZGUub3V0TGlua3MgaW5zdGFuY2VvZiBBcnJheSAmJiByb290Tm9kZS5vdXRMaW5rcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJvb3RDaGlsZHMgPSByb290Tm9kZS5vdXRMaW5rcy5tYXAoZnVuY3Rpb24gKGxpbmspIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsaW5rLm5vZGVaO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJvb3RDaGlsZHMgfHwgW107XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbGF5b3V0Tm9kZShzY2VuZSwgcm9vdCwgcmVjdXJzaW9uKSB7XHJcbiAgICAgICAgdmFyIHJvb3RDaGlsZHMgPSBnZXRSb290Q2hpbGRzKHNjZW5lLmNoaWxkcywgcm9vdCk7XHJcbiAgICAgICAgaWYgKDAgIT0gcm9vdENoaWxkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgYWRqdXN0UG9zaXRpb24ocm9vdCwgcm9vdENoaWxkcyk7XHJcbiAgICAgICAgICAgIGlmICgxID09IHJlY3Vyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCByb290Q2hpbGRzLmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0Tm9kZShzY2VuZSwgcm9vdENoaWxkc1tlXSwgcmVjdXJzaW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNwcmluZ0xheW91dChyb290LCBzY2VuZSkge1xyXG4gICAgICAgIHZhciBrZXlBID0gMC4wMTsvL+enu+WKqOW5heW6plxyXG4gICAgICAgIHZhciBrZXlCID0gMC45NTtcclxuICAgICAgICB2YXIgdGVtcCA9IC01O1xyXG4gICAgICAgIHZhciBzdGVwWCA9IDA7XHJcbiAgICAgICAgdmFyIHN0ZXBZID0gMDtcclxuICAgICAgICB2YXIgdGltZXMgPSAwO1xyXG4gICAgICAgIHZhciBub2RlcyA9IHNjZW5lLmdldEVsZW1lbnRzQnlDbGFzcyhqdG9wby5Ob2RlKTtcclxuICAgICAgICBhbm5pbWF0ZSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaGFuZ2Uocm9vdCwgbm9kZSkge1xyXG4gICAgICAgICAgICB2YXIgZGlzWCA9IHJvb3QueCAtIG5vZGUueDtcclxuICAgICAgICAgICAgdmFyIGRpc1kgPSByb290LnkgLSBub2RlLnk7XHJcbiAgICAgICAgICAgIHN0ZXBYICs9IGRpc1ggKiBrZXlBO1xyXG4gICAgICAgICAgICBzdGVwWSArPSBkaXNZICoga2V5QTtcclxuICAgICAgICAgICAgc3RlcFggKj0ga2V5QjtcclxuICAgICAgICAgICAgc3RlcFkgKj0ga2V5QjtcclxuICAgICAgICAgICAgc3RlcFkgKz0gdGVtcDtcclxuICAgICAgICAgICAgbm9kZS54ICs9IHN0ZXBYO1xyXG4gICAgICAgICAgICBub2RlLnkgKz0gc3RlcFk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhbm5pbWF0ZSgpIHtcclxuICAgICAgICAgICAgKyt0aW1lcztcclxuICAgICAgICAgICAgaWYgKHRpbWVzIDwgMTUwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVzW2ldICE9IHJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlKHJvb3QsIG5vZGVzW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFubmltYXRlLCAxZTMgLyAyNClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRUcmVlRGVlcChjaGlsZHMsIHJvb3QpIHtcclxuICAgICAgICBmdW5jdGlvbiByZURlZXAoY2hpbGRzLCByb290LCBkZWVwKSB7XHJcbiAgICAgICAgICAgIHZhciByb290Q2hpbGRzID0gZ2V0Um9vdENoaWxkcyhjaGlsZHMsIHJvb3QpO1xyXG4gICAgICAgICAgICBpZiAoZGVlcCA+IGQpIHtcclxuICAgICAgICAgICAgICAgIGQgPSBkZWVwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgcm9vdENoaWxkcy5sZW5ndGg7IGcrKykge1xyXG4gICAgICAgICAgICAgICAgcmVEZWVwKGNoaWxkcywgcm9vdENoaWxkc1tnXSwgZGVlcCArIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZCA9IDA7XHJcbiAgICAgICAgcmVEZWVwKGNoaWxkcywgcm9vdCwgMCk7XHJcbiAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICB9XHJcblxyXG4gICAganRvcG8ubGF5b3V0ID0ganRvcG8uTGF5b3V0ID0ge1xyXG4gICAgICAgIGxheW91dE5vZGU6IGxheW91dE5vZGUsXHJcbiAgICAgICAgZ2V0Tm9kZUNoaWxkczogZ2V0Um9vdENoaWxkcyxcclxuICAgICAgICBhZGp1c3RQb3NpdGlvbjogYWRqdXN0UG9zaXRpb24sXHJcbiAgICAgICAgc3ByaW5nTGF5b3V0OiBzcHJpbmdMYXlvdXQsXHJcbiAgICAgICAgZ2V0VHJlZURlZXA6IGdldFRyZWVEZWVwLFxyXG4gICAgICAgIGdldFJvb3ROb2RlczogZ2V0Um9vdE5vZGVzLFxyXG4gICAgICAgIEdyaWRMYXlvdXQ6IEdyaWRMYXlvdXQsXHJcbiAgICAgICAgRmxvd0xheW91dDogRmxvd0xheW91dCxcclxuICAgICAgICBBdXRvQm91bmRMYXlvdXQ6IEF1dG9Cb3VuZExheW91dCxcclxuICAgICAgICBDaXJjbGVMYXlvdXQ6IENpcmNsZUxheW91dCxcclxuICAgICAgICBUcmVlTGF5b3V0OiBUcmVlTGF5b3V0LFxyXG4gICAgICAgIGdldE5vZGVzQ2VudGVyOiBnZXROb2Rlc0NlbnRlcixcclxuICAgICAgICBjaXJjbGVMYXlvdXROb2RlczogY2lyY2xlTGF5b3V0Tm9kZXNcclxuICAgIH1cclxufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL3Rvb2xzL2xheW91dC5qc1xuLy8gbW9kdWxlIGlkID0gNDhcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},function(module,exports){eval('module.exports = function (JTopo) {\r\n    function MessageBus(a) {\r\n        this.name = a;\r\n        this.messageMap = {};\r\n        this.messageCount = 0;\r\n    }\r\n\r\n    MessageBus.prototype.subscribe = function (evenName, fn) {\r\n        var d = this.messageMap[evenName];\r\n        if (null == d) {\r\n            this.messageMap[evenName] = [];\r\n        }\r\n        this.messageMap[evenName].push(fn);\r\n        this.messageCount++;\r\n    };\r\n    MessageBus.prototype.unsubscribe = function (evenName, fn) {\r\n        var event = this.messageMap[evenName];\r\n        if (null != event) {\r\n            if (fn && \'function\' == typeof fn) {\r\n                var index = event.indexOf(fn);\r\n                if (index > -1) {\r\n                    event.splice(index, 1);\r\n                }\r\n            } else {\r\n                this.messageMap[evenName] = null;\r\n                delete this.messageMap[evenName];\r\n                this.messageCount--;\r\n            }\r\n        }\r\n    };\r\n    MessageBus.prototype.publish = function (evenName, e, boolean) {\r\n        var eventMap = this.messageMap[evenName];\r\n        if (null != eventMap) {\r\n            eventMap.forEach(function (fn) {\r\n                if (boolean) {\r\n                    setTimeout(function () {\r\n                        fn(e);\r\n                    });\r\n                } else {\r\n                    if (e.target && e.target.qtopo) {\r\n                        fn(e, e.target.qtopo);\r\n                    } else {\r\n                        fn(e);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    function getDistance(pointA, pointB, c, d) {\r\n        var width, height;\r\n        if (null == c && null == d) {\r\n            if (pointA && pointB) {\r\n                width = pointB.x - pointA.x;\r\n                height = pointB.y - pointA.y;\r\n            }\r\n        } else {\r\n            width = c - pointA;\r\n            height = d - pointB;\r\n        }\r\n        return Math.sqrt(width * width + height * height);\r\n    }\r\n\r\n    function getElementsBound(elements) {\r\n        var b = {\r\n            left: Number.MAX_VALUE,\r\n            right: Number.MIN_VALUE,\r\n            top: Number.MAX_VALUE,\r\n            bottom: Number.MIN_VALUE\r\n        };\r\n        elements.forEach(function (element) {\r\n            if (!(element instanceof JTopo.Link)) {\r\n                if (b.left > element.x) {\r\n                    b.left = element.x;\r\n                    b.leftNode = element;\r\n                }\r\n                if (b.right < element.x + element.width) {\r\n                    b.right = element.x + element.width;\r\n                    b.rightNode = element;\r\n                }\r\n                if (b.top > element.y) {\r\n                    b.top = element.y;\r\n                    b.topNode = element;\r\n                }\r\n                if (b.bottom < element.y + element.height) {\r\n                    b.bottom = element.y + element.height;\r\n                    b.bottomNode = element;\r\n                }\r\n            }\r\n        });\r\n        b.width = b.right - b.left;\r\n        b.height = b.bottom - b.top;\r\n        return b;\r\n    }\r\n\r\n    function getEventPosition(event) {\r\n        event = cloneEvent(event);\r\n        if (!event.pageX) {\r\n            event.pageX = event.clientX + document.body.scrollLeft - document.body.clientLeft;\r\n            event.pageY = event.clientY + document.body.scrollTop - document.body.clientTop;\r\n        }\r\n        return event;\r\n    }\r\n\r\n    function rotatePoint(aX, aY, bX, bY, c) {\r\n        var width = bX - aX;\r\n        var height = bY - aY;\r\n        var ditance = Math.sqrt(width * width + height * height);\r\n        var i = Math.atan2(height, width) + c;\r\n        return {\r\n            x: aX + Math.cos(i) * ditance,\r\n            y: aY + Math.sin(i) * ditance\r\n        }\r\n    }\r\n\r\n    function rotatePoints(root, childs, beginAngle) {\r\n        for (var d = [], e = 0; e < childs.length; e++) {\r\n            d.push(rotatePoint(root.x, root.y, childs[e].x, childs[e].y, beginAngle));\r\n        }\r\n        return d\r\n    }\r\n\r\n    function cloneEvent(a) {\r\n        var b = {};\r\n        for (var c in a) {\r\n            if ("returnValue" != c && "keyLocation" != c) {\r\n                b[c] = a[c];\r\n            }\r\n        }\r\n        return b\r\n    }\r\n\r\n    function clone(object) {\r\n        var b = {};\r\n        for (var c in object) {\r\n            b[c] = object[c];\r\n        }\r\n        return b\r\n    }\r\n\r\n    function isPointInRect(rect, points) {\r\n        var X = points.x;\r\n        var Y = points.y;\r\n        var W = points.width;\r\n        var H = points.height;\r\n        return rect.x > X && rect.x < X + W && rect.y > Y && rect.y < Y + H;\r\n    }\r\n\r\n    function isPointInLine(points, start, end) {\r\n        var line = JTopo.util.getDistance(start, end);\r\n        var toStart = JTopo.util.getDistance(start, points);\r\n        var toEnd = JTopo.util.getDistance(end, points);\r\n        return Math.abs(toStart + toEnd - line) <= 0.5;\r\n    }\r\n\r\n    function removeFromArray(arr, item) {\r\n        for (var c = 0; c < arr.length; c++) {\r\n            var d = arr[c];\r\n            if (d === item) {\r\n                arr = arr.del(c);\r\n                break\r\n            }\r\n        }\r\n        return arr\r\n    }\r\n\r\n    function randomColor() {\r\n        return Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random())\r\n    }\r\n\r\n\r\n    function loadStageFromJson(json, canvas) {\r\n        var obj = eval(json), stage = new JTopo.Stage(canvas);\r\n        for (var k in stageObj)if ("scenes" != k)stage[k] = obj[k]; else for (var scenes = obj.scenes, i = 0; i < scenes.length; i++) {\r\n            var sceneObj = scenes[i], scene = new JTopo.Scene(stage);\r\n            for (var p in sceneObj)if ("elements" != p)scene[p] = sceneObj[p]; else for (var nodeMap = {}, elements = sceneObj.elements, m = 0; m < elements.length; m++) {\r\n                var elementObj = elements[m], type = elementObj.elementType, element;\r\n                "Node" == type && (element = new JTopo.Node);\r\n                for (var mk in elementObj)element[mk] = elementObj[mk];\r\n                nodeMap[element.text] = element, scene.add(element)\r\n            }\r\n        }\r\n        return console.log(stage), stage\r\n    }\r\n\r\n    function changeColor(ctx, image, color) {\r\n        var colorArr = color.split(",");\r\n        var R = parseInt(colorArr[0]);\r\n        var G = parseInt(colorArr[1]);\r\n        var B = parseInt(colorArr[2]);\r\n        var imageWidth = canvas.width = image.width;\r\n        var imageHeight = canvas.height = image.height;\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        ctx.drawImage(image, 0, 0);\r\n        var ImageData = ctx.getImageData(0, 0, image.width, image.height);\r\n        var data = ImageData.data;\r\n        for (var i = 0; imageWidth > i; i++) {\r\n            for (var j = 0; imageHeight > j; j++) {\r\n                var n = 4 * (i + j * imageWidth);\r\n                if (0 != data[n + 3]) {\r\n                    if (null != R) {\r\n                        data[n + 0] += R;\r\n                    }\r\n                    if (null != G) {\r\n                        data[n + 1] += G;\r\n                    }\r\n                    if (null != B) {\r\n                        data[n + 2] += B;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        ctx.putImageData(ImageData, 0, 0, 0, 0, image.width, image.height);\r\n        return canvas.toDataURL();\r\n    }\r\n\r\n    function genImageAlarm(image, color) {\r\n        var src = image.src + color;\r\n        if (alarmImageCache[src])return alarmImageCache[src];\r\n        var newImage = new Image;\r\n        newImage.src = changeColor(graphics, image, color);\r\n        alarmImageCache[src] = newImage;\r\n        return newImage;\r\n    }\r\n\r\n    function getOffsetPosition(canvas) {\r\n        if (!canvas) {\r\n            return {left: 0, top: 0};\r\n        }\r\n        var b = 0, c = 0;\r\n        if ("getBoundingClientRect" in document.documentElement) {\r\n            var d = canvas.getBoundingClientRect();\r\n            var e = canvas.ownerDocument;\r\n            var f = e.body;\r\n            var g = e.documentElement;\r\n            var h = g.clientTop || f.clientTop || 0;\r\n            var i = g.clientLeft || f.clientLeft || 0;\r\n            b = d.top + (self.pageYOffset || g && g.scrollTop || f.scrollTop) - h;\r\n            c = d.left + (self.pageXOffset || g && g.scrollLeft || f.scrollLeft) - i;\r\n\r\n        } else {\r\n            do {\r\n                b += canvas.offsetTop || 0;\r\n                c += canvas.offsetLeft || 0;\r\n                canvas = canvas.offsetParent;\r\n            } while (canvas);\r\n        }\r\n        return {left: c, top: b}\r\n    }\r\n\r\n    function lineF(x1, y1, x2, y2) {\r\n        var tan = (y2 - y1) / (x2 - x1);\r\n        var g = y1 - x1 * tan;\r\n        e.k = tan;\r\n        e.b = g;\r\n        e.x1 = x1;\r\n        e.x2 = x2;\r\n        e.y1 = y1;\r\n        e.y2 = y2;\r\n        return e;\r\n        function e(a) {\r\n            return a * tan + g\r\n        }\r\n    }\r\n\r\n    function inRange(a, b, c) {\r\n        var d = Math.abs(b - c), e = Math.abs(b - a), f = Math.abs(c - a), g = Math.abs(d - (e + f));\r\n        return 1e-6 > g ? !0 : !1\r\n    }\r\n\r\n    function isPointInLineSeg(a, b, c) {\r\n        return inRange(a, c.x1, c.x2) && inRange(b, c.y1, c.y2)\r\n    }\r\n\r\n    function intersection(lineFn, lineFnB) {\r\n        var c, d;\r\n        if (lineFn.k != lineFnB.k) {\r\n            if(1 / 0 == lineFn.k || lineFn.k == -1 / 0){\r\n                c = lineFn.x1;\r\n                d = lineFnB(lineFn.x1);\r\n            }else if(1 / 0 == lineFnB.k || lineFnB.k == -1 / 0){\r\n                c = lineFnB.x1;\r\n                d = lineFn(lineFnB.x1);\r\n            }else{\r\n                c = (lineFnB.b - lineFn.b) / (lineFn.k - lineFnB.k);\r\n                d = lineFn(c)\r\n            }\r\n            if(0!= isPointInLineSeg(c, d, lineFn)&&0!= isPointInLineSeg(c, d, lineFnB)){\r\n                return {\r\n                    x: c,\r\n                    y: d\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function intersectionLineBound(lineFn, bound) {\r\n        var newLineFn = JTopo.util.lineF(bound.left, bound.top, bound.left, bound.bottom);\r\n        var d = JTopo.util.intersection(lineFn, newLineFn);\r\n        if (null == d) {\r\n            newLineFn = JTopo.util.lineF(bound.left, bound.top, bound.right, bound.top);\r\n            d = JTopo.util.intersection(lineFn, newLineFn);\r\n            if (null == d) {\r\n                newLineFn = JTopo.util.lineF(bound.right, bound.top, bound.right, bound.bottom);\r\n                d = JTopo.util.intersection(lineFn, newLineFn);\r\n                if (null == d) {\r\n                    newLineFn = JTopo.util.lineF(bound.left, bound.bottom, bound.right, bound.bottom);\r\n                    d = JTopo.util.intersection(lineFn, newLineFn);\r\n                }\r\n            }\r\n        }\r\n\r\n        return d;\r\n    }\r\n\r\n    window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function (a) {\r\n            setTimeout(a, 1e3 / 24)\r\n        };\r\n    Array.prototype.del = function (item) {\r\n        if ("number" != typeof item) {\r\n            var index = this.indexOf(item);\r\n            if (index > -1) {\r\n                this.splice(index, 1);\r\n            }\r\n            return this\r\n        } else {\r\n            if (item > -1) {\r\n                this.splice(item, 1);\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    var canvas = document.createElement("canvas"), graphics = canvas.getContext("2d"), alarmImageCache = {};\r\n    JTopo.util = {\r\n        rotatePoint: rotatePoint,\r\n        rotatePoints: rotatePoints,\r\n        getDistance: getDistance,\r\n        getEventPosition: getEventPosition,\r\n        MessageBus: MessageBus,\r\n        isFirefox: navigator.userAgent.indexOf("Firefox") > 0,\r\n        isIE: !(!window.attachEvent || -1 !== navigator.userAgent.indexOf("Opera")),\r\n        isChrome: null != navigator.userAgent.toLowerCase().match(/chrome/),\r\n        clone: clone,\r\n        isPointInRect: isPointInRect,\r\n        isPointInLine: isPointInLine,\r\n        removeFromArray: removeFromArray,\r\n        cloneEvent: cloneEvent,\r\n        randomColor: randomColor,\r\n        loadStageFromJson: loadStageFromJson,\r\n        getElementsBound: getElementsBound,\r\n        genImageAlarm: genImageAlarm,\r\n        getOffsetPosition: getOffsetPosition,\r\n        lineF: lineF,\r\n        intersection: intersection,\r\n        intersectionLineBound: intersectionLineBound\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvdXRpbC5qcz82MjFmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCLG1CQUFtQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUJBQXVCLGdCQUFnQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBLG1FQUFtRSwwQ0FBMEMsbUJBQW1CO0FBQ2hJO0FBQ0EsOEVBQThFLDJCQUEyQixzQ0FBc0MscUJBQXFCO0FBQ3BLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixnQkFBZ0I7QUFDdkMsMkJBQTJCLGlCQUFpQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGdCQUFnQjtBQUNoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiNDkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChKVG9wbykge1xyXG4gICAgZnVuY3Rpb24gTWVzc2FnZUJ1cyhhKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gYTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VNYXAgPSB7fTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VDb3VudCA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgTWVzc2FnZUJ1cy5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGV2ZW5OYW1lLCBmbikge1xyXG4gICAgICAgIHZhciBkID0gdGhpcy5tZXNzYWdlTWFwW2V2ZW5OYW1lXTtcclxuICAgICAgICBpZiAobnVsbCA9PSBkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV0gPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTWFwW2V2ZW5OYW1lXS5wdXNoKGZuKTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VDb3VudCsrO1xyXG4gICAgfTtcclxuICAgIE1lc3NhZ2VCdXMucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGV2ZW5OYW1lLCBmbikge1xyXG4gICAgICAgIHZhciBldmVudCA9IHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV07XHJcbiAgICAgICAgaWYgKG51bGwgIT0gZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGZuICYmICdmdW5jdGlvbicgPT0gdHlwZW9mIGZuKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBldmVudC5pbmRleE9mKGZuKTtcclxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VDb3VudC0tO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE1lc3NhZ2VCdXMucHJvdG90eXBlLnB1Ymxpc2ggPSBmdW5jdGlvbiAoZXZlbk5hbWUsIGUsIGJvb2xlYW4pIHtcclxuICAgICAgICB2YXIgZXZlbnRNYXAgPSB0aGlzLm1lc3NhZ2VNYXBbZXZlbk5hbWVdO1xyXG4gICAgICAgIGlmIChudWxsICE9IGV2ZW50TWFwKSB7XHJcbiAgICAgICAgICAgIGV2ZW50TWFwLmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYm9vbGVhbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ICYmIGUudGFyZ2V0LnF0b3BvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuKGUsIGUudGFyZ2V0LnF0b3BvKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBnZXREaXN0YW5jZShwb2ludEEsIHBvaW50QiwgYywgZCkge1xyXG4gICAgICAgIHZhciB3aWR0aCwgaGVpZ2h0O1xyXG4gICAgICAgIGlmIChudWxsID09IGMgJiYgbnVsbCA9PSBkKSB7XHJcbiAgICAgICAgICAgIGlmIChwb2ludEEgJiYgcG9pbnRCKSB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHBvaW50Qi54IC0gcG9pbnRBLng7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBwb2ludEIueSAtIHBvaW50QS55O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgd2lkdGggPSBjIC0gcG9pbnRBO1xyXG4gICAgICAgICAgICBoZWlnaHQgPSBkIC0gcG9pbnRCO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHdpZHRoICogd2lkdGggKyBoZWlnaHQgKiBoZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRzQm91bmQoZWxlbWVudHMpIHtcclxuICAgICAgICB2YXIgYiA9IHtcclxuICAgICAgICAgICAgbGVmdDogTnVtYmVyLk1BWF9WQUxVRSxcclxuICAgICAgICAgICAgcmlnaHQ6IE51bWJlci5NSU5fVkFMVUUsXHJcbiAgICAgICAgICAgIHRvcDogTnVtYmVyLk1BWF9WQUxVRSxcclxuICAgICAgICAgICAgYm90dG9tOiBOdW1iZXIuTUlOX1ZBTFVFXHJcbiAgICAgICAgfTtcclxuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBKVG9wby5MaW5rKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGIubGVmdCA+IGVsZW1lbnQueCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIubGVmdCA9IGVsZW1lbnQueDtcclxuICAgICAgICAgICAgICAgICAgICBiLmxlZnROb2RlID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChiLnJpZ2h0IDwgZWxlbWVudC54ICsgZWxlbWVudC53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIucmlnaHQgPSBlbGVtZW50LnggKyBlbGVtZW50LndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGIucmlnaHROb2RlID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChiLnRvcCA+IGVsZW1lbnQueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIudG9wID0gZWxlbWVudC55O1xyXG4gICAgICAgICAgICAgICAgICAgIGIudG9wTm9kZSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYi5ib3R0b20gPCBlbGVtZW50LnkgKyBlbGVtZW50LmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuYm90dG9tID0gZWxlbWVudC55ICsgZWxlbWVudC5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5ib3R0b21Ob2RlID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGIud2lkdGggPSBiLnJpZ2h0IC0gYi5sZWZ0O1xyXG4gICAgICAgIGIuaGVpZ2h0ID0gYi5ib3R0b20gLSBiLnRvcDtcclxuICAgICAgICByZXR1cm4gYjtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRFdmVudFBvc2l0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQgPSBjbG9uZUV2ZW50KGV2ZW50KTtcclxuICAgICAgICBpZiAoIWV2ZW50LnBhZ2VYKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VYID0gZXZlbnQuY2xpZW50WCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCAtIGRvY3VtZW50LmJvZHkuY2xpZW50TGVmdDtcclxuICAgICAgICAgICAgZXZlbnQucGFnZVkgPSBldmVudC5jbGllbnRZICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgLSBkb2N1bWVudC5ib2R5LmNsaWVudFRvcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV2ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJvdGF0ZVBvaW50KGFYLCBhWSwgYlgsIGJZLCBjKSB7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gYlggLSBhWDtcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gYlkgLSBhWTtcclxuICAgICAgICB2YXIgZGl0YW5jZSA9IE1hdGguc3FydCh3aWR0aCAqIHdpZHRoICsgaGVpZ2h0ICogaGVpZ2h0KTtcclxuICAgICAgICB2YXIgaSA9IE1hdGguYXRhbjIoaGVpZ2h0LCB3aWR0aCkgKyBjO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHg6IGFYICsgTWF0aC5jb3MoaSkgKiBkaXRhbmNlLFxyXG4gICAgICAgICAgICB5OiBhWSArIE1hdGguc2luKGkpICogZGl0YW5jZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByb3RhdGVQb2ludHMocm9vdCwgY2hpbGRzLCBiZWdpbkFuZ2xlKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZCA9IFtdLCBlID0gMDsgZSA8IGNoaWxkcy5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICBkLnB1c2gocm90YXRlUG9pbnQocm9vdC54LCByb290LnksIGNoaWxkc1tlXS54LCBjaGlsZHNbZV0ueSwgYmVnaW5BbmdsZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNsb25lRXZlbnQoYSkge1xyXG4gICAgICAgIHZhciBiID0ge307XHJcbiAgICAgICAgZm9yICh2YXIgYyBpbiBhKSB7XHJcbiAgICAgICAgICAgIGlmIChcInJldHVyblZhbHVlXCIgIT0gYyAmJiBcImtleUxvY2F0aW9uXCIgIT0gYykge1xyXG4gICAgICAgICAgICAgICAgYltjXSA9IGFbY107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjbG9uZShvYmplY3QpIHtcclxuICAgICAgICB2YXIgYiA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGMgaW4gb2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGJbY10gPSBvYmplY3RbY107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNQb2ludEluUmVjdChyZWN0LCBwb2ludHMpIHtcclxuICAgICAgICB2YXIgWCA9IHBvaW50cy54O1xyXG4gICAgICAgIHZhciBZID0gcG9pbnRzLnk7XHJcbiAgICAgICAgdmFyIFcgPSBwb2ludHMud2lkdGg7XHJcbiAgICAgICAgdmFyIEggPSBwb2ludHMuaGVpZ2h0O1xyXG4gICAgICAgIHJldHVybiByZWN0LnggPiBYICYmIHJlY3QueCA8IFggKyBXICYmIHJlY3QueSA+IFkgJiYgcmVjdC55IDwgWSArIEg7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaXNQb2ludEluTGluZShwb2ludHMsIHN0YXJ0LCBlbmQpIHtcclxuICAgICAgICB2YXIgbGluZSA9IEpUb3BvLnV0aWwuZ2V0RGlzdGFuY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICAgICAgdmFyIHRvU3RhcnQgPSBKVG9wby51dGlsLmdldERpc3RhbmNlKHN0YXJ0LCBwb2ludHMpO1xyXG4gICAgICAgIHZhciB0b0VuZCA9IEpUb3BvLnV0aWwuZ2V0RGlzdGFuY2UoZW5kLCBwb2ludHMpO1xyXG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0b1N0YXJ0ICsgdG9FbmQgLSBsaW5lKSA8PSAwLjU7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlRnJvbUFycmF5KGFyciwgaXRlbSkge1xyXG4gICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgYXJyLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYXJyW2NdO1xyXG4gICAgICAgICAgICBpZiAoZCA9PT0gaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgYXJyID0gYXJyLmRlbChjKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFyclxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJhbmRvbUNvbG9yKCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKDI1NSAqIE1hdGgucmFuZG9tKCkpICsgXCIsXCIgKyBNYXRoLmZsb29yKDI1NSAqIE1hdGgucmFuZG9tKCkpICsgXCIsXCIgKyBNYXRoLmZsb29yKDI1NSAqIE1hdGgucmFuZG9tKCkpXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIGxvYWRTdGFnZUZyb21Kc29uKGpzb24sIGNhbnZhcykge1xyXG4gICAgICAgIHZhciBvYmogPSBldmFsKGpzb24pLCBzdGFnZSA9IG5ldyBKVG9wby5TdGFnZShjYW52YXMpO1xyXG4gICAgICAgIGZvciAodmFyIGsgaW4gc3RhZ2VPYmopaWYgKFwic2NlbmVzXCIgIT0gaylzdGFnZVtrXSA9IG9ialtrXTsgZWxzZSBmb3IgKHZhciBzY2VuZXMgPSBvYmouc2NlbmVzLCBpID0gMDsgaSA8IHNjZW5lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgc2NlbmVPYmogPSBzY2VuZXNbaV0sIHNjZW5lID0gbmV3IEpUb3BvLlNjZW5lKHN0YWdlKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzY2VuZU9iailpZiAoXCJlbGVtZW50c1wiICE9IHApc2NlbmVbcF0gPSBzY2VuZU9ialtwXTsgZWxzZSBmb3IgKHZhciBub2RlTWFwID0ge30sIGVsZW1lbnRzID0gc2NlbmVPYmouZWxlbWVudHMsIG0gPSAwOyBtIDwgZWxlbWVudHMubGVuZ3RoOyBtKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50T2JqID0gZWxlbWVudHNbbV0sIHR5cGUgPSBlbGVtZW50T2JqLmVsZW1lbnRUeXBlLCBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgXCJOb2RlXCIgPT0gdHlwZSAmJiAoZWxlbWVudCA9IG5ldyBKVG9wby5Ob2RlKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG1rIGluIGVsZW1lbnRPYmopZWxlbWVudFtta10gPSBlbGVtZW50T2JqW21rXTtcclxuICAgICAgICAgICAgICAgIG5vZGVNYXBbZWxlbWVudC50ZXh0XSA9IGVsZW1lbnQsIHNjZW5lLmFkZChlbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhzdGFnZSksIHN0YWdlXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2hhbmdlQ29sb3IoY3R4LCBpbWFnZSwgY29sb3IpIHtcclxuICAgICAgICB2YXIgY29sb3JBcnIgPSBjb2xvci5zcGxpdChcIixcIik7XHJcbiAgICAgICAgdmFyIFIgPSBwYXJzZUludChjb2xvckFyclswXSk7XHJcbiAgICAgICAgdmFyIEcgPSBwYXJzZUludChjb2xvckFyclsxXSk7XHJcbiAgICAgICAgdmFyIEIgPSBwYXJzZUludChjb2xvckFyclsyXSk7XHJcbiAgICAgICAgdmFyIGltYWdlV2lkdGggPSBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDtcclxuICAgICAgICB2YXIgaW1hZ2VIZWlnaHQgPSBjYW52YXMuaGVpZ2h0ID0gaW1hZ2UuaGVpZ2h0O1xyXG4gICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICBjdHguZHJhd0ltYWdlKGltYWdlLCAwLCAwKTtcclxuICAgICAgICB2YXIgSW1hZ2VEYXRhID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0KTtcclxuICAgICAgICB2YXIgZGF0YSA9IEltYWdlRGF0YS5kYXRhO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpbWFnZVdpZHRoID4gaTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBpbWFnZUhlaWdodCA+IGo7IGorKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSA0ICogKGkgKyBqICogaW1hZ2VXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoMCAhPSBkYXRhW24gKyAzXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IFIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtuICsgMF0gKz0gUjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gRykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW24gKyAxXSArPSBHO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBCKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbiArIDJdICs9IEI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0eC5wdXRJbWFnZURhdGEoSW1hZ2VEYXRhLCAwLCAwLCAwLCAwLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0KTtcclxuICAgICAgICByZXR1cm4gY2FudmFzLnRvRGF0YVVSTCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdlbkltYWdlQWxhcm0oaW1hZ2UsIGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIHNyYyA9IGltYWdlLnNyYyArIGNvbG9yO1xyXG4gICAgICAgIGlmIChhbGFybUltYWdlQ2FjaGVbc3JjXSlyZXR1cm4gYWxhcm1JbWFnZUNhY2hlW3NyY107XHJcbiAgICAgICAgdmFyIG5ld0ltYWdlID0gbmV3IEltYWdlO1xyXG4gICAgICAgIG5ld0ltYWdlLnNyYyA9IGNoYW5nZUNvbG9yKGdyYXBoaWNzLCBpbWFnZSwgY29sb3IpO1xyXG4gICAgICAgIGFsYXJtSW1hZ2VDYWNoZVtzcmNdID0gbmV3SW1hZ2U7XHJcbiAgICAgICAgcmV0dXJuIG5ld0ltYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldE9mZnNldFBvc2l0aW9uKGNhbnZhcykge1xyXG4gICAgICAgIGlmICghY2FudmFzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7bGVmdDogMCwgdG9wOiAwfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGIgPSAwLCBjID0gMDtcclxuICAgICAgICBpZiAoXCJnZXRCb3VuZGluZ0NsaWVudFJlY3RcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIHZhciBlID0gY2FudmFzLm93bmVyRG9jdW1lbnQ7XHJcbiAgICAgICAgICAgIHZhciBmID0gZS5ib2R5O1xyXG4gICAgICAgICAgICB2YXIgZyA9IGUuZG9jdW1lbnRFbGVtZW50O1xyXG4gICAgICAgICAgICB2YXIgaCA9IGcuY2xpZW50VG9wIHx8IGYuY2xpZW50VG9wIHx8IDA7XHJcbiAgICAgICAgICAgIHZhciBpID0gZy5jbGllbnRMZWZ0IHx8IGYuY2xpZW50TGVmdCB8fCAwO1xyXG4gICAgICAgICAgICBiID0gZC50b3AgKyAoc2VsZi5wYWdlWU9mZnNldCB8fCBnICYmIGcuc2Nyb2xsVG9wIHx8IGYuc2Nyb2xsVG9wKSAtIGg7XHJcbiAgICAgICAgICAgIGMgPSBkLmxlZnQgKyAoc2VsZi5wYWdlWE9mZnNldCB8fCBnICYmIGcuc2Nyb2xsTGVmdCB8fCBmLnNjcm9sbExlZnQpIC0gaTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgYiArPSBjYW52YXMub2Zmc2V0VG9wIHx8IDA7XHJcbiAgICAgICAgICAgICAgICBjICs9IGNhbnZhcy5vZmZzZXRMZWZ0IHx8IDA7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMgPSBjYW52YXMub2Zmc2V0UGFyZW50O1xyXG4gICAgICAgICAgICB9IHdoaWxlIChjYW52YXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge2xlZnQ6IGMsIHRvcDogYn1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsaW5lRih4MSwgeTEsIHgyLCB5Mikge1xyXG4gICAgICAgIHZhciB0YW4gPSAoeTIgLSB5MSkgLyAoeDIgLSB4MSk7XHJcbiAgICAgICAgdmFyIGcgPSB5MSAtIHgxICogdGFuO1xyXG4gICAgICAgIGUuayA9IHRhbjtcclxuICAgICAgICBlLmIgPSBnO1xyXG4gICAgICAgIGUueDEgPSB4MTtcclxuICAgICAgICBlLngyID0geDI7XHJcbiAgICAgICAgZS55MSA9IHkxO1xyXG4gICAgICAgIGUueTIgPSB5MjtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgICAgICBmdW5jdGlvbiBlKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEgKiB0YW4gKyBnXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGluUmFuZ2UoYSwgYiwgYykge1xyXG4gICAgICAgIHZhciBkID0gTWF0aC5hYnMoYiAtIGMpLCBlID0gTWF0aC5hYnMoYiAtIGEpLCBmID0gTWF0aC5hYnMoYyAtIGEpLCBnID0gTWF0aC5hYnMoZCAtIChlICsgZikpO1xyXG4gICAgICAgIHJldHVybiAxZS02ID4gZyA/ICEwIDogITFcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpc1BvaW50SW5MaW5lU2VnKGEsIGIsIGMpIHtcclxuICAgICAgICByZXR1cm4gaW5SYW5nZShhLCBjLngxLCBjLngyKSAmJiBpblJhbmdlKGIsIGMueTEsIGMueTIpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW50ZXJzZWN0aW9uKGxpbmVGbiwgbGluZUZuQikge1xyXG4gICAgICAgIHZhciBjLCBkO1xyXG4gICAgICAgIGlmIChsaW5lRm4uayAhPSBsaW5lRm5CLmspIHtcclxuICAgICAgICAgICAgaWYoMSAvIDAgPT0gbGluZUZuLmsgfHwgbGluZUZuLmsgPT0gLTEgLyAwKXtcclxuICAgICAgICAgICAgICAgIGMgPSBsaW5lRm4ueDE7XHJcbiAgICAgICAgICAgICAgICBkID0gbGluZUZuQihsaW5lRm4ueDEpO1xyXG4gICAgICAgICAgICB9ZWxzZSBpZigxIC8gMCA9PSBsaW5lRm5CLmsgfHwgbGluZUZuQi5rID09IC0xIC8gMCl7XHJcbiAgICAgICAgICAgICAgICBjID0gbGluZUZuQi54MTtcclxuICAgICAgICAgICAgICAgIGQgPSBsaW5lRm4obGluZUZuQi54MSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgYyA9IChsaW5lRm5CLmIgLSBsaW5lRm4uYikgLyAobGluZUZuLmsgLSBsaW5lRm5CLmspO1xyXG4gICAgICAgICAgICAgICAgZCA9IGxpbmVGbihjKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKDAhPSBpc1BvaW50SW5MaW5lU2VnKGMsIGQsIGxpbmVGbikmJjAhPSBpc1BvaW50SW5MaW5lU2VnKGMsIGQsIGxpbmVGbkIpKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogYyxcclxuICAgICAgICAgICAgICAgICAgICB5OiBkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW50ZXJzZWN0aW9uTGluZUJvdW5kKGxpbmVGbiwgYm91bmQpIHtcclxuICAgICAgICB2YXIgbmV3TGluZUZuID0gSlRvcG8udXRpbC5saW5lRihib3VuZC5sZWZ0LCBib3VuZC50b3AsIGJvdW5kLmxlZnQsIGJvdW5kLmJvdHRvbSk7XHJcbiAgICAgICAgdmFyIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihsaW5lRm4sIG5ld0xpbmVGbik7XHJcbiAgICAgICAgaWYgKG51bGwgPT0gZCkge1xyXG4gICAgICAgICAgICBuZXdMaW5lRm4gPSBKVG9wby51dGlsLmxpbmVGKGJvdW5kLmxlZnQsIGJvdW5kLnRvcCwgYm91bmQucmlnaHQsIGJvdW5kLnRvcCk7XHJcbiAgICAgICAgICAgIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihsaW5lRm4sIG5ld0xpbmVGbik7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IGQpIHtcclxuICAgICAgICAgICAgICAgIG5ld0xpbmVGbiA9IEpUb3BvLnV0aWwubGluZUYoYm91bmQucmlnaHQsIGJvdW5kLnRvcCwgYm91bmQucmlnaHQsIGJvdW5kLmJvdHRvbSk7XHJcbiAgICAgICAgICAgICAgICBkID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb24obGluZUZuLCBuZXdMaW5lRm4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xpbmVGbiA9IEpUb3BvLnV0aWwubGluZUYoYm91bmQubGVmdCwgYm91bmQuYm90dG9tLCBib3VuZC5yaWdodCwgYm91bmQuYm90dG9tKTtcclxuICAgICAgICAgICAgICAgICAgICBkID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb24obGluZUZuLCBuZXdMaW5lRm4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZDtcclxuICAgIH1cclxuXHJcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoYSwgMWUzIC8gMjQpXHJcbiAgICAgICAgfTtcclxuICAgIEFycmF5LnByb3RvdHlwZS5kZWwgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgIGlmIChcIm51bWJlclwiICE9IHR5cGVvZiBpdGVtKSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXhPZihpdGVtKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKGl0ZW0sIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSwgZ3JhcGhpY3MgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpLCBhbGFybUltYWdlQ2FjaGUgPSB7fTtcclxuICAgIEpUb3BvLnV0aWwgPSB7XHJcbiAgICAgICAgcm90YXRlUG9pbnQ6IHJvdGF0ZVBvaW50LFxyXG4gICAgICAgIHJvdGF0ZVBvaW50czogcm90YXRlUG9pbnRzLFxyXG4gICAgICAgIGdldERpc3RhbmNlOiBnZXREaXN0YW5jZSxcclxuICAgICAgICBnZXRFdmVudFBvc2l0aW9uOiBnZXRFdmVudFBvc2l0aW9uLFxyXG4gICAgICAgIE1lc3NhZ2VCdXM6IE1lc3NhZ2VCdXMsXHJcbiAgICAgICAgaXNGaXJlZm94OiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJGaXJlZm94XCIpID4gMCxcclxuICAgICAgICBpc0lFOiAhKCF3aW5kb3cuYXR0YWNoRXZlbnQgfHwgLTEgIT09IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk9wZXJhXCIpKSxcclxuICAgICAgICBpc0Nocm9tZTogbnVsbCAhPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2Nocm9tZS8pLFxyXG4gICAgICAgIGNsb25lOiBjbG9uZSxcclxuICAgICAgICBpc1BvaW50SW5SZWN0OiBpc1BvaW50SW5SZWN0LFxyXG4gICAgICAgIGlzUG9pbnRJbkxpbmU6IGlzUG9pbnRJbkxpbmUsXHJcbiAgICAgICAgcmVtb3ZlRnJvbUFycmF5OiByZW1vdmVGcm9tQXJyYXksXHJcbiAgICAgICAgY2xvbmVFdmVudDogY2xvbmVFdmVudCxcclxuICAgICAgICByYW5kb21Db2xvcjogcmFuZG9tQ29sb3IsXHJcbiAgICAgICAgbG9hZFN0YWdlRnJvbUpzb246IGxvYWRTdGFnZUZyb21Kc29uLFxyXG4gICAgICAgIGdldEVsZW1lbnRzQm91bmQ6IGdldEVsZW1lbnRzQm91bmQsXHJcbiAgICAgICAgZ2VuSW1hZ2VBbGFybTogZ2VuSW1hZ2VBbGFybSxcclxuICAgICAgICBnZXRPZmZzZXRQb3NpdGlvbjogZ2V0T2Zmc2V0UG9zaXRpb24sXHJcbiAgICAgICAgbGluZUY6IGxpbmVGLFxyXG4gICAgICAgIGludGVyc2VjdGlvbjogaW50ZXJzZWN0aW9uLFxyXG4gICAgICAgIGludGVyc2VjdGlvbkxpbmVCb3VuZDogaW50ZXJzZWN0aW9uTGluZUJvdW5kXHJcbiAgICB9XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvanRvcG8vdG9vbHMvdXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gNDlcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){eval('/**\r\n * @module QTopo\r\n */\r\n//require("./core/jtopo/jtopo-min.js");\r\n__webpack_require__(10);\r\nif (typeof jQuery == "undefined") {\r\n    throw new Error("need jquery");\r\n}\r\n/**\r\n * 主入口,window.QTopo\r\n * @class QTopo\r\n * @static\r\n */\r\nvar QTopo = {\r\n    /**\r\n     * 存放当前页面中所初始化的topo实例\r\n     * @property instance {array}\r\n     */\r\n    instance: [],\r\n    /**\r\n     * 一系列工具函数,详细内容参考 QTopo.util\r\n     * @property util {object}\r\n     */\r\n    util: __webpack_require__(11),\r\n    constant: __webpack_require__(8),\r\n    /**\r\n     * 可开启或屏蔽控制台日志,对应用QTopo.util.info以及QTopo.util.error函数输出的日志\r\n     * @property log {object}\r\n     * @param error {boolean} 默认为true,开启\r\n     * @param info {boolean} 默认为true,开启\r\n     */\r\n    log: {\r\n        error: true,\r\n        info: true\r\n    }\r\n};\r\nwindow.QTopo = QTopo;\r\nvar Scene = __webpack_require__(9);\r\n/**\r\n * 初始化Qtopo实例,创建并将其保存在QTopo.instance数组内,实例api参考QTopo.instance\r\n *  @method init\r\n *  @param dom {document} 指定初始化所在的dom,若是数组则自动取第一个\r\n *  @param [config] {object} 配置参数,配置内容为图层scene配置(参考scene配置)\r\n *  @returns [instance] QTopo实例对象，QTopo.instance\r\n *  @example\r\n *      IPOSS = QTopo.init(\r\n *           document.getElementsByClassName("topo_base")[0],\r\n *          {\r\n *              backgroundColor: "#06243e",//基本属性配置背景色\r\n *              path:[] //自定义属性,插入到图层对象scene的额外属性中\r\n *          }\r\n *      );\r\n */\r\nQTopo.init = function (dom, config) {\r\n    dom = dom instanceof Array ? dom[0] : dom;\r\n    var canvas = initCanvas(dom, $(dom).width(), $(dom).height());\r\n    /**\r\n     * QTopo初始化的topo实例,QTopo.init后的返回对象，或是QTopo.instance数组内保存的对象\r\n     * @class QTopo.instance\r\n     * @static\r\n     */\r\n    var QtopoInstance = {\r\n        /**\r\n         * topo实例化的图层对象\r\n         * @property scene {object}\r\n         */\r\n        scene: new Scene(canvas, config),\r\n        setOption: setOption,\r\n        /**\r\n         * topo实例所在dom\r\n         * @property document {document}\r\n         */\r\n        document: dom,\r\n        resize: resize(dom, canvas),\r\n        toJson: toJson\r\n    };\r\n    this.instance.push(QtopoInstance);\r\n    return QtopoInstance;\r\n};\r\nmodule.exports = QTopo;\r\n//---------------------\r\n/**\r\n * 图层绘制主函数\r\n *\r\n * 可以随时使用setOption生成一个或多个元素,或配置告警，也可以一次性全局配置\r\n *\r\n * 相关的全局样式请参考各元素自身的attr属性,或通过 元素的getDefault() / scene.getDefault(type)来获取对应元素的全局样式\r\n *\r\n * 前端绘图过程可以用工具栏和右键菜单绘制完成后,配合实例的toJson函数取得图层数据,(实例通过QTopo.init初始化且保存在QTopo.instance数组内)\r\n *\r\n * 直接将返回对象的option属性传入setOption可复制绘图\r\n *\r\n * 每个元素配置的data数组内成员的属性可以是样式也可以是额外属性,自适应取值配置，过滤的额外属性自动分配到元素的extra属性中保存,可以通过node.val(\'id\')的形式获取\r\n *\r\n * 和样式重名的额外属性可以放在extra中，extra中的属性将默认全部覆盖到元素的extra属性内\r\n *\r\n *  @method setOption\r\n *  @param option {object} 配置属性,参数可以是instance.toJson().option对象\r\n *      @param [option.node] {object} 创建node元素\r\n *          @param [option.node.style] {object} 设定全局的节点样式，未配置样式的节点会采用默认样式\r\n *          @param option.node.data {array} 细则看示例\r\n *      @param [option.container] {object} 创建container元素\r\n *          @param [option.container.style] {object} 设定全局的分组样式，未配置样式的分组会采用默认样式\r\n *          @param option.container.findChildren {string} 通知分组通过什么属性去查找成员\r\n *          @param option.container.data {array} 细则看示例\r\n *      @param [option.link] {object} 创建link元素\r\n *          @param [option.link.style] {object} 设定全局的分组样式，未配置样式的分组会采用默认样式\r\n *          @param option.link.path {array} 通知链接通过什么属性去查找起始点和终点,数组参数可以为1个或2个，当设置为2个时，通过不同属性查找起始点和终点\r\n *          @param option.link.data {array} 细则看示例\r\n *      @param [option.line] {object} 创建line元素\r\n *      @param [option.alarm] {object} 配置告警\r\n *          @param option.alarm.node {string} 通知告警模块如何查找需要设定告警的节点,现只支持节点上的告警\r\n *          @param [option.alarm.animate] {object} 配置告警动画,包含2个属性 ：\r\n *                     1. time:{number}设定间隔时间,单位为毫秒 ,\r\n *                     2. callBack:{function}回调函数,参数为当前处理告警的节点\r\n *          @param option.alarm.data {array} 告警设置,包含3个属性 ：\r\n *                     1. color {string}:告警展示的颜色,255,255,255/#ffffff ,\r\n *                     2. node {string}:对应告警属性下的node为键,此处为值来查找对应的节点 ,\r\n *                     3. [text] {string}:告警显示的文字信息，可不设或为空 ,\r\n *  @param [clear=false] {boolean} 是否清空图层，默认不清除\r\n *  @returns instance\r\n *  QTopo实例自身,用以链式操作\r\n *  @example\r\n *       topo.setOption({\r\n                node: {\r\n                    style:{//全局样式\r\n                        size:[60,60],\r\n                        image: "img/node.png"\r\n                    },\r\n                    data: [{\r\n                            position:[-200,-200],\r\n                            size:[100,100],\r\n                            id:1111,\r\n                            name:"测试1\\nhhhh" //\\n为名称换行\r\n                           },\r\n                           {\r\n                            position:[0,0],\r\n                            size:[100,100],\r\n                            id:2222,\r\n                            name:"测试2\\nhhhh" //\r\n                           }]\r\n                },\r\n                container: {\r\n                    style:{\r\n                        color:"#165782",\r\n                        alpha:0.3,\r\n                        border:{\r\n                            radius:10\r\n                        },\r\n                        namePosition:"top"\r\n                    },\r\n                    findChildren: "id",//这个决定了 每个分组根据data中的数据查找该加入的子,该属性应在node中的value中有配置\r\n                    data: [{\r\n                            size:[400,400],\r\n                            position:[0,0],\r\n                            layout:{\r\n                                type:"fixed"//布局为固定\r\n                            },\r\n                            children: childrenData,\r\n                            toggle:{ //分组切换的节点样式\r\n                                image: "img/node.png"\r\n                            }\r\n                          //  findChildren: "id", 当然也可以针对某个分组单独设置其查找子元素的标记\r\n                            children:["1111","2222"]//findChildren定义为id ，此处就该是对应元素的id属性\r\n                        }]\r\n                },\r\n                link: {\r\n                    style:{\r\n                        color:"#00FFFF"\r\n                    },\r\n                    path: ["id"],   //决定了线的起始节点由什么属性决定,数组长度为1则起始节点按统一属性查找，可分别设不同，0为起始节点属性.1为终点,该属性应在node中的value中有配置\r\n                    data: [{\r\n                                start:1111,//path指明起始点和终点都是找id属性，那此处就是起点的id\r\n                                end:2222,   //终点的id\r\n                                width:10,   //样式配置，详细参考对应元素的属性\r\n                                radius:25,\r\n                                arrow:{\r\n                                    end:true,\r\n                                    start:true,\r\n                                    size:10\r\n                                },\r\n                                extra:{\r\n                                    type:1  //额外属性，因与下述链路类型的名称一致，移直extra内赋值到生成的链路extra上,可通过link.val(\'type\')取到\r\n                                },\r\n                                type:QTopo.constant.link.FLEXIONAL //建立的链路类型\r\n                            }]\r\n                },\r\n                alarm: {\r\n                    node: "alarmId",    //指明节点上对应的查找属性,该属性应在node中的value中有配置,暂只支持节点告警\r\n                    data: [],\r\n                    animate:{   //可设置动画，每个点亮之间延迟多少毫秒，回调函数中能获取到点亮的节点信息\r\n                        time:1000,\r\n                        callBack:function(node){\r\n                            console.info(node)\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n */\r\nfunction setOption(option, clear) {\r\n    option = option || {};\r\n    QTopo.util.info("start set topo: ", option);\r\n    var scene = this.scene;\r\n    if (clear) {\r\n        scene.clear();\r\n    }\r\n    createNode(scene, option.node);\r\n    createContainer(scene, option.container);\r\n    createLink(scene, option.link);\r\n    createLine(scene, option.line);\r\n    drawAlarm(scene, option.alarm);\r\n    QTopo.util.info("set topo complete: ", {\r\n        node: scene.children.node.length,\r\n        link: scene.children.link.length,\r\n        container: scene.children.container.length,\r\n        line: scene.children.line.length\r\n    });\r\n    return this;\r\n}\r\n/**\r\n * 实例自适应大小\r\n *  @method resize\r\n *  @returns instance QTopo实例自身,用以链式操作\r\n *  @example\r\n *      $(window).resize(function () {\r\n *          IPOSS.resize();\r\n *      });\r\n */\r\nfunction resize(dom, canvas) {\r\n    return function () {\r\n        canvas.setAttribute(\'width\', $(dom).width());\r\n        canvas.setAttribute(\'height\', $(dom).height());\r\n        return this;\r\n    }\r\n}\r\n/**\r\n * 当前图层数据转化为json结构\r\n *  @method toJson\r\n *  @returns {object}\r\n *  @example\r\n        var IPOSS=QTopo.instance[0];\r\n        var json=IPOSS.toJson();    //json={\r\n                                    //         init:图层参数,scene对象的参数配置,\r\n                                    //         option:图层内所有对象的属性提取，可直接用于setOption还原,其中jsonId用做每个元素的唯一标识\r\n                                    //      }\r\n        IPOSS.setOption(json.option,true);\r\n */\r\nfunction toJson() {\r\n    var data = this.scene.children;\r\n    var serialized = {\r\n        init: this.scene.toJson(),\r\n        option: {\r\n            node: {\r\n                data: []\r\n            },\r\n            link: {\r\n                data: []\r\n            },\r\n            container: {\r\n                data: []\r\n            },\r\n            line: {\r\n                data: []\r\n            }\r\n        }\r\n    };\r\n    $.each(data, function (name, elements) {\r\n        if ($.isArray(elements)) {\r\n            elements.map(function (element) {\r\n                if (serialized.option[name]) {\r\n                    serialized.option[name].data.push(element.toJson());\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return serialized;\r\n}\r\nfunction initCanvas(dom, width, height) {\r\n    if (width <= 0 || height <= 0) {\r\n        throw new Error("The dom is not exist /not config width and height!");\r\n    }\r\n    dom.style.position = \'relative\';\r\n    dom.style.overflow = \'hidden\';\r\n    var canvas = document.createElement(\'canvas\');\r\n    dom.appendChild(canvas);\r\n    canvas.setAttribute(\'width\', width);\r\n    canvas.setAttribute(\'height\', height);\r\n    canvas.style.position = "absolute";\r\n    canvas.style.top = 0;\r\n    canvas.style.left = 0;\r\n    canvas.style[\'user-select\'] = \'none\';\r\n    canvas.style[\'-webkit-tap-highlight-color\'] = \'rgba(0, 0, 0, 0)\';\r\n    return canvas;\r\n}\r\n\r\nfunction createNode(scene, config) {\r\n    if (config) {\r\n        setDefaults(scene, QTopo.constant.node, config.style);\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, item) {\r\n                var node = scene.createNode(item);\r\n                //额外属性添加\r\n                setExtra(node, item);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n//排除临时元素\r\nfunction notCasual(arr) {\r\n    if (arr.length == 1) {\r\n        return arr[0];\r\n    } else {\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i].getUseType() != QTopo.constant.CASUAL) {\r\n                arr = arr[i];\r\n                return arr;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction createContainer(scene, config) {\r\n    if (config) {\r\n        setDefaults(scene, QTopo.constant.container, config.style);\r\n        makeContainer(scene, config);\r\n    }\r\n}\r\nfunction makeContainer(scene, config) {\r\n    //搜索子的总标记\r\n    var findChild;\r\n    if (config.findChildren) {\r\n        findChild = config.findChildren;\r\n    }\r\n    if ($.isArray(config.data)) {\r\n        //开始构造分组\r\n        $.each(config.data, function (i, item) {\r\n            //无论是否有子元素，分组先创造出来\r\n            var container = scene.createContainer(item);\r\n            //额外属性添加\r\n            setExtra(container, item);\r\n            //确定查找子元素的标记\r\n            var findChild_exact = findChild;\r\n            if (item.findChildren) {\r\n                findChild_exact = item.findChildren;\r\n            }\r\n            makeChildren(scene, container, item, findChild_exact);\r\n        });\r\n    }\r\n}\r\nfunction makeChildren(scene, container, config, findChild) {\r\n    //过滤搜索子类的标记\r\n    findChild = filterTag(findChild);\r\n    if ($.isArray(config.children)) {\r\n        var errorInfo = [];\r\n        $.each(config.children, function (j, children) {\r\n            var child = scene.find(findChild + "=" + children);\r\n            if (child && child.length > 0) {\r\n                $.each(child, function (m, one) {\r\n                    if (one.getUseType() != QTopo.constant.CASUAL) {\r\n                        container.add(one);\r\n                    }\r\n                });\r\n            } else {\r\n                errorInfo.push({\r\n                    index: j,\r\n                    search: findChild + "=" + children\r\n                });\r\n            }\r\n        });\r\n        if (errorInfo.length > 0) {\r\n            QTopo.util.error("some child not found : ", errorInfo);\r\n        }\r\n    }\r\n}\r\nfunction filterTag(tag) {\r\n    if (!tag) {\r\n        tag = \'jsonId\'\r\n    }\r\n    return tag;\r\n}\r\n\r\nfunction createLink(scene, config) {\r\n    if (config) {\r\n        var path = config.path;\r\n        var findStart;\r\n        var findEnd;\r\n        if ($.isArray(path) && path.length > 0) {\r\n            //path为数组，0为起点条件1为终点条件,确定搜索条件,起始点条件可不同\r\n            if (path.length == 1) {\r\n                findEnd = path[0];\r\n                findStart = findEnd;\r\n            } else {\r\n                findStart = path[0];\r\n                findEnd = path[1];\r\n            }\r\n        } else {\r\n            findStart = filterTag(findStart);\r\n            findEnd = filterTag(findEnd);\r\n        }\r\n        //设置默认属性\r\n        setDefaults(scene, QTopo.constant.link, config.style);\r\n        //开始创建\r\n        makeLink(scene, config, findStart, findEnd);\r\n    }\r\n}\r\nfunction makeLink(scene, config, findStart, findEnd) {\r\n    if ($.isArray(config.data)) {\r\n        var errorInfo = [];\r\n        $.each(config.data, function (i, item) {\r\n            if (item) {\r\n                var link;\r\n                //根据确定的条件进行搜索\r\n                var start = notCasual(scene.find(findStart + "=" + item.start));\r\n                var end = notCasual(scene.find(findEnd + "=" + item.end));\r\n                if (start && end) {\r\n                    item.start = start;\r\n                    item.end = end;\r\n                    link = scene.addLink(item);\r\n                    //额外属性添加\r\n                    setExtra(link, item);\r\n                } else {\r\n                    var errorDate = {\r\n                        index: i,\r\n                        data: item\r\n                    };\r\n                    if (!start) {\r\n                        errorDate.missStart = item.start;\r\n                    }\r\n                    if (!end) {\r\n                        errorDate.missEnd = item.end;\r\n                    }\r\n                    errorInfo.push(errorDate);\r\n                }\r\n            } else {\r\n                errorInfo.push({\r\n                    index: i,\r\n                    info: "undefined data"\r\n                });\r\n            }\r\n        });\r\n        if (errorInfo.length > 0) {\r\n            QTopo.util.error("some link invalid : ", errorInfo);\r\n        }\r\n    }\r\n}\r\n//根据配置创建线段\r\nfunction createLine(scene, config) {\r\n    if (config) {\r\n        //设置默认属性\r\n        //设置默认属性\r\n        setDefaults(scene, QTopo.constant.line, config.style);\r\n        //开始创建\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, v) {\r\n                var line = scene.createLine(v);\r\n                //额外属性添加\r\n                setExtra(line, v);\r\n            });\r\n        } else {\r\n            QTopo.util.error("can not draw line,need config \'path\' and \'path\' is Array and not empty,path\'s element need config x y, path used to find start and end");\r\n        }\r\n    }\r\n}\r\n\r\nfunction drawAlarm(scene, config) {\r\n    if (config) {\r\n        if ($.isArray(config.data) && config.node) {\r\n            var alarmData = config.data;\r\n            var alarmNodes = makeAlarmData(scene, alarmData, config);\r\n            QTopo.util.info("告警绘制 :", {\r\n                config: alarmData.length,\r\n                success: alarmNodes.length\r\n            });\r\n            if (config.animate) {\r\n                alarmAnimate(config.animate, alarmNodes);\r\n            } else {\r\n                $.each(alarmNodes, function (i, v) {\r\n                    v.node.set({\r\n                        alarm: v.alarm\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction makeAlarmData(scene, alarmData, config) {\r\n    var alarms = [];\r\n    $.each(alarmData, function (k, v) {\r\n        var node = notCasual(scene.find(config.node + "=" + v["node"], "node"));\r\n        if (node) {\r\n            alarms.push({\r\n                node: node,\r\n                alarm: {\r\n                    show: typeof v.show == "boolean" ? v.show : true,\r\n                    text: v.text,\r\n                    color: v.color,\r\n                    font: v.font\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return alarms;\r\n}\r\nvar animateRuning;\r\nfunction alarmAnimate(animate, alarmNodes) {\r\n    if (animate) {\r\n        if ($.isNumeric(animate.time)) {\r\n            clearAnimat();\r\n            QTopo.util.info("启用告警动画");\r\n            animateRuning = setInterval(function () {\r\n                if (alarmNodes.length > 0) {\r\n                    var data = alarmNodes.pop();\r\n                    data.node.set({\r\n                        alarm: data.alarm\r\n                    });\r\n                    if ($.isFunction(animate.callBack)) {\r\n                        animate.callBack(data.node);\r\n                    }\r\n                } else {\r\n                    QTopo.util.info("告警动画结束");\r\n                    clearAnimat();\r\n                }\r\n            }, parseInt(animate.time));\r\n        }\r\n    }\r\n}\r\nfunction clearAnimat() {\r\n    if (animateRuning) {\r\n        clearInterval(animateRuning);\r\n        animateRuning = "";\r\n    }\r\n}\r\nfunction setExtra(element, data) {\r\n    if (data) {\r\n        $.each(data, function (key, value) {\r\n            if (filterConfig(element, key) && ["start", "end", "children", "toggle", "type", "extra"].indexOf(key) < 0) {\r\n                element.extra[key] = value;\r\n            }\r\n        });\r\n        if (data.extra) {\r\n            $.each(data.extra, function (key, value) {\r\n                if (value) {\r\n                    element.extra[key] = value;\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nfunction filterConfig(element, key) {\r\n    return element && typeof element.attr[key] == \'undefined\';\r\n}\r\nfunction setDefaults(scene, typeArr, style) {\r\n    if (style) {\r\n        $.each(typeArr, function (i, types) {\r\n            scene.setDefault(types, style);\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL21haW4uanM/ZjkwOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCLHFCQUFxQixRQUFRO0FBQzdCLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QixxQkFBcUIsT0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLE9BQU87QUFDMUIsOEJBQThCLE9BQU87QUFDckMsd0NBQXdDLE9BQU87QUFDL0MscUNBQXFDLE1BQU07QUFDM0MsbUNBQW1DLE9BQU87QUFDMUMsNkNBQTZDLE9BQU87QUFDcEQsa0RBQWtELE9BQU87QUFDekQsMENBQTBDLE1BQU07QUFDaEQsOEJBQThCLE9BQU87QUFDckMsd0NBQXdDLE9BQU87QUFDL0MscUNBQXFDLE1BQU07QUFDM0MscUNBQXFDLE1BQU07QUFDM0MsOEJBQThCLE9BQU87QUFDckMsK0JBQStCLE9BQU87QUFDdEMsc0NBQXNDLE9BQU87QUFDN0MsMkNBQTJDLE9BQU87QUFDbEQsZ0NBQWdDLE9BQU87QUFDdkMsb0NBQW9DLFNBQVM7QUFDN0Msc0NBQXNDLE1BQU07QUFDNUMsaUNBQWlDLE9BQU87QUFDeEMsZ0NBQWdDLE9BQU87QUFDdkMsa0NBQWtDLE9BQU87QUFDekMsMEJBQTBCLFFBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSw2QkFBNkI7QUFDN0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLHVCQUF1QixnQkFBZ0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBIiwiZmlsZSI6Ijg2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgUVRvcG9cclxuICovXHJcbi8vcmVxdWlyZShcIi4vY29yZS9qdG9wby9qdG9wby1taW4uanNcIik7XHJcbnJlcXVpcmUoXCIuL2NvcmUvanRvcG8vaW5kZXguanNcIik7XHJcbmlmICh0eXBlb2YgalF1ZXJ5ID09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIm5lZWQganF1ZXJ5XCIpO1xyXG59XHJcbi8qKlxyXG4gKiDkuLvlhaXlj6Msd2luZG93LlFUb3BvXHJcbiAqIEBjbGFzcyBRVG9wb1xyXG4gKiBAc3RhdGljXHJcbiAqL1xyXG52YXIgUVRvcG8gPSB7XHJcbiAgICAvKipcclxuICAgICAqIOWtmOaUvuW9k+WJjemhtemdouS4reaJgOWIneWni+WMlueahHRvcG/lrp7kvotcclxuICAgICAqIEBwcm9wZXJ0eSBpbnN0YW5jZSB7YXJyYXl9XHJcbiAgICAgKi9cclxuICAgIGluc3RhbmNlOiBbXSxcclxuICAgIC8qKlxyXG4gICAgICog5LiA57O75YiX5bel5YW35Ye95pWwLOivpue7huWGheWuueWPguiAgyBRVG9wby51dGlsXHJcbiAgICAgKiBAcHJvcGVydHkgdXRpbCB7b2JqZWN0fVxyXG4gICAgICovXHJcbiAgICB1dGlsOiByZXF1aXJlKCcuL3V0aWwuanMnKSxcclxuICAgIGNvbnN0YW50OiByZXF1aXJlKCcuL2NvbnN0YW50LmpzJyksXHJcbiAgICAvKipcclxuICAgICAqIOWPr+W8gOWQr+aIluWxj+iUveaOp+WItuWPsOaXpeW/lyzlr7nlupTnlKhRVG9wby51dGlsLmluZm/ku6Xlj4pRVG9wby51dGlsLmVycm9y5Ye95pWw6L6T5Ye655qE5pel5b+XXHJcbiAgICAgKiBAcHJvcGVydHkgbG9nIHtvYmplY3R9XHJcbiAgICAgKiBAcGFyYW0gZXJyb3Ige2Jvb2xlYW59IOm7mOiupOS4unRydWUs5byA5ZCvXHJcbiAgICAgKiBAcGFyYW0gaW5mbyB7Ym9vbGVhbn0g6buY6K6k5Li6dHJ1ZSzlvIDlkK9cclxuICAgICAqL1xyXG4gICAgbG9nOiB7XHJcbiAgICAgICAgZXJyb3I6IHRydWUsXHJcbiAgICAgICAgaW5mbzogdHJ1ZVxyXG4gICAgfVxyXG59O1xyXG53aW5kb3cuUVRvcG8gPSBRVG9wbztcclxudmFyIFNjZW5lID0gcmVxdWlyZSgnLi9jb3JlL1NjZW5lLmpzJyk7XHJcbi8qKlxyXG4gKiDliJ3lp4vljJZRdG9wb+WunuS+iyzliJvlu7rlubblsIblhbbkv53lrZjlnKhRVG9wby5pbnN0YW5jZeaVsOe7hOWGhSzlrp7kvothcGnlj4LogINRVG9wby5pbnN0YW5jZVxyXG4gKiAgQG1ldGhvZCBpbml0XHJcbiAqICBAcGFyYW0gZG9tIHtkb2N1bWVudH0g5oyH5a6a5Yid5aeL5YyW5omA5Zyo55qEZG9tLOiLpeaYr+aVsOe7hOWImeiHquWKqOWPluesrOS4gOS4qlxyXG4gKiAgQHBhcmFtIFtjb25maWddIHtvYmplY3R9IOmFjee9ruWPguaVsCzphY3nva7lhoXlrrnkuLrlm77lsYJzY2VuZemFjee9rijlj4LogINzY2VuZemFjee9rilcclxuICogIEByZXR1cm5zIFtpbnN0YW5jZV0gUVRvcG/lrp7kvovlr7nosaHvvIxRVG9wby5pbnN0YW5jZVxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICBJUE9TUyA9IFFUb3BvLmluaXQoXHJcbiAqICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidG9wb19iYXNlXCIpWzBdLFxyXG4gKiAgICAgICAgICB7XHJcbiAqICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiIzA2MjQzZVwiLC8v5Z+65pys5bGe5oCn6YWN572u6IOM5pmv6ImyXHJcbiAqICAgICAgICAgICAgICBwYXRoOltdIC8v6Ieq5a6a5LmJ5bGe5oCnLOaPkuWFpeWIsOWbvuWxguWvueixoXNjZW5l55qE6aKd5aSW5bGe5oCn5LitXHJcbiAqICAgICAgICAgIH1cclxuICogICAgICApO1xyXG4gKi9cclxuUVRvcG8uaW5pdCA9IGZ1bmN0aW9uIChkb20sIGNvbmZpZykge1xyXG4gICAgZG9tID0gZG9tIGluc3RhbmNlb2YgQXJyYXkgPyBkb21bMF0gOiBkb207XHJcbiAgICB2YXIgY2FudmFzID0gaW5pdENhbnZhcyhkb20sICQoZG9tKS53aWR0aCgpLCAkKGRvbSkuaGVpZ2h0KCkpO1xyXG4gICAgLyoqXHJcbiAgICAgKiBRVG9wb+WIneWni+WMlueahHRvcG/lrp7kvossUVRvcG8uaW5pdOWQjueahOi/lOWbnuWvueixoe+8jOaIluaYr1FUb3BvLmluc3RhbmNl5pWw57uE5YaF5L+d5a2Y55qE5a+56LGhXHJcbiAgICAgKiBAY2xhc3MgUVRvcG8uaW5zdGFuY2VcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqL1xyXG4gICAgdmFyIFF0b3BvSW5zdGFuY2UgPSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogdG9wb+WunuS+i+WMlueahOWbvuWxguWvueixoVxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSBzY2VuZSB7b2JqZWN0fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNjZW5lOiBuZXcgU2NlbmUoY2FudmFzLCBjb25maWcpLFxyXG4gICAgICAgIHNldE9wdGlvbjogc2V0T3B0aW9uLFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHRvcG/lrp7kvovmiYDlnKhkb21cclxuICAgICAgICAgKiBAcHJvcGVydHkgZG9jdW1lbnQge2RvY3VtZW50fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRvY3VtZW50OiBkb20sXHJcbiAgICAgICAgcmVzaXplOiByZXNpemUoZG9tLCBjYW52YXMpLFxyXG4gICAgICAgIHRvSnNvbjogdG9Kc29uXHJcbiAgICB9O1xyXG4gICAgdGhpcy5pbnN0YW5jZS5wdXNoKFF0b3BvSW5zdGFuY2UpO1xyXG4gICAgcmV0dXJuIFF0b3BvSW5zdGFuY2U7XHJcbn07XHJcbm1vZHVsZS5leHBvcnRzID0gUVRvcG87XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8qKlxyXG4gKiDlm77lsYLnu5jliLbkuLvlh73mlbBcclxuICpcclxuICog5Y+v5Lul6ZqP5pe25L2/55Soc2V0T3B0aW9u55Sf5oiQ5LiA5Liq5oiW5aSa5Liq5YWD57SgLOaIlumFjee9ruWRiuitpu+8jOS5n+WPr+S7peS4gOasoeaAp+WFqOWxgOmFjee9rlxyXG4gKlxyXG4gKiDnm7jlhbPnmoTlhajlsYDmoLflvI/or7flj4LogIPlkITlhYPntKDoh6rouqvnmoRhdHRy5bGe5oCnLOaIlumAmui/hyDlhYPntKDnmoRnZXREZWZhdWx0KCkgLyBzY2VuZS5nZXREZWZhdWx0KHR5cGUp5p2l6I635Y+W5a+55bqU5YWD57Sg55qE5YWo5bGA5qC35byPXHJcbiAqXHJcbiAqIOWJjeerr+e7mOWbvui/h+eoi+WPr+S7peeUqOW3peWFt+agj+WSjOWPs+mUruiPnOWNlee7mOWItuWujOaIkOWQjizphY3lkIjlrp7kvovnmoR0b0pzb27lh73mlbDlj5blvpflm77lsYLmlbDmja4sKOWunuS+i+mAmui/h1FUb3BvLmluaXTliJ3lp4vljJbkuJTkv53lrZjlnKhRVG9wby5pbnN0YW5jZeaVsOe7hOWGhSlcclxuICpcclxuICog55u05o6l5bCG6L+U5Zue5a+56LGh55qEb3B0aW9u5bGe5oCn5Lyg5YWlc2V0T3B0aW9u5Y+v5aSN5Yi257uY5Zu+XHJcbiAqXHJcbiAqIOavj+S4quWFg+e0oOmFjee9rueahGRhdGHmlbDnu4TlhoXmiJDlkZjnmoTlsZ7mgKflj6/ku6XmmK/moLflvI/kuZ/lj6/ku6XmmK/pop3lpJblsZ7mgKcs6Ieq6YCC5bqU5Y+W5YC86YWN572u77yM6L+H5ruk55qE6aKd5aSW5bGe5oCn6Ieq5Yqo5YiG6YWN5Yiw5YWD57Sg55qEZXh0cmHlsZ7mgKfkuK3kv53lrZgs5Y+v5Lul6YCa6L+Hbm9kZS52YWwoJ2lkJynnmoTlvaLlvI/ojrflj5ZcclxuICpcclxuICog5ZKM5qC35byP6YeN5ZCN55qE6aKd5aSW5bGe5oCn5Y+v5Lul5pS+5ZyoZXh0cmHkuK3vvIxleHRyYeS4reeahOWxnuaAp+Wwhum7mOiupOWFqOmDqOimhuebluWIsOWFg+e0oOeahGV4dHJh5bGe5oCn5YaFXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldE9wdGlvblxyXG4gKiAgQHBhcmFtIG9wdGlvbiB7b2JqZWN0fSDphY3nva7lsZ7mgKcs5Y+C5pWw5Y+v5Lul5pivaW5zdGFuY2UudG9Kc29uKCkub3B0aW9u5a+56LGhXHJcbiAqICAgICAgQHBhcmFtIFtvcHRpb24ubm9kZV0ge29iamVjdH0g5Yib5bu6bm9kZeWFg+e0oFxyXG4gKiAgICAgICAgICBAcGFyYW0gW29wdGlvbi5ub2RlLnN0eWxlXSB7b2JqZWN0fSDorr7lrprlhajlsYDnmoToioLngrnmoLflvI/vvIzmnKrphY3nva7moLflvI/nmoToioLngrnkvJrph4fnlKjpu5jorqTmoLflvI9cclxuICogICAgICAgICAgQHBhcmFtIG9wdGlvbi5ub2RlLmRhdGEge2FycmF5fSDnu4bliJnnnIvnpLrkvotcclxuICogICAgICBAcGFyYW0gW29wdGlvbi5jb250YWluZXJdIHtvYmplY3R9IOWIm+W7umNvbnRhaW5lcuWFg+e0oFxyXG4gKiAgICAgICAgICBAcGFyYW0gW29wdGlvbi5jb250YWluZXIuc3R5bGVdIHtvYmplY3R9IOiuvuWumuWFqOWxgOeahOWIhue7hOagt+W8j++8jOacqumFjee9ruagt+W8j+eahOWIhue7hOS8mumHh+eUqOm7mOiupOagt+W8j1xyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLmNvbnRhaW5lci5maW5kQ2hpbGRyZW4ge3N0cmluZ30g6YCa55+l5YiG57uE6YCa6L+H5LuA5LmI5bGe5oCn5Y675p+l5om+5oiQ5ZGYXHJcbiAqICAgICAgICAgIEBwYXJhbSBvcHRpb24uY29udGFpbmVyLmRhdGEge2FycmF5fSDnu4bliJnnnIvnpLrkvotcclxuICogICAgICBAcGFyYW0gW29wdGlvbi5saW5rXSB7b2JqZWN0fSDliJvlu7psaW5r5YWD57SgXHJcbiAqICAgICAgICAgIEBwYXJhbSBbb3B0aW9uLmxpbmsuc3R5bGVdIHtvYmplY3R9IOiuvuWumuWFqOWxgOeahOWIhue7hOagt+W8j++8jOacqumFjee9ruagt+W8j+eahOWIhue7hOS8mumHh+eUqOm7mOiupOagt+W8j1xyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLmxpbmsucGF0aCB7YXJyYXl9IOmAmuefpemTvuaOpemAmui/h+S7gOS5iOWxnuaAp+WOu+afpeaJvui1t+Wni+eCueWSjOe7iOeCuSzmlbDnu4Tlj4LmlbDlj6/ku6XkuLox5Liq5oiWMuS4qu+8jOW9k+iuvue9ruS4ujLkuKrml7bvvIzpgJrov4fkuI3lkIzlsZ7mgKfmn6Xmib7otbflp4vngrnlkoznu4jngrlcclxuICogICAgICAgICAgQHBhcmFtIG9wdGlvbi5saW5rLmRhdGEge2FycmF5fSDnu4bliJnnnIvnpLrkvotcclxuICogICAgICBAcGFyYW0gW29wdGlvbi5saW5lXSB7b2JqZWN0fSDliJvlu7psaW5l5YWD57SgXHJcbiAqICAgICAgQHBhcmFtIFtvcHRpb24uYWxhcm1dIHtvYmplY3R9IOmFjee9ruWRiuitplxyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLmFsYXJtLm5vZGUge3N0cmluZ30g6YCa55+l5ZGK6K2m5qih5Z2X5aaC5L2V5p+l5om+6ZyA6KaB6K6+5a6a5ZGK6K2m55qE6IqC54K5LOeOsOWPquaUr+aMgeiKgueCueS4iueahOWRiuitplxyXG4gKiAgICAgICAgICBAcGFyYW0gW29wdGlvbi5hbGFybS5hbmltYXRlXSB7b2JqZWN0fSDphY3nva7lkYrorabliqjnlLss5YyF5ZCrMuS4quWxnuaApyDvvJpcclxuICogICAgICAgICAgICAgICAgICAgICAxLiB0aW1lOntudW1iZXJ96K6+5a6a6Ze06ZqU5pe26Ze0LOWNleS9jeS4uuavq+enkiAsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgMi4gY2FsbEJhY2s6e2Z1bmN0aW9ufeWbnuiwg+WHveaVsCzlj4LmlbDkuLrlvZPliY3lpITnkIblkYrorabnmoToioLngrlcclxuICogICAgICAgICAgQHBhcmFtIG9wdGlvbi5hbGFybS5kYXRhIHthcnJheX0g5ZGK6K2m6K6+572uLOWMheWQqzPkuKrlsZ7mgKcg77yaXHJcbiAqICAgICAgICAgICAgICAgICAgICAgMS4gY29sb3Ige3N0cmluZ3065ZGK6K2m5bGV56S655qE6aKc6ImyLDI1NSwyNTUsMjU1LyNmZmZmZmYgLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgIDIuIG5vZGUge3N0cmluZ3065a+55bqU5ZGK6K2m5bGe5oCn5LiL55qEbm9kZeS4uumUrizmraTlpITkuLrlgLzmnaXmn6Xmib7lr7nlupTnmoToioLngrkgLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgIDMuIFt0ZXh0XSB7c3RyaW5nfTrlkYrorabmmL7npLrnmoTmloflrZfkv6Hmga/vvIzlj6/kuI3orr7miJbkuLrnqbogLFxyXG4gKiAgQHBhcmFtIFtjbGVhcj1mYWxzZV0ge2Jvb2xlYW59IOaYr+WQpua4heepuuWbvuWxgu+8jOm7mOiupOS4jea4hemZpFxyXG4gKiAgQHJldHVybnMgaW5zdGFuY2VcclxuICogIFFUb3Bv5a6e5L6L6Ieq6LqrLOeUqOS7pemTvuW8j+aTjeS9nFxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgdG9wby5zZXRPcHRpb24oe1xyXG4gICAgICAgICAgICAgICAgbm9kZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOnsvL+WFqOWxgOagt+W8j1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOls2MCw2MF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBcImltZy9ub2RlLnBuZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246Wy0yMDAsLTIwMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOlsxMDAsMTAwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOjExMTEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOlwi5rWL6K+VMVxcbmhoaGhcIiAvL1xcbuS4uuWQjeensOaNouihjFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjpbMCwwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6WzEwMCwxMDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6MjIyMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6XCLmtYvor5UyXFxuaGhoaFwiIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjpcIiMxNjU3ODJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6MC4zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzOjEwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQb3NpdGlvbjpcInRvcFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBmaW5kQ2hpbGRyZW46IFwiaWRcIiwvL+i/meS4quWGs+WumuS6hiDmr4/kuKrliIbnu4TmoLnmja5kYXRh5Lit55qE5pWw5o2u5p+l5om+6K+l5Yqg5YWl55qE5a2QLOivpeWxnuaAp+W6lOWcqG5vZGXkuK3nmoR2YWx1ZeS4reaciemFjee9rlxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOls0MDAsNDAwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOlswLDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0OntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOlwiZml4ZWRcIi8v5biD5bGA5Li65Zu65a6aXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IGNoaWxkcmVuRGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZTp7IC8v5YiG57uE5YiH5o2i55qE6IqC54K55qC35byPXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IFwiaW1nL25vZGUucG5nXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgZmluZENoaWxkcmVuOiBcImlkXCIsIOW9k+eEtuS5n+WPr+S7pemSiOWvueafkOS4quWIhue7hOWNleeLrOiuvue9ruWFtuafpeaJvuWtkOWFg+e0oOeahOagh+iusFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46W1wiMTExMVwiLFwiMjIyMlwiXS8vZmluZENoaWxkcmVu5a6a5LmJ5Li6aWQg77yM5q2k5aSE5bCx6K+l5piv5a+55bqU5YWD57Sg55qEaWTlsZ7mgKdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBsaW5rOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjpcIiMwMEZGRkZcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogW1wiaWRcIl0sICAgLy/lhrPlrprkuobnur/nmoTotbflp4voioLngrnnlLHku4DkuYjlsZ7mgKflhrPlrpos5pWw57uE6ZW/5bqm5Li6MeWImei1t+Wni+iKgueCueaMiee7n+S4gOWxnuaAp+afpeaJvu+8jOWPr+WIhuWIq+iuvuS4jeWQjO+8jDDkuLrotbflp4voioLngrnlsZ7mgKcuMeS4uue7iOeCuSzor6XlsZ7mgKflupTlnKhub2Rl5Lit55qEdmFsdWXkuK3mnInphY3nva5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OjExMTEsLy9wYXRo5oyH5piO6LW35aeL54K55ZKM57uI54K56YO95piv5om+aWTlsZ7mgKfvvIzpgqPmraTlpITlsLHmmK/otbfngrnnmoRpZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDoyMjIyLCAgIC8v57uI54K555qEaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDoxMCwgICAvL+agt+W8j+mFjee9ru+8jOivpue7huWPguiAg+WvueW6lOWFg+e0oOeahOWxnuaAp1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czoyNSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdzp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDp0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDp0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOjEwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYTp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6MSAgLy/pop3lpJblsZ7mgKfvvIzlm6DkuI7kuIvov7Dpk77ot6/nsbvlnovnmoTlkI3np7DkuIDoh7TvvIznp7vnm7RleHRyYeWGhei1i+WAvOWIsOeUn+aIkOeahOmTvui3r2V4dHJh5LiKLOWPr+mAmui/h2xpbmsudmFsKCd0eXBlJynlj5bliLBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6UVRvcG8uY29uc3RhbnQubGluay5GTEVYSU9OQUwgLy/lu7rnq4vnmoTpk77ot6/nsbvlnotcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYWxhcm06IHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlOiBcImFsYXJtSWRcIiwgICAgLy/mjIfmmI7oioLngrnkuIrlr7nlupTnmoTmn6Xmib7lsZ7mgKcs6K+l5bGe5oCn5bqU5Zyobm9kZeS4reeahHZhbHVl5Lit5pyJ6YWN572uLOaaguWPquaUr+aMgeiKgueCueWRiuitplxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGU6eyAgIC8v5Y+v6K6+572u5Yqo55S777yM5q+P5Liq54K55Lqu5LmL6Ze05bu26L+f5aSa5bCR5q+r56eS77yM5Zue6LCD5Ye95pWw5Lit6IO96I635Y+W5Yiw54K55Lqu55qE6IqC54K55L+h5oGvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6MTAwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2s6ZnVuY3Rpb24obm9kZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8obm9kZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICovXHJcbmZ1bmN0aW9uIHNldE9wdGlvbihvcHRpb24sIGNsZWFyKSB7XHJcbiAgICBvcHRpb24gPSBvcHRpb24gfHwge307XHJcbiAgICBRVG9wby51dGlsLmluZm8oXCJzdGFydCBzZXQgdG9wbzogXCIsIG9wdGlvbik7XHJcbiAgICB2YXIgc2NlbmUgPSB0aGlzLnNjZW5lO1xyXG4gICAgaWYgKGNsZWFyKSB7XHJcbiAgICAgICAgc2NlbmUuY2xlYXIoKTtcclxuICAgIH1cclxuICAgIGNyZWF0ZU5vZGUoc2NlbmUsIG9wdGlvbi5ub2RlKTtcclxuICAgIGNyZWF0ZUNvbnRhaW5lcihzY2VuZSwgb3B0aW9uLmNvbnRhaW5lcik7XHJcbiAgICBjcmVhdGVMaW5rKHNjZW5lLCBvcHRpb24ubGluayk7XHJcbiAgICBjcmVhdGVMaW5lKHNjZW5lLCBvcHRpb24ubGluZSk7XHJcbiAgICBkcmF3QWxhcm0oc2NlbmUsIG9wdGlvbi5hbGFybSk7XHJcbiAgICBRVG9wby51dGlsLmluZm8oXCJzZXQgdG9wbyBjb21wbGV0ZTogXCIsIHtcclxuICAgICAgICBub2RlOiBzY2VuZS5jaGlsZHJlbi5ub2RlLmxlbmd0aCxcclxuICAgICAgICBsaW5rOiBzY2VuZS5jaGlsZHJlbi5saW5rLmxlbmd0aCxcclxuICAgICAgICBjb250YWluZXI6IHNjZW5lLmNoaWxkcmVuLmNvbnRhaW5lci5sZW5ndGgsXHJcbiAgICAgICAgbGluZTogc2NlbmUuY2hpbGRyZW4ubGluZS5sZW5ndGhcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn1cclxuLyoqXHJcbiAqIOWunuS+i+iHqumAguW6lOWkp+Wwj1xyXG4gKiAgQG1ldGhvZCByZXNpemVcclxuICogIEByZXR1cm5zIGluc3RhbmNlIFFUb3Bv5a6e5L6L6Ieq6LqrLOeUqOS7pemTvuW8j+aTjeS9nFxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uICgpIHtcclxuICogICAgICAgICAgSVBPU1MucmVzaXplKCk7XHJcbiAqICAgICAgfSk7XHJcbiAqL1xyXG5mdW5jdGlvbiByZXNpemUoZG9tLCBjYW52YXMpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAkKGRvbSkud2lkdGgoKSk7XHJcbiAgICAgICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJChkb20pLmhlaWdodCgpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxufVxyXG4vKipcclxuICog5b2T5YmN5Zu+5bGC5pWw5o2u6L2s5YyW5Li6anNvbue7k+aehFxyXG4gKiAgQG1ldGhvZCB0b0pzb25cclxuICogIEByZXR1cm5zIHtvYmplY3R9XHJcbiAqICBAZXhhbXBsZVxyXG4gICAgICAgIHZhciBJUE9TUz1RVG9wby5pbnN0YW5jZVswXTtcclxuICAgICAgICB2YXIganNvbj1JUE9TUy50b0pzb24oKTsgICAgLy9qc29uPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBpbml0OuWbvuWxguWPguaVsCxzY2VuZeWvueixoeeahOWPguaVsOmFjee9rixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBvcHRpb2465Zu+5bGC5YaF5omA5pyJ5a+56LGh55qE5bGe5oCn5o+Q5Y+W77yM5Y+v55u05o6l55So5LqOc2V0T3B0aW9u6L+Y5Y6fLOWFtuS4rWpzb25JZOeUqOWBmuavj+S4quWFg+e0oOeahOWUr+S4gOagh+ivhlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgIH1cclxuICAgICAgICBJUE9TUy5zZXRPcHRpb24oanNvbi5vcHRpb24sdHJ1ZSk7XHJcbiAqL1xyXG5mdW5jdGlvbiB0b0pzb24oKSB7XHJcbiAgICB2YXIgZGF0YSA9IHRoaXMuc2NlbmUuY2hpbGRyZW47XHJcbiAgICB2YXIgc2VyaWFsaXplZCA9IHtcclxuICAgICAgICBpbml0OiB0aGlzLnNjZW5lLnRvSnNvbigpLFxyXG4gICAgICAgIG9wdGlvbjoge1xyXG4gICAgICAgICAgICBub2RlOiB7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiBbXVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsaW5rOiB7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiBbXVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb250YWluZXI6IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IFtdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpbmU6IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IFtdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uIChuYW1lLCBlbGVtZW50cykge1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoZWxlbWVudHMpKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnRzLm1hcChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlcmlhbGl6ZWQub3B0aW9uW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplZC5vcHRpb25bbmFtZV0uZGF0YS5wdXNoKGVsZW1lbnQudG9Kc29uKCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBzZXJpYWxpemVkO1xyXG59XHJcbmZ1bmN0aW9uIGluaXRDYW52YXMoZG9tLCB3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICBpZiAod2lkdGggPD0gMCB8fCBoZWlnaHQgPD0gMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBkb20gaXMgbm90IGV4aXN0IC9ub3QgY29uZmlnIHdpZHRoIGFuZCBoZWlnaHQhXCIpO1xyXG4gICAgfVxyXG4gICAgZG9tLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcclxuICAgIGRvbS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xyXG4gICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgZG9tLmFwcGVuZENoaWxkKGNhbnZhcyk7XHJcbiAgICBjYW52YXMuc2V0QXR0cmlidXRlKCd3aWR0aCcsIHdpZHRoKTtcclxuICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIGhlaWdodCk7XHJcbiAgICBjYW52YXMuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XHJcbiAgICBjYW52YXMuc3R5bGUudG9wID0gMDtcclxuICAgIGNhbnZhcy5zdHlsZS5sZWZ0ID0gMDtcclxuICAgIGNhbnZhcy5zdHlsZVsndXNlci1zZWxlY3QnXSA9ICdub25lJztcclxuICAgIGNhbnZhcy5zdHlsZVsnLXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yJ10gPSAncmdiYSgwLCAwLCAwLCAwKSc7XHJcbiAgICByZXR1cm4gY2FudmFzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVOb2RlKHNjZW5lLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICBzZXREZWZhdWx0cyhzY2VuZSwgUVRvcG8uY29uc3RhbnQubm9kZSwgY29uZmlnLnN0eWxlKTtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGNvbmZpZy5kYXRhKSkge1xyXG4gICAgICAgICAgICAkLmVhY2goY29uZmlnLmRhdGEsIGZ1bmN0aW9uIChpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHNjZW5lLmNyZWF0ZU5vZGUoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAvL+mineWkluWxnuaAp+a3u+WKoFxyXG4gICAgICAgICAgICAgICAgc2V0RXh0cmEobm9kZSwgaXRlbSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLy/mjpLpmaTkuLTml7blhYPntKBcclxuZnVuY3Rpb24gbm90Q2FzdWFsKGFycikge1xyXG4gICAgaWYgKGFyci5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgIHJldHVybiBhcnJbMF07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChhcnJbaV0uZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgYXJyID0gYXJyW2ldO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ29udGFpbmVyKHNjZW5lLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICBzZXREZWZhdWx0cyhzY2VuZSwgUVRvcG8uY29uc3RhbnQuY29udGFpbmVyLCBjb25maWcuc3R5bGUpO1xyXG4gICAgICAgIG1ha2VDb250YWluZXIoc2NlbmUsIGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbWFrZUNvbnRhaW5lcihzY2VuZSwgY29uZmlnKSB7XHJcbiAgICAvL+aQnOe0ouWtkOeahOaAu+agh+iusFxyXG4gICAgdmFyIGZpbmRDaGlsZDtcclxuICAgIGlmIChjb25maWcuZmluZENoaWxkcmVuKSB7XHJcbiAgICAgICAgZmluZENoaWxkID0gY29uZmlnLmZpbmRDaGlsZHJlbjtcclxuICAgIH1cclxuICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgLy/lvIDlp4vmnoTpgKDliIbnu4RcclxuICAgICAgICAkLmVhY2goY29uZmlnLmRhdGEsIGZ1bmN0aW9uIChpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIC8v5peg6K665piv5ZCm5pyJ5a2Q5YWD57Sg77yM5YiG57uE5YWI5Yib6YCg5Ye65p2lXHJcbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBzY2VuZS5jcmVhdGVDb250YWluZXIoaXRlbSk7XHJcbiAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgIHNldEV4dHJhKGNvbnRhaW5lciwgaXRlbSk7XHJcbiAgICAgICAgICAgIC8v56Gu5a6a5p+l5om+5a2Q5YWD57Sg55qE5qCH6K6wXHJcbiAgICAgICAgICAgIHZhciBmaW5kQ2hpbGRfZXhhY3QgPSBmaW5kQ2hpbGQ7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmZpbmRDaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgZmluZENoaWxkX2V4YWN0ID0gaXRlbS5maW5kQ2hpbGRyZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbWFrZUNoaWxkcmVuKHNjZW5lLCBjb250YWluZXIsIGl0ZW0sIGZpbmRDaGlsZF9leGFjdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbWFrZUNoaWxkcmVuKHNjZW5lLCBjb250YWluZXIsIGNvbmZpZywgZmluZENoaWxkKSB7XHJcbiAgICAvL+i/h+a7pOaQnOe0ouWtkOexu+eahOagh+iusFxyXG4gICAgZmluZENoaWxkID0gZmlsdGVyVGFnKGZpbmRDaGlsZCk7XHJcbiAgICBpZiAoJC5pc0FycmF5KGNvbmZpZy5jaGlsZHJlbikpIHtcclxuICAgICAgICB2YXIgZXJyb3JJbmZvID0gW107XHJcbiAgICAgICAgJC5lYWNoKGNvbmZpZy5jaGlsZHJlbiwgZnVuY3Rpb24gKGosIGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHNjZW5lLmZpbmQoZmluZENoaWxkICsgXCI9XCIgKyBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZCAmJiBjaGlsZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2goY2hpbGQsIGZ1bmN0aW9uIChtLCBvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob25lLmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmFkZChvbmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JJbmZvLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4OiBqLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaDogZmluZENoaWxkICsgXCI9XCIgKyBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZXJyb3JJbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcInNvbWUgY2hpbGQgbm90IGZvdW5kIDogXCIsIGVycm9ySW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGZpbHRlclRhZyh0YWcpIHtcclxuICAgIGlmICghdGFnKSB7XHJcbiAgICAgICAgdGFnID0gJ2pzb25JZCdcclxuICAgIH1cclxuICAgIHJldHVybiB0YWc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUxpbmsoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBwYXRoID0gY29uZmlnLnBhdGg7XHJcbiAgICAgICAgdmFyIGZpbmRTdGFydDtcclxuICAgICAgICB2YXIgZmluZEVuZDtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KHBhdGgpICYmIHBhdGgubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvL3BhdGjkuLrmlbDnu4TvvIww5Li66LW354K55p2h5Lu2MeS4uue7iOeCueadoeS7tiznoa7lrprmkJzntKLmnaHku7Ys6LW35aeL54K55p2h5Lu25Y+v5LiN5ZCMXHJcbiAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5kRW5kID0gcGF0aFswXTtcclxuICAgICAgICAgICAgICAgIGZpbmRTdGFydCA9IGZpbmRFbmQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmaW5kU3RhcnQgPSBwYXRoWzBdO1xyXG4gICAgICAgICAgICAgICAgZmluZEVuZCA9IHBhdGhbMV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmaW5kU3RhcnQgPSBmaWx0ZXJUYWcoZmluZFN0YXJ0KTtcclxuICAgICAgICAgICAgZmluZEVuZCA9IGZpbHRlclRhZyhmaW5kRW5kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/orr7nva7pu5jorqTlsZ7mgKdcclxuICAgICAgICBzZXREZWZhdWx0cyhzY2VuZSwgUVRvcG8uY29uc3RhbnQubGluaywgY29uZmlnLnN0eWxlKTtcclxuICAgICAgICAvL+W8gOWni+WIm+W7ulxyXG4gICAgICAgIG1ha2VMaW5rKHNjZW5lLCBjb25maWcsIGZpbmRTdGFydCwgZmluZEVuZCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbWFrZUxpbmsoc2NlbmUsIGNvbmZpZywgZmluZFN0YXJ0LCBmaW5kRW5kKSB7XHJcbiAgICBpZiAoJC5pc0FycmF5KGNvbmZpZy5kYXRhKSkge1xyXG4gICAgICAgIHZhciBlcnJvckluZm8gPSBbXTtcclxuICAgICAgICAkLmVhY2goY29uZmlnLmRhdGEsIGZ1bmN0aW9uIChpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGluaztcclxuICAgICAgICAgICAgICAgIC8v5qC55o2u56Gu5a6a55qE5p2h5Lu26L+b6KGM5pCc57SiXHJcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBub3RDYXN1YWwoc2NlbmUuZmluZChmaW5kU3RhcnQgKyBcIj1cIiArIGl0ZW0uc3RhcnQpKTtcclxuICAgICAgICAgICAgICAgIHZhciBlbmQgPSBub3RDYXN1YWwoc2NlbmUuZmluZChmaW5kRW5kICsgXCI9XCIgKyBpdGVtLmVuZCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc3RhcnQgPSBzdGFydDtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmVuZCA9IGVuZDtcclxuICAgICAgICAgICAgICAgICAgICBsaW5rID0gc2NlbmUuYWRkTGluayhpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAvL+mineWkluWxnuaAp+a3u+WKoFxyXG4gICAgICAgICAgICAgICAgICAgIHNldEV4dHJhKGxpbmssIGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JEYXRlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogaSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvckRhdGUubWlzc1N0YXJ0ID0gaXRlbS5zdGFydDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEYXRlLm1pc3NFbmQgPSBpdGVtLmVuZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JJbmZvLnB1c2goZXJyb3JEYXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGVycm9ySW5mby5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleDogaSxcclxuICAgICAgICAgICAgICAgICAgICBpbmZvOiBcInVuZGVmaW5lZCBkYXRhXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGVycm9ySW5mby5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJzb21lIGxpbmsgaW52YWxpZCA6IFwiLCBlcnJvckluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vL+agueaNrumFjee9ruWIm+W7uue6v+autVxyXG5mdW5jdGlvbiBjcmVhdGVMaW5lKHNjZW5lLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAvL+iuvue9rum7mOiupOWxnuaAp1xyXG4gICAgICAgIC8v6K6+572u6buY6K6k5bGe5oCnXHJcbiAgICAgICAgc2V0RGVmYXVsdHMoc2NlbmUsIFFUb3BvLmNvbnN0YW50LmxpbmUsIGNvbmZpZy5zdHlsZSk7XHJcbiAgICAgICAgLy/lvIDlp4vliJvlu7pcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGNvbmZpZy5kYXRhKSkge1xyXG4gICAgICAgICAgICAkLmVhY2goY29uZmlnLmRhdGEsIGZ1bmN0aW9uIChpLCB2KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IHNjZW5lLmNyZWF0ZUxpbmUodik7XHJcbiAgICAgICAgICAgICAgICAvL+mineWkluWxnuaAp+a3u+WKoFxyXG4gICAgICAgICAgICAgICAgc2V0RXh0cmEobGluZSwgdik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjYW4gbm90IGRyYXcgbGluZSxuZWVkIGNvbmZpZyAncGF0aCcgYW5kICdwYXRoJyBpcyBBcnJheSBhbmQgbm90IGVtcHR5LHBhdGgncyBlbGVtZW50IG5lZWQgY29uZmlnIHggeSwgcGF0aCB1c2VkIHRvIGZpbmQgc3RhcnQgYW5kIGVuZFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdBbGFybShzY2VuZSwgY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShjb25maWcuZGF0YSkgJiYgY29uZmlnLm5vZGUpIHtcclxuICAgICAgICAgICAgdmFyIGFsYXJtRGF0YSA9IGNvbmZpZy5kYXRhO1xyXG4gICAgICAgICAgICB2YXIgYWxhcm1Ob2RlcyA9IG1ha2VBbGFybURhdGEoc2NlbmUsIGFsYXJtRGF0YSwgY29uZmlnKTtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5pbmZvKFwi5ZGK6K2m57uY5Yi2IDpcIiwge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnOiBhbGFybURhdGEubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogYWxhcm1Ob2Rlcy5sZW5ndGhcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChjb25maWcuYW5pbWF0ZSkge1xyXG4gICAgICAgICAgICAgICAgYWxhcm1BbmltYXRlKGNvbmZpZy5hbmltYXRlLCBhbGFybU5vZGVzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQuZWFjaChhbGFybU5vZGVzLCBmdW5jdGlvbiAoaSwgdikge1xyXG4gICAgICAgICAgICAgICAgICAgIHYubm9kZS5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGFybTogdi5hbGFybVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbWFrZUFsYXJtRGF0YShzY2VuZSwgYWxhcm1EYXRhLCBjb25maWcpIHtcclxuICAgIHZhciBhbGFybXMgPSBbXTtcclxuICAgICQuZWFjaChhbGFybURhdGEsIGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgdmFyIG5vZGUgPSBub3RDYXN1YWwoc2NlbmUuZmluZChjb25maWcubm9kZSArIFwiPVwiICsgdltcIm5vZGVcIl0sIFwibm9kZVwiKSk7XHJcbiAgICAgICAgaWYgKG5vZGUpIHtcclxuICAgICAgICAgICAgYWxhcm1zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbm9kZTogbm9kZSxcclxuICAgICAgICAgICAgICAgIGFsYXJtOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvdzogdHlwZW9mIHYuc2hvdyA9PSBcImJvb2xlYW5cIiA/IHYuc2hvdyA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdi50ZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB2LmNvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvbnQ6IHYuZm9udFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBhbGFybXM7XHJcbn1cclxudmFyIGFuaW1hdGVSdW5pbmc7XHJcbmZ1bmN0aW9uIGFsYXJtQW5pbWF0ZShhbmltYXRlLCBhbGFybU5vZGVzKSB7XHJcbiAgICBpZiAoYW5pbWF0ZSkge1xyXG4gICAgICAgIGlmICgkLmlzTnVtZXJpYyhhbmltYXRlLnRpbWUpKSB7XHJcbiAgICAgICAgICAgIGNsZWFyQW5pbWF0KCk7XHJcbiAgICAgICAgICAgIFFUb3BvLnV0aWwuaW5mbyhcIuWQr+eUqOWRiuitpuWKqOeUu1wiKTtcclxuICAgICAgICAgICAgYW5pbWF0ZVJ1bmluZyA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhbGFybU5vZGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGFsYXJtTm9kZXMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOiBkYXRhLmFsYXJtXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNGdW5jdGlvbihhbmltYXRlLmNhbGxCYWNrKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlLmNhbGxCYWNrKGRhdGEubm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmluZm8oXCLlkYrorabliqjnlLvnu5PmnZ9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJBbmltYXQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgcGFyc2VJbnQoYW5pbWF0ZS50aW1lKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNsZWFyQW5pbWF0KCkge1xyXG4gICAgaWYgKGFuaW1hdGVSdW5pbmcpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKGFuaW1hdGVSdW5pbmcpO1xyXG4gICAgICAgIGFuaW1hdGVSdW5pbmcgPSBcIlwiO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldEV4dHJhKGVsZW1lbnQsIGRhdGEpIHtcclxuICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXJDb25maWcoZWxlbWVudCwga2V5KSAmJiBbXCJzdGFydFwiLCBcImVuZFwiLCBcImNoaWxkcmVuXCIsIFwidG9nZ2xlXCIsIFwidHlwZVwiLCBcImV4dHJhXCJdLmluZGV4T2Yoa2V5KSA8IDApIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuZXh0cmFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGRhdGEuZXh0cmEpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGRhdGEuZXh0cmEsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmV4dHJhW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGZpbHRlckNvbmZpZyhlbGVtZW50LCBrZXkpIHtcclxuICAgIHJldHVybiBlbGVtZW50ICYmIHR5cGVvZiBlbGVtZW50LmF0dHJba2V5XSA9PSAndW5kZWZpbmVkJztcclxufVxyXG5mdW5jdGlvbiBzZXREZWZhdWx0cyhzY2VuZSwgdHlwZUFyciwgc3R5bGUpIHtcclxuICAgIGlmIChzdHlsZSkge1xyXG4gICAgICAgICQuZWFjaCh0eXBlQXJyLCBmdW5jdGlvbiAoaSwgdHlwZXMpIHtcclxuICAgICAgICAgICAgc2NlbmUuc2V0RGVmYXVsdCh0eXBlcywgc3R5bGUpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9tYWluLmpzXG4vLyBtb2R1bGUgaWQgPSA4NlxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9');
}]);