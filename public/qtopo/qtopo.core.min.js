!function(g){function I(A){if(C[A])return C[A].exports;var n=C[A]={i:A,l:!1,exports:{}};return g[A].call(n.exports,n,n.exports,I),n.l=!0,n.exports}var C={};return I.m=g,I.c=C,I.i=function(g){return g},I.d=function(g,C,A){I.o(g,C)||Object.defineProperty(g,C,{configurable:!1,enumerable:!0,get:A})},I.n=function(g){var C=g&&g.__esModule?function(){return g.default}:function(){return g};return I.d(C,"a",C),C},I.o=function(g,I){return Object.prototype.hasOwnProperty.call(g,I)},I.p="",I(I.s=74)}({1:function(module,exports){eval('/**\r\n * @module core\r\n */\r\nmodule.exports = Element;\r\n/**\r\n * 元素基类,用以继承\r\n * @class [E] Element\r\n * @constructor\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nfunction Element(jtopo) {\r\n    if (jtopo) {\r\n        /**\r\n         * 核心Jtopo对象\r\n         * @property [E] jtopo {Object}\r\n         */\r\n        this.jtopo = jtopo;\r\n        jtopo.qtopo = this;\r\n    }\r\n    if (!this.attr.jsonId) {\r\n        this.attr.jsonId = QTopo.util.makeId();\r\n    }\r\n    /**\r\n     * 预定义的额外属性,参考实际元素\r\n     * @property [E] extra {object}\r\n     */\r\n    this.extra = {};\r\n    /**\r\n     * 预定义的基本属性，参考实际元素\r\n     * @property [E] attr {object}\r\n     */\r\n}\r\n/**\r\n *  设置jsonId\r\n *  @method [E] setJsonId\r\n *  @param id {string} id\r\n */\r\nElement.prototype.setJsonId = function (id) {\r\n    this.attr.jsonId = id;\r\n};\r\n/**\r\n *  显示元素\r\n *  @method [E] show\r\n */\r\nElement.prototype.show = function () {\r\n    switch (this.getType()) {\r\n        case QTopo.constant.NODE:\r\n            toggleNode.call(this, true);\r\n            break;\r\n        case QTopo.constant.CONTAINER:\r\n            toggleContainer.call(this, true);\r\n            break;\r\n        case QTopo.constant.LINK:\r\n            toggleLink.call(this, true);\r\n    }\r\n};\r\n/**\r\n *  隐藏元素\r\n *  @method [E] hide\r\n */\r\nElement.prototype.hide = function () {\r\n    switch (this.getType()) {\r\n        case QTopo.constant.NODE:\r\n            toggleNode.call(this, false);\r\n            break;\r\n        case QTopo.constant.CONTAINER:\r\n            toggleContainer.call(this, false);\r\n            break;\r\n        case QTopo.constant.LINK:\r\n            toggleLink.call(this, false);\r\n    }\r\n};\r\n/**\r\n *  设置使用类型\r\n *  @method [E] setUseType\r\n *  @param type {string}\r\n */\r\nElement.prototype.setUseType = function (type) {\r\n    this.attr.useType = type;\r\n};\r\n/**\r\n *  获取使用类型\r\n *  @method [E] getUseType\r\n *  @return {string}\r\n */\r\nElement.prototype.getUseType = function () {\r\n    return this.attr.useType;\r\n};\r\n/**\r\n *  设置元素文本\r\n *  @method [E] setText\r\n *  @param text {string}\r\n */\r\nElement.prototype.setText = function (text) {\r\n    if (text) {\r\n        this.jtopo.text = (text + "").trim();\r\n    }\r\n    this.attr.text = this.jtopo.text;\r\n};\r\n/**\r\n *  设置元素边框\r\n *  @method [E] setBorder\r\n *  @param border {object}\r\n *  color:颜色,width:宽度,radius:角弧度\r\n */\r\nElement.prototype.setBorder = function (border) {\r\n    var jtopo = this.jtopo;\r\n    if (border.color) {\r\n        jtopo.borderColor = QTopo.util.transHex(border.color.toLowerCase());\r\n    }\r\n    if ($.isNumeric(border.width)) {\r\n        jtopo.borderWidth = parseInt(border.width);\r\n    }\r\n    if ($.isNumeric(border.radius)) {\r\n        jtopo.borderRadius = parseInt(border.radius);\r\n    }\r\n    this.attr.border.color = jtopo.borderColor;\r\n    this.attr.border.width = jtopo.borderWidth;\r\n    this.attr.border.radius = jtopo.borderRadius;\r\n};\r\n/**\r\n *  绑定事件,可用off删除对应事件\r\n *  @method [E] on\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param fn {function} 处理函数\r\n */\r\nElement.prototype.on = function (name, fn) {\r\n    this.jtopo.addEventListener(name, function (e) {\r\n        if (e.target && e.target.qtopo) {\r\n            fn(e, e.target.qtopo);\r\n        } else {\r\n            fn(e);\r\n        }\r\n    });\r\n};\r\n/**\r\n *  解除事件，可删除on绑定的事件\r\n *  @method [E] off\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *   @param [fn]{function} 处理的函数对象，若无参则删除该事件下所有函数\r\n */\r\nElement.prototype.off = function (name, fn) {\r\n    this.jtopo.removeEventListener(name);\r\n};\r\n/**\r\n *  设置元素层级\r\n *  @method [E] setZIndex\r\n *  @param zIndex {number} 值高的元素覆盖在值低的元素上,默认节点>链接>分组\r\n */\r\nElement.prototype.setZIndex = function (zIndex) {\r\n    if ($.isNumeric(zIndex)) {\r\n        this.jtopo.zIndex = parseInt(zIndex);\r\n    }\r\n    this.attr.zIndex = this.jtopo.zIndex;\r\n};\r\n/**\r\n *  设置元素字体\r\n *  @method [E] setFont\r\n *  @param font {object}\r\n *\r\n *  type:字体,\r\n *  color:颜色,\r\n *  size:大小\r\n */\r\nElement.prototype.setFont = function (font) {\r\n    var type = this.attr.font.type;\r\n    var size = this.attr.font.size;\r\n    if (font) {\r\n        if ($.isNumeric(font.size)) {\r\n            size = font.size;\r\n        }\r\n        if (font.type) {\r\n            type = font.type;\r\n        }\r\n        this.jtopo.font = (size ? size : 14) + "px " + type;\r\n        if (font.color) {\r\n            this.jtopo.fontColor = QTopo.util.transHex(font.color.toLowerCase());\r\n        }\r\n    }\r\n    this.attr.font.type = type;\r\n    this.attr.font.size = size;\r\n    this.attr.font.color = this.jtopo.fontColor;\r\n};\r\n/**\r\n *  设置元素透明度\r\n *  @method [E] setAlpha\r\n *  @param alpha {number} 值域0-1\r\n */\r\nElement.prototype.setAlpha = function (alpha) {\r\n    if ($.isNumeric(alpha) && alpha <= 1 && alpha > 0) {\r\n        this.jtopo.alpha = alpha;\r\n    } else {\r\n        this.jtopo.alpha = 1;\r\n    }\r\n    this.attr.alpha = this.jtopo.alpha;\r\n};\r\n/**\r\n *  设置元素位置\r\n *  @method [E] setPosition\r\n *  @param position {array} [x,y]在图层上的坐标\r\n */\r\nElement.prototype.setPosition = function (position) {\r\n    if ($.isArray(position) && position.length >= 2) {\r\n        if ($.isNumeric(position[0]) && $.isNumeric(position[1])) {\r\n            this.jtopo.setLocation(parseInt(position[0]), parseInt(position[1]));\r\n        }\r\n    }\r\n};\r\n/**\r\n *  设置元素大小\r\n *  @method [E] setSize\r\n *  @param size {array} [width,height]\r\n */\r\nElement.prototype.setSize = function (size) {\r\n    if ($.isArray(size) && $.isNumeric(size[0]) && $.isNumeric(size[1])) {\r\n        this.jtopo.setSize(parseInt(size[0]), parseInt(size[1]));\r\n    } else {\r\n        this.jtopo.setSize(64, 64);\r\n    }\r\n    this.attr.size = [this.jtopo.width, this.jtopo.height];\r\n};\r\n/**\r\n *  元素是否锁定位置\r\n *  @method [E] setDragable\r\n *  @param dragable {boolean}\r\n */\r\nElement.prototype.setDragable = function (dragable) {\r\n    if (typeof dragable == \'boolean\') {\r\n        this.jtopo.dragable = dragable;\r\n    }\r\n    this.attr.dragable = this.jtopo.dragable;\r\n};\r\n/**\r\n *  设置元素文字位置\r\n *  @method [E] setNamePosition\r\n *  @param [namePosition] {string} 无参则设为bottom\r\n *\r\n *  hide,bottom,top,left,right,center\r\n *\r\n */\r\nElement.prototype.setNamePosition = function (namePosition) {\r\n    var jtopo = this.jtopo;\r\n    jtopo.text = this.attr.name || "";\r\n    switch (namePosition) {\r\n        case \'hide\':\r\n            jtopo.text = \'\';\r\n            this.attr.namePosition = "hide";\r\n            break;\r\n        case \'bottom\':\r\n            jtopo.textOffsetX = 0;\r\n            jtopo.textOffsetY = 0;\r\n            jtopo.textPosition = "Bottom_Center";\r\n            this.attr.namePosition = "bottom";\r\n            break;\r\n        case \'top\':\r\n            jtopo.textOffsetX = 0;\r\n            jtopo.textOffsetY = 0;\r\n            jtopo.textPosition = "Top_Center";\r\n            this.attr.namePosition = "top";\r\n            break;\r\n        case \'left\':\r\n            jtopo.textOffsetX = -5;\r\n            jtopo.textOffsetY = 0;\r\n            jtopo.textPosition = "Middle_Left";\r\n            this.attr.namePosition = "left";\r\n            break;\r\n        case \'right\':\r\n            jtopo.textOffsetX = 5;\r\n            jtopo.textOffsetY = 0;\r\n            jtopo.textPosition = "Middle_Right";\r\n            this.attr.namePosition = "right";\r\n            break;\r\n        case "center":\r\n            jtopo.textOffsetX = 0;\r\n            jtopo.textOffsetY = 0;\r\n            jtopo.textPosition = "Middle_Center";\r\n            this.attr.namePosition = "center";\r\n            break;\r\n        default:\r\n            jtopo.textOffsetX = 0;\r\n            jtopo.textOffsetY = 0;\r\n            jtopo.textPosition = \'Bottom_Center\';\r\n            this.attr.namePosition = "bottom";\r\n            QTopo.util.error(this, "set wrong namePosition,default is bottom");\r\n            break;\r\n    }\r\n};\r\n/**\r\n *  私有函数,设置元素属性,只要有对应函数则传入参数设置,不应直接调用\r\n *\r\n *  实际元素中应重写set函数，在set函数中对特殊参数做处理后再调用该函数\r\n *  @method [E] _setAttr\r\n *  @param config {object}\r\n */\r\nElement.prototype._setAttr = function (config) {\r\n    var self = this;\r\n    $.each(config, function (k, v) {\r\n        try {\r\n            var fn = self[\'set\' + QTopo.util.upFirst(k)];\r\n            if (fn) {\r\n                fn.call(self, v);\r\n            }\r\n        } catch (e) {\r\n            QTopo.util.error(self, "Element _setAttr error :" + k, e);\r\n        }\r\n    });\r\n};\r\n/**\r\n * 获取元素基本属性\r\n *  @method [E] get\r\n *  @param name {string} 属性名\r\n *  @example\r\n *          Element.setPosition([100,100])\r\n *          Element.get(\'position\')       //[100,100]\r\n */\r\nElement.prototype.get = function (name) {\r\n    return this.attr[name];\r\n};\r\n/**\r\n * 获取元素的属性,修改/赋值元素额外属性\r\n *  @method [E] val\r\n *  @param key {string} 属性名\r\n *\r\n *  要操作的属性名,与get不同，该函数会在整个对象中查找与key匹配的属性\r\n *\r\n *  无论是额外属性还是基本属性又或是Element.xx属性，只要匹配成功即返回.\r\n *\r\n *  优先级为 额外属性>基本属性>Element.xx属性\r\n *\r\n *  用该函数赋予额外属性时，可以直接传入一个对象作为参数\r\n *\r\n *  该函数会遍历该参数对象将其内容全部覆盖到额外属性上\r\n *\r\n *  @param [value] {string|object|void} 值,无参则为取值\r\n *  @example\r\n *\r\n *       赋值操作   1. Element.val(\'pid\',\'12345\')\r\n *                  2. Element.val({\r\n *                          pid:"12345",\r\n *                          path:[]\r\n *                      })\r\n *       取属性操作 Element.val(\'pid\')       //"12345"\r\n *                  Element.val(\'position\') //[x,y]\r\n *                  Element.val(\'path\')       //[]\r\n *                  Element.val(\'name\')       //""\r\n */\r\nElement.prototype.val = function (key, value) {\r\n    if (QTopo.util.getClass(key) == \'Object\') {\r\n        var self = this;\r\n        $.each(key, function (name, value) {\r\n            self.extra[name] = value;\r\n        })\r\n    } else {\r\n        if (typeof value == \'undefined\') {\r\n            var result;\r\n            if (this.extra[key]) {\r\n                result = this.extra[key];\r\n            } else if (this.attr[key]) {\r\n                result = this.attr[key];\r\n            } else {\r\n                result = this[key];\r\n            }\r\n            return result;\r\n        } else {\r\n            this.extra[key] = value;\r\n        }\r\n    }\r\n};\r\n/*\r\n * 对象links属性内的所有线进行切换\r\n * @links node/container的links属性\r\n * @fnName \'show\'/\'hide\'方法名\r\n */\r\nfunction toggle(links, fnName) {\r\n    try {\r\n        $.each(links, function (name, arr) {\r\n            arr.forEach(function (item) {\r\n                item[fnName]();\r\n            });\r\n        })\r\n    } catch (e) {\r\n        QTopo.util.error("切换隐藏/显示时错误", e);\r\n    }\r\n}\r\n//线的显示只有当其两端节点都显示时才显示\r\nfunction toggleLink(flag) {\r\n    if (flag) {\r\n        if (this.path.start.jtopo && this.path.end.jtopo) {\r\n            if (this.path.start.jtopo.visible && this.path.end.jtopo.visible) {\r\n                this.jtopo.visible = true;\r\n            }\r\n        }\r\n    } else {\r\n        this.jtopo.visible = false;\r\n    }\r\n}\r\nfunction toggleNode(flag) {\r\n    this.jtopo.visible = flag;\r\n    var string = flag ? "show" : "hide";\r\n    toggle(this.links, string);\r\n}\r\nfunction toggleContainer(flag) {\r\n    this.jtopo.visible = flag;\r\n    var string = flag ? "show" : "hide";\r\n    //切换子类显示隐藏\r\n    for (var i = 0; i < this.children.length; i++) {\r\n        this.children[i][string]();\r\n    }\r\n    toggle(this.links, string);\r\n}\r\n/**\r\n * 获取元素中心坐标\r\n *  @method [E] getCenterPosition\r\n *  @return {object} {x,y}\r\n */\r\nElement.prototype.getCenterPosition = function () {\r\n    return {\r\n        x: this.jtopo.cx,\r\n        y: this.jtopo.cy\r\n    }\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9FbGVtZW50LmpzPzg1ZDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLE1BQU07QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixNQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLE9BQU87QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE9BQU87QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtQkFBbUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDBCQUEwQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTyxFQUFFO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBjb3JlXHJcbiAqL1xyXG5tb2R1bGUuZXhwb3J0cyA9IEVsZW1lbnQ7XHJcbi8qKlxyXG4gKiDlhYPntKDln7rnsbss55So5Lul57un5om/XHJcbiAqIEBjbGFzcyBbRV0gRWxlbWVudFxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQHBhcmFtIGp0b3BvIOWFg+e0oOaguOW/g+eahGp0b3Bv5a+56LGhXHJcbiAqL1xyXG5mdW5jdGlvbiBFbGVtZW50KGp0b3BvKSB7XHJcbiAgICBpZiAoanRvcG8pIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmoLjlv4NKdG9wb+WvueixoVxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSBbRV0ganRvcG8ge09iamVjdH1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmp0b3BvID0ganRvcG87XHJcbiAgICAgICAganRvcG8ucXRvcG8gPSB0aGlzO1xyXG4gICAgfVxyXG4gICAgaWYgKCF0aGlzLmF0dHIuanNvbklkKSB7XHJcbiAgICAgICAgdGhpcy5hdHRyLmpzb25JZCA9IFFUb3BvLnV0aWwubWFrZUlkKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmihOWumuS5ieeahOmineWkluWxnuaApyzlj4LogIPlrp7pmYXlhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBbRV0gZXh0cmEge29iamVjdH1cclxuICAgICAqL1xyXG4gICAgdGhpcy5leHRyYSA9IHt9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpooTlrprkuYnnmoTln7rmnKzlsZ7mgKfvvIzlj4LogIPlrp7pmYXlhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBbRV0gYXR0ciB7b2JqZWN0fVxyXG4gICAgICovXHJcbn1cclxuLyoqXHJcbiAqICDorr7nva5qc29uSWRcclxuICogIEBtZXRob2QgW0VdIHNldEpzb25JZFxyXG4gKiAgQHBhcmFtIGlkIHtzdHJpbmd9IGlkXHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5zZXRKc29uSWQgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgIHRoaXMuYXR0ci5qc29uSWQgPSBpZDtcclxufTtcclxuLyoqXHJcbiAqICDmmL7npLrlhYPntKBcclxuICogIEBtZXRob2QgW0VdIHNob3dcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBzd2l0Y2ggKHRoaXMuZ2V0VHlwZSgpKSB7XHJcbiAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5OT0RFOlxyXG4gICAgICAgICAgICB0b2dnbGVOb2RlLmNhbGwodGhpcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSOlxyXG4gICAgICAgICAgICB0b2dnbGVDb250YWluZXIuY2FsbCh0aGlzLCB0cnVlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5MSU5LOlxyXG4gICAgICAgICAgICB0b2dnbGVMaW5rLmNhbGwodGhpcywgdHJ1ZSk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6ZqQ6JeP5YWD57SgXHJcbiAqICBAbWV0aG9kIFtFXSBoaWRlXHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc3dpdGNoICh0aGlzLmdldFR5cGUoKSkge1xyXG4gICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuTk9ERTpcclxuICAgICAgICAgICAgdG9nZ2xlTm9kZS5jYWxsKHRoaXMsIGZhbHNlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5DT05UQUlORVI6XHJcbiAgICAgICAgICAgIHRvZ2dsZUNvbnRhaW5lci5jYWxsKHRoaXMsIGZhbHNlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5MSU5LOlxyXG4gICAgICAgICAgICB0b2dnbGVMaW5rLmNhbGwodGhpcywgZmFsc2UpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiuvue9ruS9v+eUqOexu+Wei1xyXG4gKiAgQG1ldGhvZCBbRV0gc2V0VXNlVHlwZVxyXG4gKiAgQHBhcmFtIHR5cGUge3N0cmluZ31cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldFVzZVR5cGUgPSBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgdGhpcy5hdHRyLnVzZVR5cGUgPSB0eXBlO1xyXG59O1xyXG4vKipcclxuICogIOiOt+WPluS9v+eUqOexu+Wei1xyXG4gKiAgQG1ldGhvZCBbRV0gZ2V0VXNlVHlwZVxyXG4gKiAgQHJldHVybiB7c3RyaW5nfVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuZ2V0VXNlVHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB0aGlzLmF0dHIudXNlVHlwZTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDmlofmnKxcclxuICogIEBtZXRob2QgW0VdIHNldFRleHRcclxuICogIEBwYXJhbSB0ZXh0IHtzdHJpbmd9XHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5zZXRUZXh0ID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgIGlmICh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gKHRleHQgKyBcIlwiKS50cmltKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIudGV4dCA9IHRoaXMuanRvcG8udGV4dDtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDovrnmoYZcclxuICogIEBtZXRob2QgW0VdIHNldEJvcmRlclxyXG4gKiAgQHBhcmFtIGJvcmRlciB7b2JqZWN0fVxyXG4gKiAgY29sb3I66aKc6ImyLHdpZHRoOuWuveW6pixyYWRpdXM66KeS5byn5bqmXHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5zZXRCb3JkZXIgPSBmdW5jdGlvbiAoYm9yZGVyKSB7XHJcbiAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvO1xyXG4gICAgaWYgKGJvcmRlci5jb2xvcikge1xyXG4gICAgICAgIGp0b3BvLmJvcmRlckNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChib3JkZXIuY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICBpZiAoJC5pc051bWVyaWMoYm9yZGVyLndpZHRoKSkge1xyXG4gICAgICAgIGp0b3BvLmJvcmRlcldpZHRoID0gcGFyc2VJbnQoYm9yZGVyLndpZHRoKTtcclxuICAgIH1cclxuICAgIGlmICgkLmlzTnVtZXJpYyhib3JkZXIucmFkaXVzKSkge1xyXG4gICAgICAgIGp0b3BvLmJvcmRlclJhZGl1cyA9IHBhcnNlSW50KGJvcmRlci5yYWRpdXMpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmJvcmRlci5jb2xvciA9IGp0b3BvLmJvcmRlckNvbG9yO1xyXG4gICAgdGhpcy5hdHRyLmJvcmRlci53aWR0aCA9IGp0b3BvLmJvcmRlcldpZHRoO1xyXG4gICAgdGhpcy5hdHRyLmJvcmRlci5yYWRpdXMgPSBqdG9wby5ib3JkZXJSYWRpdXM7XHJcbn07XHJcbi8qKlxyXG4gKiAg57uR5a6a5LqL5Lu2LOWPr+eUqG9mZuWIoOmZpOWvueW6lOS6i+S7tlxyXG4gKiAgQG1ldGhvZCBbRV0gb25cclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9IOS6i+S7tuWQjVxyXG4gKlxyXG4gKiAgY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcclxuICpcclxuICogIEBwYXJhbSBmbiB7ZnVuY3Rpb259IOWkhOeQhuWHveaVsFxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgIHRoaXMuanRvcG8uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5xdG9wbykge1xyXG4gICAgICAgICAgICBmbihlLCBlLnRhcmdldC5xdG9wbyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm4oZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qKlxyXG4gKiAg6Kej6Zmk5LqL5Lu277yM5Y+v5Yig6Zmkb27nu5HlrprnmoTkuovku7ZcclxuICogIEBtZXRob2QgW0VdIG9mZlxyXG4gKiAgQHBhcmFtIG5hbWUge3N0cmluZ30g5LqL5Lu25ZCNXHJcbiAqXHJcbiAqICBjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLG1vdXNld2hlZWwsdG91Y2hzdGFydCx0b3VjaG1vdmUsdG91Y2hlbmQsa2V5ZG93bixrZXl1cFxyXG4gKlxyXG4gKiAgIEBwYXJhbSBbZm5de2Z1bmN0aW9ufSDlpITnkIbnmoTlh73mlbDlr7nosaHvvIzoi6Xml6Dlj4LliJnliKDpmaTor6Xkuovku7bkuIvmiYDmnInlh73mlbBcclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChuYW1lLCBmbikge1xyXG4gICAgdGhpcy5qdG9wby5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUpO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWFg+e0oOWxgue6p1xyXG4gKiAgQG1ldGhvZCBbRV0gc2V0WkluZGV4XHJcbiAqICBAcGFyYW0gekluZGV4IHtudW1iZXJ9IOWAvOmrmOeahOWFg+e0oOimhuebluWcqOWAvOS9jueahOWFg+e0oOS4iizpu5jorqToioLngrk+6ZO+5o6lPuWIhue7hFxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0WkluZGV4ID0gZnVuY3Rpb24gKHpJbmRleCkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHpJbmRleCkpIHtcclxuICAgICAgICB0aGlzLmp0b3BvLnpJbmRleCA9IHBhcnNlSW50KHpJbmRleCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuekluZGV4ID0gdGhpcy5qdG9wby56SW5kZXg7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg5a2X5L2TXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRGb250XHJcbiAqICBAcGFyYW0gZm9udCB7b2JqZWN0fVxyXG4gKlxyXG4gKiAgdHlwZTrlrZfkvZMsXHJcbiAqICBjb2xvcjrpopzoibIsXHJcbiAqICBzaXplOuWkp+Wwj1xyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0Rm9udCA9IGZ1bmN0aW9uIChmb250KSB7XHJcbiAgICB2YXIgdHlwZSA9IHRoaXMuYXR0ci5mb250LnR5cGU7XHJcbiAgICB2YXIgc2l6ZSA9IHRoaXMuYXR0ci5mb250LnNpemU7XHJcbiAgICBpZiAoZm9udCkge1xyXG4gICAgICAgIGlmICgkLmlzTnVtZXJpYyhmb250LnNpemUpKSB7XHJcbiAgICAgICAgICAgIHNpemUgPSBmb250LnNpemU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmb250LnR5cGUpIHtcclxuICAgICAgICAgICAgdHlwZSA9IGZvbnQudHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5qdG9wby5mb250ID0gKHNpemUgPyBzaXplIDogMTQpICsgXCJweCBcIiArIHR5cGU7XHJcbiAgICAgICAgaWYgKGZvbnQuY29sb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5mb250Q29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGZvbnQuY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmZvbnQudHlwZSA9IHR5cGU7XHJcbiAgICB0aGlzLmF0dHIuZm9udC5zaXplID0gc2l6ZTtcclxuICAgIHRoaXMuYXR0ci5mb250LmNvbG9yID0gdGhpcy5qdG9wby5mb250Q29sb3I7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg6YCP5piO5bqmXHJcbiAqICBAbWV0aG9kIFtFXSBzZXRBbHBoYVxyXG4gKiAgQHBhcmFtIGFscGhhIHtudW1iZXJ9IOWAvOWfnzAtMVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0QWxwaGEgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhhbHBoYSkgJiYgYWxwaGEgPD0gMSAmJiBhbHBoYSA+IDApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmFscGhhID0gYWxwaGE7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuanRvcG8uYWxwaGEgPSAxO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmFscGhhID0gdGhpcy5qdG9wby5hbHBoYTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lhYPntKDkvY3nva5cclxuICogIEBtZXRob2QgW0VdIHNldFBvc2l0aW9uXHJcbiAqICBAcGFyYW0gcG9zaXRpb24ge2FycmF5fSBbeCx5XeWcqOWbvuWxguS4iueahOWdkOagh1xyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0UG9zaXRpb24gPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcclxuICAgIGlmICgkLmlzQXJyYXkocG9zaXRpb24pICYmIHBvc2l0aW9uLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgICAgaWYgKCQuaXNOdW1lcmljKHBvc2l0aW9uWzBdKSAmJiAkLmlzTnVtZXJpYyhwb3NpdGlvblsxXSkpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5zZXRMb2NhdGlvbihwYXJzZUludChwb3NpdGlvblswXSksIHBhcnNlSW50KHBvc2l0aW9uWzFdKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiuvue9ruWFg+e0oOWkp+Wwj1xyXG4gKiAgQG1ldGhvZCBbRV0gc2V0U2l6ZVxyXG4gKiAgQHBhcmFtIHNpemUge2FycmF5fSBbd2lkdGgsaGVpZ2h0XVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0U2l6ZSA9IGZ1bmN0aW9uIChzaXplKSB7XHJcbiAgICBpZiAoJC5pc0FycmF5KHNpemUpICYmICQuaXNOdW1lcmljKHNpemVbMF0pICYmICQuaXNOdW1lcmljKHNpemVbMV0pKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zZXRTaXplKHBhcnNlSW50KHNpemVbMF0pLCBwYXJzZUludChzaXplWzFdKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuanRvcG8uc2V0U2l6ZSg2NCwgNjQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLnNpemUgPSBbdGhpcy5qdG9wby53aWR0aCwgdGhpcy5qdG9wby5oZWlnaHRdO1xyXG59O1xyXG4vKipcclxuICogIOWFg+e0oOaYr+WQpumUgeWumuS9jee9rlxyXG4gKiAgQG1ldGhvZCBbRV0gc2V0RHJhZ2FibGVcclxuICogIEBwYXJhbSBkcmFnYWJsZSB7Ym9vbGVhbn1cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLnNldERyYWdhYmxlID0gZnVuY3Rpb24gKGRyYWdhYmxlKSB7XHJcbiAgICBpZiAodHlwZW9mIGRyYWdhYmxlID09ICdib29sZWFuJykge1xyXG4gICAgICAgIHRoaXMuanRvcG8uZHJhZ2FibGUgPSBkcmFnYWJsZTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kcmFnYWJsZSA9IHRoaXMuanRvcG8uZHJhZ2FibGU7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5YWD57Sg5paH5a2X5L2N572uXHJcbiAqICBAbWV0aG9kIFtFXSBzZXROYW1lUG9zaXRpb25cclxuICogIEBwYXJhbSBbbmFtZVBvc2l0aW9uXSB7c3RyaW5nfSDml6Dlj4LliJnorr7kuLpib3R0b21cclxuICpcclxuICogIGhpZGUsYm90dG9tLHRvcCxsZWZ0LHJpZ2h0LGNlbnRlclxyXG4gKlxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuc2V0TmFtZVBvc2l0aW9uID0gZnVuY3Rpb24gKG5hbWVQb3NpdGlvbikge1xyXG4gICAgdmFyIGp0b3BvID0gdGhpcy5qdG9wbztcclxuICAgIGp0b3BvLnRleHQgPSB0aGlzLmF0dHIubmFtZSB8fCBcIlwiO1xyXG4gICAgc3dpdGNoIChuYW1lUG9zaXRpb24pIHtcclxuICAgICAgICBjYXNlICdoaWRlJzpcclxuICAgICAgICAgICAganRvcG8udGV4dCA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIubmFtZVBvc2l0aW9uID0gXCJoaWRlXCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2JvdHRvbSc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIkJvdHRvbV9DZW50ZXJcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwiYm90dG9tXCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIlRvcF9DZW50ZXJcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwidG9wXCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgICAgICBqdG9wby50ZXh0T2Zmc2V0WCA9IC01O1xyXG4gICAgICAgICAgICBqdG9wby50ZXh0T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRQb3NpdGlvbiA9IFwiTWlkZGxlX0xlZnRcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwibGVmdFwiO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gNTtcclxuICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIk1pZGRsZV9SaWdodFwiO1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIubmFtZVBvc2l0aW9uID0gXCJyaWdodFwiO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiY2VudGVyXCI6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSBcIk1pZGRsZV9DZW50ZXJcIjtcclxuICAgICAgICAgICAgdGhpcy5hdHRyLm5hbWVQb3NpdGlvbiA9IFwiY2VudGVyXCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGp0b3BvLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAganRvcG8udGV4dE9mZnNldFkgPSAwO1xyXG4gICAgICAgICAgICBqdG9wby50ZXh0UG9zaXRpb24gPSAnQm90dG9tX0NlbnRlcic7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5uYW1lUG9zaXRpb24gPSBcImJvdHRvbVwiO1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKHRoaXMsIFwic2V0IHdyb25nIG5hbWVQb3NpdGlvbixkZWZhdWx0IGlzIGJvdHRvbVwiKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg56eB5pyJ5Ye95pWwLOiuvue9ruWFg+e0oOWxnuaApyzlj6ropoHmnInlr7nlupTlh73mlbDliJnkvKDlhaXlj4LmlbDorr7nva4s5LiN5bqU55u05o6l6LCD55SoXHJcbiAqXHJcbiAqICDlrp7pmYXlhYPntKDkuK3lupTph43lhplzZXTlh73mlbDvvIzlnKhzZXTlh73mlbDkuK3lr7nnibnmrorlj4LmlbDlgZrlpITnkIblkI7lho3osIPnlKjor6Xlh73mlbBcclxuICogIEBtZXRob2QgW0VdIF9zZXRBdHRyXHJcbiAqICBAcGFyYW0gY29uZmlnIHtvYmplY3R9XHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS5fc2V0QXR0ciA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICQuZWFjaChjb25maWcsIGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIGZuID0gc2VsZlsnc2V0JyArIFFUb3BvLnV0aWwudXBGaXJzdChrKV07XHJcbiAgICAgICAgICAgIGlmIChmbikge1xyXG4gICAgICAgICAgICAgICAgZm4uY2FsbChzZWxmLCB2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihzZWxmLCBcIkVsZW1lbnQgX3NldEF0dHIgZXJyb3IgOlwiICsgaywgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDln7rmnKzlsZ7mgKdcclxuICogIEBtZXRob2QgW0VdIGdldFxyXG4gKiAgQHBhcmFtIG5hbWUge3N0cmluZ30g5bGe5oCn5ZCNXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICBFbGVtZW50LnNldFBvc2l0aW9uKFsxMDAsMTAwXSlcclxuICogICAgICAgICAgRWxlbWVudC5nZXQoJ3Bvc2l0aW9uJykgICAgICAgLy9bMTAwLDEwMF1cclxuICovXHJcbkVsZW1lbnQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICByZXR1cm4gdGhpcy5hdHRyW25hbWVdO1xyXG59O1xyXG4vKipcclxuICog6I635Y+W5YWD57Sg55qE5bGe5oCnLOS/ruaUuS/otYvlgLzlhYPntKDpop3lpJblsZ7mgKdcclxuICogIEBtZXRob2QgW0VdIHZhbFxyXG4gKiAgQHBhcmFtIGtleSB7c3RyaW5nfSDlsZ7mgKflkI1cclxuICpcclxuICogIOimgeaTjeS9nOeahOWxnuaAp+WQjSzkuI5nZXTkuI3lkIzvvIzor6Xlh73mlbDkvJrlnKjmlbTkuKrlr7nosaHkuK3mn6Xmib7kuI5rZXnljLnphY3nmoTlsZ7mgKdcclxuICpcclxuICogIOaXoOiuuuaYr+mineWkluWxnuaAp+i/mOaYr+WfuuacrOWxnuaAp+WPiOaIluaYr0VsZW1lbnQueHjlsZ7mgKfvvIzlj6ropoHljLnphY3miJDlip/ljbPov5Tlm54uXHJcbiAqXHJcbiAqICDkvJjlhYjnuqfkuLog6aKd5aSW5bGe5oCnPuWfuuacrOWxnuaApz5FbGVtZW50Lnh45bGe5oCnXHJcbiAqXHJcbiAqICDnlKjor6Xlh73mlbDotYvkuojpop3lpJblsZ7mgKfml7bvvIzlj6/ku6Xnm7TmjqXkvKDlhaXkuIDkuKrlr7nosaHkvZzkuLrlj4LmlbBcclxuICpcclxuICogIOivpeWHveaVsOS8mumBjeWOhuivpeWPguaVsOWvueixoeWwhuWFtuWGheWuueWFqOmDqOimhuebluWIsOmineWkluWxnuaAp+S4ilxyXG4gKlxyXG4gKiAgQHBhcmFtIFt2YWx1ZV0ge3N0cmluZ3xvYmplY3R8dm9pZH0g5YC8LOaXoOWPguWImeS4uuWPluWAvFxyXG4gKiAgQGV4YW1wbGVcclxuICpcclxuICogICAgICAg6LWL5YC85pON5L2cICAgMS4gRWxlbWVudC52YWwoJ3BpZCcsJzEyMzQ1JylcclxuICogICAgICAgICAgICAgICAgICAyLiBFbGVtZW50LnZhbCh7XHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBwaWQ6XCIxMjM0NVwiLFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDpbXVxyXG4gKiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gKiAgICAgICDlj5blsZ7mgKfmk43kvZwgRWxlbWVudC52YWwoJ3BpZCcpICAgICAgIC8vXCIxMjM0NVwiXHJcbiAqICAgICAgICAgICAgICAgICAgRWxlbWVudC52YWwoJ3Bvc2l0aW9uJykgLy9beCx5XVxyXG4gKiAgICAgICAgICAgICAgICAgIEVsZW1lbnQudmFsKCdwYXRoJykgICAgICAgLy9bXVxyXG4gKiAgICAgICAgICAgICAgICAgIEVsZW1lbnQudmFsKCduYW1lJykgICAgICAgLy9cIlwiXHJcbiAqL1xyXG5FbGVtZW50LnByb3RvdHlwZS52YWwgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgaWYgKFFUb3BvLnV0aWwuZ2V0Q2xhc3Moa2V5KSA9PSAnT2JqZWN0Jykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAkLmVhY2goa2V5LCBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgc2VsZi5leHRyYVtuYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgIH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZXh0cmFba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5leHRyYVtrZXldO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXR0cltrZXldKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmF0dHJba2V5XTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXh0cmFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLypcclxuICog5a+56LGhbGlua3PlsZ7mgKflhoXnmoTmiYDmnInnur/ov5vooYzliIfmjaJcclxuICogQGxpbmtzIG5vZGUvY29udGFpbmVy55qEbGlua3PlsZ7mgKdcclxuICogQGZuTmFtZSAnc2hvdycvJ2hpZGUn5pa55rOV5ZCNXHJcbiAqL1xyXG5mdW5jdGlvbiB0b2dnbGUobGlua3MsIGZuTmFtZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICAkLmVhY2gobGlua3MsIGZ1bmN0aW9uIChuYW1lLCBhcnIpIHtcclxuICAgICAgICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW1bZm5OYW1lXSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCLliIfmjaLpmpDol48v5pi+56S65pe26ZSZ6K+vXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbi8v57q/55qE5pi+56S65Y+q5pyJ5b2T5YW25Lik56uv6IqC54K56YO95pi+56S65pe25omN5pi+56S6XHJcbmZ1bmN0aW9uIHRvZ2dsZUxpbmsoZmxhZykge1xyXG4gICAgaWYgKGZsYWcpIHtcclxuICAgICAgICBpZiAodGhpcy5wYXRoLnN0YXJ0Lmp0b3BvICYmIHRoaXMucGF0aC5lbmQuanRvcG8pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucGF0aC5zdGFydC5qdG9wby52aXNpYmxlICYmIHRoaXMucGF0aC5lbmQuanRvcG8udmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5qdG9wby52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby52aXNpYmxlID0gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdG9nZ2xlTm9kZShmbGFnKSB7XHJcbiAgICB0aGlzLmp0b3BvLnZpc2libGUgPSBmbGFnO1xyXG4gICAgdmFyIHN0cmluZyA9IGZsYWcgPyBcInNob3dcIiA6IFwiaGlkZVwiO1xyXG4gICAgdG9nZ2xlKHRoaXMubGlua3MsIHN0cmluZyk7XHJcbn1cclxuZnVuY3Rpb24gdG9nZ2xlQ29udGFpbmVyKGZsYWcpIHtcclxuICAgIHRoaXMuanRvcG8udmlzaWJsZSA9IGZsYWc7XHJcbiAgICB2YXIgc3RyaW5nID0gZmxhZyA/IFwic2hvd1wiIDogXCJoaWRlXCI7XHJcbiAgICAvL+WIh+aNouWtkOexu+aYvuekuumakOiXj1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbltpXVtzdHJpbmddKCk7XHJcbiAgICB9XHJcbiAgICB0b2dnbGUodGhpcy5saW5rcywgc3RyaW5nKTtcclxufVxyXG4vKipcclxuICog6I635Y+W5YWD57Sg5Lit5b+D5Z2Q5qCHXHJcbiAqICBAbWV0aG9kIFtFXSBnZXRDZW50ZXJQb3NpdGlvblxyXG4gKiAgQHJldHVybiB7b2JqZWN0fSB7eCx5fVxyXG4gKi9cclxuRWxlbWVudC5wcm90b3R5cGUuZ2V0Q2VudGVyUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHg6IHRoaXMuanRvcG8uY3gsXHJcbiAgICAgICAgeTogdGhpcy5qdG9wby5jeVxyXG4gICAgfVxyXG59O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L0VsZW1lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},10:function(module,exports){eval('!function (window) {\r\n    function Element() {\r\n        this.initialize = function () {\r\n            this.elementType = "element", this.serializedProperties = ["elementType"], this.propertiesStack = [], this._id = "" + (new Date).getTime()\r\n        }, this.distroy = function () {\r\n        }, this.removeHandler = function () {\r\n        }, this.attr = function (a, b) {\r\n            if (null != a && null != b)this[a] = b; else if (null != a)return this[a];\r\n            return this\r\n        }, this.save = function () {\r\n            var a = this, b = {};\r\n            this.serializedProperties.forEach(function (c) {\r\n                b[c] = a[c]\r\n            }), this.propertiesStack.push(b)\r\n        }, this.restore = function () {\r\n            if (null != this.propertiesStack && 0 != this.propertiesStack.length) {\r\n                var a = this, b = this.propertiesStack.pop();\r\n                this.serializedProperties.forEach(function (c) {\r\n                    a[c] = b[c]\r\n                })\r\n            }\r\n        }, this.toJson = function () {\r\n            var a = this, b = "{", c = this.serializedProperties.length;\r\n            return this.serializedProperties.forEach(function (d, e) {\r\n                var f = a[d];\r\n                "string" == typeof f && (f = \'"\' + f + \'"\'), b += \'"\' + d + \'":\' + f, c > e + 1 && (b += ",")\r\n            }), b += "}"\r\n        }\r\n    }\r\n\r\n    /*a=this.x - this.borderWidth / 2 b=this.y - this.borderWidth / 2,*/\r\n    CanvasRenderingContext2D.prototype.JTopoRoundRect = function (a, b, w_borderWidth, h_borderWidth, borderRadius) {\r\n        //画元素圆角边框\r\n        "undefined" == typeof borderRadius && (borderRadius = 5),\r\n            this.beginPath(),\r\n            this.moveTo(a + borderRadius, b),\r\n            this.lineTo(a + w_borderWidth - borderRadius, b),\r\n            this.quadraticCurveTo(a + w_borderWidth, b, a + w_borderWidth, b + borderRadius),\r\n            this.lineTo(a + w_borderWidth, b + h_borderWidth - borderRadius),\r\n            this.quadraticCurveTo(a + w_borderWidth, b + h_borderWidth, a + w_borderWidth - borderRadius, b + h_borderWidth),\r\n            this.lineTo(a + borderRadius, b + h_borderWidth),\r\n            this.quadraticCurveTo(a, b + h_borderWidth, a, b + h_borderWidth - borderRadius),\r\n            this.lineTo(a, b + borderRadius),\r\n            this.quadraticCurveTo(a, b, a + borderRadius, b),\r\n            this.closePath()\r\n    };\r\n    CanvasRenderingContext2D.prototype.JTopoDashedLineTo = function (sX, sY, eX, eY, dashedPattern) {\r\n        //画虚线\r\n        if ("undefined" == typeof dashedPattern) {\r\n            dashedPattern = 5;\r\n        }\r\n        var dX = eX - sX;\r\n        var dY = eY - sY;\r\n        var length = Math.floor(Math.sqrt(dX * dX + dY * dY));\r\n        var dashL = 0 >= dashedPattern ? length : length / dashedPattern;\r\n        var tY = dY / length * dashedPattern;\r\n        var tX = dX / length * dashedPattern;\r\n        this.beginPath();\r\n        for (var m = 0; dashL > m; m++) {\r\n            if (m % 2) {\r\n                this.lineTo(sX + m * tX, sY + m * tY);\r\n            } else {\r\n                this.moveTo(sX + m * tX, sY + m * tY);\r\n            }\r\n        }\r\n        this.stroke();\r\n    };\r\n    var JTopo = {\r\n        version: "0.4.8_01",\r\n        zIndex_Container: 1,\r\n        zIndex_Link: 2,\r\n        zIndex_Node: 3,\r\n        SceneMode: {normal: "normal", drag: "drag", edit: "edit", select: "select"},\r\n        MouseCursor: {\r\n            normal: "default",\r\n            pointer: "pointer",\r\n            top_left: "nw-resize",\r\n            top_center: "n-resize",\r\n            top_right: "ne-resize",\r\n            middle_left: "e-resize",\r\n            middle_right: "e-resize",\r\n            bottom_left: "ne-resize",\r\n            bottom_center: "n-resize",\r\n            bottom_right: "nw-resize",\r\n            move: "move",\r\n            open_hand: "default",\r\n            closed_hand: "default"\r\n        },\r\n        createStageFromJson: function (jsonStr, canvas) {\r\n            eval("var jsonObj = " + jsonStr);\r\n            var stage = new JTopo.Stage(canvas);\r\n            for (var k in jsonObj)"childs" != k && (stage[k] = jsonObj[k]);\r\n            var scenes = jsonObj.childs;\r\n            return scenes.forEach(function (a) {\r\n                var b = new JTopo.Scene(stage);\r\n                for (var c in a)"childs" != c && (b[c] = a[c]), "background" == c && (b.background = a[c]);\r\n                var d = a.childs;\r\n                d.forEach(function (a) {\r\n                    var c = null, d = a.elementType;\r\n                    "node" == d ? c = new JTopo.Node : "CircleNode" == d && (c = new JTopo.CircleNode);\r\n                    for (var e in a)c[e] = a[e];\r\n                    b.add(c)\r\n                })\r\n            }), stage\r\n        }\r\n    };\r\n    JTopo.Element = Element;\r\n    window.JTopo = JTopo;\r\n}(window), function (JTopo) {\r\n    function MessageBus(a) {\r\n        this.name = a;\r\n        this.messageMap = {};\r\n        this.messageCount = 0;\r\n    }\r\n\r\n    MessageBus.prototype.subscribe = function (evenName, fn) {\r\n        var d = this.messageMap[evenName];\r\n        if (null == d) {\r\n            this.messageMap[evenName] = [];\r\n        }\r\n        this.messageMap[evenName].push(fn);\r\n        this.messageCount++;\r\n    };\r\n    MessageBus.prototype.unsubscribe = function (evenName, fn) {\r\n        var event = this.messageMap[evenName];\r\n        if (null != event) {\r\n            if (fn && \'function\' == typeof fn) {\r\n                var index = event.indexOf(fn);\r\n                if (index > -1) {\r\n                    event.splice(index, 1);\r\n                }\r\n            } else {\r\n                this.messageMap[evenName] = null;\r\n                delete this.messageMap[evenName];\r\n                this.messageCount--;\r\n            }\r\n        }\r\n    };\r\n    MessageBus.prototype.publish = function (evenName, e, boolean) {\r\n        var eventMap = this.messageMap[evenName];\r\n        if (null != eventMap) {\r\n            eventMap.forEach(function (fn) {\r\n                if (boolean) {\r\n                    setTimeout(function () {\r\n                        fn(e);\r\n                    });\r\n                } else {\r\n                    if (e.target && e.target.qtopo) {\r\n                        fn(e, e.target.qtopo);\r\n                    } else {\r\n                        fn(e);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    function getDistance(pointA, pointB, c, d) {\r\n        var width, height;\r\n        if (null == c && null == d) {\r\n            if (pointA && pointB) {\r\n                width = pointB.x - pointA.x;\r\n                height = pointB.y - pointA.y;\r\n            }\r\n        } else {\r\n            width = c - pointA;\r\n            height = d - pointB;\r\n        }\r\n        return Math.sqrt(width * width + height * height);\r\n    }\r\n\r\n    function getElementsBound(elements) {\r\n        var b = {\r\n            left: Number.MAX_VALUE,\r\n            right: Number.MIN_VALUE,\r\n            top: Number.MAX_VALUE,\r\n            bottom: Number.MIN_VALUE\r\n        };\r\n        elements.forEach(function (element) {\r\n            if (!(element instanceof JTopo.Link)) {\r\n                if (b.left > element.x) {\r\n                    b.left = element.x;\r\n                    b.leftNode = element;\r\n                }\r\n                if (b.right < element.x + element.width) {\r\n                    b.right = element.x + element.width;\r\n                    b.rightNode = element;\r\n                }\r\n                if (b.top > element.y) {\r\n                    b.top = element.y;\r\n                    b.topNode = element;\r\n                }\r\n                if (b.bottom < element.y + element.height) {\r\n                    b.bottom = element.y + element.height;\r\n                    b.bottomNode = element;\r\n                }\r\n            }\r\n        });\r\n        b.width = b.right - b.left;\r\n        b.height = b.bottom - b.top;\r\n        return b;\r\n    }\r\n\r\n    function getEventPosition(event) {\r\n        event = cloneEvent(event);\r\n        if (!event.pageX) {\r\n            event.pageX = event.clientX + document.body.scrollLeft - document.body.clientLeft;\r\n            event.pageY = event.clientY + document.body.scrollTop - document.body.clientTop;\r\n        }\r\n        return event;\r\n    }\r\n\r\n    function rotatePoint(aX, aY, bX, bY, c) {\r\n        var width = bX - aX;\r\n        var height = bY - aY;\r\n        var ditance = Math.sqrt(width * width + height * height);\r\n        var i = Math.atan2(height, width) + c;\r\n        return {\r\n            x: aX + Math.cos(i) * ditance,\r\n            y: aY + Math.sin(i) * ditance\r\n        }\r\n    }\r\n\r\n    function rotatePoints(root, childs, beginAngle) {\r\n        for (var d = [], e = 0; e < childs.length; e++) {\r\n            d.push(rotatePoint(root.x, root.y, childs[e].x, childs[e].y, beginAngle));\r\n        }\r\n        return d\r\n    }\r\n\r\n    function cloneEvent(a) {\r\n        var b = {};\r\n        for (var c in a) {\r\n            if ("returnValue" != c && "keyLocation" != c) {\r\n                b[c] = a[c];\r\n            }\r\n        }\r\n        return b\r\n    }\r\n\r\n    function clone(object) {\r\n        var b = {};\r\n        for (var c in object) {\r\n            b[c] = object[c];\r\n        }\r\n        return b\r\n    }\r\n\r\n    function isPointInRect(rect, points) {\r\n        var X = points.x;\r\n        var Y = points.y;\r\n        var W = points.width;\r\n        var H = points.height;\r\n        return rect.x > X && rect.x < X + W && rect.y > Y && rect.y < Y + H;\r\n    }\r\n\r\n    function isPointInLine(points, start, end) {\r\n        var line = JTopo.util.getDistance(start, end);\r\n        var toStart = JTopo.util.getDistance(start, points);\r\n        var toEnd = JTopo.util.getDistance(end, points);\r\n        return Math.abs(toStart + toEnd - line) <= 0.5;\r\n    }\r\n\r\n    function removeFromArray(arr, item) {\r\n        for (var c = 0; c < arr.length; c++) {\r\n            var d = arr[c];\r\n            if (d === item) {\r\n                arr = arr.del(c);\r\n                break\r\n            }\r\n        }\r\n        return arr\r\n    }\r\n\r\n    function randomColor() {\r\n        return Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random())\r\n    }\r\n\r\n\r\n    function loadStageFromJson(json, canvas) {\r\n        var obj = eval(json), stage = new JTopo.Stage(canvas);\r\n        for (var k in stageObj)if ("scenes" != k)stage[k] = obj[k]; else for (var scenes = obj.scenes, i = 0; i < scenes.length; i++) {\r\n            var sceneObj = scenes[i], scene = new JTopo.Scene(stage);\r\n            for (var p in sceneObj)if ("elements" != p)scene[p] = sceneObj[p]; else for (var nodeMap = {}, elements = sceneObj.elements, m = 0; m < elements.length; m++) {\r\n                var elementObj = elements[m], type = elementObj.elementType, element;\r\n                "Node" == type && (element = new JTopo.Node);\r\n                for (var mk in elementObj)element[mk] = elementObj[mk];\r\n                nodeMap[element.text] = element, scene.add(element)\r\n            }\r\n        }\r\n        return console.log(stage), stage\r\n    }\r\n\r\n    function changeColor(ctx, image, color) {\r\n        var colorArr = color.split(",");\r\n        var R = parseInt(colorArr[0]);\r\n        var G = parseInt(colorArr[1]);\r\n        var B = parseInt(colorArr[2]);\r\n        var imageWidth = canvas.width = image.width;\r\n        var imageHeight = canvas.height = image.height;\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        ctx.drawImage(image, 0, 0);\r\n        var ImageData = ctx.getImageData(0, 0, image.width, image.height);\r\n        var data = ImageData.data;\r\n        for (var i = 0; imageWidth > i; i++) {\r\n            for (var j = 0; imageHeight > j; j++) {\r\n                var n = 4 * (i + j * imageWidth);\r\n                if (0 != data[n + 3]) {\r\n                    if (null != R) {\r\n                        data[n + 0] += R;\r\n                    }\r\n                    if (null != G) {\r\n                        data[n + 1] += G;\r\n                    }\r\n                    if (null != B) {\r\n                        data[n + 2] += B;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        ctx.putImageData(ImageData, 0, 0, 0, 0, image.width, image.height);\r\n        return canvas.toDataURL();\r\n    }\r\n\r\n    function genImageAlarm(image, color) {\r\n        var src = image.src + color;\r\n        if (alarmImageCache[src])return alarmImageCache[src];\r\n        var newImage = new Image;\r\n        newImage.src = changeColor(graphics, image, color);\r\n        alarmImageCache[src] = newImage;\r\n        return newImage;\r\n    }\r\n\r\n    function getOffsetPosition(canvas) {\r\n        if (!canvas) {\r\n            return {left: 0, top: 0};\r\n        }\r\n        var b = 0, c = 0;\r\n        if ("getBoundingClientRect" in document.documentElement) {\r\n            var d = canvas.getBoundingClientRect();\r\n            var e = canvas.ownerDocument;\r\n            var f = e.body;\r\n            var g = e.documentElement;\r\n            var h = g.clientTop || f.clientTop || 0;\r\n            var i = g.clientLeft || f.clientLeft || 0;\r\n            b = d.top + (self.pageYOffset || g && g.scrollTop || f.scrollTop) - h;\r\n            c = d.left + (self.pageXOffset || g && g.scrollLeft || f.scrollLeft) - i;\r\n\r\n        } else {\r\n            do {\r\n                b += canvas.offsetTop || 0;\r\n                c += canvas.offsetLeft || 0;\r\n                canvas = canvas.offsetParent;\r\n            } while (canvas);\r\n        }\r\n        return {left: c, top: b}\r\n    }\r\n\r\n    function lineF(x1, y1, x2, y2) {\r\n        function e(a) {\r\n            return a * f + g\r\n        }\r\n\r\n        var f = (y2 - y1) / (x2 - x1), g = y1 - x1 * f;\r\n        return e.k = f, e.b = g, e.x1 = x1, e.x2 = x2, e.y1 = y1, e.y2 = y2, e\r\n    }\r\n\r\n    function inRange(a, b, c) {\r\n        var d = Math.abs(b - c), e = Math.abs(b - a), f = Math.abs(c - a), g = Math.abs(d - (e + f));\r\n        return 1e-6 > g ? !0 : !1\r\n    }\r\n\r\n    function isPointInLineSeg(a, b, c) {\r\n        return inRange(a, c.x1, c.x2) && inRange(b, c.y1, c.y2)\r\n    }\r\n\r\n    function intersection(a, b) {\r\n        var c, d;\r\n        return a.k == b.k ? null : (1 / 0 == a.k || a.k == -1 / 0 ? (c = a.x1, d = b(a.x1)) : 1 / 0 == b.k || b.k == -1 / 0 ? (c = b.x1, d = a(b.x1)) : (c = (b.b - a.b) / (a.k - b.k), d = a(c)), 0 == isPointInLineSeg(c, d, a) ? null : 0 == isPointInLineSeg(c, d, b) ? null : {\r\n            x: c,\r\n            y: d\r\n        })\r\n    }\r\n\r\n    function intersectionLineBound(link, bound) {\r\n        var c = JTopo.util.lineF(bound.left, bound.top, bound.left, bound.bottom);\r\n        var d = JTopo.util.intersection(link, c);\r\n        if (null == d) {\r\n            c = JTopo.util.lineF(bound.left, bound.top, bound.right, bound.top);\r\n            d = JTopo.util.intersection(link, c);\r\n            if (null == d) {\r\n                c = JTopo.util.lineF(bound.right, bound.top, bound.right, bound.bottom);\r\n                d = JTopo.util.intersection(link, c);\r\n                if (null == d) {\r\n                    c = JTopo.util.lineF(bound.left, bound.bottom, bound.right, bound.bottom);\r\n                    d = JTopo.util.intersection(link, c);\r\n                }\r\n            }\r\n        }\r\n\r\n        return d;\r\n    }\r\n\r\n    window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function (a) {\r\n            setTimeout(a, 1e3 / 24)\r\n        };\r\n    Array.prototype.del = function (item) {\r\n        if ("number" != typeof item) {\r\n            var index = this.indexOf(item);\r\n            if (index > -1) {\r\n                this.splice(index, 1);\r\n            }\r\n            return this\r\n        } else {\r\n            if (item > -1) {\r\n                this.splice(item, 1);\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    if (![].indexOf) {\r\n        Array.prototype.indexOf = function (a) {\r\n            for (var i = 0; i < this.length; i++) {\r\n                if (this[i] === a) {\r\n                    return i;\r\n                }\r\n            }\r\n            return -1;\r\n        }\r\n    }\r\n    window.console || (window.console = {\r\n        log: function () {\r\n        }, info: function () {\r\n        }, debug: function () {\r\n        }, warn: function () {\r\n        }, error: function () {\r\n        }\r\n    });\r\n    var canvas = document.createElement("canvas"), graphics = canvas.getContext("2d"), alarmImageCache = {};\r\n    JTopo.util = {\r\n        rotatePoint: rotatePoint,\r\n        rotatePoints: rotatePoints,\r\n        getDistance: getDistance,\r\n        getEventPosition: getEventPosition,\r\n        MessageBus: MessageBus,\r\n        isFirefox: navigator.userAgent.indexOf("Firefox") > 0,\r\n        isIE: !(!window.attachEvent || -1 !== navigator.userAgent.indexOf("Opera")),\r\n        isChrome: null != navigator.userAgent.toLowerCase().match(/chrome/),\r\n        clone: clone,\r\n        isPointInRect: isPointInRect,\r\n        isPointInLine: isPointInLine,\r\n        removeFromArray: removeFromArray,\r\n        cloneEvent: cloneEvent,\r\n        randomColor: randomColor,\r\n        loadStageFromJson: loadStageFromJson,\r\n        getElementsBound: getElementsBound,\r\n        genImageAlarm: genImageAlarm,\r\n        getOffsetPosition: getOffsetPosition,\r\n        lineF: lineF,\r\n        intersection: intersection,\r\n        intersectionLineBound: intersectionLineBound\r\n    }\r\n}(JTopo),\r\n    function (jtopo) {\r\n        function initEagleEye(stage) {\r\n            return {\r\n                hgap: 16,\r\n                visible: !1,\r\n                exportCanvas: document.createElement("canvas"),\r\n                getImage: function (b, c) {\r\n                    var d = stage.getBound();\r\n                    var e = 1;\r\n                    var f = 1;\r\n                    this.exportCanvas.width = stage.canvas.width;\r\n                    this.exportCanvas.height = stage.canvas.height;\r\n                    if (null != b && null != c) {\r\n                        this.exportCanvas.width = b;\r\n                        this.exportCanvas.height = c;\r\n                        e = b / d.width;\r\n                        f = c / d.height;\r\n                    } else {\r\n                        if (d.width > stage.canvas.width) {\r\n                            this.exportCanvas.width = d.width;\r\n                        }\r\n                        if (d.height > stage.canvas.height) {\r\n                            this.exportCanvas.height = d.height;\r\n                        }\r\n                    }\r\n                    var g = this.exportCanvas.getContext("2d");\r\n                    if (stage.childs.length > 0) {\r\n                        g.save();\r\n                        g.clearRect(0, 0, this.exportCanvas.width, this.exportCanvas.height);\r\n                        stage.childs.forEach(function (a) {\r\n                            if (1 == a.visible) {\r\n                                a.save();\r\n                                a.translateX = 0;\r\n                                a.translateY = 0;\r\n                                a.scaleX = 1;\r\n                                a.scaleY = 1;\r\n                                g.scale(e, f);\r\n                                if (d.left < 0) {\r\n                                    a.translateX = Math.abs(d.left)\r\n                                }\r\n                                if (d.top < 0) {\r\n                                    a.translateY = Math.abs(d.top)\r\n                                }\r\n                                a.paintAll = !0;\r\n                                a.repaint(g);\r\n                                a.paintAll = !1;\r\n                                a.restore();\r\n                            }\r\n                        });\r\n                        g.restore();\r\n                    }\r\n                    return this.exportCanvas.toDataURL("image/png");\r\n                },\r\n                canvas: document.createElement("canvas"),\r\n                update: function () {\r\n                    this.eagleImageDatas = this.getData(stage);\r\n                },\r\n                setSize: function (a, b) {\r\n                    this.width = this.canvas.width = a;\r\n                    this.height = this.canvas.height = b;\r\n                },\r\n                getData: function (b, c) {\r\n                    function d(a) {\r\n                        var b = a.stage.canvas.width, c = a.stage.canvas.height, d = b / a.scaleX / 2, e = c / a.scaleY / 2;\r\n                        return {translateX: a.translateX + d - d * a.scaleX, translateY: a.translateY + e - e * a.scaleY}\r\n                    }\r\n\r\n                    null != j && null != k ? this.setSize(b, c) : this.setSize(200, 160);\r\n                    var e = this.canvas.getContext("2d");\r\n                    if (stage.childs.length > 0) {\r\n                        e.save(), e.clearRect(0, 0, this.canvas.width, this.canvas.height), stage.childs.forEach(function (a) {\r\n                            1 == a.visible && (a.save(), a.centerAndZoom(null, null, e), a.repaint(e), a.restore())\r\n                        });\r\n                        var f = d(stage.childs[0]), g = f.translateX * (this.canvas.width / stage.canvas.width) * stage.childs[0].scaleX, h = f.translateY * (this.canvas.height / stage.canvas.height) * stage.childs[0].scaleY, i = stage.getBound(), j = stage.canvas.width / stage.childs[0].scaleX / i.width, k = stage.canvas.height / stage.childs[0].scaleY / i.height;\r\n                        j > 1 && (j = 1), k > 1 && (j = 1), g *= j, h *= k, i.left < 0 && (g -= Math.abs(i.left) * (this.width / i.width)), i.top < 0 && (h -= Math.abs(i.top) * (this.height / i.height)), e.save(), e.lineWidth = 1, e.strokeStyle = "rgba(255,0,0,1)", e.strokeRect(-g, -h, e.canvas.width * j, e.canvas.height * k), e.restore();\r\n                        var l = null;\r\n                        try {\r\n                            l = e.getImageData(0, 0, e.canvas.width, e.canvas.height)\r\n                        } catch (m) {\r\n                        }\r\n                        return l\r\n                    }\r\n                    return null\r\n                },\r\n                paint: function () {\r\n                    if (null != this.eagleImageDatas) {\r\n                        var b = stage.graphics;\r\n                        b.save();\r\n                        b.fillStyle = "rgba(211,211,211,0.3)";\r\n                        b.fillRect(stage.canvas.width - this.canvas.width - 2 * this.hgap, stage.canvas.height - this.canvas.height - 1, stage.canvas.width - this.canvas.width, this.canvas.height + 1);\r\n                        b.fill();\r\n                        b.save();\r\n                        b.lineWidth = 1;\r\n                        b.strokeStyle = "rgba(0,0,0,1)";\r\n                        b.rect(stage.canvas.width - this.canvas.width - 2 * this.hgap, stage.canvas.height - this.canvas.height - 1, stage.canvas.width - this.canvas.width, this.canvas.height + 1);\r\n                        b.stroke();\r\n                        b.restore();\r\n                        b.putImageData(this.eagleImageDatas, stage.canvas.width - this.canvas.width - this.hgap, stage.canvas.height - this.canvas.height);\r\n                        b.restore()\r\n                    } else {\r\n                        this.eagleImageDatas = this.getData(stage);\r\n                    }\r\n                },\r\n                eventHandler: function (a, b, c) {\r\n                    var d = b.x, e = b.y;\r\n                    if (d > c.canvas.width - this.canvas.width && e > c.canvas.height - this.canvas.height) {\r\n                        if (d = b.x - this.canvas.width, e = b.y - this.canvas.height, "mousedown" == a && (this.lastTranslateX = c.childs[0].translateX, this.lastTranslateY = c.childs[0].translateY), "mousedrag" == a && c.childs.length > 0) {\r\n                            var f = b.dx, g = b.dy, h = c.getBound(), i = this.canvas.width / c.childs[0].scaleX / h.width, j = this.canvas.height / c.childs[0].scaleY / h.height;\r\n                            c.childs[0].translateX = this.lastTranslateX - f / i, c.childs[0].translateY = this.lastTranslateY - g / j\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function stage(canvas) {\r\n            function getEventObject(event) {\r\n                var eventPosition = jtopo.util.getEventPosition(event);\r\n                var offsetPosition = jtopo.util.getOffsetPosition(theStage.canvas);\r\n                eventPosition.offsetLeft = eventPosition.pageX - offsetPosition.left;\r\n                eventPosition.offsetTop = eventPosition.pageY - offsetPosition.top;\r\n                eventPosition.x = eventPosition.offsetLeft;\r\n                eventPosition.y = eventPosition.offsetTop;\r\n                eventPosition.target = null;\r\n                return eventPosition;\r\n            }\r\n\r\n            function mouseOver(event) {\r\n                document.onselectstart = function () {\r\n                    return !1\r\n                }, this.mouseOver = !0;\r\n                var b = getEventObject(event);\r\n                theStage.dispatchEventToScenes("mouseover", b), theStage.dispatchEvent("mouseover", b)\r\n            }\r\n\r\n            function mouseOut(a) {\r\n                p = setTimeout(function () {\r\n                    o = !0\r\n                }, 500), document.onselectstart = function () {\r\n                    return !0\r\n                };\r\n                var b = getEventObject(a);\r\n                theStage.dispatchEventToScenes("mouseout", b), theStage.dispatchEvent("mouseout", b), theStage.needRepaint = 0 == theStage.animate ? !1 : !0\r\n            }\r\n\r\n            function mouseDown(a) {\r\n                var b = getEventObject(a);\r\n                theStage.mouseDown = !0, theStage.mouseDownX = b.x, theStage.mouseDownY = b.y, theStage.dispatchEventToScenes("mousedown", b), theStage.dispatchEvent("mousedown", b)\r\n            }\r\n\r\n            function mouseUp(a) {\r\n                var b = getEventObject(a);\r\n                theStage.dispatchEventToScenes("mouseup", b), theStage.dispatchEvent("mouseup", b), theStage.mouseDown = !1, theStage.needRepaint = 0 == theStage.animate ? !1 : !0\r\n            }\r\n\r\n            function mouseMove(event) {\r\n                if (p) {\r\n                    window.clearTimeout(p);\r\n                    p = null;\r\n                }\r\n                o = !1;\r\n                var b = getEventObject(event);\r\n                if (theStage.mouseDown) {\r\n                    if (0 == event.button) {\r\n                        b.dx = b.x - theStage.mouseDownX;\r\n                        b.dy = b.y - theStage.mouseDownY;\r\n                        theStage.dispatchEventToScenes("mousedrag", b);\r\n                        theStage.dispatchEvent("mousedrag", b);\r\n                        if (1 == theStage.eagleEye.visible) {\r\n                            theStage.eagleEye.update();\r\n                        }\r\n                    }\r\n                } else {\r\n                    theStage.dispatchEventToScenes("mousemove", b);\r\n                    theStage.dispatchEvent("mousemove", b);\r\n                }\r\n            }\r\n\r\n            function click(a) {\r\n                var b = getEventObject(a);\r\n                theStage.dispatchEventToScenes("click", b), theStage.dispatchEvent("click", b)\r\n            }\r\n\r\n            function dbclick(a) {\r\n                var b = getEventObject(a);\r\n                theStage.dispatchEventToScenes("dbclick", b), theStage.dispatchEvent("dbclick", b)\r\n            }\r\n\r\n            function mouseWheel(a) {\r\n                var b = getEventObject(a);\r\n                theStage.dispatchEventToScenes("mousewheel", b), theStage.dispatchEvent("mousewheel", b), null != theStage.wheelZoom && (a.preventDefault ? a.preventDefault() : (a = a || window.event, a.returnValue = !1), 1 == theStage.eagleEye.visible && theStage.eagleEye.update())\r\n            }\r\n\r\n            function addEventInCanvas(canvas) {\r\n                if (jtopo.util.isIE || !window.addEventListener) {\r\n                    canvas.onmouseout = mouseOut;\r\n                    canvas.onmouseover = mouseOver;\r\n                    canvas.onmousedown = mouseDown;\r\n                    canvas.onmouseup = mouseUp;\r\n                    canvas.onmousemove = mouseMove;\r\n                    canvas.onclick = click;\r\n                    canvas.ondblclick = dbclick;\r\n                    canvas.onmousewheel = mouseWheel;\r\n                    canvas.touchstart = mouseDown;\r\n                    canvas.touchmove = mouseMove;\r\n                    canvas.touchend = mouseUp;\r\n                } else {\r\n                    canvas.addEventListener("mouseout", mouseOut);\r\n                    canvas.addEventListener("mouseover", mouseOver);\r\n                    canvas.addEventListener("mousedown", mouseDown);\r\n                    canvas.addEventListener("mouseup", mouseUp);\r\n                    canvas.addEventListener("mousemove", mouseMove);\r\n                    canvas.addEventListener("click", click);\r\n                    canvas.addEventListener("dblclick", dbclick);\r\n                    if (jtopo.util.isFirefox) {\r\n                        canvas.addEventListener("DOMMouseScroll", mouseWheel);\r\n                    } else {\r\n                        canvas.addEventListener("mousewheel", mouseWheel);\r\n                    }\r\n                }\r\n                if (window.addEventListener) {\r\n                    window.addEventListener("keydown", function (event) {\r\n                        theStage.dispatchEventToScenes("keydown", jtopo.util.cloneEvent(event));\r\n                        var keyCode = event.keyCode;\r\n                        if (37 == keyCode || 38 == keyCode || 39 == keyCode || 40 == keyCode) {\r\n                            if (event.preventDefault) {\r\n                                event.preventDefault()\r\n                            } else {\r\n                                event = event || window.event;\r\n                                event.returnValue = !1;\r\n                            }\r\n                        }\r\n                    }, !0);\r\n                    window.addEventListener("keyup", function (event) {\r\n                        theStage.dispatchEventToScenes("keyup", jtopo.util.cloneEvent(event));\r\n                        var keyCode = event.keyCode;\r\n                        if (37 == keyCode || 38 == keyCode || 39 == keyCode || 40 == keyCode) {\r\n                            if (event.preventDefault) {\r\n                                event.preventDefault()\r\n                            } else {\r\n                                event = event || window.event;\r\n                                event.returnValue = !1;\r\n                            }\r\n                        }\r\n                    }, !0);\r\n                }\r\n            }\r\n\r\n            jtopo.stage = this;\r\n            var theStage = this;\r\n            var self = this;\r\n            this.initialize = function (canvas) {\r\n                addEventInCanvas(canvas);\r\n                this.canvas = canvas;\r\n                this.graphics = canvas.getContext("2d");\r\n                this.childs = [];\r\n                this.frames = 24;\r\n                this.messageBus = new jtopo.util.MessageBus;\r\n                this.eagleEye = initEagleEye(this);\r\n                this.wheelZoom = null;\r\n                this.mouseDownX = 0;\r\n                this.mouseDownY = 0;\r\n                this.mouseDown = !1;\r\n                this.mouseOver = !1;\r\n                this.needRepaint = !0;\r\n                this.serializedProperties = ["frames", "wheelZoom"];\r\n            };\r\n            if (null != canvas) {\r\n                this.initialize(canvas);\r\n            }\r\n            var o = !0, p = null;\r\n            document.oncontextmenu = function () {\r\n                return o\r\n            };\r\n            this.dispatchEventToScenes = function (a, b) {\r\n                if (0 != this.frames && (this.needRepaint = !0), 1 == this.eagleEye.visible && -1 != a.indexOf("mouse")) {\r\n                    var c = b.x, d = b.y;\r\n                    if (c > this.width - this.eagleEye.width && d > this.height - this.eagleEye.height)return void this.eagleEye.eventHandler(a, b, this)\r\n                }\r\n                this.childs.forEach(function (c) {\r\n                    if (1 == c.visible) {\r\n                        var d = c[a + "Handler"];\r\n                        if (null == d)throw new Error("Function not found:" + a + "Handler");\r\n                        d.call(c, b)\r\n                    }\r\n                })\r\n            };\r\n            this.add = function (a) {\r\n                for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a)return;\r\n                a.addTo(this), this.childs.push(a)\r\n            };\r\n            this.remove = function (a) {\r\n                if (null == a)throw new Error("Stage.remove出错: 参数为null!");\r\n                for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a)return a.stage = null, this.childs = this.childs.del(b), this;\r\n                return this\r\n            };\r\n            this.clear = function () {\r\n                this.childs = []\r\n            };\r\n            this.addEventListener = function (eventName, fn) {\r\n                var self = this;\r\n                var b = function (e) {\r\n                    fn.call(self, e);\r\n                };\r\n                this.messageBus.subscribe(eventName, fn);\r\n                return this;\r\n            };\r\n            this.removeEventListener = function (a, f) {\r\n                this.messageBus.unsubscribe(a, f)\r\n            };\r\n            this.removeAllEventListener = function () {\r\n                this.messageBus = new jtopo.util.MessageBus\r\n            };\r\n            this.dispatchEvent = function (a, b) {\r\n                this.messageBus.publish(a, b);\r\n                return this;\r\n            };\r\n            var q = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), r = this;\r\n            q.forEach(function (a) {\r\n                r[a] = function (b) {\r\n                    null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n                }\r\n            });\r\n            this.saveImageInfo = function (a, b) {\r\n                var c = this.eagleEye.getImage(a, b), d = window.open("about:blank");\r\n                return d.document.write("<img src=\'" + c + "\' alt=\'from canvas\'/>"), this\r\n            };\r\n            this.saveAsLocalImage = function (a, b) {\r\n                var c = this.eagleEye.getImage(a, b);\r\n                return c.replace("image/png", "image/octet-stream"), window.location.href = c, this\r\n            };\r\n            this.paint = function () {\r\n                null != this.canvas && (this.graphics.save(), this.graphics.clearRect(0, 0, this.width, this.height), this.childs.forEach(function (a) {\r\n                    1 == a.visible && a.repaint(theStage.graphics)\r\n                }), 1 == this.eagleEye.visible && this.eagleEye.paint(this), this.graphics.restore())\r\n            };\r\n            this.repaint = function () {\r\n                0 != this.frames && (this.frames < 0 && 0 == this.needRepaint || (this.paint(), this.frames < 0 && (this.needRepaint = !1)))\r\n            };\r\n            this.zoom = function (a) {\r\n                this.childs.forEach(function (b) {\r\n                    0 != b.visible && b.zoom(a)\r\n                })\r\n            };\r\n            this.zoomOut = function (a) {\r\n                this.childs.forEach(function (b) {\r\n                    0 != b.visible && b.zoomOut(a)\r\n                })\r\n            };\r\n            this.zoomIn = function (a) {\r\n                this.childs.forEach(function (b) {\r\n                    0 != b.visible && b.zoomIn(a)\r\n                })\r\n            };\r\n            this.centerAndZoom = function () {\r\n                this.childs.forEach(function (a) {\r\n                    0 != a.visible && a.centerAndZoom()\r\n                })\r\n            };\r\n            this.setCenter = function (a, b) {\r\n                var c = this;\r\n                this.childs.forEach(function (d) {\r\n                    var e = a - c.canvas.width / 2, f = b - c.canvas.height / 2;\r\n                    d.translateX = -e, d.translateY = -f\r\n                })\r\n            };\r\n            this.getBound = function () {\r\n                var a = {left: Number.MAX_VALUE, right: Number.MIN_VALUE, top: Number.MAX_VALUE, bottom: Number.MIN_VALUE};\r\n                return this.childs.forEach(function (b) {\r\n                    var c = b.getElementsBound();\r\n                    c.left < a.left && (a.left = c.left, a.leftNode = c.leftNode), c.top < a.top && (a.top = c.top, a.topNode = c.topNode), c.right > a.right && (a.right = c.right, a.rightNode = c.rightNode), c.bottom > a.bottom && (a.bottom = c.bottom, a.bottomNode = c.bottomNode)\r\n                }), a.width = a.right - a.left, a.height = a.bottom - a.top, a\r\n            };\r\n            this.toJson = function () {\r\n                {\r\n                    var b = this, c = \'{"version":"\' + jtopo.version + \'",\';\r\n                    this.serializedProperties.length\r\n                }\r\n                return this.serializedProperties.forEach(function (a) {\r\n                    var d = b[a];\r\n                    "string" == typeof d && (d = \'"\' + d + \'"\'), c += \'"\' + a + \'":\' + d + ","\r\n                }), c += \'"childs":[\', this.childs.forEach(function (a) {\r\n                    c += a.toJson()\r\n                }), c += "]", c += "}"\r\n            }, function () {\r\n                if (0 == theStage.frames) {\r\n                    setTimeout(arguments.callee, 100);\r\n                } else if (theStage.frames < 0) {\r\n                    theStage.repaint();\r\n                    setTimeout(arguments.callee, 1e3 / -theStage.frames);\r\n                } else {\r\n                    theStage.repaint();\r\n                    setTimeout(arguments.callee, 1e3 / theStage.frames);\r\n                }\r\n            }();\r\n            setTimeout(function () {\r\n                theStage.mousewheel(function (a) {\r\n                    var direction = null == a.wheelDelta ? a.detail : a.wheelDelta;\r\n                    if (null != self.wheelZoom) {\r\n                        if (direction < 0) {\r\n                            self.zoomIn(self.wheelZoom);\r\n                        } else {\r\n                            self.zoomOut(self.wheelZoom);\r\n                        }\r\n                    }\r\n                });\r\n                theStage.paint();\r\n            }, 300);\r\n            setTimeout(function () {\r\n                theStage.paint()\r\n            }, 1e3);\r\n            setTimeout(function () {\r\n                theStage.paint()\r\n            }, 3e3);\r\n        }\r\n\r\n        stage.prototype = {\r\n            get width() {\r\n                return this.canvas.width\r\n            }, get height() {\r\n                return this.canvas.height\r\n            }, set cursor(a) {\r\n                this.canvas.style.cursor = a\r\n            }, get cursor() {\r\n                return this.canvas.style.cursor\r\n            }, set mode(a) {\r\n                this.childs.forEach(function (b) {\r\n                    b.mode = a\r\n                })\r\n            }\r\n        }, jtopo.Stage = stage\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function scene(c) {\r\n            function d(a, b, c, d) {\r\n                return function (e) {\r\n                    e.beginPath(), e.strokeStyle = "rgba(0,0,236,0.5)", e.fillStyle = "rgba(0,0,236,0.1)", e.rect(a, b, c, d), e.fill(), e.stroke(), e.closePath()\r\n                }\r\n            }\r\n\r\n            var scene_self = this;\r\n            this.initialize = function () {\r\n                scene.prototype.initialize.apply(this, arguments);\r\n                this.messageBus = new jtopo.util.MessageBus;\r\n                this.elementType = "scene";\r\n                this.childs = [];\r\n                this.zIndexMap = {};\r\n                this.zIndexArray = [];\r\n                this.backgroundColor = "255,255,255";\r\n                this.visible = !0;\r\n                this.alpha = 0;\r\n                this.scaleX = 1;\r\n                this.scaleY = 1;\r\n                this.mode = jtopo.SceneMode.normal;\r\n                this.translate = !0;\r\n                this.translateX = 0;\r\n                this.translateY = 0;\r\n                this.lastTranslateX = 0;\r\n                this.lastTranslateY = 0;\r\n                this.mouseDown = !1;\r\n                this.mouseDownX = null;\r\n                this.mouseDownY = null;\r\n                this.mouseDownEvent = null;\r\n                this.areaSelect = !0;\r\n                this.operations = [];\r\n                this.selectedElements = [];\r\n                this.paintAll = !1;\r\n                var c = "background,backgroundColor,mode,paintAll,areaSelect,translate,translateX,translateY,lastTranslatedX,lastTranslatedY,alpha,visible,scaleX,scaleY".split(",");\r\n                this.serializedProperties = this.serializedProperties.concat(c);\r\n            };\r\n            this.initialize();\r\n            this.setBackground = function (a) {\r\n                this.background = a\r\n            };\r\n            this.addTo = function (a) {\r\n                this.stage !== a && null != a && (this.stage = a)\r\n            };\r\n            null != c && (c.add(this), this.addTo(c)), this.show = function () {\r\n                this.visible = !0\r\n            };\r\n            this.hide = function () {\r\n                this.visible = !1\r\n            };\r\n            this.paint = function (a) {\r\n                if (0 != this.visible && null != this.stage) {\r\n                    if (a.save(), this.paintBackgroud(a), a.restore(), a.save(), a.scale(this.scaleX, this.scaleY), 1 == this.translate) {\r\n                        var b = this.getOffsetTranslate(a);\r\n                        a.translate(b.translateX, b.translateY)\r\n                    }\r\n                    this.paintChilds(a), a.restore(), a.save(), this.paintOperations(a, this.operations), a.restore()\r\n                }\r\n            };\r\n            this.repaint = function (a) {\r\n                0 != this.visible && this.paint(a)\r\n            };\r\n            this.paintBackgroud = function (a) {\r\n                null != this.background ? a.drawImage(this.background, 0, 0, a.canvas.width, a.canvas.height) : (a.beginPath(), a.fillStyle = "rgba(" + this.backgroundColor + "," + this.alpha + ")", a.fillRect(0, 0, a.canvas.width, a.canvas.height), a.closePath())\r\n            };\r\n            this.getDisplayedElements = function () {\r\n                for (var a = [], b = 0; b < this.zIndexArray.length; b++)for (var c = this.zIndexArray[b], d = this.zIndexMap[c], e = 0; e < d.length; e++) {\r\n                    var f = d[e];\r\n                    this.isVisiable(f) && a.push(f)\r\n                }\r\n                return a\r\n            };\r\n            this.getDisplayedNodes = function () {\r\n                for (var b = [], c = 0; c < this.childs.length; c++) {\r\n                    var d = this.childs[c];\r\n                    d instanceof jtopo.Node && this.isVisiable(d) && b.push(d)\r\n                }\r\n                return b\r\n            };\r\n            this.paintChilds = function (context) {\r\n                for (var i = 0; i < this.zIndexArray.length; i++) {\r\n                    var zIndex = this.zIndexArray[i];\r\n                    var zIndexElements = this.zIndexMap[zIndex];\r\n                    for (var j = 0; j < zIndexElements.length; j++) {\r\n                        var element = zIndexElements[j];\r\n                        if (1 == this.paintAll || this.isVisiable(element)) {\r\n                            context.save();\r\n                            if (1 == element.transformAble) {\r\n                                var center = element.getCenterLocation();\r\n                                context.translate(center.x, center.y);\r\n                                if (element.rotate) {\r\n                                    context.rotate(element.rotate);\r\n                                }\r\n                                if (element.scaleX && element.scaleY) {\r\n                                    context.scale(element.scaleX, element.scaleY)\r\n                                } else if (element.scaleX) {\r\n                                    context.scale(element.scaleX, 1);\r\n                                } else if (element.scaleY) {\r\n                                    context.scale(1, element.scaleY);\r\n                                }\r\n                            }\r\n                            if (1 == element.shadow) {\r\n                                context.shadowBlur = element.shadowBlur;\r\n                                context.shadowColor = element.shadowColor;\r\n                                context.shadowOffsetX = element.shadowOffsetX;\r\n                                context.shadowOffsetY = element.shadowOffsetY;\r\n                            }\r\n                            if (element instanceof jtopo.InteractiveElement) {\r\n                                if (element.selected && 1 == element.showSelected) {\r\n                                    element.paintSelected(context)\r\n                                }\r\n                                if (1 == element.isMouseOver) {\r\n                                    element.paintMouseover(context)\r\n                                }\r\n                            }\r\n                            element.paint(context);\r\n                            context.restore();\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            this.getOffsetTranslate = function (a) {\r\n                var b = this.stage.canvas.width, c = this.stage.canvas.height;\r\n                null != a && "move" != a && (b = a.canvas.width, c = a.canvas.height);\r\n                var d = b / this.scaleX / 2, e = c / this.scaleY / 2, f = {translateX: this.translateX + (d - d * this.scaleX), translateY: this.translateY + (e - e * this.scaleY)};\r\n                return f\r\n            };\r\n            this.isVisiable = function (b) {\r\n                if (1 != b.visible)return !1;\r\n                if (b instanceof jtopo.Link)return !0;\r\n                var c = this.getOffsetTranslate(), d = b.x + c.translateX, e = b.y + c.translateY;\r\n                d *= this.scaleX, e *= this.scaleY;\r\n                var f = d + b.width * this.scaleX, g = e + b.height * this.scaleY;\r\n                return d > this.stage.canvas.width || e > this.stage.canvas.height || 0 > f || 0 > g ? !1 : !0\r\n            };\r\n            this.paintOperations = function (a, b) {\r\n                for (var c = 0; c < b.length; c++)b[c](a)\r\n            };\r\n            this.findElements = function (a) {\r\n                for (var b = [], c = 0; c < this.childs.length; c++)1 == a(this.childs[c]) && b.push(this.childs[c]);\r\n                return b\r\n            };\r\n            this.getElementsByClass = function (a) {\r\n                return this.findElements(function (b) {\r\n                    return b instanceof a\r\n                })\r\n            };\r\n            this.addOperation = function (a) {\r\n                return this.operations.push(a), this\r\n            };\r\n            this.clearOperations = function () {\r\n                return this.operations = [], this\r\n            };\r\n            this.getElementByXY = function (b, c) {\r\n                for (var d = null, e = this.zIndexArray.length - 1; e >= 0; e--)for (var f = this.zIndexArray[e], g = this.zIndexMap[f], h = g.length - 1; h >= 0; h--) {\r\n                    var i = g[h];\r\n                    if (i instanceof jtopo.InteractiveElement && this.isVisiable(i) && i.isInBound(b, c))return d = i\r\n                }\r\n                return d\r\n            };\r\n            this.add = function (a) {\r\n                this.childs.push(a);\r\n                if (null == this.zIndexMap[a.zIndex]) {\r\n                    this.zIndexMap[a.zIndex] = [];\r\n                    this.zIndexArray.push(a.zIndex);\r\n                    this.zIndexArray.sort(function (a, b) {\r\n                        return a - b\r\n                    });\r\n                }\r\n                this.zIndexMap["" + a.zIndex].push(a);\r\n            };\r\n            this.remove = function (item) {\r\n                this.childs = jtopo.util.removeFromArray(this.childs, item);\r\n                var elements = this.zIndexMap[item.zIndex];\r\n                if (elements) {\r\n                    this.zIndexMap[item.zIndex] = jtopo.util.removeFromArray(elements, item);\r\n                }\r\n                item.removeHandler(this);\r\n            };\r\n            this.clear = function () {\r\n                var self = this;\r\n                this.childs.forEach(function (child) {\r\n                    child.removeHandler(self);\r\n                });\r\n                this.childs = [];\r\n                this.operations = [];\r\n                this.zIndexArray = [];\r\n                this.zIndexMap = {};\r\n            };\r\n            this.addToSelected = function (a) {\r\n                this.selectedElements.push(a)\r\n            };\r\n            this.cancleAllSelected = function (a) {\r\n                for (var b = 0; b < this.selectedElements.length; b++)this.selectedElements[b].unselectedHandler(a);\r\n                this.selectedElements = []\r\n            };\r\n            this.notInSelectedNodes = function (a) {\r\n                for (var b = 0; b < this.selectedElements.length; b++)if (a === this.selectedElements[b])return !1;\r\n                return !0\r\n            };\r\n            this.removeFromSelected = function (a) {\r\n                for (var b = 0; b < this.selectedElements.length; b++) {\r\n                    var c = this.selectedElements[b];\r\n                    a === c && (this.selectedElements = this.selectedElements.del(b))\r\n                }\r\n            };\r\n            this.toSceneEvent = function (b) {\r\n                var c = jtopo.util.clone(b);\r\n                if (c.x /= this.scaleX, c.y /= this.scaleY, 1 == this.translate) {\r\n                    var d = this.getOffsetTranslate();\r\n                    c.x -= d.translateX, c.y -= d.translateY\r\n                }\r\n                return null != c.dx && (c.dx /= this.scaleX, c.dy /= this.scaleY), null != this.currentElement && (c.target = this.currentElement), c.scene = this, c\r\n            };\r\n            this.selectElement = function (a) {\r\n                var b = scene_self.getElementByXY(a.x, a.y);\r\n                if (null != b)if (a.target = b, b.mousedownHander(a), b.selectedHandler(a), scene_self.notInSelectedNodes(b))a.ctrlKey || scene_self.cancleAllSelected(), scene_self.addToSelected(b); else {\r\n                    1 == a.ctrlKey && (b.unselectedHandler(), this.removeFromSelected(b));\r\n                    for (var c = 0; c < this.selectedElements.length; c++) {\r\n                        var d = this.selectedElements[c];\r\n                        d.selectedHandler(a)\r\n                    }\r\n                } else a.ctrlKey || scene_self.cancleAllSelected();\r\n                this.currentElement = b\r\n            };\r\n            this.mousedownHandler = function (b) {\r\n                var c = this.toSceneEvent(b);\r\n                if (this.mouseDown = !0, this.mouseDownX = c.x, this.mouseDownY = c.y, this.mouseDownEvent = c, this.mode == jtopo.SceneMode.normal)this.selectElement(c), (null == this.currentElement || this.currentElement instanceof jtopo.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX, this.lastTranslateY = this.translateY); else {\r\n                    if (this.mode == jtopo.SceneMode.drag && 1 == this.translate)return this.lastTranslateX = this.translateX, void(this.lastTranslateY = this.translateY);\r\n                    this.mode == jtopo.SceneMode.select ? this.selectElement(c) : this.mode == jtopo.SceneMode.edit && (this.selectElement(c), (null == this.currentElement || this.currentElement instanceof jtopo.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX, this.lastTranslateY = this.translateY))\r\n                }\r\n                scene_self.dispatchEvent("mousedown", c)\r\n            };\r\n            this.mouseupHandler = function (b) {\r\n                this.stage.cursor != jtopo.MouseCursor.normal && (this.stage.cursor = jtopo.MouseCursor.normal), scene_self.clearOperations();\r\n                var c = this.toSceneEvent(b);\r\n                null != this.currentElement && (c.target = scene_self.currentElement, this.currentElement.mouseupHandler(c)), this.dispatchEvent("mouseup", c), this.mouseDown = !1\r\n            };\r\n            this.dragElements = function (b) {\r\n                if (null != this.currentElement && 1 == this.currentElement.dragable)for (var c = 0; c < this.selectedElements.length; c++) {\r\n                    var d = this.selectedElements[c];\r\n                    if (0 != d.dragable) {\r\n                        var e = jtopo.util.clone(b);\r\n                        e.target = d, d.mousedragHandler(e)\r\n                    }\r\n                }\r\n            };\r\n            this.mousedragHandler = function (b) {\r\n                var c = this.toSceneEvent(b);\r\n                this.mode == jtopo.SceneMode.normal ? null == this.currentElement || this.currentElement instanceof jtopo.Link ? 1 == this.translate && (this.stage.cursor = jtopo.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c) : this.mode == jtopo.SceneMode.drag ? 1 == this.translate && (this.stage.cursor = jtopo.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.mode == jtopo.SceneMode.select ? null != this.currentElement ? 1 == this.currentElement.dragable && this.dragElements(c) : 1 == this.areaSelect && this.areaSelectHandle(c) : this.mode == jtopo.SceneMode.edit && (null == this.currentElement || this.currentElement instanceof jtopo.Link ? 1 == this.translate && (this.stage.cursor = jtopo.MouseCursor.closed_hand, this.translateX = this.lastTranslateX + c.dx, this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c)), this.dispatchEvent("mousedrag", c)\r\n            };\r\n            this.areaSelectHandle = function (a) {\r\n                var b = a.offsetLeft, c = a.offsetTop, f = this.mouseDownEvent.offsetLeft, g = this.mouseDownEvent.offsetTop, h = b >= f ? f : b, i = c >= g ? g : c, j = Math.abs(a.dx) * this.scaleX, k = Math.abs(a.dy) * this.scaleY, l = new d(h, i, j, k);\r\n                scene_self.clearOperations().addOperation(l), b = a.x, c = a.y, f = this.mouseDownEvent.x, g = this.mouseDownEvent.y, h = b >= f ? f : b, i = c >= g ? g : c, j = Math.abs(a.dx), k = Math.abs(a.dy);\r\n                for (var m = h + j, n = i + k, o = 0; o < scene_self.childs.length; o++) {\r\n                    var p = scene_self.childs[o];\r\n                    p.x > h && p.x + p.width < m && p.y > i && p.y + p.height < n && scene_self.notInSelectedNodes(p) && (p.selectedHandler(a), scene_self.addToSelected(p))\r\n                }\r\n            };\r\n            this.mousemoveHandler = function (b) {\r\n                this.mousecoord = {\r\n                    x: b.x,\r\n                    y: b.y\r\n                };\r\n                var c = this.toSceneEvent(b);\r\n                if (this.mode == jtopo.SceneMode.drag) {\r\n                    return void(this.stage.cursor = jtopo.MouseCursor.open_hand);\r\n                }\r\n                if (this.mode == jtopo.SceneMode.normal) {\r\n                    this.stage.cursor = jtopo.MouseCursor.normal;\r\n                } else if (this.mode == jtopo.SceneMode.select) {\r\n                    this.stage.cursor = jtopo.MouseCursor.normal;\r\n                }\r\n\r\n                var d = scene_self.getElementByXY(c.x, c.y);\r\n                if (null != d) {\r\n                    if (scene_self.mouseOverelement && scene_self.mouseOverelement !== d) {\r\n                        c.target = d, scene_self.mouseOverelement.mouseoutHandler(c)\r\n                    }\r\n                    scene_self.mouseOverelement = d;\r\n                    if (0 == d.isMouseOver) {\r\n                        c.target = d;\r\n                        d.mouseoverHandler(c);\r\n                        scene_self.dispatchEvent("mouseover", c);\r\n                    } else {\r\n                        c.target = d;\r\n                        d.mousemoveHandler(c);\r\n                        scene_self.dispatchEvent("mousemove", c);\r\n                    }\r\n                } else {\r\n                    if (scene_self.mouseOverelement) {\r\n                        c.target = d;\r\n                        scene_self.mouseOverelement.mouseoutHandler(c);\r\n                        scene_self.mouseOverelement = null;\r\n                        scene_self.dispatchEvent("mouseout", c);\r\n                    } else {\r\n                        c.target = null;\r\n                        scene_self.dispatchEvent("mousemove", c)\r\n                    }\r\n                }\r\n            }, this.mouseoverHandler = function (a) {\r\n                var b = this.toSceneEvent(a);\r\n                this.dispatchEvent("mouseover", b)\r\n            }, this.mouseoutHandler = function (a) {\r\n                var b = this.toSceneEvent(a);\r\n                this.dispatchEvent("mouseout", b)\r\n            }, this.clickHandler = function (a) {\r\n                var b = this.toSceneEvent(a);\r\n                this.currentElement && (b.target = this.currentElement, this.currentElement.clickHandler(b)), this.dispatchEvent("click", b)\r\n            }, this.dbclickHandler = function (a) {\r\n                var b = this.toSceneEvent(a);\r\n                this.currentElement ? (b.target = this.currentElement, this.currentElement.dbclickHandler(b)) : scene_self.cancleAllSelected(), this.dispatchEvent("dbclick", b)\r\n            }, this.mousewheelHandler = function (a) {\r\n                var b = this.toSceneEvent(a);\r\n                this.dispatchEvent("mousewheel", b)\r\n            }, this.touchstart = this.mousedownHander, this.touchmove = this.mousedragHandler, this.touchend = this.mousedownHander, this.keydownHandler = function (a) {\r\n                this.dispatchEvent("keydown", a)\r\n            }, this.keyupHandler = function (a) {\r\n                this.dispatchEvent("keyup", a)\r\n            }, this.addEventListener = function (eventName, fn) {\r\n                var self = this;\r\n                var b = function (e) {\r\n                    fn.call(self, e);\r\n                };\r\n                this.messageBus.subscribe(eventName, fn);\r\n                return this;\r\n            }, this.removeEventListener = function (a, f) {\r\n                this.messageBus.unsubscribe(a, f)\r\n            }, this.removeAllEventListener = function () {\r\n                this.messageBus = new jtopo.util.MessageBus\r\n            }, this.dispatchEvent = function (a, b) {\r\n                return this.messageBus.publish(a, b), this\r\n            };\r\n            var f = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","), g = this;\r\n            return f.forEach(function (a) {\r\n                g[a] = function (b) {\r\n                    null != b ? this.addEventListener(a, b) : this.dispatchEvent(a)\r\n                }\r\n            }), this.zoom = function (a, b) {\r\n                null != a && 0 != a && (this.scaleX = a), null != b && 0 != b && (this.scaleY = b)\r\n            }, this.zoomOut = function (a) {\r\n                0 != a && (null == a && (a = .8), this.scaleX /= a, this.scaleY /= a)\r\n            }, this.zoomIn = function (a) {\r\n                0 != a && (null == a && (a = .8), this.scaleX *= a, this.scaleY *= a)\r\n            }, this.getBound = function () {\r\n                return {left: 0, top: 0, right: this.stage.canvas.width, bottom: this.stage.canvas.height, width: this.stage.canvas.width, height: this.stage.canvas.height}\r\n            }, this.getElementsBound = function () {\r\n                return jtopo.util.getElementsBound(this.childs)\r\n            }, this.translateToCenter = function (a) {\r\n                var b = this.getElementsBound(), c = this.stage.canvas.width / 2 - (b.left + b.right) / 2, d = this.stage.canvas.height / 2 - (b.top + b.bottom) / 2;\r\n                a && (c = a.canvas.width / 2 - (b.left + b.right) / 2, d = a.canvas.height / 2 - (b.top + b.bottom) / 2), this.translateX = c, this.translateY = d\r\n            }, this.setCenter = function (a, b) {\r\n                var c = a - this.stage.canvas.width / 2, d = b - this.stage.canvas.height / 2;\r\n                this.translateX = -c, this.translateY = -d\r\n            }, this.centerAndZoom = function (a, b, c) {\r\n                if (this.translateToCenter(c), null == a || null == b) {\r\n                    var d = this.getElementsBound(), e = d.right - d.left, f = d.bottom - d.top, g = this.stage.canvas.width / e, h = this.stage.canvas.height / f;\r\n                    c && (g = c.canvas.width / e, h = c.canvas.height / f);\r\n                    var i = Math.min(g, h);\r\n                    if (i > 1)return;\r\n                    this.zoom(i, i)\r\n                }\r\n                this.zoom(a, b)\r\n            }, this.getCenterLocation = function () {\r\n                return {x: scene_self.stage.canvas.width / 2, y: scene_self.stage.canvas.height / 2}\r\n            }, this.doLayout = function (a) {\r\n                a && a(this, this.childs)\r\n            }, this.toJson = function () {\r\n                {\r\n                    var a = this, b = "{";\r\n                    this.serializedProperties.length\r\n                }\r\n                this.serializedProperties.forEach(function (c) {\r\n                    var d = a[c];\r\n                    "background" == c && (d = a._background.src), "string" == typeof d && (d = \'"\' + d + \'"\'), b += \'"\' + c + \'":\' + d + ","\r\n                }), b += \'"childs":[\';\r\n                var c = this.childs.length;\r\n                return this.childs.forEach(function (a, d) {\r\n                    b += a.toJson(), c > d + 1 && (b += ",")\r\n                }), b += "]", b += "}"\r\n            }, scene_self\r\n        }\r\n\r\n        scene.prototype = new jtopo.Element;\r\n        var c = {};\r\n        Object.defineProperties(scene.prototype, {\r\n            background: {\r\n                get: function () {\r\n                    return this._background\r\n                }, set: function (a) {\r\n                    if ("string" == typeof a) {\r\n                        var b = c[a];\r\n                        null == b && (b = new Image, b.src = a, b.onload = function () {\r\n                            c[a] = b\r\n                        }), this._background = b\r\n                    } else this._background = a\r\n                }\r\n            }\r\n        }), jtopo.Scene = scene\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function DisplayElement() {\r\n            this.initialize = function () {\r\n                DisplayElement.prototype.initialize.apply(this, arguments);\r\n                this.elementType = "displayElement";\r\n                this.x = 0;\r\n                this.y = 0;\r\n                this.width = 32;\r\n                this.height = 32;\r\n                this.visible = !0;\r\n                this.alpha = 1;\r\n                this.rotate = 0;\r\n                this.scaleX = 1;\r\n                this.scaleY = 1;\r\n                this.strokeColor = "22,124,255";\r\n                this.borderColor = "22,124,255";\r\n                this.fillColor = "22,124,255";\r\n                this.shadow = !1;\r\n                this.shadowBlur = 5;\r\n                this.shadowColor = "rgba(0,0,0,0.5)";\r\n                this.shadowOffsetX = 3;\r\n                this.shadowOffsetY = 6;\r\n                this.transformAble = !1;\r\n                this.zIndex = 0;\r\n                var a = "x,y,width,height,visible,alpha,rotate,scaleX,scaleY,strokeColor,fillColor,shadow,shadowColor,shadowOffsetX,shadowOffsetY,transformAble,zIndex".split(",");\r\n                this.serializedProperties = this.serializedProperties.concat(a)\r\n            };\r\n            this.initialize();\r\n            this.paint = function (a) {\r\n                a.beginPath();\r\n                a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                a.rect(-this.width / 2, -this.height / 2, this.width, this.height);\r\n                a.fill();\r\n                a.stroke();\r\n                a.closePath();\r\n            };\r\n            this.getLocation = function () {\r\n                return {\r\n                    x: this.x,\r\n                    y: this.y\r\n                }\r\n            };\r\n            this.setLocation = function (a, b) {\r\n                if (this.qtopo && this.qtopo.attr && this.qtopo.attr.position) {\r\n                    this.qtopo.attr.position[0] = a;\r\n                    this.qtopo.attr.position[1] = b;\r\n                }\r\n                return this.x = a, this.y = b, this\r\n            };\r\n            this.getCenterLocation = function () {\r\n                return {\r\n                    x: this.x + this.width / 2,\r\n                    y: this.y + this.height / 2\r\n                }\r\n            };\r\n            this.setCenterLocation = function (a, b) {\r\n                this.x = a - this.width / 2;\r\n                this.y = b - this.height / 2;\r\n                return this;\r\n            };\r\n            this.getSize = function () {\r\n                return {\r\n                    width: this.width,\r\n                    height: this.heith\r\n                }\r\n            };\r\n            this.setSize = function (a, b) {\r\n                this.width = a;\r\n                this.height = b;\r\n                return this;\r\n            };\r\n            this.getBound = function () {\r\n                return {\r\n                    left: this.x,\r\n                    top: this.y,\r\n                    right: this.x + this.width,\r\n                    bottom: this.y + this.height,\r\n                    width: this.width,\r\n                    height: this.height\r\n                }\r\n            };\r\n            this.setBound = function (a, b, c, d) {\r\n                this.setLocation(a, b);\r\n                this.setSize(c, d);\r\n                return this;\r\n            };\r\n            this.getDisplayBound = function () {\r\n                return {\r\n                    left: this.x,\r\n                    top: this.y,\r\n                    right: this.x + this.width * this.scaleX,\r\n                    bottom: this.y + this.height * this.scaleY\r\n                }\r\n            };\r\n            this.getDisplaySize = function () {\r\n                return {\r\n                    width: this.width * this.scaleX,\r\n                    height: this.height * this.scaleY\r\n                }\r\n            };\r\n            this.getPosition = function (a) {\r\n                var position,\r\n                    c = this.getBound();\r\n                switch (a) {\r\n                    case "Top_Left":\r\n                        position = {x: c.left, y: c.top};\r\n                        break;\r\n                    case "Top_Center":\r\n                        position = {x: this.cx, y: c.top};\r\n                        break;\r\n                    case "Top_Right":\r\n                        position = {x: c.right, y: c.top};\r\n                        break;\r\n                    case "Middle_Left":\r\n                        position = {x: c.left, y: this.cy};\r\n                        break;\r\n                    case "Middle_Center":\r\n                        position = {x: this.cx, y: this.cy};\r\n                        break;\r\n                    case "Middle_Right":\r\n                        position = {x: c.right, y: this.cy};\r\n                        break;\r\n                    case "Bottom_Left":\r\n                        position = {x: c.left, y: c.bottom};\r\n                        break;\r\n                    case "Bottom_Center":\r\n                        position = {x: this.cx, y: c.bottom};\r\n                        break;\r\n                    case  "Bottom_Right":\r\n                        position = {x: c.right, y: c.bottom};\r\n                        break;\r\n                    default:\r\n                        position = {x: c.left, y: c.top};\r\n                }\r\n                return position;\r\n            };\r\n        }\r\n\r\n        function interactiveElement() {\r\n            this.initialize = function () {\r\n                interactiveElement.prototype.initialize.apply(this, arguments);\r\n                this.elementType = "interactiveElement";\r\n                this.dragable = !1;\r\n                this.selected = !1;\r\n                this.showSelected = !0;\r\n                this.selectedLocation = null;\r\n                this.isMouseOver = !1;\r\n                var a = "dragable,selected,showSelected,isMouseOver".split(",");\r\n                this.serializedProperties = this.serializedProperties.concat(a);\r\n            };\r\n            this.initialize();\r\n            this.paintSelected = function (a) {\r\n                if (0 != this.showSelected) {\r\n                    a.save();\r\n                    a.beginPath();\r\n                    a.strokeStyle = "rgba(168,202,255, 0.9)";\r\n                    a.fillStyle = "rgba(168,202,236,0.7)";\r\n                    a.rect(-this.width / 2 - 3, -this.height / 2 - 3, this.width + 6, this.height + 6);\r\n                    a.fill();\r\n                    a.stroke();\r\n                    a.closePath();\r\n                    a.restore();\r\n                }\r\n                return this;\r\n            };\r\n            this.paintMouseover = function (a) {\r\n                return this.paintSelected(a);\r\n            };\r\n            this.isInBound = function (pointX, pointY) {\r\n                return pointX > this.x && pointX < this.x + this.width * Math.abs(this.scaleX) && pointY > this.y && pointY < this.y + this.height * Math.abs(this.scaleY)\r\n            };\r\n            this.selectedHandler = function () {\r\n                this.selected = !0;\r\n                this.selectedLocation = {\r\n                    x: this.x,\r\n                    y: this.y\r\n                };\r\n                return this;\r\n            };\r\n            this.unselectedHandler = function () {\r\n                this.selected = !1;\r\n                this.selectedLocation = null;\r\n                return this;\r\n            };\r\n            this.dbclickHandler = function (a) {\r\n                this.dispatchEvent("dbclick", a);\r\n                return this;\r\n            };\r\n            this.clickHandler = function (a) {\r\n                this.dispatchEvent("click", a);\r\n                return this;\r\n            };\r\n            this.mousedownHander = function (a) {\r\n                this.dispatchEvent("mousedown", a);\r\n                return this;\r\n            };\r\n            this.mouseupHandler = function (a) {\r\n                this.dispatchEvent("mouseup", a);\r\n                return this;\r\n            };\r\n            this.mouseoverHandler = function (a) {\r\n                this.isMouseOver = !0;\r\n                this.dispatchEvent("mouseover", a);\r\n                return this;\r\n            };\r\n            this.mousemoveHandler = function (a) {\r\n                this.dispatchEvent("mousemove", a);\r\n                return this;\r\n            };\r\n            this.mouseoutHandler = function (a) {\r\n                this.isMouseOver = !1;\r\n                this.dispatchEvent("mouseout", a);\r\n                return this;\r\n            };\r\n            this.mousedragHandler = function (a) {\r\n                var b = this.selectedLocation.x + a.dx;\r\n                var c = this.selectedLocation.y + a.dy;\r\n                this.setLocation(b, c);\r\n                this.dispatchEvent("mousedrag", a);\r\n                return this;\r\n            };\r\n            this.addEventListener = function (event, fn) {\r\n                if (!this.messageBus) {\r\n                    this.messageBus = new jtopo.util.MessageBus;\r\n                }\r\n                this.messageBus.subscribe(event, fn);\r\n                return this;\r\n            };\r\n            this.dispatchEvent = function (event, e) {\r\n                if (this.messageBus) {\r\n                    this.messageBus.publish(event, e);\r\n                    return this;\r\n                }\r\n            };\r\n            this.removeEventListener = function (event, fn) {\r\n                this.messageBus.unsubscribe(event, fn);\r\n            };\r\n            this.removeAllEventListener = function () {\r\n                this.messageBus = new jtopo.util.MessageBus\r\n            };\r\n            var self = this;\r\n            "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,touchstart,touchmove,touchend".split(",")\r\n                .forEach(function (eventName) {\r\n                    self[eventName] = function (e) {\r\n                        if (null != e) {\r\n                            this.addEventListener(eventName, e);\r\n                        } else {\r\n                            this.dispatchEvent(eventName);\r\n                        }\r\n                    }\r\n                });\r\n        }\r\n\r\n        function EditableElement() {\r\n            this.initialize = function () {\r\n                EditableElement.prototype.initialize.apply(this, arguments);\r\n                this.editAble = !1;\r\n                this.selectedPoint = null;\r\n            };\r\n            this.getCtrlPosition = function (a) {\r\n                var b = 5;\r\n                var c = 5;\r\n                var d = this.getPosition(a);\r\n                return {\r\n                    left: d.x - b,\r\n                    top: d.y - c,\r\n                    right: d.x + b,\r\n                    bottom: d.y + c\r\n                }\r\n            };\r\n            this.selectedHandler = function (b) {\r\n                EditableElement.prototype.selectedHandler.apply(this, arguments), this.selectedSize = {\r\n                    width: this.width,\r\n                    height: this.height\r\n                };\r\n                if (b.scene.mode == jtopo.SceneMode.edit) {\r\n                    this.editAble = !0\r\n                }\r\n            };\r\n            this.unselectedHandler = function () {\r\n                EditableElement.prototype.unselectedHandler.apply(this, arguments);\r\n                this.selectedSize = null;\r\n                this.editAble = !1;\r\n            };\r\n            var b = ["Top_Left", "Top_Center", "Top_Right", "Middle_Left", "Middle_Right", "Bottom_Left", "Bottom_Center", "Bottom_Right"];\r\n            this.paintCtrl = function (cx) {\r\n                if (0 != this.editAble) {\r\n                    cx.save();\r\n                    for (var c = 0; c < b.length; c++) {\r\n                        var d = this.getCtrlPosition(b[c]);\r\n                        d.left -= this.cx;\r\n                        d.right -= this.cx;\r\n                        d.top -= this.cy;\r\n                        d.bottom -= this.cy;\r\n                        var e = d.right - d.left;\r\n                        var f = d.bottom - d.top;\r\n                        cx.beginPath();\r\n                        cx.strokeStyle = "rgba(0,0,0,0.8)";\r\n                        cx.rect(d.left, d.top, e, f);\r\n                        cx.stroke();\r\n                        cx.closePath();\r\n                        cx.beginPath();\r\n                        cx.strokeStyle = "rgba(255,255,255,0.3)";\r\n                        cx.rect(d.left + 1, d.top + 1, e - 2, f - 2);\r\n                        cx.stroke();\r\n                        cx.closePath();\r\n                    }\r\n                    cx.restore();\r\n                }\r\n            };\r\n            this.isInBound = function (a, c) {\r\n                if (this.selectedPoint = null, 1 == this.editAble)for (var e = 0; e < b.length; e++) {\r\n                    var f = this.getCtrlPosition(b[e]);\r\n                    if (a > f.left && a < f.right && c > f.top && c < f.bottom)return this.selectedPoint = b[e], !0\r\n                }\r\n                return EditableElement.prototype.isInBound.apply(this, arguments)\r\n            };\r\n            this.mousedragHandler = function (a) {\r\n                if (null == this.selectedPoint) {\r\n                    var b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                    this.setLocation(b, c), this.dispatchEvent("mousedrag", a)\r\n                } else {\r\n                    if ("Top_Left" == this.selectedPoint) {\r\n                        var d = this.selectedSize.width - a.dx, e = this.selectedSize.height - a.dy, b = this.selectedLocation.x + a.dx, c = this.selectedLocation.y + a.dy;\r\n                        b < this.x + this.width && (this.x = b, this.width = d), c < this.y + this.height && (this.y = c, this.height = e)\r\n                    } else if ("Top_Center" == this.selectedPoint) {\r\n                        var e = this.selectedSize.height - a.dy, c = this.selectedLocation.y + a.dy;\r\n                        c < this.y + this.height && (this.y = c, this.height = e)\r\n                    } else if ("Top_Right" == this.selectedPoint) {\r\n                        var d = this.selectedSize.width + a.dx, c = this.selectedLocation.y + a.dy;\r\n                        c < this.y + this.height && (this.y = c, this.height = this.selectedSize.height - a.dy), d > 1 && (this.width = d)\r\n                    } else if ("Middle_Left" == this.selectedPoint) {\r\n                        var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                        b < this.x + this.width && (this.x = b), d > 1 && (this.width = d)\r\n                    } else if ("Middle_Right" == this.selectedPoint) {\r\n                        var d = this.selectedSize.width + a.dx;\r\n                        d > 1 && (this.width = d)\r\n                    } else if ("Bottom_Left" == this.selectedPoint) {\r\n                        var d = this.selectedSize.width - a.dx, b = this.selectedLocation.x + a.dx;\r\n                        d > 1 && (this.x = b, this.width = d);\r\n                        var e = this.selectedSize.height + a.dy;\r\n                        e > 1 && (this.height = e)\r\n                    } else if ("Bottom_Center" == this.selectedPoint) {\r\n                        var e = this.selectedSize.height + a.dy;\r\n                        e > 1 && (this.height = e)\r\n                    } else if ("Bottom_Right" == this.selectedPoint) {\r\n                        var d = this.selectedSize.width + a.dx;\r\n                        d > 1 && (this.width = d);\r\n                        var e = this.selectedSize.height + a.dy;\r\n                        e > 1 && (this.height = e)\r\n                    }\r\n                    this.dispatchEvent("resize", a)\r\n                }\r\n            }\r\n        }\r\n\r\n        DisplayElement.prototype = new jtopo.Element, Object.defineProperties(DisplayElement.prototype, {\r\n            cx: {\r\n                get: function () {\r\n                    return this.x + this.width / 2\r\n                }, set: function (a) {\r\n                    this.x = a - this.width / 2\r\n                }\r\n            }, cy: {\r\n                get: function () {\r\n                    return this.y + this.height / 2\r\n                }, set: function (a) {\r\n                    this.y = a - this.height / 2\r\n                }\r\n            }\r\n        });\r\n        interactiveElement.prototype = new DisplayElement;\r\n        EditableElement.prototype = new interactiveElement;\r\n        jtopo.DisplayElement = DisplayElement;\r\n        jtopo.InteractiveElement = interactiveElement;\r\n        jtopo.EditableElement = EditableElement;\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function baseNode(c) {\r\n            this.initialize = function (c) {\r\n                baseNode.prototype.initialize.apply(this, arguments), this.elementType = "node", this.zIndex = jtopo.zIndex_Node, this.text = c, this.font = "12px Consolas", this.fontColor = "255,255,255", this.borderWidth = 0, this.borderColor = "255,255,255", this.borderRadius = null, this.dragable = !0, this.textPosition = "Bottom_Center", this.textOffsetX = 0, this.textOffsetY = 0, this.transformAble = !0, this.inLinks = null, this.outLinks = null;\r\n                var d = "text,font,fontColor,textPosition,textOffsetX,textOffsetY,borderRadius".split(",");\r\n                this.serializedProperties = this.serializedProperties.concat(d)\r\n            }, this.initialize(c), this.paint = function (a) {\r\n                if (this.image) {\r\n                    var b = a.globalAlpha;\r\n                    a.globalAlpha = this.alpha, null != this.alarmImage && null != this.alarm ? a.drawImage(this.alarmImage, -this.width / 2, -this.height / 2, this.width, this.height) : a.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height), a.globalAlpha = b\r\n                } else a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")", null == this.borderRadius || 0 == this.borderRadius ? a.rect(-this.width / 2, -this.height / 2, this.width, this.height) : a.JTopoRoundRect(-this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius), a.fill(), a.closePath();\r\n                this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n            }, this.paintAlarmText = function (a) {\r\n                if (null != this.alarm && "" != this.alarm) {\r\n                    var b = this.alarmColor || "255,0,0", c = this.alarmAlpha || .5;\r\n                    a.beginPath(), a.font = this.alarmFont || "10px 微软雅黑";\r\n                    var d = a.measureText(this.alarm).width + 6, e = a.measureText("田").width + 6, f = this.width / 2 - d / 2, g = -this.height / 2 - e - 8;\r\n                    a.strokeStyle = "rgba(" + b + ", " + c + ")", a.fillStyle = "rgba(" + b + ", " + c + ")", a.lineCap = "round", a.lineWidth = 1, a.moveTo(f, g), a.lineTo(f + d, g), a.lineTo(f + d, g + e), a.lineTo(f + d / 2 + 6, g + e), a.lineTo(f + d / 2, g + e + 8), a.lineTo(f + d / 2 - 6, g + e), a.lineTo(f, g + e), a.lineTo(f, g), a.fill(), a.stroke(), a.closePath(), a.beginPath(), a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.alarm, f + 2, g + e - 4), a.closePath()\r\n                }\r\n            }, this.paintText = function (a) {\r\n                var b = this.text;\r\n                if (null != b && "" != b) {\r\n                    a.beginPath(), a.font = this.font;\r\n                    var c = a.measureText(b).width, d = a.measureText("田").width;\r\n                    a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                    var e = this.getTextPostion(this.textPosition, c, d);\r\n                    a.fillText(b, e.x, e.y), a.closePath()\r\n                }\r\n            }, this.paintBorder = function (a) {\r\n                if (0 != this.borderWidth) {\r\n                    a.beginPath();\r\n                    a.lineWidth = this.borderWidth;\r\n                    a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                    var b = this.borderWidth / 2;\r\n                    if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                        a.rect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth);\r\n                    } else {\r\n                        a.JTopoRoundRect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius);\r\n                    }\r\n                    a.stroke();\r\n                    a.closePath();\r\n                }\r\n            }, this.getTextPostion = function (position, maxWidth, fontWidth, height) {\r\n                var d = null;\r\n                switch (position) {\r\n                    case "Bottom_Center":\r\n                        d = {\r\n                            x: -this.width / 2 + (this.width - maxWidth) / 2,\r\n                            y: this.height / 2 + fontWidth\r\n                        };\r\n                        break;\r\n                    case "Top_Center":\r\n                        d = {\r\n                            x: -this.width / 2 + (this.width - maxWidth) / 2,\r\n                            y: -this.height / 2 - fontWidth / 2 - fontWidth * (height - 1)\r\n                        };\r\n                        break;\r\n                    case "Top_Right":\r\n                        d = {\r\n                            x: this.width / 2,\r\n                            y: -this.height / 2 - fontWidth / 2\r\n                        };\r\n                        break;\r\n                    case "Top_Left":\r\n                        d = {\r\n                            x: -this.width / 2 - maxWidth,\r\n                            y: -this.height / 2 - fontWidth / 2\r\n                        };\r\n                        break;\r\n                    case "Bottom_Right":\r\n                        d = {\r\n                            x: this.width / 2,\r\n                            y: this.height / 2 + fontWidth\r\n                        };\r\n                        break;\r\n                    case "Bottom_Left":\r\n                        d = {\r\n                            x: -this.width / 2 - maxWidth,\r\n                            y: this.height / 2 + fontWidth\r\n                        };\r\n                        break;\r\n                    case "Middle_Center":\r\n                        d = {\r\n                            x: -this.width / 2 + (this.width - maxWidth) / 2,\r\n                            y: fontWidth / 2\r\n                        };\r\n                        break;\r\n                    case "Middle_Right":\r\n                        d = {\r\n                            x: this.width / 2,\r\n                            y: fontWidth / 2\r\n                        };\r\n                        break;\r\n                    case "Middle_Left":\r\n                        d = {\r\n                            x: -this.width / 2 - maxWidth,\r\n                            y: fontWidth / 2\r\n                        };\r\n                        break;\r\n                    default:\r\n                        d = {\r\n                            x: -this.width / 2 - maxWidth,\r\n                            y: fontWidth / 2\r\n                        };\r\n                }\r\n                if (null != this.textOffsetX) {\r\n                    d.x += this.textOffsetX\r\n                }\r\n                if (null != this.textOffsetY) {\r\n                    d.y += this.textOffsetY\r\n                }\r\n                return d;\r\n            }, this.setImage = function (a, b) {\r\n                if (null == a)throw new Error("Node.setImage(): 参数Image对象为空!");\r\n                var c = this;\r\n                if ("string" == typeof a) {\r\n                    var d = j[a];\r\n                    null == d ? (d = new Image, d.src = a, d.onload = function () {\r\n                        j[a] = d, 1 == b && c.setSize(d.width, d.height), c.image = d, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor\r\n                    }) : (b && this.setSize(d.width, d.height), c.image = d, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor)\r\n                } else this.image = a, c.alarmColor = null == c.alarmColor ? "255,0,0" : c.alarmColor, 1 == b && this.setSize(a.width, a.height)\r\n            };\r\n            this.removeHandler = function (scene) {\r\n                var self = this;\r\n                if (this.outLinks) {\r\n                    this.outLinks.forEach(function (c) {\r\n                        if (c.nodeA === self) {\r\n                            scene.remove(c)\r\n                        }\r\n                    });\r\n                    this.outLinks = null;\r\n                }\r\n                if (this.inLinks) {\r\n                    this.inLinks.forEach(function (c) {\r\n                        c.nodeZ === self && scene.remove(c)\r\n                    });\r\n                    this.inLinks = null;\r\n                }\r\n            }\r\n        }\r\n\r\n        function Node() {\r\n            Node.prototype.initialize.apply(this, arguments)\r\n        }\r\n\r\n        function TextNode(a) {\r\n            this.initialize(), this.text = a, this.elementType = "TextNode", this.paint = function (a) {\r\n                a.beginPath(), a.font = this.font, this.width = a.measureText(this.text).width, this.height = a.measureText("田").width, a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.text, -this.width / 2, this.height / 2), a.closePath(), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n            }\r\n        }\r\n\r\n        function LinkNode(a, b, c) {\r\n            this.initialize(), this.text = a, this.href = b, this.target = c, this.elementType = "LinkNode", this.isVisited = !1, this.visitedColor = null, this.paint = function (a) {\r\n                a.beginPath(), a.font = this.font, this.width = a.measureText(this.text).width, this.height = a.measureText("田").width, this.isVisited && null != this.visitedColor ? (a.strokeStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")") : (a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")"), a.fillText(this.text, -this.width / 2, this.height / 2), this.isMouseOver && (a.moveTo(-this.width / 2, this.height), a.lineTo(this.width / 2, this.height), a.stroke()), a.closePath(), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n            }, this.mousemove(function () {\r\n                var a = document.getElementsByTagName("canvas");\r\n                if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "pointer"\r\n            }), this.mouseout(function () {\r\n                var a = document.getElementsByTagName("canvas");\r\n                if (a && a.length > 0)for (var b = 0; b < a.length; b++)a[b].style.cursor = "default"\r\n            }), this.click(function () {\r\n                "_blank" == this.target ? window.open(this.href) : location = this.href, this.isVisited = !0\r\n            })\r\n        }\r\n\r\n        function CircleNode(text) {\r\n            this.initialize(arguments);\r\n            this._radius = 20;\r\n            this.beginDegree = 0;\r\n            this.endDegree = 2 * Math.PI;\r\n            this.text = text;\r\n            this.paint = function (context) {\r\n                context.save();\r\n                context.beginPath();\r\n                context.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                context.arc(0, 0, this.radius, this.beginDegree, this.endDegree, !0);\r\n                context.fill();\r\n                context.closePath();\r\n                context.restore();\r\n                this.paintText(context);\r\n                this.paintBorder(context);\r\n                this.paintCtrl(context);\r\n                this.paintAlarmText(context);\r\n            }, this.paintSelected = function (context) {\r\n                context.save();\r\n                context.beginPath();\r\n                context.strokeStyle = "rgba(168,202,255, 0.9)";\r\n                context.fillStyle = "rgba(168,202,236,0.7)";\r\n                context.arc(0, 0, this.radius + 3, this.beginDegree, this.endDegree, !0);\r\n                context.fill();\r\n                context.stroke();\r\n                context.closePath();\r\n                context.restore();\r\n            }\r\n        }\r\n\r\n        function g(a, b, c) {\r\n            this.initialize();\r\n            this.frameImages = a || [];\r\n            this.frameIndex = 0;\r\n            this.isStop = !0;\r\n            var d = b || 1e3;\r\n            this.repeatPlay = !1;\r\n            var e = this;\r\n            this.nextFrame = function () {\r\n                if (!this.isStop && null != this.frameImages.length) {\r\n                    this.frameIndex++;\r\n                    if (this.frameIndex >= this.frameImages.length) {\r\n                        if (!this.repeatPlay)return;\r\n                        this.frameIndex = 0;\r\n                    }\r\n                    this.setImage(this.frameImages[this.frameIndex], c);\r\n                    setTimeout(function () {\r\n                        e.nextFrame();\r\n                    }, d / a.length);\r\n                }\r\n            }\r\n        }\r\n\r\n        function h(a, b, c, d, e) {\r\n            this.initialize();\r\n            var f = this;\r\n            this.setImage(a), this.frameIndex = 0, this.isPause = !0, this.repeatPlay = !1;\r\n            var g = d || 1e3;\r\n            e = e || 0, this.paint = function (a) {\r\n                if (this.image) {\r\n                    var b = this.width, d = this.height;\r\n                    a.save(), a.beginPath(), a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                    var f = (Math.floor(this.frameIndex / c) + e) * d, g = Math.floor(this.frameIndex % c) * b;\r\n                    a.drawImage(this.image, g, f, b, d, -b / 2, -d / 2, b, d), a.fill(), a.closePath(), a.restore(), this.paintText(a), this.paintBorder(a), this.paintCtrl(a), this.paintAlarmText(a)\r\n                }\r\n            }, this.nextFrame = function () {\r\n                if (!this.isStop) {\r\n                    if (this.frameIndex++, this.frameIndex >= b * c) {\r\n                        if (!this.repeatPlay)return;\r\n                        this.frameIndex = 0\r\n                    }\r\n                    setTimeout(function () {\r\n                        f.isStop || f.nextFrame()\r\n                    }, g / (b * c))\r\n                }\r\n            }\r\n        }\r\n\r\n        function AnimateNode() {\r\n            var a = null;\r\n            return a = arguments.length <= 3 ? new g(arguments[0], arguments[1], arguments[2]) : new h(arguments[0], arguments[1], arguments[2], arguments[3], arguments[4], arguments[5]), a.stop = function () {\r\n                a.isStop = !0\r\n            }, a.play = function () {\r\n                a.isStop = !1, a.frameIndex = 0, a.nextFrame()\r\n            }, a\r\n        }\r\n\r\n        var j = {};\r\n        baseNode.prototype = new jtopo.EditableElement;\r\n        Node.prototype = new baseNode;\r\n        Object.defineProperties(Node.prototype, {\r\n            alarmColor: {\r\n                get: function () {\r\n                    return this._alarmColor\r\n                }, set: function (color) {\r\n                    this._alarmColor = color;\r\n                    if (null != this.image) {\r\n                        var c = jtopo.util.genImageAlarm(this.image, color);\r\n                        if (c) {\r\n                            this.alarmImage = c;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        TextNode.prototype = new Node;\r\n        LinkNode.prototype = new TextNode;\r\n        CircleNode.prototype = new Node;\r\n        Object.defineProperties(CircleNode.prototype, {\r\n            radius: {\r\n                get: function () {\r\n                    return this._radius\r\n                }, set: function (a) {\r\n                    this._radius = a;\r\n                    var b = 2 * this.radius, c = 2 * this.radius;\r\n                    this.width = b, this.height = c\r\n                }\r\n            }, width: {\r\n                get: function () {\r\n                    return this._width\r\n                }, set: function (a) {\r\n                    this._radius = a / 2, this._width = a\r\n                }\r\n            }, height: {\r\n                get: function () {\r\n                    return this._height\r\n                }, set: function (a) {\r\n                    this._radius = a / 2, this._height = a\r\n                }\r\n            }\r\n        });\r\n        g.prototype = new Node;\r\n        h.prototype = new Node;\r\n        AnimateNode.prototype = new Node;\r\n        jtopo.Node = Node;\r\n        jtopo.TextNode = TextNode;\r\n        jtopo.LinkNode = LinkNode;\r\n        jtopo.CircleNode = CircleNode;\r\n        jtopo.AnimateNode = AnimateNode;\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function getPublicLink(elementA, elementB) {\r\n            var result = [];\r\n            if (null == elementA || null == elementB)return result;\r\n            if (elementA && elementB && elementA.outLinks && elementB.inLinks)\r\n                for (var i = 0; i < elementA.outLinks.length; i++) {\r\n                    var outLink = elementA.outLinks[i];\r\n                    for (var f = 0; f < elementB.inLinks.length; f++) {\r\n                        var inlink = elementB.inLinks[f];\r\n                        if (outLink === inlink) {\r\n                            result.push(inlink);\r\n                        }\r\n                    }\r\n                }\r\n            return result\r\n        }\r\n\r\n        function getLinksBetween(start, end) {\r\n            var d = getPublicLink(start, end);\r\n            var e = getPublicLink(end, start);\r\n            return d.concat(e);\r\n        }\r\n\r\n        function getLinkNotThis(link) {\r\n            var b = getLinksBetween(link.nodeA, link.nodeZ);\r\n            return b = b.filter(function (b) {\r\n                return link !== b\r\n            })\r\n        }\r\n\r\n        function getNums(a, b) {\r\n            return getLinksBetween(a, b).length\r\n        }\r\n\r\n        function Link(b, c, g) {\r\n            function h(start, end) {\r\n                var link = jtopo.util.lineF(start.cx, start.cy, end.cx, end.cy);\r\n                var bound = start.getBound();\r\n                return jtopo.util.intersectionLineBound(link, bound);\r\n            }\r\n\r\n            this.initialize = function (b, c, d) {\r\n                if (Link.prototype.initialize.apply(this, arguments), this.elementType = "link", this.zIndex = jtopo.zIndex_Link, 0 != arguments.length) {\r\n                    this.text = d;\r\n                    this.nodeA = b;\r\n                    this.nodeZ = c;\r\n                    this.nodeA && null == this.nodeA.outLinks && (this.nodeA.outLinks = []);\r\n                    this.nodeA && null == this.nodeA.inLinks && (this.nodeA.inLinks = []);\r\n                    this.nodeZ && null == this.nodeZ.inLinks && (this.nodeZ.inLinks = []);\r\n                    this.nodeZ && null == this.nodeZ.outLinks && (this.nodeZ.outLinks = []);\r\n                    null != this.nodeA && this.nodeA.outLinks.push(this);\r\n                    null != this.nodeZ && this.nodeZ.inLinks.push(this);\r\n                    this.caculateIndex();\r\n                    this.font = "12px Consolas";\r\n                    this.fontColor = "255,255,255";\r\n                    this.lineWidth = 2;\r\n                    this.lineJoin = "miter";\r\n                    this.transformAble = !1;\r\n                    this.bundleOffset = 20;\r\n                    this.bundleGap = 12;\r\n                    this.textOffsetX = 0;\r\n                    this.textOffsetY = 0;\r\n                    this.arrowsRadius = null;\r\n                    this.arrowsOffset = 0;\r\n                    this.dashedPattern = null;\r\n                    this.path = [];\r\n                    var e = "text,font,fontColor,lineWidth,lineJoin".split(",");\r\n                    this.serializedProperties = this.serializedProperties.concat(e)\r\n                }\r\n            }, this.caculateIndex = function () {\r\n                var a = getNums(this.nodeA, this.nodeZ);\r\n                a > 0 && (this.nodeIndex = a - 1)\r\n            }, this.initialize(b, c, g), this.removeHandler = function () {\r\n                var a = this;\r\n                this.nodeA && this.nodeA.outLinks && (this.nodeA.outLinks = this.nodeA.outLinks.filter(function (b) {\r\n                    return b !== a\r\n                })), this.nodeZ && this.nodeZ.inLinks && (this.nodeZ.inLinks = this.nodeZ.inLinks.filter(function (b) {\r\n                    return b !== a\r\n                }));\r\n                var b = getLinkNotThis(this);\r\n                b.forEach(function (a, b) {\r\n                    a.nodeIndex = b\r\n                })\r\n            }, this.getStartPosition = function () {\r\n                var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n                return a\r\n            }, this.getEndPosition = function () {\r\n                var a;\r\n                return null != this.arrowsRadius && (a = h(this.nodeZ, this.nodeA)), null == a && (a = {x: this.nodeZ.cx, y: this.nodeZ.cy}), a\r\n            }, this.getPath = function () {\r\n                var a = [], b = this.getStartPosition(), c = this.getEndPosition();\r\n                if (this.nodeA === this.nodeZ)return [b, c];\r\n                var d = getNums(this.nodeA, this.nodeZ);\r\n                if (1 == d)return [b, c];\r\n                var f = Math.atan2(c.y - b.y, c.x - b.x), g = {x: b.x + this.bundleOffset * Math.cos(f), y: b.y + this.bundleOffset * Math.sin(f)}, h = {\r\n                    x: c.x + this.bundleOffset * Math.cos(f - Math.PI),\r\n                    y: c.y + this.bundleOffset * Math.sin(f - Math.PI)\r\n                }, i = f - Math.PI / 2, j = f - Math.PI / 2, k = d * this.bundleGap / 2 - this.bundleGap / 2, l = this.bundleGap * this.nodeIndex, m = {\r\n                    x: g.x + l * Math.cos(i),\r\n                    y: g.y + l * Math.sin(i)\r\n                }, n = {x: h.x + l * Math.cos(j), y: h.y + l * Math.sin(j)};\r\n                return m = {x: m.x + k * Math.cos(i - Math.PI), y: m.y + k * Math.sin(i - Math.PI)}, n = {x: n.x + k * Math.cos(j - Math.PI), y: n.y + k * Math.sin(j - Math.PI)}, a.push({\r\n                    x: b.x,\r\n                    y: b.y\r\n                }), a.push({x: m.x, y: m.y}), a.push({x: n.x, y: n.y}), a.push({x: c.x, y: c.y}), a\r\n            }, this.paintPath = function (a, b) {\r\n                if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n                a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n                for (var c = 1; c < b.length; c++)null == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);\r\n                if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n                    var d = b[b.length - 2], e = b[b.length - 1];\r\n                    this.paintArrow(a, d, e)\r\n                }\r\n            }, this.paintLoop = function (a) {\r\n                a.beginPath();\r\n                {\r\n                    var b = this.bundleGap * (this.nodeIndex + 1) / 2;\r\n                    Math.PI + Math.PI / 2\r\n                }\r\n                a.arc(this.nodeA.x, this.nodeA.y, b, Math.PI / 2, 2 * Math.PI), a.stroke(), a.closePath()\r\n            }, this.paintArrow = function (b, c, d) {\r\n                var e = this.arrowsOffset, f = this.arrowsRadius / 2, g = c, h = d, i = Math.atan2(h.y - g.y, h.x - g.x), j = jtopo.util.getDistance(g, h) - this.arrowsRadius, k = g.x + (j + e) * Math.cos(i), l = g.y + (j + e) * Math.sin(i), m = h.x + e * Math.cos(i), n = h.y + e * Math.sin(i);\r\n                i -= Math.PI / 2;\r\n                var o = {x: k + f * Math.cos(i), y: l + f * Math.sin(i)}, p = {x: k + f * Math.cos(i - Math.PI), y: l + f * Math.sin(i - Math.PI)};\r\n                b.beginPath(), b.fillStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", b.moveTo(o.x, o.y), b.lineTo(m, n), b.lineTo(p.x, p.y), b.stroke(), b.closePath()\r\n            }, this.paint = function (a) {\r\n                if (null != this.nodeA && null != !this.nodeZ) {\r\n                    var b = this.getPath(this.nodeIndex);\r\n                    this.path = b, a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", a.lineWidth = this.lineWidth, this.paintPath(a, b), b && b.length > 0 && this.paintText(a, b)\r\n                }\r\n            };\r\n            var i = -(Math.PI / 2 + Math.PI / 4);\r\n            this.paintText = function (a, b) {\r\n                var c = b[0], d = b[b.length - 1];\r\n                if (4 == b.length && (c = b[1], d = b[2]), this.text && this.text.length > 0) {\r\n                    var e = (d.x + c.x) / 2 + this.textOffsetX, f = (d.y + c.y) / 2 + this.textOffsetY;\r\n                    a.save(), a.beginPath(), a.font = this.font;\r\n                    var g = a.measureText(this.text).width, h = a.measureText("田").width;\r\n                    if (a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", this.nodeA === this.nodeZ) {\r\n                        var j = this.bundleGap * (this.nodeIndex + 1) / 2, e = this.nodeA.x + j * Math.cos(i), f = this.nodeA.y + j * Math.sin(i);\r\n                        a.fillText(this.text, e, f)\r\n                    } else a.fillText(this.text, e - g / 2, f - h / 2);\r\n                    a.stroke(), a.closePath(), a.restore()\r\n                }\r\n            }, this.paintSelected = function (a) {\r\n                a.shadowBlur = 10, a.shadowColor = "rgba(0,0,0,1)", a.shadowOffsetX = 0, a.shadowOffsetY = 0\r\n            }, this.isInBound = function (b, c) {\r\n                if (this.nodeA === this.nodeZ) {\r\n                    var d = this.bundleGap * (this.nodeIndex + 1) / 2, e = jtopo.util.getDistance(this.nodeA, {x: b, y: c}) - d;\r\n                    return Math.abs(e) <= 3\r\n                }\r\n                for (var f = !1, g = 1; g < this.path.length; g++) {\r\n                    var h = this.path[g - 1], i = this.path[g];\r\n                    if (1 == jtopo.util.isPointInLine({x: b, y: c}, h, i)) {\r\n                        f = !0;\r\n                        break\r\n                    }\r\n                }\r\n                return f\r\n            }\r\n        }\r\n\r\n        function FoldLink(a, b, c) {\r\n            this.initialize = function () {\r\n                FoldLink.prototype.initialize.apply(this, arguments), this.direction = "horizontal"\r\n            }, this.initialize(a, b, c), this.getStartPosition = function () {\r\n                var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n                return "horizontal" == this.direction ? this.nodeZ.cx > a.x ? a.x += this.nodeA.width / 2 : a.x -= this.nodeA.width / 2 : this.nodeZ.cy > a.y ? a.y += this.nodeA.height / 2 : a.y -= this.nodeA.height / 2, a\r\n            }, this.getEndPosition = function () {\r\n                var a = {x: this.nodeZ.cx, y: this.nodeZ.cy};\r\n                return "horizontal" == this.direction ? this.nodeA.cy < a.y ? a.y -= this.nodeZ.height / 2 : a.y += this.nodeZ.height / 2 : a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width, a\r\n            }, this.getPath = function (a) {\r\n                var b = [], c = this.getStartPosition(), d = this.getEndPosition();\r\n                if (this.nodeA === this.nodeZ)return [c, d];\r\n                var f, g, h = getNums(this.nodeA, this.nodeZ), i = (h - 1) * this.bundleGap, j = this.bundleGap * a - i / 2;\r\n                return "horizontal" == this.direction ? (f = d.x + j, g = c.y - j, b.push({x: c.x, y: g}), b.push({x: f, y: g}), b.push({x: f, y: d.y})) : (f = c.x + j, g = d.y - j, b.push({\r\n                    x: f,\r\n                    y: c.y\r\n                }), b.push({x: f, y: g}), b.push({x: d.x, y: g})), b\r\n            }, this.paintText = function (a, b) {\r\n                if (this.text && this.text.length > 0) {\r\n                    var c = b[1], d = c.x + this.textOffsetX, e = c.y + this.textOffsetY;\r\n                    a.save(), a.beginPath(), a.font = this.font;\r\n                    var f = a.measureText(this.text).width, g = a.measureText("田").width;\r\n                    a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")", a.fillText(this.text, d - f / 2, e - g / 2), a.stroke(), a.closePath(), a.restore()\r\n                }\r\n            }\r\n        }\r\n\r\n        function FlexionalLink(a, b, c) {\r\n            this.initialize = function () {\r\n                FlexionalLink.prototype.initialize.apply(this, arguments), this.direction = "vertical", this.offsetGap = 44\r\n            }, this.initialize(a, b, c), this.getStartPosition = function () {\r\n                var a = {x: this.nodeA.cx, y: this.nodeA.cy};\r\n                return "horizontal" == this.direction ? a.x = this.nodeZ.cx < a.x ? this.nodeA.x : this.nodeA.x + this.nodeA.width : a.y = this.nodeZ.cy < a.y ? this.nodeA.y : this.nodeA.y + this.nodeA.height, a\r\n            }, this.getEndPosition = function () {\r\n                var a = {x: this.nodeZ.cx, y: this.nodeZ.cy};\r\n                return "horizontal" == this.direction ? a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width : a.y = this.nodeA.cy < a.y ? this.nodeZ.y : this.nodeZ.y + this.nodeZ.height, a\r\n            }, this.getPath = function (a) {\r\n                var b = this.getStartPosition(), c = this.getEndPosition();\r\n                if (this.nodeA === this.nodeZ)return [b, c];\r\n                var d = [], f = getNums(this.nodeA, this.nodeZ), g = (f - 1) * this.bundleGap, h = this.bundleGap * a - g / 2, i = this.offsetGap;\r\n                return "horizontal" == this.direction ? (this.nodeA.cx > this.nodeZ.cx && (i = -i), d.push({x: b.x, y: b.y + h}), d.push({x: b.x + i, y: b.y + h}), d.push({\r\n                    x: c.x - i,\r\n                    y: c.y + h\r\n                }), d.push({x: c.x, y: c.y + h})) : (this.nodeA.cy > this.nodeZ.cy && (i = -i), d.push({x: b.x + h, y: b.y}), d.push({x: b.x + h, y: b.y + i}), d.push({\r\n                    x: c.x + h,\r\n                    y: c.y - i\r\n                }), d.push({x: c.x + h, y: c.y})), d\r\n            }\r\n        }\r\n\r\n        function CurveLink(a, b, c) {\r\n            this.initialize = function () {\r\n                CurveLink.prototype.initialize.apply(this, arguments)\r\n            }, this.initialize(a, b, c), this.paintPath = function (a, b) {\r\n                if (this.nodeA === this.nodeZ)return void this.paintLoop(a);\r\n                a.beginPath(), a.moveTo(b[0].x, b[0].y);\r\n                for (var c = 1; c < b.length; c++) {\r\n                    var d = b[c - 1], e = b[c], f = (d.x + e.x) / 2, g = (d.y + e.y) / 2;\r\n                    g += (e.y - d.y) / 2, a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")", a.lineWidth = this.lineWidth, a.moveTo(d.x, d.cy), a.quadraticCurveTo(f, g, e.x, e.y), a.stroke()\r\n                }\r\n                if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n                    var h = b[b.length - 2], i = b[b.length - 1];\r\n                    this.paintArrow(a, h, i)\r\n                }\r\n            }\r\n        }\r\n\r\n        Link.prototype = new jtopo.InteractiveElement;\r\n        FoldLink.prototype = new Link;\r\n        FlexionalLink.prototype = new Link;\r\n        CurveLink.prototype = new Link;\r\n        jtopo.Link = Link;\r\n        jtopo.FoldLink = FoldLink;\r\n        jtopo.FlexionalLink = FlexionalLink;\r\n        jtopo.CurveLink = CurveLink;\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function container(c) {\r\n            this.initialize = function (c) {\r\n                container.prototype.initialize.apply(this, null),\r\n                    this.elementType = "container",\r\n                    this.zIndex = jtopo.zIndex_Container,\r\n                    this.width = 100,\r\n                    this.height = 100,\r\n                    this.childs = [],\r\n                    this.alpha = .5,\r\n                    this.dragable = !0,\r\n                    this.childDragble = !0,\r\n                    this.visible = !0,\r\n                    this.fillColor = "10,100,80",\r\n                    this.borderWidth = 0,\r\n                    this.borderColor = "255,255,255",\r\n                    this.borderRadius = null,\r\n                    this.font = "12px Consolas",\r\n                    this.fontColor = "255,255,255",\r\n                    this.text = c,\r\n                    this.textPosition = "Bottom_Center",\r\n                    this.textOffsetX = 0,\r\n                    this.textOffsetY = 0,\r\n                    this.layout = new jtopo.layout.AutoBoundLayout\r\n            }, this.initialize(c), this.add = function (a) {\r\n                this.childs.push(a), a.dragable = this.childDragble\r\n            }, this.remove = function (a) {\r\n                for (var b = 0; b < this.childs.length; b++)if (this.childs[b] === a) {\r\n                    a.parentContainer = null, this.childs = this.childs.del(b), a.lastParentContainer = this;\r\n                    break\r\n                }\r\n            }, this.removeAll = function () {\r\n                this.childs = []\r\n            }, this.setLocation = function (a, b) {\r\n                var c = a - this.x, d = b - this.y;\r\n                this.x = a, this.y = b;\r\n                if (this.qtopo && this.qtopo.attr && this.qtopo.attr.position) {\r\n                    this.qtopo.attr.position[0] = a;\r\n                    this.qtopo.attr.position[1] = b;\r\n                }\r\n                for (var e = 0; e < this.childs.length; e++) {\r\n                    var f = this.childs[e];\r\n                    f.setLocation(f.x + c, f.y + d)\r\n                }\r\n            }, this.doLayout = function (a) {\r\n                a && a(this, this.childs)\r\n            }, this.paint = function (a) {\r\n                if (this.visible) {\r\n                    if (this.layout) {\r\n                        this.layout(this, this.childs);\r\n                    }\r\n                    a.beginPath();\r\n                    a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                    if (null == this.borderRadius || 0 == this.borderRadius) {\r\n                        a.rect(this.x, this.y, this.width, this.height);\r\n                    } else {\r\n                        a.JTopoRoundRect(this.x, this.y, this.width, this.height, this.borderRadius);\r\n                    }\r\n                    a.fill();\r\n                    a.closePath();\r\n                    this.paintText(a);\r\n                    this.paintBorder(a);\r\n                }\r\n            }, this.paintBorder = function (a) {\r\n                if (0 != this.borderWidth) {\r\n                    a.beginPath(), a.lineWidth = this.borderWidth, a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";\r\n                    var b = this.borderWidth / 2;\r\n                    null == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth) : a.JTopoRoundRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius), a.stroke(), a.closePath()\r\n                }\r\n            }, this.paintText = function (a) {\r\n                var b = this.text;\r\n                if (null != b && "" != b) {\r\n                    a.beginPath(), a.font = this.font;\r\n                    var c = a.measureText(b).width, d = a.measureText("田").width;\r\n                    a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n                    var e = this.getTextPostion(this.textPosition, c, d);\r\n                    a.fillText(b, e.x, e.y), a.closePath()\r\n                }\r\n            }, this.getTextPostion = function (textPosition, maxWidth, fontWidth, height) {\r\n                var d = null;\r\n                return null == textPosition || "Bottom_Center" == textPosition ? d = {\r\n                    x: this.x + this.width / 2 - maxWidth / 2,\r\n                    y: this.y + this.height + fontWidth\r\n                } : "Top_Center" == textPosition ? d = {\r\n                    x: this.x + this.width / 2 - maxWidth / 2,\r\n                    y: this.y - fontWidth / 2 - fontWidth * (height - 1)\r\n                } : "Top_Right" == textPosition ? d = {x: this.x + this.width - maxWidth, y: this.y - fontWidth / 2} : "Top_Left" == textPosition ? d = {\r\n                    x: this.x,\r\n                    y: this.y - fontWidth / 2\r\n                } : "Bottom_Right" == textPosition ? d = {\r\n                    x: this.x + this.width - maxWidth,\r\n                    y: this.y + this.height + fontWidth\r\n                } : "Bottom_Left" == textPosition ? d = {x: this.x, y: this.y + this.height + fontWidth} : "Middle_Center" == textPosition ? d = {\r\n                    x: this.x + this.width / 2 - maxWidth / 2,\r\n                    y: this.y + this.height / 2 + fontWidth / 2\r\n                } : "Middle_Right" == textPosition ? d = {x: this.x + this.width - maxWidth, y: this.y + this.height / 2 + fontWidth / 2} : "Middle_Left" == textPosition && (d = {\r\n                    x: this.x,\r\n                    y: this.y + this.height / 2 + fontWidth / 2\r\n                }), null != this.textOffsetX && (d.x += this.textOffsetX), null != this.textOffsetY && (d.y += this.textOffsetY), d\r\n            }, this.paintMouseover = function () {\r\n            }, this.paintSelected = function (a) {\r\n                a.shadowBlur = 10, a.shadowColor = "rgba(0,0,0,1)", a.shadowOffsetX = 0, a.shadowOffsetY = 0\r\n            }\r\n        }\r\n\r\n        container.prototype = new jtopo.InteractiveElement;\r\n        jtopo.Container = container;\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function getNodesCenter(a) {\r\n            var b = 0, c = 0;\r\n            a.forEach(function (a) {\r\n                b += a.cx, c += a.cy\r\n            });\r\n            var d = {x: b / a.length, y: c / a.length};\r\n            return d\r\n        }\r\n\r\n        function circleLayoutNodes(nodeArray, animateConfig) {\r\n            null == animateConfig && (animateConfig = {});\r\n            {\r\n                var e = animateConfig.cx,\r\n                    f = animateConfig.cy,\r\n                    g = animateConfig.minRadius,\r\n                    h = animateConfig.nodeDiameter,\r\n                    i = animateConfig.hScale || 1,\r\n                    j = animateConfig.vScale || 1;\r\n                animateConfig.beginAngle || 0, animateConfig.endAngle || 2 * Math.PI\r\n            }\r\n            if (null == e || null == f) {\r\n                var k = getNodesCenter(nodeArray);\r\n                e = k.x, f = k.y\r\n            }\r\n            var l = 0, m = [], n = [];\r\n            nodeArray.forEach(function (node) {\r\n                null == animateConfig.nodeDiameter ? (node.diameter && (h = node.diameter),\r\n                    h = node.radius ? 2 * node.radius : Math.sqrt(2 * node.width * node.height),\r\n                    n.push(h)) : n.push(h), l += h\r\n            }), nodeArray.forEach(function (a, b) {\r\n                var c = n[b] / l;\r\n                m.push(Math.PI * c)\r\n            });\r\n            var o = (nodeArray.length, m[0] + m[1]), p = n[0] / 2 + n[1] / 2, q = p / 2 / Math.sin(o / 2);\r\n            null != g && g > q && (q = g);\r\n            var r = q * i, s = q * j, t = animateConfig.animate;\r\n            if (t) {\r\n                var time = t.time || 1e3, v = 0;\r\n                nodeArray.forEach(function (node, c) {\r\n                    v += 0 == c ? m[c] : m[c - 1] + m[c];\r\n                    var d = e + Math.cos(v) * r, g = f + Math.sin(v) * s;\r\n                    jtopo.Animate.stepByStep(node, {x: d - node.width / 2, y: g - node.height / 2}, time).start()\r\n                })\r\n            } else {\r\n                var v = 0;\r\n                nodeArray.forEach(function (a, b) {\r\n                    v += 0 == b ? m[b] : m[b - 1] + m[b];\r\n                    var c = e + Math.cos(v) * r, d = f + Math.sin(v) * s;\r\n                    a.cx = c, a.cy = d\r\n                })\r\n            }\r\n            return {cx: e, cy: f, radius: r, radiusA: r, radiusB: s}\r\n        }\r\n\r\n        function GridLayout(row, column) {\r\n            return function (container) {\r\n                var childs = container.childs;\r\n                if (!(childs.length <= 0)) {\r\n                    var cBound = container.getBound();\r\n                    var childNode = childs[0];\r\n                    var columSpace = (cBound.width - childNode.width) / column;\r\n                    var rowSpace = (cBound.height - childNode.height) / row;\r\n                    for (var childIndex = 0, rowsIndex = 0; row > rowsIndex; rowsIndex++) {\r\n                        for (var columnIndex = 0; column > columnIndex; columnIndex++) {\r\n                            var node = childs[childIndex++];\r\n                            var x = cBound.left + columSpace / 2 + columnIndex * columSpace;\r\n                            var y = cBound.top + rowSpace / 2 + rowsIndex * rowSpace;\r\n                            node.setLocation(x, y);\r\n                            if (childIndex >= childs.length) {\r\n                                return\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n\r\n        function FlowLayout(row, column) {\r\n            if (null == column) {\r\n                column = 0;\r\n            }\r\n            if (null == row) {\r\n                row = 0;\r\n            }\r\n            return function (container) {\r\n                var childs = container.childs;\r\n                if (!(childs.length <= 0)) {\r\n                    var bound = container.getBound();\r\n                    var left = bound.left;\r\n                    var top = bound.top;\r\n                    for (var i = 0; i < childs.length; i++) {\r\n                        var child = childs[i];\r\n                        if (left + child.width >= bound.right) {\r\n                            left = bound.left;\r\n                            top += row + child.height;\r\n                        }\r\n                        child.setLocation(left, top);\r\n                        left += column + child.width;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function AutoBoundLayout() {\r\n            return function (container, children) {\r\n                if (children.length > 0) {\r\n                    var left = 1e7,\r\n                        right = -1e7,\r\n                        top = 1e7,\r\n                        bottom = -1e7,\r\n                        width = right - left,\r\n                        height = bottom - top;\r\n                    for (var i = 0; i < children.length; i++) {\r\n                        var child = children[i];\r\n                        child.x <= left && (left = child.x);\r\n                        (child.x + child.width) >= right && (right = child.x + child.width);\r\n                        child.y <= top && (top = child.y);\r\n                        (child.y + child.height) >= bottom && (bottom = child.y + child.height);\r\n                        width = right - left;\r\n                        height = bottom - top;\r\n                    }\r\n                    container.x = left;\r\n                    container.y = top;\r\n                    container.width = width;\r\n                    container.height = height;\r\n                } else {\r\n                    container.width = 100;\r\n                    container.height = 100;\r\n                }\r\n                if (container.qtopo) {\r\n                    container.qtopo.attr.size[0] = container.width;\r\n                    container.qtopo.attr.size[1] = container.height;\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * 找到可以作为根的节点\r\n         * */\r\n        function getRootNodes(elements) {\r\n            return elements.filter(function (element) {\r\n                return (element instanceof jtopo.Node) &&\r\n                    (!element.inLinks || element.inLinks.length == 0) &&\r\n                    (element.outLinks && element.outLinks.length > 0);\r\n            });\r\n        }\r\n\r\n        function getGap(arr) {\r\n            var totalWidth = 0, totalHeight = 0;\r\n            arr.forEach(function (a) {\r\n                totalWidth += a.width;\r\n                totalHeight += a.height;\r\n            });\r\n            return {\r\n                width: totalWidth / arr.length,\r\n                height: totalHeight / arr.length\r\n            }\r\n        }\r\n\r\n        function i(a, b, c, d) {\r\n            b.x += c, b.y += d;\r\n            for (var e = getRootChilds(a, b), f = 0; f < e.length; f++)i(a, e[f], c, d)\r\n        }\r\n\r\n        function j(a, b) {\r\n            function c(b, e) {\r\n                var f = getRootChilds(a, b);\r\n                null == d[e] && (d[e] = {}, d[e].nodes = [], d[e].childs = []), d[e].nodes.push(b), d[e].childs.push(f);\r\n                for (var g = 0; g < f.length; g++)c(f[g], e + 1), f[g].parent = b\r\n            }\r\n\r\n            var d = [];\r\n            return c(b, 0), d\r\n        }\r\n\r\n        function TreeLayout(direction, gap, top) {\r\n            return function (scene) {\r\n                function f(childs, root) {\r\n                    var h = jtopo.layout.getTreeDeep(childs, root);\r\n                    var k = j(childs, root);\r\n                    var l = k["" + h].nodes;\r\n                    for (var m = 0; m < l.length; m++) {\r\n                        var n = l[m], o = (m + 1) * (gap + 10), p = h * top;\r\n                        "down" == direction || ("up" == direction ? p = -p : "left" == direction ? (o = -h * top, p = (m + 1) * (gap + 10)) : "right" == direction && (o = h * top, p = (m + 1) * (gap + 10))), n.setLocation(o, p)\r\n                    }\r\n                    for (var q = h - 1; q >= 0; q--)for (var r = k["" + q].nodes, s = k["" + q].childs, m = 0; m < r.length; m++) {\r\n                        var t = r[m], u = s[m];\r\n                        if ("down" == direction ? t.y = q * top : "up" == direction ? t.y = -q * top : "left" == direction ? t.x = -q * top : "right" == direction && (t.x = q * top), u.length > 0 ? "down" == direction || "up" == direction ? t.x = (u[0].x + u[u.length - 1].x) / 2 : ("left" == direction || "right" == direction) && (t.y = (u[0].y + u[u.length - 1].y) / 2) : m > 0 && ("down" == direction || "up" == direction ? t.x = r[m - 1].x + r[m - 1].width + gap : ("left" == direction || "right" == direction) && (t.y = r[m - 1].y + r[m - 1].height + gap)), m > 0)if ("down" == direction || "up" == direction) {\r\n                            if (t.x < r[m - 1].x + r[m - 1].width)for (var v = r[m - 1].x + r[m - 1].width + gap, w = Math.abs(v - t.x), x = m; x < r.length; x++)i(scene.childs, r[x], w, 0)\r\n                        } else if (("left" == direction || "right" == direction) && t.y < r[m - 1].y + r[m - 1].height)for (var y = r[m - 1].y + r[m - 1].height + gap, z = Math.abs(y - t.y), x = m; x < r.length; x++)i(scene.childs, r[x], 0, z)\r\n                    }\r\n                }\r\n\r\n                var realGap = null;\r\n                if (null == gap) {\r\n                    realGap = getGap(scene.childs);\r\n                    gap = realGap.width;\r\n                    if ("left" == direction || "right" == direction) {\r\n                        gap = realGap.width + 10;\r\n                    }\r\n                }\r\n                if (null == top) {\r\n                    if (null == realGap) {\r\n                        realGap = getGap(scene.childs)\r\n                    }\r\n                    top = 2 * realGap.height;\r\n                }\r\n                direction = direction || "down";\r\n                var roots = jtopo.layout.getRootNodes(scene.childs);\r\n                if (roots.length > 0) {\r\n                    f(scene.childs, roots[0]);\r\n                    var bound = jtopo.util.getElementsBound(scene.childs);\r\n                    var center = scene.getCenterLocation();\r\n                    var startX = center.x - (bound.left + bound.right) / 2,\r\n                        startY = center.y - (bound.top + bound.bottom) / 2;\r\n                    scene.childs.forEach(function (element) {\r\n                        if (element instanceof jtopo.Node) {\r\n                            element.x += startX;\r\n                            element.y += startY;\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n\r\n        //必须得是有向无环图才可以布局\r\n        function CircleLayout(radius) {\r\n            return function (scene) {\r\n                function locationSet(allChilds, root, ra) {\r\n                    var rootsArr = getRootChilds(allChilds, root);\r\n                    if (0 != rootsArr.length) {\r\n                        if (null == ra) {\r\n                            ra = radius;\r\n                        }\r\n                        var step = 2 * Math.PI / rootsArr.length;\r\n                        rootsArr.forEach(function (child, i) {\r\n                            child.setLocation(\r\n                                root.x + ra * Math.cos(step * i),\r\n                                root.y + ra * Math.sin(step * i)\r\n                            );\r\n                            locationSet(allChilds, child, ra / 2);\r\n                        })\r\n                    }\r\n                }\r\n\r\n                var roots = jtopo.layout.getRootNodes(scene.childs);\r\n                if (roots.length > 0) {\r\n                    locationSet(scene.childs, roots[0]);\r\n                    var bound = jtopo.util.getElementsBound(scene.childs);\r\n                    var center = scene.getCenterLocation();\r\n                    var left = center.x - (bound.left + bound.right) / 2;\r\n                    var top = center.y - (bound.top + bound.bottom) / 2;\r\n                    scene.childs.forEach(function (b) {\r\n                        if (b instanceof jtopo.Node) {\r\n                            b.x += left;\r\n                            b.y += top;\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n\r\n        function m(a, b, c, d, e, f) {\r\n            for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n            return g\r\n        }\r\n\r\n        function circlePosition(centerX, centerY, total, raidus, beginAngle, endAngle) {\r\n            var begin = beginAngle ? beginAngle : 0;\r\n            var end = endAngle ? endAngle : 2 * Math.PI;\r\n            var totalAngle = end - begin;\r\n            var step = totalAngle / total;\r\n            var position = [];\r\n            begin += step / 2;\r\n            for (var i = begin; end >= i; i += step) {\r\n                position.push({\r\n                    x: centerX + Math.cos(i) * raidus,\r\n                    y: centerY + Math.sin(i) * raidus\r\n                });\r\n            }\r\n            return position\r\n        }\r\n\r\n        function treePostion(a, b, c, d, e, f) {\r\n            var g = f || "bottom", h = [];\r\n            if ("bottom" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n                x: i + j * d,\r\n                y: b + e\r\n            }); else if ("top" == g)for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n                x: i + j * d,\r\n                y: b - e\r\n            }); else if ("right" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({\r\n                x: a + e,\r\n                y: i + j * d\r\n            }); else if ("left" == g)for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)h.push({x: a - e, y: i + j * d});\r\n            return h\r\n        }\r\n\r\n        function gridPosition(a, b, c, d, e, f) {\r\n            for (var g = [], h = 0; c > h; h++)for (var i = 0; d > i; i++)g.push({x: a + i * e, y: b + h * f});\r\n            return g\r\n        }\r\n\r\n        function adjustPosition(root, rootChilds) {\r\n            if (root.layout) {\r\n                var layout = root.layout;\r\n                var locationArr = null;\r\n                switch (layout.type) {\r\n                    case \'circle\':\r\n                        var radius = layout.radius || Math.max(root.width, root.height);\r\n                        locationArr = circlePosition(\r\n                            root.cx,\r\n                            root.cy,\r\n                            rootChilds.length,\r\n                            radius,\r\n                            root.layout.beginAngle,\r\n                            root.layout.endAngle\r\n                        );\r\n                        break;\r\n                    case \'tree\':\r\n                        locationArr = treePostion(\r\n                            root.cx,\r\n                            root.cy,\r\n                            rootChilds.length,\r\n                            layout.width || 50,\r\n                            layout.height || 50,\r\n                            layout.direction\r\n                        );\r\n                        break;\r\n                    case \'grid\':\r\n                        locationArr = gridPosition(\r\n                            root.x,\r\n                            root.y,\r\n                            layout.rows,\r\n                            layout.cols,\r\n                            layout.horizontal || 0,\r\n                            layout.vertical || 0\r\n                        );\r\n                        break;\r\n                }\r\n                for (var i = 0; i < rootChilds.length; i++) {\r\n                    rootChilds[i].setCenterLocation(locationArr[i].x, locationArr[i].y);\r\n                }\r\n            }\r\n        }\r\n\r\n        function getRootChilds(allChilds, rootNode) {\r\n            var rootChilds;\r\n            if (rootNode.outLinks instanceof Array && rootNode.outLinks.length > 0) {\r\n                rootChilds = rootNode.outLinks.map(function (link) {\r\n                    return link.nodeZ;\r\n                });\r\n            }\r\n            return rootChilds || [];\r\n        }\r\n\r\n        function layoutNode(scene, root, recursion) {\r\n            var rootChilds = getRootChilds(scene.childs, root);\r\n            if (0 != rootChilds.length) {\r\n                adjustPosition(root, rootChilds);\r\n                if (1 == recursion) {\r\n                    for (var e = 0; e < rootChilds.length; e++) {\r\n                        layoutNode(scene, rootChilds[e], recursion);\r\n                    }\r\n                }\r\n            }\r\n            return null\r\n        }\r\n\r\n        function springLayout(b, c) {\r\n            function d(a, b) {\r\n                var c = a.x - b.x, d = a.y - b.y;\r\n                i += c * f, j += d * f, i *= g, j *= g, j += h, b.x += i, b.y += j\r\n            }\r\n\r\n            function e() {\r\n                if (!(++k > 150)) {\r\n                    for (var a = 0; a < l.length; a++)l[a] != b && d(b, l[a], l);\r\n                    setTimeout(e, 1e3 / 24)\r\n                }\r\n            }\r\n\r\n            var f = .01, g = .95, h = -5, i = 0, j = 0, k = 0, l = c.getElementsByClass(jtopo.Node);\r\n            e()\r\n        }\r\n\r\n        function getTreeDeep(childs, root) {\r\n            function reDeep(childs, root, deep) {\r\n                var rootChilds = getRootChilds(childs, root);\r\n                if (deep > d) {\r\n                    d = deep;\r\n                }\r\n                for (var g = 0; g < rootChilds.length; g++) {\r\n                    reDeep(childs, rootChilds[g], deep + 1);\r\n                }\r\n            }\r\n\r\n            var d = 0;\r\n            reDeep(childs, root, 0);\r\n            return d;\r\n        }\r\n\r\n        jtopo.layout = jtopo.Layout = {\r\n            layoutNode: layoutNode,\r\n            getNodeChilds: getRootChilds,\r\n            adjustPosition: adjustPosition,\r\n            springLayout: springLayout,\r\n            getTreeDeep: getTreeDeep,\r\n            getRootNodes: getRootNodes,\r\n            GridLayout: GridLayout,\r\n            FlowLayout: FlowLayout,\r\n            AutoBoundLayout: AutoBoundLayout,\r\n            CircleLayout: CircleLayout,\r\n            TreeLayout: TreeLayout,\r\n            getNodesCenter: getNodesCenter,\r\n            circleLayoutNodes: circleLayoutNodes\r\n        }\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function PieChartNode() {\r\n            var b = new jtopo.CircleNode;\r\n            return b.radius = 150, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n                var c = 2 * b.radius, d = 2 * b.radius;\r\n                b.width = c, b.height = d;\r\n                for (var e = 0, f = 0; f < this.datas.length; f++) {\r\n                    var g = this.datas[f] * Math.PI * 2;\r\n                    a.save(), a.beginPath(), a.fillStyle = b.colors[f], a.moveTo(0, 0), a.arc(0, 0, this.radius, e, e + g, !1), a.fill(), a.closePath(), a.restore(), a.beginPath(), a.font = this.font;\r\n                    var h = this.titles[f] + ": " + (100 * this.datas[f]).toFixed(2) + "%", i = a.measureText(h).width, j = (a.measureText("田").width, (e + e + g) / 2), k = this.radius * Math.cos(j), l = this.radius * Math.sin(j);\r\n                    j > Math.PI / 2 && j <= Math.PI ? k -= i : j > Math.PI && j < 2 * Math.PI * 3 / 4 ? k -= i : j > 2 * Math.PI * .75, a.fillStyle = "#FFFFFF", a.fillText(h, k, l), a.moveTo(this.radius * Math.cos(j), this.radius * Math.sin(j)), j > Math.PI / 2 && j < 2 * Math.PI * 3 / 4 && (k -= i), j > Math.PI, a.fill(), a.stroke(), a.closePath(), e += g\r\n                }\r\n            }, b\r\n        }\r\n\r\n        function BarChartNode() {\r\n            var b = new jtopo.Node;\r\n            return b.showSelected = !1, b.width = 250, b.height = 180, b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"], b.datas = [.3, .3, .4], b.titles = ["A", "B", "C"], b.paint = function (a) {\r\n                var c = 3, d = (this.width - c) / this.datas.length;\r\n                a.save(), a.beginPath(), a.fillStyle = "#FFFFFF", a.strokeStyle = "#FFFFFF", a.moveTo(-this.width / 2 - 1, -this.height / 2), a.lineTo(-this.width / 2 - 1, this.height / 2 + 3), a.lineTo(this.width / 2 + c + 1, this.height / 2 + 3), a.stroke(), a.closePath(), a.restore();\r\n                for (var e = 0; e < this.datas.length; e++) {\r\n                    a.save(), a.beginPath(), a.fillStyle = b.colors[e];\r\n                    var f = this.datas[e], g = e * (d + c) - this.width / 2, h = this.height - f - this.height / 2;\r\n                    a.fillRect(g, h, d, f);\r\n                    var i = "" + parseInt(this.datas[e]), j = a.measureText(i).width, k = a.measureText("田").width;\r\n                    a.fillStyle = "#FFFFFF", a.fillText(i, g + (d - j) / 2, h - k), a.fillText(this.titles[e], g + (d - j) / 2, this.height / 2 + k), a.fill(), a.closePath(), a.restore()\r\n                }\r\n            }, b\r\n        }\r\n\r\n        jtopo.BarChartNode = BarChartNode;\r\n        jtopo.PieChartNode = PieChartNode;\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function b(b, c) {\r\n            var d, e = null;\r\n            return {\r\n                stop: function () {\r\n                    return d ? (window.clearInterval(d), e && e.publish("stop"), this) : this\r\n                }, start: function () {\r\n                    var a = this;\r\n                    return d = setInterval(function () {\r\n                        b.call(a)\r\n                    }, c), this\r\n                }, onStop: function (b) {\r\n                    return null == e && (e = new jtopo.util.MessageBus), e.subscribe("stop", b), this\r\n                }\r\n            }\r\n        }\r\n\r\n        function ef_gravity(a, c) {\r\n            c = c || {};\r\n            var d = c.gravity || .1, e = c.dx || 0, f = c.dy || 5, g = c.stop, h = c.interval || 30, i = new b(function () {\r\n                g && g() ? (f = .5, this.stop()) : (f += d, a.setLocation(a.x + e, a.y + f))\r\n            }, h);\r\n            return i\r\n        }\r\n\r\n        function an_stepByStep(target, attr, time, e, f) {\r\n            var g = 1e3 / 24, h = {};\r\n            for (var i in attr) {\r\n                var j = attr[i], k = j - target[i];\r\n                h[i] = {\r\n                    oldValue: target[i], targetValue: j, step: k / time * g, isDone: function (b) {\r\n                        var c = this.step > 0 && target[b] >= this.targetValue || this.step < 0 && target[b] <= this.targetValue;\r\n                        return c\r\n                    }\r\n                }\r\n            }\r\n            var l = new b(function () {\r\n                var b = !0;\r\n                for (var d in attr)h[d].isDone(d) || (target[d] += h[d].step, b = !1);\r\n                if (b) {\r\n                    if (!e)return this.stop();\r\n                    for (var d in attr)if (f) {\r\n                        var g = h[d].targetValue;\r\n                        h[d].targetValue = h[d].oldValue, h[d].oldValue = g, h[d].step = -h[d].step\r\n                    } else target[d] = h[d].oldValue\r\n                }\r\n                return this\r\n            }, g);\r\n            return l\r\n        }\r\n\r\n        function ef_spring(a) {\r\n            null == a && (a = {});\r\n            var b = a.spring || .1, c = a.friction || .8, d = a.grivity || 0, e = (a.wind || 0, a.minLength || 0);\r\n            return {\r\n                items: [], timer: null, isPause: !1, addNode: function (a, b) {\r\n                    var c = {node: a, target: b, vx: 0, vy: 0};\r\n                    return this.items.push(c), this\r\n                }, play: function (a) {\r\n                    this.stop(), a = null == a ? 1e3 / 24 : a;\r\n                    var b = this;\r\n                    this.timer = setInterval(function () {\r\n                        b.nextFrame()\r\n                    }, a)\r\n                }, stop: function () {\r\n                    null != this.timer && window.clearInterval(this.timer)\r\n                }, nextFrame: function () {\r\n                    for (var a = 0; a < this.items.length; a++) {\r\n                        var f = this.items[a], g = f.node, h = f.target, i = f.vx, j = f.vy, k = h.x - g.x, l = h.y - g.y, m = Math.atan2(l, k);\r\n                        if (0 != e) {\r\n                            var n = h.x - Math.cos(m) * e, o = h.y - Math.sin(m) * e;\r\n                            i += (n - g.x) * b, j += (o - g.y) * b\r\n                        } else i += k * b, j += l * b;\r\n                        i *= c, j *= c, j += d, g.x += i, g.y += j, f.vx = i, f.vy = j\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function an_rotate(a, b) {\r\n            function c() {\r\n                return e = setInterval(function () {\r\n                    return o ? void f.stop() : (a.rotate += g || .2, void(a.rotate > 2 * Math.PI && (a.rotate = 0)))\r\n                }, 100), f\r\n            }\r\n\r\n            function d() {\r\n                return window.clearInterval(e), f.onStop && f.onStop(a), f\r\n            }\r\n\r\n            var e = (b.context, null), f = {}, g = b.v;\r\n            return f.run = c, f.stop = d, f.onStop = function (a) {\r\n                return f.onStop = a, f\r\n            }, f\r\n        }\r\n\r\n        function an_gravity(a, b) {\r\n            function c() {\r\n                return window.clearInterval(g), h.onStop && h.onStop(a), h\r\n            }\r\n\r\n            function d() {\r\n                var d = b.dx || 0, i = b.dy || 2;\r\n                return g = setInterval(function () {\r\n                    return o ? void h.stop() : (i += f, void(a.y + a.height < e.stage.canvas.height ? a.setLocation(a.x + d, a.y + i) : (i = 0, c())))\r\n                }, 20), h\r\n            }\r\n\r\n            var e = b.context, f = b.gravity || .1, g = null, h = {};\r\n            return h.run = d, h.stop = c, h.onStop = function (a) {\r\n                return h.onStop = a, h\r\n            }, h\r\n        }\r\n\r\n        function an_dividedTwoPiece(b, c) {\r\n            function d(c, d, e, f, g) {\r\n                var h = new jtopo.Node;\r\n                return h.setImage(b.image), h.setSize(b.width, b.height), h.setLocation(c, d), h.showSelected = !1, h.dragable = !1, h.paint = function (a) {\r\n                    a.save(), a.arc(0, 0, e, f, g), a.clip(), a.beginPath(), null != this.image ? a.drawImage(this.image, -this.width / 2, -this.height / 2) : (a.fillStyle = "rgba(" + this.style.fillStyle + "," + this.alpha + ")", a.rect(-this.width / 2, -this.height / 2, this.width / 2, this.height / 2), a.fill()), a.closePath(), a.restore()\r\n                }, h\r\n            }\r\n\r\n            function e(c, e) {\r\n                var f = c, g = c + Math.PI, h = d(b.x, b.y, b.width, f, g), j = d(b.x - 2 + 4 * Math.random(), b.y, b.width, f + Math.PI, f);\r\n                b.visible = !1, e.add(h), e.add(j), jtopo.Animate.gravity(h, {context: e, dx: .3}).run().onStop(function () {\r\n                    e.remove(h), e.remove(j), i.stop()\r\n                }), jtopo.Animate.gravity(j, {context: e, dx: -.2}).run()\r\n            }\r\n\r\n            function f() {\r\n                return e(c.angle, h), i\r\n            }\r\n\r\n            function g() {\r\n                return i.onStop && i.onStop(b), i\r\n            }\r\n\r\n            var h = c.context, i = (b.style, {});\r\n            return i.onStop = function (a) {\r\n                return i.onStop = a, i\r\n            }, i.run = f, i.stop = g, i\r\n        }\r\n\r\n        function an_repeatThrow(a, b) {\r\n            function c(a) {\r\n                a.visible = !0, a.rotate = Math.random();\r\n                var b = g.stage.canvas.width / 2;\r\n                a.x = b + Math.random() * (b - 100) - Math.random() * (b - 100), a.y = g.stage.canvas.height, a.vx = 5 * Math.random() - 5 * Math.random(), a.vy = -25\r\n            }\r\n\r\n            function d() {\r\n                return c(a), h = setInterval(function () {\r\n                    return o ? void i.stop() : (a.vy += f, a.x += a.vx, a.y += a.vy, void((a.x < 0 || a.x > g.stage.canvas.width || a.y > g.stage.canvas.height) && (i.onStop && i.onStop(a), c(a))))\r\n                }, 50), i\r\n            }\r\n\r\n            function e() {\r\n                window.clearInterval(h)\r\n            }\r\n\r\n            var f = .8, g = b.context, h = null, i = {};\r\n            return i.onStop = function (a) {\r\n                return i.onStop = a, i\r\n            }, i.run = d, i.stop = e, i\r\n        }\r\n\r\n        function an_stopAll() {\r\n            o = !0\r\n        }\r\n\r\n        function an_startAll() {\r\n            o = !1\r\n        }\r\n\r\n        function an_cycle(b, c) {\r\n            function d() {\r\n                return n = setInterval(function () {\r\n                    if (o)return void m.stop();\r\n                    var a = f.y + h + Math.sin(k) * j;\r\n                    b.setLocation(b.x, a), k += l\r\n                }, 100), m\r\n            }\r\n\r\n            function e() {\r\n                window.clearInterval(n)\r\n            }\r\n\r\n            var f = c.p1, g = c.p2, h = (c.context, f.x + (g.x - f.x) / 2), i = f.y + (g.y - f.y) / 2, j = jtopo.util.getDistance(f, g) / 2, k = Math.atan2(i, h), l = c.speed || .2, m = {}, n = null;\r\n            return m.run = d, m.stop = e, m\r\n        }\r\n\r\n        function an_move(a, b) {\r\n            function c() {\r\n                return h = setInterval(function () {\r\n                    if (o)return void g.stop();\r\n                    var b = e.x - a.x, c = e.y - a.y, h = b * f, i = c * f;\r\n                    a.x += h, a.y += i, .01 > h && .1 > i && d()\r\n                }, 100), g\r\n            }\r\n\r\n            function d() {\r\n                window.clearInterval(h)\r\n            }\r\n\r\n            var e = b.position, f = (b.context, b.easing || .2), g = {}, h = null;\r\n            return g.onStop = function (a) {\r\n                return g.onStop = a, g\r\n            }, g.run = c, g.stop = d, g\r\n        }\r\n\r\n        function an_scale(a, b) {\r\n            function c() {\r\n                return j = setInterval(function () {\r\n                    a.scaleX += f, a.scaleY += f, a.scaleX >= e && d()\r\n                }, 100), i\r\n            }\r\n\r\n            function d() {\r\n                i.onStop && i.onStop(a), a.scaleX = g, a.scaleY = h, window.clearInterval(j)\r\n            }\r\n\r\n            var e = (b.position, b.context, b.scale || 1), f = .06, g = a.scaleX, h = a.scaleY, i = {}, j = null;\r\n            return i.onStop = function (a) {\r\n                return i.onStop = a, i\r\n            }, i.run = c, i.stop = d, i\r\n        }\r\n\r\n        jtopo.Animate = {}, jtopo.Effect = {};\r\n        var o = !1;\r\n        jtopo.Effect.spring = ef_spring;\r\n        jtopo.Effect.gravity = ef_gravity;\r\n        jtopo.Animate.stepByStep = an_stepByStep;\r\n        jtopo.Animate.rotate = an_rotate;\r\n        jtopo.Animate.scale = an_scale;\r\n        jtopo.Animate.move = an_move;\r\n        jtopo.Animate.cycle = an_cycle;\r\n        jtopo.Animate.repeatThrow = an_repeatThrow;\r\n        jtopo.Animate.dividedTwoPiece = an_dividedTwoPiece;\r\n        jtopo.Animate.gravity = an_gravity;\r\n        jtopo.Animate.startAll = an_startAll;\r\n        jtopo.Animate.stopAll = an_stopAll;\r\n    }(JTopo),\r\n    function (jtopo) {\r\n        function b(a, b) {\r\n            var c = [];\r\n            if (0 == a.length)return c;\r\n            var d = b.match(/^\\s*(\\w+)\\s*$/);\r\n            if (null != d) {\r\n                var e = a.filter(function (a) {\r\n                    return a.elementType == d[1]\r\n                });\r\n                null != e && e.length > 0 && (c = c.concat(e))\r\n            } else {\r\n                var f = !1;\r\n                if (d = b.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*[\'"](\\S+)[\'"]\\s*\\]\\s*/), (null == d || d.length < 5) && (d = b.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*(\\d+(\\.\\d+)?)\\s*\\]\\s*/), f = !0), null != d && d.length >= 5) {\r\n                    var g = d[1], h = d[2], i = d[3], j = d[4];\r\n                    e = a.filter(function (a) {\r\n                        if (a.elementType != g)return !1;\r\n                        var b = a[h];\r\n                        return 1 == f && (b = parseInt(b)), "=" == i ? b == j : ">" == i ? b > j : "<" == i ? j > b : "<=" == i ? j >= b : ">=" == i ? b >= j : "!=" == i ? b != j : !1\r\n                    }), null != e && e.length > 0 && (c = c.concat(e))\r\n                }\r\n            }\r\n            return c\r\n        }\r\n\r\n        function c(a) {\r\n            if (a.find = function (a) {\r\n                    return find.call(this, a)\r\n                }, e.forEach(function (b) {\r\n                    a[b] = function (a) {\r\n                        for (var c = 0; c < this.length; c++)this[c][b](a);\r\n                        return this\r\n                    }\r\n                }), a.length > 0) {\r\n                var b = a[0];\r\n                for (var c in b) {\r\n                    var f = b[c];\r\n                    "function" == typeof f && !function (b) {\r\n                        a[c] = function () {\r\n                            for (var c = [], d = 0; d < a.length; d++)c.push(b.apply(a[d], arguments));\r\n                            return c\r\n                        }\r\n                    }(f)\r\n                }\r\n            }\r\n            return a.attr = function (a, b) {\r\n                if (null != a && null != b)for (var c = 0; c < this.length; c++)this[c][a] = b; else {\r\n                    if (null != a && "string" == typeof a) {\r\n                        for (var d = [], c = 0; c < this.length; c++)d.push(this[c][a]);\r\n                        return d\r\n                    }\r\n                    if (null != a)for (var c = 0; c < this.length; c++)for (var e in a)this[c][e] = a[e]\r\n                }\r\n                return this\r\n            }, a\r\n        }\r\n\r\n        function find(d) {\r\n            debugger;\r\n            var e = [];\r\n            var f = [];\r\n            if (this instanceof jtopo.Stage) {\r\n                e = this.childs;\r\n                f = f.concat(e);\r\n            } else if (this instanceof jtopo.Scene) {\r\n                e = [this];\r\n            } else {\r\n                f = this;\r\n                e.forEach(function (a) {\r\n                    f = f.concat(a.childs)\r\n                });\r\n            }\r\n            var g = null;\r\n            if ("function" == typeof d) {\r\n                f.filter(d)\r\n            } else {\r\n                b(f, d);\r\n            }\r\n            return c(g);\r\n        }\r\n\r\n        var e = "click,mousedown,mouseup,mouseover,mouseout,mousedrag,keydown,keyup".split(",");\r\n        jtopo.Stage.prototype.find = find;\r\n        jtopo.Scene.prototype.find = find;\r\n    }(JTopo),\r\n    function (win) {\r\n        function logObject(a, b) {\r\n            this.x = a;\r\n            this.y = b;\r\n        }\r\n\r\n        function Tortoise(a) {\r\n            this.p = new logObject(0, 0);\r\n            this.w = new logObject(1, 0);\r\n            this.paint = a;\r\n        }\r\n\r\n        function shift(a, b, c) {\r\n            return function (d) {\r\n                for (var e = 0; b > e; e++)a(), c && d.turn(c), d.move(3)\r\n            }\r\n        }\r\n\r\n        function spin(a, b) {\r\n            var c = 2 * Math.PI;\r\n            return function (d) {\r\n                for (var e = 0; b > e; e++)a(), d.turn(c / b)\r\n            }\r\n        }\r\n\r\n        function scale(a, b, c) {\r\n            return function (d) {\r\n                for (var e = 0; b > e; e++)a(), d.resize(c)\r\n            }\r\n        }\r\n\r\n        function polygon(a) {\r\n            var b = 2 * Math.PI;\r\n            return function (c) {\r\n                for (var d = 0; a > d; d++)c.forward(1), c.turn(b / a)\r\n            }\r\n        }\r\n\r\n        function star(a) {\r\n            var b = 4 * Math.PI;\r\n            return function (c) {\r\n                for (var d = 0; a > d; d++)c.forward(1), c.turn(b / a)\r\n            }\r\n        }\r\n\r\n        function spiral(a, b, c, d) {\r\n            return function (e) {\r\n                for (var f = 0; b > f; f++)a(), e.forward(1), e.turn(c), e.resize(d)\r\n            }\r\n        }\r\n\r\n        var Logo = {};\r\n        Tortoise.prototype.forward = function (a) {\r\n            var b = this.p, c = this.w;\r\n            return b.x = b.x + a * c.x, b.y = b.y + a * c.y, this.paint && this.paint(b.x, b.y), this\r\n        };\r\n        Tortoise.prototype.move = function (a) {\r\n            var b = this.p, c = this.w;\r\n            return b.x = b.x + a * c.x, b.y = b.y + a * c.y, this\r\n        };\r\n        Tortoise.prototype.moveTo = function (a, b) {\r\n            return this.p.x = a, this.p.y = b, this\r\n        };\r\n        Tortoise.prototype.turn = function (a) {\r\n            var b = (this.p, this.w);\r\n            var c = Math.cos(a) * b.x - Math.sin(a) * b.y;\r\n            var d = Math.sin(a) * b.x + Math.cos(a) * b.y;\r\n            b.x = c;\r\n            b.y = d;\r\n            return this;\r\n        };\r\n        Tortoise.prototype.resize = function (a) {\r\n            var b = this.w;\r\n            b.x = b.x * a;\r\n            b.y = b.y * a;\r\n            return this;\r\n        };\r\n        Tortoise.prototype.save = function () {\r\n            return null == this._stack && (this._stack = []), this._stack.push([this.p, this.w]), this\r\n        };\r\n        Tortoise.prototype.restore = function () {\r\n            if (null != this._stack && this._stack.length > 0) {\r\n                var a = this._stack.pop();\r\n                this.p = a[0], this.w = a[1]\r\n            }\r\n            return this\r\n        };\r\n        Logo.Tortoise = Tortoise;\r\n        Logo.shift = shift;\r\n        Logo.spin = spin;\r\n        Logo.polygon = polygon;\r\n        Logo.spiral = spiral;\r\n        Logo.star = star;\r\n        Logo.scale = scale;\r\n        win.Logo = Logo;\r\n    }(window);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvanRvcG8vanRvcG8tbWluLmpzPzM0OWEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsU0FBUztBQUNULFNBQVM7QUFDVCxtREFBbUQ7QUFDbkQ7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVCxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsYUFBYSxVQUFVO0FBQ3ZCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsV0FBVztBQUNsQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLCtEQUErRDtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQixtQkFBbUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVCQUF1QixnQkFBZ0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQSxtRUFBbUUsMENBQTBDLG1CQUFtQjtBQUNoSTtBQUNBLDhFQUE4RSwyQkFBMkIsc0NBQXNDLHFCQUFxQjtBQUNwSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZ0JBQWdCO0FBQ3ZDLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxnQkFBZ0I7QUFDaEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsaUJBQWlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxTQUFTO0FBQ1QsU0FBUztBQUNULFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsK0JBQStCLHdCQUF3QjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix3QkFBd0I7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUIsb0JBQW9CO0FBQ3JDLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDZCQUE2QixvRUFBb0UsY0FBYztBQUN0SjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsd0JBQXdCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2QkFBNkI7QUFDNUQ7QUFDQTtBQUNBLG1DQUFtQywyQkFBMkI7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0EsdUNBQXVDLHdCQUF3QjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtRUFBbUUsUUFBUSwrRUFBK0UsUUFBUTtBQUNsSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixrQ0FBa0M7QUFDakU7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGtDQUFrQztBQUNqRTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isa0NBQWtDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzTUFBc007QUFDdE07QUFDQSxtQ0FBbUMsa0NBQWtDO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtWQUErVjtBQUMvVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0dBQW9HLGtDQUFrQztBQUN0STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELDhCQUE4QjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2Isd0JBQXdCO0FBQ3hCLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYix3QkFBd0I7QUFDeEIsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLG9CQUFvQjtBQUNyQyxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGNBQWM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRkFBaUYsY0FBYztBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EscURBQXFELGNBQWM7QUFDbkUsYUFBYTtBQUNiO0FBQ0EscURBQXFELGNBQWM7QUFDbkUsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw4QkFBOEI7QUFDN0Q7QUFDQSxtQ0FBbUMsNkJBQTZCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IseUJBQXlCO0FBQ3pCO0FBQ0EsYUFBYTtBQUNiO0FBQ0Esd0dBQXdHLG1DQUFtQztBQUMzSSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsbUZBQW1GO0FBQ2xKO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCLDRCQUE0Qix1RUFBdUUsT0FBTyx1RUFBdUU7QUFDakw7QUFDQTtBQUNBLGlCQUFpQixXQUFXLGVBQWUsV0FBVyxlQUFlLFdBQVcsZUFBZTtBQUMvRixhQUFhO0FBQ2I7QUFDQTtBQUNBLCtCQUErQixjQUFjO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EseUJBQXlCLCtDQUErQyxPQUFPO0FBQy9FO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsK0dBQStHLFdBQVc7QUFDMUg7QUFDQTtBQUNBLHVDQUF1QyxzQkFBc0I7QUFDN0Q7QUFDQSx1REFBdUQsV0FBVztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IseUJBQXlCO0FBQ3pCO0FBQ0EsYUFBYTtBQUNiLHlCQUF5QjtBQUN6QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSwyRkFBMkYsYUFBYSxXQUFXLFdBQVcsV0FBVyxhQUFhO0FBQ3RKO0FBQ0E7QUFDQSxpQkFBaUIsV0FBVyxXQUFXLFdBQVcsYUFBYTtBQUMvRCxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IseUJBQXlCO0FBQ3pCO0FBQ0EsYUFBYTtBQUNiLHlCQUF5QjtBQUN6QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSw0R0FBNEcsbUJBQW1CLFdBQVcsdUJBQXVCO0FBQ2pLO0FBQ0E7QUFDQSxpQkFBaUIsV0FBVyxtQkFBbUIseURBQXlELG1CQUFtQixXQUFXLHVCQUF1QjtBQUM3SjtBQUNBO0FBQ0EsaUJBQWlCLFdBQVcsbUJBQW1CO0FBQy9DO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2IsK0JBQStCLHdCQUF3QjtBQUN2RDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHdCQUF3QjtBQUN2RDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQixzQ0FBc0MsNkRBQTZEO0FBQ3BIO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQix3Q0FBd0MsK0NBQStDO0FBQ3hHO0FBQ0E7QUFDQSxpQkFBaUIseUNBQXlDLCtFQUErRTtBQUN6STtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYixhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixxQkFBcUI7QUFDckI7QUFDQTs7QUFFQTtBQUNBLHdEQUF3RDtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELDhDQUE4QztBQUNsRyxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxvQkFBb0I7QUFDcEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxpQkFBaUI7QUFDNUUsaURBQWlELHNCQUFzQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLG1CQUFtQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxxQkFBcUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0RBQW9ELGNBQWM7QUFDbEU7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDLCtCQUErQixjQUFjO0FBQzdDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsY0FBYztBQUNqRDtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsUUFBUSwrREFBK0QsY0FBYztBQUM1SDtBQUNBO0FBQ0EsK0lBQStJLGNBQWM7QUFDN0oseUJBQXlCLDRLQUE0SyxjQUFjO0FBQ25OO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxtQ0FBbUMsT0FBTyxvQkFBb0IsT0FBTyxhQUFhLDJCQUEyQjtBQUM3RztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLFVBQVU7QUFDekM7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esd0VBQXdFLFFBQVE7QUFDaEY7QUFDQTtBQUNBLGFBQWEsRUFBRSwrREFBK0QsUUFBUTtBQUN0RjtBQUNBO0FBQ0EsYUFBYSxFQUFFLGlFQUFpRSxRQUFRO0FBQ3hGO0FBQ0E7QUFDQSxhQUFhLEVBQUUsZ0VBQWdFLFFBQVEsYUFBYSx1QkFBdUI7QUFDM0g7QUFDQTs7QUFFQTtBQUNBLG1DQUFtQyxPQUFPLG9CQUFvQixPQUFPLGFBQWEsMkJBQTJCO0FBQzdHO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsdUJBQXVCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsdUJBQXVCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtQ0FBbUMsY0FBYztBQUNqRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix1QkFBdUI7QUFDdEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsdUJBQXVCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix1QkFBdUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQixtQ0FBbUMsdUJBQXVCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDZDQUE2QztBQUM3QztBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQSw4RUFBOEUsbUJBQW1CO0FBQ2pHO0FBQ0EsaUJBQWlCLDZCQUE2QixvQkFBb0I7QUFDbEU7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSwrQ0FBK0M7QUFDL0M7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDRMQUE0TDtBQUM1TDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsdUVBQXVFO0FBQ3ZFO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBOztBQUVBLHNHQUFzRztBQUN0RztBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLHVDQUF1QyxpQkFBaUI7QUFDeEQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGNBQWM7QUFDakU7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsaUJBQWlCLG9CQUFvQjtBQUMvRjtBQUNBLCtDQUErQyxpQkFBaUI7QUFDaEU7QUFDQTtBQUNBLGlEQUFpRCxpQkFBaUI7QUFDbEU7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0JBQStCLE9BQU87QUFDdEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsT0FBTztBQUN0QztBQUNBOztBQUVBO0FBQ0E7QUFDQSwrQkFBK0IsT0FBTztBQUN0QztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixPQUFPO0FBQ3RDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLE9BQU87QUFDdEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0JBQStCLE9BQU87QUFDdEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyIsImZpbGUiOiIxMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiFmdW5jdGlvbiAod2luZG93KSB7XHJcbiAgICBmdW5jdGlvbiBFbGVtZW50KCkge1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50VHlwZSA9IFwiZWxlbWVudFwiLCB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzID0gW1wiZWxlbWVudFR5cGVcIl0sIHRoaXMucHJvcGVydGllc1N0YWNrID0gW10sIHRoaXMuX2lkID0gXCJcIiArIChuZXcgRGF0ZSkuZ2V0VGltZSgpXHJcbiAgICAgICAgfSwgdGhpcy5kaXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIH0sIHRoaXMucmVtb3ZlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCB0aGlzLmF0dHIgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICBpZiAobnVsbCAhPSBhICYmIG51bGwgIT0gYil0aGlzW2FdID0gYjsgZWxzZSBpZiAobnVsbCAhPSBhKXJldHVybiB0aGlzW2FdO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH0sIHRoaXMuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSB0aGlzLCBiID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgYltjXSA9IGFbY11cclxuICAgICAgICAgICAgfSksIHRoaXMucHJvcGVydGllc1N0YWNrLnB1c2goYilcclxuICAgICAgICB9LCB0aGlzLnJlc3RvcmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMucHJvcGVydGllc1N0YWNrICYmIDAgIT0gdGhpcy5wcm9wZXJ0aWVzU3RhY2subGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHRoaXMsIGIgPSB0aGlzLnByb3BlcnRpZXNTdGFjay5wb3AoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGFbY10gPSBiW2NdXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcy50b0pzb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gdGhpcywgYiA9IFwie1wiLCBjID0gdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gYVtkXTtcclxuICAgICAgICAgICAgICAgIFwic3RyaW5nXCIgPT0gdHlwZW9mIGYgJiYgKGYgPSAnXCInICsgZiArICdcIicpLCBiICs9ICdcIicgKyBkICsgJ1wiOicgKyBmLCBjID4gZSArIDEgJiYgKGIgKz0gXCIsXCIpXHJcbiAgICAgICAgICAgIH0pLCBiICs9IFwifVwiXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qYT10aGlzLnggLSB0aGlzLmJvcmRlcldpZHRoIC8gMiBiPXRoaXMueSAtIHRoaXMuYm9yZGVyV2lkdGggLyAyLCovXHJcbiAgICBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLkpUb3BvUm91bmRSZWN0ID0gZnVuY3Rpb24gKGEsIGIsIHdfYm9yZGVyV2lkdGgsIGhfYm9yZGVyV2lkdGgsIGJvcmRlclJhZGl1cykge1xyXG4gICAgICAgIC8v55S75YWD57Sg5ZyG6KeS6L655qGGXHJcbiAgICAgICAgXCJ1bmRlZmluZWRcIiA9PSB0eXBlb2YgYm9yZGVyUmFkaXVzICYmIChib3JkZXJSYWRpdXMgPSA1KSxcclxuICAgICAgICAgICAgdGhpcy5iZWdpblBhdGgoKSxcclxuICAgICAgICAgICAgdGhpcy5tb3ZlVG8oYSArIGJvcmRlclJhZGl1cywgYiksXHJcbiAgICAgICAgICAgIHRoaXMubGluZVRvKGEgKyB3X2JvcmRlcldpZHRoIC0gYm9yZGVyUmFkaXVzLCBiKSxcclxuICAgICAgICAgICAgdGhpcy5xdWFkcmF0aWNDdXJ2ZVRvKGEgKyB3X2JvcmRlcldpZHRoLCBiLCBhICsgd19ib3JkZXJXaWR0aCwgYiArIGJvcmRlclJhZGl1cyksXHJcbiAgICAgICAgICAgIHRoaXMubGluZVRvKGEgKyB3X2JvcmRlcldpZHRoLCBiICsgaF9ib3JkZXJXaWR0aCAtIGJvcmRlclJhZGl1cyksXHJcbiAgICAgICAgICAgIHRoaXMucXVhZHJhdGljQ3VydmVUbyhhICsgd19ib3JkZXJXaWR0aCwgYiArIGhfYm9yZGVyV2lkdGgsIGEgKyB3X2JvcmRlcldpZHRoIC0gYm9yZGVyUmFkaXVzLCBiICsgaF9ib3JkZXJXaWR0aCksXHJcbiAgICAgICAgICAgIHRoaXMubGluZVRvKGEgKyBib3JkZXJSYWRpdXMsIGIgKyBoX2JvcmRlcldpZHRoKSxcclxuICAgICAgICAgICAgdGhpcy5xdWFkcmF0aWNDdXJ2ZVRvKGEsIGIgKyBoX2JvcmRlcldpZHRoLCBhLCBiICsgaF9ib3JkZXJXaWR0aCAtIGJvcmRlclJhZGl1cyksXHJcbiAgICAgICAgICAgIHRoaXMubGluZVRvKGEsIGIgKyBib3JkZXJSYWRpdXMpLFxyXG4gICAgICAgICAgICB0aGlzLnF1YWRyYXRpY0N1cnZlVG8oYSwgYiwgYSArIGJvcmRlclJhZGl1cywgYiksXHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VQYXRoKClcclxuICAgIH07XHJcbiAgICBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLkpUb3BvRGFzaGVkTGluZVRvID0gZnVuY3Rpb24gKHNYLCBzWSwgZVgsIGVZLCBkYXNoZWRQYXR0ZXJuKSB7XHJcbiAgICAgICAgLy/nlLvomZrnur9cclxuICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiA9PSB0eXBlb2YgZGFzaGVkUGF0dGVybikge1xyXG4gICAgICAgICAgICBkYXNoZWRQYXR0ZXJuID0gNTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRYID0gZVggLSBzWDtcclxuICAgICAgICB2YXIgZFkgPSBlWSAtIHNZO1xyXG4gICAgICAgIHZhciBsZW5ndGggPSBNYXRoLmZsb29yKE1hdGguc3FydChkWCAqIGRYICsgZFkgKiBkWSkpO1xyXG4gICAgICAgIHZhciBkYXNoTCA9IDAgPj0gZGFzaGVkUGF0dGVybiA/IGxlbmd0aCA6IGxlbmd0aCAvIGRhc2hlZFBhdHRlcm47XHJcbiAgICAgICAgdmFyIHRZID0gZFkgLyBsZW5ndGggKiBkYXNoZWRQYXR0ZXJuO1xyXG4gICAgICAgIHZhciB0WCA9IGRYIC8gbGVuZ3RoICogZGFzaGVkUGF0dGVybjtcclxuICAgICAgICB0aGlzLmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGZvciAodmFyIG0gPSAwOyBkYXNoTCA+IG07IG0rKykge1xyXG4gICAgICAgICAgICBpZiAobSAlIDIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGluZVRvKHNYICsgbSAqIHRYLCBzWSArIG0gKiB0WSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVUbyhzWCArIG0gKiB0WCwgc1kgKyBtICogdFkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc3Ryb2tlKCk7XHJcbiAgICB9O1xyXG4gICAgdmFyIEpUb3BvID0ge1xyXG4gICAgICAgIHZlcnNpb246IFwiMC40LjhfMDFcIixcclxuICAgICAgICB6SW5kZXhfQ29udGFpbmVyOiAxLFxyXG4gICAgICAgIHpJbmRleF9MaW5rOiAyLFxyXG4gICAgICAgIHpJbmRleF9Ob2RlOiAzLFxyXG4gICAgICAgIFNjZW5lTW9kZToge25vcm1hbDogXCJub3JtYWxcIiwgZHJhZzogXCJkcmFnXCIsIGVkaXQ6IFwiZWRpdFwiLCBzZWxlY3Q6IFwic2VsZWN0XCJ9LFxyXG4gICAgICAgIE1vdXNlQ3Vyc29yOiB7XHJcbiAgICAgICAgICAgIG5vcm1hbDogXCJkZWZhdWx0XCIsXHJcbiAgICAgICAgICAgIHBvaW50ZXI6IFwicG9pbnRlclwiLFxyXG4gICAgICAgICAgICB0b3BfbGVmdDogXCJudy1yZXNpemVcIixcclxuICAgICAgICAgICAgdG9wX2NlbnRlcjogXCJuLXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICB0b3BfcmlnaHQ6IFwibmUtcmVzaXplXCIsXHJcbiAgICAgICAgICAgIG1pZGRsZV9sZWZ0OiBcImUtcmVzaXplXCIsXHJcbiAgICAgICAgICAgIG1pZGRsZV9yaWdodDogXCJlLXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICBib3R0b21fbGVmdDogXCJuZS1yZXNpemVcIixcclxuICAgICAgICAgICAgYm90dG9tX2NlbnRlcjogXCJuLXJlc2l6ZVwiLFxyXG4gICAgICAgICAgICBib3R0b21fcmlnaHQ6IFwibnctcmVzaXplXCIsXHJcbiAgICAgICAgICAgIG1vdmU6IFwibW92ZVwiLFxyXG4gICAgICAgICAgICBvcGVuX2hhbmQ6IFwiZGVmYXVsdFwiLFxyXG4gICAgICAgICAgICBjbG9zZWRfaGFuZDogXCJkZWZhdWx0XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNyZWF0ZVN0YWdlRnJvbUpzb246IGZ1bmN0aW9uIChqc29uU3RyLCBjYW52YXMpIHtcclxuICAgICAgICAgICAgZXZhbChcInZhciBqc29uT2JqID0gXCIgKyBqc29uU3RyKTtcclxuICAgICAgICAgICAgdmFyIHN0YWdlID0gbmV3IEpUb3BvLlN0YWdlKGNhbnZhcyk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4ganNvbk9iailcImNoaWxkc1wiICE9IGsgJiYgKHN0YWdlW2tdID0ganNvbk9ialtrXSk7XHJcbiAgICAgICAgICAgIHZhciBzY2VuZXMgPSBqc29uT2JqLmNoaWxkcztcclxuICAgICAgICAgICAgcmV0dXJuIHNjZW5lcy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IG5ldyBKVG9wby5TY2VuZShzdGFnZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjIGluIGEpXCJjaGlsZHNcIiAhPSBjICYmIChiW2NdID0gYVtjXSksIFwiYmFja2dyb3VuZFwiID09IGMgJiYgKGIuYmFja2dyb3VuZCA9IGFbY10pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBhLmNoaWxkcztcclxuICAgICAgICAgICAgICAgIGQuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gbnVsbCwgZCA9IGEuZWxlbWVudFR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJub2RlXCIgPT0gZCA/IGMgPSBuZXcgSlRvcG8uTm9kZSA6IFwiQ2lyY2xlTm9kZVwiID09IGQgJiYgKGMgPSBuZXcgSlRvcG8uQ2lyY2xlTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSBpbiBhKWNbZV0gPSBhW2VdO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuYWRkKGMpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KSwgc3RhZ2VcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSlRvcG8uRWxlbWVudCA9IEVsZW1lbnQ7XHJcbiAgICB3aW5kb3cuSlRvcG8gPSBKVG9wbztcclxufSh3aW5kb3cpLCBmdW5jdGlvbiAoSlRvcG8pIHtcclxuICAgIGZ1bmN0aW9uIE1lc3NhZ2VCdXMoYSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IGE7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTWFwID0ge307XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQ291bnQgPSAwO1xyXG4gICAgfVxyXG5cclxuICAgIE1lc3NhZ2VCdXMucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChldmVuTmFtZSwgZm4pIHtcclxuICAgICAgICB2YXIgZCA9IHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV07XHJcbiAgICAgICAgaWYgKG51bGwgPT0gZCkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VNYXBbZXZlbk5hbWVdID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWVzc2FnZU1hcFtldmVuTmFtZV0ucHVzaChmbik7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQ291bnQrKztcclxuICAgIH07XHJcbiAgICBNZXNzYWdlQnVzLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChldmVuTmFtZSwgZm4pIHtcclxuICAgICAgICB2YXIgZXZlbnQgPSB0aGlzLm1lc3NhZ2VNYXBbZXZlbk5hbWVdO1xyXG4gICAgICAgIGlmIChudWxsICE9IGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChmbiAmJiAnZnVuY3Rpb24nID09IHR5cGVvZiBmbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gZXZlbnQuaW5kZXhPZihmbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VNYXBbZXZlbk5hbWVdID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLm1lc3NhZ2VNYXBbZXZlbk5hbWVdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQ291bnQtLTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBNZXNzYWdlQnVzLnByb3RvdHlwZS5wdWJsaXNoID0gZnVuY3Rpb24gKGV2ZW5OYW1lLCBlLCBib29sZWFuKSB7XHJcbiAgICAgICAgdmFyIGV2ZW50TWFwID0gdGhpcy5tZXNzYWdlTWFwW2V2ZW5OYW1lXTtcclxuICAgICAgICBpZiAobnVsbCAhPSBldmVudE1hcCkge1xyXG4gICAgICAgICAgICBldmVudE1hcC5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGJvb2xlYW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm4oZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5xdG9wbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbihlLCBlLnRhcmdldC5xdG9wbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm4oZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZnVuY3Rpb24gZ2V0RGlzdGFuY2UocG9pbnRBLCBwb2ludEIsIGMsIGQpIHtcclxuICAgICAgICB2YXIgd2lkdGgsIGhlaWdodDtcclxuICAgICAgICBpZiAobnVsbCA9PSBjICYmIG51bGwgPT0gZCkge1xyXG4gICAgICAgICAgICBpZiAocG9pbnRBICYmIHBvaW50Qikge1xyXG4gICAgICAgICAgICAgICAgd2lkdGggPSBwb2ludEIueCAtIHBvaW50QS54O1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gcG9pbnRCLnkgLSBwb2ludEEueTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdpZHRoID0gYyAtIHBvaW50QTtcclxuICAgICAgICAgICAgaGVpZ2h0ID0gZCAtIHBvaW50QjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCh3aWR0aCAqIHdpZHRoICsgaGVpZ2h0ICogaGVpZ2h0KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRFbGVtZW50c0JvdW5kKGVsZW1lbnRzKSB7XHJcbiAgICAgICAgdmFyIGIgPSB7XHJcbiAgICAgICAgICAgIGxlZnQ6IE51bWJlci5NQVhfVkFMVUUsXHJcbiAgICAgICAgICAgIHJpZ2h0OiBOdW1iZXIuTUlOX1ZBTFVFLFxyXG4gICAgICAgICAgICB0b3A6IE51bWJlci5NQVhfVkFMVUUsXHJcbiAgICAgICAgICAgIGJvdHRvbTogTnVtYmVyLk1JTl9WQUxVRVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoIShlbGVtZW50IGluc3RhbmNlb2YgSlRvcG8uTGluaykpIHtcclxuICAgICAgICAgICAgICAgIGlmIChiLmxlZnQgPiBlbGVtZW50LngpIHtcclxuICAgICAgICAgICAgICAgICAgICBiLmxlZnQgPSBlbGVtZW50Lng7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5sZWZ0Tm9kZSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYi5yaWdodCA8IGVsZW1lbnQueCArIGVsZW1lbnQud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBiLnJpZ2h0ID0gZWxlbWVudC54ICsgZWxlbWVudC53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBiLnJpZ2h0Tm9kZSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYi50b3AgPiBlbGVtZW50LnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBiLnRvcCA9IGVsZW1lbnQueTtcclxuICAgICAgICAgICAgICAgICAgICBiLnRvcE5vZGUgPSBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGIuYm90dG9tIDwgZWxlbWVudC55ICsgZWxlbWVudC5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBiLmJvdHRvbSA9IGVsZW1lbnQueSArIGVsZW1lbnQuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGIuYm90dG9tTm9kZSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBiLndpZHRoID0gYi5yaWdodCAtIGIubGVmdDtcclxuICAgICAgICBiLmhlaWdodCA9IGIuYm90dG9tIC0gYi50b3A7XHJcbiAgICAgICAgcmV0dXJuIGI7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0RXZlbnRQb3NpdGlvbihldmVudCkge1xyXG4gICAgICAgIGV2ZW50ID0gY2xvbmVFdmVudChldmVudCk7XHJcbiAgICAgICAgaWYgKCFldmVudC5wYWdlWCkge1xyXG4gICAgICAgICAgICBldmVudC5wYWdlWCA9IGV2ZW50LmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgLSBkb2N1bWVudC5ib2R5LmNsaWVudExlZnQ7XHJcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VZID0gZXZlbnQuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIC0gZG9jdW1lbnQuYm9keS5jbGllbnRUb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBldmVudDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByb3RhdGVQb2ludChhWCwgYVksIGJYLCBiWSwgYykge1xyXG4gICAgICAgIHZhciB3aWR0aCA9IGJYIC0gYVg7XHJcbiAgICAgICAgdmFyIGhlaWdodCA9IGJZIC0gYVk7XHJcbiAgICAgICAgdmFyIGRpdGFuY2UgPSBNYXRoLnNxcnQod2lkdGggKiB3aWR0aCArIGhlaWdodCAqIGhlaWdodCk7XHJcbiAgICAgICAgdmFyIGkgPSBNYXRoLmF0YW4yKGhlaWdodCwgd2lkdGgpICsgYztcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB4OiBhWCArIE1hdGguY29zKGkpICogZGl0YW5jZSxcclxuICAgICAgICAgICAgeTogYVkgKyBNYXRoLnNpbihpKSAqIGRpdGFuY2VcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcm90YXRlUG9pbnRzKHJvb3QsIGNoaWxkcywgYmVnaW5BbmdsZSkge1xyXG4gICAgICAgIGZvciAodmFyIGQgPSBbXSwgZSA9IDA7IGUgPCBjaGlsZHMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgZC5wdXNoKHJvdGF0ZVBvaW50KHJvb3QueCwgcm9vdC55LCBjaGlsZHNbZV0ueCwgY2hpbGRzW2VdLnksIGJlZ2luQW5nbGUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjbG9uZUV2ZW50KGEpIHtcclxuICAgICAgICB2YXIgYiA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGMgaW4gYSkge1xyXG4gICAgICAgICAgICBpZiAoXCJyZXR1cm5WYWx1ZVwiICE9IGMgJiYgXCJrZXlMb2NhdGlvblwiICE9IGMpIHtcclxuICAgICAgICAgICAgICAgIGJbY10gPSBhW2NdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xvbmUob2JqZWN0KSB7XHJcbiAgICAgICAgdmFyIGIgPSB7fTtcclxuICAgICAgICBmb3IgKHZhciBjIGluIG9iamVjdCkge1xyXG4gICAgICAgICAgICBiW2NdID0gb2JqZWN0W2NdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzUG9pbnRJblJlY3QocmVjdCwgcG9pbnRzKSB7XHJcbiAgICAgICAgdmFyIFggPSBwb2ludHMueDtcclxuICAgICAgICB2YXIgWSA9IHBvaW50cy55O1xyXG4gICAgICAgIHZhciBXID0gcG9pbnRzLndpZHRoO1xyXG4gICAgICAgIHZhciBIID0gcG9pbnRzLmhlaWdodDtcclxuICAgICAgICByZXR1cm4gcmVjdC54ID4gWCAmJiByZWN0LnggPCBYICsgVyAmJiByZWN0LnkgPiBZICYmIHJlY3QueSA8IFkgKyBIO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzUG9pbnRJbkxpbmUocG9pbnRzLCBzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgdmFyIGxpbmUgPSBKVG9wby51dGlsLmdldERpc3RhbmNlKHN0YXJ0LCBlbmQpO1xyXG4gICAgICAgIHZhciB0b1N0YXJ0ID0gSlRvcG8udXRpbC5nZXREaXN0YW5jZShzdGFydCwgcG9pbnRzKTtcclxuICAgICAgICB2YXIgdG9FbmQgPSBKVG9wby51dGlsLmdldERpc3RhbmNlKGVuZCwgcG9pbnRzKTtcclxuICAgICAgICByZXR1cm4gTWF0aC5hYnModG9TdGFydCArIHRvRW5kIC0gbGluZSkgPD0gMC41O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlbW92ZUZyb21BcnJheShhcnIsIGl0ZW0pIHtcclxuICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGFyci5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGFycltjXTtcclxuICAgICAgICAgICAgaWYgKGQgPT09IGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGFyciA9IGFyci5kZWwoYyk7XHJcbiAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhcnJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByYW5kb21Db2xvcigpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKSArIFwiLFwiICsgTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKSArIFwiLFwiICsgTWF0aC5mbG9vcigyNTUgKiBNYXRoLnJhbmRvbSgpKVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBsb2FkU3RhZ2VGcm9tSnNvbihqc29uLCBjYW52YXMpIHtcclxuICAgICAgICB2YXIgb2JqID0gZXZhbChqc29uKSwgc3RhZ2UgPSBuZXcgSlRvcG8uU3RhZ2UoY2FudmFzKTtcclxuICAgICAgICBmb3IgKHZhciBrIGluIHN0YWdlT2JqKWlmIChcInNjZW5lc1wiICE9IGspc3RhZ2Vba10gPSBvYmpba107IGVsc2UgZm9yICh2YXIgc2NlbmVzID0gb2JqLnNjZW5lcywgaSA9IDA7IGkgPCBzY2VuZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHNjZW5lT2JqID0gc2NlbmVzW2ldLCBzY2VuZSA9IG5ldyBKVG9wby5TY2VuZShzdGFnZSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gc2NlbmVPYmopaWYgKFwiZWxlbWVudHNcIiAhPSBwKXNjZW5lW3BdID0gc2NlbmVPYmpbcF07IGVsc2UgZm9yICh2YXIgbm9kZU1hcCA9IHt9LCBlbGVtZW50cyA9IHNjZW5lT2JqLmVsZW1lbnRzLCBtID0gMDsgbSA8IGVsZW1lbnRzLmxlbmd0aDsgbSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudE9iaiA9IGVsZW1lbnRzW21dLCB0eXBlID0gZWxlbWVudE9iai5lbGVtZW50VHlwZSwgZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIFwiTm9kZVwiID09IHR5cGUgJiYgKGVsZW1lbnQgPSBuZXcgSlRvcG8uTm9kZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBtayBpbiBlbGVtZW50T2JqKWVsZW1lbnRbbWtdID0gZWxlbWVudE9ialtta107XHJcbiAgICAgICAgICAgICAgICBub2RlTWFwW2VsZW1lbnQudGV4dF0gPSBlbGVtZW50LCBzY2VuZS5hZGQoZWxlbWVudClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29uc29sZS5sb2coc3RhZ2UpLCBzdGFnZVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNoYW5nZUNvbG9yKGN0eCwgaW1hZ2UsIGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIGNvbG9yQXJyID0gY29sb3Iuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgIHZhciBSID0gcGFyc2VJbnQoY29sb3JBcnJbMF0pO1xyXG4gICAgICAgIHZhciBHID0gcGFyc2VJbnQoY29sb3JBcnJbMV0pO1xyXG4gICAgICAgIHZhciBCID0gcGFyc2VJbnQoY29sb3JBcnJbMl0pO1xyXG4gICAgICAgIHZhciBpbWFnZVdpZHRoID0gY2FudmFzLndpZHRoID0gaW1hZ2Uud2lkdGg7XHJcbiAgICAgICAgdmFyIGltYWdlSGVpZ2h0ID0gY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDtcclxuICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7XHJcbiAgICAgICAgdmFyIEltYWdlRGF0YSA9IGN0eC5nZXRJbWFnZURhdGEoMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBJbWFnZURhdGEuZGF0YTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaW1hZ2VXaWR0aCA+IGk7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaW1hZ2VIZWlnaHQgPiBqOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gNCAqIChpICsgaiAqIGltYWdlV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gZGF0YVtuICsgM10pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbiArIDBdICs9IFI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IEcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtuICsgMV0gKz0gRztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gQikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW24gKyAyXSArPSBCO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjdHgucHV0SW1hZ2VEYXRhKEltYWdlRGF0YSwgMCwgMCwgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7XHJcbiAgICAgICAgcmV0dXJuIGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZW5JbWFnZUFsYXJtKGltYWdlLCBjb2xvcikge1xyXG4gICAgICAgIHZhciBzcmMgPSBpbWFnZS5zcmMgKyBjb2xvcjtcclxuICAgICAgICBpZiAoYWxhcm1JbWFnZUNhY2hlW3NyY10pcmV0dXJuIGFsYXJtSW1hZ2VDYWNoZVtzcmNdO1xyXG4gICAgICAgIHZhciBuZXdJbWFnZSA9IG5ldyBJbWFnZTtcclxuICAgICAgICBuZXdJbWFnZS5zcmMgPSBjaGFuZ2VDb2xvcihncmFwaGljcywgaW1hZ2UsIGNvbG9yKTtcclxuICAgICAgICBhbGFybUltYWdlQ2FjaGVbc3JjXSA9IG5ld0ltYWdlO1xyXG4gICAgICAgIHJldHVybiBuZXdJbWFnZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRPZmZzZXRQb3NpdGlvbihjYW52YXMpIHtcclxuICAgICAgICBpZiAoIWNhbnZhcykge1xyXG4gICAgICAgICAgICByZXR1cm4ge2xlZnQ6IDAsIHRvcDogMH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBiID0gMCwgYyA9IDA7XHJcbiAgICAgICAgaWYgKFwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0XCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICB2YXIgZSA9IGNhbnZhcy5vd25lckRvY3VtZW50O1xyXG4gICAgICAgICAgICB2YXIgZiA9IGUuYm9keTtcclxuICAgICAgICAgICAgdmFyIGcgPSBlLmRvY3VtZW50RWxlbWVudDtcclxuICAgICAgICAgICAgdmFyIGggPSBnLmNsaWVudFRvcCB8fCBmLmNsaWVudFRvcCB8fCAwO1xyXG4gICAgICAgICAgICB2YXIgaSA9IGcuY2xpZW50TGVmdCB8fCBmLmNsaWVudExlZnQgfHwgMDtcclxuICAgICAgICAgICAgYiA9IGQudG9wICsgKHNlbGYucGFnZVlPZmZzZXQgfHwgZyAmJiBnLnNjcm9sbFRvcCB8fCBmLnNjcm9sbFRvcCkgLSBoO1xyXG4gICAgICAgICAgICBjID0gZC5sZWZ0ICsgKHNlbGYucGFnZVhPZmZzZXQgfHwgZyAmJiBnLnNjcm9sbExlZnQgfHwgZi5zY3JvbGxMZWZ0KSAtIGk7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgIGIgKz0gY2FudmFzLm9mZnNldFRvcCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgYyArPSBjYW52YXMub2Zmc2V0TGVmdCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzID0gY2FudmFzLm9mZnNldFBhcmVudDtcclxuICAgICAgICAgICAgfSB3aGlsZSAoY2FudmFzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtsZWZ0OiBjLCB0b3A6IGJ9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbGluZUYoeDEsIHkxLCB4MiwgeTIpIHtcclxuICAgICAgICBmdW5jdGlvbiBlKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEgKiBmICsgZ1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGYgPSAoeTIgLSB5MSkgLyAoeDIgLSB4MSksIGcgPSB5MSAtIHgxICogZjtcclxuICAgICAgICByZXR1cm4gZS5rID0gZiwgZS5iID0gZywgZS54MSA9IHgxLCBlLngyID0geDIsIGUueTEgPSB5MSwgZS55MiA9IHkyLCBlXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW5SYW5nZShhLCBiLCBjKSB7XHJcbiAgICAgICAgdmFyIGQgPSBNYXRoLmFicyhiIC0gYyksIGUgPSBNYXRoLmFicyhiIC0gYSksIGYgPSBNYXRoLmFicyhjIC0gYSksIGcgPSBNYXRoLmFicyhkIC0gKGUgKyBmKSk7XHJcbiAgICAgICAgcmV0dXJuIDFlLTYgPiBnID8gITAgOiAhMVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzUG9pbnRJbkxpbmVTZWcoYSwgYiwgYykge1xyXG4gICAgICAgIHJldHVybiBpblJhbmdlKGEsIGMueDEsIGMueDIpICYmIGluUmFuZ2UoYiwgYy55MSwgYy55MilcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oYSwgYikge1xyXG4gICAgICAgIHZhciBjLCBkO1xyXG4gICAgICAgIHJldHVybiBhLmsgPT0gYi5rID8gbnVsbCA6ICgxIC8gMCA9PSBhLmsgfHwgYS5rID09IC0xIC8gMCA/IChjID0gYS54MSwgZCA9IGIoYS54MSkpIDogMSAvIDAgPT0gYi5rIHx8IGIuayA9PSAtMSAvIDAgPyAoYyA9IGIueDEsIGQgPSBhKGIueDEpKSA6IChjID0gKGIuYiAtIGEuYikgLyAoYS5rIC0gYi5rKSwgZCA9IGEoYykpLCAwID09IGlzUG9pbnRJbkxpbmVTZWcoYywgZCwgYSkgPyBudWxsIDogMCA9PSBpc1BvaW50SW5MaW5lU2VnKGMsIGQsIGIpID8gbnVsbCA6IHtcclxuICAgICAgICAgICAgeDogYyxcclxuICAgICAgICAgICAgeTogZFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW50ZXJzZWN0aW9uTGluZUJvdW5kKGxpbmssIGJvdW5kKSB7XHJcbiAgICAgICAgdmFyIGMgPSBKVG9wby51dGlsLmxpbmVGKGJvdW5kLmxlZnQsIGJvdW5kLnRvcCwgYm91bmQubGVmdCwgYm91bmQuYm90dG9tKTtcclxuICAgICAgICB2YXIgZCA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uKGxpbmssIGMpO1xyXG4gICAgICAgIGlmIChudWxsID09IGQpIHtcclxuICAgICAgICAgICAgYyA9IEpUb3BvLnV0aWwubGluZUYoYm91bmQubGVmdCwgYm91bmQudG9wLCBib3VuZC5yaWdodCwgYm91bmQudG9wKTtcclxuICAgICAgICAgICAgZCA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uKGxpbmssIGMpO1xyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSBkKSB7XHJcbiAgICAgICAgICAgICAgICBjID0gSlRvcG8udXRpbC5saW5lRihib3VuZC5yaWdodCwgYm91bmQudG9wLCBib3VuZC5yaWdodCwgYm91bmQuYm90dG9tKTtcclxuICAgICAgICAgICAgICAgIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihsaW5rLCBjKTtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsID09IGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjID0gSlRvcG8udXRpbC5saW5lRihib3VuZC5sZWZ0LCBib3VuZC5ib3R0b20sIGJvdW5kLnJpZ2h0LCBib3VuZC5ib3R0b20pO1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSBKVG9wby51dGlsLmludGVyc2VjdGlvbihsaW5rLCBjKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICB9XHJcblxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGEsIDFlMyAvIDI0KVxyXG4gICAgICAgIH07XHJcbiAgICBBcnJheS5wcm90b3R5cGUuZGVsID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICBpZiAoXCJudW1iZXJcIiAhPSB0eXBlb2YgaXRlbSkge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmluZGV4T2YoaXRlbSk7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoaXRlbSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwbGljZShpdGVtLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgaWYgKCFbXS5pbmRleE9mKSB7XHJcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzW2ldID09PSBhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHdpbmRvdy5jb25zb2xlIHx8ICh3aW5kb3cuY29uc29sZSA9IHtcclxuICAgICAgICBsb2c6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCBpbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfSwgZGVidWc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9LCB3YXJuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfSwgZXJyb3I6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLCBncmFwaGljcyA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksIGFsYXJtSW1hZ2VDYWNoZSA9IHt9O1xyXG4gICAgSlRvcG8udXRpbCA9IHtcclxuICAgICAgICByb3RhdGVQb2ludDogcm90YXRlUG9pbnQsXHJcbiAgICAgICAgcm90YXRlUG9pbnRzOiByb3RhdGVQb2ludHMsXHJcbiAgICAgICAgZ2V0RGlzdGFuY2U6IGdldERpc3RhbmNlLFxyXG4gICAgICAgIGdldEV2ZW50UG9zaXRpb246IGdldEV2ZW50UG9zaXRpb24sXHJcbiAgICAgICAgTWVzc2FnZUJ1czogTWVzc2FnZUJ1cyxcclxuICAgICAgICBpc0ZpcmVmb3g6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIkZpcmVmb3hcIikgPiAwLFxyXG4gICAgICAgIGlzSUU6ICEoIXdpbmRvdy5hdHRhY2hFdmVudCB8fCAtMSAhPT0gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiT3BlcmFcIikpLFxyXG4gICAgICAgIGlzQ2hyb21lOiBudWxsICE9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvY2hyb21lLyksXHJcbiAgICAgICAgY2xvbmU6IGNsb25lLFxyXG4gICAgICAgIGlzUG9pbnRJblJlY3Q6IGlzUG9pbnRJblJlY3QsXHJcbiAgICAgICAgaXNQb2ludEluTGluZTogaXNQb2ludEluTGluZSxcclxuICAgICAgICByZW1vdmVGcm9tQXJyYXk6IHJlbW92ZUZyb21BcnJheSxcclxuICAgICAgICBjbG9uZUV2ZW50OiBjbG9uZUV2ZW50LFxyXG4gICAgICAgIHJhbmRvbUNvbG9yOiByYW5kb21Db2xvcixcclxuICAgICAgICBsb2FkU3RhZ2VGcm9tSnNvbjogbG9hZFN0YWdlRnJvbUpzb24sXHJcbiAgICAgICAgZ2V0RWxlbWVudHNCb3VuZDogZ2V0RWxlbWVudHNCb3VuZCxcclxuICAgICAgICBnZW5JbWFnZUFsYXJtOiBnZW5JbWFnZUFsYXJtLFxyXG4gICAgICAgIGdldE9mZnNldFBvc2l0aW9uOiBnZXRPZmZzZXRQb3NpdGlvbixcclxuICAgICAgICBsaW5lRjogbGluZUYsXHJcbiAgICAgICAgaW50ZXJzZWN0aW9uOiBpbnRlcnNlY3Rpb24sXHJcbiAgICAgICAgaW50ZXJzZWN0aW9uTGluZUJvdW5kOiBpbnRlcnNlY3Rpb25MaW5lQm91bmRcclxuICAgIH1cclxufShKVG9wbyksXHJcbiAgICBmdW5jdGlvbiAoanRvcG8pIHtcclxuICAgICAgICBmdW5jdGlvbiBpbml0RWFnbGVFeWUoc3RhZ2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGhnYXA6IDE2LFxyXG4gICAgICAgICAgICAgICAgdmlzaWJsZTogITEsXHJcbiAgICAgICAgICAgICAgICBleHBvcnRDYW52YXM6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksXHJcbiAgICAgICAgICAgICAgICBnZXRJbWFnZTogZnVuY3Rpb24gKGIsIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHN0YWdlLmdldEJvdW5kKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gMTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydENhbnZhcy53aWR0aCA9IHN0YWdlLmNhbnZhcy53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydENhbnZhcy5oZWlnaHQgPSBzdGFnZS5jYW52YXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGIgJiYgbnVsbCAhPSBjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0Q2FudmFzLndpZHRoID0gYjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0ID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGIgLyBkLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gYyAvIGQuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLndpZHRoID4gc3RhZ2UuY2FudmFzLndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydENhbnZhcy53aWR0aCA9IGQud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuaGVpZ2h0ID4gc3RhZ2UuY2FudmFzLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0ID0gZC5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSB0aGlzLmV4cG9ydENhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YWdlLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGcuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnLmNsZWFyUmVjdCgwLCAwLCB0aGlzLmV4cG9ydENhbnZhcy53aWR0aCwgdGhpcy5leHBvcnRDYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhZ2UuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgxID09IGEudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEudHJhbnNsYXRlWCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS50cmFuc2xhdGVZID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNjYWxlWCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zY2FsZVkgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuc2NhbGUoZSwgZik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQubGVmdCA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS50cmFuc2xhdGVYID0gTWF0aC5hYnMoZC5sZWZ0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC50b3AgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEudHJhbnNsYXRlWSA9IE1hdGguYWJzKGQudG9wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnBhaW50QWxsID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5yZXBhaW50KGcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucGFpbnRBbGwgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGcucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5leHBvcnRDYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGNhbnZhczogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWFnbGVJbWFnZURhdGFzID0gdGhpcy5nZXREYXRhKHN0YWdlKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzZXRTaXplOiBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLmNhbnZhcy53aWR0aCA9IGE7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQgPSBiO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gYS5zdGFnZS5jYW52YXMud2lkdGgsIGMgPSBhLnN0YWdlLmNhbnZhcy5oZWlnaHQsIGQgPSBiIC8gYS5zY2FsZVggLyAyLCBlID0gYyAvIGEuc2NhbGVZIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt0cmFuc2xhdGVYOiBhLnRyYW5zbGF0ZVggKyBkIC0gZCAqIGEuc2NhbGVYLCB0cmFuc2xhdGVZOiBhLnRyYW5zbGF0ZVkgKyBlIC0gZSAqIGEuc2NhbGVZfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBqICYmIG51bGwgIT0gayA/IHRoaXMuc2V0U2l6ZShiLCBjKSA6IHRoaXMuc2V0U2l6ZSgyMDAsIDE2MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YWdlLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc2F2ZSgpLCBlLmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KSwgc3RhZ2UuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgPT0gYS52aXNpYmxlICYmIChhLnNhdmUoKSwgYS5jZW50ZXJBbmRab29tKG51bGwsIG51bGwsIGUpLCBhLnJlcGFpbnQoZSksIGEucmVzdG9yZSgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBkKHN0YWdlLmNoaWxkc1swXSksIGcgPSBmLnRyYW5zbGF0ZVggKiAodGhpcy5jYW52YXMud2lkdGggLyBzdGFnZS5jYW52YXMud2lkdGgpICogc3RhZ2UuY2hpbGRzWzBdLnNjYWxlWCwgaCA9IGYudHJhbnNsYXRlWSAqICh0aGlzLmNhbnZhcy5oZWlnaHQgLyBzdGFnZS5jYW52YXMuaGVpZ2h0KSAqIHN0YWdlLmNoaWxkc1swXS5zY2FsZVksIGkgPSBzdGFnZS5nZXRCb3VuZCgpLCBqID0gc3RhZ2UuY2FudmFzLndpZHRoIC8gc3RhZ2UuY2hpbGRzWzBdLnNjYWxlWCAvIGkud2lkdGgsIGsgPSBzdGFnZS5jYW52YXMuaGVpZ2h0IC8gc3RhZ2UuY2hpbGRzWzBdLnNjYWxlWSAvIGkuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqID4gMSAmJiAoaiA9IDEpLCBrID4gMSAmJiAoaiA9IDEpLCBnICo9IGosIGggKj0gaywgaS5sZWZ0IDwgMCAmJiAoZyAtPSBNYXRoLmFicyhpLmxlZnQpICogKHRoaXMud2lkdGggLyBpLndpZHRoKSksIGkudG9wIDwgMCAmJiAoaCAtPSBNYXRoLmFicyhpLnRvcCkgKiAodGhpcy5oZWlnaHQgLyBpLmhlaWdodCkpLCBlLnNhdmUoKSwgZS5saW5lV2lkdGggPSAxLCBlLnN0cm9rZVN0eWxlID0gXCJyZ2JhKDI1NSwwLDAsMSlcIiwgZS5zdHJva2VSZWN0KC1nLCAtaCwgZS5jYW52YXMud2lkdGggKiBqLCBlLmNhbnZhcy5oZWlnaHQgKiBrKSwgZS5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBlLmdldEltYWdlRGF0YSgwLCAwLCBlLmNhbnZhcy53aWR0aCwgZS5jYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBwYWludDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuZWFnbGVJbWFnZURhdGFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gc3RhZ2UuZ3JhcGhpY3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLmZpbGxTdHlsZSA9IFwicmdiYSgyMTEsMjExLDIxMSwwLjMpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIuZmlsbFJlY3Qoc3RhZ2UuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggLSAyICogdGhpcy5oZ2FwLCBzdGFnZS5jYW52YXMuaGVpZ2h0IC0gdGhpcy5jYW52YXMuaGVpZ2h0IC0gMSwgc3RhZ2UuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLmZpbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIubGluZVdpZHRoID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMCwxKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnJlY3Qoc3RhZ2UuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggLSAyICogdGhpcy5oZ2FwLCBzdGFnZS5jYW52YXMuaGVpZ2h0IC0gdGhpcy5jYW52YXMuaGVpZ2h0IC0gMSwgc3RhZ2UuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5wdXRJbWFnZURhdGEodGhpcy5lYWdsZUltYWdlRGF0YXMsIHN0YWdlLmNhbnZhcy53aWR0aCAtIHRoaXMuY2FudmFzLndpZHRoIC0gdGhpcy5oZ2FwLCBzdGFnZS5jYW52YXMuaGVpZ2h0IC0gdGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5yZXN0b3JlKClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVhZ2xlSW1hZ2VEYXRhcyA9IHRoaXMuZ2V0RGF0YShzdGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGV2ZW50SGFuZGxlcjogZnVuY3Rpb24gKGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGIueCwgZSA9IGIueTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZCA+IGMuY2FudmFzLndpZHRoIC0gdGhpcy5jYW52YXMud2lkdGggJiYgZSA+IGMuY2FudmFzLmhlaWdodCAtIHRoaXMuY2FudmFzLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZCA9IGIueCAtIHRoaXMuY2FudmFzLndpZHRoLCBlID0gYi55IC0gdGhpcy5jYW52YXMuaGVpZ2h0LCBcIm1vdXNlZG93blwiID09IGEgJiYgKHRoaXMubGFzdFRyYW5zbGF0ZVggPSBjLmNoaWxkc1swXS50cmFuc2xhdGVYLCB0aGlzLmxhc3RUcmFuc2xhdGVZID0gYy5jaGlsZHNbMF0udHJhbnNsYXRlWSksIFwibW91c2VkcmFnXCIgPT0gYSAmJiBjLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGIuZHgsIGcgPSBiLmR5LCBoID0gYy5nZXRCb3VuZCgpLCBpID0gdGhpcy5jYW52YXMud2lkdGggLyBjLmNoaWxkc1swXS5zY2FsZVggLyBoLndpZHRoLCBqID0gdGhpcy5jYW52YXMuaGVpZ2h0IC8gYy5jaGlsZHNbMF0uc2NhbGVZIC8gaC5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmNoaWxkc1swXS50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCAtIGYgLyBpLCBjLmNoaWxkc1swXS50cmFuc2xhdGVZID0gdGhpcy5sYXN0VHJhbnNsYXRlWSAtIGcgLyBqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHN0YWdlKGNhbnZhcykge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRFdmVudE9iamVjdChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50UG9zaXRpb24gPSBqdG9wby51dGlsLmdldEV2ZW50UG9zaXRpb24oZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldFBvc2l0aW9uID0ganRvcG8udXRpbC5nZXRPZmZzZXRQb3NpdGlvbih0aGVTdGFnZS5jYW52YXMpO1xyXG4gICAgICAgICAgICAgICAgZXZlbnRQb3NpdGlvbi5vZmZzZXRMZWZ0ID0gZXZlbnRQb3NpdGlvbi5wYWdlWCAtIG9mZnNldFBvc2l0aW9uLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICBldmVudFBvc2l0aW9uLm9mZnNldFRvcCA9IGV2ZW50UG9zaXRpb24ucGFnZVkgLSBvZmZzZXRQb3NpdGlvbi50b3A7XHJcbiAgICAgICAgICAgICAgICBldmVudFBvc2l0aW9uLnggPSBldmVudFBvc2l0aW9uLm9mZnNldExlZnQ7XHJcbiAgICAgICAgICAgICAgICBldmVudFBvc2l0aW9uLnkgPSBldmVudFBvc2l0aW9uLm9mZnNldFRvcDtcclxuICAgICAgICAgICAgICAgIGV2ZW50UG9zaXRpb24udGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBldmVudFBvc2l0aW9uO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBtb3VzZU92ZXIoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50Lm9uc2VsZWN0c3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExXHJcbiAgICAgICAgICAgICAgICB9LCB0aGlzLm1vdXNlT3ZlciA9ICEwO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBnZXRFdmVudE9iamVjdChldmVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZW92ZXJcIiwgYiksIHRoZVN0YWdlLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW92ZXJcIiwgYilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gbW91c2VPdXQoYSkge1xyXG4gICAgICAgICAgICAgICAgcCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSAhMFxyXG4gICAgICAgICAgICAgICAgfSwgNTAwKSwgZG9jdW1lbnQub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gITBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGEpO1xyXG4gICAgICAgICAgICAgICAgdGhlU3RhZ2UuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwibW91c2VvdXRcIiwgYiksIHRoZVN0YWdlLmRpc3BhdGNoRXZlbnQoXCJtb3VzZW91dFwiLCBiKSwgdGhlU3RhZ2UubmVlZFJlcGFpbnQgPSAwID09IHRoZVN0YWdlLmFuaW1hdGUgPyAhMSA6ICEwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIG1vdXNlRG93bihhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGEpO1xyXG4gICAgICAgICAgICAgICAgdGhlU3RhZ2UubW91c2VEb3duID0gITAsIHRoZVN0YWdlLm1vdXNlRG93blggPSBiLngsIHRoZVN0YWdlLm1vdXNlRG93blkgPSBiLnksIHRoZVN0YWdlLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlZG93blwiLCBiKSwgdGhlU3RhZ2UuZGlzcGF0Y2hFdmVudChcIm1vdXNlZG93blwiLCBiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBtb3VzZVVwKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gZ2V0RXZlbnRPYmplY3QoYSk7XHJcbiAgICAgICAgICAgICAgICB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZXVwXCIsIGIpLCB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50KFwibW91c2V1cFwiLCBiKSwgdGhlU3RhZ2UubW91c2VEb3duID0gITEsIHRoZVN0YWdlLm5lZWRSZXBhaW50ID0gMCA9PSB0aGVTdGFnZS5hbmltYXRlID8gITEgOiAhMFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBtb3VzZU1vdmUoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChwKTtcclxuICAgICAgICAgICAgICAgICAgICBwID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG8gPSAhMTtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gZ2V0RXZlbnRPYmplY3QoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoZVN0YWdlLm1vdXNlRG93bikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgwID09IGV2ZW50LmJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLmR4ID0gYi54IC0gdGhlU3RhZ2UubW91c2VEb3duWDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5keSA9IGIueSAtIHRoZVN0YWdlLm1vdXNlRG93blk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoZVN0YWdlLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlZHJhZ1wiLCBiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhlU3RhZ2UuZGlzcGF0Y2hFdmVudChcIm1vdXNlZHJhZ1wiLCBiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0gdGhlU3RhZ2UuZWFnbGVFeWUudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlU3RhZ2UuZWFnbGVFeWUudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoZVN0YWdlLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyhcIm1vdXNlbW92ZVwiLCBiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjbGljayhhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGdldEV2ZW50T2JqZWN0KGEpO1xyXG4gICAgICAgICAgICAgICAgdGhlU3RhZ2UuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwiY2xpY2tcIiwgYiksIHRoZVN0YWdlLmRpc3BhdGNoRXZlbnQoXCJjbGlja1wiLCBiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBkYmNsaWNrKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gZ2V0RXZlbnRPYmplY3QoYSk7XHJcbiAgICAgICAgICAgICAgICB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJkYmNsaWNrXCIsIGIpLCB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50KFwiZGJjbGlja1wiLCBiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBtb3VzZVdoZWVsKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gZ2V0RXZlbnRPYmplY3QoYSk7XHJcbiAgICAgICAgICAgICAgICB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJtb3VzZXdoZWVsXCIsIGIpLCB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50KFwibW91c2V3aGVlbFwiLCBiKSwgbnVsbCAhPSB0aGVTdGFnZS53aGVlbFpvb20gJiYgKGEucHJldmVudERlZmF1bHQgPyBhLnByZXZlbnREZWZhdWx0KCkgOiAoYSA9IGEgfHwgd2luZG93LmV2ZW50LCBhLnJldHVyblZhbHVlID0gITEpLCAxID09IHRoZVN0YWdlLmVhZ2xlRXllLnZpc2libGUgJiYgdGhlU3RhZ2UuZWFnbGVFeWUudXBkYXRlKCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGFkZEV2ZW50SW5DYW52YXMoY2FudmFzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanRvcG8udXRpbC5pc0lFIHx8ICF3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNlb3V0ID0gbW91c2VPdXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9ubW91c2VvdmVyID0gbW91c2VPdmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5vbm1vdXNlZG93biA9IG1vdXNlRG93bjtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMub25tb3VzZXVwID0gbW91c2VVcDtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMub25tb3VzZW1vdmUgPSBtb3VzZU1vdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9uY2xpY2sgPSBjbGljaztcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMub25kYmxjbGljayA9IGRiY2xpY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9ubW91c2V3aGVlbCA9IG1vdXNlV2hlZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnRvdWNoc3RhcnQgPSBtb3VzZURvd247XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnRvdWNobW92ZSA9IG1vdXNlTW92ZTtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMudG91Y2hlbmQgPSBtb3VzZVVwO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsIG1vdXNlT3V0KTtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBtb3VzZU92ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vdXNlRG93bik7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG1vdXNlVXApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIG1vdXNlTW92ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbGljayk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJkYmxjbGlja1wiLCBkYmNsaWNrKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoanRvcG8udXRpbC5pc0ZpcmVmb3gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Nb3VzZVNjcm9sbFwiLCBtb3VzZVdoZWVsKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNld2hlZWxcIiwgbW91c2VXaGVlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGVTdGFnZS5kaXNwYXRjaEV2ZW50VG9TY2VuZXMoXCJrZXlkb3duXCIsIGp0b3BvLnV0aWwuY2xvbmVFdmVudChldmVudCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgzNyA9PSBrZXlDb2RlIHx8IDM4ID09IGtleUNvZGUgfHwgMzkgPT0ga2V5Q29kZSB8fCA0MCA9PSBrZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQucHJldmVudERlZmF1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQgfHwgd2luZG93LmV2ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnJldHVyblZhbHVlID0gITE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCAhMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhlU3RhZ2UuZGlzcGF0Y2hFdmVudFRvU2NlbmVzKFwia2V5dXBcIiwganRvcG8udXRpbC5jbG9uZUV2ZW50KGV2ZW50KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDM3ID09IGtleUNvZGUgfHwgMzggPT0ga2V5Q29kZSB8fCAzOSA9PSBrZXlDb2RlIHx8IDQwID09IGtleUNvZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5wcmV2ZW50RGVmYXVsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucmV0dXJuVmFsdWUgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sICEwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAganRvcG8uc3RhZ2UgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgdGhlU3RhZ2UgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjYW52YXMpIHtcclxuICAgICAgICAgICAgICAgIGFkZEV2ZW50SW5DYW52YXMoY2FudmFzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaGljcyA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mcmFtZXMgPSAyNDtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyA9IG5ldyBqdG9wby51dGlsLk1lc3NhZ2VCdXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVhZ2xlRXllID0gaW5pdEVhZ2xlRXllKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aGVlbFpvb20gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZURvd25YID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2VEb3duWSA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlRG93biA9ICExO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZU92ZXIgPSAhMTtcclxuICAgICAgICAgICAgICAgIHRoaXMubmVlZFJlcGFpbnQgPSAhMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSBbXCJmcmFtZXNcIiwgXCJ3aGVlbFpvb21cIl07XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IGNhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKGNhbnZhcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG8gPSAhMCwgcCA9IG51bGw7XHJcbiAgICAgICAgICAgIGRvY3VtZW50Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnRUb1NjZW5lcyA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoMCAhPSB0aGlzLmZyYW1lcyAmJiAodGhpcy5uZWVkUmVwYWludCA9ICEwKSwgMSA9PSB0aGlzLmVhZ2xlRXllLnZpc2libGUgJiYgLTEgIT0gYS5pbmRleE9mKFwibW91c2VcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGIueCwgZCA9IGIueTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYyA+IHRoaXMud2lkdGggLSB0aGlzLmVhZ2xlRXllLndpZHRoICYmIGQgPiB0aGlzLmhlaWdodCAtIHRoaXMuZWFnbGVFeWUuaGVpZ2h0KXJldHVybiB2b2lkIHRoaXMuZWFnbGVFeWUuZXZlbnRIYW5kbGVyKGEsIGIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0gYy52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gY1thICsgXCJIYW5kbGVyXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBkKXRocm93IG5ldyBFcnJvcihcIkZ1bmN0aW9uIG5vdCBmb3VuZDpcIiArIGEgKyBcIkhhbmRsZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuY2FsbChjLCBiKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuYWRkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBiKyspaWYgKHRoaXMuY2hpbGRzW2JdID09PSBhKXJldHVybjtcclxuICAgICAgICAgICAgICAgIGEuYWRkVG8odGhpcyksIHRoaXMuY2hpbGRzLnB1c2goYSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gYSl0aHJvdyBuZXcgRXJyb3IoXCJTdGFnZS5yZW1vdmXlh7rplJk6IOWPguaVsOS4um51bGwhXCIpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLmNoaWxkcy5sZW5ndGg7IGIrKylpZiAodGhpcy5jaGlsZHNbYl0gPT09IGEpcmV0dXJuIGEuc3RhZ2UgPSBudWxsLCB0aGlzLmNoaWxkcyA9IHRoaXMuY2hpbGRzLmRlbChiKSwgdGhpcztcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcyA9IFtdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGZuKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4uY2FsbChzZWxmLCBlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGV2ZW50TmFtZSwgZm4pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhLCBmKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMudW5zdWJzY3JpYmUoYSwgZilcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1c1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnB1Ymxpc2goYSwgYik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIHEgPSBcImNsaWNrLGRiY2xpY2ssbW91c2Vkb3duLG1vdXNldXAsbW91c2VvdmVyLG1vdXNlb3V0LG1vdXNlbW92ZSxtb3VzZWRyYWcsbW91c2V3aGVlbCx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZCxrZXlkb3duLGtleXVwXCIuc3BsaXQoXCIsXCIpLCByID0gdGhpcztcclxuICAgICAgICAgICAgcS5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICByW2FdID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICBudWxsICE9IGIgPyB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoYSwgYikgOiB0aGlzLmRpc3BhdGNoRXZlbnQoYSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZUltYWdlSW5mbyA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuZWFnbGVFeWUuZ2V0SW1hZ2UoYSwgYiksIGQgPSB3aW5kb3cub3BlbihcImFib3V0OmJsYW5rXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQuZG9jdW1lbnQud3JpdGUoXCI8aW1nIHNyYz0nXCIgKyBjICsgXCInIGFsdD0nZnJvbSBjYW52YXMnLz5cIiksIHRoaXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5zYXZlQXNMb2NhbEltYWdlID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy5lYWdsZUV5ZS5nZXRJbWFnZShhLCBiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjLnJlcGxhY2UoXCJpbWFnZS9wbmdcIiwgXCJpbWFnZS9vY3RldC1zdHJlYW1cIiksIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYywgdGhpc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbnVsbCAhPSB0aGlzLmNhbnZhcyAmJiAodGhpcy5ncmFwaGljcy5zYXZlKCksIHRoaXMuZ3JhcGhpY3MuY2xlYXJSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KSwgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIDEgPT0gYS52aXNpYmxlICYmIGEucmVwYWludCh0aGVTdGFnZS5ncmFwaGljcylcclxuICAgICAgICAgICAgICAgIH0pLCAxID09IHRoaXMuZWFnbGVFeWUudmlzaWJsZSAmJiB0aGlzLmVhZ2xlRXllLnBhaW50KHRoaXMpLCB0aGlzLmdyYXBoaWNzLnJlc3RvcmUoKSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5yZXBhaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgMCAhPSB0aGlzLmZyYW1lcyAmJiAodGhpcy5mcmFtZXMgPCAwICYmIDAgPT0gdGhpcy5uZWVkUmVwYWludCB8fCAodGhpcy5wYWludCgpLCB0aGlzLmZyYW1lcyA8IDAgJiYgKHRoaXMubmVlZFJlcGFpbnQgPSAhMSkpKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnpvb20gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIDAgIT0gYi52aXNpYmxlICYmIGIuem9vbShhKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy56b29tT3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAwICE9IGIudmlzaWJsZSAmJiBiLnpvb21PdXQoYSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuem9vbUluID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAwICE9IGIudmlzaWJsZSAmJiBiLnpvb21JbihhKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5jZW50ZXJBbmRab29tID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIDAgIT0gYS52aXNpYmxlICYmIGEuY2VudGVyQW5kWm9vbSgpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnNldENlbnRlciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhIC0gYy5jYW52YXMud2lkdGggLyAyLCBmID0gYiAtIGMuY2FudmFzLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgZC50cmFuc2xhdGVYID0gLWUsIGQudHJhbnNsYXRlWSA9IC1mXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmdldEJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSB7bGVmdDogTnVtYmVyLk1BWF9WQUxVRSwgcmlnaHQ6IE51bWJlci5NSU5fVkFMVUUsIHRvcDogTnVtYmVyLk1BWF9WQUxVRSwgYm90dG9tOiBOdW1iZXIuTUlOX1ZBTFVFfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiLmdldEVsZW1lbnRzQm91bmQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjLmxlZnQgPCBhLmxlZnQgJiYgKGEubGVmdCA9IGMubGVmdCwgYS5sZWZ0Tm9kZSA9IGMubGVmdE5vZGUpLCBjLnRvcCA8IGEudG9wICYmIChhLnRvcCA9IGMudG9wLCBhLnRvcE5vZGUgPSBjLnRvcE5vZGUpLCBjLnJpZ2h0ID4gYS5yaWdodCAmJiAoYS5yaWdodCA9IGMucmlnaHQsIGEucmlnaHROb2RlID0gYy5yaWdodE5vZGUpLCBjLmJvdHRvbSA+IGEuYm90dG9tICYmIChhLmJvdHRvbSA9IGMuYm90dG9tLCBhLmJvdHRvbU5vZGUgPSBjLmJvdHRvbU5vZGUpXHJcbiAgICAgICAgICAgICAgICB9KSwgYS53aWR0aCA9IGEucmlnaHQgLSBhLmxlZnQsIGEuaGVpZ2h0ID0gYS5ib3R0b20gLSBhLnRvcCwgYVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnRvSnNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMsIGMgPSAne1widmVyc2lvblwiOlwiJyArIGp0b3BvLnZlcnNpb24gKyAnXCIsJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gYlthXTtcclxuICAgICAgICAgICAgICAgICAgICBcInN0cmluZ1wiID09IHR5cGVvZiBkICYmIChkID0gJ1wiJyArIGQgKyAnXCInKSwgYyArPSAnXCInICsgYSArICdcIjonICsgZCArIFwiLFwiXHJcbiAgICAgICAgICAgICAgICB9KSwgYyArPSAnXCJjaGlsZHNcIjpbJywgdGhpcy5jaGlsZHMuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGMgKz0gYS50b0pzb24oKVxyXG4gICAgICAgICAgICAgICAgfSksIGMgKz0gXCJdXCIsIGMgKz0gXCJ9XCJcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgPT0gdGhlU3RhZ2UuZnJhbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLCAxMDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGVTdGFnZS5mcmFtZXMgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhlU3RhZ2UucmVwYWludCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXJndW1lbnRzLmNhbGxlZSwgMWUzIC8gLXRoZVN0YWdlLmZyYW1lcyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoZVN0YWdlLnJlcGFpbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFyZ3VtZW50cy5jYWxsZWUsIDFlMyAvIHRoZVN0YWdlLmZyYW1lcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0oKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGVTdGFnZS5tb3VzZXdoZWVsKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IG51bGwgPT0gYS53aGVlbERlbHRhID8gYS5kZXRhaWwgOiBhLndoZWVsRGVsdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gc2VsZi53aGVlbFpvb20pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuem9vbUluKHNlbGYud2hlZWxab29tKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuem9vbU91dChzZWxmLndoZWVsWm9vbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoZVN0YWdlLnBhaW50KCk7XHJcbiAgICAgICAgICAgIH0sIDMwMCk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhlU3RhZ2UucGFpbnQoKVxyXG4gICAgICAgICAgICB9LCAxZTMpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRoZVN0YWdlLnBhaW50KClcclxuICAgICAgICAgICAgfSwgM2UzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHN0YWdlLnByb3RvdHlwZSA9IHtcclxuICAgICAgICAgICAgZ2V0IHdpZHRoKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLndpZHRoXHJcbiAgICAgICAgICAgIH0sIGdldCBoZWlnaHQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXMuaGVpZ2h0XHJcbiAgICAgICAgICAgIH0sIHNldCBjdXJzb3IoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuY3Vyc29yID0gYVxyXG4gICAgICAgICAgICB9LCBnZXQgY3Vyc29yKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLnN0eWxlLmN1cnNvclxyXG4gICAgICAgICAgICB9LCBzZXQgbW9kZShhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5tb2RlID0gYVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGp0b3BvLlN0YWdlID0gc3RhZ2VcclxuICAgIH0oSlRvcG8pLFxyXG4gICAgZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gc2NlbmUoYykge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBkKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYmVnaW5QYXRoKCksIGUuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMCwwLDIzNiwwLjUpXCIsIGUuZmlsbFN0eWxlID0gXCJyZ2JhKDAsMCwyMzYsMC4xKVwiLCBlLnJlY3QoYSwgYiwgYywgZCksIGUuZmlsbCgpLCBlLnN0cm9rZSgpLCBlLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBzY2VuZV9zZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgc2NlbmUucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyA9IG5ldyBqdG9wby51dGlsLk1lc3NhZ2VCdXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRUeXBlID0gXCJzY2VuZVwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuekluZGV4TWFwID0ge307XHJcbiAgICAgICAgICAgICAgICB0aGlzLnpJbmRleEFycmF5ID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhY2tncm91bmRDb2xvciA9IFwiMjU1LDI1NSwyNTVcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9ICEwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbHBoYSA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlWCA9IDE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlWSA9IDE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGUgPSBqdG9wby5TY2VuZU1vZGUubm9ybWFsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUgPSAhMDtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVkgPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0VHJhbnNsYXRlWCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RUcmFuc2xhdGVZID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2VEb3duID0gITE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlRG93blggPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZURvd25ZID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2VEb3duRXZlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcmVhU2VsZWN0ID0gITA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wZXJhdGlvbnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRFbGVtZW50cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFsbCA9ICExO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBcImJhY2tncm91bmQsYmFja2dyb3VuZENvbG9yLG1vZGUscGFpbnRBbGwsYXJlYVNlbGVjdCx0cmFuc2xhdGUsdHJhbnNsYXRlWCx0cmFuc2xhdGVZLGxhc3RUcmFuc2xhdGVkWCxsYXN0VHJhbnNsYXRlZFksYWxwaGEsdmlzaWJsZSxzY2FsZVgsc2NhbGVZXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuY29uY2F0KGMpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IGFcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5hZGRUbyA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YWdlICE9PSBhICYmIG51bGwgIT0gYSAmJiAodGhpcy5zdGFnZSA9IGEpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG51bGwgIT0gYyAmJiAoYy5hZGQodGhpcyksIHRoaXMuYWRkVG8oYykpLCB0aGlzLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpc2libGUgPSAhMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpc2libGUgPSAhMVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGlmICgwICE9IHRoaXMudmlzaWJsZSAmJiBudWxsICE9IHRoaXMuc3RhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYS5zYXZlKCksIHRoaXMucGFpbnRCYWNrZ3JvdWQoYSksIGEucmVzdG9yZSgpLCBhLnNhdmUoKSwgYS5zY2FsZSh0aGlzLnNjYWxlWCwgdGhpcy5zY2FsZVkpLCAxID09IHRoaXMudHJhbnNsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5nZXRPZmZzZXRUcmFuc2xhdGUoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEudHJhbnNsYXRlKGIudHJhbnNsYXRlWCwgYi50cmFuc2xhdGVZKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50Q2hpbGRzKGEpLCBhLnJlc3RvcmUoKSwgYS5zYXZlKCksIHRoaXMucGFpbnRPcGVyYXRpb25zKGEsIHRoaXMub3BlcmF0aW9ucyksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMucmVwYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAwICE9IHRoaXMudmlzaWJsZSAmJiB0aGlzLnBhaW50KGEpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRCYWNrZ3JvdWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgbnVsbCAhPSB0aGlzLmJhY2tncm91bmQgPyBhLmRyYXdJbWFnZSh0aGlzLmJhY2tncm91bmQsIDAsIDAsIGEuY2FudmFzLndpZHRoLCBhLmNhbnZhcy5oZWlnaHQpIDogKGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsUmVjdCgwLCAwLCBhLmNhbnZhcy53aWR0aCwgYS5jYW52YXMuaGVpZ2h0KSwgYS5jbG9zZVBhdGgoKSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5nZXREaXNwbGF5ZWRFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCB0aGlzLnpJbmRleEFycmF5Lmxlbmd0aDsgYisrKWZvciAodmFyIGMgPSB0aGlzLnpJbmRleEFycmF5W2JdLCBkID0gdGhpcy56SW5kZXhNYXBbY10sIGUgPSAwOyBlIDwgZC5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gZFtlXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzVmlzaWFibGUoZikgJiYgYS5wdXNoKGYpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmdldERpc3BsYXllZE5vZGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IFtdLCBjID0gMDsgYyA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmNoaWxkc1tjXTtcclxuICAgICAgICAgICAgICAgICAgICBkIGluc3RhbmNlb2YganRvcG8uTm9kZSAmJiB0aGlzLmlzVmlzaWFibGUoZCkgJiYgYi5wdXNoKGQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Q2hpbGRzID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy56SW5kZXhBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB6SW5kZXggPSB0aGlzLnpJbmRleEFycmF5W2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB6SW5kZXhFbGVtZW50cyA9IHRoaXMuekluZGV4TWFwW3pJbmRleF07XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB6SW5kZXhFbGVtZW50cy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHpJbmRleEVsZW1lbnRzW2pdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSB0aGlzLnBhaW50QWxsIHx8IHRoaXMuaXNWaXNpYWJsZShlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBlbGVtZW50LnRyYW5zZm9ybUFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gZWxlbWVudC5nZXRDZW50ZXJMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKGNlbnRlci54LCBjZW50ZXIueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucm90YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQucm90YXRlKGVsZW1lbnQucm90YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc2NhbGVYICYmIGVsZW1lbnQuc2NhbGVZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2NhbGUoZWxlbWVudC5zY2FsZVgsIGVsZW1lbnQuc2NhbGVZKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5zY2FsZVgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZShlbGVtZW50LnNjYWxlWCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50LnNjYWxlWSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNjYWxlKDEsIGVsZW1lbnQuc2NhbGVZKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBlbGVtZW50LnNoYWRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IGVsZW1lbnQuc2hhZG93Qmx1cjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNoYWRvd0NvbG9yID0gZWxlbWVudC5zaGFkb3dDb2xvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNoYWRvd09mZnNldFggPSBlbGVtZW50LnNoYWRvd09mZnNldFg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRZID0gZWxlbWVudC5zaGFkb3dPZmZzZXRZO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5zZWxlY3RlZCAmJiAxID09IGVsZW1lbnQuc2hvd1NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGFpbnRTZWxlY3RlZChjb250ZXh0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PSBlbGVtZW50LmlzTW91c2VPdmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGFpbnRNb3VzZW92ZXIoY29udGV4dClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnBhaW50KGNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5zdGFnZS5jYW52YXMud2lkdGgsIGMgPSB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBudWxsICE9IGEgJiYgXCJtb3ZlXCIgIT0gYSAmJiAoYiA9IGEuY2FudmFzLndpZHRoLCBjID0gYS5jYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gYiAvIHRoaXMuc2NhbGVYIC8gMiwgZSA9IGMgLyB0aGlzLnNjYWxlWSAvIDIsIGYgPSB7dHJhbnNsYXRlWDogdGhpcy50cmFuc2xhdGVYICsgKGQgLSBkICogdGhpcy5zY2FsZVgpLCB0cmFuc2xhdGVZOiB0aGlzLnRyYW5zbGF0ZVkgKyAoZSAtIGUgKiB0aGlzLnNjYWxlWSl9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5pc1Zpc2lhYmxlID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIGlmICgxICE9IGIudmlzaWJsZSlyZXR1cm4gITE7XHJcbiAgICAgICAgICAgICAgICBpZiAoYiBpbnN0YW5jZW9mIGp0b3BvLkxpbmspcmV0dXJuICEwO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmdldE9mZnNldFRyYW5zbGF0ZSgpLCBkID0gYi54ICsgYy50cmFuc2xhdGVYLCBlID0gYi55ICsgYy50cmFuc2xhdGVZO1xyXG4gICAgICAgICAgICAgICAgZCAqPSB0aGlzLnNjYWxlWCwgZSAqPSB0aGlzLnNjYWxlWTtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gZCArIGIud2lkdGggKiB0aGlzLnNjYWxlWCwgZyA9IGUgKyBiLmhlaWdodCAqIHRoaXMuc2NhbGVZO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQgPiB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCB8fCBlID4gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0IHx8IDAgPiBmIHx8IDAgPiBnID8gITEgOiAhMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50T3BlcmF0aW9ucyA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGIubGVuZ3RoOyBjKyspYltjXShhKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmZpbmRFbGVtZW50cyA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgdGhpcy5jaGlsZHMubGVuZ3RoOyBjKyspMSA9PSBhKHRoaXMuY2hpbGRzW2NdKSAmJiBiLnB1c2godGhpcy5jaGlsZHNbY10pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5nZXRFbGVtZW50c0J5Q2xhc3MgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZEVsZW1lbnRzKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIgaW5zdGFuY2VvZiBhXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmFkZE9wZXJhdGlvbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRpb25zLnB1c2goYSksIHRoaXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5jbGVhck9wZXJhdGlvbnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRpb25zID0gW10sIHRoaXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5nZXRFbGVtZW50QnlYWSA9IGZ1bmN0aW9uIChiLCBjKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gbnVsbCwgZSA9IHRoaXMuekluZGV4QXJyYXkubGVuZ3RoIC0gMTsgZSA+PSAwOyBlLS0pZm9yICh2YXIgZiA9IHRoaXMuekluZGV4QXJyYXlbZV0sIGcgPSB0aGlzLnpJbmRleE1hcFtmXSwgaCA9IGcubGVuZ3RoIC0gMTsgaCA+PSAwOyBoLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGdbaF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgaW5zdGFuY2VvZiBqdG9wby5JbnRlcmFjdGl2ZUVsZW1lbnQgJiYgdGhpcy5pc1Zpc2lhYmxlKGkpICYmIGkuaXNJbkJvdW5kKGIsIGMpKXJldHVybiBkID0gaVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5hZGQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHMucHVzaChhKTtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsID09IHRoaXMuekluZGV4TWFwW2EuekluZGV4XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuekluZGV4TWFwW2EuekluZGV4XSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuekluZGV4QXJyYXkucHVzaChhLnpJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy56SW5kZXhBcnJheS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhIC0gYlxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy56SW5kZXhNYXBbXCJcIiArIGEuekluZGV4XS5wdXNoKGEpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcyA9IGp0b3BvLnV0aWwucmVtb3ZlRnJvbUFycmF5KHRoaXMuY2hpbGRzLCBpdGVtKTtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IHRoaXMuekluZGV4TWFwW2l0ZW0uekluZGV4XTtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuekluZGV4TWFwW2l0ZW0uekluZGV4XSA9IGp0b3BvLnV0aWwucmVtb3ZlRnJvbUFycmF5KGVsZW1lbnRzLCBpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGl0ZW0ucmVtb3ZlSGFuZGxlcih0aGlzKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQucmVtb3ZlSGFuZGxlcihzZWxmKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3BlcmF0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy56SW5kZXhBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy56SW5kZXhNYXAgPSB7fTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5hZGRUb1NlbGVjdGVkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5wdXNoKGEpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuY2FuY2xlQWxsU2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBiKyspdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2JdLnVuc2VsZWN0ZWRIYW5kbGVyKGEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEVsZW1lbnRzID0gW11cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5ub3RJblNlbGVjdGVkTm9kZXMgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBiKyspaWYgKGEgPT09IHRoaXMuc2VsZWN0ZWRFbGVtZW50c1tiXSlyZXR1cm4gITE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gITBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVGcm9tU2VsZWN0ZWQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBiKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuc2VsZWN0ZWRFbGVtZW50c1tiXTtcclxuICAgICAgICAgICAgICAgICAgICBhID09PSBjICYmICh0aGlzLnNlbGVjdGVkRWxlbWVudHMgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHMuZGVsKGIpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnRvU2NlbmVFdmVudCA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGp0b3BvLnV0aWwuY2xvbmUoYik7XHJcbiAgICAgICAgICAgICAgICBpZiAoYy54IC89IHRoaXMuc2NhbGVYLCBjLnkgLz0gdGhpcy5zY2FsZVksIDEgPT0gdGhpcy50cmFuc2xhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0T2Zmc2V0VHJhbnNsYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYy54IC09IGQudHJhbnNsYXRlWCwgYy55IC09IGQudHJhbnNsYXRlWVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGwgIT0gYy5keCAmJiAoYy5keCAvPSB0aGlzLnNjYWxlWCwgYy5keSAvPSB0aGlzLnNjYWxlWSksIG51bGwgIT0gdGhpcy5jdXJyZW50RWxlbWVudCAmJiAoYy50YXJnZXQgPSB0aGlzLmN1cnJlbnRFbGVtZW50KSwgYy5zY2VuZSA9IHRoaXMsIGNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RFbGVtZW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gc2NlbmVfc2VsZi5nZXRFbGVtZW50QnlYWShhLngsIGEueSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBiKWlmIChhLnRhcmdldCA9IGIsIGIubW91c2Vkb3duSGFuZGVyKGEpLCBiLnNlbGVjdGVkSGFuZGxlcihhKSwgc2NlbmVfc2VsZi5ub3RJblNlbGVjdGVkTm9kZXMoYikpYS5jdHJsS2V5IHx8IHNjZW5lX3NlbGYuY2FuY2xlQWxsU2VsZWN0ZWQoKSwgc2NlbmVfc2VsZi5hZGRUb1NlbGVjdGVkKGIpOyBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAxID09IGEuY3RybEtleSAmJiAoYi51bnNlbGVjdGVkSGFuZGxlcigpLCB0aGlzLnJlbW92ZUZyb21TZWxlY3RlZChiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLnNlbGVjdGVkRWxlbWVudHMubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHNbY107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQuc2VsZWN0ZWRIYW5kbGVyKGEpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGEuY3RybEtleSB8fCBzY2VuZV9zZWxmLmNhbmNsZUFsbFNlbGVjdGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50ID0gYlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlZG93bkhhbmRsZXIgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChiKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vdXNlRG93biA9ICEwLCB0aGlzLm1vdXNlRG93blggPSBjLngsIHRoaXMubW91c2VEb3duWSA9IGMueSwgdGhpcy5tb3VzZURvd25FdmVudCA9IGMsIHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUubm9ybWFsKXRoaXMuc2VsZWN0RWxlbWVudChjKSwgKG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YganRvcG8uTGluaykgJiYgMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5sYXN0VHJhbnNsYXRlWCA9IHRoaXMudHJhbnNsYXRlWCwgdGhpcy5sYXN0VHJhbnNsYXRlWSA9IHRoaXMudHJhbnNsYXRlWSk7IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLmRyYWcgJiYgMSA9PSB0aGlzLnRyYW5zbGF0ZSlyZXR1cm4gdGhpcy5sYXN0VHJhbnNsYXRlWCA9IHRoaXMudHJhbnNsYXRlWCwgdm9pZCh0aGlzLmxhc3RUcmFuc2xhdGVZID0gdGhpcy50cmFuc2xhdGVZKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLnNlbGVjdCA/IHRoaXMuc2VsZWN0RWxlbWVudChjKSA6IHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZWRpdCAmJiAodGhpcy5zZWxlY3RFbGVtZW50KGMpLCAobnVsbCA9PSB0aGlzLmN1cnJlbnRFbGVtZW50IHx8IHRoaXMuY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5MaW5rKSAmJiAxID09IHRoaXMudHJhbnNsYXRlICYmICh0aGlzLmxhc3RUcmFuc2xhdGVYID0gdGhpcy50cmFuc2xhdGVYLCB0aGlzLmxhc3RUcmFuc2xhdGVZID0gdGhpcy50cmFuc2xhdGVZKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlZG93blwiLCBjKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNldXBIYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhZ2UuY3Vyc29yICE9IGp0b3BvLk1vdXNlQ3Vyc29yLm5vcm1hbCAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBqdG9wby5Nb3VzZUN1cnNvci5ub3JtYWwpLCBzY2VuZV9zZWxmLmNsZWFyT3BlcmF0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChiKTtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gdGhpcy5jdXJyZW50RWxlbWVudCAmJiAoYy50YXJnZXQgPSBzY2VuZV9zZWxmLmN1cnJlbnRFbGVtZW50LCB0aGlzLmN1cnJlbnRFbGVtZW50Lm1vdXNldXBIYW5kbGVyKGMpKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2V1cFwiLCBjKSwgdGhpcy5tb3VzZURvd24gPSAhMVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmRyYWdFbGVtZW50cyA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmN1cnJlbnRFbGVtZW50ICYmIDEgPT0gdGhpcy5jdXJyZW50RWxlbWVudC5kcmFnYWJsZSlmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMuc2VsZWN0ZWRFbGVtZW50cy5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzW2NdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgwICE9IGQuZHJhZ2FibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBqdG9wby51dGlsLmNsb25lKGIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldCA9IGQsIGQubW91c2VkcmFnSGFuZGxlcihlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZWRyYWdIYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy50b1NjZW5lRXZlbnQoYik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLm5vcm1hbCA/IG51bGwgPT0gdGhpcy5jdXJyZW50RWxlbWVudCB8fCB0aGlzLmN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YganRvcG8uTGluayA/IDEgPT0gdGhpcy50cmFuc2xhdGUgJiYgKHRoaXMuc3RhZ2UuY3Vyc29yID0ganRvcG8uTW91c2VDdXJzb3IuY2xvc2VkX2hhbmQsIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBjLmR4LCB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmxhc3RUcmFuc2xhdGVZICsgYy5keSkgOiB0aGlzLmRyYWdFbGVtZW50cyhjKSA6IHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZHJhZyA/IDEgPT0gdGhpcy50cmFuc2xhdGUgJiYgKHRoaXMuc3RhZ2UuY3Vyc29yID0ganRvcG8uTW91c2VDdXJzb3IuY2xvc2VkX2hhbmQsIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMubGFzdFRyYW5zbGF0ZVggKyBjLmR4LCB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmxhc3RUcmFuc2xhdGVZICsgYy5keSkgOiB0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLnNlbGVjdCA/IG51bGwgIT0gdGhpcy5jdXJyZW50RWxlbWVudCA/IDEgPT0gdGhpcy5jdXJyZW50RWxlbWVudC5kcmFnYWJsZSAmJiB0aGlzLmRyYWdFbGVtZW50cyhjKSA6IDEgPT0gdGhpcy5hcmVhU2VsZWN0ICYmIHRoaXMuYXJlYVNlbGVjdEhhbmRsZShjKSA6IHRoaXMubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZWRpdCAmJiAobnVsbCA9PSB0aGlzLmN1cnJlbnRFbGVtZW50IHx8IHRoaXMuY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5MaW5rID8gMSA9PSB0aGlzLnRyYW5zbGF0ZSAmJiAodGhpcy5zdGFnZS5jdXJzb3IgPSBqdG9wby5Nb3VzZUN1cnNvci5jbG9zZWRfaGFuZCwgdGhpcy50cmFuc2xhdGVYID0gdGhpcy5sYXN0VHJhbnNsYXRlWCArIGMuZHgsIHRoaXMudHJhbnNsYXRlWSA9IHRoaXMubGFzdFRyYW5zbGF0ZVkgKyBjLmR5KSA6IHRoaXMuZHJhZ0VsZW1lbnRzKGMpKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VkcmFnXCIsIGMpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuYXJlYVNlbGVjdEhhbmRsZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGEub2Zmc2V0TGVmdCwgYyA9IGEub2Zmc2V0VG9wLCBmID0gdGhpcy5tb3VzZURvd25FdmVudC5vZmZzZXRMZWZ0LCBnID0gdGhpcy5tb3VzZURvd25FdmVudC5vZmZzZXRUb3AsIGggPSBiID49IGYgPyBmIDogYiwgaSA9IGMgPj0gZyA/IGcgOiBjLCBqID0gTWF0aC5hYnMoYS5keCkgKiB0aGlzLnNjYWxlWCwgayA9IE1hdGguYWJzKGEuZHkpICogdGhpcy5zY2FsZVksIGwgPSBuZXcgZChoLCBpLCBqLCBrKTtcclxuICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYuY2xlYXJPcGVyYXRpb25zKCkuYWRkT3BlcmF0aW9uKGwpLCBiID0gYS54LCBjID0gYS55LCBmID0gdGhpcy5tb3VzZURvd25FdmVudC54LCBnID0gdGhpcy5tb3VzZURvd25FdmVudC55LCBoID0gYiA+PSBmID8gZiA6IGIsIGkgPSBjID49IGcgPyBnIDogYywgaiA9IE1hdGguYWJzKGEuZHgpLCBrID0gTWF0aC5hYnMoYS5keSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBtID0gaCArIGosIG4gPSBpICsgaywgbyA9IDA7IG8gPCBzY2VuZV9zZWxmLmNoaWxkcy5sZW5ndGg7IG8rKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0gc2NlbmVfc2VsZi5jaGlsZHNbb107XHJcbiAgICAgICAgICAgICAgICAgICAgcC54ID4gaCAmJiBwLnggKyBwLndpZHRoIDwgbSAmJiBwLnkgPiBpICYmIHAueSArIHAuaGVpZ2h0IDwgbiAmJiBzY2VuZV9zZWxmLm5vdEluU2VsZWN0ZWROb2RlcyhwKSAmJiAocC5zZWxlY3RlZEhhbmRsZXIoYSksIHNjZW5lX3NlbGYuYWRkVG9TZWxlY3RlZChwKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2Vjb29yZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBiLngsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogYi55XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRvU2NlbmVFdmVudChiKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT0ganRvcG8uU2NlbmVNb2RlLmRyYWcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCh0aGlzLnN0YWdlLmN1cnNvciA9IGp0b3BvLk1vdXNlQ3Vyc29yLm9wZW5faGFuZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlID09IGp0b3BvLlNjZW5lTW9kZS5ub3JtYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWdlLmN1cnNvciA9IGp0b3BvLk1vdXNlQ3Vyc29yLm5vcm1hbDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09IGp0b3BvLlNjZW5lTW9kZS5zZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWdlLmN1cnNvciA9IGp0b3BvLk1vdXNlQ3Vyc29yLm5vcm1hbDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHNjZW5lX3NlbGYuZ2V0RWxlbWVudEJ5WFkoYy54LCBjLnkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzY2VuZV9zZWxmLm1vdXNlT3ZlcmVsZW1lbnQgJiYgc2NlbmVfc2VsZi5tb3VzZU92ZXJlbGVtZW50ICE9PSBkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMudGFyZ2V0ID0gZCwgc2NlbmVfc2VsZi5tb3VzZU92ZXJlbGVtZW50Lm1vdXNlb3V0SGFuZGxlcihjKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzY2VuZV9zZWxmLm1vdXNlT3ZlcmVsZW1lbnQgPSBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgwID09IGQuaXNNb3VzZU92ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy50YXJnZXQgPSBkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkLm1vdXNlb3ZlckhhbmRsZXIoYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBjKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjLnRhcmdldCA9IGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQubW91c2Vtb3ZlSGFuZGxlcihjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmVfc2VsZi5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjZW5lX3NlbGYubW91c2VPdmVyZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjLnRhcmdldCA9IGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYubW91c2VPdmVyZWxlbWVudC5tb3VzZW91dEhhbmRsZXIoYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYubW91c2VPdmVyZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lX3NlbGYuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3V0XCIsIGMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmVfc2VsZi5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCB0aGlzLm1vdXNlb3ZlckhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBiKVxyXG4gICAgICAgICAgICB9LCB0aGlzLm1vdXNlb3V0SGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMudG9TY2VuZUV2ZW50KGEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2VvdXRcIiwgYilcclxuICAgICAgICAgICAgfSwgdGhpcy5jbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnRvU2NlbmVFdmVudChhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEVsZW1lbnQgJiYgKGIudGFyZ2V0ID0gdGhpcy5jdXJyZW50RWxlbWVudCwgdGhpcy5jdXJyZW50RWxlbWVudC5jbGlja0hhbmRsZXIoYikpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJjbGlja1wiLCBiKVxyXG4gICAgICAgICAgICB9LCB0aGlzLmRiY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy50b1NjZW5lRXZlbnQoYSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50ID8gKGIudGFyZ2V0ID0gdGhpcy5jdXJyZW50RWxlbWVudCwgdGhpcy5jdXJyZW50RWxlbWVudC5kYmNsaWNrSGFuZGxlcihiKSkgOiBzY2VuZV9zZWxmLmNhbmNsZUFsbFNlbGVjdGVkKCksIHRoaXMuZGlzcGF0Y2hFdmVudChcImRiY2xpY2tcIiwgYilcclxuICAgICAgICAgICAgfSwgdGhpcy5tb3VzZXdoZWVsSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMudG9TY2VuZUV2ZW50KGEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2V3aGVlbFwiLCBiKVxyXG4gICAgICAgICAgICB9LCB0aGlzLnRvdWNoc3RhcnQgPSB0aGlzLm1vdXNlZG93bkhhbmRlciwgdGhpcy50b3VjaG1vdmUgPSB0aGlzLm1vdXNlZHJhZ0hhbmRsZXIsIHRoaXMudG91Y2hlbmQgPSB0aGlzLm1vdXNlZG93bkhhbmRlciwgdGhpcy5rZXlkb3duSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJrZXlkb3duXCIsIGEpXHJcbiAgICAgICAgICAgIH0sIHRoaXMua2V5dXBIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImtleXVwXCIsIGEpXHJcbiAgICAgICAgICAgIH0sIHRoaXMuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGZuKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4uY2FsbChzZWxmLCBlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGV2ZW50TmFtZSwgZm4pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhLCBmKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMudW5zdWJzY3JpYmUoYSwgZilcclxuICAgICAgICAgICAgfSwgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1c1xyXG4gICAgICAgICAgICB9LCB0aGlzLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUJ1cy5wdWJsaXNoKGEsIGIpLCB0aGlzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciBmID0gXCJjbGljayxkYmNsaWNrLG1vdXNlZG93bixtb3VzZXVwLG1vdXNlb3Zlcixtb3VzZW91dCxtb3VzZW1vdmUsbW91c2VkcmFnLG1vdXNld2hlZWwsdG91Y2hzdGFydCx0b3VjaG1vdmUsdG91Y2hlbmQsa2V5ZG93bixrZXl1cFwiLnNwbGl0KFwiLFwiKSwgZyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiBmLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGdbYV0gPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIG51bGwgIT0gYiA/IHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihhLCBiKSA6IHRoaXMuZGlzcGF0Y2hFdmVudChhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSwgdGhpcy56b29tID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gYSAmJiAwICE9IGEgJiYgKHRoaXMuc2NhbGVYID0gYSksIG51bGwgIT0gYiAmJiAwICE9IGIgJiYgKHRoaXMuc2NhbGVZID0gYilcclxuICAgICAgICAgICAgfSwgdGhpcy56b29tT3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIDAgIT0gYSAmJiAobnVsbCA9PSBhICYmIChhID0gLjgpLCB0aGlzLnNjYWxlWCAvPSBhLCB0aGlzLnNjYWxlWSAvPSBhKVxyXG4gICAgICAgICAgICB9LCB0aGlzLnpvb21JbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAwICE9IGEgJiYgKG51bGwgPT0gYSAmJiAoYSA9IC44KSwgdGhpcy5zY2FsZVggKj0gYSwgdGhpcy5zY2FsZVkgKj0gYSlcclxuICAgICAgICAgICAgfSwgdGhpcy5nZXRCb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7bGVmdDogMCwgdG9wOiAwLCByaWdodDogdGhpcy5zdGFnZS5jYW52YXMud2lkdGgsIGJvdHRvbTogdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0LCB3aWR0aDogdGhpcy5zdGFnZS5jYW52YXMud2lkdGgsIGhlaWdodDogdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0fVxyXG4gICAgICAgICAgICB9LCB0aGlzLmdldEVsZW1lbnRzQm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ganRvcG8udXRpbC5nZXRFbGVtZW50c0JvdW5kKHRoaXMuY2hpbGRzKVxyXG4gICAgICAgICAgICB9LCB0aGlzLnRyYW5zbGF0ZVRvQ2VudGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5nZXRFbGVtZW50c0JvdW5kKCksIGMgPSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCAvIDIgLSAoYi5sZWZ0ICsgYi5yaWdodCkgLyAyLCBkID0gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0IC8gMiAtIChiLnRvcCArIGIuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgICAgICAgICBhICYmIChjID0gYS5jYW52YXMud2lkdGggLyAyIC0gKGIubGVmdCArIGIucmlnaHQpIC8gMiwgZCA9IGEuY2FudmFzLmhlaWdodCAvIDIgLSAoYi50b3AgKyBiLmJvdHRvbSkgLyAyKSwgdGhpcy50cmFuc2xhdGVYID0gYywgdGhpcy50cmFuc2xhdGVZID0gZFxyXG4gICAgICAgICAgICB9LCB0aGlzLnNldENlbnRlciA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGEgLSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCAvIDIsIGQgPSBiIC0gdGhpcy5zdGFnZS5jYW52YXMuaGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlWCA9IC1jLCB0aGlzLnRyYW5zbGF0ZVkgPSAtZFxyXG4gICAgICAgICAgICB9LCB0aGlzLmNlbnRlckFuZFpvb20gPSBmdW5jdGlvbiAoYSwgYiwgYykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNsYXRlVG9DZW50ZXIoYyksIG51bGwgPT0gYSB8fCBudWxsID09IGIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0RWxlbWVudHNCb3VuZCgpLCBlID0gZC5yaWdodCAtIGQubGVmdCwgZiA9IGQuYm90dG9tIC0gZC50b3AsIGcgPSB0aGlzLnN0YWdlLmNhbnZhcy53aWR0aCAvIGUsIGggPSB0aGlzLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyBmO1xyXG4gICAgICAgICAgICAgICAgICAgIGMgJiYgKGcgPSBjLmNhbnZhcy53aWR0aCAvIGUsIGggPSBjLmNhbnZhcy5oZWlnaHQgLyBmKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IE1hdGgubWluKGcsIGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID4gMSlyZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy56b29tKGksIGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnpvb20oYSwgYilcclxuICAgICAgICAgICAgfSwgdGhpcy5nZXRDZW50ZXJMb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7eDogc2NlbmVfc2VsZi5zdGFnZS5jYW52YXMud2lkdGggLyAyLCB5OiBzY2VuZV9zZWxmLnN0YWdlLmNhbnZhcy5oZWlnaHQgLyAyfVxyXG4gICAgICAgICAgICB9LCB0aGlzLmRvTGF5b3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGEgJiYgYSh0aGlzLCB0aGlzLmNoaWxkcylcclxuICAgICAgICAgICAgfSwgdGhpcy50b0pzb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLCBiID0gXCJ7XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcy5sZW5ndGhcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gYVtjXTtcclxuICAgICAgICAgICAgICAgICAgICBcImJhY2tncm91bmRcIiA9PSBjICYmIChkID0gYS5fYmFja2dyb3VuZC5zcmMpLCBcInN0cmluZ1wiID09IHR5cGVvZiBkICYmIChkID0gJ1wiJyArIGQgKyAnXCInKSwgYiArPSAnXCInICsgYyArICdcIjonICsgZCArIFwiLFwiXHJcbiAgICAgICAgICAgICAgICB9KSwgYiArPSAnXCJjaGlsZHNcIjpbJztcclxuICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy5jaGlsZHMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGEsIGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBiICs9IGEudG9Kc29uKCksIGMgPiBkICsgMSAmJiAoYiArPSBcIixcIilcclxuICAgICAgICAgICAgICAgIH0pLCBiICs9IFwiXVwiLCBiICs9IFwifVwiXHJcbiAgICAgICAgICAgIH0sIHNjZW5lX3NlbGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNjZW5lLnByb3RvdHlwZSA9IG5ldyBqdG9wby5FbGVtZW50O1xyXG4gICAgICAgIHZhciBjID0ge307XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoc2NlbmUucHJvdG90eXBlLCB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHtcclxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgICAgICB9LCBzZXQ6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBjW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsID09IGIgJiYgKGIgPSBuZXcgSW1hZ2UsIGIuc3JjID0gYSwgYi5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjW2FdID0gYlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSwgdGhpcy5fYmFja2dyb3VuZCA9IGJcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5fYmFja2dyb3VuZCA9IGFcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLCBqdG9wby5TY2VuZSA9IHNjZW5lXHJcbiAgICB9KEpUb3BvKSxcclxuICAgIGZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAgICAgIGZ1bmN0aW9uIERpc3BsYXlFbGVtZW50KCkge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50VHlwZSA9IFwiZGlzcGxheUVsZW1lbnRcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMueCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IDMyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSAzMjtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9ICEwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbHBoYSA9IDE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvdGF0ZSA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlWCA9IDE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlWSA9IDE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0cm9rZUNvbG9yID0gXCIyMiwxMjQsMjU1XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvcmRlckNvbG9yID0gXCIyMiwxMjQsMjU1XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGxDb2xvciA9IFwiMjIsMTI0LDI1NVwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkb3cgPSAhMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hhZG93Qmx1ciA9IDU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWRvd0NvbG9yID0gXCJyZ2JhKDAsMCwwLDAuNSlcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hhZG93T2Zmc2V0WCA9IDM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWRvd09mZnNldFkgPSA2O1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm1BYmxlID0gITE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnpJbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IFwieCx5LHdpZHRoLGhlaWdodCx2aXNpYmxlLGFscGhhLHJvdGF0ZSxzY2FsZVgsc2NhbGVZLHN0cm9rZUNvbG9yLGZpbGxDb2xvcixzaGFkb3csc2hhZG93Q29sb3Isc2hhZG93T2Zmc2V0WCxzaGFkb3dPZmZzZXRZLHRyYW5zZm9ybUFibGUsekluZGV4XCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuY29uY2F0KGEpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICBhLnJlY3QoLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBhLmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIGEuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmdldExvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLngsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuc2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucXRvcG8gJiYgdGhpcy5xdG9wby5hdHRyICYmIHRoaXMucXRvcG8uYXR0ci5wb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXRvcG8uYXR0ci5wb3NpdGlvblswXSA9IGE7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uWzFdID0gYjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnggPSBhLCB0aGlzLnkgPSBiLCB0aGlzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q2VudGVyTG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnNldENlbnRlckxvY2F0aW9uID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMueCA9IGEgLSB0aGlzLndpZHRoIC8gMjtcclxuICAgICAgICAgICAgICAgIHRoaXMueSA9IGIgLSB0aGlzLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5nZXRTaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpdGhcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTaXplID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBiO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Qm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMueCxcclxuICAgICAgICAgICAgICAgICAgICB0b3A6IHRoaXMueSxcclxuICAgICAgICAgICAgICAgICAgICByaWdodDogdGhpcy54ICsgdGhpcy53aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICBib3R0b206IHRoaXMueSArIHRoaXMuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWlnaHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5zZXRCb3VuZCA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldExvY2F0aW9uKGEsIGIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTaXplKGMsIGQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RGlzcGxheUJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0aGlzLngsXHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiB0aGlzLnksXHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHRoaXMueCArIHRoaXMud2lkdGggKiB0aGlzLnNjYWxlWCxcclxuICAgICAgICAgICAgICAgICAgICBib3R0b206IHRoaXMueSArIHRoaXMuaGVpZ2h0ICogdGhpcy5zY2FsZVlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5nZXREaXNwbGF5U2l6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMud2lkdGggKiB0aGlzLnNjYWxlWCxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0ICogdGhpcy5zY2FsZVlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IHRoaXMuZ2V0Qm91bmQoKTtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJUb3BfTGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiBjLmxlZnQsIHk6IGMudG9wfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlRvcF9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogdGhpcy5jeCwgeTogYy50b3B9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiVG9wX1JpZ2h0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMucmlnaHQsIHk6IGMudG9wfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIk1pZGRsZV9MZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMubGVmdCwgeTogdGhpcy5jeX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJNaWRkbGVfQ2VudGVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IHRoaXMuY3gsIHk6IHRoaXMuY3l9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiTWlkZGxlX1JpZ2h0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IGMucmlnaHQsIHk6IHRoaXMuY3l9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiQm90dG9tX0xlZnRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogYy5sZWZ0LCB5OiBjLmJvdHRvbX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJCb3R0b21fQ2VudGVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0ge3g6IHRoaXMuY3gsIHk6IGMuYm90dG9tfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAgXCJCb3R0b21fUmlnaHRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB7eDogYy5yaWdodCwgeTogYy5ib3R0b219O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHt4OiBjLmxlZnQsIHk6IGMudG9wfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbjtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGludGVyYWN0aXZlRWxlbWVudCgpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaW50ZXJhY3RpdmVFbGVtZW50LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRUeXBlID0gXCJpbnRlcmFjdGl2ZUVsZW1lbnRcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ2FibGUgPSAhMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1NlbGVjdGVkID0gITA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTG9jYXRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc01vdXNlT3ZlciA9ICExO1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBcImRyYWdhYmxlLHNlbGVjdGVkLHNob3dTZWxlY3RlZCxpc01vdXNlT3ZlclwiLnNwbGl0KFwiLFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChhKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoMCAhPSB0aGlzLnNob3dTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5zdHJva2VTdHlsZSA9IFwicmdiYSgxNjgsMjAyLDI1NSwgMC45KVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gXCJyZ2JhKDE2OCwyMDIsMjM2LDAuNylcIjtcclxuICAgICAgICAgICAgICAgICAgICBhLnJlY3QoLXRoaXMud2lkdGggLyAyIC0gMywgLXRoaXMuaGVpZ2h0IC8gMiAtIDMsIHRoaXMud2lkdGggKyA2LCB0aGlzLmhlaWdodCArIDYpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuZmlsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICBhLnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50TW91c2VvdmVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhaW50U2VsZWN0ZWQoYSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuaXNJbkJvdW5kID0gZnVuY3Rpb24gKHBvaW50WCwgcG9pbnRZKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnRYID4gdGhpcy54ICYmIHBvaW50WCA8IHRoaXMueCArIHRoaXMud2lkdGggKiBNYXRoLmFicyh0aGlzLnNjYWxlWCkgJiYgcG9pbnRZID4gdGhpcy55ICYmIHBvaW50WSA8IHRoaXMueSArIHRoaXMuaGVpZ2h0ICogTWF0aC5hYnModGhpcy5zY2FsZVkpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICEwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZExvY2F0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCxcclxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy51bnNlbGVjdGVkSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMb2NhdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5kYmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJkYmNsaWNrXCIsIGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcImNsaWNrXCIsIGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMubW91c2Vkb3duSGFuZGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZG93blwiLCBhKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNldXBIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNldXBcIiwgYSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5tb3VzZW92ZXJIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNNb3VzZU92ZXIgPSAhMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3ZlclwiLCBhKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlbW92ZUhhbmRsZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibW91c2Vtb3ZlXCIsIGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VvdXRIYW5kbGVyID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNNb3VzZU92ZXIgPSAhMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlb3V0XCIsIGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VkcmFnSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRMb2NhdGlvbihiLCBjKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcIm1vdXNlZHJhZ1wiLCBhKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWVzc2FnZUJ1cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyA9IG5ldyBqdG9wby51dGlsLk1lc3NhZ2VCdXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuc3Vic2NyaWJlKGV2ZW50LCBmbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tZXNzYWdlQnVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnB1Ymxpc2goZXZlbnQsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMudW5zdWJzY3JpYmUoZXZlbnQsIGZuKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzID0gbmV3IGp0b3BvLnV0aWwuTWVzc2FnZUJ1c1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIFwiY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZFwiLnNwbGl0KFwiLFwiKVxyXG4gICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGZbZXZlbnROYW1lXSA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEVkaXRhYmxlRWxlbWVudCgpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgRWRpdGFibGVFbGVtZW50LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRBYmxlID0gITE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUG9pbnQgPSBudWxsO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmdldEN0cmxQb3NpdGlvbiA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IDU7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IDU7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0UG9zaXRpb24oYSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IGQueCAtIGIsXHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiBkLnkgLSBjLFxyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBkLnggKyBiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvdHRvbTogZC55ICsgY1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkSGFuZGxlciA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICBFZGl0YWJsZUVsZW1lbnQucHJvdG90eXBlLnNlbGVjdGVkSGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLnNlbGVjdGVkU2l6ZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaWYgKGIuc2NlbmUubW9kZSA9PSBqdG9wby5TY2VuZU1vZGUuZWRpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdEFibGUgPSAhMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnVuc2VsZWN0ZWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgRWRpdGFibGVFbGVtZW50LnByb3RvdHlwZS51bnNlbGVjdGVkSGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFNpemUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0QWJsZSA9ICExO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgYiA9IFtcIlRvcF9MZWZ0XCIsIFwiVG9wX0NlbnRlclwiLCBcIlRvcF9SaWdodFwiLCBcIk1pZGRsZV9MZWZ0XCIsIFwiTWlkZGxlX1JpZ2h0XCIsIFwiQm90dG9tX0xlZnRcIiwgXCJCb3R0b21fQ2VudGVyXCIsIFwiQm90dG9tX1JpZ2h0XCJdO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Q3RybCA9IGZ1bmN0aW9uIChjeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy5lZGl0QWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN4LnNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGIubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmdldEN0cmxQb3NpdGlvbihiW2NdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZC5sZWZ0IC09IHRoaXMuY3g7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucmlnaHQgLT0gdGhpcy5jeDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZC50b3AgLT0gdGhpcy5jeTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZC5ib3R0b20gLT0gdGhpcy5jeTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBkLnJpZ2h0IC0gZC5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGQuYm90dG9tIC0gZC50b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjeC5zdHJva2VTdHlsZSA9IFwicmdiYSgwLDAsMCwwLjgpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN4LnJlY3QoZC5sZWZ0LCBkLnRvcCwgZSwgZik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN4LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjeC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3guYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN4LnN0cm9rZVN0eWxlID0gXCJyZ2JhKDI1NSwyNTUsMjU1LDAuMylcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3gucmVjdChkLmxlZnQgKyAxLCBkLnRvcCArIDEsIGUgLSAyLCBmIC0gMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN4LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjeC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY3gucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmlzSW5Cb3VuZCA9IGZ1bmN0aW9uIChhLCBjKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFBvaW50ID0gbnVsbCwgMSA9PSB0aGlzLmVkaXRBYmxlKWZvciAodmFyIGUgPSAwOyBlIDwgYi5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gdGhpcy5nZXRDdHJsUG9zaXRpb24oYltlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPiBmLmxlZnQgJiYgYSA8IGYucmlnaHQgJiYgYyA+IGYudG9wICYmIGMgPCBmLmJvdHRvbSlyZXR1cm4gdGhpcy5zZWxlY3RlZFBvaW50ID0gYltlXSwgITBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBFZGl0YWJsZUVsZW1lbnQucHJvdG90eXBlLmlzSW5Cb3VuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VkcmFnSGFuZGxlciA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keCwgYyA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi55ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldExvY2F0aW9uKGIsIGMpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJtb3VzZWRyYWdcIiwgYSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiVG9wX0xlZnRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCAtIGEuZHgsIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgLSBhLmR5LCBiID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnggKyBhLmR4LCBjID0gdGhpcy5zZWxlY3RlZExvY2F0aW9uLnkgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiIDwgdGhpcy54ICsgdGhpcy53aWR0aCAmJiAodGhpcy54ID0gYiwgdGhpcy53aWR0aCA9IGQpLCBjIDwgdGhpcy55ICsgdGhpcy5oZWlnaHQgJiYgKHRoaXMueSA9IGMsIHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiVG9wX0NlbnRlclwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCAtIGEuZHksIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPCB0aGlzLnkgKyB0aGlzLmhlaWdodCAmJiAodGhpcy55ID0gYywgdGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJUb3BfUmlnaHRcIiA9PSB0aGlzLnNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLnNlbGVjdGVkU2l6ZS53aWR0aCArIGEuZHgsIGMgPSB0aGlzLnNlbGVjdGVkTG9jYXRpb24ueSArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPCB0aGlzLnkgKyB0aGlzLmhlaWdodCAmJiAodGhpcy55ID0gYywgdGhpcy5oZWlnaHQgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgLSBhLmR5KSwgZCA+IDEgJiYgKHRoaXMud2lkdGggPSBkKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJNaWRkbGVfTGVmdFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoIC0gYS5keCwgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYiA8IHRoaXMueCArIHRoaXMud2lkdGggJiYgKHRoaXMueCA9IGIpLCBkID4gMSAmJiAodGhpcy53aWR0aCA9IGQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIk1pZGRsZV9SaWdodFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoICsgYS5keDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA+IDEgJiYgKHRoaXMud2lkdGggPSBkKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJCb3R0b21fTGVmdFwiID09IHRoaXMuc2VsZWN0ZWRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuc2VsZWN0ZWRTaXplLndpZHRoIC0gYS5keCwgYiA9IHRoaXMuc2VsZWN0ZWRMb2NhdGlvbi54ICsgYS5keDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA+IDEgJiYgKHRoaXMueCA9IGIsIHRoaXMud2lkdGggPSBkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNlbGVjdGVkU2l6ZS5oZWlnaHQgKyBhLmR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID4gMSAmJiAodGhpcy5oZWlnaHQgPSBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJCb3R0b21fQ2VudGVyXCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5zZWxlY3RlZFNpemUuaGVpZ2h0ICsgYS5keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA+IDEgJiYgKHRoaXMuaGVpZ2h0ID0gZSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiQm90dG9tX1JpZ2h0XCIgPT0gdGhpcy5zZWxlY3RlZFBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZWxlY3RlZFNpemUud2lkdGggKyBhLmR4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID4gMSAmJiAodGhpcy53aWR0aCA9IGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc2VsZWN0ZWRTaXplLmhlaWdodCArIGEuZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPiAxICYmICh0aGlzLmhlaWdodCA9IGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChcInJlc2l6ZVwiLCBhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBEaXNwbGF5RWxlbWVudC5wcm90b3R5cGUgPSBuZXcganRvcG8uRWxlbWVudCwgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoRGlzcGxheUVsZW1lbnQucHJvdG90eXBlLCB7XHJcbiAgICAgICAgICAgIGN4OiB7XHJcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy54ICsgdGhpcy53aWR0aCAvIDJcclxuICAgICAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnggPSBhIC0gdGhpcy53aWR0aCAvIDJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY3k6IHtcclxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDJcclxuICAgICAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBhIC0gdGhpcy5oZWlnaHQgLyAyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpbnRlcmFjdGl2ZUVsZW1lbnQucHJvdG90eXBlID0gbmV3IERpc3BsYXlFbGVtZW50O1xyXG4gICAgICAgIEVkaXRhYmxlRWxlbWVudC5wcm90b3R5cGUgPSBuZXcgaW50ZXJhY3RpdmVFbGVtZW50O1xyXG4gICAgICAgIGp0b3BvLkRpc3BsYXlFbGVtZW50ID0gRGlzcGxheUVsZW1lbnQ7XHJcbiAgICAgICAganRvcG8uSW50ZXJhY3RpdmVFbGVtZW50ID0gaW50ZXJhY3RpdmVFbGVtZW50O1xyXG4gICAgICAgIGp0b3BvLkVkaXRhYmxlRWxlbWVudCA9IEVkaXRhYmxlRWxlbWVudDtcclxuICAgIH0oSlRvcG8pLFxyXG4gICAgZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYmFzZU5vZGUoYykge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgYmFzZU5vZGUucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5lbGVtZW50VHlwZSA9IFwibm9kZVwiLCB0aGlzLnpJbmRleCA9IGp0b3BvLnpJbmRleF9Ob2RlLCB0aGlzLnRleHQgPSBjLCB0aGlzLmZvbnQgPSBcIjEycHggQ29uc29sYXNcIiwgdGhpcy5mb250Q29sb3IgPSBcIjI1NSwyNTUsMjU1XCIsIHRoaXMuYm9yZGVyV2lkdGggPSAwLCB0aGlzLmJvcmRlckNvbG9yID0gXCIyNTUsMjU1LDI1NVwiLCB0aGlzLmJvcmRlclJhZGl1cyA9IG51bGwsIHRoaXMuZHJhZ2FibGUgPSAhMCwgdGhpcy50ZXh0UG9zaXRpb24gPSBcIkJvdHRvbV9DZW50ZXJcIiwgdGhpcy50ZXh0T2Zmc2V0WCA9IDAsIHRoaXMudGV4dE9mZnNldFkgPSAwLCB0aGlzLnRyYW5zZm9ybUFibGUgPSAhMCwgdGhpcy5pbkxpbmtzID0gbnVsbCwgdGhpcy5vdXRMaW5rcyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IFwidGV4dCxmb250LGZvbnRDb2xvcix0ZXh0UG9zaXRpb24sdGV4dE9mZnNldFgsdGV4dE9mZnNldFksYm9yZGVyUmFkaXVzXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxpemVkUHJvcGVydGllcyA9IHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMuY29uY2F0KGQpXHJcbiAgICAgICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZShjKSwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gYS5nbG9iYWxBbHBoYTtcclxuICAgICAgICAgICAgICAgICAgICBhLmdsb2JhbEFscGhhID0gdGhpcy5hbHBoYSwgbnVsbCAhPSB0aGlzLmFsYXJtSW1hZ2UgJiYgbnVsbCAhPSB0aGlzLmFsYXJtID8gYS5kcmF3SW1hZ2UodGhpcy5hbGFybUltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KSA6IGEuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpLCBhLmdsb2JhbEFscGhhID0gYlxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgbnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzID8gYS5yZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpIDogYS5KVG9wb1JvdW5kUmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmJvcmRlclJhZGl1cyksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludFRleHQoYSksIHRoaXMucGFpbnRCb3JkZXIoYSksIHRoaXMucGFpbnRDdHJsKGEpLCB0aGlzLnBhaW50QWxhcm1UZXh0KGEpXHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnRBbGFybVRleHQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5hbGFybSAmJiBcIlwiICE9IHRoaXMuYWxhcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuYWxhcm1Db2xvciB8fCBcIjI1NSwwLDBcIiwgYyA9IHRoaXMuYWxhcm1BbHBoYSB8fCAuNTtcclxuICAgICAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmFsYXJtRm9udCB8fCBcIjEwcHgg5b6u6L2v6ZuF6buRXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhLm1lYXN1cmVUZXh0KHRoaXMuYWxhcm0pLndpZHRoICsgNiwgZSA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGggKyA2LCBmID0gdGhpcy53aWR0aCAvIDIgLSBkIC8gMiwgZyA9IC10aGlzLmhlaWdodCAvIDIgLSBlIC0gODtcclxuICAgICAgICAgICAgICAgICAgICBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgYiArIFwiLCBcIiArIGMgKyBcIilcIiwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyBiICsgXCIsIFwiICsgYyArIFwiKVwiLCBhLmxpbmVDYXAgPSBcInJvdW5kXCIsIGEubGluZVdpZHRoID0gMSwgYS5tb3ZlVG8oZiwgZyksIGEubGluZVRvKGYgKyBkLCBnKSwgYS5saW5lVG8oZiArIGQsIGcgKyBlKSwgYS5saW5lVG8oZiArIGQgLyAyICsgNiwgZyArIGUpLCBhLmxpbmVUbyhmICsgZCAvIDIsIGcgKyBlICsgOCksIGEubGluZVRvKGYgKyBkIC8gMiAtIDYsIGcgKyBlKSwgYS5saW5lVG8oZiwgZyArIGUpLCBhLmxpbmVUbyhmLCBnKSwgYS5maWxsKCksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIGEuYmVnaW5QYXRoKCksIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsVGV4dCh0aGlzLmFsYXJtLCBmICsgMiwgZyArIGUgLSA0KSwgYS5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCB0aGlzLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMudGV4dDtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGIgJiYgXCJcIiAhPSBiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKSwgYS5mb250ID0gdGhpcy5mb250O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gYS5tZWFzdXJlVGV4dChiKS53aWR0aCwgZCA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0VGV4dFBvc3Rpb24odGhpcy50ZXh0UG9zaXRpb24sIGMsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuZmlsbFRleHQoYiwgZS54LCBlLnkpLCBhLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnRCb3JkZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy5ib3JkZXJXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5saW5lV2lkdGggPSB0aGlzLmJvcmRlcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmJvcmRlckNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmJvcmRlcldpZHRoIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0aGlzLmJvcmRlclJhZGl1cyB8fCAwID09IHRoaXMuYm9yZGVyUmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEucmVjdCgtdGhpcy53aWR0aCAvIDIgLSBiLCAtdGhpcy5oZWlnaHQgLyAyIC0gYiwgdGhpcy53aWR0aCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuaGVpZ2h0ICsgdGhpcy5ib3JkZXJXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5KVG9wb1JvdW5kUmVjdCgtdGhpcy53aWR0aCAvIDIgLSBiLCAtdGhpcy5oZWlnaHQgLyAyIC0gYiwgdGhpcy53aWR0aCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuaGVpZ2h0ICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5ib3JkZXJSYWRpdXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBhLnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMuZ2V0VGV4dFBvc3Rpb24gPSBmdW5jdGlvbiAocG9zaXRpb24sIG1heFdpZHRoLCBmb250V2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChwb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJCb3R0b21fQ2VudGVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiAtdGhpcy53aWR0aCAvIDIgKyAodGhpcy53aWR0aCAtIG1heFdpZHRoKSAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmhlaWdodCAvIDIgKyBmb250V2lkdGhcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlRvcF9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IC10aGlzLndpZHRoIC8gMiArICh0aGlzLndpZHRoIC0gbWF4V2lkdGgpIC8gMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IC10aGlzLmhlaWdodCAvIDIgLSBmb250V2lkdGggLyAyIC0gZm9udFdpZHRoICogKGhlaWdodCAtIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJUb3BfUmlnaHRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogLXRoaXMuaGVpZ2h0IC8gMiAtIGZvbnRXaWR0aCAvIDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlRvcF9MZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiAtdGhpcy53aWR0aCAvIDIgLSBtYXhXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IC10aGlzLmhlaWdodCAvIDIgLSBmb250V2lkdGggLyAyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJCb3R0b21fUmlnaHRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJCb3R0b21fTGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogLXRoaXMud2lkdGggLyAyIC0gbWF4V2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmhlaWdodCAvIDIgKyBmb250V2lkdGhcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIk1pZGRsZV9DZW50ZXJcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IC10aGlzLndpZHRoIC8gMiArICh0aGlzLndpZHRoIC0gbWF4V2lkdGgpIC8gMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IGZvbnRXaWR0aCAvIDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIk1pZGRsZV9SaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBmb250V2lkdGggLyAyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJNaWRkbGVfTGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogLXRoaXMud2lkdGggLyAyIC0gbWF4V2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBmb250V2lkdGggLyAyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiAtdGhpcy53aWR0aCAvIDIgLSBtYXhXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IGZvbnRXaWR0aCAvIDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMudGV4dE9mZnNldFgpIHtcclxuICAgICAgICAgICAgICAgICAgICBkLnggKz0gdGhpcy50ZXh0T2Zmc2V0WFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQueSArPSB0aGlzLnRleHRPZmZzZXRZXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZDtcclxuICAgICAgICAgICAgfSwgdGhpcy5zZXRJbWFnZSA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBhKXRocm93IG5ldyBFcnJvcihcIk5vZGUuc2V0SW1hZ2UoKTog5Y+C5pWwSW1hZ2Xlr7nosaHkuLrnqbohXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGpbYV07XHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbCA9PSBkID8gKGQgPSBuZXcgSW1hZ2UsIGQuc3JjID0gYSwgZC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGpbYV0gPSBkLCAxID09IGIgJiYgYy5zZXRTaXplKGQud2lkdGgsIGQuaGVpZ2h0KSwgYy5pbWFnZSA9IGQsIGMuYWxhcm1Db2xvciA9IG51bGwgPT0gYy5hbGFybUNvbG9yID8gXCIyNTUsMCwwXCIgOiBjLmFsYXJtQ29sb3JcclxuICAgICAgICAgICAgICAgICAgICB9KSA6IChiICYmIHRoaXMuc2V0U2l6ZShkLndpZHRoLCBkLmhlaWdodCksIGMuaW1hZ2UgPSBkLCBjLmFsYXJtQ29sb3IgPSBudWxsID09IGMuYWxhcm1Db2xvciA/IFwiMjU1LDAsMFwiIDogYy5hbGFybUNvbG9yKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHRoaXMuaW1hZ2UgPSBhLCBjLmFsYXJtQ29sb3IgPSBudWxsID09IGMuYWxhcm1Db2xvciA/IFwiMjU1LDAsMFwiIDogYy5hbGFybUNvbG9yLCAxID09IGIgJiYgdGhpcy5zZXRTaXplKGEud2lkdGgsIGEuaGVpZ2h0KVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUhhbmRsZXIgPSBmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm91dExpbmtzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjLm5vZGVBID09PSBzZWxmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUoYylcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3V0TGlua3MgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5MaW5rcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5MaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMubm9kZVogPT09IHNlbGYgJiYgc2NlbmUucmVtb3ZlKGMpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbkxpbmtzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTm9kZSgpIHtcclxuICAgICAgICAgICAgTm9kZS5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBUZXh0Tm9kZShhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpLCB0aGlzLnRleHQgPSBhLCB0aGlzLmVsZW1lbnRUeXBlID0gXCJUZXh0Tm9kZVwiLCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udCwgdGhpcy53aWR0aCA9IGEubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCwgdGhpcy5oZWlnaHQgPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoLCBhLnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5mb250Q29sb3IgKyBcIiwgXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEuZmlsbFRleHQodGhpcy50ZXh0LCAtdGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0IC8gMiksIGEuY2xvc2VQYXRoKCksIHRoaXMucGFpbnRCb3JkZXIoYSksIHRoaXMucGFpbnRDdHJsKGEpLCB0aGlzLnBhaW50QWxhcm1UZXh0KGEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIExpbmtOb2RlKGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKCksIHRoaXMudGV4dCA9IGEsIHRoaXMuaHJlZiA9IGIsIHRoaXMudGFyZ2V0ID0gYywgdGhpcy5lbGVtZW50VHlwZSA9IFwiTGlua05vZGVcIiwgdGhpcy5pc1Zpc2l0ZWQgPSAhMSwgdGhpcy52aXNpdGVkQ29sb3IgPSBudWxsLCB0aGlzLnBhaW50ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udCwgdGhpcy53aWR0aCA9IGEubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCwgdGhpcy5oZWlnaHQgPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoLCB0aGlzLmlzVmlzaXRlZCAmJiBudWxsICE9IHRoaXMudmlzaXRlZENvbG9yID8gKGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnZpc2l0ZWRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnZpc2l0ZWRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIikgOiAoYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiKSwgYS5maWxsVGV4dCh0aGlzLnRleHQsIC10aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyKSwgdGhpcy5pc01vdXNlT3ZlciAmJiAoYS5tb3ZlVG8oLXRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCksIGEubGluZVRvKHRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCksIGEuc3Ryb2tlKCkpLCBhLmNsb3NlUGF0aCgpLCB0aGlzLnBhaW50Qm9yZGVyKGEpLCB0aGlzLnBhaW50Q3RybChhKSwgdGhpcy5wYWludEFsYXJtVGV4dChhKVxyXG4gICAgICAgICAgICB9LCB0aGlzLm1vdXNlbW92ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEgJiYgYS5sZW5ndGggPiAwKWZvciAodmFyIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKylhW2JdLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiXHJcbiAgICAgICAgICAgIH0pLCB0aGlzLm1vdXNlb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoYSAmJiBhLmxlbmd0aCA+IDApZm9yICh2YXIgYiA9IDA7IGIgPCBhLmxlbmd0aDsgYisrKWFbYl0uc3R5bGUuY3Vyc29yID0gXCJkZWZhdWx0XCJcclxuICAgICAgICAgICAgfSksIHRoaXMuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgXCJfYmxhbmtcIiA9PSB0aGlzLnRhcmdldCA/IHdpbmRvdy5vcGVuKHRoaXMuaHJlZikgOiBsb2NhdGlvbiA9IHRoaXMuaHJlZiwgdGhpcy5pc1Zpc2l0ZWQgPSAhMFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ2lyY2xlTm9kZSh0ZXh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZShhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLl9yYWRpdXMgPSAyMDtcclxuICAgICAgICAgICAgdGhpcy5iZWdpbkRlZ3JlZSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZW5kRGVncmVlID0gMiAqIE1hdGguUEk7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5yYWRpdXMsIHRoaXMuYmVnaW5EZWdyZWUsIHRoaXMuZW5kRGVncmVlLCAhMCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRUZXh0KGNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEJvcmRlcihjb250ZXh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRDdHJsKGNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFsYXJtVGV4dChjb250ZXh0KTtcclxuICAgICAgICAgICAgfSwgdGhpcy5wYWludFNlbGVjdGVkID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMTY4LDIwMiwyNTUsIDAuOSlcIjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKDE2OCwyMDIsMjM2LDAuNylcIjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMucmFkaXVzICsgMywgdGhpcy5iZWdpbkRlZ3JlZSwgdGhpcy5lbmREZWdyZWUsICEwKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbCgpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZyhhLCBiLCBjKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmZyYW1lSW1hZ2VzID0gYSB8fCBbXTtcclxuICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5pc1N0b3AgPSAhMDtcclxuICAgICAgICAgICAgdmFyIGQgPSBiIHx8IDFlMztcclxuICAgICAgICAgICAgdGhpcy5yZXBlYXRQbGF5ID0gITE7XHJcbiAgICAgICAgICAgIHZhciBlID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5uZXh0RnJhbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNTdG9wICYmIG51bGwgIT0gdGhpcy5mcmFtZUltYWdlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lSW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mcmFtZUluZGV4ID49IHRoaXMuZnJhbWVJbWFnZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yZXBlYXRQbGF5KXJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRJbWFnZSh0aGlzLmZyYW1lSW1hZ2VzW3RoaXMuZnJhbWVJbmRleF0sIGMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLm5leHRGcmFtZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGQgLyBhLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGgoYSwgYiwgYywgZCwgZSkge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICAgICAgICAgICAgdmFyIGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLnNldEltYWdlKGEpLCB0aGlzLmZyYW1lSW5kZXggPSAwLCB0aGlzLmlzUGF1c2UgPSAhMCwgdGhpcy5yZXBlYXRQbGF5ID0gITE7XHJcbiAgICAgICAgICAgIHZhciBnID0gZCB8fCAxZTM7XHJcbiAgICAgICAgICAgIGUgPSBlIHx8IDAsIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMud2lkdGgsIGQgPSB0aGlzLmhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZpbGxDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gKE1hdGguZmxvb3IodGhpcy5mcmFtZUluZGV4IC8gYykgKyBlKSAqIGQsIGcgPSBNYXRoLmZsb29yKHRoaXMuZnJhbWVJbmRleCAlIGMpICogYjtcclxuICAgICAgICAgICAgICAgICAgICBhLmRyYXdJbWFnZSh0aGlzLmltYWdlLCBnLCBmLCBiLCBkLCAtYiAvIDIsIC1kIC8gMiwgYiwgZCksIGEuZmlsbCgpLCBhLmNsb3NlUGF0aCgpLCBhLnJlc3RvcmUoKSwgdGhpcy5wYWludFRleHQoYSksIHRoaXMucGFpbnRCb3JkZXIoYSksIHRoaXMucGFpbnRDdHJsKGEpLCB0aGlzLnBhaW50QWxhcm1UZXh0KGEpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMubmV4dEZyYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzU3RvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyYW1lSW5kZXgrKywgdGhpcy5mcmFtZUluZGV4ID49IGIgKiBjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yZXBlYXRQbGF5KXJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4ID0gMFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZi5pc1N0b3AgfHwgZi5uZXh0RnJhbWUoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGcgLyAoYiAqIGMpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBBbmltYXRlTm9kZSgpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBudWxsO1xyXG4gICAgICAgICAgICByZXR1cm4gYSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMyA/IG5ldyBnKGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pIDogbmV3IGgoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSwgYXJndW1lbnRzWzNdLCBhcmd1bWVudHNbNF0sIGFyZ3VtZW50c1s1XSksIGEuc3RvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGEuaXNTdG9wID0gITBcclxuICAgICAgICAgICAgfSwgYS5wbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYS5pc1N0b3AgPSAhMSwgYS5mcmFtZUluZGV4ID0gMCwgYS5uZXh0RnJhbWUoKVxyXG4gICAgICAgICAgICB9LCBhXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaiA9IHt9O1xyXG4gICAgICAgIGJhc2VOb2RlLnByb3RvdHlwZSA9IG5ldyBqdG9wby5FZGl0YWJsZUVsZW1lbnQ7XHJcbiAgICAgICAgTm9kZS5wcm90b3R5cGUgPSBuZXcgYmFzZU5vZGU7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTm9kZS5wcm90b3R5cGUsIHtcclxuICAgICAgICAgICAgYWxhcm1Db2xvcjoge1xyXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FsYXJtQ29sb3JcclxuICAgICAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWxhcm1Db2xvciA9IGNvbG9yO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBqdG9wby51dGlsLmdlbkltYWdlQWxhcm0odGhpcy5pbWFnZSwgY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGFybUltYWdlID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFRleHROb2RlLnByb3RvdHlwZSA9IG5ldyBOb2RlO1xyXG4gICAgICAgIExpbmtOb2RlLnByb3RvdHlwZSA9IG5ldyBUZXh0Tm9kZTtcclxuICAgICAgICBDaXJjbGVOb2RlLnByb3RvdHlwZSA9IG5ldyBOb2RlO1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKENpcmNsZU5vZGUucHJvdG90eXBlLCB7XHJcbiAgICAgICAgICAgIHJhZGl1czoge1xyXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JhZGl1c1xyXG4gICAgICAgICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JhZGl1cyA9IGE7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSAyICogdGhpcy5yYWRpdXMsIGMgPSAyICogdGhpcy5yYWRpdXM7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IGIsIHRoaXMuaGVpZ2h0ID0gY1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCB3aWR0aDoge1xyXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoXHJcbiAgICAgICAgICAgICAgICB9LCBzZXQ6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmFkaXVzID0gYSAvIDIsIHRoaXMuX3dpZHRoID0gYVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBoZWlnaHQ6IHtcclxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHRcclxuICAgICAgICAgICAgICAgIH0sIHNldDogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yYWRpdXMgPSBhIC8gMiwgdGhpcy5faGVpZ2h0ID0gYVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZy5wcm90b3R5cGUgPSBuZXcgTm9kZTtcclxuICAgICAgICBoLnByb3RvdHlwZSA9IG5ldyBOb2RlO1xyXG4gICAgICAgIEFuaW1hdGVOb2RlLnByb3RvdHlwZSA9IG5ldyBOb2RlO1xyXG4gICAgICAgIGp0b3BvLk5vZGUgPSBOb2RlO1xyXG4gICAgICAgIGp0b3BvLlRleHROb2RlID0gVGV4dE5vZGU7XHJcbiAgICAgICAganRvcG8uTGlua05vZGUgPSBMaW5rTm9kZTtcclxuICAgICAgICBqdG9wby5DaXJjbGVOb2RlID0gQ2lyY2xlTm9kZTtcclxuICAgICAgICBqdG9wby5BbmltYXRlTm9kZSA9IEFuaW1hdGVOb2RlO1xyXG4gICAgfShKVG9wbyksXHJcbiAgICBmdW5jdGlvbiAoanRvcG8pIHtcclxuICAgICAgICBmdW5jdGlvbiBnZXRQdWJsaWNMaW5rKGVsZW1lbnRBLCBlbGVtZW50Qikge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IGVsZW1lbnRBIHx8IG51bGwgPT0gZWxlbWVudEIpcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnRBICYmIGVsZW1lbnRCICYmIGVsZW1lbnRBLm91dExpbmtzICYmIGVsZW1lbnRCLmluTGlua3MpXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRBLm91dExpbmtzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dExpbmsgPSBlbGVtZW50QS5vdXRMaW5rc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBmID0gMDsgZiA8IGVsZW1lbnRCLmluTGlua3MubGVuZ3RoOyBmKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlubGluayA9IGVsZW1lbnRCLmluTGlua3NbZl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdXRMaW5rID09PSBpbmxpbmspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGlubGluayk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldExpbmtzQmV0d2VlbihzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gZ2V0UHVibGljTGluayhzdGFydCwgZW5kKTtcclxuICAgICAgICAgICAgdmFyIGUgPSBnZXRQdWJsaWNMaW5rKGVuZCwgc3RhcnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZC5jb25jYXQoZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRMaW5rTm90VGhpcyhsaW5rKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gZ2V0TGlua3NCZXR3ZWVuKGxpbmsubm9kZUEsIGxpbmsubm9kZVopO1xyXG4gICAgICAgICAgICByZXR1cm4gYiA9IGIuZmlsdGVyKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGluayAhPT0gYlxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0TnVtcyhhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRMaW5rc0JldHdlZW4oYSwgYikubGVuZ3RoXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBMaW5rKGIsIGMsIGcpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gaChzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGluayA9IGp0b3BvLnV0aWwubGluZUYoc3RhcnQuY3gsIHN0YXJ0LmN5LCBlbmQuY3gsIGVuZC5jeSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm91bmQgPSBzdGFydC5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGp0b3BvLnV0aWwuaW50ZXJzZWN0aW9uTGluZUJvdW5kKGxpbmssIGJvdW5kKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChMaW5rLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuZWxlbWVudFR5cGUgPSBcImxpbmtcIiwgdGhpcy56SW5kZXggPSBqdG9wby56SW5kZXhfTGluaywgMCAhPSBhcmd1bWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0ID0gZDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVBID0gYjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVaID0gYztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVBICYmIG51bGwgPT0gdGhpcy5ub2RlQS5vdXRMaW5rcyAmJiAodGhpcy5ub2RlQS5vdXRMaW5rcyA9IFtdKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVBICYmIG51bGwgPT0gdGhpcy5ub2RlQS5pbkxpbmtzICYmICh0aGlzLm5vZGVBLmluTGlua3MgPSBbXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlWiAmJiBudWxsID09IHRoaXMubm9kZVouaW5MaW5rcyAmJiAodGhpcy5ub2RlWi5pbkxpbmtzID0gW10pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZVogJiYgbnVsbCA9PSB0aGlzLm5vZGVaLm91dExpbmtzICYmICh0aGlzLm5vZGVaLm91dExpbmtzID0gW10pO1xyXG4gICAgICAgICAgICAgICAgICAgIG51bGwgIT0gdGhpcy5ub2RlQSAmJiB0aGlzLm5vZGVBLm91dExpbmtzLnB1c2godGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSB0aGlzLm5vZGVaICYmIHRoaXMubm9kZVouaW5MaW5rcy5wdXNoKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjdWxhdGVJbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9udCA9IFwiMTJweCBDb25zb2xhc1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9udENvbG9yID0gXCIyNTUsMjU1LDI1NVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGluZVdpZHRoID0gMjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmVKb2luID0gXCJtaXRlclwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtQWJsZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnVuZGxlT2Zmc2V0ID0gMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idW5kbGVHYXAgPSAxMjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRPZmZzZXRZID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFycm93c1JhZGl1cyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcnJvd3NPZmZzZXQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGFzaGVkUGF0dGVybiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXRoID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBcInRleHQsZm9udCxmb250Q29sb3IsbGluZVdpZHRoLGxpbmVKb2luXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFByb3BlcnRpZXMgPSB0aGlzLnNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmNvbmNhdChlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCB0aGlzLmNhY3VsYXRlSW5kZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGdldE51bXModGhpcy5ub2RlQSwgdGhpcy5ub2RlWik7XHJcbiAgICAgICAgICAgICAgICBhID4gMCAmJiAodGhpcy5ub2RlSW5kZXggPSBhIC0gMSlcclxuICAgICAgICAgICAgfSwgdGhpcy5pbml0aWFsaXplKGIsIGMsIGcpLCB0aGlzLnJlbW92ZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVBICYmIHRoaXMubm9kZUEub3V0TGlua3MgJiYgKHRoaXMubm9kZUEub3V0TGlua3MgPSB0aGlzLm5vZGVBLm91dExpbmtzLmZpbHRlcihmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiICE9PSBhXHJcbiAgICAgICAgICAgICAgICB9KSksIHRoaXMubm9kZVogJiYgdGhpcy5ub2RlWi5pbkxpbmtzICYmICh0aGlzLm5vZGVaLmluTGlua3MgPSB0aGlzLm5vZGVaLmluTGlua3MuZmlsdGVyKGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIgIT09IGFcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gZ2V0TGlua05vdFRoaXModGhpcyk7XHJcbiAgICAgICAgICAgICAgICBiLmZvckVhY2goZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhLm5vZGVJbmRleCA9IGJcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0sIHRoaXMuZ2V0U3RhcnRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0ge3g6IHRoaXMubm9kZUEuY3gsIHk6IHRoaXMubm9kZUEuY3l9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFcclxuICAgICAgICAgICAgfSwgdGhpcy5nZXRFbmRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMgJiYgKGEgPSBoKHRoaXMubm9kZVosIHRoaXMubm9kZUEpKSwgbnVsbCA9PSBhICYmIChhID0ge3g6IHRoaXMubm9kZVouY3gsIHk6IHRoaXMubm9kZVouY3l9KSwgYVxyXG4gICAgICAgICAgICB9LCB0aGlzLmdldFBhdGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IFtdLCBiID0gdGhpcy5nZXRTdGFydFBvc2l0aW9uKCksIGMgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gW2IsIGNdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBnZXROdW1zKHRoaXMubm9kZUEsIHRoaXMubm9kZVopO1xyXG4gICAgICAgICAgICAgICAgaWYgKDEgPT0gZClyZXR1cm4gW2IsIGNdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBNYXRoLmF0YW4yKGMueSAtIGIueSwgYy54IC0gYi54KSwgZyA9IHt4OiBiLnggKyB0aGlzLmJ1bmRsZU9mZnNldCAqIE1hdGguY29zKGYpLCB5OiBiLnkgKyB0aGlzLmJ1bmRsZU9mZnNldCAqIE1hdGguc2luKGYpfSwgaCA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBjLnggKyB0aGlzLmJ1bmRsZU9mZnNldCAqIE1hdGguY29zKGYgLSBNYXRoLlBJKSxcclxuICAgICAgICAgICAgICAgICAgICB5OiBjLnkgKyB0aGlzLmJ1bmRsZU9mZnNldCAqIE1hdGguc2luKGYgLSBNYXRoLlBJKVxyXG4gICAgICAgICAgICAgICAgfSwgaSA9IGYgLSBNYXRoLlBJIC8gMiwgaiA9IGYgLSBNYXRoLlBJIC8gMiwgayA9IGQgKiB0aGlzLmJ1bmRsZUdhcCAvIDIgLSB0aGlzLmJ1bmRsZUdhcCAvIDIsIGwgPSB0aGlzLmJ1bmRsZUdhcCAqIHRoaXMubm9kZUluZGV4LCBtID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IGcueCArIGwgKiBNYXRoLmNvcyhpKSxcclxuICAgICAgICAgICAgICAgICAgICB5OiBnLnkgKyBsICogTWF0aC5zaW4oaSlcclxuICAgICAgICAgICAgICAgIH0sIG4gPSB7eDogaC54ICsgbCAqIE1hdGguY29zKGopLCB5OiBoLnkgKyBsICogTWF0aC5zaW4oail9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG0gPSB7eDogbS54ICsgayAqIE1hdGguY29zKGkgLSBNYXRoLlBJKSwgeTogbS55ICsgayAqIE1hdGguc2luKGkgLSBNYXRoLlBJKX0sIG4gPSB7eDogbi54ICsgayAqIE1hdGguY29zKGogLSBNYXRoLlBJKSwgeTogbi55ICsgayAqIE1hdGguc2luKGogLSBNYXRoLlBJKX0sIGEucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogYi54LFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IGIueVxyXG4gICAgICAgICAgICAgICAgfSksIGEucHVzaCh7eDogbS54LCB5OiBtLnl9KSwgYS5wdXNoKHt4OiBuLngsIHk6IG4ueX0pLCBhLnB1c2goe3g6IGMueCwgeTogYy55fSksIGFcclxuICAgICAgICAgICAgfSwgdGhpcy5wYWludFBhdGggPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLm1vdmVUbyhiWzBdLngsIGJbMF0ueSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMTsgYyA8IGIubGVuZ3RoOyBjKyspbnVsbCA9PSB0aGlzLmRhc2hlZFBhdHRlcm4gPyBhLmxpbmVUbyhiW2NdLngsIGJbY10ueSkgOiBhLkpUb3BvRGFzaGVkTGluZVRvKGJbYyAtIDFdLngsIGJbYyAtIDFdLnksIGJbY10ueCwgYltjXS55LCB0aGlzLmRhc2hlZFBhdHRlcm4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGJbYi5sZW5ndGggLSAyXSwgZSA9IGJbYi5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgZCwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgdGhpcy5wYWludExvb3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuYnVuZGxlR2FwICogKHRoaXMubm9kZUluZGV4ICsgMSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIE1hdGguUEkgKyBNYXRoLlBJIC8gMlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYS5hcmModGhpcy5ub2RlQS54LCB0aGlzLm5vZGVBLnksIGIsIE1hdGguUEkgLyAyLCAyICogTWF0aC5QSSksIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgfSwgdGhpcy5wYWludEFycm93ID0gZnVuY3Rpb24gKGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5hcnJvd3NPZmZzZXQsIGYgPSB0aGlzLmFycm93c1JhZGl1cyAvIDIsIGcgPSBjLCBoID0gZCwgaSA9IE1hdGguYXRhbjIoaC55IC0gZy55LCBoLnggLSBnLngpLCBqID0ganRvcG8udXRpbC5nZXREaXN0YW5jZShnLCBoKSAtIHRoaXMuYXJyb3dzUmFkaXVzLCBrID0gZy54ICsgKGogKyBlKSAqIE1hdGguY29zKGkpLCBsID0gZy55ICsgKGogKyBlKSAqIE1hdGguc2luKGkpLCBtID0gaC54ICsgZSAqIE1hdGguY29zKGkpLCBuID0gaC55ICsgZSAqIE1hdGguc2luKGkpO1xyXG4gICAgICAgICAgICAgICAgaSAtPSBNYXRoLlBJIC8gMjtcclxuICAgICAgICAgICAgICAgIHZhciBvID0ge3g6IGsgKyBmICogTWF0aC5jb3MoaSksIHk6IGwgKyBmICogTWF0aC5zaW4oaSl9LCBwID0ge3g6IGsgKyBmICogTWF0aC5jb3MoaSAtIE1hdGguUEkpLCB5OiBsICsgZiAqIE1hdGguc2luKGkgLSBNYXRoLlBJKX07XHJcbiAgICAgICAgICAgICAgICBiLmJlZ2luUGF0aCgpLCBiLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3Ryb2tlQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYi5tb3ZlVG8oby54LCBvLnkpLCBiLmxpbmVUbyhtLCBuKSwgYi5saW5lVG8ocC54LCBwLnkpLCBiLnN0cm9rZSgpLCBiLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5ub2RlQSAmJiBudWxsICE9ICF0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmdldFBhdGgodGhpcy5ub2RlSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGF0aCA9IGIsIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLnN0cm9rZUNvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGgsIHRoaXMucGFpbnRQYXRoKGEsIGIpLCBiICYmIGIubGVuZ3RoID4gMCAmJiB0aGlzLnBhaW50VGV4dChhLCBiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgaSA9IC0oTWF0aC5QSSAvIDIgKyBNYXRoLlBJIC8gNCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRUZXh0ID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gYlswXSwgZCA9IGJbYi5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgIGlmICg0ID09IGIubGVuZ3RoICYmIChjID0gYlsxXSwgZCA9IGJbMl0pLCB0aGlzLnRleHQgJiYgdGhpcy50ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IChkLnggKyBjLngpIC8gMiArIHRoaXMudGV4dE9mZnNldFgsIGYgPSAoZC55ICsgYy55KSAvIDIgKyB0aGlzLnRleHRPZmZzZXRZO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc2F2ZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBhLm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGgsIGggPSBhLm1lYXN1cmVUZXh0KFwi55SwXCIpLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiLCB0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqID0gdGhpcy5idW5kbGVHYXAgKiAodGhpcy5ub2RlSW5kZXggKyAxKSAvIDIsIGUgPSB0aGlzLm5vZGVBLnggKyBqICogTWF0aC5jb3MoaSksIGYgPSB0aGlzLm5vZGVBLnkgKyBqICogTWF0aC5zaW4oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuZmlsbFRleHQodGhpcy50ZXh0LCBlLCBmKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBhLmZpbGxUZXh0KHRoaXMudGV4dCwgZSAtIGcgLyAyLCBmIC0gaCAvIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBhLnNoYWRvd0JsdXIgPSAxMCwgYS5zaGFkb3dDb2xvciA9IFwicmdiYSgwLDAsMCwxKVwiLCBhLnNoYWRvd09mZnNldFggPSAwLCBhLnNoYWRvd09mZnNldFkgPSAwXHJcbiAgICAgICAgICAgIH0sIHRoaXMuaXNJbkJvdW5kID0gZnVuY3Rpb24gKGIsIGMpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVBID09PSB0aGlzLm5vZGVaKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmJ1bmRsZUdhcCAqICh0aGlzLm5vZGVJbmRleCArIDEpIC8gMiwgZSA9IGp0b3BvLnV0aWwuZ2V0RGlzdGFuY2UodGhpcy5ub2RlQSwge3g6IGIsIHk6IGN9KSAtIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKGUpIDw9IDNcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGYgPSAhMSwgZyA9IDE7IGcgPCB0aGlzLnBhdGgubGVuZ3RoOyBnKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IHRoaXMucGF0aFtnIC0gMV0sIGkgPSB0aGlzLnBhdGhbZ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0ganRvcG8udXRpbC5pc1BvaW50SW5MaW5lKHt4OiBiLCB5OiBjfSwgaCwgaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEZvbGRMaW5rKGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgRm9sZExpbmsucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5kaXJlY3Rpb24gPSBcImhvcml6b250YWxcIlxyXG4gICAgICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoYSwgYiwgYyksIHRoaXMuZ2V0U3RhcnRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0ge3g6IHRoaXMubm9kZUEuY3gsIHk6IHRoaXMubm9kZUEuY3l9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uID8gdGhpcy5ub2RlWi5jeCA+IGEueCA/IGEueCArPSB0aGlzLm5vZGVBLndpZHRoIC8gMiA6IGEueCAtPSB0aGlzLm5vZGVBLndpZHRoIC8gMiA6IHRoaXMubm9kZVouY3kgPiBhLnkgPyBhLnkgKz0gdGhpcy5ub2RlQS5oZWlnaHQgLyAyIDogYS55IC09IHRoaXMubm9kZUEuaGVpZ2h0IC8gMiwgYVxyXG4gICAgICAgICAgICB9LCB0aGlzLmdldEVuZFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSB7eDogdGhpcy5ub2RlWi5jeCwgeTogdGhpcy5ub2RlWi5jeX07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJob3Jpem9udGFsXCIgPT0gdGhpcy5kaXJlY3Rpb24gPyB0aGlzLm5vZGVBLmN5IDwgYS55ID8gYS55IC09IHRoaXMubm9kZVouaGVpZ2h0IC8gMiA6IGEueSArPSB0aGlzLm5vZGVaLmhlaWdodCAvIDIgOiBhLnggPSB0aGlzLm5vZGVBLmN4IDwgYS54ID8gdGhpcy5ub2RlWi54IDogdGhpcy5ub2RlWi54ICsgdGhpcy5ub2RlWi53aWR0aCwgYVxyXG4gICAgICAgICAgICB9LCB0aGlzLmdldFBhdGggPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBbXSwgYyA9IHRoaXMuZ2V0U3RhcnRQb3NpdGlvbigpLCBkID0gdGhpcy5nZXRFbmRQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIFtjLCBkXTtcclxuICAgICAgICAgICAgICAgIHZhciBmLCBnLCBoID0gZ2V0TnVtcyh0aGlzLm5vZGVBLCB0aGlzLm5vZGVaKSwgaSA9IChoIC0gMSkgKiB0aGlzLmJ1bmRsZUdhcCwgaiA9IHRoaXMuYnVuZGxlR2FwICogYSAtIGkgLyAyO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaG9yaXpvbnRhbFwiID09IHRoaXMuZGlyZWN0aW9uID8gKGYgPSBkLnggKyBqLCBnID0gYy55IC0gaiwgYi5wdXNoKHt4OiBjLngsIHk6IGd9KSwgYi5wdXNoKHt4OiBmLCB5OiBnfSksIGIucHVzaCh7eDogZiwgeTogZC55fSkpIDogKGYgPSBjLnggKyBqLCBnID0gZC55IC0gaiwgYi5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBmLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IGMueVxyXG4gICAgICAgICAgICAgICAgfSksIGIucHVzaCh7eDogZiwgeTogZ30pLCBiLnB1c2goe3g6IGQueCwgeTogZ30pKSwgYlxyXG4gICAgICAgICAgICB9LCB0aGlzLnBhaW50VGV4dCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0ICYmIHRoaXMudGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiWzFdLCBkID0gYy54ICsgdGhpcy50ZXh0T2Zmc2V0WCwgZSA9IGMueSArIHRoaXMudGV4dE9mZnNldFk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGEubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCwgZyA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5maWxsVGV4dCh0aGlzLnRleHQsIGQgLSBmIC8gMiwgZSAtIGcgLyAyKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRmxleGlvbmFsTGluayhhLCBiLCBjKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIEZsZXhpb25hbExpbmsucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5kaXJlY3Rpb24gPSBcInZlcnRpY2FsXCIsIHRoaXMub2Zmc2V0R2FwID0gNDRcclxuICAgICAgICAgICAgfSwgdGhpcy5pbml0aWFsaXplKGEsIGIsIGMpLCB0aGlzLmdldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHt4OiB0aGlzLm5vZGVBLmN4LCB5OiB0aGlzLm5vZGVBLmN5fTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbiA/IGEueCA9IHRoaXMubm9kZVouY3ggPCBhLnggPyB0aGlzLm5vZGVBLnggOiB0aGlzLm5vZGVBLnggKyB0aGlzLm5vZGVBLndpZHRoIDogYS55ID0gdGhpcy5ub2RlWi5jeSA8IGEueSA/IHRoaXMubm9kZUEueSA6IHRoaXMubm9kZUEueSArIHRoaXMubm9kZUEuaGVpZ2h0LCBhXHJcbiAgICAgICAgICAgIH0sIHRoaXMuZ2V0RW5kUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHt4OiB0aGlzLm5vZGVaLmN4LCB5OiB0aGlzLm5vZGVaLmN5fTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbiA/IGEueCA9IHRoaXMubm9kZUEuY3ggPCBhLnggPyB0aGlzLm5vZGVaLnggOiB0aGlzLm5vZGVaLnggKyB0aGlzLm5vZGVaLndpZHRoIDogYS55ID0gdGhpcy5ub2RlQS5jeSA8IGEueSA/IHRoaXMubm9kZVoueSA6IHRoaXMubm9kZVoueSArIHRoaXMubm9kZVouaGVpZ2h0LCBhXHJcbiAgICAgICAgICAgIH0sIHRoaXMuZ2V0UGF0aCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuZ2V0U3RhcnRQb3NpdGlvbigpLCBjID0gdGhpcy5nZXRFbmRQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIFtiLCBjXTtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gW10sIGYgPSBnZXROdW1zKHRoaXMubm9kZUEsIHRoaXMubm9kZVopLCBnID0gKGYgLSAxKSAqIHRoaXMuYnVuZGxlR2FwLCBoID0gdGhpcy5idW5kbGVHYXAgKiBhIC0gZyAvIDIsIGkgPSB0aGlzLm9mZnNldEdhcDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImhvcml6b250YWxcIiA9PSB0aGlzLmRpcmVjdGlvbiA/ICh0aGlzLm5vZGVBLmN4ID4gdGhpcy5ub2RlWi5jeCAmJiAoaSA9IC1pKSwgZC5wdXNoKHt4OiBiLngsIHk6IGIueSArIGh9KSwgZC5wdXNoKHt4OiBiLnggKyBpLCB5OiBiLnkgKyBofSksIGQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogYy54IC0gaSxcclxuICAgICAgICAgICAgICAgICAgICB5OiBjLnkgKyBoXHJcbiAgICAgICAgICAgICAgICB9KSwgZC5wdXNoKHt4OiBjLngsIHk6IGMueSArIGh9KSkgOiAodGhpcy5ub2RlQS5jeSA+IHRoaXMubm9kZVouY3kgJiYgKGkgPSAtaSksIGQucHVzaCh7eDogYi54ICsgaCwgeTogYi55fSksIGQucHVzaCh7eDogYi54ICsgaCwgeTogYi55ICsgaX0pLCBkLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IGMueCArIGgsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogYy55IC0gaVxyXG4gICAgICAgICAgICAgICAgfSksIGQucHVzaCh7eDogYy54ICsgaCwgeTogYy55fSkpLCBkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEN1cnZlTGluayhhLCBiLCBjKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIEN1cnZlTGluay5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpXHJcbiAgICAgICAgICAgIH0sIHRoaXMuaW5pdGlhbGl6ZShhLCBiLCBjKSwgdGhpcy5wYWludFBhdGggPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLm1vdmVUbyhiWzBdLngsIGJbMF0ueSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMTsgYyA8IGIubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGJbYyAtIDFdLCBlID0gYltjXSwgZiA9IChkLnggKyBlLngpIC8gMiwgZyA9IChkLnkgKyBlLnkpIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICBnICs9IChlLnkgLSBkLnkpIC8gMiwgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3Ryb2tlQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIiwgYS5saW5lV2lkdGggPSB0aGlzLmxpbmVXaWR0aCwgYS5tb3ZlVG8oZC54LCBkLmN5KSwgYS5xdWFkcmF0aWNDdXJ2ZVRvKGYsIGcsIGUueCwgZS55KSwgYS5zdHJva2UoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGEuc3Ryb2tlKCksIGEuY2xvc2VQYXRoKCksIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IGJbYi5sZW5ndGggLSAyXSwgaSA9IGJbYi5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgaCwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgTGluay5wcm90b3R5cGUgPSBuZXcganRvcG8uSW50ZXJhY3RpdmVFbGVtZW50O1xyXG4gICAgICAgIEZvbGRMaW5rLnByb3RvdHlwZSA9IG5ldyBMaW5rO1xyXG4gICAgICAgIEZsZXhpb25hbExpbmsucHJvdG90eXBlID0gbmV3IExpbms7XHJcbiAgICAgICAgQ3VydmVMaW5rLnByb3RvdHlwZSA9IG5ldyBMaW5rO1xyXG4gICAgICAgIGp0b3BvLkxpbmsgPSBMaW5rO1xyXG4gICAgICAgIGp0b3BvLkZvbGRMaW5rID0gRm9sZExpbms7XHJcbiAgICAgICAganRvcG8uRmxleGlvbmFsTGluayA9IEZsZXhpb25hbExpbms7XHJcbiAgICAgICAganRvcG8uQ3VydmVMaW5rID0gQ3VydmVMaW5rO1xyXG4gICAgfShKVG9wbyksXHJcbiAgICBmdW5jdGlvbiAoanRvcG8pIHtcclxuICAgICAgICBmdW5jdGlvbiBjb250YWluZXIoYykge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIG51bGwpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBcImNvbnRhaW5lclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuekluZGV4ID0ganRvcG8uekluZGV4X0NvbnRhaW5lcixcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gMTAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gMTAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRzID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbHBoYSA9IC41LFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhZ2FibGUgPSAhMCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkRHJhZ2JsZSA9ICEwLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9ICEwLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsbENvbG9yID0gXCIxMCwxMDAsODBcIixcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvcmRlcldpZHRoID0gMCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvcmRlckNvbG9yID0gXCIyNTUsMjU1LDI1NVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9yZGVyUmFkaXVzID0gbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvbnQgPSBcIjEycHggQ29uc29sYXNcIixcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvbnRDb2xvciA9IFwiMjU1LDI1NSwyNTVcIixcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHQgPSBjLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dFBvc2l0aW9uID0gXCJCb3R0b21fQ2VudGVyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0T2Zmc2V0WCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0T2Zmc2V0WSA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXlvdXQgPSBuZXcganRvcG8ubGF5b3V0LkF1dG9Cb3VuZExheW91dFxyXG4gICAgICAgICAgICB9LCB0aGlzLmluaXRpYWxpemUoYyksIHRoaXMuYWRkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRzLnB1c2goYSksIGEuZHJhZ2FibGUgPSB0aGlzLmNoaWxkRHJhZ2JsZVxyXG4gICAgICAgICAgICB9LCB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHRoaXMuY2hpbGRzLmxlbmd0aDsgYisrKWlmICh0aGlzLmNoaWxkc1tiXSA9PT0gYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGEucGFyZW50Q29udGFpbmVyID0gbnVsbCwgdGhpcy5jaGlsZHMgPSB0aGlzLmNoaWxkcy5kZWwoYiksIGEubGFzdFBhcmVudENvbnRhaW5lciA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgdGhpcy5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcyA9IFtdXHJcbiAgICAgICAgICAgIH0sIHRoaXMuc2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBhIC0gdGhpcy54LCBkID0gYiAtIHRoaXMueTtcclxuICAgICAgICAgICAgICAgIHRoaXMueCA9IGEsIHRoaXMueSA9IGI7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5xdG9wbyAmJiB0aGlzLnF0b3BvLmF0dHIgJiYgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdG9wby5hdHRyLnBvc2l0aW9uWzBdID0gYTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnF0b3BvLmF0dHIucG9zaXRpb25bMV0gPSBiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLmNoaWxkcy5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gdGhpcy5jaGlsZHNbZV07XHJcbiAgICAgICAgICAgICAgICAgICAgZi5zZXRMb2NhdGlvbihmLnggKyBjLCBmLnkgKyBkKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCB0aGlzLmRvTGF5b3V0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGEgJiYgYSh0aGlzLCB0aGlzLmNoaWxkcylcclxuICAgICAgICAgICAgfSwgdGhpcy5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubGF5b3V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGF5b3V0KHRoaXMsIHRoaXMuY2hpbGRzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZmlsbENvbG9yICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5ib3JkZXJSYWRpdXMgfHwgMCA9PSB0aGlzLmJvcmRlclJhZGl1cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLnJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLkpUb3BvUm91bmRSZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgdGhpcy5ib3JkZXJSYWRpdXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBhLmZpbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFpbnRUZXh0KGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFpbnRCb3JkZXIoYSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnRCb3JkZXIgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gdGhpcy5ib3JkZXJXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGEuYmVnaW5QYXRoKCksIGEubGluZVdpZHRoID0gdGhpcy5ib3JkZXJXaWR0aCwgYS5zdHJva2VTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuYm9yZGVyQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuYm9yZGVyV2lkdGggLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIG51bGwgPT0gdGhpcy5ib3JkZXJSYWRpdXMgfHwgMCA9PSB0aGlzLmJvcmRlclJhZGl1cyA/IGEucmVjdCh0aGlzLnggLSBiLCB0aGlzLnkgLSBiLCB0aGlzLndpZHRoICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5oZWlnaHQgKyB0aGlzLmJvcmRlcldpZHRoKSA6IGEuSlRvcG9Sb3VuZFJlY3QodGhpcy54IC0gYiwgdGhpcy55IC0gYiwgdGhpcy53aWR0aCArIHRoaXMuYm9yZGVyV2lkdGgsIHRoaXMuaGVpZ2h0ICsgdGhpcy5ib3JkZXJXaWR0aCwgdGhpcy5ib3JkZXJSYWRpdXMpLCBhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnRUZXh0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy50ZXh0O1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gYiAmJiBcIlwiICE9IGIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhLm1lYXN1cmVUZXh0KGIpLndpZHRoLCBkID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5nZXRUZXh0UG9zdGlvbih0aGlzLnRleHRQb3NpdGlvbiwgYywgZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5maWxsVGV4dChiLCBlLngsIGUueSksIGEuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgdGhpcy5nZXRUZXh0UG9zdGlvbiA9IGZ1bmN0aW9uICh0ZXh0UG9zaXRpb24sIG1heFdpZHRoLCBmb250V2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGwgPT0gdGV4dFBvc2l0aW9uIHx8IFwiQm90dG9tX0NlbnRlclwiID09IHRleHRQb3NpdGlvbiA/IGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIgLSBtYXhXaWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgKyBmb250V2lkdGhcclxuICAgICAgICAgICAgICAgIH0gOiBcIlRvcF9DZW50ZXJcIiA9PSB0ZXh0UG9zaXRpb24gPyBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyIC0gbWF4V2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHRoaXMueSAtIGZvbnRXaWR0aCAvIDIgLSBmb250V2lkdGggKiAoaGVpZ2h0IC0gMSlcclxuICAgICAgICAgICAgICAgIH0gOiBcIlRvcF9SaWdodFwiID09IHRleHRQb3NpdGlvbiA/IGQgPSB7eDogdGhpcy54ICsgdGhpcy53aWR0aCAtIG1heFdpZHRoLCB5OiB0aGlzLnkgLSBmb250V2lkdGggLyAyfSA6IFwiVG9wX0xlZnRcIiA9PSB0ZXh0UG9zaXRpb24gPyBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCxcclxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgLSBmb250V2lkdGggLyAyXHJcbiAgICAgICAgICAgICAgICB9IDogXCJCb3R0b21fUmlnaHRcIiA9PSB0ZXh0UG9zaXRpb24gPyBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLSBtYXhXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCArIGZvbnRXaWR0aFxyXG4gICAgICAgICAgICAgICAgfSA6IFwiQm90dG9tX0xlZnRcIiA9PSB0ZXh0UG9zaXRpb24gPyBkID0ge3g6IHRoaXMueCwgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgKyBmb250V2lkdGh9IDogXCJNaWRkbGVfQ2VudGVyXCIgPT0gdGV4dFBvc2l0aW9uID8gZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyB0aGlzLndpZHRoIC8gMiAtIG1heFdpZHRoIC8gMixcclxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDIgKyBmb250V2lkdGggLyAyXHJcbiAgICAgICAgICAgICAgICB9IDogXCJNaWRkbGVfUmlnaHRcIiA9PSB0ZXh0UG9zaXRpb24gPyBkID0ge3g6IHRoaXMueCArIHRoaXMud2lkdGggLSBtYXhXaWR0aCwgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQgLyAyICsgZm9udFdpZHRoIC8gMn0gOiBcIk1pZGRsZV9MZWZ0XCIgPT0gdGV4dFBvc2l0aW9uICYmIChkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMueCxcclxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDIgKyBmb250V2lkdGggLyAyXHJcbiAgICAgICAgICAgICAgICB9KSwgbnVsbCAhPSB0aGlzLnRleHRPZmZzZXRYICYmIChkLnggKz0gdGhpcy50ZXh0T2Zmc2V0WCksIG51bGwgIT0gdGhpcy50ZXh0T2Zmc2V0WSAmJiAoZC55ICs9IHRoaXMudGV4dE9mZnNldFkpLCBkXHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnRNb3VzZW92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIH0sIHRoaXMucGFpbnRTZWxlY3RlZCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBhLnNoYWRvd0JsdXIgPSAxMCwgYS5zaGFkb3dDb2xvciA9IFwicmdiYSgwLDAsMCwxKVwiLCBhLnNoYWRvd09mZnNldFggPSAwLCBhLnNoYWRvd09mZnNldFkgPSAwXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnRhaW5lci5wcm90b3R5cGUgPSBuZXcganRvcG8uSW50ZXJhY3RpdmVFbGVtZW50O1xyXG4gICAgICAgIGp0b3BvLkNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgIH0oSlRvcG8pLFxyXG4gICAgZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0Tm9kZXNDZW50ZXIoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IDAsIGMgPSAwO1xyXG4gICAgICAgICAgICBhLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGIgKz0gYS5jeCwgYyArPSBhLmN5XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgZCA9IHt4OiBiIC8gYS5sZW5ndGgsIHk6IGMgLyBhLmxlbmd0aH07XHJcbiAgICAgICAgICAgIHJldHVybiBkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaXJjbGVMYXlvdXROb2Rlcyhub2RlQXJyYXksIGFuaW1hdGVDb25maWcpIHtcclxuICAgICAgICAgICAgbnVsbCA9PSBhbmltYXRlQ29uZmlnICYmIChhbmltYXRlQ29uZmlnID0ge30pO1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IGFuaW1hdGVDb25maWcuY3gsXHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGFuaW1hdGVDb25maWcuY3ksXHJcbiAgICAgICAgICAgICAgICAgICAgZyA9IGFuaW1hdGVDb25maWcubWluUmFkaXVzLFxyXG4gICAgICAgICAgICAgICAgICAgIGggPSBhbmltYXRlQ29uZmlnLm5vZGVEaWFtZXRlcixcclxuICAgICAgICAgICAgICAgICAgICBpID0gYW5pbWF0ZUNvbmZpZy5oU2NhbGUgfHwgMSxcclxuICAgICAgICAgICAgICAgICAgICBqID0gYW5pbWF0ZUNvbmZpZy52U2NhbGUgfHwgMTtcclxuICAgICAgICAgICAgICAgIGFuaW1hdGVDb25maWcuYmVnaW5BbmdsZSB8fCAwLCBhbmltYXRlQ29uZmlnLmVuZEFuZ2xlIHx8IDIgKiBNYXRoLlBJXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG51bGwgPT0gZSB8fCBudWxsID09IGYpIHtcclxuICAgICAgICAgICAgICAgIHZhciBrID0gZ2V0Tm9kZXNDZW50ZXIobm9kZUFycmF5KTtcclxuICAgICAgICAgICAgICAgIGUgPSBrLngsIGYgPSBrLnlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbCA9IDAsIG0gPSBbXSwgbiA9IFtdO1xyXG4gICAgICAgICAgICBub2RlQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICAgICAgbnVsbCA9PSBhbmltYXRlQ29uZmlnLm5vZGVEaWFtZXRlciA/IChub2RlLmRpYW1ldGVyICYmIChoID0gbm9kZS5kaWFtZXRlciksXHJcbiAgICAgICAgICAgICAgICAgICAgaCA9IG5vZGUucmFkaXVzID8gMiAqIG5vZGUucmFkaXVzIDogTWF0aC5zcXJ0KDIgKiBub2RlLndpZHRoICogbm9kZS5oZWlnaHQpLFxyXG4gICAgICAgICAgICAgICAgICAgIG4ucHVzaChoKSkgOiBuLnB1c2goaCksIGwgKz0gaFxyXG4gICAgICAgICAgICB9KSwgbm9kZUFycmF5LmZvckVhY2goZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gbltiXSAvIGw7XHJcbiAgICAgICAgICAgICAgICBtLnB1c2goTWF0aC5QSSAqIGMpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgbyA9IChub2RlQXJyYXkubGVuZ3RoLCBtWzBdICsgbVsxXSksIHAgPSBuWzBdIC8gMiArIG5bMV0gLyAyLCBxID0gcCAvIDIgLyBNYXRoLnNpbihvIC8gMik7XHJcbiAgICAgICAgICAgIG51bGwgIT0gZyAmJiBnID4gcSAmJiAocSA9IGcpO1xyXG4gICAgICAgICAgICB2YXIgciA9IHEgKiBpLCBzID0gcSAqIGosIHQgPSBhbmltYXRlQ29uZmlnLmFuaW1hdGU7XHJcbiAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IHQudGltZSB8fCAxZTMsIHYgPSAwO1xyXG4gICAgICAgICAgICAgICAgbm9kZUFycmF5LmZvckVhY2goZnVuY3Rpb24gKG5vZGUsIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2ICs9IDAgPT0gYyA/IG1bY10gOiBtW2MgLSAxXSArIG1bY107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBlICsgTWF0aC5jb3ModikgKiByLCBnID0gZiArIE1hdGguc2luKHYpICogcztcclxuICAgICAgICAgICAgICAgICAgICBqdG9wby5BbmltYXRlLnN0ZXBCeVN0ZXAobm9kZSwge3g6IGQgLSBub2RlLndpZHRoIC8gMiwgeTogZyAtIG5vZGUuaGVpZ2h0IC8gMn0sIHRpbWUpLnN0YXJ0KClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdiA9IDA7XHJcbiAgICAgICAgICAgICAgICBub2RlQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHYgKz0gMCA9PSBiID8gbVtiXSA6IG1bYiAtIDFdICsgbVtiXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGUgKyBNYXRoLmNvcyh2KSAqIHIsIGQgPSBmICsgTWF0aC5zaW4odikgKiBzO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuY3ggPSBjLCBhLmN5ID0gZFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ge2N4OiBlLCBjeTogZiwgcmFkaXVzOiByLCByYWRpdXNBOiByLCByYWRpdXNCOiBzfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gR3JpZExheW91dChyb3csIGNvbHVtbikge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IGNvbnRhaW5lci5jaGlsZHM7XHJcbiAgICAgICAgICAgICAgICBpZiAoIShjaGlsZHMubGVuZ3RoIDw9IDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNCb3VuZCA9IGNvbnRhaW5lci5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZE5vZGUgPSBjaGlsZHNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtU3BhY2UgPSAoY0JvdW5kLndpZHRoIC0gY2hpbGROb2RlLndpZHRoKSAvIGNvbHVtbjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcm93U3BhY2UgPSAoY0JvdW5kLmhlaWdodCAtIGNoaWxkTm9kZS5oZWlnaHQpIC8gcm93O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGNoaWxkSW5kZXggPSAwLCByb3dzSW5kZXggPSAwOyByb3cgPiByb3dzSW5kZXg7IHJvd3NJbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGNvbHVtbkluZGV4ID0gMDsgY29sdW1uID4gY29sdW1uSW5kZXg7IGNvbHVtbkluZGV4KyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gY2hpbGRzW2NoaWxkSW5kZXgrK107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGNCb3VuZC5sZWZ0ICsgY29sdW1TcGFjZSAvIDIgKyBjb2x1bW5JbmRleCAqIGNvbHVtU3BhY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGNCb3VuZC50b3AgKyByb3dTcGFjZSAvIDIgKyByb3dzSW5kZXggKiByb3dTcGFjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0TG9jYXRpb24oeCwgeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRJbmRleCA+PSBjaGlsZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBGbG93TGF5b3V0KHJvdywgY29sdW1uKSB7XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IGNvbHVtbikge1xyXG4gICAgICAgICAgICAgICAgY29sdW1uID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSByb3cpIHtcclxuICAgICAgICAgICAgICAgIHJvdyA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZHMgPSBjb250YWluZXIuY2hpbGRzO1xyXG4gICAgICAgICAgICAgICAgaWYgKCEoY2hpbGRzLmxlbmd0aCA8PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBib3VuZCA9IGNvbnRhaW5lci5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsZWZ0ID0gYm91bmQubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gYm91bmQudG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IGNoaWxkc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlZnQgKyBjaGlsZC53aWR0aCA+PSBib3VuZC5yaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IGJvdW5kLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3AgKz0gcm93ICsgY2hpbGQuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLnNldExvY2F0aW9uKGxlZnQsIHRvcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQgKz0gY29sdW1uICsgY2hpbGQud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBBdXRvQm91bmRMYXlvdXQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoY29udGFpbmVyLCBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVmdCA9IDFlNyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQgPSAtMWU3LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSAxZTcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbSA9IC0xZTcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gcmlnaHQgLSBsZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBib3R0b20gLSB0b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBjaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQueCA8PSBsZWZ0ICYmIChsZWZ0ID0gY2hpbGQueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChjaGlsZC54ICsgY2hpbGQud2lkdGgpID49IHJpZ2h0ICYmIChyaWdodCA9IGNoaWxkLnggKyBjaGlsZC53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLnkgPD0gdG9wICYmICh0b3AgPSBjaGlsZC55KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGNoaWxkLnkgKyBjaGlsZC5oZWlnaHQpID49IGJvdHRvbSAmJiAoYm90dG9tID0gY2hpbGQueSArIGNoaWxkLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBib3R0b20gLSB0b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci54ID0gbGVmdDtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIueSA9IHRvcDtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIud2lkdGggPSAxMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmhlaWdodCA9IDEwMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIucXRvcG8pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIucXRvcG8uYXR0ci5zaXplWzBdID0gY29udGFpbmVyLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5xdG9wby5hdHRyLnNpemVbMV0gPSBjb250YWluZXIuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmib7liLDlj6/ku6XkvZzkuLrmoLnnmoToioLngrlcclxuICAgICAgICAgKiAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldFJvb3ROb2RlcyhlbGVtZW50cykge1xyXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGVsZW1lbnQgaW5zdGFuY2VvZiBqdG9wby5Ob2RlKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICghZWxlbWVudC5pbkxpbmtzIHx8IGVsZW1lbnQuaW5MaW5rcy5sZW5ndGggPT0gMCkgJiZcclxuICAgICAgICAgICAgICAgICAgICAoZWxlbWVudC5vdXRMaW5rcyAmJiBlbGVtZW50Lm91dExpbmtzLmxlbmd0aCA+IDApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEdhcChhcnIpIHtcclxuICAgICAgICAgICAgdmFyIHRvdGFsV2lkdGggPSAwLCB0b3RhbEhlaWdodCA9IDA7XHJcbiAgICAgICAgICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB0b3RhbFdpZHRoICs9IGEud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0b3RhbEhlaWdodCArPSBhLmhlaWdodDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogdG90YWxXaWR0aCAvIGFyci5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRvdGFsSGVpZ2h0IC8gYXJyLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgYi54ICs9IGMsIGIueSArPSBkO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gZ2V0Um9vdENoaWxkcyhhLCBiKSwgZiA9IDA7IGYgPCBlLmxlbmd0aDsgZisrKWkoYSwgZVtmXSwgYywgZClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGooYSwgYikge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBjKGIsIGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gZ2V0Um9vdENoaWxkcyhhLCBiKTtcclxuICAgICAgICAgICAgICAgIG51bGwgPT0gZFtlXSAmJiAoZFtlXSA9IHt9LCBkW2VdLm5vZGVzID0gW10sIGRbZV0uY2hpbGRzID0gW10pLCBkW2VdLm5vZGVzLnB1c2goYiksIGRbZV0uY2hpbGRzLnB1c2goZik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBnID0gMDsgZyA8IGYubGVuZ3RoOyBnKyspYyhmW2ddLCBlICsgMSksIGZbZ10ucGFyZW50ID0gYlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZCA9IFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gYyhiLCAwKSwgZFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVHJlZUxheW91dChkaXJlY3Rpb24sIGdhcCwgdG9wKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGYoY2hpbGRzLCByb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBqdG9wby5sYXlvdXQuZ2V0VHJlZURlZXAoY2hpbGRzLCByb290KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgayA9IGooY2hpbGRzLCByb290KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IGtbXCJcIiArIGhdLm5vZGVzO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG0gPSAwOyBtIDwgbC5sZW5ndGg7IG0rKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGxbbV0sIG8gPSAobSArIDEpICogKGdhcCArIDEwKSwgcCA9IGggKiB0b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZG93blwiID09IGRpcmVjdGlvbiB8fCAoXCJ1cFwiID09IGRpcmVjdGlvbiA/IHAgPSAtcCA6IFwibGVmdFwiID09IGRpcmVjdGlvbiA/IChvID0gLWggKiB0b3AsIHAgPSAobSArIDEpICogKGdhcCArIDEwKSkgOiBcInJpZ2h0XCIgPT0gZGlyZWN0aW9uICYmIChvID0gaCAqIHRvcCwgcCA9IChtICsgMSkgKiAoZ2FwICsgMTApKSksIG4uc2V0TG9jYXRpb24obywgcClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcSA9IGggLSAxOyBxID49IDA7IHEtLSlmb3IgKHZhciByID0ga1tcIlwiICsgcV0ubm9kZXMsIHMgPSBrW1wiXCIgKyBxXS5jaGlsZHMsIG0gPSAwOyBtIDwgci5sZW5ndGg7IG0rKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IHJbbV0sIHUgPSBzW21dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJkb3duXCIgPT0gZGlyZWN0aW9uID8gdC55ID0gcSAqIHRvcCA6IFwidXBcIiA9PSBkaXJlY3Rpb24gPyB0LnkgPSAtcSAqIHRvcCA6IFwibGVmdFwiID09IGRpcmVjdGlvbiA/IHQueCA9IC1xICogdG9wIDogXCJyaWdodFwiID09IGRpcmVjdGlvbiAmJiAodC54ID0gcSAqIHRvcCksIHUubGVuZ3RoID4gMCA/IFwiZG93blwiID09IGRpcmVjdGlvbiB8fCBcInVwXCIgPT0gZGlyZWN0aW9uID8gdC54ID0gKHVbMF0ueCArIHVbdS5sZW5ndGggLSAxXS54KSAvIDIgOiAoXCJsZWZ0XCIgPT0gZGlyZWN0aW9uIHx8IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24pICYmICh0LnkgPSAodVswXS55ICsgdVt1Lmxlbmd0aCAtIDFdLnkpIC8gMikgOiBtID4gMCAmJiAoXCJkb3duXCIgPT0gZGlyZWN0aW9uIHx8IFwidXBcIiA9PSBkaXJlY3Rpb24gPyB0LnggPSByW20gLSAxXS54ICsgclttIC0gMV0ud2lkdGggKyBnYXAgOiAoXCJsZWZ0XCIgPT0gZGlyZWN0aW9uIHx8IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24pICYmICh0LnkgPSByW20gLSAxXS55ICsgclttIC0gMV0uaGVpZ2h0ICsgZ2FwKSksIG0gPiAwKWlmIChcImRvd25cIiA9PSBkaXJlY3Rpb24gfHwgXCJ1cFwiID09IGRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQueCA8IHJbbSAtIDFdLnggKyByW20gLSAxXS53aWR0aClmb3IgKHZhciB2ID0gclttIC0gMV0ueCArIHJbbSAtIDFdLndpZHRoICsgZ2FwLCB3ID0gTWF0aC5hYnModiAtIHQueCksIHggPSBtOyB4IDwgci5sZW5ndGg7IHgrKylpKHNjZW5lLmNoaWxkcywgclt4XSwgdywgMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoXCJsZWZ0XCIgPT0gZGlyZWN0aW9uIHx8IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24pICYmIHQueSA8IHJbbSAtIDFdLnkgKyByW20gLSAxXS5oZWlnaHQpZm9yICh2YXIgeSA9IHJbbSAtIDFdLnkgKyByW20gLSAxXS5oZWlnaHQgKyBnYXAsIHogPSBNYXRoLmFicyh5IC0gdC55KSwgeCA9IG07IHggPCByLmxlbmd0aDsgeCsrKWkoc2NlbmUuY2hpbGRzLCByW3hdLCAwLCB6KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVhbEdhcCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBnYXApIHtcclxuICAgICAgICAgICAgICAgICAgICByZWFsR2FwID0gZ2V0R2FwKHNjZW5lLmNoaWxkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2FwID0gcmVhbEdhcC53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJsZWZ0XCIgPT0gZGlyZWN0aW9uIHx8IFwicmlnaHRcIiA9PSBkaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2FwID0gcmVhbEdhcC53aWR0aCArIDEwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChudWxsID09IHRvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IHJlYWxHYXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhbEdhcCA9IGdldEdhcChzY2VuZS5jaGlsZHMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IDIgKiByZWFsR2FwLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IGRpcmVjdGlvbiB8fCBcImRvd25cIjtcclxuICAgICAgICAgICAgICAgIHZhciByb290cyA9IGp0b3BvLmxheW91dC5nZXRSb290Tm9kZXMoc2NlbmUuY2hpbGRzKTtcclxuICAgICAgICAgICAgICAgIGlmIChyb290cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZihzY2VuZS5jaGlsZHMsIHJvb3RzWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYm91bmQgPSBqdG9wby51dGlsLmdldEVsZW1lbnRzQm91bmQoc2NlbmUuY2hpbGRzKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gc2NlbmUuZ2V0Q2VudGVyTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnRYID0gY2VudGVyLnggLSAoYm91bmQubGVmdCArIGJvdW5kLnJpZ2h0KSAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0WSA9IGNlbnRlci55IC0gKGJvdW5kLnRvcCArIGJvdW5kLmJvdHRvbSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YganRvcG8uTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC54ICs9IHN0YXJ0WDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQueSArPSBzdGFydFk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL+W/hemhu+W+l+aYr+acieWQkeaXoOeOr+WbvuaJjeWPr+S7peW4g+WxgFxyXG4gICAgICAgIGZ1bmN0aW9uIENpcmNsZUxheW91dChyYWRpdXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gbG9jYXRpb25TZXQoYWxsQ2hpbGRzLCByb290LCByYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByb290c0FyciA9IGdldFJvb3RDaGlsZHMoYWxsQ2hpbGRzLCByb290KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMCAhPSByb290c0Fyci5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gcmEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhID0gcmFkaXVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwID0gMiAqIE1hdGguUEkgLyByb290c0Fyci5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3RzQXJyLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5zZXRMb2NhdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290LnggKyByYSAqIE1hdGguY29zKHN0ZXAgKiBpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290LnkgKyByYSAqIE1hdGguc2luKHN0ZXAgKiBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uU2V0KGFsbENoaWxkcywgY2hpbGQsIHJhIC8gMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciByb290cyA9IGp0b3BvLmxheW91dC5nZXRSb290Tm9kZXMoc2NlbmUuY2hpbGRzKTtcclxuICAgICAgICAgICAgICAgIGlmIChyb290cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25TZXQoc2NlbmUuY2hpbGRzLCByb290c1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJvdW5kID0ganRvcG8udXRpbC5nZXRFbGVtZW50c0JvdW5kKHNjZW5lLmNoaWxkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHNjZW5lLmdldENlbnRlckxvY2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBjZW50ZXIueCAtIChib3VuZC5sZWZ0ICsgYm91bmQucmlnaHQpIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gY2VudGVyLnkgLSAoYm91bmQudG9wICsgYm91bmQuYm90dG9tKSAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUuY2hpbGRzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIgaW5zdGFuY2VvZiBqdG9wby5Ob2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnggKz0gbGVmdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIueSArPSB0b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtKGEsIGIsIGMsIGQsIGUsIGYpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgZyA9IFtdLCBoID0gMDsgYyA+IGg7IGgrKylmb3IgKHZhciBpID0gMDsgZCA+IGk7IGkrKylnLnB1c2goe3g6IGEgKyBpICogZSwgeTogYiArIGggKiBmfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBnXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaXJjbGVQb3NpdGlvbihjZW50ZXJYLCBjZW50ZXJZLCB0b3RhbCwgcmFpZHVzLCBiZWdpbkFuZ2xlLCBlbmRBbmdsZSkge1xyXG4gICAgICAgICAgICB2YXIgYmVnaW4gPSBiZWdpbkFuZ2xlID8gYmVnaW5BbmdsZSA6IDA7XHJcbiAgICAgICAgICAgIHZhciBlbmQgPSBlbmRBbmdsZSA/IGVuZEFuZ2xlIDogMiAqIE1hdGguUEk7XHJcbiAgICAgICAgICAgIHZhciB0b3RhbEFuZ2xlID0gZW5kIC0gYmVnaW47XHJcbiAgICAgICAgICAgIHZhciBzdGVwID0gdG90YWxBbmdsZSAvIHRvdGFsO1xyXG4gICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbXTtcclxuICAgICAgICAgICAgYmVnaW4gKz0gc3RlcCAvIDI7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBiZWdpbjsgZW5kID49IGk7IGkgKz0gc3RlcCkge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogY2VudGVyWCArIE1hdGguY29zKGkpICogcmFpZHVzLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IGNlbnRlclkgKyBNYXRoLnNpbihpKSAqIHJhaWR1c1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9uXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0cmVlUG9zdGlvbihhLCBiLCBjLCBkLCBlLCBmKSB7XHJcbiAgICAgICAgICAgIHZhciBnID0gZiB8fCBcImJvdHRvbVwiLCBoID0gW107XHJcbiAgICAgICAgICAgIGlmIChcImJvdHRvbVwiID09IGcpZm9yICh2YXIgaSA9IGEgLSBjIC8gMiAqIGQgKyBkIC8gMiwgaiA9IDA7IGMgPj0gajsgaisrKWgucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB4OiBpICsgaiAqIGQsXHJcbiAgICAgICAgICAgICAgICB5OiBiICsgZVxyXG4gICAgICAgICAgICB9KTsgZWxzZSBpZiAoXCJ0b3BcIiA9PSBnKWZvciAodmFyIGkgPSBhIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgeDogaSArIGogKiBkLFxyXG4gICAgICAgICAgICAgICAgeTogYiAtIGVcclxuICAgICAgICAgICAgfSk7IGVsc2UgaWYgKFwicmlnaHRcIiA9PSBnKWZvciAodmFyIGkgPSBiIC0gYyAvIDIgKiBkICsgZCAvIDIsIGogPSAwOyBjID49IGo7IGorKyloLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgeDogYSArIGUsXHJcbiAgICAgICAgICAgICAgICB5OiBpICsgaiAqIGRcclxuICAgICAgICAgICAgfSk7IGVsc2UgaWYgKFwibGVmdFwiID09IGcpZm9yICh2YXIgaSA9IGIgLSBjIC8gMiAqIGQgKyBkIC8gMiwgaiA9IDA7IGMgPj0gajsgaisrKWgucHVzaCh7eDogYSAtIGUsIHk6IGkgKyBqICogZH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gaFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ3JpZFBvc2l0aW9uKGEsIGIsIGMsIGQsIGUsIGYpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgZyA9IFtdLCBoID0gMDsgYyA+IGg7IGgrKylmb3IgKHZhciBpID0gMDsgZCA+IGk7IGkrKylnLnB1c2goe3g6IGEgKyBpICogZSwgeTogYiArIGggKiBmfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBnXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhZGp1c3RQb3NpdGlvbihyb290LCByb290Q2hpbGRzKSB7XHJcbiAgICAgICAgICAgIGlmIChyb290LmxheW91dCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxheW91dCA9IHJvb3QubGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uQXJyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAobGF5b3V0LnR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjaXJjbGUnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gbGF5b3V0LnJhZGl1cyB8fCBNYXRoLm1heChyb290LndpZHRoLCByb290LmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uQXJyID0gY2lyY2xlUG9zaXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290LmN4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5jeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3RDaGlsZHMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5sYXlvdXQuYmVnaW5BbmdsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QubGF5b3V0LmVuZEFuZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RyZWUnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkFyciA9IHRyZWVQb3N0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5jeCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QuY3ksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290Q2hpbGRzLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dC53aWR0aCB8fCA1MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dC5oZWlnaHQgfHwgNTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQuZGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dyaWQnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkFyciA9IGdyaWRQb3NpdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QueSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dC5yb3dzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LmNvbHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQuaG9yaXpvbnRhbCB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LnZlcnRpY2FsIHx8IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvb3RDaGlsZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICByb290Q2hpbGRzW2ldLnNldENlbnRlckxvY2F0aW9uKGxvY2F0aW9uQXJyW2ldLngsIGxvY2F0aW9uQXJyW2ldLnkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRSb290Q2hpbGRzKGFsbENoaWxkcywgcm9vdE5vZGUpIHtcclxuICAgICAgICAgICAgdmFyIHJvb3RDaGlsZHM7XHJcbiAgICAgICAgICAgIGlmIChyb290Tm9kZS5vdXRMaW5rcyBpbnN0YW5jZW9mIEFycmF5ICYmIHJvb3ROb2RlLm91dExpbmtzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHJvb3RDaGlsZHMgPSByb290Tm9kZS5vdXRMaW5rcy5tYXAoZnVuY3Rpb24gKGxpbmspIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluay5ub2RlWjtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByb290Q2hpbGRzIHx8IFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGF5b3V0Tm9kZShzY2VuZSwgcm9vdCwgcmVjdXJzaW9uKSB7XHJcbiAgICAgICAgICAgIHZhciByb290Q2hpbGRzID0gZ2V0Um9vdENoaWxkcyhzY2VuZS5jaGlsZHMsIHJvb3QpO1xyXG4gICAgICAgICAgICBpZiAoMCAhPSByb290Q2hpbGRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgYWRqdXN0UG9zaXRpb24ocm9vdCwgcm9vdENoaWxkcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoMSA9PSByZWN1cnNpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHJvb3RDaGlsZHMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0Tm9kZShzY2VuZSwgcm9vdENoaWxkc1tlXSwgcmVjdXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNwcmluZ0xheW91dChiLCBjKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGQoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBhLnggLSBiLngsIGQgPSBhLnkgLSBiLnk7XHJcbiAgICAgICAgICAgICAgICBpICs9IGMgKiBmLCBqICs9IGQgKiBmLCBpICo9IGcsIGogKj0gZywgaiArPSBoLCBiLnggKz0gaSwgYi55ICs9IGpcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKCsrayA+IDE1MCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gMDsgYSA8IGwubGVuZ3RoOyBhKyspbFthXSAhPSBiICYmIGQoYiwgbFthXSwgbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChlLCAxZTMgLyAyNClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGYgPSAuMDEsIGcgPSAuOTUsIGggPSAtNSwgaSA9IDAsIGogPSAwLCBrID0gMCwgbCA9IGMuZ2V0RWxlbWVudHNCeUNsYXNzKGp0b3BvLk5vZGUpO1xyXG4gICAgICAgICAgICBlKClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFRyZWVEZWVwKGNoaWxkcywgcm9vdCkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiByZURlZXAoY2hpbGRzLCByb290LCBkZWVwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcm9vdENoaWxkcyA9IGdldFJvb3RDaGlsZHMoY2hpbGRzLCByb290KTtcclxuICAgICAgICAgICAgICAgIGlmIChkZWVwID4gZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSBkZWVwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZyA9IDA7IGcgPCByb290Q2hpbGRzLmxlbmd0aDsgZysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVEZWVwKGNoaWxkcywgcm9vdENoaWxkc1tnXSwgZGVlcCArIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZCA9IDA7XHJcbiAgICAgICAgICAgIHJlRGVlcChjaGlsZHMsIHJvb3QsIDApO1xyXG4gICAgICAgICAgICByZXR1cm4gZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGp0b3BvLmxheW91dCA9IGp0b3BvLkxheW91dCA9IHtcclxuICAgICAgICAgICAgbGF5b3V0Tm9kZTogbGF5b3V0Tm9kZSxcclxuICAgICAgICAgICAgZ2V0Tm9kZUNoaWxkczogZ2V0Um9vdENoaWxkcyxcclxuICAgICAgICAgICAgYWRqdXN0UG9zaXRpb246IGFkanVzdFBvc2l0aW9uLFxyXG4gICAgICAgICAgICBzcHJpbmdMYXlvdXQ6IHNwcmluZ0xheW91dCxcclxuICAgICAgICAgICAgZ2V0VHJlZURlZXA6IGdldFRyZWVEZWVwLFxyXG4gICAgICAgICAgICBnZXRSb290Tm9kZXM6IGdldFJvb3ROb2RlcyxcclxuICAgICAgICAgICAgR3JpZExheW91dDogR3JpZExheW91dCxcclxuICAgICAgICAgICAgRmxvd0xheW91dDogRmxvd0xheW91dCxcclxuICAgICAgICAgICAgQXV0b0JvdW5kTGF5b3V0OiBBdXRvQm91bmRMYXlvdXQsXHJcbiAgICAgICAgICAgIENpcmNsZUxheW91dDogQ2lyY2xlTGF5b3V0LFxyXG4gICAgICAgICAgICBUcmVlTGF5b3V0OiBUcmVlTGF5b3V0LFxyXG4gICAgICAgICAgICBnZXROb2Rlc0NlbnRlcjogZ2V0Tm9kZXNDZW50ZXIsXHJcbiAgICAgICAgICAgIGNpcmNsZUxheW91dE5vZGVzOiBjaXJjbGVMYXlvdXROb2Rlc1xyXG4gICAgICAgIH1cclxuICAgIH0oSlRvcG8pLFxyXG4gICAgZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gUGllQ2hhcnROb2RlKCkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IG5ldyBqdG9wby5DaXJjbGVOb2RlO1xyXG4gICAgICAgICAgICByZXR1cm4gYi5yYWRpdXMgPSAxNTAsIGIuY29sb3JzID0gW1wiIzM2NjZCMFwiLCBcIiMyQ0E4RTBcIiwgXCIjNzdEMUY2XCJdLCBiLmRhdGFzID0gWy4zLCAuMywgLjRdLCBiLnRpdGxlcyA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiXSwgYi5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IDIgKiBiLnJhZGl1cywgZCA9IDIgKiBiLnJhZGl1cztcclxuICAgICAgICAgICAgICAgIGIud2lkdGggPSBjLCBiLmhlaWdodCA9IGQ7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMCwgZiA9IDA7IGYgPCB0aGlzLmRhdGFzLmxlbmd0aDsgZisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSB0aGlzLmRhdGFzW2ZdICogTWF0aC5QSSAqIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gYi5jb2xvcnNbZl0sIGEubW92ZVRvKDAsIDApLCBhLmFyYygwLCAwLCB0aGlzLnJhZGl1cywgZSwgZSArIGcsICExKSwgYS5maWxsKCksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpLCBhLmJlZ2luUGF0aCgpLCBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSB0aGlzLnRpdGxlc1tmXSArIFwiOiBcIiArICgxMDAgKiB0aGlzLmRhdGFzW2ZdKS50b0ZpeGVkKDIpICsgXCIlXCIsIGkgPSBhLm1lYXN1cmVUZXh0KGgpLndpZHRoLCBqID0gKGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGgsIChlICsgZSArIGcpIC8gMiksIGsgPSB0aGlzLnJhZGl1cyAqIE1hdGguY29zKGopLCBsID0gdGhpcy5yYWRpdXMgKiBNYXRoLnNpbihqKTtcclxuICAgICAgICAgICAgICAgICAgICBqID4gTWF0aC5QSSAvIDIgJiYgaiA8PSBNYXRoLlBJID8gayAtPSBpIDogaiA+IE1hdGguUEkgJiYgaiA8IDIgKiBNYXRoLlBJICogMyAvIDQgPyBrIC09IGkgOiBqID4gMiAqIE1hdGguUEkgKiAuNzUsIGEuZmlsbFN0eWxlID0gXCIjRkZGRkZGXCIsIGEuZmlsbFRleHQoaCwgaywgbCksIGEubW92ZVRvKHRoaXMucmFkaXVzICogTWF0aC5jb3MoaiksIHRoaXMucmFkaXVzICogTWF0aC5zaW4oaikpLCBqID4gTWF0aC5QSSAvIDIgJiYgaiA8IDIgKiBNYXRoLlBJICogMyAvIDQgJiYgKGsgLT0gaSksIGogPiBNYXRoLlBJLCBhLmZpbGwoKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgZSArPSBnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEJhckNoYXJ0Tm9kZSgpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBuZXcganRvcG8uTm9kZTtcclxuICAgICAgICAgICAgcmV0dXJuIGIuc2hvd1NlbGVjdGVkID0gITEsIGIud2lkdGggPSAyNTAsIGIuaGVpZ2h0ID0gMTgwLCBiLmNvbG9ycyA9IFtcIiMzNjY2QjBcIiwgXCIjMkNBOEUwXCIsIFwiIzc3RDFGNlwiXSwgYi5kYXRhcyA9IFsuMywgLjMsIC40XSwgYi50aXRsZXMgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIl0sIGIucGFpbnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSAzLCBkID0gKHRoaXMud2lkdGggLSBjKSAvIHRoaXMuZGF0YXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYmVnaW5QYXRoKCksIGEuZmlsbFN0eWxlID0gXCIjRkZGRkZGXCIsIGEuc3Ryb2tlU3R5bGUgPSBcIiNGRkZGRkZcIiwgYS5tb3ZlVG8oLXRoaXMud2lkdGggLyAyIC0gMSwgLXRoaXMuaGVpZ2h0IC8gMiksIGEubGluZVRvKC10aGlzLndpZHRoIC8gMiAtIDEsIHRoaXMuaGVpZ2h0IC8gMiArIDMpLCBhLmxpbmVUbyh0aGlzLndpZHRoIC8gMiArIGMgKyAxLCB0aGlzLmhlaWdodCAvIDIgKyAzKSwgYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHRoaXMuZGF0YXMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBhLnNhdmUoKSwgYS5iZWdpblBhdGgoKSwgYS5maWxsU3R5bGUgPSBiLmNvbG9yc1tlXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IHRoaXMuZGF0YXNbZV0sIGcgPSBlICogKGQgKyBjKSAtIHRoaXMud2lkdGggLyAyLCBoID0gdGhpcy5oZWlnaHQgLSBmIC0gdGhpcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuZmlsbFJlY3QoZywgaCwgZCwgZik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBcIlwiICsgcGFyc2VJbnQodGhpcy5kYXRhc1tlXSksIGogPSBhLm1lYXN1cmVUZXh0KGkpLndpZHRoLCBrID0gYS5tZWFzdXJlVGV4dChcIueUsFwiKS53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IFwiI0ZGRkZGRlwiLCBhLmZpbGxUZXh0KGksIGcgKyAoZCAtIGopIC8gMiwgaCAtIGspLCBhLmZpbGxUZXh0KHRoaXMudGl0bGVzW2VdLCBnICsgKGQgLSBqKSAvIDIsIHRoaXMuaGVpZ2h0IC8gMiArIGspLCBhLmZpbGwoKSwgYS5jbG9zZVBhdGgoKSwgYS5yZXN0b3JlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgYlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAganRvcG8uQmFyQ2hhcnROb2RlID0gQmFyQ2hhcnROb2RlO1xyXG4gICAgICAgIGp0b3BvLlBpZUNoYXJ0Tm9kZSA9IFBpZUNoYXJ0Tm9kZTtcclxuICAgIH0oSlRvcG8pLFxyXG4gICAgZnVuY3Rpb24gKGp0b3BvKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYihiLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciBkLCBlID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZCA/ICh3aW5kb3cuY2xlYXJJbnRlcnZhbChkKSwgZSAmJiBlLnB1Ymxpc2goXCJzdG9wXCIpLCB0aGlzKSA6IHRoaXNcclxuICAgICAgICAgICAgICAgIH0sIHN0YXJ0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLmNhbGwoYSlcclxuICAgICAgICAgICAgICAgICAgICB9LCBjKSwgdGhpc1xyXG4gICAgICAgICAgICAgICAgfSwgb25TdG9wOiBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsID09IGUgJiYgKGUgPSBuZXcganRvcG8udXRpbC5NZXNzYWdlQnVzKSwgZS5zdWJzY3JpYmUoXCJzdG9wXCIsIGIpLCB0aGlzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVmX2dyYXZpdHkoYSwgYykge1xyXG4gICAgICAgICAgICBjID0gYyB8fCB7fTtcclxuICAgICAgICAgICAgdmFyIGQgPSBjLmdyYXZpdHkgfHwgLjEsIGUgPSBjLmR4IHx8IDAsIGYgPSBjLmR5IHx8IDUsIGcgPSBjLnN0b3AsIGggPSBjLmludGVydmFsIHx8IDMwLCBpID0gbmV3IGIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZyAmJiBnKCkgPyAoZiA9IC41LCB0aGlzLnN0b3AoKSkgOiAoZiArPSBkLCBhLnNldExvY2F0aW9uKGEueCArIGUsIGEueSArIGYpKVxyXG4gICAgICAgICAgICB9LCBoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuX3N0ZXBCeVN0ZXAodGFyZ2V0LCBhdHRyLCB0aW1lLCBlLCBmKSB7XHJcbiAgICAgICAgICAgIHZhciBnID0gMWUzIC8gMjQsIGggPSB7fTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBhdHRyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaiA9IGF0dHJbaV0sIGsgPSBqIC0gdGFyZ2V0W2ldO1xyXG4gICAgICAgICAgICAgICAgaFtpXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZTogdGFyZ2V0W2ldLCB0YXJnZXRWYWx1ZTogaiwgc3RlcDogayAvIHRpbWUgKiBnLCBpc0RvbmU6IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy5zdGVwID4gMCAmJiB0YXJnZXRbYl0gPj0gdGhpcy50YXJnZXRWYWx1ZSB8fCB0aGlzLnN0ZXAgPCAwICYmIHRhcmdldFtiXSA8PSB0aGlzLnRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbCA9IG5ldyBiKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gITA7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBkIGluIGF0dHIpaFtkXS5pc0RvbmUoZCkgfHwgKHRhcmdldFtkXSArPSBoW2RdLnN0ZXAsIGIgPSAhMSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZSlyZXR1cm4gdGhpcy5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCBpbiBhdHRyKWlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gaFtkXS50YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaFtkXS50YXJnZXRWYWx1ZSA9IGhbZF0ub2xkVmFsdWUsIGhbZF0ub2xkVmFsdWUgPSBnLCBoW2RdLnN0ZXAgPSAtaFtkXS5zdGVwXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHRhcmdldFtkXSA9IGhbZF0ub2xkVmFsdWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH0sIGcpO1xyXG4gICAgICAgICAgICByZXR1cm4gbFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZWZfc3ByaW5nKGEpIHtcclxuICAgICAgICAgICAgbnVsbCA9PSBhICYmIChhID0ge30pO1xyXG4gICAgICAgICAgICB2YXIgYiA9IGEuc3ByaW5nIHx8IC4xLCBjID0gYS5mcmljdGlvbiB8fCAuOCwgZCA9IGEuZ3Jpdml0eSB8fCAwLCBlID0gKGEud2luZCB8fCAwLCBhLm1pbkxlbmd0aCB8fCAwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSwgdGltZXI6IG51bGwsIGlzUGF1c2U6ICExLCBhZGROb2RlOiBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0ge25vZGU6IGEsIHRhcmdldDogYiwgdng6IDAsIHZ5OiAwfTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5wdXNoKGMpLCB0aGlzXHJcbiAgICAgICAgICAgICAgICB9LCBwbGF5OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcCgpLCBhID0gbnVsbCA9PSBhID8gMWUzIC8gMjQgOiBhO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLm5leHRGcmFtZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgYSlcclxuICAgICAgICAgICAgICAgIH0sIHN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBudWxsICE9IHRoaXMudGltZXIgJiYgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy50aW1lcilcclxuICAgICAgICAgICAgICAgIH0sIG5leHRGcmFtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGErKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IHRoaXMuaXRlbXNbYV0sIGcgPSBmLm5vZGUsIGggPSBmLnRhcmdldCwgaSA9IGYudngsIGogPSBmLnZ5LCBrID0gaC54IC0gZy54LCBsID0gaC55IC0gZy55LCBtID0gTWF0aC5hdGFuMihsLCBrKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBoLnggLSBNYXRoLmNvcyhtKSAqIGUsIG8gPSBoLnkgLSBNYXRoLnNpbihtKSAqIGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICs9IChuIC0gZy54KSAqIGIsIGogKz0gKG8gLSBnLnkpICogYlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaSArPSBrICogYiwgaiArPSBsICogYjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSAqPSBjLCBqICo9IGMsIGogKz0gZCwgZy54ICs9IGksIGcueSArPSBqLCBmLnZ4ID0gaSwgZi52eSA9IGpcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuX3JvdGF0ZShhLCBiKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZSA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbyA/IHZvaWQgZi5zdG9wKCkgOiAoYS5yb3RhdGUgKz0gZyB8fCAuMiwgdm9pZChhLnJvdGF0ZSA+IDIgKiBNYXRoLlBJICYmIChhLnJvdGF0ZSA9IDApKSlcclxuICAgICAgICAgICAgICAgIH0sIDEwMCksIGZcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cuY2xlYXJJbnRlcnZhbChlKSwgZi5vblN0b3AgJiYgZi5vblN0b3AoYSksIGZcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGUgPSAoYi5jb250ZXh0LCBudWxsKSwgZiA9IHt9LCBnID0gYi52O1xyXG4gICAgICAgICAgICByZXR1cm4gZi5ydW4gPSBjLCBmLnN0b3AgPSBkLCBmLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZi5vblN0b3AgPSBhLCBmXHJcbiAgICAgICAgICAgIH0sIGZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuX2dyYXZpdHkoYSwgYikge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jbGVhckludGVydmFsKGcpLCBoLm9uU3RvcCAmJiBoLm9uU3RvcChhKSwgaFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiLmR4IHx8IDAsIGkgPSBiLmR5IHx8IDI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZyA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbyA/IHZvaWQgaC5zdG9wKCkgOiAoaSArPSBmLCB2b2lkKGEueSArIGEuaGVpZ2h0IDwgZS5zdGFnZS5jYW52YXMuaGVpZ2h0ID8gYS5zZXRMb2NhdGlvbihhLnggKyBkLCBhLnkgKyBpKSA6IChpID0gMCwgYygpKSkpXHJcbiAgICAgICAgICAgICAgICB9LCAyMCksIGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGUgPSBiLmNvbnRleHQsIGYgPSBiLmdyYXZpdHkgfHwgLjEsIGcgPSBudWxsLCBoID0ge307XHJcbiAgICAgICAgICAgIHJldHVybiBoLnJ1biA9IGQsIGguc3RvcCA9IGMsIGgub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoLm9uU3RvcCA9IGEsIGhcclxuICAgICAgICAgICAgfSwgaFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYW5fZGl2aWRlZFR3b1BpZWNlKGIsIGMpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gZChjLCBkLCBlLCBmLCBnKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IG5ldyBqdG9wby5Ob2RlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGguc2V0SW1hZ2UoYi5pbWFnZSksIGguc2V0U2l6ZShiLndpZHRoLCBiLmhlaWdodCksIGguc2V0TG9jYXRpb24oYywgZCksIGguc2hvd1NlbGVjdGVkID0gITEsIGguZHJhZ2FibGUgPSAhMSwgaC5wYWludCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5zYXZlKCksIGEuYXJjKDAsIDAsIGUsIGYsIGcpLCBhLmNsaXAoKSwgYS5iZWdpblBhdGgoKSwgbnVsbCAhPSB0aGlzLmltYWdlID8gYS5kcmF3SW1hZ2UodGhpcy5pbWFnZSwgLXRoaXMud2lkdGggLyAyLCAtdGhpcy5oZWlnaHQgLyAyKSA6IChhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuc3R5bGUuZmlsbFN0eWxlICsgXCIsXCIgKyB0aGlzLmFscGhhICsgXCIpXCIsIGEucmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIpLCBhLmZpbGwoKSksIGEuY2xvc2VQYXRoKCksIGEucmVzdG9yZSgpXHJcbiAgICAgICAgICAgICAgICB9LCBoXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGUoYywgZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBjLCBnID0gYyArIE1hdGguUEksIGggPSBkKGIueCwgYi55LCBiLndpZHRoLCBmLCBnKSwgaiA9IGQoYi54IC0gMiArIDQgKiBNYXRoLnJhbmRvbSgpLCBiLnksIGIud2lkdGgsIGYgKyBNYXRoLlBJLCBmKTtcclxuICAgICAgICAgICAgICAgIGIudmlzaWJsZSA9ICExLCBlLmFkZChoKSwgZS5hZGQoaiksIGp0b3BvLkFuaW1hdGUuZ3Jhdml0eShoLCB7Y29udGV4dDogZSwgZHg6IC4zfSkucnVuKCkub25TdG9wKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnJlbW92ZShoKSwgZS5yZW1vdmUoaiksIGkuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICB9KSwganRvcG8uQW5pbWF0ZS5ncmF2aXR5KGosIHtjb250ZXh0OiBlLCBkeDogLS4yfSkucnVuKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlKGMuYW5nbGUsIGgpLCBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGcoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgJiYgaS5vblN0b3AoYiksIGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGggPSBjLmNvbnRleHQsIGkgPSAoYi5zdHlsZSwge30pO1xyXG4gICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkub25TdG9wID0gYSwgaVxyXG4gICAgICAgICAgICB9LCBpLnJ1biA9IGYsIGkuc3RvcCA9IGcsIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuX3JlcGVhdFRocm93KGEsIGIpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gYyhhKSB7XHJcbiAgICAgICAgICAgICAgICBhLnZpc2libGUgPSAhMCwgYS5yb3RhdGUgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBnLnN0YWdlLmNhbnZhcy53aWR0aCAvIDI7XHJcbiAgICAgICAgICAgICAgICBhLnggPSBiICsgTWF0aC5yYW5kb20oKSAqIChiIC0gMTAwKSAtIE1hdGgucmFuZG9tKCkgKiAoYiAtIDEwMCksIGEueSA9IGcuc3RhZ2UuY2FudmFzLmhlaWdodCwgYS52eCA9IDUgKiBNYXRoLnJhbmRvbSgpIC0gNSAqIE1hdGgucmFuZG9tKCksIGEudnkgPSAtMjVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjKGEpLCBoID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvID8gdm9pZCBpLnN0b3AoKSA6IChhLnZ5ICs9IGYsIGEueCArPSBhLnZ4LCBhLnkgKz0gYS52eSwgdm9pZCgoYS54IDwgMCB8fCBhLnggPiBnLnN0YWdlLmNhbnZhcy53aWR0aCB8fCBhLnkgPiBnLnN0YWdlLmNhbnZhcy5oZWlnaHQpICYmIChpLm9uU3RvcCAmJiBpLm9uU3RvcChhKSwgYyhhKSkpKVxyXG4gICAgICAgICAgICAgICAgfSwgNTApLCBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZiA9IC44LCBnID0gYi5jb250ZXh0LCBoID0gbnVsbCwgaSA9IHt9O1xyXG4gICAgICAgICAgICByZXR1cm4gaS5vblN0b3AgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkub25TdG9wID0gYSwgaVxyXG4gICAgICAgICAgICB9LCBpLnJ1biA9IGQsIGkuc3RvcCA9IGUsIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuX3N0b3BBbGwoKSB7XHJcbiAgICAgICAgICAgIG8gPSAhMFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYW5fc3RhcnRBbGwoKSB7XHJcbiAgICAgICAgICAgIG8gPSAhMVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYW5fY3ljbGUoYiwgYykge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8pcmV0dXJuIHZvaWQgbS5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBmLnkgKyBoICsgTWF0aC5zaW4oaykgKiBqO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc2V0TG9jYXRpb24oYi54LCBhKSwgayArPSBsXHJcbiAgICAgICAgICAgICAgICB9LCAxMDApLCBtXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChuKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZiA9IGMucDEsIGcgPSBjLnAyLCBoID0gKGMuY29udGV4dCwgZi54ICsgKGcueCAtIGYueCkgLyAyKSwgaSA9IGYueSArIChnLnkgLSBmLnkpIC8gMiwgaiA9IGp0b3BvLnV0aWwuZ2V0RGlzdGFuY2UoZiwgZykgLyAyLCBrID0gTWF0aC5hdGFuMihpLCBoKSwgbCA9IGMuc3BlZWQgfHwgLjIsIG0gPSB7fSwgbiA9IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybiBtLnJ1biA9IGQsIG0uc3RvcCA9IGUsIG1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuX21vdmUoYSwgYikge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGggPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8pcmV0dXJuIHZvaWQgZy5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBlLnggLSBhLngsIGMgPSBlLnkgLSBhLnksIGggPSBiICogZiwgaSA9IGMgKiBmO1xyXG4gICAgICAgICAgICAgICAgICAgIGEueCArPSBoLCBhLnkgKz0gaSwgLjAxID4gaCAmJiAuMSA+IGkgJiYgZCgpXHJcbiAgICAgICAgICAgICAgICB9LCAxMDApLCBnXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZSA9IGIucG9zaXRpb24sIGYgPSAoYi5jb250ZXh0LCBiLmVhc2luZyB8fCAuMiksIGcgPSB7fSwgaCA9IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybiBnLm9uU3RvcCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZy5vblN0b3AgPSBhLCBnXHJcbiAgICAgICAgICAgIH0sIGcucnVuID0gYywgZy5zdG9wID0gZCwgZ1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYW5fc2NhbGUoYSwgYikge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBjKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGogPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5zY2FsZVggKz0gZiwgYS5zY2FsZVkgKz0gZiwgYS5zY2FsZVggPj0gZSAmJiBkKClcclxuICAgICAgICAgICAgICAgIH0sIDEwMCksIGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZCgpIHtcclxuICAgICAgICAgICAgICAgIGkub25TdG9wICYmIGkub25TdG9wKGEpLCBhLnNjYWxlWCA9IGcsIGEuc2NhbGVZID0gaCwgd2luZG93LmNsZWFySW50ZXJ2YWwoailcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGUgPSAoYi5wb3NpdGlvbiwgYi5jb250ZXh0LCBiLnNjYWxlIHx8IDEpLCBmID0gLjA2LCBnID0gYS5zY2FsZVgsIGggPSBhLnNjYWxlWSwgaSA9IHt9LCBqID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIGkub25TdG9wID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpLm9uU3RvcCA9IGEsIGlcclxuICAgICAgICAgICAgfSwgaS5ydW4gPSBjLCBpLnN0b3AgPSBkLCBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBqdG9wby5BbmltYXRlID0ge30sIGp0b3BvLkVmZmVjdCA9IHt9O1xyXG4gICAgICAgIHZhciBvID0gITE7XHJcbiAgICAgICAganRvcG8uRWZmZWN0LnNwcmluZyA9IGVmX3NwcmluZztcclxuICAgICAgICBqdG9wby5FZmZlY3QuZ3Jhdml0eSA9IGVmX2dyYXZpdHk7XHJcbiAgICAgICAganRvcG8uQW5pbWF0ZS5zdGVwQnlTdGVwID0gYW5fc3RlcEJ5U3RlcDtcclxuICAgICAgICBqdG9wby5BbmltYXRlLnJvdGF0ZSA9IGFuX3JvdGF0ZTtcclxuICAgICAgICBqdG9wby5BbmltYXRlLnNjYWxlID0gYW5fc2NhbGU7XHJcbiAgICAgICAganRvcG8uQW5pbWF0ZS5tb3ZlID0gYW5fbW92ZTtcclxuICAgICAgICBqdG9wby5BbmltYXRlLmN5Y2xlID0gYW5fY3ljbGU7XHJcbiAgICAgICAganRvcG8uQW5pbWF0ZS5yZXBlYXRUaHJvdyA9IGFuX3JlcGVhdFRocm93O1xyXG4gICAgICAgIGp0b3BvLkFuaW1hdGUuZGl2aWRlZFR3b1BpZWNlID0gYW5fZGl2aWRlZFR3b1BpZWNlO1xyXG4gICAgICAgIGp0b3BvLkFuaW1hdGUuZ3Jhdml0eSA9IGFuX2dyYXZpdHk7XHJcbiAgICAgICAganRvcG8uQW5pbWF0ZS5zdGFydEFsbCA9IGFuX3N0YXJ0QWxsO1xyXG4gICAgICAgIGp0b3BvLkFuaW1hdGUuc3RvcEFsbCA9IGFuX3N0b3BBbGw7XHJcbiAgICB9KEpUb3BvKSxcclxuICAgIGZ1bmN0aW9uIChqdG9wbykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGIoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYyA9IFtdO1xyXG4gICAgICAgICAgICBpZiAoMCA9PSBhLmxlbmd0aClyZXR1cm4gYztcclxuICAgICAgICAgICAgdmFyIGQgPSBiLm1hdGNoKC9eXFxzKihcXHcrKVxccyokLyk7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gYS5maWx0ZXIoZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5lbGVtZW50VHlwZSA9PSBkWzFdXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG51bGwgIT0gZSAmJiBlLmxlbmd0aCA+IDAgJiYgKGMgPSBjLmNvbmNhdChlKSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gITE7XHJcbiAgICAgICAgICAgICAgICBpZiAoZCA9IGIubWF0Y2goL1xccyooXFx3KylcXHMqXFxbXFxzKihcXHcrKVxccyooWz49PF0pXFxzKlsnXCJdKFxcUyspWydcIl1cXHMqXFxdXFxzKi8pLCAobnVsbCA9PSBkIHx8IGQubGVuZ3RoIDwgNSkgJiYgKGQgPSBiLm1hdGNoKC9cXHMqKFxcdyspXFxzKlxcW1xccyooXFx3KylcXHMqKFs+PTxdKVxccyooXFxkKyhcXC5cXGQrKT8pXFxzKlxcXVxccyovKSwgZiA9ICEwKSwgbnVsbCAhPSBkICYmIGQubGVuZ3RoID49IDUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGRbMV0sIGggPSBkWzJdLCBpID0gZFszXSwgaiA9IGRbNF07XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGEuZmlsdGVyKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhLmVsZW1lbnRUeXBlICE9IGcpcmV0dXJuICExO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGFbaF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxID09IGYgJiYgKGIgPSBwYXJzZUludChiKSksIFwiPVwiID09IGkgPyBiID09IGogOiBcIj5cIiA9PSBpID8gYiA+IGogOiBcIjxcIiA9PSBpID8gaiA+IGIgOiBcIjw9XCIgPT0gaSA/IGogPj0gYiA6IFwiPj1cIiA9PSBpID8gYiA+PSBqIDogXCIhPVwiID09IGkgPyBiICE9IGogOiAhMVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLCBudWxsICE9IGUgJiYgZS5sZW5ndGggPiAwICYmIChjID0gYy5jb25jYXQoZSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGMoYSkge1xyXG4gICAgICAgICAgICBpZiAoYS5maW5kID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmluZC5jYWxsKHRoaXMsIGEpXHJcbiAgICAgICAgICAgICAgICB9LCBlLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhW2JdID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLmxlbmd0aDsgYysrKXRoaXNbY11bYl0oYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSksIGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBhWzBdO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYyBpbiBiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBiW2NdO1xyXG4gICAgICAgICAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZiAmJiAhZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYVtjXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSBbXSwgZCA9IDA7IGQgPCBhLmxlbmd0aDsgZCsrKWMucHVzaChiLmFwcGx5KGFbZF0sIGFyZ3VtZW50cykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0oZilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYS5hdHRyID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGEgJiYgbnVsbCAhPSBiKWZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5sZW5ndGg7IGMrKyl0aGlzW2NdW2FdID0gYjsgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gYSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSBbXSwgYyA9IDA7IGMgPCB0aGlzLmxlbmd0aDsgYysrKWQucHVzaCh0aGlzW2NdW2FdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gYSlmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMubGVuZ3RoOyBjKyspZm9yICh2YXIgZSBpbiBhKXRoaXNbY11bZV0gPSBhW2VdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICB9LCBhXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmaW5kKGQpIHtcclxuICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgIHZhciBlID0gW107XHJcbiAgICAgICAgICAgIHZhciBmID0gW107XHJcbiAgICAgICAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YganRvcG8uU3RhZ2UpIHtcclxuICAgICAgICAgICAgICAgIGUgPSB0aGlzLmNoaWxkcztcclxuICAgICAgICAgICAgICAgIGYgPSBmLmNvbmNhdChlKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzIGluc3RhbmNlb2YganRvcG8uU2NlbmUpIHtcclxuICAgICAgICAgICAgICAgIGUgPSBbdGhpc107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmID0gdGhpcztcclxuICAgICAgICAgICAgICAgIGUuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBmLmNvbmNhdChhLmNoaWxkcylcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBnID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZCkge1xyXG4gICAgICAgICAgICAgICAgZi5maWx0ZXIoZClcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGIoZiwgZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGMoZyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZSA9IFwiY2xpY2ssbW91c2Vkb3duLG1vdXNldXAsbW91c2VvdmVyLG1vdXNlb3V0LG1vdXNlZHJhZyxrZXlkb3duLGtleXVwXCIuc3BsaXQoXCIsXCIpO1xyXG4gICAgICAgIGp0b3BvLlN0YWdlLnByb3RvdHlwZS5maW5kID0gZmluZDtcclxuICAgICAgICBqdG9wby5TY2VuZS5wcm90b3R5cGUuZmluZCA9IGZpbmQ7XHJcbiAgICB9KEpUb3BvKSxcclxuICAgIGZ1bmN0aW9uICh3aW4pIHtcclxuICAgICAgICBmdW5jdGlvbiBsb2dPYmplY3QoYSwgYikge1xyXG4gICAgICAgICAgICB0aGlzLnggPSBhO1xyXG4gICAgICAgICAgICB0aGlzLnkgPSBiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVG9ydG9pc2UoYSkge1xyXG4gICAgICAgICAgICB0aGlzLnAgPSBuZXcgbG9nT2JqZWN0KDAsIDApO1xyXG4gICAgICAgICAgICB0aGlzLncgPSBuZXcgbG9nT2JqZWN0KDEsIDApO1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50ID0gYTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNoaWZ0KGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgYiA+IGU7IGUrKylhKCksIGMgJiYgZC50dXJuKGMpLCBkLm1vdmUoMylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc3BpbihhLCBiKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gMiAqIE1hdGguUEk7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGIgPiBlOyBlKyspYSgpLCBkLnR1cm4oYyAvIGIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNjYWxlKGEsIGIsIGMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgYiA+IGU7IGUrKylhKCksIGQucmVzaXplKGMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHBvbHlnb24oYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IDIgKiBNYXRoLlBJO1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBhID4gZDsgZCsrKWMuZm9yd2FyZCgxKSwgYy50dXJuKGIgLyBhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzdGFyKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSA0ICogTWF0aC5QSTtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gMDsgYSA+IGQ7IGQrKyljLmZvcndhcmQoMSksIGMudHVybihiIC8gYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc3BpcmFsKGEsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBmID0gMDsgYiA+IGY7IGYrKylhKCksIGUuZm9yd2FyZCgxKSwgZS50dXJuKGMpLCBlLnJlc2l6ZShkKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgTG9nbyA9IHt9O1xyXG4gICAgICAgIFRvcnRvaXNlLnByb3RvdHlwZS5mb3J3YXJkID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnAsIGMgPSB0aGlzLnc7XHJcbiAgICAgICAgICAgIHJldHVybiBiLnggPSBiLnggKyBhICogYy54LCBiLnkgPSBiLnkgKyBhICogYy55LCB0aGlzLnBhaW50ICYmIHRoaXMucGFpbnQoYi54LCBiLnkpLCB0aGlzXHJcbiAgICAgICAgfTtcclxuICAgICAgICBUb3J0b2lzZS5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcy5wLCBjID0gdGhpcy53O1xyXG4gICAgICAgICAgICByZXR1cm4gYi54ID0gYi54ICsgYSAqIGMueCwgYi55ID0gYi55ICsgYSAqIGMueSwgdGhpc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVG9ydG9pc2UucHJvdG90eXBlLm1vdmVUbyA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnAueCA9IGEsIHRoaXMucC55ID0gYiwgdGhpc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVG9ydG9pc2UucHJvdG90eXBlLnR1cm4gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9ICh0aGlzLnAsIHRoaXMudyk7XHJcbiAgICAgICAgICAgIHZhciBjID0gTWF0aC5jb3MoYSkgKiBiLnggLSBNYXRoLnNpbihhKSAqIGIueTtcclxuICAgICAgICAgICAgdmFyIGQgPSBNYXRoLnNpbihhKSAqIGIueCArIE1hdGguY29zKGEpICogYi55O1xyXG4gICAgICAgICAgICBiLnggPSBjO1xyXG4gICAgICAgICAgICBiLnkgPSBkO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIFRvcnRvaXNlLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMudztcclxuICAgICAgICAgICAgYi54ID0gYi54ICogYTtcclxuICAgICAgICAgICAgYi55ID0gYi55ICogYTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBUb3J0b2lzZS5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGwgPT0gdGhpcy5fc3RhY2sgJiYgKHRoaXMuX3N0YWNrID0gW10pLCB0aGlzLl9zdGFjay5wdXNoKFt0aGlzLnAsIHRoaXMud10pLCB0aGlzXHJcbiAgICAgICAgfTtcclxuICAgICAgICBUb3J0b2lzZS5wcm90b3R5cGUucmVzdG9yZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgIT0gdGhpcy5fc3RhY2sgJiYgdGhpcy5fc3RhY2subGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLl9zdGFjay5wb3AoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucCA9IGFbMF0sIHRoaXMudyA9IGFbMV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgTG9nby5Ub3J0b2lzZSA9IFRvcnRvaXNlO1xyXG4gICAgICAgIExvZ28uc2hpZnQgPSBzaGlmdDtcclxuICAgICAgICBMb2dvLnNwaW4gPSBzcGluO1xyXG4gICAgICAgIExvZ28ucG9seWdvbiA9IHBvbHlnb247XHJcbiAgICAgICAgTG9nby5zcGlyYWwgPSBzcGlyYWw7XHJcbiAgICAgICAgTG9nby5zdGFyID0gc3RhcjtcclxuICAgICAgICBMb2dvLnNjYWxlID0gc2NhbGU7XHJcbiAgICAgICAgd2luLkxvZ28gPSBMb2dvO1xyXG4gICAgfSh3aW5kb3cpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2p0b3BvL2p0b3BvLW1pbi5qc1xuLy8gbW9kdWxlIGlkID0gMTBcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},11:function(module,exports){eval('/**\r\n * @module QTopo\r\n */\r\n/**\r\n * QTopo通用工具包\r\n * @class QTopo.util\r\n * @static\r\n */\r\nfunction cached(fn) {\r\n    var cache = Object.create(null);\r\n    return (function cachedFn(str) {\r\n        var hit = cache[str];\r\n        return hit || (cache[str] = fn(str))\r\n    })\r\n}\r\n\r\nvar util = {\r\n        /**\r\n         *  给函数添加缓存机制\r\n         *  @method cached\r\n         *  @param fn {function} 需处理的函数\r\n         *  @returns {function} 处理过的函数\r\n         */\r\n        cached:cached,\r\n        /**\r\n         * 字符串转化json\r\n         * @method toJson\r\n         * @param json {string|object}\r\n         * @returns json对象 {json}\r\n         */\r\n        toJson: function (json) {\r\n            if (typeof json == \'string\') {\r\n                json = $.parseJSON(json.replace(/\'/g, \'"\'));\r\n            }\r\n            return json;\r\n        },\r\n        /**\r\n         * 首字母大写\r\n         * @method upFirst\r\n         * @param string 字符串\r\n         * @returns {string} 首字母大写的字符串\r\n         */\r\n        upFirst: cached(function (str) {\r\n            return str.charAt(0).toUpperCase() + str.slice(1);\r\n        }),\r\n        /**\r\n         * 对象深度合并，只继承原对象有的属性\r\n         * @method extend\r\n         * @param base 原对象\r\n         * @param config 合并对象\r\n         * @returns {object} 处理完的原对象\r\n         */\r\n        extend: function (base, config) {\r\n            try {\r\n                if (typeof base == "object" && typeof config == "object") {\r\n                    deep(base, config);\r\n                }\r\n                else {\r\n                    QTopo.util.error("some extend error:", base, config);\r\n                }\r\n            } catch (e) {\r\n                QTopo.util.error("extend error", e, base, config);\r\n            }\r\n            function deep(attr, config) {\r\n                $.each(attr, function (key, value) {\r\n                    if (attr[key] && typeof attr[key] == "object" && typeof config[key] == "object") {\r\n                        if ($.isArray(attr[key]) && $.isArray(config[key])) {\r\n                            attr[key] = config[key];\r\n                        } else if ($.isFunction(attr[key]) && $.isFunction(config[key])) {\r\n                            attr[key] = config[key];\r\n                        } else {\r\n                            deep(attr[key], config[key]);\r\n                        }\r\n                    } else if (typeof attr[key] != "undefined" && typeof config[key] != "undefined") {\r\n                        attr[key] = config[key];\r\n                    }\r\n                });\r\n            }\r\n\r\n            return base;\r\n        },\r\n        /**\r\n         * 获取浏览器连接上的参数\r\n         * @method getParameter\r\n         * @param param 参数名\r\n         * @returns {string}\r\n         */\r\n        getParameter: function (param) {\r\n            var query = window.location.search;//获取URL地址中？后的所有字符\r\n            var iLen = param.length;//获取你的参数名称长度\r\n            var iStart = query.indexOf(param);//获取你该参数名称的其实索引\r\n            if (iStart == -1)//-1为没有该参数\r\n                return "";\r\n            iStart += iLen + 1;\r\n            var iEnd = query.indexOf("&", iStart);//获取第二个参数的其实索引\r\n            if (iEnd == -1)//只有一个参数\r\n                return query.substring(iStart);//获取单个参数的参数值\r\n            return query.substring(iStart, iEnd);//获取第二个参数的值\r\n        },\r\n        /**\r\n         * 仅画布全屏展示\r\n         * @method runPrefixMethod\r\n         * @param element {document} 例:canvas\r\n         * @param method {string} "RequestFullScreen"全屏的模式\r\n         */\r\n        runPrefixMethod: function (element, method) {\r\n            var usablePrefixMethod;\r\n            ["webkit", "moz", "ms", "o", ""].forEach(function (prefix) {\r\n                    if (usablePrefixMethod) return;\r\n                    if (prefix === "") {\r\n                        // 无前缀，方法首字母小写\r\n                        method = method.slice(0, 1).toLowerCase() + method.slice(1);\r\n                    }\r\n                    var typePrefixMethod = typeof element[prefix + method];\r\n                    if (typePrefixMethod + "" !== "undefined") {\r\n                        if (typePrefixMethod === "function") {\r\n                            usablePrefixMethod = element[prefix + method]();\r\n                        } else {\r\n                            usablePrefixMethod = element[prefix + method];\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n        },\r\n        /**\r\n         * 浏览器全屏展示\r\n         * @method launchFullScreen\r\n         * @param element {document} 例:document.documentElement\r\n         */\r\n        launchFullScreen: function (element) {\r\n            if (element.requestFullscreen) {\r\n                element.requestFullscreen();\r\n            } else if (element.mozRequestFullScreen) {\r\n                element.mozRequestFullScreen();\r\n            } else if (element.webkitRequestFullscreen) {\r\n                element.webkitRequestFullscreen();\r\n            } else if (element.msRequestFullscreen) {\r\n                element.msRequestFullscreen();\r\n            }\r\n        },\r\n        /**\r\n         * 关闭浏览器全屏\r\n         * @method exitFullScreen\r\n         * @param document {document} 例:window.document\r\n         */\r\n        exitFullScreen: function (document) {\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.mozCancelFullScreen) {\r\n                document.mozCancelFullScreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n                document.webkitExitFullscreen();\r\n            }\r\n        },\r\n        /**\r\n         * 颜色字符串转换成rgb 16进制\r\n         * @method transHex\r\n         * @param color {string} 例:"#asdd00"\r\n         * @return {string} 16进制 例:"255,255,255"\r\n         */\r\n        transHex: cached(function (color) {\r\n            if (color && color.length == 7 && color.charAt(0) == \'#\') {\r\n                return [\r\n                    parseInt(color.substr(1, 2), 16),\r\n                    parseInt(color.substr(3, 2), 16),\r\n                    parseInt(color.substr(5, 2), 16)\r\n                ].join(\',\');\r\n            } else {\r\n                return color;\r\n            }\r\n        }),\r\n        /**\r\n         * 数组添加元素,如果数组中不存在则存入，否则不做操作\r\n         * @method arrayPush\r\n         * @param arr 操作的数组\r\n         * @param value 操作的元素\r\n         * @return {boolean} 操作是否成功\r\n         */\r\n        arrayPush: function (arr, value) {\r\n            if (arr.indexOf(value) < 0) {\r\n                arr.push(value);\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 数组删除元素,如果数组中不存在则删除，否则不做操作\r\n         * @method arrayDelete\r\n         * @param arr 操作的数组\r\n         * @param value 操作的元素\r\n         * @return {boolean} 操作是否成功\r\n         */\r\n        arrayDelete: function (arr, value) {\r\n            var i = arr.indexOf(value);\r\n            if (i >= 0) {\r\n                arr.splice(i, 1);\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 构造类继承关系\r\n         * @method inherits\r\n         * @param {Function} clazz 源类\r\n         * @param {Function} baseClazz 基类\r\n         */\r\n        inherits: function (clazz, baseClazz) {\r\n            var clazzPrototype = clazz.prototype;\r\n\r\n            function F() {\r\n            }\r\n\r\n            F.prototype = baseClazz.prototype;\r\n            clazz.prototype = new F();\r\n\r\n            for (var prop in clazzPrototype) {\r\n                clazz.prototype[prop] = clazzPrototype[prop];\r\n            }\r\n            clazz.constructor = clazz;\r\n        },\r\n        /**\r\n         * 深度克隆对象\r\n         * @method deepClone\r\n         * @param {object} obj 待克隆对象\r\n         * @return {object} 克隆后的新对象\r\n         */\r\n        deepClone: function (obj) {\r\n            var result, oClass = util.getClass(obj);\r\n            //确定result的类型\r\n            if (oClass === "Object") {\r\n                result = {};\r\n            } else if (oClass === "Array") {\r\n                result = [];\r\n            } else {\r\n                return obj;\r\n            }\r\n            for (key in obj) {\r\n                var copy = obj[key];\r\n                if (util.getClass(copy) == "Object") {\r\n                    result[key] = arguments.callee(copy);//递归调用\r\n                } else if ($.isArray(copy)) {\r\n                    result[key] = arguments.callee(copy);\r\n                } else {\r\n                    result[key] = obj[key];\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n        /**\r\n         * 获取对象的类\r\n         * @method getClass\r\n         * @param {object} o 待处理对象\r\n         * @return {string} 类名，如"Object","Array"\r\n         */\r\n        getClass: function (o) {\r\n            if (o === null) return "Null";\r\n            if (o === undefined) return "Undefined";\r\n            return Object.prototype.toString.call(o).slice(8, -1);\r\n        },\r\n        /**\r\n         * 加入时间戳的信息日志\r\n         * @method info\r\n         * @param {arguments} arguments\r\n         */\r\n        info: function () {\r\n            if (QTopo.log.info) {\r\n                console.info.apply(console, $.merge([util.dateFormat(new Date(), "hh:mm:ss")], arguments));\r\n            }\r\n        },\r\n        /**\r\n         * 加入时间戳的错误日志\r\n         * @method error\r\n         * @param {arguments} arguments\r\n         */\r\n        error: function () {\r\n            if (QTopo.log.error) {\r\n                console.error.apply(console, $.merge([util.dateFormat(new Date(), "hh:mm:ss")], arguments));\r\n            }\r\n        },\r\n        /**\r\n         * 格式化Date对象\r\n         * @method dateFormat\r\n         * @param {Date} date Date对象\r\n         * @param {string} ftString 格式化字符串,如"hh:mm:ss"\r\n         * @return {string}\r\n         */\r\n        dateFormat: function (date, ftString) {\r\n            if (date instanceof Date) {\r\n                var fomat = {\r\n                    "M+": date.getMonth() + 1, //月份\r\n                    "d+": date.getDate(), //日\r\n                    "h+": date.getHours(), //小时\r\n                    "m+": date.getMinutes(), //分\r\n                    "s+": date.getSeconds(), //秒\r\n                    "q+": Math.floor((date.getMonth() + 3) / 3), //季度\r\n                    "S": date.getMilliseconds() //毫秒\r\n                };\r\n                if (/(y+)/.test(ftString)) {\r\n                    ftString = ftString.replace(RegExp.$1, (date.getFullYear() + "")\r\n                        .substr(4 - RegExp.$1.length));\r\n                }\r\n                for (var type in fomat) {\r\n                    if (new RegExp("(" + type + ")").test(ftString)) {\r\n                        var temp;\r\n                        if (RegExp.$1.length == 1) {\r\n                            temp = fomat[type];\r\n                        } else {\r\n                            temp = ("00" + fomat[type]).substr(("" + fomat[type]).length);\r\n                        }\r\n                        ftString = ftString.replace(RegExp.$1, temp);\r\n                    }\r\n                }\r\n            }\r\n            return ftString;\r\n        },\r\n        /**\r\n         * 构造唯一Id字符串\r\n         * @method makeId\r\n         * @return {string}\r\n         */\r\n        makeId: function () {\r\n            return S4() + "-" + S4() + "-" + S4();\r\n        },\r\n        /**\r\n         * 判断对象是否是元素\r\n         * @method isElement\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isElement: function (target) {\r\n            return target &&target.getType &&target.getType() != QTopo.constant.SCENE && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是图层\r\n         * @method isScene\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isScene: function (target) {\r\n            return !target || target.getType() == QTopo.constant.SCENE;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是节点\r\n         * @method isNode\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isNode: function (target) {\r\n            return target && target.getType() == QTopo.constant.NODE && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是分组\r\n         * @method isContainer\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isContainer: function (target) {\r\n            return target && target.getType() == QTopo.constant.CONTAINER && target.getUseType() != QTopo.constant.CASUAL;\r\n        },\r\n        /**\r\n         * 判断QTopo对象是否是链接\r\n         * @method isLink\r\n         * @param element {element}\r\n         * @return {boolean}\r\n         */\r\n        isLink: function (target) {\r\n            return target && target.getType() == QTopo.constant.LINK && target.getUseType() != QTopo.constant.CASUAL;\r\n        }\r\n    }\r\n    ;\r\nfunction S4() {\r\n    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n}\r\nmodule.exports = util;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL3V0aWwuanM/MjkyNiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixTQUFTO0FBQ2hDLHNCQUFzQixTQUFTO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEIsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DLG9DQUFvQztBQUNwQyw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0Esa0RBQWtEO0FBQ2xEO0FBQ0EsK0NBQStDO0FBQy9DLGlEQUFpRDtBQUNqRCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFNBQVM7QUFDcEMsMEJBQTBCLE9BQU87QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsU0FBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixTQUFTO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLE9BQU87QUFDaEMsb0JBQW9CLE9BQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsU0FBUztBQUM1QixtQkFBbUIsU0FBUztBQUM1QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlEO0FBQ3pELGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsT0FBTztBQUMxQixvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixVQUFVO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFVBQVU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsS0FBSztBQUN4QixtQkFBbUIsT0FBTztBQUMxQixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIxMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIFFUb3BvXHJcbiAqL1xyXG4vKipcclxuICogUVRvcG/pgJrnlKjlt6XlhbfljIVcclxuICogQGNsYXNzIFFUb3BvLnV0aWxcclxuICogQHN0YXRpY1xyXG4gKi9cclxuZnVuY3Rpb24gY2FjaGVkKGZuKSB7XHJcbiAgICB2YXIgY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgcmV0dXJuIChmdW5jdGlvbiBjYWNoZWRGbihzdHIpIHtcclxuICAgICAgICB2YXIgaGl0ID0gY2FjaGVbc3RyXTtcclxuICAgICAgICByZXR1cm4gaGl0IHx8IChjYWNoZVtzdHJdID0gZm4oc3RyKSlcclxuICAgIH0pXHJcbn1cclxuXHJcbnZhciB1dGlsID0ge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICDnu5nlh73mlbDmt7vliqDnvJPlrZjmnLrliLZcclxuICAgICAgICAgKiAgQG1ldGhvZCBjYWNoZWRcclxuICAgICAgICAgKiAgQHBhcmFtIGZuIHtmdW5jdGlvbn0g6ZyA5aSE55CG55qE5Ye95pWwXHJcbiAgICAgICAgICogIEByZXR1cm5zIHtmdW5jdGlvbn0g5aSE55CG6L+H55qE5Ye95pWwXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2FjaGVkOmNhY2hlZCxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlrZfnrKbkuLLovazljJZqc29uXHJcbiAgICAgICAgICogQG1ldGhvZCB0b0pzb25cclxuICAgICAgICAgKiBAcGFyYW0ganNvbiB7c3RyaW5nfG9iamVjdH1cclxuICAgICAgICAgKiBAcmV0dXJucyBqc29u5a+56LGhIHtqc29ufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvSnNvbjogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBqc29uID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICBqc29uID0gJC5wYXJzZUpTT04oanNvbi5yZXBsYWNlKC8nL2csICdcIicpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ganNvbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmmluWtl+avjeWkp+WGmVxyXG4gICAgICAgICAqIEBtZXRob2QgdXBGaXJzdFxyXG4gICAgICAgICAqIEBwYXJhbSBzdHJpbmcg5a2X56ym5LiyXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ30g6aaW5a2X5q+N5aSn5YaZ55qE5a2X56ym5LiyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdXBGaXJzdDogY2FjaGVkKGZ1bmN0aW9uIChzdHIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcclxuICAgICAgICB9KSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlr7nosaHmt7HluqblkIjlubbvvIzlj6rnu6fmib/ljp/lr7nosaHmnInnmoTlsZ7mgKdcclxuICAgICAgICAgKiBAbWV0aG9kIGV4dGVuZFxyXG4gICAgICAgICAqIEBwYXJhbSBiYXNlIOWOn+WvueixoVxyXG4gICAgICAgICAqIEBwYXJhbSBjb25maWcg5ZCI5bm25a+56LGhXHJcbiAgICAgICAgICogQHJldHVybnMge29iamVjdH0g5aSE55CG5a6M55qE5Y6f5a+56LGhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZXh0ZW5kOiBmdW5jdGlvbiAoYmFzZSwgY29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJhc2UgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgY29uZmlnID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWVwKGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic29tZSBleHRlbmQgZXJyb3I6XCIsIGJhc2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJleHRlbmQgZXJyb3JcIiwgZSwgYmFzZSwgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWVwKGF0dHIsIGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGF0dHIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJba2V5XSAmJiB0eXBlb2YgYXR0cltrZXldID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGNvbmZpZ1trZXldID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShhdHRyW2tleV0pICYmICQuaXNBcnJheShjb25maWdba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCQuaXNGdW5jdGlvbihhdHRyW2tleV0pICYmICQuaXNGdW5jdGlvbihjb25maWdba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVlcChhdHRyW2tleV0sIGNvbmZpZ1trZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGF0dHJba2V5XSAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBjb25maWdba2V5XSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJba2V5XSA9IGNvbmZpZ1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gYmFzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlua1j+iniOWZqOi/nuaOpeS4iueahOWPguaVsFxyXG4gICAgICAgICAqIEBtZXRob2QgZ2V0UGFyYW1ldGVyXHJcbiAgICAgICAgICogQHBhcmFtIHBhcmFtIOWPguaVsOWQjVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0UGFyYW1ldGVyOiBmdW5jdGlvbiAocGFyYW0pIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDsvL+iOt+WPllVSTOWcsOWdgOS4re+8n+WQjueahOaJgOacieWtl+esplxyXG4gICAgICAgICAgICB2YXIgaUxlbiA9IHBhcmFtLmxlbmd0aDsvL+iOt+WPluS9oOeahOWPguaVsOWQjeensOmVv+W6plxyXG4gICAgICAgICAgICB2YXIgaVN0YXJ0ID0gcXVlcnkuaW5kZXhPZihwYXJhbSk7Ly/ojrflj5bkvaDor6Xlj4LmlbDlkI3np7DnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICAgICAgaWYgKGlTdGFydCA9PSAtMSkvLy0x5Li65rKh5pyJ6K+l5Y+C5pWwXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgaVN0YXJ0ICs9IGlMZW4gKyAxO1xyXG4gICAgICAgICAgICB2YXIgaUVuZCA9IHF1ZXJ5LmluZGV4T2YoXCImXCIsIGlTdGFydCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlhbblrp7ntKLlvJVcclxuICAgICAgICAgICAgaWYgKGlFbmQgPT0gLTEpLy/lj6rmnInkuIDkuKrlj4LmlbBcclxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5zdWJzdHJpbmcoaVN0YXJ0KTsvL+iOt+WPluWNleS4quWPguaVsOeahOWPguaVsOWAvFxyXG4gICAgICAgICAgICByZXR1cm4gcXVlcnkuc3Vic3RyaW5nKGlTdGFydCwgaUVuZCk7Ly/ojrflj5bnrKzkuozkuKrlj4LmlbDnmoTlgLxcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOS7heeUu+W4g+WFqOWxj+WxleekulxyXG4gICAgICAgICAqIEBtZXRob2QgcnVuUHJlZml4TWV0aG9kXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2RvY3VtZW50fSDkvos6Y2FudmFzXHJcbiAgICAgICAgICogQHBhcmFtIG1ldGhvZCB7c3RyaW5nfSBcIlJlcXVlc3RGdWxsU2NyZWVuXCLlhajlsY/nmoTmqKHlvI9cclxuICAgICAgICAgKi9cclxuICAgICAgICBydW5QcmVmaXhNZXRob2Q6IGZ1bmN0aW9uIChlbGVtZW50LCBtZXRob2QpIHtcclxuICAgICAgICAgICAgdmFyIHVzYWJsZVByZWZpeE1ldGhvZDtcclxuICAgICAgICAgICAgW1wid2Via2l0XCIsIFwibW96XCIsIFwibXNcIiwgXCJvXCIsIFwiXCJdLmZvckVhY2goZnVuY3Rpb24gKHByZWZpeCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2FibGVQcmVmaXhNZXRob2QpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJlZml4ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaXoOWJjee8gO+8jOaWueazlemmluWtl+avjeWwj+WGmVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSBtZXRob2Quc2xpY2UoMCwgMSkudG9Mb3dlckNhc2UoKSArIG1ldGhvZC5zbGljZSgxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGVQcmVmaXhNZXRob2QgPSB0eXBlb2YgZWxlbWVudFtwcmVmaXggKyBtZXRob2RdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlUHJlZml4TWV0aG9kICsgXCJcIiAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZVByZWZpeE1ldGhvZCA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FibGVQcmVmaXhNZXRob2QgPSBlbGVtZW50W3ByZWZpeCArIG1ldGhvZF0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWJsZVByZWZpeE1ldGhvZCA9IGVsZW1lbnRbcHJlZml4ICsgbWV0aG9kXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa1j+iniOWZqOWFqOWxj+WxleekulxyXG4gICAgICAgICAqIEBtZXRob2QgbGF1bmNoRnVsbFNjcmVlblxyXG4gICAgICAgICAqIEBwYXJhbSBlbGVtZW50IHtkb2N1bWVudH0g5L6LOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxhdW5jaEZ1bGxTY3JlZW46IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlhbPpl63mtY/op4jlmajlhajlsY9cclxuICAgICAgICAgKiBAbWV0aG9kIGV4aXRGdWxsU2NyZWVuXHJcbiAgICAgICAgICogQHBhcmFtIGRvY3VtZW50IHtkb2N1bWVudH0g5L6LOndpbmRvdy5kb2N1bWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGV4aXRGdWxsU2NyZWVuOiBmdW5jdGlvbiAoZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6aKc6Imy5a2X56ym5Liy6L2s5o2i5oiQcmdiIDE26L+b5Yi2XHJcbiAgICAgICAgICogQG1ldGhvZCB0cmFuc0hleFxyXG4gICAgICAgICAqIEBwYXJhbSBjb2xvciB7c3RyaW5nfSDkvos6XCIjYXNkZDAwXCJcclxuICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IDE26L+b5Yi2IOS+izpcIjI1NSwyNTUsMjU1XCJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmFuc0hleDogY2FjaGVkKGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgICAgICAgICBpZiAoY29sb3IgJiYgY29sb3IubGVuZ3RoID09IDcgJiYgY29sb3IuY2hhckF0KDApID09ICcjJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoMSwgMiksIDE2KSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoMywgMiksIDE2KSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChjb2xvci5zdWJzdHIoNSwgMiksIDE2KVxyXG4gICAgICAgICAgICAgICAgXS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29sb3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmlbDnu4Tmt7vliqDlhYPntKAs5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5a2Y5YWl77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICAgICAgICogQG1ldGhvZCBhcnJheVB1c2hcclxuICAgICAgICAgKiBAcGFyYW0gYXJyIOaTjeS9nOeahOaVsOe7hFxyXG4gICAgICAgICAqIEBwYXJhbSB2YWx1ZSDmk43kvZznmoTlhYPntKBcclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSDmk43kvZzmmK/lkKbmiJDlip9cclxuICAgICAgICAgKi9cclxuICAgICAgICBhcnJheVB1c2g6IGZ1bmN0aW9uIChhcnIsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChhcnIuaW5kZXhPZih2YWx1ZSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBhcnIucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmlbDnu4TliKDpmaTlhYPntKAs5aaC5p6c5pWw57uE5Lit5LiN5a2Y5Zyo5YiZ5Yig6Zmk77yM5ZCm5YiZ5LiN5YGa5pON5L2cXHJcbiAgICAgICAgICogQG1ldGhvZCBhcnJheURlbGV0ZVxyXG4gICAgICAgICAqIEBwYXJhbSBhcnIg5pON5L2c55qE5pWw57uEXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlIOaTjeS9nOeahOWFg+e0oFxyXG4gICAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IOaTjeS9nOaYr+WQpuaIkOWKn1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFycmF5RGVsZXRlOiBmdW5jdGlvbiAoYXJyLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IGFyci5pbmRleE9mKHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKGkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgYXJyLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaehOmAoOexu+e7p+aJv+WFs+ezu1xyXG4gICAgICAgICAqIEBtZXRob2QgaW5oZXJpdHNcclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjbGF6eiDmupDnsbtcclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBiYXNlQ2xhenog5Z+657G7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5oZXJpdHM6IGZ1bmN0aW9uIChjbGF6eiwgYmFzZUNsYXp6KSB7XHJcbiAgICAgICAgICAgIHZhciBjbGF6elByb3RvdHlwZSA9IGNsYXp6LnByb3RvdHlwZTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIEYoKSB7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIEYucHJvdG90eXBlID0gYmFzZUNsYXp6LnByb3RvdHlwZTtcclxuICAgICAgICAgICAgY2xhenoucHJvdG90eXBlID0gbmV3IEYoKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gY2xhenpQcm90b3R5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNsYXp6LnByb3RvdHlwZVtwcm9wXSA9IGNsYXp6UHJvdG90eXBlW3Byb3BdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNsYXp6LmNvbnN0cnVjdG9yID0gY2xheno7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmt7HluqblhYvpmoblr7nosaFcclxuICAgICAgICAgKiBAbWV0aG9kIGRlZXBDbG9uZVxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmog5b6F5YWL6ZqG5a+56LGhXHJcbiAgICAgICAgICogQHJldHVybiB7b2JqZWN0fSDlhYvpmoblkI7nmoTmlrDlr7nosaFcclxuICAgICAgICAgKi9cclxuICAgICAgICBkZWVwQ2xvbmU6IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCwgb0NsYXNzID0gdXRpbC5nZXRDbGFzcyhvYmopO1xyXG4gICAgICAgICAgICAvL+ehruWumnJlc3VsdOeahOexu+Wei1xyXG4gICAgICAgICAgICBpZiAob0NsYXNzID09PSBcIk9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChvQ2xhc3MgPT09IFwiQXJyYXlcIikge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvcHkgPSBvYmpba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICh1dGlsLmdldENsYXNzKGNvcHkpID09IFwiT2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGFyZ3VtZW50cy5jYWxsZWUoY29weSk7Ly/pgJLlvZLosIPnlKhcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJC5pc0FycmF5KGNvcHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBhcmd1bWVudHMuY2FsbGVlKGNvcHkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IG9ialtrZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blr7nosaHnmoTnsbtcclxuICAgICAgICAgKiBAbWV0aG9kIGdldENsYXNzXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IG8g5b6F5aSE55CG5a+56LGhXHJcbiAgICAgICAgICogQHJldHVybiB7c3RyaW5nfSDnsbvlkI3vvIzlpoJcIk9iamVjdFwiLFwiQXJyYXlcIlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldENsYXNzOiBmdW5jdGlvbiAobykge1xyXG4gICAgICAgICAgICBpZiAobyA9PT0gbnVsbCkgcmV0dXJuIFwiTnVsbFwiO1xyXG4gICAgICAgICAgICBpZiAobyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gXCJVbmRlZmluZWRcIjtcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliqDlhaXml7bpl7TmiLPnmoTkv6Hmga/ml6Xlv5dcclxuICAgICAgICAgKiBAbWV0aG9kIGluZm9cclxuICAgICAgICAgKiBAcGFyYW0ge2FyZ3VtZW50c30gYXJndW1lbnRzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5mbzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoUVRvcG8ubG9nLmluZm8pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mby5hcHBseShjb25zb2xlLCAkLm1lcmdlKFt1dGlsLmRhdGVGb3JtYXQobmV3IERhdGUoKSwgXCJoaDptbTpzc1wiKV0sIGFyZ3VtZW50cykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliqDlhaXml7bpl7TmiLPnmoTplJnor6/ml6Xlv5dcclxuICAgICAgICAgKiBAbWV0aG9kIGVycm9yXHJcbiAgICAgICAgICogQHBhcmFtIHthcmd1bWVudHN9IGFyZ3VtZW50c1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChRVG9wby5sb2cuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IuYXBwbHkoY29uc29sZSwgJC5tZXJnZShbdXRpbC5kYXRlRm9ybWF0KG5ldyBEYXRlKCksIFwiaGg6bW06c3NcIildLCBhcmd1bWVudHMpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5qC85byP5YyWRGF0ZeWvueixoVxyXG4gICAgICAgICAqIEBtZXRob2QgZGF0ZUZvcm1hdFxyXG4gICAgICAgICAqIEBwYXJhbSB7RGF0ZX0gZGF0ZSBEYXRl5a+56LGhXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGZ0U3RyaW5nIOagvOW8j+WMluWtl+espuS4sizlpoJcImhoOm1tOnNzXCJcclxuICAgICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZGF0ZUZvcm1hdDogZnVuY3Rpb24gKGRhdGUsIGZ0U3RyaW5nKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvbWF0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiTStcIjogZGF0ZS5nZXRNb250aCgpICsgMSwgLy/mnIjku71cclxuICAgICAgICAgICAgICAgICAgICBcImQrXCI6IGRhdGUuZ2V0RGF0ZSgpLCAvL+aXpVxyXG4gICAgICAgICAgICAgICAgICAgIFwiaCtcIjogZGF0ZS5nZXRIb3VycygpLCAvL+Wwj+aXtlxyXG4gICAgICAgICAgICAgICAgICAgIFwibStcIjogZGF0ZS5nZXRNaW51dGVzKCksIC8v5YiGXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzK1wiOiBkYXRlLmdldFNlY29uZHMoKSwgLy/np5JcclxuICAgICAgICAgICAgICAgICAgICBcInErXCI6IE1hdGguZmxvb3IoKGRhdGUuZ2V0TW9udGgoKSArIDMpIC8gMyksIC8v5a2j5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgXCJTXCI6IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCkgLy/mr6vnp5JcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAoLyh5KykvLnRlc3QoZnRTdHJpbmcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnRTdHJpbmcgPSBmdFN0cmluZy5yZXBsYWNlKFJlZ0V4cC4kMSwgKGRhdGUuZ2V0RnVsbFllYXIoKSArIFwiXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWJzdHIoNCAtIFJlZ0V4cC4kMS5sZW5ndGgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gZm9tYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChcIihcIiArIHR5cGUgKyBcIilcIikudGVzdChmdFN0cmluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChSZWdFeHAuJDEubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBmb21hdFt0eXBlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSAoXCIwMFwiICsgZm9tYXRbdHlwZV0pLnN1YnN0cigoXCJcIiArIGZvbWF0W3R5cGVdKS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ0U3RyaW5nID0gZnRTdHJpbmcucmVwbGFjZShSZWdFeHAuJDEsIHRlbXApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZnRTdHJpbmc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmnoTpgKDllK/kuIBJZOWtl+espuS4slxyXG4gICAgICAgICAqIEBtZXRob2QgbWFrZUlkXHJcbiAgICAgICAgICogQHJldHVybiB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG1ha2VJZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUzQoKSArIFwiLVwiICsgUzQoKSArIFwiLVwiICsgUzQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIpOaWreWvueixoeaYr+WQpuaYr+WFg+e0oFxyXG4gICAgICAgICAqIEBtZXRob2QgaXNFbGVtZW50XHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0VsZW1lbnQ6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldCAmJnRhcmdldC5nZXRUeXBlICYmdGFyZ2V0LmdldFR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5TQ0VORSAmJiB0YXJnZXQuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIpOaWrVFUb3Bv5a+56LGh5piv5ZCm5piv5Zu+5bGCXHJcbiAgICAgICAgICogQG1ldGhvZCBpc1NjZW5lXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc1NjZW5lOiBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhdGFyZ2V0IHx8IHRhcmdldC5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuU0NFTkU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliKTmlq1RVG9wb+WvueixoeaYr+WQpuaYr+iKgueCuVxyXG4gICAgICAgICAqIEBtZXRob2QgaXNOb2RlXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc05vZGU6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldCAmJiB0YXJnZXQuZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50Lk5PREUgJiYgdGFyZ2V0LmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliKTmlq1RVG9wb+WvueixoeaYr+WQpuaYr+WIhue7hFxyXG4gICAgICAgICAqIEBtZXRob2QgaXNDb250YWluZXJcclxuICAgICAgICAgKiBAcGFyYW0gZWxlbWVudCB7ZWxlbWVudH1cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzQ29udGFpbmVyOiBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQgJiYgdGFyZ2V0LmdldFR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5DT05UQUlORVIgJiYgdGFyZ2V0LmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDliKTmlq1RVG9wb+WvueixoeaYr+WQpuaYr+mTvuaOpVxyXG4gICAgICAgICAqIEBtZXRob2QgaXNMaW5rXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0xpbms6IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldCAmJiB0YXJnZXQuZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkxJTksgJiYgdGFyZ2V0LmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgO1xyXG5mdW5jdGlvbiBTNCgpIHtcclxuICAgIHJldHVybiAoKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKSB8IDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSB1dGlsO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC91dGlsLmpzXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9');
},2:function(module,exports,__webpack_require__){eval("/**\r\n * @module core\r\n */\r\n/**\r\n * 链路基类,用以继承 [E]开头继承于Element,[L]开头为自身api\r\n * @class [L] Link\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element = __webpack_require__(1);\r\nmodule.exports = Link;\r\nvar jtopoReset = {\r\n    //原选取后效果较暗，在暗色主题下不明显，重写为亮色\r\n    paintSelected: function (a) {\r\n        a.shadowBlur = 10;\r\n        a.shadowColor = \"rgba(255,255,255,1)\";\r\n        a.shadowOffsetX = 0;\r\n        a.shadowOffsetY = 0;\r\n    }\r\n};\r\nfunction Link(jtopo) {\r\n    if (!jtopo) {\r\n        QTopo.util.error(\"create Link without jtopo\", this);\r\n        return;\r\n    }\r\n    Element.call(this, jtopo);\r\n    /**\r\n     * 记录链路的首尾元素\r\n     * @property [L] path {object}\r\n     * @param start {object} 起始元素\r\n     * @param end {object} 终点元素\r\n     */\r\n    this.path = {\r\n        start: this.jtopo.nodeA.qtopo,\r\n        end: this.jtopo.nodeZ.qtopo\r\n    };\r\n    //在线路两端的对象上的links属性中更新自己\r\n    if (this.path.start.links && $.isArray(this.path.start.links.out)) {\r\n        if (this.path.start.links.out.indexOf(this) < 0) {\r\n            this.path.start.links.out.push(this);\r\n        }\r\n    }\r\n    if (this.path.end.links && $.isArray(this.path.end.links.in)) {\r\n        if (this.path.end.links.in.indexOf(this) < 0) {\r\n            this.path.end.links.in.push(this);\r\n        }\r\n    }\r\n    reset(this.jtopo);\r\n}\r\nQTopo.util.inherits(Link, Element);\r\n\r\nfunction reset(jtopo) {\r\n    //被選中后的样式\r\n    jtopo.paintSelected = jtopoReset.paintSelected;\r\n}\r\n/**\r\n *  获取元素基本类型,详细参考QTopo.constant中的类型定义\r\n *  @method [L] getType\r\n *  @return QTopo.constant.LINK\r\n */\r\nLink.prototype.getType = function () {\r\n    return QTopo.constant.LINK;\r\n};\r\n/**\r\n *  设置颜色\r\n *  @method [L] setColor\r\n *  @param color {string} \"255,255,255\"/\"#ffffff\"\r\n */\r\nLink.prototype.setColor = function (color) {\r\n    if (color) {\r\n        this.jtopo.strokeColor = QTopo.util.transHex(color.toLowerCase());\r\n    }\r\n    this.attr.color = this.jtopo.strokeColor;\r\n};\r\n/**\r\n *  计数设置\r\n *\r\n *  计数大于1时在链路上显示(+number)\r\n *\r\n *  QTopo.constant.link.DIRECT类型的链路可以基于此数展开\r\n *  @method [L] setNumber\r\n *  @param number {number}\r\n */\r\nLink.prototype.setNumber = function (number) {\r\n    if ($.isNumeric(number)) {\r\n        number = parseInt(number);\r\n        if (number > 1) {\r\n            this.jtopo.text = '(+' + number + ')';\r\n        } else {\r\n            number = 1;\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.number = number;\r\n    }\r\n};\r\n/**\r\n *  设置链路宽度,小于0则默认为1\r\n *  @method [L] setWidth\r\n *  @param width {number}\r\n */\r\nLink.prototype.setWidth = function (width) {\r\n    if ($.isNumeric(width)) {\r\n        var newWidth = parseInt(width);\r\n        this.jtopo.lineWidth = newWidth > 0 ? newWidth : 1; // 线宽\r\n    }\r\n    this.attr.width = this.jtopo.lineWidth;\r\n};\r\n/**\r\n *  设置链路两端的箭头属性\r\n *  @method [L] setArrow\r\n *  @param arrow {object}\r\n *\r\n *          arrow={\r\n *              size:箭头大小{number},\r\n *              offset:箭头在链路上的偏移量{number},\r\n *              start:是否显示起点箭头{boolean},\r\n *              end:是否显示终点箭头{boolean},\r\n *          }\r\n */\r\nLink.prototype.setArrow = function (arrow) {\r\n    if (arrow) {\r\n        if(typeof arrow.size!='undefined'){\r\n            this.jtopo.arrowsRadius = $.isNumeric(arrow.size) ? parseInt(arrow.size) : 0;\r\n        }\r\n        if(typeof arrow.offset!='undefined'){\r\n            this.jtopo.arrowsOffset = $.isNumeric(arrow.offset) ? parseInt(arrow.offset) : 0;\r\n        }\r\n        if (!this.attr.arrow) {\r\n            this.attr.arrow = {};\r\n        }\r\n\r\n        if (typeof arrow.start!='undefined') {\r\n            this.attr.arrow.start = typeof arrow.start == \"boolean\" ? arrow.start : arrow.start == \"true\";\r\n        }\r\n        if (typeof arrow.end!='undefined') {\r\n            this.attr.arrow.end = typeof arrow.end == \"boolean\" ? arrow.end : arrow.end == \"true\";\r\n        }\r\n    }\r\n    this.attr.arrow.size = this.jtopo.arrowsRadius;\r\n    this.attr.arrow.offset = this.jtopo.arrowsOffset;\r\n};\r\n/**\r\n *  设置相同起点和终点的链路之间的间隔大小\r\n *\r\n *  常用于设置QTopo.constant.link.DIRECT类型的链路展开时,其子链路之间的间距大小\r\n *  @method [L] setGap\r\n *  @param gap {number}\r\n */\r\nLink.prototype.setGap = function (gap) {\r\n    if (gap) {\r\n        this.jtopo.bundleGap = $.isNumeric(gap) ? parseInt(gap) : 0; // 线条之间的间隔\r\n    }\r\n    this.attr.gap = this.jtopo.bundleGap;\r\n};\r\n/**\r\n *  设置链路的虚线线段长度\r\n *\r\n *  设置不为number类型或小于0时，则认为不要虚线\r\n *\r\n *  @method [L] setDashed\r\n *  @param dashedPattern {number|null}\r\n */\r\nLink.prototype.setDashed = function (dashedPattern) {\r\n    if ($.isNumeric(dashedPattern) && dashedPattern > 0) {\r\n        this.jtopo.dashedPattern = parseInt(dashedPattern);\r\n    } else {\r\n        this.jtopo.dashedPattern = null;\r\n    }\r\n    this.attr.dashed = this.jtopo.dashedPattern;\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [L] toJson\r\n *  @return {object}\r\n */\r\nLink.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    json.start=this.path.start.get('jsonId');\r\n    json.end=this.path.end.get('jsonId');\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0xpbmsuanM/NTYwMCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLHFCQUFxQixPQUFPO0FBQzVCLG1CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBLDBCQUEwQixPQUFPO0FBQ2pDLGtDQUFrQyxPQUFPO0FBQ3pDLCtCQUErQixRQUFRO0FBQ3ZDLDZCQUE2QixRQUFRO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEIsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBjb3JlXHJcbiAqL1xyXG4vKipcclxuICog6ZO+6Lev5Z+657G7LOeUqOS7pee7p+aJvyBbRV3lvIDlpLTnu6fmib/kuo5FbGVtZW50LFtMXeW8gOWktOS4uuiHqui6q2FwaVxyXG4gKiBAY2xhc3MgW0xdIExpbmtcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtFXSBFbGVtZW50XHJcbiAqIEBwYXJhbSBqdG9wbyDlhYPntKDmoLjlv4PnmoRqdG9wb+WvueixoVxyXG4gKi9cclxudmFyIEVsZW1lbnQgPSByZXF1aXJlKFwiLi4vRWxlbWVudC5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSBMaW5rO1xyXG52YXIganRvcG9SZXNldCA9IHtcclxuICAgIC8v5Y6f6YCJ5Y+W5ZCO5pWI5p6c6L6D5pqX77yM5Zyo5pqX6Imy5Li76aKY5LiL5LiN5piO5pi+77yM6YeN5YaZ5Li65Lqu6ImyXHJcbiAgICBwYWludFNlbGVjdGVkOiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIGEuc2hhZG93Qmx1ciA9IDEwO1xyXG4gICAgICAgIGEuc2hhZG93Q29sb3IgPSBcInJnYmEoMjU1LDI1NSwyNTUsMSlcIjtcclxuICAgICAgICBhLnNoYWRvd09mZnNldFggPSAwO1xyXG4gICAgICAgIGEuc2hhZG93T2Zmc2V0WSA9IDA7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIExpbmsoanRvcG8pIHtcclxuICAgIGlmICghanRvcG8pIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIExpbmsgd2l0aG91dCBqdG9wb1wiLCB0aGlzKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBFbGVtZW50LmNhbGwodGhpcywganRvcG8pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDorrDlvZXpk77ot6/nmoTpppblsL7lhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBbTF0gcGF0aCB7b2JqZWN0fVxyXG4gICAgICogQHBhcmFtIHN0YXJ0IHtvYmplY3R9IOi1t+Wni+WFg+e0oFxyXG4gICAgICogQHBhcmFtIGVuZCB7b2JqZWN0fSDnu4jngrnlhYPntKBcclxuICAgICAqL1xyXG4gICAgdGhpcy5wYXRoID0ge1xyXG4gICAgICAgIHN0YXJ0OiB0aGlzLmp0b3BvLm5vZGVBLnF0b3BvLFxyXG4gICAgICAgIGVuZDogdGhpcy5qdG9wby5ub2RlWi5xdG9wb1xyXG4gICAgfTtcclxuICAgIC8v5Zyo57q/6Lev5Lik56uv55qE5a+56LGh5LiK55qEbGlua3PlsZ7mgKfkuK3mm7TmlrDoh6rlt7FcclxuICAgIGlmICh0aGlzLnBhdGguc3RhcnQubGlua3MgJiYgJC5pc0FycmF5KHRoaXMucGF0aC5zdGFydC5saW5rcy5vdXQpKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGF0aC5zdGFydC5saW5rcy5vdXQuaW5kZXhPZih0aGlzKSA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy5wYXRoLnN0YXJ0LmxpbmtzLm91dC5wdXNoKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLnBhdGguZW5kLmxpbmtzICYmICQuaXNBcnJheSh0aGlzLnBhdGguZW5kLmxpbmtzLmluKSkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhdGguZW5kLmxpbmtzLmluLmluZGV4T2YodGhpcykgPCAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGF0aC5lbmQubGlua3MuaW4ucHVzaCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXNldCh0aGlzLmp0b3BvKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKExpbmssIEVsZW1lbnQpO1xyXG5cclxuZnVuY3Rpb24gcmVzZXQoanRvcG8pIHtcclxuICAgIC8v6KKr6YG45Lit5ZCO55qE5qC35byPXHJcbiAgICBqdG9wby5wYWludFNlbGVjdGVkID0ganRvcG9SZXNldC5wYWludFNlbGVjdGVkO1xyXG59XHJcbi8qKlxyXG4gKiAg6I635Y+W5YWD57Sg5Z+65pys57G75Z6LLOivpue7huWPguiAg1FUb3BvLmNvbnN0YW505Lit55qE57G75Z6L5a6a5LmJXHJcbiAqICBAbWV0aG9kIFtMXSBnZXRUeXBlXHJcbiAqICBAcmV0dXJuIFFUb3BvLmNvbnN0YW50LkxJTktcclxuICovXHJcbkxpbmsucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuTElOSztcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7popzoibJcclxuICogIEBtZXRob2QgW0xdIHNldENvbG9yXHJcbiAqICBAcGFyYW0gY29sb3Ige3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiXHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdHJva2VDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuY29sb3IgPSB0aGlzLmp0b3BvLnN0cm9rZUNvbG9yO1xyXG59O1xyXG4vKipcclxuICogIOiuoeaVsOiuvue9rlxyXG4gKlxyXG4gKiAg6K6h5pWw5aSn5LqOMeaXtuWcqOmTvui3r+S4iuaYvuekuigrbnVtYmVyKVxyXG4gKlxyXG4gKiAgUVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1TnsbvlnovnmoTpk77ot6/lj6/ku6Xln7rkuo7mraTmlbDlsZXlvIBcclxuICogIEBtZXRob2QgW0xdIHNldE51bWJlclxyXG4gKiAgQHBhcmFtIG51bWJlciB7bnVtYmVyfVxyXG4gKi9cclxuTGluay5wcm90b3R5cGUuc2V0TnVtYmVyID0gZnVuY3Rpb24gKG51bWJlcikge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKG51bWJlcikpIHtcclxuICAgICAgICBudW1iZXIgPSBwYXJzZUludChudW1iZXIpO1xyXG4gICAgICAgIGlmIChudW1iZXIgPiAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICcoKycgKyBudW1iZXIgKyAnKSc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbnVtYmVyID0gMTtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXR0ci5udW1iZXIgPSBudW1iZXI7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev5a695bqmLOWwj+S6jjDliJnpu5jorqTkuLoxXHJcbiAqICBAbWV0aG9kIFtMXSBzZXRXaWR0aFxyXG4gKiAgQHBhcmFtIHdpZHRoIHtudW1iZXJ9XHJcbiAqL1xyXG5MaW5rLnByb3RvdHlwZS5zZXRXaWR0aCA9IGZ1bmN0aW9uICh3aWR0aCkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHdpZHRoKSkge1xyXG4gICAgICAgIHZhciBuZXdXaWR0aCA9IHBhcnNlSW50KHdpZHRoKTtcclxuICAgICAgICB0aGlzLmp0b3BvLmxpbmVXaWR0aCA9IG5ld1dpZHRoID4gMCA/IG5ld1dpZHRoIDogMTsgLy8g57q/5a69XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIud2lkdGggPSB0aGlzLmp0b3BvLmxpbmVXaWR0aDtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7pk77ot6/kuKTnq6/nmoTnrq3lpLTlsZ7mgKdcclxuICogIEBtZXRob2QgW0xdIHNldEFycm93XHJcbiAqICBAcGFyYW0gYXJyb3cge29iamVjdH1cclxuICpcclxuICogICAgICAgICAgYXJyb3c9e1xyXG4gKiAgICAgICAgICAgICAgc2l6ZTrnrq3lpLTlpKflsI97bnVtYmVyfSxcclxuICogICAgICAgICAgICAgIG9mZnNldDrnrq3lpLTlnKjpk77ot6/kuIrnmoTlgY/np7vph497bnVtYmVyfSxcclxuICogICAgICAgICAgICAgIHN0YXJ0OuaYr+WQpuaYvuekuui1t+eCueeureWktHtib29sZWFufSxcclxuICogICAgICAgICAgICAgIGVuZDrmmK/lkKbmmL7npLrnu4jngrnnrq3lpLR7Ym9vbGVhbn0sXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnNldEFycm93ID0gZnVuY3Rpb24gKGFycm93KSB7XHJcbiAgICBpZiAoYXJyb3cpIHtcclxuICAgICAgICBpZih0eXBlb2YgYXJyb3cuc2l6ZSE9J3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLmFycm93c1JhZGl1cyA9ICQuaXNOdW1lcmljKGFycm93LnNpemUpID8gcGFyc2VJbnQoYXJyb3cuc2l6ZSkgOiAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0eXBlb2YgYXJyb3cub2Zmc2V0IT0ndW5kZWZpbmVkJyl7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8uYXJyb3dzT2Zmc2V0ID0gJC5pc051bWVyaWMoYXJyb3cub2Zmc2V0KSA/IHBhcnNlSW50KGFycm93Lm9mZnNldCkgOiAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuYXR0ci5hcnJvdykge1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuYXJyb3cgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJyb3cuc3RhcnQhPSd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ci5hcnJvdy5zdGFydCA9IHR5cGVvZiBhcnJvdy5zdGFydCA9PSBcImJvb2xlYW5cIiA/IGFycm93LnN0YXJ0IDogYXJyb3cuc3RhcnQgPT0gXCJ0cnVlXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJyb3cuZW5kIT0ndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICB0aGlzLmF0dHIuYXJyb3cuZW5kID0gdHlwZW9mIGFycm93LmVuZCA9PSBcImJvb2xlYW5cIiA/IGFycm93LmVuZCA6IGFycm93LmVuZCA9PSBcInRydWVcIjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cuc2l6ZSA9IHRoaXMuanRvcG8uYXJyb3dzUmFkaXVzO1xyXG4gICAgdGhpcy5hdHRyLmFycm93Lm9mZnNldCA9IHRoaXMuanRvcG8uYXJyb3dzT2Zmc2V0O1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruebuOWQjOi1t+eCueWSjOe7iOeCueeahOmTvui3r+S5i+mXtOeahOmXtOmalOWkp+Wwj1xyXG4gKlxyXG4gKiAg5bi455So5LqO6K6+572uUVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1TnsbvlnovnmoTpk77ot6/lsZXlvIDml7Ys5YW25a2Q6ZO+6Lev5LmL6Ze055qE6Ze06Led5aSn5bCPXHJcbiAqICBAbWV0aG9kIFtMXSBzZXRHYXBcclxuICogIEBwYXJhbSBnYXAge251bWJlcn1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnNldEdhcCA9IGZ1bmN0aW9uIChnYXApIHtcclxuICAgIGlmIChnYXApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmJ1bmRsZUdhcCA9ICQuaXNOdW1lcmljKGdhcCkgPyBwYXJzZUludChnYXApIDogMDsgLy8g57q/5p2h5LmL6Ze055qE6Ze06ZqUXHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuZ2FwID0gdGhpcy5qdG9wby5idW5kbGVHYXA7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev55qE6Jma57q/57q/5q616ZW/5bqmXHJcbiAqXHJcbiAqICDorr7nva7kuI3kuLpudW1iZXLnsbvlnovmiJblsI/kuo4w5pe277yM5YiZ6K6k5Li65LiN6KaB6Jma57q/XHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMXSBzZXREYXNoZWRcclxuICogIEBwYXJhbSBkYXNoZWRQYXR0ZXJuIHtudW1iZXJ8bnVsbH1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnNldERhc2hlZCA9IGZ1bmN0aW9uIChkYXNoZWRQYXR0ZXJuKSB7XHJcbiAgICBpZiAoJC5pc051bWVyaWMoZGFzaGVkUGF0dGVybikgJiYgZGFzaGVkUGF0dGVybiA+IDApIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm4gPSBwYXJzZUludChkYXNoZWRQYXR0ZXJuKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuID0gbnVsbDtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kYXNoZWQgPSB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm47XHJcbn07XHJcbi8qKlxyXG4gKiAg5Y2V5Liq5a+56LGh55qE5bGe5oCn5o+Q5Y+WXHJcbiAqICBAbWV0aG9kIFtMXSB0b0pzb25cclxuICogIEByZXR1cm4ge29iamVjdH1cclxuICovXHJcbkxpbmsucHJvdG90eXBlLnRvSnNvbj1mdW5jdGlvbigpe1xyXG4gICAgdmFyIGpzb249JC5leHRlbmQoe30sdGhpcy5hdHRyKTtcclxuICAgIGpzb24uZXh0cmE9JC5leHRlbmQoe30sdGhpcy5leHRyYSk7XHJcbiAgICBqc29uLnN0YXJ0PXRoaXMucGF0aC5zdGFydC5nZXQoJ2pzb25JZCcpO1xyXG4gICAganNvbi5lbmQ9dGhpcy5wYXRoLmVuZC5nZXQoJ2pzb25JZCcpO1xyXG4gICAgcmV0dXJuIGpzb247XHJcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0xpbmsuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==")},27:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 容器基类,用以继承 [E]开头继承于Element,[C]开头为自身api\r\n * @class [C] Container\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\n\r\nvar Element = __webpack_require__(1);\r\nmodule.exports = Container;\r\nvar jtopoReset = {\r\n    //重写名称绘制，用以换行显示\r\n    paintText: function (a) {\r\n        var text = this.text;\r\n        if (null != text && "" != text) {\r\n            a.beginPath();\r\n            a.font = this.font;\r\n            var fontWidth = a.measureText("田").width;\r\n            var maxWidth = fontWidth;\r\n            a.fillStyle = "rgba(" + this.fontColor + ",1)"; //", " + this.alpha + ")";名称永远不透明\r\n            //换行检测\r\n            var texts = text.split("\\n");\r\n            for (var i = 0; i < texts.length; i++) {\r\n                var width = a.measureText(texts[i]).width;\r\n                if (width > maxWidth) {\r\n                    maxWidth = width;\r\n                }\r\n            }\r\n            var e = this.getTextPostion(this.textPosition, maxWidth, fontWidth,texts.length);\r\n            for (var j = 0; j < texts.length; j++) {\r\n                var textWidth = a.measureText(texts[j]).width;\r\n                a.fillText(texts[j], e.x + (maxWidth - textWidth) / 2, e.y + j * fontWidth);\r\n            }\r\n\r\n            a.closePath();\r\n        }\r\n    }\r\n};\r\nfunction Container(jtopo) {\r\n    if (jtopo) {\r\n        Element.call(this, jtopo);\r\n    } else {\r\n        QTopo.util.error("create Container without jtopo", this);\r\n    }\r\n    /**\r\n     * 记录容器内的元素\r\n     * @property [C] children {array}\r\n     */\r\n    this.children = [];\r\n    /**\r\n     * 记录容器上的链路\r\n     * @property [C] links {array}\r\n     * @param in 以容器为终点的链路\r\n     * @param out 以容器为起点的链路\r\n     */\r\n    this.links = {\r\n        in: [],\r\n        out: []\r\n    };\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(Container, Element);\r\nfunction reset(element) {\r\n    element.jtopo.paintText = jtopoReset.paintText;\r\n}\r\n/**\r\n *  设置容器名称\r\n *  @method [C] setName\r\n *  @param name {string}\r\n */\r\nContainer.prototype.setName = function (name) {\r\n    if (name) {\r\n        if (this.attr.namePosition != "hide") {\r\n            this.jtopo.text = name.trim();\r\n        }\r\n        this.attr.name = name.trim();\r\n    }\r\n};\r\n/**\r\n *  将元素加入容器内\r\n *  @method [C] add\r\n *  @param element {element|array} 一般为节点类型对象或数组，容器加入容器容易产生Bug\r\n */\r\nContainer.prototype.add = function (element) {\r\n    var self=this;\r\n    if (!$.isArray(this.children)) {\r\n        this.children = [];\r\n    }\r\n    if ($.isArray(element)) {\r\n        $.each(element,function(i,el){\r\n            addOnce(el);\r\n        });\r\n    }else{\r\n        addOnce(element);\r\n    }\r\n    function addOnce(element){\r\n        if (element&&check(element)&&!self.isChild(element)) {\r\n            self.children.push(element);\r\n            element.parent = self;\r\n            self.jtopo.add(element.jtopo);\r\n            if (self.attr.children && typeof self.attr.children.dragble == "boolean") {\r\n                //若分组不允许移动组内元素，手动设置元素不可移动\r\n                element.setDragable(self.attr.children.dragble);\r\n            }\r\n        }\r\n    }\r\n    function check(element){\r\n        return element.getType()==QTopo.constant.NODE&&element.getUseType()!=QTopo.constant.CASUAL&&!element.parent;\r\n    }\r\n};\r\n/**\r\n * 将子元素从容器中删除\r\n * @method [C] remove\r\n * @param element {element}\r\n */\r\nContainer.prototype.remove = function (element) {\r\n    if ($.isArray(this.children) && this.isChild(element)) {\r\n        this.children.splice(this.children.indexOf(element), 1);\r\n        delete element.parent;\r\n        this.jtopo.remove(element.jtopo);\r\n        //移除元素，应手动设回元素可移动\r\n        element.setDragable(true);\r\n    }\r\n};\r\n/**\r\n * 获取容器基本类型\r\n * @method [C] getType\r\n * @return QTopo.constant.CONTAINER\r\n */\r\nContainer.prototype.getType = function () {\r\n    return QTopo.constant.CONTAINER;\r\n};\r\n/**\r\n * 设置容器背景色\r\n * @method [C] setColor\r\n * @param color {string} "255,255,255"/"#ffffff"\r\n */\r\nContainer.prototype.setColor = function (color) {\r\n    if (color) {\r\n        color = QTopo.util.transHex(color.toLowerCase());\r\n        this.jtopo.fillColor = color;\r\n    }\r\n    this.attr.color = this.jtopo.fillColor;\r\n};\r\n/**\r\n * 设置容器内子元素一般行为,未完全实现\r\n * @method [C] setChildren\r\n * @param children {object}\r\n *          children={\r\n *                  dragble:是否可移动{boolean}\r\n *          }\r\n */\r\nContainer.prototype.setChildren = function (children) {\r\n    var jtopo = this.jtopo;\r\n    if (children) {\r\n        if (typeof children.dragble == "boolean") {\r\n            this.jtopo.childDragble = children.dragble;\r\n            for (var i = 0; i < this.children.length; i++) {\r\n                this.children[i].setDragable(children.dragble);\r\n            }\r\n        }\r\n    }\r\n    this.attr.children.dragble = jtopo.childDragble;\r\n};\r\n/**\r\n * 容器缩放切换,在scene创建时可选是否提供切换\r\n *\r\n * 可在创建时增加参数 toggle:{close:true}来创建一个不可切换的容器\r\n *\r\n * 若无切换对象，则该方法无动作\r\n * @method [C] toggle\r\n * @param [flag] 为true则强制缩放，为false则强制展开，无值则自适应切换,\r\n */\r\nContainer.prototype.toggle = function (flag) {\r\n    if (this.toggleTo) {\r\n        var gJtopo = this.jtopo;\r\n        var nJtopo = this.toggleTo.jtopo;\r\n        var todo = typeof flag == "boolean" ? flag : gJtopo.visible;\r\n        if (todo) {\r\n            //缩放\r\n            this.hide();\r\n            this.toggleTo.show();\r\n            this.toggleTo.setPosition([gJtopo.cx - nJtopo.width / 2, gJtopo.cy - nJtopo.height / 2]);\r\n        } else {\r\n            //展开\r\n            this.show();\r\n            this.toggleTo.hide();\r\n            this.setPosition([nJtopo.cx - gJtopo.width / 2, nJtopo.cy - gJtopo.height / 2]);\r\n        }\r\n    }\r\n};\r\n/**\r\n * 判断元素是否已是子元素\r\n * @method [C] isChild\r\n * @param element 判断的子元素\r\n * @return {boolean}\r\n */\r\nContainer.prototype.isChild = function (element) {\r\n    if ($.isArray(this.children)) {\r\n        var index=this.children.indexOf(element);\r\n        if (element.parent != this&& index> -1) {\r\n            QTopo.util.error("some group get error,the child\'s parent is not it and the child in its children,index is "+index, this,element);\r\n        }\r\n        return index>-1;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n/**\r\n * 判断元素是否在分组覆盖的范围内,临时元素不考虑\r\n * @method [C] isInside\r\n * @param element 判断的元素\r\n * @return {boolean}\r\n */\r\nContainer.prototype.isInside = function (element) {\r\n    if (element && element.getType() != QTopo.constant.CASUAL) {\r\n        var center = element.getCenterPosition();\r\n        return !this.isChild(element) && center.x > this.x && center.x < (this.x + this.width) && center.y > this.y && center.y < (this.y + this.height);\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n/**\r\n * 分组属性提取\r\n * @method [C] toJson\r\n * @return {object}\r\n */\r\nContainer.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    json.children=[];\r\n    this.children.map(function(child){\r\n        json.children.push(child.get(\'jsonId\'));\r\n    });\r\n    json.toggle=this.toggleTo.toJson();\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvQ29udGFpbmVyLmpzPzNhZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCwyQkFBMkI7QUFDdEY7QUFDQTtBQUNBLDJCQUEyQixrQkFBa0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGtCQUFrQjtBQUM3QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGNBQWM7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMEJBQTBCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixXQUFXO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSIsImZpbGUiOiIyNy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlrrnlmajln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW0Nd5byA5aS05Li66Ieq6LqrYXBpXHJcbiAqIEBjbGFzcyBbQ10gQ29udGFpbmVyXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcblxyXG52YXIgRWxlbWVudCA9IHJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRhaW5lcjtcclxudmFyIGp0b3BvUmVzZXQgPSB7XHJcbiAgICAvL+mHjeWGmeWQjeensOe7mOWItu+8jOeUqOS7peaNouihjOaYvuekulxyXG4gICAgcGFpbnRUZXh0OiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy50ZXh0O1xyXG4gICAgICAgIGlmIChudWxsICE9IHRleHQgJiYgXCJcIiAhPSB0ZXh0KSB7XHJcbiAgICAgICAgICAgIGEuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGEuZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgdmFyIGZvbnRXaWR0aCA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBtYXhXaWR0aCA9IGZvbnRXaWR0aDtcclxuICAgICAgICAgICAgYS5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLDEpXCI7IC8vXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO+WQjeensOawuOi/nOS4jemAj+aYjlxyXG4gICAgICAgICAgICAvL+aNouihjOajgOa1i1xyXG4gICAgICAgICAgICB2YXIgdGV4dHMgPSB0ZXh0LnNwbGl0KFwiXFxuXCIpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRleHRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBhLm1lYXN1cmVUZXh0KHRleHRzW2ldKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0VGV4dFBvc3Rpb24odGhpcy50ZXh0UG9zaXRpb24sIG1heFdpZHRoLCBmb250V2lkdGgsdGV4dHMubGVuZ3RoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0ZXh0cy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHRXaWR0aCA9IGEubWVhc3VyZVRleHQodGV4dHNbal0pLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYS5maWxsVGV4dCh0ZXh0c1tqXSwgZS54ICsgKG1heFdpZHRoIC0gdGV4dFdpZHRoKSAvIDIsIGUueSArIGogKiBmb250V2lkdGgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gQ29udGFpbmVyKGp0b3BvKSB7XHJcbiAgICBpZiAoanRvcG8pIHtcclxuICAgICAgICBFbGVtZW50LmNhbGwodGhpcywganRvcG8pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIENvbnRhaW5lciB3aXRob3V0IGp0b3BvXCIsIHRoaXMpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDorrDlvZXlrrnlmajlhoXnmoTlhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBbQ10gY2hpbGRyZW4ge2FycmF5fVxyXG4gICAgICovXHJcbiAgICB0aGlzLmNoaWxkcmVuID0gW107XHJcbiAgICAvKipcclxuICAgICAqIOiusOW9leWuueWZqOS4iueahOmTvui3r1xyXG4gICAgICogQHByb3BlcnR5IFtDXSBsaW5rcyB7YXJyYXl9XHJcbiAgICAgKiBAcGFyYW0gaW4g5Lul5a655Zmo5Li657uI54K555qE6ZO+6LevXHJcbiAgICAgKiBAcGFyYW0gb3V0IOS7peWuueWZqOS4uui1t+eCueeahOmTvui3r1xyXG4gICAgICovXHJcbiAgICB0aGlzLmxpbmtzID0ge1xyXG4gICAgICAgIGluOiBbXSxcclxuICAgICAgICBvdXQ6IFtdXHJcbiAgICB9O1xyXG4gICAgcmVzZXQodGhpcyk7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhDb250YWluZXIsIEVsZW1lbnQpO1xyXG5mdW5jdGlvbiByZXNldChlbGVtZW50KSB7XHJcbiAgICBlbGVtZW50Lmp0b3BvLnBhaW50VGV4dCA9IGp0b3BvUmVzZXQucGFpbnRUZXh0O1xyXG59XHJcbi8qKlxyXG4gKiAg6K6+572u5a655Zmo5ZCN56ewXHJcbiAqICBAbWV0aG9kIFtDXSBzZXROYW1lXHJcbiAqICBAcGFyYW0gbmFtZSB7c3RyaW5nfVxyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS5zZXROYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgIGlmIChuYW1lKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYXR0ci5uYW1lUG9zaXRpb24gIT0gXCJoaWRlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby50ZXh0ID0gbmFtZS50cmltKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXR0ci5uYW1lID0gbmFtZS50cmltKCk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg5bCG5YWD57Sg5Yqg5YWl5a655Zmo5YaFXHJcbiAqICBAbWV0aG9kIFtDXSBhZGRcclxuICogIEBwYXJhbSBlbGVtZW50IHtlbGVtZW50fGFycmF5fSDkuIDoiKzkuLroioLngrnnsbvlnovlr7nosaHmiJbmlbDnu4TvvIzlrrnlmajliqDlhaXlrrnlmajlrrnmmJPkuqfnlJ9CdWdcclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICBpZiAoISQuaXNBcnJheSh0aGlzLmNoaWxkcmVuKSkge1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcclxuICAgIH1cclxuICAgIGlmICgkLmlzQXJyYXkoZWxlbWVudCkpIHtcclxuICAgICAgICAkLmVhY2goZWxlbWVudCxmdW5jdGlvbihpLGVsKXtcclxuICAgICAgICAgICAgYWRkT25jZShlbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBhZGRPbmNlKGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gYWRkT25jZShlbGVtZW50KXtcclxuICAgICAgICBpZiAoZWxlbWVudCYmY2hlY2soZWxlbWVudCkmJiFzZWxmLmlzQ2hpbGQoZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgc2VsZi5jaGlsZHJlbi5wdXNoKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICBlbGVtZW50LnBhcmVudCA9IHNlbGY7XHJcbiAgICAgICAgICAgIHNlbGYuanRvcG8uYWRkKGVsZW1lbnQuanRvcG8pO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5hdHRyLmNoaWxkcmVuICYmIHR5cGVvZiBzZWxmLmF0dHIuY2hpbGRyZW4uZHJhZ2JsZSA9PSBcImJvb2xlYW5cIikge1xyXG4gICAgICAgICAgICAgICAgLy/oi6XliIbnu4TkuI3lhYHorrjnp7vliqjnu4TlhoXlhYPntKDvvIzmiYvliqjorr7nva7lhYPntKDkuI3lj6/np7vliqhcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0RHJhZ2FibGUoc2VsZi5hdHRyLmNoaWxkcmVuLmRyYWdibGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY2hlY2soZWxlbWVudCl7XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQuZ2V0VHlwZSgpPT1RVG9wby5jb25zdGFudC5OT0RFJiZlbGVtZW50LmdldFVzZVR5cGUoKSE9UVRvcG8uY29uc3RhbnQuQ0FTVUFMJiYhZWxlbWVudC5wYXJlbnQ7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDlsIblrZDlhYPntKDku47lrrnlmajkuK3liKDpmaRcclxuICogQG1ldGhvZCBbQ10gcmVtb3ZlXHJcbiAqIEBwYXJhbSBlbGVtZW50IHtlbGVtZW50fVxyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgaWYgKCQuaXNBcnJheSh0aGlzLmNoaWxkcmVuKSAmJiB0aGlzLmlzQ2hpbGQoZWxlbWVudCkpIHtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZSh0aGlzLmNoaWxkcmVuLmluZGV4T2YoZWxlbWVudCksIDEpO1xyXG4gICAgICAgIGRlbGV0ZSBlbGVtZW50LnBhcmVudDtcclxuICAgICAgICB0aGlzLmp0b3BvLnJlbW92ZShlbGVtZW50Lmp0b3BvKTtcclxuICAgICAgICAvL+enu+mZpOWFg+e0oO+8jOW6lOaJi+WKqOiuvuWbnuWFg+e0oOWPr+enu+WKqFxyXG4gICAgICAgIGVsZW1lbnQuc2V0RHJhZ2FibGUodHJ1ZSk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blrrnlmajln7rmnKznsbvlnotcclxuICogQG1ldGhvZCBbQ10gZ2V0VHlwZVxyXG4gKiBAcmV0dXJuIFFUb3BvLmNvbnN0YW50LkNPTlRBSU5FUlxyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIFFUb3BvLmNvbnN0YW50LkNPTlRBSU5FUjtcclxufTtcclxuLyoqXHJcbiAqIOiuvue9ruWuueWZqOiDjOaZr+iJslxyXG4gKiBAbWV0aG9kIFtDXSBzZXRDb2xvclxyXG4gKiBAcGFyYW0gY29sb3Ige3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiXHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLnNldENvbG9yID0gZnVuY3Rpb24gKGNvbG9yKSB7XHJcbiAgICBpZiAoY29sb3IpIHtcclxuICAgICAgICBjb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgdGhpcy5qdG9wby5maWxsQ29sb3IgPSBjb2xvcjtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5jb2xvciA9IHRoaXMuanRvcG8uZmlsbENvbG9yO1xyXG59O1xyXG4vKipcclxuICog6K6+572u5a655Zmo5YaF5a2Q5YWD57Sg5LiA6Iis6KGM5Li6LOacquWujOWFqOWunueOsFxyXG4gKiBAbWV0aG9kIFtDXSBzZXRDaGlsZHJlblxyXG4gKiBAcGFyYW0gY2hpbGRyZW4ge29iamVjdH1cclxuICogICAgICAgICAgY2hpbGRyZW49e1xyXG4gKiAgICAgICAgICAgICAgICAgIGRyYWdibGU65piv5ZCm5Y+v56e75Yqoe2Jvb2xlYW59XHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUuc2V0Q2hpbGRyZW4gPSBmdW5jdGlvbiAoY2hpbGRyZW4pIHtcclxuICAgIHZhciBqdG9wbyA9IHRoaXMuanRvcG87XHJcbiAgICBpZiAoY2hpbGRyZW4pIHtcclxuICAgICAgICBpZiAodHlwZW9mIGNoaWxkcmVuLmRyYWdibGUgPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5qdG9wby5jaGlsZERyYWdibGUgPSBjaGlsZHJlbi5kcmFnYmxlO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5baV0uc2V0RHJhZ2FibGUoY2hpbGRyZW4uZHJhZ2JsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuY2hpbGRyZW4uZHJhZ2JsZSA9IGp0b3BvLmNoaWxkRHJhZ2JsZTtcclxufTtcclxuLyoqXHJcbiAqIOWuueWZqOe8qeaUvuWIh+aNoizlnKhzY2VuZeWIm+W7uuaXtuWPr+mAieaYr+WQpuaPkOS+m+WIh+aNolxyXG4gKlxyXG4gKiDlj6/lnKjliJvlu7rml7blop7liqDlj4LmlbAgdG9nZ2xlOntjbG9zZTp0cnVlfeadpeWIm+W7uuS4gOS4quS4jeWPr+WIh+aNoueahOWuueWZqFxyXG4gKlxyXG4gKiDoi6Xml6DliIfmjaLlr7nosaHvvIzliJnor6Xmlrnms5Xml6DliqjkvZxcclxuICogQG1ldGhvZCBbQ10gdG9nZ2xlXHJcbiAqIEBwYXJhbSBbZmxhZ10g5Li6dHJ1ZeWImeW8uuWItue8qeaUvu+8jOS4umZhbHNl5YiZ5by65Yi25bGV5byA77yM5peg5YC85YiZ6Ieq6YCC5bqU5YiH5o2iLFxyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgaWYgKHRoaXMudG9nZ2xlVG8pIHtcclxuICAgICAgICB2YXIgZ0p0b3BvID0gdGhpcy5qdG9wbztcclxuICAgICAgICB2YXIgbkp0b3BvID0gdGhpcy50b2dnbGVUby5qdG9wbztcclxuICAgICAgICB2YXIgdG9kbyA9IHR5cGVvZiBmbGFnID09IFwiYm9vbGVhblwiID8gZmxhZyA6IGdKdG9wby52aXNpYmxlO1xyXG4gICAgICAgIGlmICh0b2RvKSB7XHJcbiAgICAgICAgICAgIC8v57yp5pS+XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRvLnNob3coKTtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVUby5zZXRQb3NpdGlvbihbZ0p0b3BvLmN4IC0gbkp0b3BvLndpZHRoIC8gMiwgZ0p0b3BvLmN5IC0gbkp0b3BvLmhlaWdodCAvIDJdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL+WxleW8gFxyXG4gICAgICAgICAgICB0aGlzLnNob3coKTtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVUby5oaWRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UG9zaXRpb24oW25KdG9wby5jeCAtIGdKdG9wby53aWR0aCAvIDIsIG5KdG9wby5jeSAtIGdKdG9wby5oZWlnaHQgLyAyXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog5Yik5pat5YWD57Sg5piv5ZCm5bey5piv5a2Q5YWD57SgXHJcbiAqIEBtZXRob2QgW0NdIGlzQ2hpbGRcclxuICogQHBhcmFtIGVsZW1lbnQg5Yik5pat55qE5a2Q5YWD57SgXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAqL1xyXG5Db250YWluZXIucHJvdG90eXBlLmlzQ2hpbGQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgaWYgKCQuaXNBcnJheSh0aGlzLmNoaWxkcmVuKSkge1xyXG4gICAgICAgIHZhciBpbmRleD10aGlzLmNoaWxkcmVuLmluZGV4T2YoZWxlbWVudCk7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQucGFyZW50ICE9IHRoaXMmJiBpbmRleD4gLTEpIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcInNvbWUgZ3JvdXAgZ2V0IGVycm9yLHRoZSBjaGlsZCdzIHBhcmVudCBpcyBub3QgaXQgYW5kIHRoZSBjaGlsZCBpbiBpdHMgY2hpbGRyZW4saW5kZXggaXMgXCIraW5kZXgsIHRoaXMsZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbmRleD4tMTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog5Yik5pat5YWD57Sg5piv5ZCm5Zyo5YiG57uE6KaG55uW55qE6IyD5Zu05YaFLOS4tOaXtuWFg+e0oOS4jeiAg+iZkVxyXG4gKiBAbWV0aG9kIFtDXSBpc0luc2lkZVxyXG4gKiBAcGFyYW0gZWxlbWVudCDliKTmlq3nmoTlhYPntKBcclxuICogQHJldHVybiB7Ym9vbGVhbn1cclxuICovXHJcbkNvbnRhaW5lci5wcm90b3R5cGUuaXNJbnNpZGUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5nZXRUeXBlKCkgIT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgdmFyIGNlbnRlciA9IGVsZW1lbnQuZ2V0Q2VudGVyUG9zaXRpb24oKTtcclxuICAgICAgICByZXR1cm4gIXRoaXMuaXNDaGlsZChlbGVtZW50KSAmJiBjZW50ZXIueCA+IHRoaXMueCAmJiBjZW50ZXIueCA8ICh0aGlzLnggKyB0aGlzLndpZHRoKSAmJiBjZW50ZXIueSA+IHRoaXMueSAmJiBjZW50ZXIueSA8ICh0aGlzLnkgKyB0aGlzLmhlaWdodCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOWIhue7hOWxnuaAp+aPkOWPllxyXG4gKiBAbWV0aG9kIFtDXSB0b0pzb25cclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKi9cclxuQ29udGFpbmVyLnByb3RvdHlwZS50b0pzb249ZnVuY3Rpb24oKXtcclxuICAgIHZhciBqc29uPSQuZXh0ZW5kKHt9LHRoaXMuYXR0cik7XHJcbiAgICBqc29uLmV4dHJhPSQuZXh0ZW5kKHt9LHRoaXMuZXh0cmEpO1xyXG4gICAganNvbi5jaGlsZHJlbj1bXTtcclxuICAgIHRoaXMuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uKGNoaWxkKXtcclxuICAgICAgICBqc29uLmNoaWxkcmVuLnB1c2goY2hpbGQuZ2V0KCdqc29uSWQnKSk7XHJcbiAgICB9KTtcclxuICAgIGpzb24udG9nZ2xlPXRoaXMudG9nZ2xlVG8udG9Kc29uKCk7XHJcbiAgICByZXR1cm4ganNvbjtcclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L2NvbnRhaW5lci9Db250YWluZXIuanNcbi8vIG1vZHVsZSBpZCA9IDI3XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},28:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  Group\r\n * @constructor\r\n * @extends [C] Container\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Container=__webpack_require__(27);\r\nmodule.exports =  {\r\n    constructor:Group,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n        name: \'group\',\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        color: \'10,10,100\',\r\n        alpha: 0.5,\r\n        dragable: true,\r\n        zIndex: 10,\r\n        jsonId:"",\r\n        border:{\r\n            width:0,\r\n            radius:30,//最大160 最小0\r\n            color:"255,0,0"\r\n        },\r\n        size:[500,500],\r\n        position:[0,0],\r\n        namePosition: \'bottom\',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n        layout: {\r\n            type:"default"\r\n        },\r\n        children:{\r\n            showLink: false,\r\n            showName: true,\r\n            dragble: true\r\n        },\r\n        useType:QTopo.constant.container.GROUP\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//----\r\n//----\r\nfunction Group(config) {\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    Container.call(this, new JTopo.Container());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n}\r\nQTopo.util.inherits(Group,Container);\r\n//-\r\nvar fixedLayout=function(group, children){\r\n    if(this.qtopo){\r\n        if(group.width==0||group.height==0){\r\n            group.width=this.qtopo.attr.size[0];\r\n            group.height=this.qtopo.attr.size[1];\r\n        }\r\n        if(group.width>0&&group.height>0){\r\n            var groupBound=group.getBound();\r\n            children.map(function(child){\r\n                resetLocation(groupBound,child);\r\n            });\r\n        }else{\r\n            //若未设置高宽则运行一次自动布局设置高宽\r\n            JTopo.Layout.AutoBoundLayout()(group, children);\r\n        }\r\n    }else{\r\n        QTopo.util.error("the container not wrap with qtopo",this);\r\n    }\r\n};\r\nfunction resetLocation(groupBound,child){\r\n    var childBound=child.getBound();\r\n    var location=child.getLocation();\r\n    if(childBound.bottom>groupBound.bottom){\r\n        location.y=groupBound.bottom-childBound.height;\r\n    }\r\n    if(childBound.right>groupBound.right){\r\n        location.x=groupBound.right-childBound.width;\r\n    }\r\n    if(childBound.left<groupBound.left){\r\n        location.x=groupBound.left;\r\n    }\r\n    if(childBound.top<groupBound.top){\r\n        location.y=groupBound.top;\r\n    }\r\n    child.setLocation(location.x,location.y);\r\n}\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\n//-\r\n/**\r\n *\r\n *  @method setLayout\r\n *  @param layout {object} 图片相对路径\r\n *      @param layout.type {string} flow(固定宽高,组员流式布局), grid(固定宽高,组员行列布局), fixed(固定宽高,组员可拖动), default(宽高自适应)\r\n *      @param [layout.row] {number} 当type=flow时,用以设置水平间隔 ,当type=grid时,用以设置行数\r\n *      @param [layout.column] {number} 当type=flow时,用以设置垂直间隔 ,当type=grid时,用以设置列数\r\n */\r\nGroup.prototype.setLayout=function(layout){\r\n    var selected;\r\n    if (layout) {\r\n        switch (layout.type) {\r\n            case \'flow\':\r\n                // 流式布局（水平,垂直间隔)\r\n                selected = JTopo.layout.FlowLayout(parseInt(layout.row), parseInt(layout.column));\r\n                this.attr.layout=layout;\r\n                break;\r\n            case \'grid\':\r\n                // 网格布局(行,列)\r\n                var rows=parseInt(layout.row);\r\n                var columns=parseInt(layout.column);\r\n                if(rows*columns<this.children.length){\r\n                    QTopo.util.error("GridLayout\'s row*column need bigger than group\'s children length");\r\n                    columns=rows= Math.ceil(Math.sqrt(todo.target.children.length));\r\n                }\r\n                selected = JTopo.layout.GridLayout(rows,columns);\r\n                this.attr.layout=layout;\r\n                break;\r\n            case \'fixed\':\r\n                //固定长宽布局\r\n                selected = fixedLayout;\r\n                this.attr.layout=layout;\r\n                break;\r\n            default:\r\n                selected = JTopo.Layout.AutoBoundLayout();\r\n                this.attr.layout={};\r\n                this.attr.layout.type="default";\r\n        }\r\n    } else {\r\n        selected = JTopo.Layout.AutoBoundLayout();\r\n        this.attr.layout={};\r\n        this.attr.layout.type="default";\r\n    }\r\n    this.jtopo.layout = selected;\r\n};\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT = {\r\n                                name: \'group\',\r\n                                font:{\r\n                                    size:16,\r\n                                    type:"微软雅黑",\r\n                                    color:\'255,255,255\'\r\n                                },\r\n                                color: \'10,10,100\',\r\n                                alpha: 0.5,\r\n                                dragable: true,\r\n                                zIndex: 10,\r\n                                jsonId:"",\r\n                                border:{\r\n                                    width:0,\r\n                                    radius:30,//最大160 最小0\r\n                                    color:"255,0,0"\r\n                                },\r\n                                size:[500,500],\r\n                                position:[0,0],\r\n                                namePosition: \'bottom\',//Bottom_Center Top_Center Middle_Left Middle_Right Hidden,\r\n                                layout: {\r\n                                    type:"default"\r\n                                },\r\n                                children:{//待定设置，未完全实现\r\n                                    showLink: false,\r\n                                    showName: true,\r\n                                    dragble: true\r\n                                },\r\n                                useType:QTopo.constant.container.GROUP\r\n                        };\r\n */\r\nGroup.prototype.getDefault=getDefault;\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanM/YjdmYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCLDRCQUE0QixPQUFPO0FBQ25DLDZCQUE2QixPQUFPO0FBQ3BDLGdDQUFnQyxPQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjI4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOWbvuW9ouiKgueCuVxyXG4gKiBAY2xhc3MgIEdyb3VwXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbQ10gQ29udGFpbmVyXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBDb250YWluZXI9cmVxdWlyZShcIi4vQ29udGFpbmVyLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9ICB7XHJcbiAgICBjb25zdHJ1Y3RvcjpHcm91cCxcclxuICAgIHNldERlZmF1bHQ6c2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6Z2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQgPSB7XHJcbiAgICAgICAgbmFtZTogJ2dyb3VwJyxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb2xvcjogJzEwLDEwLDEwMCcsXHJcbiAgICAgICAgYWxwaGE6IDAuNSxcclxuICAgICAgICBkcmFnYWJsZTogdHJ1ZSxcclxuICAgICAgICB6SW5kZXg6IDEwLFxyXG4gICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgIGJvcmRlcjp7XHJcbiAgICAgICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgICAgIHJhZGl1czozMCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgIGNvbG9yOlwiMjU1LDAsMFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzaXplOls1MDAsNTAwXSxcclxuICAgICAgICBwb3NpdGlvbjpbMCwwXSxcclxuICAgICAgICBuYW1lUG9zaXRpb246ICdib3R0b20nLC8vQm90dG9tX0NlbnRlciBUb3BfQ2VudGVyIE1pZGRsZV9MZWZ0IE1pZGRsZV9SaWdodCBIaWRkZW4sXHJcbiAgICAgICAgbGF5b3V0OiB7XHJcbiAgICAgICAgICAgIHR5cGU6XCJkZWZhdWx0XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNoaWxkcmVuOntcclxuICAgICAgICAgICAgc2hvd0xpbms6IGZhbHNlLFxyXG4gICAgICAgICAgICBzaG93TmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgZHJhZ2JsZTogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXNlVHlwZTpRVG9wby5jb25zdGFudC5jb250YWluZXIuR1JPVVBcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpe1xyXG4gICAgUVRvcG8udXRpbC5leHRlbmQoREVGQVVMVCwgY29uZmlnIHx8IHt9KTtcclxufVxyXG5mdW5jdGlvbiBnZXREZWZhdWx0KCl7XHJcbiAgICByZXR1cm4gUVRvcG8udXRpbC5kZWVwQ2xvbmUoREVGQVVMVCk7XHJcbn1cclxuLy8tXHJcbi8vLS0tLVxyXG4vLy0tLS1cclxuZnVuY3Rpb24gR3JvdXAoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSAgUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgQ29udGFpbmVyLmNhbGwodGhpcywgbmV3IEpUb3BvLkNvbnRhaW5lcigpKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhHcm91cCxDb250YWluZXIpO1xyXG4vLy1cclxudmFyIGZpeGVkTGF5b3V0PWZ1bmN0aW9uKGdyb3VwLCBjaGlsZHJlbil7XHJcbiAgICBpZih0aGlzLnF0b3BvKXtcclxuICAgICAgICBpZihncm91cC53aWR0aD09MHx8Z3JvdXAuaGVpZ2h0PT0wKXtcclxuICAgICAgICAgICAgZ3JvdXAud2lkdGg9dGhpcy5xdG9wby5hdHRyLnNpemVbMF07XHJcbiAgICAgICAgICAgIGdyb3VwLmhlaWdodD10aGlzLnF0b3BvLmF0dHIuc2l6ZVsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZ3JvdXAud2lkdGg+MCYmZ3JvdXAuaGVpZ2h0PjApe1xyXG4gICAgICAgICAgICB2YXIgZ3JvdXBCb3VuZD1ncm91cC5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5tYXAoZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgICAgICAgICAgcmVzZXRMb2NhdGlvbihncm91cEJvdW5kLGNoaWxkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8v6Iul5pyq6K6+572u6auY5a695YiZ6L+Q6KGM5LiA5qyh6Ieq5Yqo5biD5bGA6K6+572u6auY5a69XHJcbiAgICAgICAgICAgIEpUb3BvLkxheW91dC5BdXRvQm91bmRMYXlvdXQoKShncm91cCwgY2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH1lbHNle1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJ0aGUgY29udGFpbmVyIG5vdCB3cmFwIHdpdGggcXRvcG9cIix0aGlzKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gcmVzZXRMb2NhdGlvbihncm91cEJvdW5kLGNoaWxkKXtcclxuICAgIHZhciBjaGlsZEJvdW5kPWNoaWxkLmdldEJvdW5kKCk7XHJcbiAgICB2YXIgbG9jYXRpb249Y2hpbGQuZ2V0TG9jYXRpb24oKTtcclxuICAgIGlmKGNoaWxkQm91bmQuYm90dG9tPmdyb3VwQm91bmQuYm90dG9tKXtcclxuICAgICAgICBsb2NhdGlvbi55PWdyb3VwQm91bmQuYm90dG9tLWNoaWxkQm91bmQuaGVpZ2h0O1xyXG4gICAgfVxyXG4gICAgaWYoY2hpbGRCb3VuZC5yaWdodD5ncm91cEJvdW5kLnJpZ2h0KXtcclxuICAgICAgICBsb2NhdGlvbi54PWdyb3VwQm91bmQucmlnaHQtY2hpbGRCb3VuZC53aWR0aDtcclxuICAgIH1cclxuICAgIGlmKGNoaWxkQm91bmQubGVmdDxncm91cEJvdW5kLmxlZnQpe1xyXG4gICAgICAgIGxvY2F0aW9uLng9Z3JvdXBCb3VuZC5sZWZ0O1xyXG4gICAgfVxyXG4gICAgaWYoY2hpbGRCb3VuZC50b3A8Z3JvdXBCb3VuZC50b3Ape1xyXG4gICAgICAgIGxvY2F0aW9uLnk9Z3JvdXBCb3VuZC50b3A7XHJcbiAgICB9XHJcbiAgICBjaGlsZC5zZXRMb2NhdGlvbihsb2NhdGlvbi54LGxvY2F0aW9uLnkpO1xyXG59XHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGY9dGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuLy8tXHJcbi8qKlxyXG4gKlxyXG4gKiAgQG1ldGhvZCBzZXRMYXlvdXRcclxuICogIEBwYXJhbSBsYXlvdXQge29iamVjdH0g5Zu+54mH55u45a+56Lev5b6EXHJcbiAqICAgICAgQHBhcmFtIGxheW91dC50eXBlIHtzdHJpbmd9IGZsb3co5Zu65a6a5a696auYLOe7hOWRmOa1geW8j+W4g+WxgCksIGdyaWQo5Zu65a6a5a696auYLOe7hOWRmOihjOWIl+W4g+WxgCksIGZpeGVkKOWbuuWumuWuvemrmCznu4TlkZjlj6/mi5bliqgpLCBkZWZhdWx0KOWuvemrmOiHqumAguW6lClcclxuICogICAgICBAcGFyYW0gW2xheW91dC5yb3ddIHtudW1iZXJ9IOW9k3R5cGU9Zmxvd+aXtiznlKjku6Xorr7nva7msLTlubPpl7TpmpQgLOW9k3R5cGU9Z3JpZOaXtiznlKjku6Xorr7nva7ooYzmlbBcclxuICogICAgICBAcGFyYW0gW2xheW91dC5jb2x1bW5dIHtudW1iZXJ9IOW9k3R5cGU9Zmxvd+aXtiznlKjku6Xorr7nva7lnoLnm7Tpl7TpmpQgLOW9k3R5cGU9Z3JpZOaXtiznlKjku6Xorr7nva7liJfmlbBcclxuICovXHJcbkdyb3VwLnByb3RvdHlwZS5zZXRMYXlvdXQ9ZnVuY3Rpb24obGF5b3V0KXtcclxuICAgIHZhciBzZWxlY3RlZDtcclxuICAgIGlmIChsYXlvdXQpIHtcclxuICAgICAgICBzd2l0Y2ggKGxheW91dC50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Zsb3cnOlxyXG4gICAgICAgICAgICAgICAgLy8g5rWB5byP5biD5bGA77yI5rC05bmzLOWeguebtOmXtOmalClcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gSlRvcG8ubGF5b3V0LkZsb3dMYXlvdXQocGFyc2VJbnQobGF5b3V0LnJvdyksIHBhcnNlSW50KGxheW91dC5jb2x1bW4pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9bGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2dyaWQnOlxyXG4gICAgICAgICAgICAgICAgLy8g572R5qC85biD5bGAKOihjCzliJcpXHJcbiAgICAgICAgICAgICAgICB2YXIgcm93cz1wYXJzZUludChsYXlvdXQucm93KTtcclxuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5zPXBhcnNlSW50KGxheW91dC5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgaWYocm93cypjb2x1bW5zPHRoaXMuY2hpbGRyZW4ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiR3JpZExheW91dCdzIHJvdypjb2x1bW4gbmVlZCBiaWdnZXIgdGhhbiBncm91cCdzIGNoaWxkcmVuIGxlbmd0aFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zPXJvd3M9IE1hdGguY2VpbChNYXRoLnNxcnQodG9kby50YXJnZXQuY2hpbGRyZW4ubGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLmxheW91dC5HcmlkTGF5b3V0KHJvd3MsY29sdW1ucyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0PWxheW91dDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdmaXhlZCc6XHJcbiAgICAgICAgICAgICAgICAvL+WbuuWumumVv+WuveW4g+WxgFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSBmaXhlZExheW91dDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9bGF5b3V0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLkxheW91dC5BdXRvQm91bmRMYXlvdXQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ci5sYXlvdXQ9e307XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIubGF5b3V0LnR5cGU9XCJkZWZhdWx0XCI7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzZWxlY3RlZCA9IEpUb3BvLkxheW91dC5BdXRvQm91bmRMYXlvdXQoKTtcclxuICAgICAgICB0aGlzLmF0dHIubGF5b3V0PXt9O1xyXG4gICAgICAgIHRoaXMuYXR0ci5sYXlvdXQudHlwZT1cImRlZmF1bHRcIjtcclxuICAgIH1cclxuICAgIHRoaXMuanRvcG8ubGF5b3V0ID0gc2VsZWN0ZWQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5YWo5bGA6K6+572uXHJcbiAqICBAbWV0aG9kIGdldERlZmF1bHRcclxuICogIEByZXR1cm4gY29uZmlnIHtvYmplY3R9IOWFqOWxgOmFjee9rueahOWFi+mahuWvueixoVvlj6ror7td77yM5L+u5pS56K+l5a+56LGh5LiN5Lya55u05o6l5L+u5pS55YWo5bGA6YWN572u77yM6Iul6KaB5L+u5pS55YWo5bGA6YWN572u6K+35L2/55Soc2NlbmUuc2V0RGVmYXVsdFxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg6buY6K6k5YWo5bGA5Y+C5pWwOlxyXG4gKiAgICAgICAgICAgICAgdmFyIERFRkFVTFQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2dyb3VwJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzEwLDEwLDEwMCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDAuNSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcmFnYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDEwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcjp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czozMCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOlwiMjU1LDAsMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOls1MDAsNTAwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjpbMCwwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lUG9zaXRpb246ICdib3R0b20nLC8vQm90dG9tX0NlbnRlciBUb3BfQ2VudGVyIE1pZGRsZV9MZWZ0IE1pZGRsZV9SaWdodCBIaWRkZW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6XCJkZWZhdWx0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOnsvL+W+heWumuiuvue9ru+8jOacquWujOWFqOWunueOsFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TGluazogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dOYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcmFnYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOlFUb3BvLmNvbnN0YW50LmNvbnRhaW5lci5HUk9VUFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuR3JvdXAucHJvdG90eXBlLmdldERlZmF1bHQ9Z2V0RGVmYXVsdDtcclxuLy8tXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9jb250YWluZXIvR3JvdXAuanNcbi8vIG1vZHVsZSBpZCA9IDI4XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},29:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  DirectLine\r\n * @constructor\r\n * @extends [LE] Line\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Line=__webpack_require__(30);\r\nmodule.exports =  {\r\n    constructor:DirectLine,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT={\r\n        num: 1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:null,\r\n            offset:0,\r\n            start:false,\r\n            end:true\r\n        },\r\n        jsonId:"",\r\n        gap:20,\r\n        position:{\r\n            start:[0,0],\r\n            end:[0,100]\r\n        },\r\n        path:{\r\n            start:{},\r\n            end:{}\r\n        },\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 80,\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        useType: QTopo.constant.line.DIRECT,\r\n        bundleOffset:60// 多条直线时，线条折线拐角处的长度\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//----\r\nvar jtopoReset={\r\n    //双向箭头\r\n    getStartPosition:function () {\r\n        var a;\r\n        return null != this.arrowsRadius && (a = (function (thisl) {\r\n            var b = thisl.nodeA, c = thisl.nodeZ;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), null == a && (a = {\r\n            x: this.nodeA.cx,\r\n            y: this.nodeA.cy\r\n        }), a;\r\n    },\r\n    paintPath:function (a, b) {\r\n        if (this.nodeA === this.nodeZ) return void this.paintLoop(a);\r\n        a.beginPath(),\r\n            a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++) {\r\n            null == this.dashedPattern ? (\r\n                (null == this.PointPathColor ? a.lineTo(b[c].x, b[c].y) : a.JtopoDrawPointPath(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, a.strokeStyle, this.PointPathColor))\r\n            ) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern)\r\n        }\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (this.qtopo.attr.arrow.end) {\r\n                this.paintArrow(a, b[0], b[b.length - 1]);\r\n            }//终点箭头\r\n            if (this.qtopo.attr.arrow.start) {\r\n                this.paintArrow(a, b[b.length - 1], b[0]);\r\n            }//起点箭头\r\n        }\r\n    }\r\n};\r\n//----\r\nfunction DirectLine(config) {\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    //line基于不加入画布的节点之间的线生成\r\n    Line.call(this,new JTopo.Link(new JTopo.Node(), new JTopo.Node()));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n    //源码修改\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(DirectLine,Line);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(Line){\r\n    Line.jtopo.getStartPosition = jtopoReset.getStartPosition;\r\n    Line.jtopo.paintPath = jtopoReset.paintPath;\r\n}\r\n/**\r\n *  设置直线两端的线段长度\r\n *\r\n *  当一条链路的两端元素之间有多条链路时，链路将会分成三段绘制并偏移，以区分其他链路\r\n *  @method setBundleOffset\r\n *  @param bundleOffset {number}\r\n */\r\nDirectLine.prototype.setBundleOffset=function(bundleOffset){\r\n    if($.isNumeric(bundleOffset)){\r\n        this.jtopo.bundleOffset=parseInt(bundleOffset);\r\n    }\r\n    this.attr.bundleOffset=this.jtopo.bundleOffset;\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                position:{\r\n                                    start:[0,0],\r\n                                    end:[0,100]\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 3,\r\n                                dashed: null,\r\n                                zIndex: 100,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                expendAble: true,\r\n                                useType: QTopo.constant.line.DIRECT,\r\n                                bundleOffset: 60// 多条直线时，线条折线拐角处的长度\r\n                            };\r\n */\r\nDirectLine.prototype.getDefault=getDefault;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5lL0RpcmVjdC5qcz85OTFmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMjkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBjb3JlXHJcbiAqL1xyXG4vKipcclxuICog5Zu+5b2i6IqC54K5XHJcbiAqIEBjbGFzcyAgRGlyZWN0TGluZVxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0xFXSBMaW5lXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBMaW5lPXJlcXVpcmUoXCIuL0xpbmUuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0gIHtcclxuICAgIGNvbnN0cnVjdG9yOkRpcmVjdExpbmUsXHJcbiAgICBzZXREZWZhdWx0OnNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OmdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUPXtcclxuICAgICAgICBudW06IDEsXHJcbiAgICAgICAgYWxwaGE6MSxcclxuICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgc2l6ZTpudWxsLFxyXG4gICAgICAgICAgICBvZmZzZXQ6MCxcclxuICAgICAgICAgICAgc3RhcnQ6ZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZDp0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICBnYXA6MjAsXHJcbiAgICAgICAgcG9zaXRpb246e1xyXG4gICAgICAgICAgICBzdGFydDpbMCwwXSxcclxuICAgICAgICAgICAgZW5kOlswLDEwMF1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHBhdGg6e1xyXG4gICAgICAgICAgICBzdGFydDp7fSxcclxuICAgICAgICAgICAgZW5kOnt9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3aWR0aDogMixcclxuICAgICAgICBkYXNoZWQ6ICBudWxsLFxyXG4gICAgICAgIHpJbmRleCA6IDgwLFxyXG4gICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICBzaXplOjE2LFxyXG4gICAgICAgICAgICB0eXBlOlwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmUuRElSRUNULFxyXG4gICAgICAgIGJ1bmRsZU9mZnNldDo2MC8vIOWkmuadoeebtOe6v+aXtu+8jOe6v+adoeaKmOe6v+aLkOinkuWkhOeahOmVv+W6plxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZyl7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKXtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuLy8tLS0tXHJcbnZhciBqdG9wb1Jlc2V0PXtcclxuICAgIC8v5Y+M5ZCR566t5aS0XHJcbiAgICBnZXRTdGFydFBvc2l0aW9uOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYTtcclxuICAgICAgICByZXR1cm4gbnVsbCAhPSB0aGlzLmFycm93c1JhZGl1cyAmJiAoYSA9IChmdW5jdGlvbiAodGhpc2wpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzbC5ub2RlQSwgYyA9IHRoaXNsLm5vZGVaO1xyXG4gICAgICAgICAgICB2YXIgZCA9IEpUb3BvLnV0aWwubGluZUYoYi5jeCwgYi5jeSwgYy5jeCwgYy5jeSk7XHJcbiAgICAgICAgICAgIHZhciBlID0gYi5nZXRCb3VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gZiA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uTGluZUJvdW5kKGQsIGUpO1xyXG4gICAgICAgIH0pKHRoaXMpKSwgbnVsbCA9PSBhICYmIChhID0ge1xyXG4gICAgICAgICAgICB4OiB0aGlzLm5vZGVBLmN4LFxyXG4gICAgICAgICAgICB5OiB0aGlzLm5vZGVBLmN5XHJcbiAgICAgICAgfSksIGE7XHJcbiAgICB9LFxyXG4gICAgcGFpbnRQYXRoOmZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopIHJldHVybiB2b2lkIHRoaXMucGFpbnRMb29wKGEpO1xyXG4gICAgICAgIGEuYmVnaW5QYXRoKCksXHJcbiAgICAgICAgICAgIGEubW92ZVRvKGJbMF0ueCwgYlswXS55KTtcclxuICAgICAgICBmb3IgKHZhciBjID0gMTsgYyA8IGIubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmRhc2hlZFBhdHRlcm4gPyAoXHJcbiAgICAgICAgICAgICAgICAobnVsbCA9PSB0aGlzLlBvaW50UGF0aENvbG9yID8gYS5saW5lVG8oYltjXS54LCBiW2NdLnkpIDogYS5KdG9wb0RyYXdQb2ludFBhdGgoYltjIC0gMV0ueCwgYltjIC0gMV0ueSwgYltjXS54LCBiW2NdLnksIGEuc3Ryb2tlU3R5bGUsIHRoaXMuUG9pbnRQYXRoQ29sb3IpKVxyXG4gICAgICAgICAgICApIDogYS5KVG9wb0Rhc2hlZExpbmVUbyhiW2MgLSAxXS54LCBiW2MgLSAxXS55LCBiW2NdLngsIGJbY10ueSwgdGhpcy5kYXNoZWRQYXR0ZXJuKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYS5zdHJva2UoKSwgYS5jbG9zZVBhdGgoKSwgbnVsbCAhPSB0aGlzLmFycm93c1JhZGl1cykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5xdG9wby5hdHRyLmFycm93LmVuZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGEsIGJbMF0sIGJbYi5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgIH0vL+e7iOeCueeureWktFxyXG4gICAgICAgICAgICBpZiAodGhpcy5xdG9wby5hdHRyLmFycm93LnN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgYltiLmxlbmd0aCAtIDFdLCBiWzBdKTtcclxuICAgICAgICAgICAgfS8v6LW354K5566t5aS0XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vLy0tLS1cclxuZnVuY3Rpb24gRGlyZWN0TGluZShjb25maWcpIHtcclxuICAgIHRoaXMuYXR0ciA9ICBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICAvL2xpbmXln7rkuo7kuI3liqDlhaXnlLvluIPnmoToioLngrnkuYvpl7TnmoTnur/nlJ/miJBcclxuICAgIExpbmUuY2FsbCh0aGlzLG5ldyBKVG9wby5MaW5rKG5ldyBKVG9wby5Ob2RlKCksIG5ldyBKVG9wby5Ob2RlKCkpKTtcclxuICAgIC8v5Ye95pWwXHJcbiAgICB0aGlzLnNldCA9IHNldEpUb3BvO1xyXG4gICAgLy/liJ3lp4vljJZcclxuICAgIHRoaXMuc2V0KHRoaXMuYXR0cik7XHJcbiAgICAvL+a6kOeggeS/ruaUuVxyXG4gICAgcmVzZXQodGhpcyk7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhEaXJlY3RMaW5lLExpbmUpO1xyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgc2VsZi5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlc2V0KExpbmUpe1xyXG4gICAgTGluZS5qdG9wby5nZXRTdGFydFBvc2l0aW9uID0ganRvcG9SZXNldC5nZXRTdGFydFBvc2l0aW9uO1xyXG4gICAgTGluZS5qdG9wby5wYWludFBhdGggPSBqdG9wb1Jlc2V0LnBhaW50UGF0aDtcclxufVxyXG4vKipcclxuICogIOiuvue9ruebtOe6v+S4pOerr+eahOe6v+autemVv+W6plxyXG4gKlxyXG4gKiAg5b2T5LiA5p2h6ZO+6Lev55qE5Lik56uv5YWD57Sg5LmL6Ze05pyJ5aSa5p2h6ZO+6Lev5pe277yM6ZO+6Lev5bCG5Lya5YiG5oiQ5LiJ5q6157uY5Yi25bm25YGP56e777yM5Lul5Yy65YiG5YW25LuW6ZO+6LevXHJcbiAqICBAbWV0aG9kIHNldEJ1bmRsZU9mZnNldFxyXG4gKiAgQHBhcmFtIGJ1bmRsZU9mZnNldCB7bnVtYmVyfVxyXG4gKi9cclxuRGlyZWN0TGluZS5wcm90b3R5cGUuc2V0QnVuZGxlT2Zmc2V0PWZ1bmN0aW9uKGJ1bmRsZU9mZnNldCl7XHJcbiAgICBpZigkLmlzTnVtZXJpYyhidW5kbGVPZmZzZXQpKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmJ1bmRsZU9mZnNldD1wYXJzZUludChidW5kbGVPZmZzZXQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyLmJ1bmRsZU9mZnNldD10aGlzLmp0b3BvLmJ1bmRsZU9mZnNldDtcclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6WzAsMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDpbMCwxMDBdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXA6IDIwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hlZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDEwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzI1NSwyNTUsMjU1J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZW5kQWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5lLkRJUkVDVCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidW5kbGVPZmZzZXQ6IDYwLy8g5aSa5p2h55u057q/5pe277yM57q/5p2h5oqY57q/5ouQ6KeS5aSE55qE6ZW/5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuRGlyZWN0TGluZS5wcm90b3R5cGUuZ2V0RGVmYXVsdD1nZXREZWZhdWx0O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluZS9EaXJlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDI5XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},3:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 节点基类,用以继承 [E]开头继承于Element,[N]开头为自身api\r\n * @class [N] Node\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element=__webpack_require__(1);\r\nmodule.exports =Node;\r\n\r\nfunction Node(jtopo) {\r\n    if(jtopo){\r\n        Element.call(this,jtopo);\r\n    }else{\r\n        QTopo.util.error("create Node without jtopo",this);\r\n    }\r\n    /**\r\n     * 链接记录\r\n     * @property [N] links {object}\r\n     * @param in {array} 自身为终点的链路对象\r\n     * @param out {array} 自身为起点的链路对象\r\n     */\r\n    this.links={\r\n        in:[],\r\n        out:[]\r\n    };\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(Node,Element);\r\nfunction reset(element){\r\n    var jtopoReset={\r\n        //对节点名的绘制重写，让名称可以换行\r\n        paintText:function (cx) {\r\n            var text = this.text;\r\n            if (null != text && "" != text) {\r\n                cx.beginPath();\r\n                cx.font = this.font;\r\n                var fontWidth = cx.measureText("田").width;\r\n                var maxWidth = fontWidth;\r\n                cx.fillStyle = "rgba(" + this.fontColor + "," + this.alpha + ")";//;名称永远不透明\r\n                //换行检测\r\n                var texts = text.split("\\n");\r\n                for (var i = 0; i < texts.length; i++) {\r\n                    var width = cx.measureText(texts[i]).width;\r\n                    if (width > maxWidth) {\r\n                        maxWidth = width;\r\n                    }\r\n                }\r\n                var e = this.getTextPostion(this.textPosition, maxWidth, fontWidth,texts.length);\r\n                for(var j = 0; j < texts.length; j++){\r\n                    var textWidth=cx.measureText(texts[j]).width;\r\n                    cx.fillText(texts[j], e.x+(maxWidth-textWidth)/2, e.y+j*fontWidth);\r\n                }\r\n\r\n                cx.closePath();\r\n            }\r\n        }\r\n    };\r\n    element.jtopo.paintText = jtopoReset.paintText;\r\n}\r\n/**\r\n *  获取元素基本类型,详细参考QTopo.constant中的类型定义\r\n *  @method [N] getType\r\n *  @return QTopo.constant.NODE\r\n */\r\nNode.prototype.getType=function(){\r\n    return QTopo.constant.NODE;\r\n};\r\n/**\r\n *  设置颜色,一般为设置自身填充颜色，节点有图片设置或为文字节点时无效\r\n *  @method [N] setColor\r\n *  @param color {string} "255,255,255"/"#ffffff"\r\n */\r\nNode.prototype.setColor = function (color) {\r\n    if (color) {\r\n        color = QTopo.util.transHex(color.toLowerCase());\r\n        this.jtopo.fillColor = color;\r\n    }\r\n    this.attr.color=this.jtopo.fillColor;\r\n};\r\n/**\r\n *  设置显示名称,删减首尾空格符\r\n *\r\n *  文字节点应调用setText处理文字显示\r\n *\r\n *  其他节点应用该函数处理名称，否则会出现隐藏后再显示而名称不符的Bug\r\n *  @method [N] setName\r\n *  @param name {string}\r\n */\r\nNode.prototype.setName=function(name){\r\n    if(name){\r\n        if (this.attr.namePosition != "hide") {\r\n            this.jtopo.text = (name+"").trim();\r\n        }\r\n        this.attr.name = (name+"").trim();\r\n    }\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [N] toJson\r\n *  @return {object}\r\n */\r\nNode.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    return json;\r\n};\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL05vZGUuanM/OTA1OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLGtCQUFrQixNQUFNO0FBQ3hCLG1CQUFtQixNQUFNO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRixHQUFHO0FBQ3BGO0FBQ0E7QUFDQSwrQkFBK0Isa0JBQWtCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixrQkFBa0I7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEIsMEJBQTBCO0FBQzFCO0FBQ0EiLCJmaWxlIjoiMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDoioLngrnln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW05d5byA5aS05Li66Ieq6LqrYXBpXHJcbiAqIEBjbGFzcyBbTl0gTm9kZVxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0VdIEVsZW1lbnRcclxuICogQHBhcmFtIGp0b3BvIOWFg+e0oOaguOW/g+eahGp0b3Bv5a+56LGhXHJcbiAqL1xyXG52YXIgRWxlbWVudD1yZXF1aXJlKFwiLi4vRWxlbWVudC5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPU5vZGU7XHJcblxyXG5mdW5jdGlvbiBOb2RlKGp0b3BvKSB7XHJcbiAgICBpZihqdG9wbyl7XHJcbiAgICAgICAgRWxlbWVudC5jYWxsKHRoaXMsanRvcG8pO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNyZWF0ZSBOb2RlIHdpdGhvdXQganRvcG9cIix0aGlzKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6ZO+5o6l6K6w5b2VXHJcbiAgICAgKiBAcHJvcGVydHkgW05dIGxpbmtzIHtvYmplY3R9XHJcbiAgICAgKiBAcGFyYW0gaW4ge2FycmF5fSDoh6rouqvkuLrnu4jngrnnmoTpk77ot6/lr7nosaFcclxuICAgICAqIEBwYXJhbSBvdXQge2FycmF5fSDoh6rouqvkuLrotbfngrnnmoTpk77ot6/lr7nosaFcclxuICAgICAqL1xyXG4gICAgdGhpcy5saW5rcz17XHJcbiAgICAgICAgaW46W10sXHJcbiAgICAgICAgb3V0OltdXHJcbiAgICB9O1xyXG4gICAgcmVzZXQodGhpcyk7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhOb2RlLEVsZW1lbnQpO1xyXG5mdW5jdGlvbiByZXNldChlbGVtZW50KXtcclxuICAgIHZhciBqdG9wb1Jlc2V0PXtcclxuICAgICAgICAvL+WvueiKgueCueWQjeeahOe7mOWItumHjeWGme+8jOiuqeWQjeensOWPr+S7peaNouihjFxyXG4gICAgICAgIHBhaW50VGV4dDpmdW5jdGlvbiAoY3gpIHtcclxuICAgICAgICAgICAgdmFyIHRleHQgPSB0aGlzLnRleHQ7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHRleHQgJiYgXCJcIiAhPSB0ZXh0KSB7XHJcbiAgICAgICAgICAgICAgICBjeC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN4LmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgZm9udFdpZHRoID0gY3gubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWF4V2lkdGggPSBmb250V2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjeC5maWxsU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiOy8vO+WQjeensOawuOi/nOS4jemAj+aYjlxyXG4gICAgICAgICAgICAgICAgLy/mjaLooYzmo4DmtYtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0cyA9IHRleHQuc3BsaXQoXCJcXG5cIik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRleHRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gY3gubWVhc3VyZVRleHQodGV4dHNbaV0pLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmdldFRleHRQb3N0aW9uKHRoaXMudGV4dFBvc2l0aW9uLCBtYXhXaWR0aCwgZm9udFdpZHRoLHRleHRzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgdGV4dHMubGVuZ3RoOyBqKyspe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0V2lkdGg9Y3gubWVhc3VyZVRleHQodGV4dHNbal0pLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGN4LmZpbGxUZXh0KHRleHRzW2pdLCBlLngrKG1heFdpZHRoLXRleHRXaWR0aCkvMiwgZS55K2oqZm9udFdpZHRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjeC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlbGVtZW50Lmp0b3BvLnBhaW50VGV4dCA9IGp0b3BvUmVzZXQucGFpbnRUZXh0O1xyXG59XHJcbi8qKlxyXG4gKiAg6I635Y+W5YWD57Sg5Z+65pys57G75Z6LLOivpue7huWPguiAg1FUb3BvLmNvbnN0YW505Lit55qE57G75Z6L5a6a5LmJXHJcbiAqICBAbWV0aG9kIFtOXSBnZXRUeXBlXHJcbiAqICBAcmV0dXJuIFFUb3BvLmNvbnN0YW50Lk5PREVcclxuICovXHJcbk5vZGUucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24oKXtcclxuICAgIHJldHVybiBRVG9wby5jb25zdGFudC5OT0RFO1xyXG59O1xyXG4vKipcclxuICogIOiuvue9ruminOiJsizkuIDoiKzkuLrorr7nva7oh6rouqvloavlhYXpopzoibLvvIzoioLngrnmnInlm77niYforr7nva7miJbkuLrmloflrZfoioLngrnml7bml6DmlYhcclxuICogIEBtZXRob2QgW05dIHNldENvbG9yXHJcbiAqICBAcGFyYW0gY29sb3Ige3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiXHJcbiAqL1xyXG5Ob2RlLnByb3RvdHlwZS5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgY29sb3IgPSBRVG9wby51dGlsLnRyYW5zSGV4KGNvbG9yLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgIHRoaXMuanRvcG8uZmlsbENvbG9yID0gY29sb3I7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuY29sb3I9dGhpcy5qdG9wby5maWxsQ29sb3I7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5pi+56S65ZCN56ewLOWIoOWHj+mmluWwvuepuuagvOesplxyXG4gKlxyXG4gKiAg5paH5a2X6IqC54K55bqU6LCD55Soc2V0VGV4dOWkhOeQhuaWh+Wtl+aYvuekulxyXG4gKlxyXG4gKiAg5YW25LuW6IqC54K55bqU55So6K+l5Ye95pWw5aSE55CG5ZCN56ew77yM5ZCm5YiZ5Lya5Ye6546w6ZqQ6JeP5ZCO5YaN5pi+56S66ICM5ZCN56ew5LiN56ym55qEQnVnXHJcbiAqICBAbWV0aG9kIFtOXSBzZXROYW1lXHJcbiAqICBAcGFyYW0gbmFtZSB7c3RyaW5nfVxyXG4gKi9cclxuTm9kZS5wcm90b3R5cGUuc2V0TmFtZT1mdW5jdGlvbihuYW1lKXtcclxuICAgIGlmKG5hbWUpe1xyXG4gICAgICAgIGlmICh0aGlzLmF0dHIubmFtZVBvc2l0aW9uICE9IFwiaGlkZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9IChuYW1lK1wiXCIpLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLm5hbWUgPSAobmFtZStcIlwiKS50cmltKCk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg5Y2V5Liq5a+56LGh55qE5bGe5oCn5o+Q5Y+WXHJcbiAqICBAbWV0aG9kIFtOXSB0b0pzb25cclxuICogIEByZXR1cm4ge29iamVjdH1cclxuICovXHJcbk5vZGUucHJvdG90eXBlLnRvSnNvbj1mdW5jdGlvbigpe1xyXG4gICAgdmFyIGpzb249JC5leHRlbmQoe30sdGhpcy5hdHRyKTtcclxuICAgIGpzb24uZXh0cmE9JC5leHRlbmQoe30sdGhpcy5leHRyYSk7XHJcbiAgICByZXR1cm4ganNvbjtcclxufTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL05vZGUuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==')},30:function(module,exports,__webpack_require__){eval("/**\r\n * @module core\r\n */\r\n/**\r\n * 线段基类,用以继承 [E]开头继承于Element,[LE]开头为自身api\r\n * @class [LE] Line\r\n * @constructor\r\n * @extends [E] Element\r\n * @param jtopo 元素核心的jtopo对象\r\n */\r\nvar Element=__webpack_require__(1);\r\nmodule.exports =Line;\r\nfunction Line(jtopo) {\r\n    if(jtopo){\r\n        Element.call(this,jtopo);\r\n    }else{\r\n        QTopo.util.error(\"create Line without jtopo\",this);\r\n    }\r\n    /**\r\n     * 记录线段的首尾元素,首尾元素一般隐藏，且为jtopo对象，仅作为绘制的坐标点\r\n     * @property [LE] path {object}\r\n     * @param start {object} 起始元素\r\n     * @param end {object} 终点元素\r\n     */\r\n    this.attr.path={\r\n        start:this.jtopo.nodeA,\r\n        end:this.jtopo.nodeZ\r\n    };\r\n}\r\nQTopo.util.inherits(Line,Element);\r\n/**\r\n *  设置线段位置,原理是设置线段首尾处隐藏jtopo节点的位置\r\n *  @method [LE] setPosition\r\n *  @param position {object}\r\n *\r\n *          position={\r\n *              start:[x,y],\r\n *              end:[x,y]\r\n *          }\r\n */\r\nLine.prototype.setPosition=function(position){\r\n    var start=this.attr.path.start;\r\n    var end=this.attr.path.end;\r\n    if($.isArray(position.start)&&$.isNumeric(position.start[0])&&$.isNumeric(position.start[1])){\r\n        start.setLocation(parseInt(position.start[0]), parseInt(position.start[1]));\r\n    }\r\n    if($.isArray(position.end)&&$.isNumeric(position.end[0])&&$.isNumeric(position.end[1])){\r\n        end.setLocation(parseInt(position.end[0]), parseInt(position.end[1]));\r\n    }\r\n    this.attr.position={\r\n        start:[start.x,start.y],\r\n        end:[end.x,end.y]\r\n    };\r\n};\r\n/**\r\n *  获取基本类型\r\n *  @method [LE] getType\r\n *  @return QTopo.constant.Line {string}\r\n */\r\nLine.prototype.getType=function(){\r\n    return QTopo.constant.Line;\r\n};\r\n/**\r\n *  设置线段颜色\r\n *  @method [LE] setColor\r\n *  @param color{string} \"255,255,255\"/\"#ffffff\"\r\n */\r\nLine.prototype.setColor = function (color) {\r\n    if (color) {\r\n        this.jtopo.strokeColor = QTopo.util.transHex(color.toLowerCase());\r\n    }\r\n    this.attr.color=this.jtopo.strokeColor;\r\n};\r\n/**\r\n *  设置线段计数\r\n *  @method [LE] setNum\r\n *  @param {number} num\r\n */\r\nLine.prototype.setNum = function (num) {\r\n    if ($.isNumeric(num)) {\r\n        if(num > 1){\r\n            this.jtopo.text = '(+' + num + ')';\r\n        }else {\r\n            this.jtopo.text = '';\r\n        }\r\n        this.attr.num=num;\r\n    }\r\n};\r\n/**\r\n *  设置线段宽度\r\n *  @method [LE] setWidth\r\n *  @param {number} width\r\n */\r\nLine.prototype.setWidth=function(width){\r\n    if($.isNumeric(width)){\r\n        this.jtopo.lineWidth = width; // 线宽\r\n    }\r\n    this.attr.width=this.jtopo.lineWidth;\r\n};\r\n/**\r\n *  设置线段两端箭头参数\r\n *  @method [LE] setArrow\r\n *  @param arrow {object}\r\n *\r\n *          arrow={\r\n *              size:箭头大小{number},\r\n *              offset:箭头在链路上的偏移量{number},\r\n *              start:是否显示起点箭头{boolean},\r\n *              end:是否显示终点箭头{boolean},\r\n *          }\r\n */\r\nLine.prototype.setArrow = function(arrow){\r\n    if(arrow){\r\n        this.jtopo.arrowsRadius = $.isNumeric(arrow.size)?arrow.size:0;\r\n        this.jtopo.arrowsOffset = $.isNumeric(arrow.offset)?arrow.offset:0;\r\n    }\r\n    if(!this.attr.arrow){\r\n        this.attr.arrow={};\r\n    }\r\n    this.attr.arrow.size=this.jtopo.arrowsRadius;\r\n    this.attr.arrow.offset=this.jtopo.arrowsOffset;\r\n};\r\n/**\r\n *  设置相同起点和终点的链路之间的间隔大小\r\n *\r\n *  @method [LE] setGap\r\n *  @param gap {number}\r\n */\r\nLine.prototype.setGap=function(gap){\r\n    if(gap){\r\n        this.jtopo.bundleGap = $.isNumeric(gap)?gap:0; // 线条之间的间隔\r\n    }\r\n    this.attr.gap=this.jtopo.bundleGap;\r\n};\r\n/**\r\n *  设置链路的虚线线段长度\r\n *\r\n *  设置不为number类型或小于0时，则认为不要虚线\r\n *\r\n *  @method [LE] setDashed\r\n *  @param dashedPattern {number|null}\r\n */\r\nLine.prototype.setDashed=function(dashedPattern){\r\n    if($.isNumeric(dashedPattern)&&dashedPattern>0){\r\n        this.jtopo.dashedPattern=parseInt(dashedPattern);\r\n    }else{\r\n        this.jtopo.dashedPattern=null;\r\n    }\r\n    this.attr.dashed=this.jtopo.dashedPattern;\r\n};\r\n/**\r\n *  单个对象的属性提取\r\n *  @method [LE] toJson\r\n *  @return {object}\r\n */\r\nLine.prototype.toJson=function(){\r\n    var json=$.extend({},this.attr);\r\n    json.extra=$.extend({},this.extra);\r\n    return json;\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5lL0xpbmUuanM/YjkwZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIscUJBQXFCLE9BQU87QUFDNUIsbUJBQW1CLE9BQU87QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSwwQkFBMEIsT0FBTztBQUNqQyxrQ0FBa0MsT0FBTztBQUN6QywrQkFBK0IsUUFBUTtBQUN2Qyw2QkFBNkIsUUFBUTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUI7QUFDQSIsImZpbGUiOiIzMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDnur/mrrXln7rnsbss55So5Lul57un5om/IFtFXeW8gOWktOe7p+aJv+S6jkVsZW1lbnQsW0xFXeW8gOWktOS4uuiHqui6q2FwaVxyXG4gKiBAY2xhc3MgW0xFXSBMaW5lXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbRV0gRWxlbWVudFxyXG4gKiBAcGFyYW0ganRvcG8g5YWD57Sg5qC45b+D55qEanRvcG/lr7nosaFcclxuICovXHJcbnZhciBFbGVtZW50PXJlcXVpcmUoXCIuLi9FbGVtZW50LmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9TGluZTtcclxuZnVuY3Rpb24gTGluZShqdG9wbykge1xyXG4gICAgaWYoanRvcG8pe1xyXG4gICAgICAgIEVsZW1lbnQuY2FsbCh0aGlzLGp0b3BvKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJjcmVhdGUgTGluZSB3aXRob3V0IGp0b3BvXCIsdGhpcyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiusOW9lee6v+auteeahOmmluWwvuWFg+e0oCzpppblsL7lhYPntKDkuIDoiKzpmpDol4/vvIzkuJTkuLpqdG9wb+Wvueixoe+8jOS7heS9nOS4uue7mOWItueahOWdkOagh+eCuVxyXG4gICAgICogQHByb3BlcnR5IFtMRV0gcGF0aCB7b2JqZWN0fVxyXG4gICAgICogQHBhcmFtIHN0YXJ0IHtvYmplY3R9IOi1t+Wni+WFg+e0oFxyXG4gICAgICogQHBhcmFtIGVuZCB7b2JqZWN0fSDnu4jngrnlhYPntKBcclxuICAgICAqL1xyXG4gICAgdGhpcy5hdHRyLnBhdGg9e1xyXG4gICAgICAgIHN0YXJ0OnRoaXMuanRvcG8ubm9kZUEsXHJcbiAgICAgICAgZW5kOnRoaXMuanRvcG8ubm9kZVpcclxuICAgIH07XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhMaW5lLEVsZW1lbnQpO1xyXG4vKipcclxuICogIOiuvue9rue6v+auteS9jee9rizljp/nkIbmmK/orr7nva7nur/mrrXpppblsL7lpITpmpDol49qdG9wb+iKgueCueeahOS9jee9rlxyXG4gKiAgQG1ldGhvZCBbTEVdIHNldFBvc2l0aW9uXHJcbiAqICBAcGFyYW0gcG9zaXRpb24ge29iamVjdH1cclxuICpcclxuICogICAgICAgICAgcG9zaXRpb249e1xyXG4gKiAgICAgICAgICAgICAgc3RhcnQ6W3gseV0sXHJcbiAqICAgICAgICAgICAgICBlbmQ6W3gseV1cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUuc2V0UG9zaXRpb249ZnVuY3Rpb24ocG9zaXRpb24pe1xyXG4gICAgdmFyIHN0YXJ0PXRoaXMuYXR0ci5wYXRoLnN0YXJ0O1xyXG4gICAgdmFyIGVuZD10aGlzLmF0dHIucGF0aC5lbmQ7XHJcbiAgICBpZigkLmlzQXJyYXkocG9zaXRpb24uc3RhcnQpJiYkLmlzTnVtZXJpYyhwb3NpdGlvbi5zdGFydFswXSkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLnN0YXJ0WzFdKSl7XHJcbiAgICAgICAgc3RhcnQuc2V0TG9jYXRpb24ocGFyc2VJbnQocG9zaXRpb24uc3RhcnRbMF0pLCBwYXJzZUludChwb3NpdGlvbi5zdGFydFsxXSkpO1xyXG4gICAgfVxyXG4gICAgaWYoJC5pc0FycmF5KHBvc2l0aW9uLmVuZCkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLmVuZFswXSkmJiQuaXNOdW1lcmljKHBvc2l0aW9uLmVuZFsxXSkpe1xyXG4gICAgICAgIGVuZC5zZXRMb2NhdGlvbihwYXJzZUludChwb3NpdGlvbi5lbmRbMF0pLCBwYXJzZUludChwb3NpdGlvbi5lbmRbMV0pKTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5wb3NpdGlvbj17XHJcbiAgICAgICAgc3RhcnQ6W3N0YXJ0Lngsc3RhcnQueV0sXHJcbiAgICAgICAgZW5kOltlbmQueCxlbmQueV1cclxuICAgIH07XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5Z+65pys57G75Z6LXHJcbiAqICBAbWV0aG9kIFtMRV0gZ2V0VHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5MaW5lIHtzdHJpbmd9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuTGluZTtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXpopzoibJcclxuICogIEBtZXRob2QgW0xFXSBzZXRDb2xvclxyXG4gKiAgQHBhcmFtIGNvbG9ye3N0cmluZ30gXCIyNTUsMjU1LDI1NVwiL1wiI2ZmZmZmZlwiXHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRDb2xvciA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdHJva2VDb2xvciA9IFFUb3BvLnV0aWwudHJhbnNIZXgoY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuY29sb3I9dGhpcy5qdG9wby5zdHJva2VDb2xvcjtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXorqHmlbBcclxuICogIEBtZXRob2QgW0xFXSBzZXROdW1cclxuICogIEBwYXJhbSB7bnVtYmVyfSBudW1cclxuICovXHJcbkxpbmUucHJvdG90eXBlLnNldE51bSA9IGZ1bmN0aW9uIChudW0pIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhudW0pKSB7XHJcbiAgICAgICAgaWYobnVtID4gMSl7XHJcbiAgICAgICAgICAgIHRoaXMuanRvcG8udGV4dCA9ICcoKycgKyBudW0gKyAnKSc7XHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmp0b3BvLnRleHQgPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLm51bT1udW07XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u57q/5q615a695bqmXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0V2lkdGhcclxuICogIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUuc2V0V2lkdGg9ZnVuY3Rpb24od2lkdGgpe1xyXG4gICAgaWYoJC5pc051bWVyaWMod2lkdGgpKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmxpbmVXaWR0aCA9IHdpZHRoOyAvLyDnur/lrr1cclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci53aWR0aD10aGlzLmp0b3BvLmxpbmVXaWR0aDtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7nur/mrrXkuKTnq6/nrq3lpLTlj4LmlbBcclxuICogIEBtZXRob2QgW0xFXSBzZXRBcnJvd1xyXG4gKiAgQHBhcmFtIGFycm93IHtvYmplY3R9XHJcbiAqXHJcbiAqICAgICAgICAgIGFycm93PXtcclxuICogICAgICAgICAgICAgIHNpemU6566t5aS05aSn5bCPe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBvZmZzZXQ6566t5aS05Zyo6ZO+6Lev5LiK55qE5YGP56e76YePe251bWJlcn0sXHJcbiAqICAgICAgICAgICAgICBzdGFydDrmmK/lkKbmmL7npLrotbfngrnnrq3lpLR7Ym9vbGVhbn0sXHJcbiAqICAgICAgICAgICAgICBlbmQ65piv5ZCm5pi+56S657uI54K5566t5aS0e2Jvb2xlYW59LFxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRBcnJvdyA9IGZ1bmN0aW9uKGFycm93KXtcclxuICAgIGlmKGFycm93KXtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c1JhZGl1cyA9ICQuaXNOdW1lcmljKGFycm93LnNpemUpP2Fycm93LnNpemU6MDtcclxuICAgICAgICB0aGlzLmp0b3BvLmFycm93c09mZnNldCA9ICQuaXNOdW1lcmljKGFycm93Lm9mZnNldCk/YXJyb3cub2Zmc2V0OjA7XHJcbiAgICB9XHJcbiAgICBpZighdGhpcy5hdHRyLmFycm93KXtcclxuICAgICAgICB0aGlzLmF0dHIuYXJyb3c9e307XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuYXJyb3cuc2l6ZT10aGlzLmp0b3BvLmFycm93c1JhZGl1cztcclxuICAgIHRoaXMuYXR0ci5hcnJvdy5vZmZzZXQ9dGhpcy5qdG9wby5hcnJvd3NPZmZzZXQ7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u55u45ZCM6LW354K55ZKM57uI54K555qE6ZO+6Lev5LmL6Ze055qE6Ze06ZqU5aSn5bCPXHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0R2FwXHJcbiAqICBAcGFyYW0gZ2FwIHtudW1iZXJ9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXRHYXA9ZnVuY3Rpb24oZ2FwKXtcclxuICAgIGlmKGdhcCl7XHJcbiAgICAgICAgdGhpcy5qdG9wby5idW5kbGVHYXAgPSAkLmlzTnVtZXJpYyhnYXApP2dhcDowOyAvLyDnur/mnaHkuYvpl7TnmoTpl7TpmpRcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5nYXA9dGhpcy5qdG9wby5idW5kbGVHYXA7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u6ZO+6Lev55qE6Jma57q/57q/5q616ZW/5bqmXHJcbiAqXHJcbiAqICDorr7nva7kuI3kuLpudW1iZXLnsbvlnovmiJblsI/kuo4w5pe277yM5YiZ6K6k5Li65LiN6KaB6Jma57q/XHJcbiAqXHJcbiAqICBAbWV0aG9kIFtMRV0gc2V0RGFzaGVkXHJcbiAqICBAcGFyYW0gZGFzaGVkUGF0dGVybiB7bnVtYmVyfG51bGx9XHJcbiAqL1xyXG5MaW5lLnByb3RvdHlwZS5zZXREYXNoZWQ9ZnVuY3Rpb24oZGFzaGVkUGF0dGVybil7XHJcbiAgICBpZigkLmlzTnVtZXJpYyhkYXNoZWRQYXR0ZXJuKSYmZGFzaGVkUGF0dGVybj4wKXtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm49cGFyc2VJbnQoZGFzaGVkUGF0dGVybik7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICB0aGlzLmp0b3BvLmRhc2hlZFBhdHRlcm49bnVsbDtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kYXNoZWQ9dGhpcy5qdG9wby5kYXNoZWRQYXR0ZXJuO1xyXG59O1xyXG4vKipcclxuICogIOWNleS4quWvueixoeeahOWxnuaAp+aPkOWPllxyXG4gKiAgQG1ldGhvZCBbTEVdIHRvSnNvblxyXG4gKiAgQHJldHVybiB7b2JqZWN0fVxyXG4gKi9cclxuTGluZS5wcm90b3R5cGUudG9Kc29uPWZ1bmN0aW9uKCl7XHJcbiAgICB2YXIganNvbj0kLmV4dGVuZCh7fSx0aGlzLmF0dHIpO1xyXG4gICAganNvbi5leHRyYT0kLmV4dGVuZCh7fSx0aGlzLmV4dHJhKTtcclxuICAgIHJldHVybiBqc29uO1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluZS9MaW5lLmpzXG4vLyBtb2R1bGUgaWQgPSAzMFxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9")},31:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 曲线链路\r\n * @class  CurveLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(2);\r\nmodule.exports = {\r\n    constructor: CurveLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        size: 10,\r\n        offset: 0,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId:"",\r\n    gap: 20,\r\n    width: 2,\r\n    dashed: null,\r\n    zIndex: 100,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    useType: QTopo.constant.link.CURVE,\r\n    curveOffset: 200\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//------\r\nvar jtopoRest={\r\n    //改写源码绘制二次贝赛尔曲线\r\n    //修改始终点的位置，用以确定箭头方向\r\n    getStart: function () {\r\n        var a;\r\n        var b = this.nodeA, c = this.nodeZ;\r\n        var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n        var e = b.getBound();\r\n        a = JTopo.util.intersectionLineBound(d, e);\r\n        return a;\r\n    },\r\n    getEnd:function () {\r\n        var a;\r\n        var b = this.nodeZ, c = this.nodeA;\r\n        var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n        var e = b.getBound();\r\n        a = JTopo.util.intersectionLineBound(d, e);\r\n        return a;\r\n    },\r\n    //获取曲线的路径点，返回应是数组\r\n    getPath:function () {\r\n        var path = [], start = this.getStartPosition(), end = this.getEndPosition();\r\n        if (this.nodeA === this.nodeZ)return [start, end];\r\n        if (start && end) {\r\n            var angle = Math.atan(Math.abs(end.y - start.y) / Math.abs(end.x - start.x));\r\n            var mX = (start.x + end.x) / 2 + this.qtopo.attr.curveOffset * Math.cos(angle - Math.PI / 2);\r\n            var mY = (start.y + end.y) / 2 + this.qtopo.attr.curveOffset * Math.sin(angle - Math.PI / 2);\r\n            path.start = start;\r\n            path.end = end;\r\n            path.middle = {\r\n                x: mX,\r\n                y: mY\r\n            };\r\n            path.text =  makePoint(path.start,path.middle, path.end, 1/2);\r\n            path.angle = angle;\r\n            path.push(start);\r\n            path.push(end);\r\n        }\r\n        return path\r\n    },\r\n    //绘制曲线路径\r\n    paintPath:function (cx, path) {\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(cx);\r\n        var start = path.start;\r\n        var end = path.end;\r\n        var middle = path.middle;\r\n        if (start && end && middle) {\r\n            cx.beginPath();\r\n            cx.moveTo(start.x, start.y);\r\n            cx.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";\r\n            cx.lineWidth = this.lineWidth;\r\n            cx.moveTo(start.x, start.y);\r\n            cx.quadraticCurveTo(middle.x, middle.y, end.x, end.y);\r\n            cx.stroke();\r\n            if (cx.stroke(), cx.closePath(), null != this.arrowsRadius) {\r\n                if (this.qtopo.attr.arrow.end) {\r\n                    this.paintArrow(cx, start, end);\r\n                }\r\n                if (this.qtopo.attr.arrow.start) {\r\n                    this.paintArrow(cx, end, start);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //线上文本位置\r\n    paintText:function (cx, path) {\r\n        if (path && path.text && this.text && this.text.length > 0) {\r\n            var textX = path.text.x + this.textOffsetX;\r\n            var textY = path.text.y + this.textOffsetY;\r\n            cx.save();\r\n            cx.beginPath();\r\n            cx.font = this.font;\r\n            var totalWidth = cx.measureText(this.text).width;\r\n            var fontWidth = cx.measureText("田").width;\r\n            cx.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n            cx.fillText(this.text, textX - totalWidth / 2, textY - fontWidth / 2);\r\n            cx.stroke();\r\n            cx.closePath();\r\n            cx.restore();\r\n        }\r\n    },\r\n    //判断点是否落在曲线上,原理基于二次贝塞尔曲线公式阶段点取样,判断点是否落在每小部分的线段上\r\n    isInBound:function (x, y) {\r\n        if (this.nodeA === this.nodeZ) {\r\n            var d = this.bundleGap * (this.nodeIndex + 1) / 2, e = a.util.getDistance(this.nodeA, {x: x, y: y}) - d;\r\n            return Math.abs(e) <= 3\r\n        }\r\n        //----\r\n        var flag = false;\r\n        var start = this.path.start;\r\n        var end = this.path.end;\r\n        var middle = this.path.middle;\r\n        var angle = this.path.angle;//起始点之间的夹角\r\n        if(start&&end&&middle&&angle){\r\n            var temp1 = start;//首次为起点\r\n            var temp2;\r\n            for (var i = 1; i <= 10; i++) {\r\n                temp2 = makePoint(start, middle, end, i / 10);//取样为10份\r\n                //判断点是否落在temp1和temp2构成的直线上\r\n                if (pointInLine({x: x, y: y}, temp1, temp2, this.width / 2, angle)) {\r\n                    flag = true;\r\n                    break\r\n                }\r\n                temp1 = temp2;\r\n            }\r\n        }\r\n        return flag\r\n    }\r\n};\r\n//----\r\n//制造一个二次贝塞尔曲线的阶段点\r\nfunction makePoint(s, m, e, t) {\r\n    return {\r\n        x: (1 - t) * (1 - t) * s.x + 2 * t * (1 - t) * m.x + t * t * e.x,\r\n        y: (1 - t) * (1 - t) * s.y + 2 * t * (1 - t) * m.y + t * t * e.y\r\n    }\r\n}\r\n//考虑到线段的粗细,需要判断点是否在矩形内，若点同时在顺时针4个点成的4条线的右侧,则为在矩形内\r\nfunction pointInLine(p, s, e, w, an) {\r\n    var rectangle = [//顺时针，从左上开始\r\n        {\r\n            x: s.x - w * Math.sin(an),\r\n            y: s.y - w * Math.cos(an)\r\n        },\r\n        {\r\n            x: e.x - w * Math.sin(an),\r\n            y: e.y - w * Math.cos(an)\r\n        },\r\n        {\r\n            x: e.x + w * Math.sin(an),\r\n            y: e.y + w * Math.cos(an)\r\n        },\r\n        {\r\n            x: s.x + w * Math.sin(an),\r\n            y: s.y + w * Math.cos(an)\r\n        }\r\n    ];\r\n    return poinRightLine(rectangle[0], rectangle[1], p) && poinRightLine(rectangle[1], rectangle[2], p) && poinRightLine(rectangle[2], rectangle[3], p) && poinRightLine(rectangle[3], rectangle[0], p);\r\n}\r\n//判断点在线的右侧?\r\nfunction poinRightLine(s, e, p) {\r\n    return ((e.x - s.x) * (-p.y + s.y) - (-e.y + s.y) * (p.x - s.x)) < 0;\r\n}\r\n//---\r\n//------\r\n//-\r\nfunction CurveLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.CurveLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n    //改写源码绘制曲线,可由curveOffset指定弧度\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(CurveLink, Link);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link) {\r\n    link.jtopo.getStartPosition =jtopoRest.getStart;\r\n    link.jtopo.getEndPosition =jtopoRest.getEnd;\r\n    link.jtopo.paintPath =jtopoRest.paintPath;\r\n    link.jtopo.getPath =jtopoRest.getPath;\r\n    link.jtopo.isInBound = jtopoRest.isInBound;\r\n    link.jtopo.paintText =jtopoRest.paintText;\r\n}\r\n//-\r\n/**\r\n *  设置曲线偏移量\r\n *\r\n *  @method setCurveOffset\r\n *  @param curveOffset {number}\r\n */\r\nCurveLink.prototype.setCurveOffset = function (curveOffset) {\r\n    if ($.isNumeric(curveOffset)) {\r\n        this.attr.curveOffset = parseInt(curveOffset);\r\n    }\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 2,\r\n                                dashed: null,\r\n                                zIndex: 100,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                useType: QTopo.constant.link.CURVE,\r\n                                curveOffset: 200\r\n                            };\r\n */\r\nCurveLink.prototype.getDefault = getDefault;\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0N1cnZlLmpzP2QwZTMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxtR0FBbUcsV0FBVztBQUM5RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBLDhCQUE4QjtBQUM5QjtBQUNBLDJCQUEyQixTQUFTO0FBQ3BDLDhEQUE4RDtBQUM5RDtBQUNBLGlDQUFpQyxXQUFXO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjMxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOabsue6v+mTvui3r1xyXG4gKiBAY2xhc3MgIEN1cnZlTGlua1xyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0xdIExpbmtcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIExpbmsgPSByZXF1aXJlKFwiLi9MaW5rLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIGNvbnN0cnVjdG9yOiBDdXJ2ZUxpbmssXHJcbiAgICBzZXREZWZhdWx0OiBzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDogZ2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQgPSB7XHJcbiAgICBudW1iZXI6IDEsXHJcbiAgICBhbHBoYTogMSxcclxuICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICBhcnJvdzoge1xyXG4gICAgICAgIHNpemU6IDEwLFxyXG4gICAgICAgIG9mZnNldDogMCxcclxuICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgZW5kOiBmYWxzZVxyXG4gICAgfSxcclxuICAgIGpzb25JZDpcIlwiLFxyXG4gICAgZ2FwOiAyMCxcclxuICAgIHdpZHRoOiAyLFxyXG4gICAgZGFzaGVkOiBudWxsLFxyXG4gICAgekluZGV4OiAxMDAsXHJcbiAgICBmb250OiB7XHJcbiAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgdHlwZTogXCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICBjb2xvcjogJzI1NSwyNTUsMjU1J1xyXG4gICAgfSxcclxuICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuQ1VSVkUsXHJcbiAgICBjdXJ2ZU9mZnNldDogMjAwXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKSB7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8udXRpbC5kZWVwQ2xvbmUoREVGQVVMVCk7XHJcbn1cclxuLy8tLS0tLS1cclxudmFyIGp0b3BvUmVzdD17XHJcbiAgICAvL+aUueWGmea6kOeggee7mOWItuS6jOasoei0nei1m+WwlOabsue6v1xyXG4gICAgLy/kv67mlLnlp4vnu4jngrnnmoTkvY3nva7vvIznlKjku6Xnoa7lrprnrq3lpLTmlrnlkJFcclxuICAgIGdldFN0YXJ0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGE7XHJcbiAgICAgICAgdmFyIGIgPSB0aGlzLm5vZGVBLCBjID0gdGhpcy5ub2RlWjtcclxuICAgICAgICB2YXIgZCA9IEpUb3BvLnV0aWwubGluZUYoYi5jeCwgYi5jeSwgYy5jeCwgYy5jeSk7XHJcbiAgICAgICAgdmFyIGUgPSBiLmdldEJvdW5kKCk7XHJcbiAgICAgICAgYSA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uTGluZUJvdW5kKGQsIGUpO1xyXG4gICAgICAgIHJldHVybiBhO1xyXG4gICAgfSxcclxuICAgIGdldEVuZDpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGE7XHJcbiAgICAgICAgdmFyIGIgPSB0aGlzLm5vZGVaLCBjID0gdGhpcy5ub2RlQTtcclxuICAgICAgICB2YXIgZCA9IEpUb3BvLnV0aWwubGluZUYoYi5jeCwgYi5jeSwgYy5jeCwgYy5jeSk7XHJcbiAgICAgICAgdmFyIGUgPSBiLmdldEJvdW5kKCk7XHJcbiAgICAgICAgYSA9IEpUb3BvLnV0aWwuaW50ZXJzZWN0aW9uTGluZUJvdW5kKGQsIGUpO1xyXG4gICAgICAgIHJldHVybiBhO1xyXG4gICAgfSxcclxuICAgIC8v6I635Y+W5puy57q/55qE6Lev5b6E54K577yM6L+U5Zue5bqU5piv5pWw57uEXHJcbiAgICBnZXRQYXRoOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IFtdLCBzdGFydCA9IHRoaXMuZ2V0U3RhcnRQb3NpdGlvbigpLCBlbmQgPSB0aGlzLmdldEVuZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZUEgPT09IHRoaXMubm9kZVopcmV0dXJuIFtzdGFydCwgZW5kXTtcclxuICAgICAgICBpZiAoc3RhcnQgJiYgZW5kKSB7XHJcbiAgICAgICAgICAgIHZhciBhbmdsZSA9IE1hdGguYXRhbihNYXRoLmFicyhlbmQueSAtIHN0YXJ0LnkpIC8gTWF0aC5hYnMoZW5kLnggLSBzdGFydC54KSk7XHJcbiAgICAgICAgICAgIHZhciBtWCA9IChzdGFydC54ICsgZW5kLngpIC8gMiArIHRoaXMucXRvcG8uYXR0ci5jdXJ2ZU9mZnNldCAqIE1hdGguY29zKGFuZ2xlIC0gTWF0aC5QSSAvIDIpO1xyXG4gICAgICAgICAgICB2YXIgbVkgPSAoc3RhcnQueSArIGVuZC55KSAvIDIgKyB0aGlzLnF0b3BvLmF0dHIuY3VydmVPZmZzZXQgKiBNYXRoLnNpbihhbmdsZSAtIE1hdGguUEkgLyAyKTtcclxuICAgICAgICAgICAgcGF0aC5zdGFydCA9IHN0YXJ0O1xyXG4gICAgICAgICAgICBwYXRoLmVuZCA9IGVuZDtcclxuICAgICAgICAgICAgcGF0aC5taWRkbGUgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiBtWCxcclxuICAgICAgICAgICAgICAgIHk6IG1ZXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHBhdGgudGV4dCA9ICBtYWtlUG9pbnQocGF0aC5zdGFydCxwYXRoLm1pZGRsZSwgcGF0aC5lbmQsIDEvMik7XHJcbiAgICAgICAgICAgIHBhdGguYW5nbGUgPSBhbmdsZTtcclxuICAgICAgICAgICAgcGF0aC5wdXNoKHN0YXJ0KTtcclxuICAgICAgICAgICAgcGF0aC5wdXNoKGVuZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXRoXHJcbiAgICB9LFxyXG4gICAgLy/nu5jliLbmm7Lnur/ot6/lvoRcclxuICAgIHBhaW50UGF0aDpmdW5jdGlvbiAoY3gsIHBhdGgpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gdm9pZCB0aGlzLnBhaW50TG9vcChjeCk7XHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gcGF0aC5zdGFydDtcclxuICAgICAgICB2YXIgZW5kID0gcGF0aC5lbmQ7XHJcbiAgICAgICAgdmFyIG1pZGRsZSA9IHBhdGgubWlkZGxlO1xyXG4gICAgICAgIGlmIChzdGFydCAmJiBlbmQgJiYgbWlkZGxlKSB7XHJcbiAgICAgICAgICAgIGN4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjeC5tb3ZlVG8oc3RhcnQueCwgc3RhcnQueSk7XHJcbiAgICAgICAgICAgIGN4LnN0cm9rZVN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5zdHJva2VDb2xvciArIFwiLFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICBjeC5saW5lV2lkdGggPSB0aGlzLmxpbmVXaWR0aDtcclxuICAgICAgICAgICAgY3gubW92ZVRvKHN0YXJ0LngsIHN0YXJ0LnkpO1xyXG4gICAgICAgICAgICBjeC5xdWFkcmF0aWNDdXJ2ZVRvKG1pZGRsZS54LCBtaWRkbGUueSwgZW5kLngsIGVuZC55KTtcclxuICAgICAgICAgICAgY3guc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgIGlmIChjeC5zdHJva2UoKSwgY3guY2xvc2VQYXRoKCksIG51bGwgIT0gdGhpcy5hcnJvd3NSYWRpdXMpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnF0b3BvLmF0dHIuYXJyb3cuZW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGN4LCBzdGFydCwgZW5kKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnF0b3BvLmF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coY3gsIGVuZCwgc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v57q/5LiK5paH5pys5L2N572uXHJcbiAgICBwYWludFRleHQ6ZnVuY3Rpb24gKGN4LCBwYXRoKSB7XHJcbiAgICAgICAgaWYgKHBhdGggJiYgcGF0aC50ZXh0ICYmIHRoaXMudGV4dCAmJiB0aGlzLnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgdGV4dFggPSBwYXRoLnRleHQueCArIHRoaXMudGV4dE9mZnNldFg7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0WSA9IHBhdGgudGV4dC55ICsgdGhpcy50ZXh0T2Zmc2V0WTtcclxuICAgICAgICAgICAgY3guc2F2ZSgpO1xyXG4gICAgICAgICAgICBjeC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgY3guZm9udCA9IHRoaXMuZm9udDtcclxuICAgICAgICAgICAgdmFyIHRvdGFsV2lkdGggPSBjeC5tZWFzdXJlVGV4dCh0aGlzLnRleHQpLndpZHRoO1xyXG4gICAgICAgICAgICB2YXIgZm9udFdpZHRoID0gY3gubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgICAgIGN4LmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgICAgICBjeC5maWxsVGV4dCh0aGlzLnRleHQsIHRleHRYIC0gdG90YWxXaWR0aCAvIDIsIHRleHRZIC0gZm9udFdpZHRoIC8gMik7XHJcbiAgICAgICAgICAgIGN4LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICBjeC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgY3gucmVzdG9yZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+WIpOaWreeCueaYr+WQpuiQveWcqOabsue6v+S4iizljp/nkIbln7rkuo7kuozmrKHotJ3loZ7lsJTmm7Lnur/lhazlvI/pmLbmrrXngrnlj5bmoLcs5Yik5pat54K55piv5ZCm6JC95Zyo5q+P5bCP6YOo5YiG55qE57q/5q615LiKXHJcbiAgICBpc0luQm91bmQ6ZnVuY3Rpb24gKHgsIHkpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWikge1xyXG4gICAgICAgICAgICB2YXIgZCA9IHRoaXMuYnVuZGxlR2FwICogKHRoaXMubm9kZUluZGV4ICsgMSkgLyAyLCBlID0gYS51dGlsLmdldERpc3RhbmNlKHRoaXMubm9kZUEsIHt4OiB4LCB5OiB5fSkgLSBkO1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5hYnMoZSkgPD0gM1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLy0tLS1cclxuICAgICAgICB2YXIgZmxhZyA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMucGF0aC5zdGFydDtcclxuICAgICAgICB2YXIgZW5kID0gdGhpcy5wYXRoLmVuZDtcclxuICAgICAgICB2YXIgbWlkZGxlID0gdGhpcy5wYXRoLm1pZGRsZTtcclxuICAgICAgICB2YXIgYW5nbGUgPSB0aGlzLnBhdGguYW5nbGU7Ly/otbflp4vngrnkuYvpl7TnmoTlpLnop5JcclxuICAgICAgICBpZihzdGFydCYmZW5kJiZtaWRkbGUmJmFuZ2xlKXtcclxuICAgICAgICAgICAgdmFyIHRlbXAxID0gc3RhcnQ7Ly/pppbmrKHkuLrotbfngrlcclxuICAgICAgICAgICAgdmFyIHRlbXAyO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSAxMDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wMiA9IG1ha2VQb2ludChzdGFydCwgbWlkZGxlLCBlbmQsIGkgLyAxMCk7Ly/lj5bmoLfkuLoxMOS7vVxyXG4gICAgICAgICAgICAgICAgLy/liKTmlq3ngrnmmK/lkKbokL3lnKh0ZW1wMeWSjHRlbXAy5p6E5oiQ55qE55u057q/5LiKXHJcbiAgICAgICAgICAgICAgICBpZiAocG9pbnRJbkxpbmUoe3g6IHgsIHk6IHl9LCB0ZW1wMSwgdGVtcDIsIHRoaXMud2lkdGggLyAyLCBhbmdsZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbGFnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGVtcDEgPSB0ZW1wMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmxhZ1xyXG4gICAgfVxyXG59O1xyXG4vLy0tLS1cclxuLy/liLbpgKDkuIDkuKrkuozmrKHotJ3loZ7lsJTmm7Lnur/nmoTpmLbmrrXngrlcclxuZnVuY3Rpb24gbWFrZVBvaW50KHMsIG0sIGUsIHQpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgeDogKDEgLSB0KSAqICgxIC0gdCkgKiBzLnggKyAyICogdCAqICgxIC0gdCkgKiBtLnggKyB0ICogdCAqIGUueCxcclxuICAgICAgICB5OiAoMSAtIHQpICogKDEgLSB0KSAqIHMueSArIDIgKiB0ICogKDEgLSB0KSAqIG0ueSArIHQgKiB0ICogZS55XHJcbiAgICB9XHJcbn1cclxuLy/ogIPomZHliLDnur/mrrXnmoTnspfnu4Ys6ZyA6KaB5Yik5pat54K55piv5ZCm5Zyo55+p5b2i5YaF77yM6Iul54K55ZCM5pe25Zyo6aG65pe26ZKINOS4queCueaIkOeahDTmnaHnur/nmoTlj7Pkvqcs5YiZ5Li65Zyo55+p5b2i5YaFXHJcbmZ1bmN0aW9uIHBvaW50SW5MaW5lKHAsIHMsIGUsIHcsIGFuKSB7XHJcbiAgICB2YXIgcmVjdGFuZ2xlID0gWy8v6aG65pe26ZKI77yM5LuO5bem5LiK5byA5aeLXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB4OiBzLnggLSB3ICogTWF0aC5zaW4oYW4pLFxyXG4gICAgICAgICAgICB5OiBzLnkgLSB3ICogTWF0aC5jb3MoYW4pXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHg6IGUueCAtIHcgKiBNYXRoLnNpbihhbiksXHJcbiAgICAgICAgICAgIHk6IGUueSAtIHcgKiBNYXRoLmNvcyhhbilcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgeDogZS54ICsgdyAqIE1hdGguc2luKGFuKSxcclxuICAgICAgICAgICAgeTogZS55ICsgdyAqIE1hdGguY29zKGFuKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB4OiBzLnggKyB3ICogTWF0aC5zaW4oYW4pLFxyXG4gICAgICAgICAgICB5OiBzLnkgKyB3ICogTWF0aC5jb3MoYW4pXHJcbiAgICAgICAgfVxyXG4gICAgXTtcclxuICAgIHJldHVybiBwb2luUmlnaHRMaW5lKHJlY3RhbmdsZVswXSwgcmVjdGFuZ2xlWzFdLCBwKSAmJiBwb2luUmlnaHRMaW5lKHJlY3RhbmdsZVsxXSwgcmVjdGFuZ2xlWzJdLCBwKSAmJiBwb2luUmlnaHRMaW5lKHJlY3RhbmdsZVsyXSwgcmVjdGFuZ2xlWzNdLCBwKSAmJiBwb2luUmlnaHRMaW5lKHJlY3RhbmdsZVszXSwgcmVjdGFuZ2xlWzBdLCBwKTtcclxufVxyXG4vL+WIpOaWreeCueWcqOe6v+eahOWPs+S+pz9cclxuZnVuY3Rpb24gcG9pblJpZ2h0TGluZShzLCBlLCBwKSB7XHJcbiAgICByZXR1cm4gKChlLnggLSBzLngpICogKC1wLnkgKyBzLnkpIC0gKC1lLnkgKyBzLnkpICogKHAueCAtIHMueCkpIDwgMDtcclxufVxyXG4vLy0tLVxyXG4vLy0tLS0tLVxyXG4vLy1cclxuZnVuY3Rpb24gQ3VydmVMaW5rKGNvbmZpZykge1xyXG4gICAgaWYgKCFjb25maWcuc3RhcnQgfHwgIWNvbmZpZy5lbmQgfHwgIWNvbmZpZy5zdGFydC5qdG9wbyB8fCAhY29uZmlnLmVuZC5qdG9wbykge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTGluay5jYWxsKHRoaXMsIG5ldyBKVG9wby5DdXJ2ZUxpbmsoY29uZmlnLnN0YXJ0Lmp0b3BvLCBjb25maWcuZW5kLmp0b3BvKSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG4gICAgLy/mlLnlhpnmupDnoIHnu5jliLbmm7Lnur8s5Y+v55SxY3VydmVPZmZzZXTmjIflrprlvKfluqZcclxuICAgIHJlc2V0KHRoaXMpO1xyXG59XHJcblFUb3BvLnV0aWwuaW5oZXJpdHMoQ3VydmVMaW5rLCBMaW5rKTtcclxuLy8tXHJcbi8qKlxyXG4gKiAg5YWD57Sg5a+55bGe5oCn55qE57uf5LiA6K6+572u5Ye95pWw77yM5o6o6I2Q5L2/55SoXHJcbiAqXHJcbiAqICDlj4LmlbDlj6/orr7nva7kuIDpobnmiJblpJrpobks5pyq6K6+572u6YOo5YiG5Y+C6ICD5YWo5bGA6YWN572uXHJcbiAqICBAbWV0aG9kIHNldFxyXG4gKiAgQHBhcmFtIGNvbmZpZ1xyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAg5a6e6ZmF5Y+C5pWw5Y+C6ICDYXR0cuWGheWxnuaApyzlj6rkvJrkv67mlLnmnInlr7nlupRzZXTlh73mlbDnmoTlsZ7mgKcs6Iul5paw5aKe5bGe5oCn5LiU5re75Yqg5LqGc2V0WFhY5Ye95pWw77yM5Lmf5Y+v55So5q2k5Ye95pWw6YWN572uXHJcbiAqICAgICAgICAgIOWmgjpuYW1lIOWvueW6lCBzZXROYW1lKFwiLi5cIilcclxuICogICAgICAgICAg5Y+C5pWw5qC85byP5aaC5LiLXHJcbiAqICAgICAgICAgIGNvbmZpZz17XHJcbiAqICAgICAgICAgICAgICB4eDouLi4sXHJcbiAqICAgICAgICAgICAgICB4eDouLi5cclxuICogICAgICAgICAgfVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0SlRvcG8oY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXNldChsaW5rKSB7XHJcbiAgICBsaW5rLmp0b3BvLmdldFN0YXJ0UG9zaXRpb24gPWp0b3BvUmVzdC5nZXRTdGFydDtcclxuICAgIGxpbmsuanRvcG8uZ2V0RW5kUG9zaXRpb24gPWp0b3BvUmVzdC5nZXRFbmQ7XHJcbiAgICBsaW5rLmp0b3BvLnBhaW50UGF0aCA9anRvcG9SZXN0LnBhaW50UGF0aDtcclxuICAgIGxpbmsuanRvcG8uZ2V0UGF0aCA9anRvcG9SZXN0LmdldFBhdGg7XHJcbiAgICBsaW5rLmp0b3BvLmlzSW5Cb3VuZCA9IGp0b3BvUmVzdC5pc0luQm91bmQ7XHJcbiAgICBsaW5rLmp0b3BvLnBhaW50VGV4dCA9anRvcG9SZXN0LnBhaW50VGV4dDtcclxufVxyXG4vLy1cclxuLyoqXHJcbiAqICDorr7nva7mm7Lnur/lgY/np7vph49cclxuICpcclxuICogIEBtZXRob2Qgc2V0Q3VydmVPZmZzZXRcclxuICogIEBwYXJhbSBjdXJ2ZU9mZnNldCB7bnVtYmVyfVxyXG4gKi9cclxuQ3VydmVMaW5rLnByb3RvdHlwZS5zZXRDdXJ2ZU9mZnNldCA9IGZ1bmN0aW9uIChjdXJ2ZU9mZnNldCkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKGN1cnZlT2Zmc2V0KSkge1xyXG4gICAgICAgIHRoaXMuYXR0ci5jdXJ2ZU9mZnNldCA9IHBhcnNlSW50KGN1cnZlT2Zmc2V0KTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgICB2YXIgREVGQVVMVCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcyMiwxMjQsMjU1JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcDogMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFzaGVkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMTAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkNVUlZFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnZlT2Zmc2V0OiAyMDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5DdXJ2ZUxpbmsucHJvdG90eXBlLmdldERlZmF1bHQgPSBnZXREZWZhdWx0O1xyXG4vLy1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L2xpbmsvQ3VydmUuanNcbi8vIG1vZHVsZSBpZCA9IDMxXG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},32:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 直线链路\r\n * @class  DirectLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(2);\r\nmodule.exports = {\r\n    constructor: DirectLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        size: 10,\r\n        offset: 0,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId:"",\r\n    gap: 20,\r\n    width: 3,\r\n    dashed: null,\r\n    zIndex: 100,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    expendAble: true,\r\n    useType: QTopo.constant.link.DIRECT,\r\n    bundleOffset: 60// 多条直线时，线条折线拐角处的长度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//------\r\nvar jtopoReset={\r\n    //重写绘制，添加双向箭头\r\n    getStartPosition:function () {\r\n        var a;\r\n        return null != this.arrowsRadius && (a = (function (self) {\r\n            var b = self.nodeA, c = self.nodeZ;\r\n            var d = JTopo.util.lineF(b.cx, b.cy, c.cx, c.cy);\r\n            var e = b.getBound();\r\n            return f = JTopo.util.intersectionLineBound(d, e);\r\n        })(this)), null == a && (a = {\r\n            x: this.nodeA.cx,\r\n            y: this.nodeA.cy\r\n        }), a;\r\n    },\r\n    paintPath:function (a, b) {\r\n        if (this.nodeA === this.nodeZ) return void this.paintLoop(a);\r\n        a.beginPath(),\r\n            a.moveTo(b[0].x, b[0].y);\r\n        for (var c = 1; c < b.length; c++) {\r\n            null == this.dashedPattern ? (\r\n                (null == this.PointPathColor ? a.lineTo(b[c].x, b[c].y) : a.JtopoDrawPointPath(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, a.strokeStyle, this.PointPathColor))\r\n            ) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern)\r\n        }\r\n        if (a.stroke(), a.closePath(), null != this.arrowsRadius) {\r\n            if (this.qtopo.attr.arrow.end) {\r\n                this.paintArrow(a, b[0], b[b.length - 1]);\r\n            }//终点箭头\r\n            if (this.qtopo.attr.arrow.start) {\r\n                this.paintArrow(a, b[b.length - 1], b[0]);\r\n            }//起点箭头\r\n        }\r\n    }\r\n};\r\n//------\r\n//-\r\nfunction DirectLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.Link(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n    //源码修改\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(DirectLink, Link);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        self._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link) {\r\n    link.jtopo.getStartPosition = jtopoReset.getStartPosition;\r\n    link.jtopo.paintPath = jtopoReset.paintPath;\r\n}\r\n/**\r\n *  设置直线两端的线段长度\r\n *\r\n *  当一条链路的两端元素之间有多条链路时，链路将会分成三段绘制并偏移，以区分其他链路\r\n *  @method setBundleOffset\r\n *  @param bundleOffset {number}\r\n */\r\nDirectLink.prototype.setBundleOffset = function (bundleOffset) {\r\n    if ($.isNumeric(bundleOffset)) {\r\n        this.jtopo.bundleOffset = parseInt(bundleOffset);\r\n    }\r\n    this.attr.bundleOffset = this.jtopo.bundleOffset;\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *          var DEFAULT = {\r\n                                number: 1,\r\n                                alpha: 1,\r\n                                color: \'22,124,255\',\r\n                                arrow: {\r\n                                    size: 10,\r\n                                    offset: 0,\r\n                                    start: false,\r\n                                    end: false\r\n                                },\r\n                                jsonId:"",\r\n                                gap: 20,\r\n                                width: 3,\r\n                                dashed: null,\r\n                                zIndex: 100,\r\n                                font: {\r\n                                    size: 16,\r\n                                    type: "微软雅黑",\r\n                                    color: \'255,255,255\'\r\n                                },\r\n                                expendAble: true,\r\n                                useType: QTopo.constant.link.DIRECT,\r\n                                bundleOffset: 60// 多条直线时，线条折线拐角处的长度\r\n                            };\r\n */\r\nDirectLink.prototype.getDefault = getDefault;\r\n/**\r\n * 开启链路展开模式,为链路生成toggle函数\r\n * @method openToggle\r\n * @param scene {scene}链路所在图层\r\n */\r\nDirectLink.prototype.openToggle = function (scene) {\r\n    this.attr.expendAble = true;\r\n    var jtopo = scene.jtopo;\r\n    /**\r\n     * 链路展开/合并切换\r\n     * @method toggle\r\n     * @param [flag] {boolean}为true则展开为false则缩放，无值则根据现状自适应切换,\r\n     */\r\n    this.toggle = function (flag) {\r\n        var todo = !(this.getUseType() == QTopo.constant.CASUAL && this.parent);\r\n        if (typeof flag == "boolean" && (flag ^ todo)) {\r\n            return;\r\n        }\r\n        if (todo) {\r\n            //展开\r\n            //复制属性\r\n            if (this.attr.number > 1 && this.attr.expendAble) {\r\n                var childSet = QTopo.util.deepClone(this.attr);\r\n                childSet.start = this.path.start;\r\n                childSet.end = this.path.end;\r\n                childSet.useType = QTopo.constant.CASUAL;\r\n                childSet.number = 1;\r\n                var parent = {\r\n                    attr: this.attr,\r\n                    extra: this.extra,\r\n                    path: this.path,\r\n                    addChild: function (num) {\r\n                        if ($.isNumeric(num)) {\r\n                            num = parseInt(num);\r\n                            for (var i = 0; i < num; i++) {\r\n                                var link = scene.createLink(childSet);\r\n                                parent.children.push(link);\r\n                                link.parent = parent;\r\n                                link.extra = parent.extra;\r\n                            }\r\n                        }\r\n                    },\r\n                    children: []\r\n                };\r\n                scene.remove(this);\r\n                parent.addChild(parent.attr.number);\r\n            }\r\n        } else {\r\n            //聚合\r\n            var father = this.parent;\r\n            scene.remove(father.children);\r\n            var config = father.attr;\r\n            config.start = father.path.start;\r\n            config.end = father.path.end;\r\n            scene.createLink(config).extra = father.extra;\r\n        }\r\n    };\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0RpcmVjdC5qcz9jZjVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixjQUFjO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsTUFBTTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixRQUFRO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLFNBQVM7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMzIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBjb3JlXHJcbiAqL1xyXG4vKipcclxuICog55u057q/6ZO+6LevXHJcbiAqIEBjbGFzcyAgRGlyZWN0TGlua1xyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0xdIExpbmtcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIExpbmsgPSByZXF1aXJlKFwiLi9MaW5rLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIGNvbnN0cnVjdG9yOiBEaXJlY3RMaW5rLFxyXG4gICAgc2V0RGVmYXVsdDogc2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6IGdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID0ge1xyXG4gICAgbnVtYmVyOiAxLFxyXG4gICAgYWxwaGE6IDEsXHJcbiAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgYXJyb3c6IHtcclxuICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICBvZmZzZXQ6IDAsXHJcbiAgICAgICAgc3RhcnQ6IGZhbHNlLFxyXG4gICAgICAgIGVuZDogZmFsc2VcclxuICAgIH0sXHJcbiAgICBqc29uSWQ6XCJcIixcclxuICAgIGdhcDogMjAsXHJcbiAgICB3aWR0aDogMyxcclxuICAgIGRhc2hlZDogbnVsbCxcclxuICAgIHpJbmRleDogMTAwLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgY29sb3I6ICcyNTUsMjU1LDI1NSdcclxuICAgIH0sXHJcbiAgICBleHBlbmRBYmxlOiB0cnVlLFxyXG4gICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1QsXHJcbiAgICBidW5kbGVPZmZzZXQ6IDYwLy8g5aSa5p2h55u057q/5pe277yM57q/5p2h5oqY57q/5ouQ6KeS5aSE55qE6ZW/5bqmXHJcbn07XHJcbmZ1bmN0aW9uIHNldERlZmF1bHQoY29uZmlnKSB7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8udXRpbC5kZWVwQ2xvbmUoREVGQVVMVCk7XHJcbn1cclxuLy8tLS0tLS1cclxudmFyIGp0b3BvUmVzZXQ9e1xyXG4gICAgLy/ph43lhpnnu5jliLbvvIzmt7vliqDlj4zlkJHnrq3lpLRcclxuICAgIGdldFN0YXJ0UG9zaXRpb246ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhO1xyXG4gICAgICAgIHJldHVybiBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzICYmIChhID0gKGZ1bmN0aW9uIChzZWxmKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gc2VsZi5ub2RlQSwgYyA9IHNlbGYubm9kZVo7XHJcbiAgICAgICAgICAgIHZhciBkID0gSlRvcG8udXRpbC5saW5lRihiLmN4LCBiLmN5LCBjLmN4LCBjLmN5KTtcclxuICAgICAgICAgICAgdmFyIGUgPSBiLmdldEJvdW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmID0gSlRvcG8udXRpbC5pbnRlcnNlY3Rpb25MaW5lQm91bmQoZCwgZSk7XHJcbiAgICAgICAgfSkodGhpcykpLCBudWxsID09IGEgJiYgKGEgPSB7XHJcbiAgICAgICAgICAgIHg6IHRoaXMubm9kZUEuY3gsXHJcbiAgICAgICAgICAgIHk6IHRoaXMubm9kZUEuY3lcclxuICAgICAgICB9KSwgYTtcclxuICAgIH0sXHJcbiAgICBwYWludFBhdGg6ZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWikgcmV0dXJuIHZvaWQgdGhpcy5wYWludExvb3AoYSk7XHJcbiAgICAgICAgYS5iZWdpblBhdGgoKSxcclxuICAgICAgICAgICAgYS5tb3ZlVG8oYlswXS54LCBiWzBdLnkpO1xyXG4gICAgICAgIGZvciAodmFyIGMgPSAxOyBjIDwgYi5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICBudWxsID09IHRoaXMuZGFzaGVkUGF0dGVybiA/IChcclxuICAgICAgICAgICAgICAgIChudWxsID09IHRoaXMuUG9pbnRQYXRoQ29sb3IgPyBhLmxpbmVUbyhiW2NdLngsIGJbY10ueSkgOiBhLkp0b3BvRHJhd1BvaW50UGF0aChiW2MgLSAxXS54LCBiW2MgLSAxXS55LCBiW2NdLngsIGJbY10ueSwgYS5zdHJva2VTdHlsZSwgdGhpcy5Qb2ludFBhdGhDb2xvcikpXHJcbiAgICAgICAgICAgICkgOiBhLkpUb3BvRGFzaGVkTGluZVRvKGJbYyAtIDFdLngsIGJbYyAtIDFdLnksIGJbY10ueCwgYltjXS55LCB0aGlzLmRhc2hlZFBhdHRlcm4pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhLnN0cm9rZSgpLCBhLmNsb3NlUGF0aCgpLCBudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnF0b3BvLmF0dHIuYXJyb3cuZW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coYSwgYlswXSwgYltiLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICAgICAgfS8v57uI54K5566t5aS0XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnF0b3BvLmF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhhLCBiW2IubGVuZ3RoIC0gMV0sIGJbMF0pO1xyXG4gICAgICAgICAgICB9Ly/otbfngrnnrq3lpLRcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8vLS0tLS0tXHJcbi8vLVxyXG5mdW5jdGlvbiBEaXJlY3RMaW5rKGNvbmZpZykge1xyXG4gICAgaWYgKCFjb25maWcuc3RhcnQgfHwgIWNvbmZpZy5lbmQgfHwgIWNvbmZpZy5zdGFydC5qdG9wbyB8fCAhY29uZmlnLmVuZC5qdG9wbykge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTGluay5jYWxsKHRoaXMsIG5ldyBKVG9wby5MaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbykpO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHRoaXMuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgdGhpcy5zZXQodGhpcy5hdHRyKTtcclxuICAgIC8v5rqQ56CB5L+u5pS5XHJcbiAgICByZXNldCh0aGlzKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKERpcmVjdExpbmssIExpbmspO1xyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVzZXQobGluaykge1xyXG4gICAgbGluay5qdG9wby5nZXRTdGFydFBvc2l0aW9uID0ganRvcG9SZXNldC5nZXRTdGFydFBvc2l0aW9uO1xyXG4gICAgbGluay5qdG9wby5wYWludFBhdGggPSBqdG9wb1Jlc2V0LnBhaW50UGF0aDtcclxufVxyXG4vKipcclxuICogIOiuvue9ruebtOe6v+S4pOerr+eahOe6v+autemVv+W6plxyXG4gKlxyXG4gKiAg5b2T5LiA5p2h6ZO+6Lev55qE5Lik56uv5YWD57Sg5LmL6Ze05pyJ5aSa5p2h6ZO+6Lev5pe277yM6ZO+6Lev5bCG5Lya5YiG5oiQ5LiJ5q6157uY5Yi25bm25YGP56e777yM5Lul5Yy65YiG5YW25LuW6ZO+6LevXHJcbiAqICBAbWV0aG9kIHNldEJ1bmRsZU9mZnNldFxyXG4gKiAgQHBhcmFtIGJ1bmRsZU9mZnNldCB7bnVtYmVyfVxyXG4gKi9cclxuRGlyZWN0TGluay5wcm90b3R5cGUuc2V0QnVuZGxlT2Zmc2V0ID0gZnVuY3Rpb24gKGJ1bmRsZU9mZnNldCkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKGJ1bmRsZU9mZnNldCkpIHtcclxuICAgICAgICB0aGlzLmp0b3BvLmJ1bmRsZU9mZnNldCA9IHBhcnNlSW50KGJ1bmRsZU9mZnNldCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuYnVuZGxlT2Zmc2V0ID0gdGhpcy5qdG9wby5idW5kbGVPZmZzZXQ7XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDlhajlsYDmoLflvI9cclxuICogQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqIEByZXR1cm4ge29iamVjdH1cclxuICogQGV4YW1wbGVcclxuICogICAgICAgICAgdmFyIERFRkFVTFQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyb3c6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogMTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXA6IDIwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hlZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDEwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzI1NSwyNTUsMjU1J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZW5kQWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkRJUkVDVCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidW5kbGVPZmZzZXQ6IDYwLy8g5aSa5p2h55u057q/5pe277yM57q/5p2h5oqY57q/5ouQ6KeS5aSE55qE6ZW/5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuRGlyZWN0TGluay5wcm90b3R5cGUuZ2V0RGVmYXVsdCA9IGdldERlZmF1bHQ7XHJcbi8qKlxyXG4gKiDlvIDlkK/pk77ot6/lsZXlvIDmqKHlvI8s5Li66ZO+6Lev55Sf5oiQdG9nZ2xl5Ye95pWwXHJcbiAqIEBtZXRob2Qgb3BlblRvZ2dsZVxyXG4gKiBAcGFyYW0gc2NlbmUge3NjZW5lfemTvui3r+aJgOWcqOWbvuWxglxyXG4gKi9cclxuRGlyZWN0TGluay5wcm90b3R5cGUub3BlblRvZ2dsZSA9IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgdGhpcy5hdHRyLmV4cGVuZEFibGUgPSB0cnVlO1xyXG4gICAgdmFyIGp0b3BvID0gc2NlbmUuanRvcG87XHJcbiAgICAvKipcclxuICAgICAqIOmTvui3r+WxleW8gC/lkIjlubbliIfmjaJcclxuICAgICAqIEBtZXRob2QgdG9nZ2xlXHJcbiAgICAgKiBAcGFyYW0gW2ZsYWddIHtib29sZWFufeS4unRydWXliJnlsZXlvIDkuLpmYWxzZeWImee8qeaUvu+8jOaXoOWAvOWImeagueaNrueOsOeKtuiHqumAguW6lOWIh+aNoixcclxuICAgICAqL1xyXG4gICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICAgIHZhciB0b2RvID0gISh0aGlzLmdldFVzZVR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5DQVNVQUwgJiYgdGhpcy5wYXJlbnQpO1xyXG4gICAgICAgIGlmICh0eXBlb2YgZmxhZyA9PSBcImJvb2xlYW5cIiAmJiAoZmxhZyBeIHRvZG8pKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRvZG8pIHtcclxuICAgICAgICAgICAgLy/lsZXlvIBcclxuICAgICAgICAgICAgLy/lpI3liLblsZ7mgKdcclxuICAgICAgICAgICAgaWYgKHRoaXMuYXR0ci5udW1iZXIgPiAxICYmIHRoaXMuYXR0ci5leHBlbmRBYmxlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRTZXQgPSBRVG9wby51dGlsLmRlZXBDbG9uZSh0aGlzLmF0dHIpO1xyXG4gICAgICAgICAgICAgICAgY2hpbGRTZXQuc3RhcnQgPSB0aGlzLnBhdGguc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICBjaGlsZFNldC5lbmQgPSB0aGlzLnBhdGguZW5kO1xyXG4gICAgICAgICAgICAgICAgY2hpbGRTZXQudXNlVHlwZSA9IFFUb3BvLmNvbnN0YW50LkNBU1VBTDtcclxuICAgICAgICAgICAgICAgIGNoaWxkU2V0Lm51bWJlciA9IDE7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGF0dHI6IHRoaXMuYXR0cixcclxuICAgICAgICAgICAgICAgICAgICBleHRyYTogdGhpcy5leHRyYSxcclxuICAgICAgICAgICAgICAgICAgICBwYXRoOiB0aGlzLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uIChudW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNOdW1lcmljKG51bSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9IHBhcnNlSW50KG51bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmsgPSBzY2VuZS5jcmVhdGVMaW5rKGNoaWxkU2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY2hpbGRyZW4ucHVzaChsaW5rKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnBhcmVudCA9IHBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLmV4dHJhID0gcGFyZW50LmV4dHJhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW11cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQuYWRkQ2hpbGQocGFyZW50LmF0dHIubnVtYmVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8v6IGa5ZCIXHJcbiAgICAgICAgICAgIHZhciBmYXRoZXIgPSB0aGlzLnBhcmVudDtcclxuICAgICAgICAgICAgc2NlbmUucmVtb3ZlKGZhdGhlci5jaGlsZHJlbik7XHJcbiAgICAgICAgICAgIHZhciBjb25maWcgPSBmYXRoZXIuYXR0cjtcclxuICAgICAgICAgICAgY29uZmlnLnN0YXJ0ID0gZmF0aGVyLnBhdGguc3RhcnQ7XHJcbiAgICAgICAgICAgIGNvbmZpZy5lbmQgPSBmYXRoZXIucGF0aC5lbmQ7XHJcbiAgICAgICAgICAgIHNjZW5lLmNyZWF0ZUxpbmsoY29uZmlnKS5leHRyYSA9IGZhdGhlci5leHRyYTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluay9EaXJlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDMyXG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},33:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 二次折线链路\r\n * @class  FlexionalLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link = __webpack_require__(2);\r\nmodule.exports = {\r\n    constructor: FlexionalLink,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    number: 1,\r\n    alpha: 1,\r\n    color: \'22,124,255\',\r\n    arrow: {\r\n        size: 10,\r\n        offset: 0,\r\n        start: false,\r\n        end: false\r\n    },\r\n    jsonId:"",\r\n    radius: 0,\r\n    gap: 20,\r\n    width: 2,\r\n    dashed: null,\r\n    zIndex: 100,\r\n    font: {\r\n        size: 16,\r\n        type: "微软雅黑",\r\n        color: \'255,255,255\'\r\n    },\r\n    useType: QTopo.constant.link.FLEXIONAL,\r\n    direction: "horizontal",\r\n    offsetGap: 60//折线处长度\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//-----\r\nvar jtopoReset = {\r\n    paintPath: function (cx, path) {\r\n        var attr = this.qtopo.attr;\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(cx);\r\n        var start = path[0];\r\n        var end = path[path.length - 1];\r\n        cx.beginPath();\r\n        cx.moveTo(start.x, start.y);\r\n        for (var i = 1; i < path.length; i++) {\r\n            if (null == this.dashedPattern) {\r\n                if (attr.radius > 0) {\r\n                    if (i < path.length - 1) {\r\n                        cx.arcTo(path[i].x, path[i].y,path[i + 1].x, path[i + 1].y,attr.radius);//增加折线弧度\r\n                    } else {\r\n                        cx.lineTo(path[i].x, path[i].y);\r\n                    }\r\n                } else {\r\n                    cx.lineTo(path[i].x, path[i].y);\r\n                }\r\n            } else {\r\n                cx.JTopoDashedLineTo(path[i - 1].x, path[i - 1].y, path[i].x, path[i].y, this.dashedPattern);\r\n            }\r\n        }\r\n        cx.stroke();\r\n        cx.closePath();\r\n        if (null != this.arrowsRadius) {\r\n            if (attr.arrow.end) {\r\n                this.paintArrow(cx, path[path.length - 2], path[path.length - 1]);\r\n            }\r\n            if (attr.arrow.start) {\r\n                this.paintArrow(cx, path[1], path[0]);//添加双向箭头\r\n            }\r\n        }\r\n    }\r\n};\r\n//-----\r\nfunction FlexionalLink(config) {\r\n    if (!config.start || !config.end || !config.start.jtopo || !config.end.jtopo) {\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.FlexionalLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n    //修改源码\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(FlexionalLink, Link);\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self = this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link) {\r\n    //双向箭头\r\n    link.jtopo.paintPath = jtopoReset.paintPath;\r\n}\r\n/**\r\n *  两端折线线段的长度\r\n *\r\n *  @method setOffsetGap\r\n *  @param offsetGap {number}\r\n */\r\nFlexionalLink.prototype.setOffsetGap = function (offsetGap) {\r\n    if ($.isNumeric(offsetGap)) {\r\n        this.jtopo.offsetGap = parseInt(offsetGap);\r\n    }\r\n    this.attr.offsetGap = this.jtopo.offsetGap;\r\n};\r\n/**\r\n *  设置折线方向\r\n *\r\n *  @method setDirection\r\n *  @param direction {string} horizontal 水平 "vertical"垂直\r\n */\r\nFlexionalLink.prototype.setDirection = function (direction) {\r\n    //折线方向 horizontal 水平 "vertical"垂直\r\n    if (direction) {\r\n        this.jtopo.direction = direction;\r\n    }\r\n    this.attr.direction = this.jtopo.direction;\r\n};\r\n/**\r\n *  设置折角弧度\r\n *\r\n *  @method setRadius\r\n *  @param radius {number}\r\n */\r\nFlexionalLink.prototype.setRadius = function (radius) {\r\n    if ($.isNumeric(radius)) {\r\n        radius = parseInt(radius);\r\n        if (radius > 20) {\r\n            radius = 20;\r\n        } else if (radius < 0) {\r\n            radius = 0;\r\n        }\r\n        this.attr.radius = radius;\r\n    }\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *         var DEFAULT = {\r\n                            number: 1,\r\n                            alpha: 1,\r\n                            color: \'22,124,255\',\r\n                            arrow: {\r\n                                size: 10,\r\n                                offset: 0,\r\n                                start: false,\r\n                                end: false\r\n                            },\r\n                            jsonId:"",\r\n                            radius: 0,\r\n                            gap: 20,\r\n                            width: 2,\r\n                            dashed: null,\r\n                            zIndex: 100,\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑",\r\n                                color: \'255,255,255\'\r\n                            },\r\n                            useType: QTopo.constant.link.FLEXIONAL,\r\n                            direction: "horizontal",\r\n                            offsetGap: 60//两端折线线段的长度\r\n                        };\r\n */\r\nFlexionalLink.prototype.getDefault = getDefault;\r\n/*一种绘制固定在节点右侧的二次线*/\r\n//resetFold.jtopo.getPath =poinst;\r\nfunction poinst() {\r\n    //重写线的绘制路径\r\n    var littleSize = 50;\r\n    var startRight = {\r\n        x: start.x + start.width,\r\n        y: start.y + start.height / 2\r\n    };\r\n    var endRight = {\r\n        x: end.x + end.width,\r\n        y: end.y + end.height / 2\r\n    };\r\n    var middleA = {};\r\n    var middleB = {};\r\n    if (startRight.x > endRight.x) {\r\n        middleA.x = startRight.x + littleSize;\r\n        middleA.y = startRight.y;\r\n        middleB.x = startRight.x + littleSize;\r\n        middleB.y = endRight.y;\r\n    } else {\r\n        middleA.x = endRight.x + littleSize;\r\n        middleA.y = startRight.y;\r\n        middleB.x = endRight.x + littleSize;\r\n        middleB.y = endRight.y;\r\n    }\r\n    return [startRight, middleA, middleB, endRight];\r\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZsZXhpb25hbC5qcz8wMDA2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGlCQUFpQjtBQUN4QztBQUNBO0FBQ0E7QUFDQSxnR0FBZ0c7QUFDaEcscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDkuozmrKHmipjnur/pk77ot69cclxuICogQGNsYXNzICBGbGV4aW9uYWxMaW5rXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTF0gTGlua1xyXG4gKiBAcGFyYW0gW2NvbmZpZ10g6YWN572u5Y+C5pWw77yM5peg5Y+C5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqL1xyXG52YXIgTGluayA9IHJlcXVpcmUoXCIuL0xpbmsuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6IEZsZXhpb25hbExpbmssXHJcbiAgICBzZXREZWZhdWx0OiBzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDogZ2V0RGVmYXVsdFxyXG59O1xyXG4vLy1cclxudmFyIERFRkFVTFQgPSB7XHJcbiAgICBudW1iZXI6IDEsXHJcbiAgICBhbHBoYTogMSxcclxuICAgIGNvbG9yOiAnMjIsMTI0LDI1NScsXHJcbiAgICBhcnJvdzoge1xyXG4gICAgICAgIHNpemU6IDEwLFxyXG4gICAgICAgIG9mZnNldDogMCxcclxuICAgICAgICBzdGFydDogZmFsc2UsXHJcbiAgICAgICAgZW5kOiBmYWxzZVxyXG4gICAgfSxcclxuICAgIGpzb25JZDpcIlwiLFxyXG4gICAgcmFkaXVzOiAwLFxyXG4gICAgZ2FwOiAyMCxcclxuICAgIHdpZHRoOiAyLFxyXG4gICAgZGFzaGVkOiBudWxsLFxyXG4gICAgekluZGV4OiAxMDAsXHJcbiAgICBmb250OiB7XHJcbiAgICAgICAgc2l6ZTogMTYsXHJcbiAgICAgICAgdHlwZTogXCLlvq7ova/pm4Xpu5FcIixcclxuICAgICAgICBjb2xvcjogJzI1NSwyNTUsMjU1J1xyXG4gICAgfSxcclxuICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50LmxpbmsuRkxFWElPTkFMLFxyXG4gICAgZGlyZWN0aW9uOiBcImhvcml6b250YWxcIixcclxuICAgIG9mZnNldEdhcDogNjAvL+aKmOe6v+WkhOmVv+W6plxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZykge1xyXG4gICAgUVRvcG8udXRpbC5leHRlbmQoREVGQVVMVCwgY29uZmlnIHx8IHt9KTtcclxufVxyXG5mdW5jdGlvbiBnZXREZWZhdWx0KCkge1xyXG4gICAgcmV0dXJuIFFUb3BvLnV0aWwuZGVlcENsb25lKERFRkFVTFQpO1xyXG59XHJcbi8vLVxyXG4vLy0tLS0tXHJcbnZhciBqdG9wb1Jlc2V0ID0ge1xyXG4gICAgcGFpbnRQYXRoOiBmdW5jdGlvbiAoY3gsIHBhdGgpIHtcclxuICAgICAgICB2YXIgYXR0ciA9IHRoaXMucXRvcG8uYXR0cjtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gdm9pZCB0aGlzLnBhaW50TG9vcChjeCk7XHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gcGF0aFswXTtcclxuICAgICAgICB2YXIgZW5kID0gcGF0aFtwYXRoLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgIGN4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGN4Lm1vdmVUbyhzdGFydC54LCBzdGFydC55KTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKG51bGwgPT0gdGhpcy5kYXNoZWRQYXR0ZXJuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXR0ci5yYWRpdXMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBwYXRoLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3guYXJjVG8ocGF0aFtpXS54LCBwYXRoW2ldLnkscGF0aFtpICsgMV0ueCwgcGF0aFtpICsgMV0ueSxhdHRyLnJhZGl1cyk7Ly/lop7liqDmipjnur/lvKfluqZcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjeC5saW5lVG8ocGF0aFtpXS54LCBwYXRoW2ldLnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3gubGluZVRvKHBhdGhbaV0ueCwgcGF0aFtpXS55KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGN4LkpUb3BvRGFzaGVkTGluZVRvKHBhdGhbaSAtIDFdLngsIHBhdGhbaSAtIDFdLnksIHBhdGhbaV0ueCwgcGF0aFtpXS55LCB0aGlzLmRhc2hlZFBhdHRlcm4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN4LnN0cm9rZSgpO1xyXG4gICAgICAgIGN4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgIGlmIChudWxsICE9IHRoaXMuYXJyb3dzUmFkaXVzKSB7XHJcbiAgICAgICAgICAgIGlmIChhdHRyLmFycm93LmVuZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWludEFycm93KGN4LCBwYXRoW3BhdGgubGVuZ3RoIC0gMl0sIHBhdGhbcGF0aC5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGF0dHIuYXJyb3cuc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhjeCwgcGF0aFsxXSwgcGF0aFswXSk7Ly/mt7vliqDlj4zlkJHnrq3lpLRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLy8tLS0tLVxyXG5mdW5jdGlvbiBGbGV4aW9uYWxMaW5rKGNvbmZpZykge1xyXG4gICAgaWYgKCFjb25maWcuc3RhcnQgfHwgIWNvbmZpZy5lbmQgfHwgIWNvbmZpZy5zdGFydC5qdG9wbyB8fCAhY29uZmlnLmVuZC5qdG9wbykge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJDcmVhdGUgTGluayBuZWVkIHN0YXJ0IGFuZCBlbmRcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTGluay5jYWxsKHRoaXMsIG5ldyBKVG9wby5GbGV4aW9uYWxMaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbykpO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHRoaXMuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgdGhpcy5zZXQodGhpcy5hdHRyKTtcclxuICAgIC8v5L+u5pS55rqQ56CBXHJcbiAgICByZXNldCh0aGlzKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKEZsZXhpb25hbExpbmssIExpbmspO1xyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zZXRBdHRyKGNvbmZpZyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVzZXQobGluaykge1xyXG4gICAgLy/lj4zlkJHnrq3lpLRcclxuICAgIGxpbmsuanRvcG8ucGFpbnRQYXRoID0ganRvcG9SZXNldC5wYWludFBhdGg7XHJcbn1cclxuLyoqXHJcbiAqICDkuKTnq6/mipjnur/nur/mrrXnmoTplb/luqZcclxuICpcclxuICogIEBtZXRob2Qgc2V0T2Zmc2V0R2FwXHJcbiAqICBAcGFyYW0gb2Zmc2V0R2FwIHtudW1iZXJ9XHJcbiAqL1xyXG5GbGV4aW9uYWxMaW5rLnByb3RvdHlwZS5zZXRPZmZzZXRHYXAgPSBmdW5jdGlvbiAob2Zmc2V0R2FwKSB7XHJcbiAgICBpZiAoJC5pc051bWVyaWMob2Zmc2V0R2FwKSkge1xyXG4gICAgICAgIHRoaXMuanRvcG8ub2Zmc2V0R2FwID0gcGFyc2VJbnQob2Zmc2V0R2FwKTtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5vZmZzZXRHYXAgPSB0aGlzLmp0b3BvLm9mZnNldEdhcDtcclxufTtcclxuLyoqXHJcbiAqICDorr7nva7mipjnur/mlrnlkJFcclxuICpcclxuICogIEBtZXRob2Qgc2V0RGlyZWN0aW9uXHJcbiAqICBAcGFyYW0gZGlyZWN0aW9uIHtzdHJpbmd9IGhvcml6b250YWwg5rC05bmzIFwidmVydGljYWxcIuWeguebtFxyXG4gKi9cclxuRmxleGlvbmFsTGluay5wcm90b3R5cGUuc2V0RGlyZWN0aW9uID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xyXG4gICAgLy/mipjnur/mlrnlkJEgaG9yaXpvbnRhbCDmsLTlubMgXCJ2ZXJ0aWNhbFwi5Z6C55u0XHJcbiAgICBpZiAoZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dHIuZGlyZWN0aW9uID0gdGhpcy5qdG9wby5kaXJlY3Rpb247XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5oqY6KeS5byn5bqmXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldFJhZGl1c1xyXG4gKiAgQHBhcmFtIHJhZGl1cyB7bnVtYmVyfVxyXG4gKi9cclxuRmxleGlvbmFsTGluay5wcm90b3R5cGUuc2V0UmFkaXVzID0gZnVuY3Rpb24gKHJhZGl1cykge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHJhZGl1cykpIHtcclxuICAgICAgICByYWRpdXMgPSBwYXJzZUludChyYWRpdXMpO1xyXG4gICAgICAgIGlmIChyYWRpdXMgPiAyMCkge1xyXG4gICAgICAgICAgICByYWRpdXMgPSAyMDtcclxuICAgICAgICB9IGVsc2UgaWYgKHJhZGl1cyA8IDApIHtcclxuICAgICAgICAgICAgcmFkaXVzID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRyLnJhZGl1cyA9IHJhZGl1cztcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiBAbWV0aG9kIGdldERlZmF1bHRcclxuICogQHJldHVybiB7b2JqZWN0fVxyXG4gKiBAZXhhbXBsZVxyXG4gKiAgICAgICAgIHZhciBERUZBVUxUID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyb3c6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcDogMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hlZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMTAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcyNTUsMjU1LDI1NSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkZMRVhJT05BTCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogXCJob3Jpem9udGFsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRHYXA6IDYwLy/kuKTnq6/mipjnur/nur/mrrXnmoTplb/luqZcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICovXHJcbkZsZXhpb25hbExpbmsucHJvdG90eXBlLmdldERlZmF1bHQgPSBnZXREZWZhdWx0O1xyXG4vKuS4gOenjee7mOWItuWbuuWumuWcqOiKgueCueWPs+S+p+eahOS6jOasoee6vyovXHJcbi8vcmVzZXRGb2xkLmp0b3BvLmdldFBhdGggPXBvaW5zdDtcclxuZnVuY3Rpb24gcG9pbnN0KCkge1xyXG4gICAgLy/ph43lhpnnur/nmoTnu5jliLbot6/lvoRcclxuICAgIHZhciBsaXR0bGVTaXplID0gNTA7XHJcbiAgICB2YXIgc3RhcnRSaWdodCA9IHtcclxuICAgICAgICB4OiBzdGFydC54ICsgc3RhcnQud2lkdGgsXHJcbiAgICAgICAgeTogc3RhcnQueSArIHN0YXJ0LmhlaWdodCAvIDJcclxuICAgIH07XHJcbiAgICB2YXIgZW5kUmlnaHQgPSB7XHJcbiAgICAgICAgeDogZW5kLnggKyBlbmQud2lkdGgsXHJcbiAgICAgICAgeTogZW5kLnkgKyBlbmQuaGVpZ2h0IC8gMlxyXG4gICAgfTtcclxuICAgIHZhciBtaWRkbGVBID0ge307XHJcbiAgICB2YXIgbWlkZGxlQiA9IHt9O1xyXG4gICAgaWYgKHN0YXJ0UmlnaHQueCA+IGVuZFJpZ2h0LngpIHtcclxuICAgICAgICBtaWRkbGVBLnggPSBzdGFydFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgIG1pZGRsZUEueSA9IHN0YXJ0UmlnaHQueTtcclxuICAgICAgICBtaWRkbGVCLnggPSBzdGFydFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgIG1pZGRsZUIueSA9IGVuZFJpZ2h0Lnk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIG1pZGRsZUEueCA9IGVuZFJpZ2h0LnggKyBsaXR0bGVTaXplO1xyXG4gICAgICAgIG1pZGRsZUEueSA9IHN0YXJ0UmlnaHQueTtcclxuICAgICAgICBtaWRkbGVCLnggPSBlbmRSaWdodC54ICsgbGl0dGxlU2l6ZTtcclxuICAgICAgICBtaWRkbGVCLnkgPSBlbmRSaWdodC55O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtzdGFydFJpZ2h0LCBtaWRkbGVBLCBtaWRkbGVCLCBlbmRSaWdodF07XHJcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29yZS9lbGVtZW50L2xpbmsvRmxleGlvbmFsLmpzXG4vLyBtb2R1bGUgaWQgPSAzM1xuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9');
},34:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 折线链路\r\n * @class  FoldLink\r\n * @constructor\r\n * @extends [L] Link\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Link=__webpack_require__(2);\r\nmodule.exports =  {\r\n    constructor:FoldLink,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT ={\r\n        number:1,\r\n        alpha:1,\r\n        color: \'22,124,255\',\r\n        arrow:{\r\n            size:10,\r\n            offset:0,\r\n            start:false,\r\n            end:false\r\n        },\r\n        jsonId:"",\r\n        gap:20,\r\n        width: 2,\r\n        dashed:  null,\r\n        zIndex : 100,\r\n        radius:0,\r\n        font:{\r\n            size:16,\r\n            type:"微软雅黑",\r\n            color:\'255,255,255\'\r\n        },\r\n        useType: QTopo.constant.link.FOLD,\r\n        direction:"vertical"\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//---------\r\nvar jtopoReset={\r\n    //双向箭头\r\n    paintPath:function (cx, path) {\r\n        var attr=this.qtopo.attr;\r\n        if (this.nodeA === this.nodeZ)return void this.paintLoop(cx);\r\n        cx.beginPath();\r\n        cx.moveTo(path[0].x, path[0].y);\r\n        for (var i = 1; i < path.length; i++){\r\n            if(null == this.dashedPattern){\r\n                if (attr.radius > 0) {\r\n                    if (i < path.length - 1) {\r\n                        cx.arcTo(path[i].x, path[i].y,path[i + 1].x, path[i + 1].y,attr.radius);//增加折线弧度\r\n                    } else {\r\n                        cx.lineTo(path[i].x, path[i].y);\r\n                    }\r\n                } else {\r\n                    cx.lineTo(path[i].x, path[i].y);\r\n                }\r\n            }else{\r\n                cx.JTopoDashedLineTo(path[i - 1].x, path[i - 1].y, path[i].x, path[i].y, this.dashedPattern);\r\n            }\r\n        }\r\n        cx.stroke();\r\n        cx.closePath();\r\n        if (null != this.arrowsRadius) {\r\n            if (attr.arrow.end) {\r\n                this.paintArrow(cx, path[path.length - 2], path[path.length - 1]);\r\n            }\r\n            if (attr.arrow.start) {\r\n                this.paintArrow(cx, path[1], path[0]);//添加双向箭头\r\n            }\r\n        }\r\n    }\r\n};\r\n//---------\r\n//-\r\nfunction FoldLink(config){\r\n    if(!config.start||!config.end||!config.start.jtopo||!config.end.jtopo){\r\n        QTopo.util.error("Create Link need start and end");\r\n        return;\r\n    }\r\n    this.attr =  QTopo.util.extend(getDefault(), config || {});\r\n    Link.call(this, new JTopo.FoldLink(config.start.jtopo, config.end.jtopo));\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n    //修改源码\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(FoldLink,Link);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        var self=this;\r\n        this._setAttr(config);\r\n    }\r\n}\r\nfunction reset(link){\r\n    link.jtopo.paintPath = jtopoReset.paintPath;\r\n}\r\n//-\r\n/**\r\n *  设置折线方向\r\n *\r\n *  @method setDirection\r\n *  @param direction {string} /horizontal 水平 "vertical"垂直\r\n */\r\nFoldLink.prototype.setDirection=function(direction){\r\n    if(direction){\r\n        this.jtopo.direction=direction;\r\n    }\r\n    this.attr.direction=this.jtopo.direction;\r\n};\r\n/**\r\n * 获取元素全局样式\r\n * @method getDefault\r\n * @return {object}\r\n * @example\r\n *        var DEFAULT ={\r\n                            number:1,\r\n                            alpha:1,\r\n                            color: \'22,124,255\',\r\n                            arrow:{\r\n                                size:10,\r\n                                offset:0,\r\n                                start:false,\r\n                                end:false\r\n                            },\r\n                            jsonId:"",\r\n                            gap:20,\r\n                            width: 2,\r\n                            dashed:  null,\r\n                            zIndex : 100,\r\n                            radius:0,\r\n                            font:{\r\n                                size:16,\r\n                                type:"微软雅黑",\r\n                                color:\'255,255,255\'\r\n                            },\r\n                            useType: QTopo.constant.link.FOLD,\r\n                            direction:"vertical"\r\n                    };\r\n */\r\nFoldLink.prototype.getDefault=getDefault;\r\n/**\r\n *  设置折角弧度\r\n *\r\n *  @method setRadius\r\n *  @param radius {number}\r\n */\r\nFoldLink.prototype.setRadius = function (radius) {\r\n    if ($.isNumeric(radius)) {\r\n        radius = parseInt(radius);\r\n        if (radius > 20) {\r\n            radius = 20;\r\n        } else if (radius < 0) {\r\n            radius = 0;\r\n        }\r\n        this.attr.radius = radius;\r\n    }\r\n};\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9saW5rL0ZvbGQuanM/NTBiYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsZ0dBQWdHO0FBQ2hHLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzNC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDmipjnur/pk77ot69cclxuICogQGNsYXNzICBGb2xkTGlua1xyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMgW0xdIExpbmtcclxuICogQHBhcmFtIFtjb25maWddIOmFjee9ruWPguaVsO+8jOaXoOWPguWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKi9cclxudmFyIExpbms9cmVxdWlyZShcIi4vTGluay5qc1wiKTtcclxubW9kdWxlLmV4cG9ydHMgPSAge1xyXG4gICAgY29uc3RydWN0b3I6Rm9sZExpbmssXHJcbiAgICBzZXREZWZhdWx0OnNldERlZmF1bHQsXHJcbiAgICBnZXREZWZhdWx0OmdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID17XHJcbiAgICAgICAgbnVtYmVyOjEsXHJcbiAgICAgICAgYWxwaGE6MSxcclxuICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgc2l6ZToxMCxcclxuICAgICAgICAgICAgb2Zmc2V0OjAsXHJcbiAgICAgICAgICAgIHN0YXJ0OmZhbHNlLFxyXG4gICAgICAgICAgICBlbmQ6ZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgIGdhcDoyMCxcclxuICAgICAgICB3aWR0aDogMixcclxuICAgICAgICBkYXNoZWQ6ICBudWxsLFxyXG4gICAgICAgIHpJbmRleCA6IDEwMCxcclxuICAgICAgICByYWRpdXM6MCxcclxuICAgICAgICBmb250OntcclxuICAgICAgICAgICAgc2l6ZToxNixcclxuICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICBjb2xvcjonMjU1LDI1NSwyNTUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkZPTEQsXHJcbiAgICAgICAgZGlyZWN0aW9uOlwidmVydGljYWxcIlxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZyl7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKXtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy0tLS0tLS0tLVxyXG52YXIganRvcG9SZXNldD17XHJcbiAgICAvL+WPjOWQkeeureWktFxyXG4gICAgcGFpbnRQYXRoOmZ1bmN0aW9uIChjeCwgcGF0aCkge1xyXG4gICAgICAgIHZhciBhdHRyPXRoaXMucXRvcG8uYXR0cjtcclxuICAgICAgICBpZiAodGhpcy5ub2RlQSA9PT0gdGhpcy5ub2RlWilyZXR1cm4gdm9pZCB0aGlzLnBhaW50TG9vcChjeCk7XHJcbiAgICAgICAgY3guYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgY3gubW92ZVRvKHBhdGhbMF0ueCwgcGF0aFswXS55KTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBhdGgubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBpZihudWxsID09IHRoaXMuZGFzaGVkUGF0dGVybil7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXR0ci5yYWRpdXMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBwYXRoLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3guYXJjVG8ocGF0aFtpXS54LCBwYXRoW2ldLnkscGF0aFtpICsgMV0ueCwgcGF0aFtpICsgMV0ueSxhdHRyLnJhZGl1cyk7Ly/lop7liqDmipjnur/lvKfluqZcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjeC5saW5lVG8ocGF0aFtpXS54LCBwYXRoW2ldLnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3gubGluZVRvKHBhdGhbaV0ueCwgcGF0aFtpXS55KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBjeC5KVG9wb0Rhc2hlZExpbmVUbyhwYXRoW2kgLSAxXS54LCBwYXRoW2kgLSAxXS55LCBwYXRoW2ldLngsIHBhdGhbaV0ueSwgdGhpcy5kYXNoZWRQYXR0ZXJuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjeC5zdHJva2UoKTtcclxuICAgICAgICBjeC5jbG9zZVBhdGgoKTtcclxuICAgICAgICBpZiAobnVsbCAhPSB0aGlzLmFycm93c1JhZGl1cykge1xyXG4gICAgICAgICAgICBpZiAoYXR0ci5hcnJvdy5lbmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFpbnRBcnJvdyhjeCwgcGF0aFtwYXRoLmxlbmd0aCAtIDJdLCBwYXRoW3BhdGgubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhdHRyLmFycm93LnN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50QXJyb3coY3gsIHBhdGhbMV0sIHBhdGhbMF0pOy8v5re75Yqg5Y+M5ZCR566t5aS0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8vLS0tLS0tLS0tXHJcbi8vLVxyXG5mdW5jdGlvbiBGb2xkTGluayhjb25maWcpe1xyXG4gICAgaWYoIWNvbmZpZy5zdGFydHx8IWNvbmZpZy5lbmR8fCFjb25maWcuc3RhcnQuanRvcG98fCFjb25maWcuZW5kLmp0b3BvKXtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiQ3JlYXRlIExpbmsgbmVlZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ciA9ICBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBMaW5rLmNhbGwodGhpcywgbmV3IEpUb3BvLkZvbGRMaW5rKGNvbmZpZy5zdGFydC5qdG9wbywgY29uZmlnLmVuZC5qdG9wbykpO1xyXG4gICAgLy/lh73mlbBcclxuICAgIHRoaXMuc2V0ID0gc2V0SlRvcG87XHJcbiAgICAvL+WIneWni+WMllxyXG4gICAgdGhpcy5zZXQodGhpcy5hdHRyKTtcclxuICAgIC8v5L+u5pS55rqQ56CBXHJcbiAgICByZXNldCh0aGlzKTtcclxufVxyXG5RVG9wby51dGlsLmluaGVyaXRzKEZvbGRMaW5rLExpbmspO1xyXG4vLy1cclxuLyoqXHJcbiAqICDlhYPntKDlr7nlsZ7mgKfnmoTnu5/kuIDorr7nva7lh73mlbDvvIzmjqjojZDkvb/nlKhcclxuICpcclxuICogIOWPguaVsOWPr+iuvue9ruS4gOmhueaIluWkmumhuSzmnKrorr7nva7pg6jliIblj4LogIPlhajlsYDphY3nva5cclxuICogIEBtZXRob2Qgc2V0XHJcbiAqICBAcGFyYW0gY29uZmlnXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICAgICDlrp7pmYXlj4LmlbDlj4LogINhdHRy5YaF5bGe5oCnLOWPquS8muS/ruaUueacieWvueW6lHNldOWHveaVsOeahOWxnuaApyzoi6XmlrDlop7lsZ7mgKfkuJTmt7vliqDkuoZzZXRYWFjlh73mlbDvvIzkuZ/lj6/nlKjmraTlh73mlbDphY3nva5cclxuICogICAgICAgICAg5aaCOm5hbWUg5a+55bqUIHNldE5hbWUoXCIuLlwiKVxyXG4gKiAgICAgICAgICDlj4LmlbDmoLzlvI/lpoLkuItcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHh4Oi4uLixcclxuICogICAgICAgICAgICAgIHh4Oi4uLlxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRKVG9wbyhjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG4gICAgICAgIHRoaXMuX3NldEF0dHIoY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXNldChsaW5rKXtcclxuICAgIGxpbmsuanRvcG8ucGFpbnRQYXRoID0ganRvcG9SZXNldC5wYWludFBhdGg7XHJcbn1cclxuLy8tXHJcbi8qKlxyXG4gKiAg6K6+572u5oqY57q/5pa55ZCRXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldERpcmVjdGlvblxyXG4gKiAgQHBhcmFtIGRpcmVjdGlvbiB7c3RyaW5nfSAvaG9yaXpvbnRhbCDmsLTlubMgXCJ2ZXJ0aWNhbFwi5Z6C55u0XHJcbiAqL1xyXG5Gb2xkTGluay5wcm90b3R5cGUuc2V0RGlyZWN0aW9uPWZ1bmN0aW9uKGRpcmVjdGlvbil7XHJcbiAgICBpZihkaXJlY3Rpb24pe1xyXG4gICAgICAgIHRoaXMuanRvcG8uZGlyZWN0aW9uPWRpcmVjdGlvbjtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0ci5kaXJlY3Rpb249dGhpcy5qdG9wby5kaXJlY3Rpb247XHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDlhajlsYDmoLflvI9cclxuICogQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqIEByZXR1cm4ge29iamVjdH1cclxuICogQGV4YW1wbGVcclxuICogICAgICAgIHZhciBERUZBVUxUID17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6MSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOjEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJzIyLDEyNCwyNTUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyb3c6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6MTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6ZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOmZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbklkOlwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXA6MjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hlZDogIG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXggOiAxMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6MTYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpcIuW+rui9r+mbhem7kVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOicyNTUsMjU1LDI1NSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5saW5rLkZPTEQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246XCJ2ZXJ0aWNhbFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICovXHJcbkZvbGRMaW5rLnByb3RvdHlwZS5nZXREZWZhdWx0PWdldERlZmF1bHQ7XHJcbi8qKlxyXG4gKiAg6K6+572u5oqY6KeS5byn5bqmXHJcbiAqXHJcbiAqICBAbWV0aG9kIHNldFJhZGl1c1xyXG4gKiAgQHBhcmFtIHJhZGl1cyB7bnVtYmVyfVxyXG4gKi9cclxuRm9sZExpbmsucHJvdG90eXBlLnNldFJhZGl1cyA9IGZ1bmN0aW9uIChyYWRpdXMpIHtcclxuICAgIGlmICgkLmlzTnVtZXJpYyhyYWRpdXMpKSB7XHJcbiAgICAgICAgcmFkaXVzID0gcGFyc2VJbnQocmFkaXVzKTtcclxuICAgICAgICBpZiAocmFkaXVzID4gMjApIHtcclxuICAgICAgICAgICAgcmFkaXVzID0gMjA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyYWRpdXMgPCAwKSB7XHJcbiAgICAgICAgICAgIHJhZGl1cyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXR0ci5yYWRpdXMgPSByYWRpdXM7XHJcbiAgICB9XHJcbn07XHJcbi8vLVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbGluay9Gb2xkLmpzXG4vLyBtb2R1bGUgaWQgPSAzNFxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwic291cmNlUm9vdCI6IiJ9')},35:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 图形节点\r\n * @class  ImageNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Node=__webpack_require__(3);\r\nmodule.exports = {\r\n    constructor:ImageNode,\r\n    setDefault:setDefault,\r\n    getDefault:getDefault\r\n};\r\n//-\r\nvar DEFAULT= {\r\n    image: "",\r\n    size: [60, 60],\r\n    name: "node",\r\n    alpha: 1,\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    jsonId:"",\r\n    border:{\r\n        width:0,\r\n        radius:0,//最大160 最小0\r\n        color:"255,0,0"\r\n    },\r\n    zIndex: 200,//层级(10-999)\r\n    color: JTopo.util.randomColor(),\r\n    namePosition: \'bottom\',\r\n    useType: QTopo.constant.node.IMAGE,\r\n    alarm: {\r\n        show: false,\r\n        text: "",\r\n        color: "255,255,255",\r\n        font: {\r\n            size: 16,\r\n            type: "微软雅黑"\r\n        }\r\n    }\r\n};\r\nfunction setDefault(config){\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault(){\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//------\r\n    var jtopoReset={\r\n        //重写绘制函数，优化告警效果\r\n        paint:function (cx) {\r\n            alarmFlash.call(this,cx);\r\n            if (this.image) {\r\n                var b = cx.globalAlpha;\r\n                cx.globalAlpha = this.alpha;\r\n                if(null != this.alarmImage&& null != this.alarm ){\r\n                    cx.drawImage(this.alarmImage, -this.width / 2, -this.height / 2, this.width, this.height)\r\n                }else{\r\n                    cx.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height)\r\n                }\r\n                cx.globalAlpha = b;\r\n            } else{\r\n                cx.beginPath();\r\n                cx.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";\r\n                if(null == this.borderRadius || 0 == this.borderRadius){\r\n                    cx.rect(-this.width / 2, -this.height / 2, this.width, this.height);\r\n                }else{\r\n                    cx.JTopoRoundRect(-this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius);\r\n                }\r\n                cx.fill();\r\n                cx.closePath();\r\n            }\r\n            this.paintText(cx);\r\n            this.paintBorder(cx);\r\n            this.paintCtrl(cx);\r\n            this.paintAlarmText(cx);\r\n        }\r\n    };\r\n//------\r\nfunction ImageNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this,new JTopo.Node());\r\n    //函数\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(ImageNode,Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        this._setAttr(config);\r\n        //处理特殊属性的设置\r\n    }\r\n}\r\nfunction reset(node){\r\n    node.jtopo.paint=jtopoReset.paint;\r\n}\r\n\r\n//-\r\n/**\r\n *  设置节点图片,与setColor冲突，设了图片则颜色无效\r\n *\r\n *  未设置图片则显示方形节点，内部填充颜色\r\n *  @method setImage\r\n *  @param image {string} 图片相对路径\r\n */\r\nImageNode.prototype.setImage=function(image) {\r\n    if(image){\r\n        this.jtopo.setImage(image);\r\n        this.attr.image=image;\r\n    }\r\n};\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT= {\r\n                        image: "",\r\n                        size: [60, 60],\r\n                        name: "node",\r\n                        alpha: 1,\r\n                        position: [0, 0],\r\n                        font: {\r\n                            size: 16,\r\n                            type: \'微软雅黑\',\r\n                            color: "255,255,255"\r\n                        },\r\n                        jsonId:"",\r\n                        border:{\r\n                            width:0,\r\n                            radius:0,//最大160 最小0\r\n                            color:"255,0,0"\r\n                        },\r\n                        zIndex: 200,//层级(10-999)\r\n                        color: JTopo.util.randomColor(),\r\n                        namePosition: \'bottom\',\r\n                        useType: QTopo.constant.node.IMAGE,\r\n                        alarm: {\r\n                            show: false,\r\n                            text: "",\r\n                            color: "255,255,255",\r\n                            font: {\r\n                                size: 16,\r\n                                type: "微软雅黑"\r\n                            }\r\n                        }\r\n                    };\r\n */\r\nImageNode.prototype.getDefault=getDefault;\r\n//--\r\n/**\r\n *  设置告警\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *  @method setAlarm\r\n *  @param config {object}\r\n *  @example\r\n *          config={\r\n *              show: 是否显示告警{boolean},\r\n                text: 节点右上角告警板中内容,可为空{string},\r\n                color: 告警颜色{string} "255,255,255"/"#ffffff",\r\n                font: {\r\n                    size: 告警字体大小{number},\r\n                    type: 告警字体类型{string} 如"微软雅黑"\r\n                }\r\n *          }\r\n */\r\nImageNode.prototype.setAlarm=function(config) {\r\n    alarmAttr(this,this.attr.alarm,config);\r\n};\r\nfunction alarmAttr(qtopo,alarm,config){\r\n    var jtopo=qtopo.jtopo;\r\n    if(typeof config.show=="undefined"){\r\n        config.show=alarm.show;\r\n    }\r\n    if ((typeof config.show=="boolean"&&config.show)||(config.show=="true")) {\r\n        qtopo.setAlpha(1);\r\n        jtopo.shadow = true;\r\n        jtopo.alarm = config.text || "";\r\n        alarm.text=jtopo.alarm;\r\n        if(config.color){\r\n            jtopo.alarmColor = QTopo.util.transHex(config.color.toLowerCase());\r\n            alarm.color=jtopo.alarmColor;\r\n        }\r\n        var size=alarm.font.size;\r\n        var font=alarm.font.type;\r\n        if(config.font&&$.isNumeric(config.font.size)){\r\n            size=config.font.size;\r\n        }\r\n        if(config.font&&config.font.type){\r\n            font=config.font.type;\r\n        }\r\n        jtopo.alarmFont =  size+ \'px \' + font;\r\n        alarm.font.size=size;\r\n        alarm.font.type=font;\r\n        toggleAlarmFlash(jtopo,true);\r\n    } else {\r\n        jtopo.alarm = null;\r\n        toggleAlarmFlash(jtopo,false);\r\n    }\r\n    alarm.show=config.show;\r\n}\r\nfunction toggleAlarmFlash(node,show){\r\n    //切换闪烁\r\n    if(show){\r\n        node.shadowOffsetX = 0;\r\n        node.shadowOffsetY = 0;\r\n        node.shadowColor = "rgba(" + node.alarmColor + ",1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=true;\r\n    }else{\r\n        node.shadowOffsetX = 3;\r\n        node.shadowOffsetY = 6;\r\n        node.shadowColor="rgba(0,0,0,0.1)";\r\n        node.shadowBlur = 10;\r\n        node.allowAlarmFlash=false;\r\n    }\r\n}\r\n//插入源码部分,启用告警后每次绘画执行修改阴影\r\nfunction alarmFlash(cx) {\r\n    if(this.shadow&&this.allowAlarmFlash){\r\n        if(typeof this.shadowDirection=="undefined"){\r\n            this.shadowDirection=true;\r\n        }\r\n        move(this);\r\n        cx.shadowBlur = this.shadowBlur;\r\n        function move(node){\r\n            if (node.shadowDirection) {\r\n                node.shadowBlur += 5;\r\n                if(node.shadowBlur>100){\r\n                    node.shadowDirection=false;\r\n                }\r\n            }\r\n            else {\r\n                node.shadowBlur -= 5;\r\n                if(node.shadowBlur<=10){\r\n                    node.shadowDirection=true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n//--\r\n//-//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL0ltYWdlLmpzPzczNWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLE9BQU87QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0EsNkJBQTZCLFFBQVE7QUFDckMsc0NBQXNDLE9BQU87QUFDN0MsNEJBQTRCLE9BQU87QUFDbkM7QUFDQSxpQ0FBaUMsT0FBTztBQUN4QyxpQ0FBaUMsT0FBTztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIzNS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8qKlxyXG4gKiDlm77lvaLoioLngrlcclxuICogQGNsYXNzICBJbWFnZU5vZGVcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIFtOXSBOb2RlXHJcbiAqIEBwYXJhbSBbY29uZmlnXSDphY3nva7lj4LmlbDvvIzml6Dlj4LliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICovXHJcbnZhciBOb2RlPXJlcXVpcmUoXCIuL05vZGUuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6SW1hZ2VOb2RlLFxyXG4gICAgc2V0RGVmYXVsdDpzZXREZWZhdWx0LFxyXG4gICAgZ2V0RGVmYXVsdDpnZXREZWZhdWx0XHJcbn07XHJcbi8vLVxyXG52YXIgREVGQVVMVD0ge1xyXG4gICAgaW1hZ2U6IFwiXCIsXHJcbiAgICBzaXplOiBbNjAsIDYwXSxcclxuICAgIG5hbWU6IFwibm9kZVwiLFxyXG4gICAgYWxwaGE6IDEsXHJcbiAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgZm9udDoge1xyXG4gICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgIGNvbG9yOiBcIjI1NSwyNTUsMjU1XCJcclxuICAgIH0sXHJcbiAgICBqc29uSWQ6XCJcIixcclxuICAgIGJvcmRlcjp7XHJcbiAgICAgICAgd2lkdGg6MCxcclxuICAgICAgICByYWRpdXM6MCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgY29sb3I6XCIyNTUsMCwwXCJcclxuICAgIH0sXHJcbiAgICB6SW5kZXg6IDIwMCwvL+Wxgue6pygxMC05OTkpXHJcbiAgICBjb2xvcjogSlRvcG8udXRpbC5yYW5kb21Db2xvcigpLFxyXG4gICAgbmFtZVBvc2l0aW9uOiAnYm90dG9tJyxcclxuICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0UsXHJcbiAgICBhbGFybToge1xyXG4gICAgICAgIHNob3c6IGZhbHNlLFxyXG4gICAgICAgIHRleHQ6IFwiXCIsXHJcbiAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIixcclxuICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICB0eXBlOiBcIuW+rui9r+mbhem7kVwiXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBzZXREZWZhdWx0KGNvbmZpZyl7XHJcbiAgICBRVG9wby51dGlsLmV4dGVuZChERUZBVUxULCBjb25maWcgfHwge30pO1xyXG59XHJcbmZ1bmN0aW9uIGdldERlZmF1bHQoKXtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuLy8tLS0tLS1cclxuICAgIHZhciBqdG9wb1Jlc2V0PXtcclxuICAgICAgICAvL+mHjeWGmee7mOWItuWHveaVsO+8jOS8mOWMluWRiuitpuaViOaenFxyXG4gICAgICAgIHBhaW50OmZ1bmN0aW9uIChjeCkge1xyXG4gICAgICAgICAgICBhbGFybUZsYXNoLmNhbGwodGhpcyxjeCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGN4Lmdsb2JhbEFscGhhO1xyXG4gICAgICAgICAgICAgICAgY3guZ2xvYmFsQWxwaGEgPSB0aGlzLmFscGhhO1xyXG4gICAgICAgICAgICAgICAgaWYobnVsbCAhPSB0aGlzLmFsYXJtSW1hZ2UmJiBudWxsICE9IHRoaXMuYWxhcm0gKXtcclxuICAgICAgICAgICAgICAgICAgICBjeC5kcmF3SW1hZ2UodGhpcy5hbGFybUltYWdlLCAtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgY3guZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjeC5nbG9iYWxBbHBoYSA9IGI7XHJcbiAgICAgICAgICAgIH0gZWxzZXtcclxuICAgICAgICAgICAgICAgIGN4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY3guZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgdGhpcy5maWxsQ29sb3IgKyBcIixcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgIGlmKG51bGwgPT0gdGhpcy5ib3JkZXJSYWRpdXMgfHwgMCA9PSB0aGlzLmJvcmRlclJhZGl1cyl7XHJcbiAgICAgICAgICAgICAgICAgICAgY3gucmVjdCgtdGhpcy53aWR0aCAvIDIsIC10aGlzLmhlaWdodCAvIDIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGN4LkpUb3BvUm91bmRSZWN0KC10aGlzLndpZHRoIC8gMiwgLXRoaXMuaGVpZ2h0IC8gMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuYm9yZGVyUmFkaXVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGN4LmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIGN4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRUZXh0KGN4KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEJvcmRlcihjeCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRDdHJsKGN4KTtcclxuICAgICAgICAgICAgdGhpcy5wYWludEFsYXJtVGV4dChjeCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuLy8tLS0tLS1cclxuZnVuY3Rpb24gSW1hZ2VOb2RlKGNvbmZpZykge1xyXG4gICAgdGhpcy5hdHRyID0gUVRvcG8udXRpbC5leHRlbmQoZ2V0RGVmYXVsdCgpLCBjb25maWcgfHwge30pO1xyXG4gICAgTm9kZS5jYWxsKHRoaXMsbmV3IEpUb3BvLk5vZGUoKSk7XHJcbiAgICAvL+WHveaVsFxyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG4gICAgcmVzZXQodGhpcyk7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhJbWFnZU5vZGUsTm9kZSk7XHJcbi8vLVxyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIC8v5aSE55CG5LiA6Iis5bGe5oCn55qE6K6+572uXHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgICAgIC8v5aSE55CG54m55q6K5bGe5oCn55qE6K6+572uXHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVzZXQobm9kZSl7XHJcbiAgICBub2RlLmp0b3BvLnBhaW50PWp0b3BvUmVzZXQucGFpbnQ7XHJcbn1cclxuXHJcbi8vLVxyXG4vKipcclxuICogIOiuvue9ruiKgueCueWbvueJhyzkuI5zZXRDb2xvcuWGsueqge+8jOiuvuS6huWbvueJh+WImeminOiJsuaXoOaViFxyXG4gKlxyXG4gKiAg5pyq6K6+572u5Zu+54mH5YiZ5pi+56S65pa55b2i6IqC54K577yM5YaF6YOo5aGr5YWF6aKc6ImyXHJcbiAqICBAbWV0aG9kIHNldEltYWdlXHJcbiAqICBAcGFyYW0gaW1hZ2Uge3N0cmluZ30g5Zu+54mH55u45a+56Lev5b6EXHJcbiAqL1xyXG5JbWFnZU5vZGUucHJvdG90eXBlLnNldEltYWdlPWZ1bmN0aW9uKGltYWdlKSB7XHJcbiAgICBpZihpbWFnZSl7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zZXRJbWFnZShpbWFnZSk7XHJcbiAgICAgICAgdGhpcy5hdHRyLmltYWdlPWltYWdlO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOiOt+WPluWFqOWxgOiuvue9rlxyXG4gKiAgQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqICBAcmV0dXJuIGNvbmZpZyB7b2JqZWN0fSDlhajlsYDphY3nva7nmoTlhYvpmoblr7nosaFb5Y+q6K+7Xe+8jOS/ruaUueivpeWvueixoeS4jeS8muebtOaOpeS/ruaUueWFqOWxgOmFjee9ru+8jOiLpeimgeS/ruaUueWFqOWxgOmFjee9ruivt+S9v+eUqHNjZW5lLnNldERlZmF1bHRcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOm7mOiupOWFqOWxgOWPguaVsDpcclxuICogICAgICAgICAgICAgIHZhciBERUZBVUxUPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbNjAsIDYwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJub2RlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICflvq7ova/pm4Xpu5EnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiMjU1LDI1NSwyNTVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uSWQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MCwvL+acgOWkpzE2MCDmnIDlsI8wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjpcIjI1NSwwLDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDIwMCwvL+Wxgue6pygxMC05OTkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBKVG9wby51dGlsLnJhbmRvbUNvbG9yKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQb3NpdGlvbjogJ2JvdHRvbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZVR5cGU6IFFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwi5b6u6L2v6ZuF6buRXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAqL1xyXG5JbWFnZU5vZGUucHJvdG90eXBlLmdldERlZmF1bHQ9Z2V0RGVmYXVsdDtcclxuLy8tLVxyXG4vKipcclxuICogIOiuvue9ruWRiuitplxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKiAgQG1ldGhvZCBzZXRBbGFybVxyXG4gKiAgQHBhcmFtIGNvbmZpZyB7b2JqZWN0fVxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAgY29uZmlnPXtcclxuICogICAgICAgICAgICAgIHNob3c6IOaYr+WQpuaYvuekuuWRiuitpntib29sZWFufSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IOiKgueCueWPs+S4iuinkuWRiuitpuadv+S4reWGheWuuSzlj6/kuLrnqbp7c3RyaW5nfSxcclxuICAgICAgICAgICAgICAgIGNvbG9yOiDlkYrorabpopzoibJ7c3RyaW5nfSBcIjI1NSwyNTUsMjU1XCIvXCIjZmZmZmZmXCIsXHJcbiAgICAgICAgICAgICAgICBmb250OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTog5ZGK6K2m5a2X5L2T5aSn5bCPe251bWJlcn0sXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTog5ZGK6K2m5a2X5L2T57G75Z6Le3N0cmluZ30g5aaCXCLlvq7ova/pm4Xpu5FcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gKiAgICAgICAgICB9XHJcbiAqL1xyXG5JbWFnZU5vZGUucHJvdG90eXBlLnNldEFsYXJtPWZ1bmN0aW9uKGNvbmZpZykge1xyXG4gICAgYWxhcm1BdHRyKHRoaXMsdGhpcy5hdHRyLmFsYXJtLGNvbmZpZyk7XHJcbn07XHJcbmZ1bmN0aW9uIGFsYXJtQXR0cihxdG9wbyxhbGFybSxjb25maWcpe1xyXG4gICAgdmFyIGp0b3BvPXF0b3BvLmp0b3BvO1xyXG4gICAgaWYodHlwZW9mIGNvbmZpZy5zaG93PT1cInVuZGVmaW5lZFwiKXtcclxuICAgICAgICBjb25maWcuc2hvdz1hbGFybS5zaG93O1xyXG4gICAgfVxyXG4gICAgaWYgKCh0eXBlb2YgY29uZmlnLnNob3c9PVwiYm9vbGVhblwiJiZjb25maWcuc2hvdyl8fChjb25maWcuc2hvdz09XCJ0cnVlXCIpKSB7XHJcbiAgICAgICAgcXRvcG8uc2V0QWxwaGEoMSk7XHJcbiAgICAgICAganRvcG8uc2hhZG93ID0gdHJ1ZTtcclxuICAgICAgICBqdG9wby5hbGFybSA9IGNvbmZpZy50ZXh0IHx8IFwiXCI7XHJcbiAgICAgICAgYWxhcm0udGV4dD1qdG9wby5hbGFybTtcclxuICAgICAgICBpZihjb25maWcuY29sb3Ipe1xyXG4gICAgICAgICAgICBqdG9wby5hbGFybUNvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb25maWcuY29sb3IudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIGFsYXJtLmNvbG9yPWp0b3BvLmFsYXJtQ29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzaXplPWFsYXJtLmZvbnQuc2l6ZTtcclxuICAgICAgICB2YXIgZm9udD1hbGFybS5mb250LnR5cGU7XHJcbiAgICAgICAgaWYoY29uZmlnLmZvbnQmJiQuaXNOdW1lcmljKGNvbmZpZy5mb250LnNpemUpKXtcclxuICAgICAgICAgICAgc2l6ZT1jb25maWcuZm9udC5zaXplO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihjb25maWcuZm9udCYmY29uZmlnLmZvbnQudHlwZSl7XHJcbiAgICAgICAgICAgIGZvbnQ9Y29uZmlnLmZvbnQudHlwZTtcclxuICAgICAgICB9XHJcbiAgICAgICAganRvcG8uYWxhcm1Gb250ID0gIHNpemUrICdweCAnICsgZm9udDtcclxuICAgICAgICBhbGFybS5mb250LnNpemU9c2l6ZTtcclxuICAgICAgICBhbGFybS5mb250LnR5cGU9Zm9udDtcclxuICAgICAgICB0b2dnbGVBbGFybUZsYXNoKGp0b3BvLHRydWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBqdG9wby5hbGFybSA9IG51bGw7XHJcbiAgICAgICAgdG9nZ2xlQWxhcm1GbGFzaChqdG9wbyxmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBhbGFybS5zaG93PWNvbmZpZy5zaG93O1xyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUFsYXJtRmxhc2gobm9kZSxzaG93KXtcclxuICAgIC8v5YiH5o2i6Zeq54OBXHJcbiAgICBpZihzaG93KXtcclxuICAgICAgICBub2RlLnNoYWRvd09mZnNldFggPSAwO1xyXG4gICAgICAgIG5vZGUuc2hhZG93T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dDb2xvciA9IFwicmdiYShcIiArIG5vZGUuYWxhcm1Db2xvciArIFwiLDEpXCI7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dCbHVyID0gMTA7XHJcbiAgICAgICAgbm9kZS5hbGxvd0FsYXJtRmxhc2g9dHJ1ZTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIG5vZGUuc2hhZG93T2Zmc2V0WCA9IDM7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dPZmZzZXRZID0gNjtcclxuICAgICAgICBub2RlLnNoYWRvd0NvbG9yPVwicmdiYSgwLDAsMCwwLjEpXCI7XHJcbiAgICAgICAgbm9kZS5zaGFkb3dCbHVyID0gMTA7XHJcbiAgICAgICAgbm9kZS5hbGxvd0FsYXJtRmxhc2g9ZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuLy/mj5LlhaXmupDnoIHpg6jliIYs5ZCv55So5ZGK6K2m5ZCO5q+P5qyh57uY55S75omn6KGM5L+u5pS56Zi05b2xXHJcbmZ1bmN0aW9uIGFsYXJtRmxhc2goY3gpIHtcclxuICAgIGlmKHRoaXMuc2hhZG93JiZ0aGlzLmFsbG93QWxhcm1GbGFzaCl7XHJcbiAgICAgICAgaWYodHlwZW9mIHRoaXMuc2hhZG93RGlyZWN0aW9uPT1cInVuZGVmaW5lZFwiKXtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dEaXJlY3Rpb249dHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbW92ZSh0aGlzKTtcclxuICAgICAgICBjeC5zaGFkb3dCbHVyID0gdGhpcy5zaGFkb3dCbHVyO1xyXG4gICAgICAgIGZ1bmN0aW9uIG1vdmUobm9kZSl7XHJcbiAgICAgICAgICAgIGlmIChub2RlLnNoYWRvd0RpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5zaGFkb3dCbHVyICs9IDU7XHJcbiAgICAgICAgICAgICAgICBpZihub2RlLnNoYWRvd0JsdXI+MTAwKXtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnNoYWRvd0RpcmVjdGlvbj1mYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuc2hhZG93Qmx1ciAtPSA1O1xyXG4gICAgICAgICAgICAgICAgaWYobm9kZS5zaGFkb3dCbHVyPD0xMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5zaGFkb3dEaXJlY3Rpb249dHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vLy0tXHJcbi8vLVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2VsZW1lbnQvbm9kZS9JbWFnZS5qc1xuLy8gbW9kdWxlIGlkID0gMzVcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==');
},36:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * 文本节点\r\n * @class  TextNode\r\n * @constructor\r\n * @extends [N] Node\r\n * @param [config] 配置参数，无参则按全局配置创建\r\n */\r\nvar Node = __webpack_require__(3);\r\nmodule.exports = {\r\n    constructor: TextNode,\r\n    setDefault: setDefault,\r\n    getDefault: getDefault\r\n};\r\n//-\r\nvar DEFAULT = {\r\n    position: [0, 0],\r\n    font: {\r\n        size: 16,\r\n        type: \'微软雅黑\',\r\n        color: "255,255,255"\r\n    },\r\n    jsonId:"",\r\n    border: {\r\n        width: 0,\r\n        radius: 0,//最大160 最小0\r\n        color: "255,0,0"\r\n    },\r\n    zIndex: 200,//层级(10-999)\r\n    alpha: 1,\r\n    text: \'no text here\',\r\n    useType: QTopo.constant.node.TEXT\r\n};\r\nfunction setDefault(config) {\r\n    QTopo.util.extend(DEFAULT, config || {});\r\n}\r\nfunction getDefault() {\r\n    return QTopo.util.deepClone(DEFAULT);\r\n}\r\n//-\r\n//----\r\n//支持自动换行\r\nvar jtopoReset = {\r\n    paint: function (a) {\r\n        //自动换行\r\n        var texts = this.text.split("\\n");\r\n        a.beginPath();\r\n        a.font = this.font;\r\n        var fontWidth = a.measureText("田").width;\r\n        this.width = 0;\r\n        for (var j = 0; j < texts.length; j++) {\r\n            var width = a.measureText(texts[j]).width;\r\n            if (width > this.width) {\r\n                this.width = width;\r\n            }\r\n        }\r\n        this.height = texts.length * fontWidth;\r\n        a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n        a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";\r\n        if (texts.length > 1) {\r\n            for (var i = 0; i < texts.length; i++) {\r\n                a.fillText(texts[i], -this.width / 2 + 0.15 * fontWidth, this.height / 2 + (i - texts.length + 0.85) * fontWidth);\r\n            }\r\n        } else {\r\n            a.fillText(texts, -this.width / 2 + 0.03 * fontWidth, this.height / 2 - 0.15 * fontWidth);\r\n        }\r\n        a.closePath();\r\n        this.paintBorder(a);\r\n        this.paintCtrl(a);\r\n        this.paintAlarmText(a);\r\n    }\r\n};\r\n//----\r\nfunction TextNode(config) {\r\n    this.attr = QTopo.util.extend(getDefault(), config || {});\r\n    Node.call(this, new JTopo.TextNode());\r\n    this.set = setJTopo;\r\n    //初始化\r\n    this.set(this.attr);\r\n    reset(this);\r\n}\r\nQTopo.util.inherits(TextNode, Node);\r\n//-\r\n/**\r\n *  元素对属性的统一设置函数，推荐使用\r\n *\r\n *  参数可设置一项或多项,未设置部分参考全局配置\r\n *\r\n *  若传入参数的text未配置，则显示为  "not set text"\r\n *  @method set\r\n *  @param config\r\n *  @example\r\n *          实际参数参考attr内属性,只会修改有对应set函数的属性,若新增属性且添加了setXXX函数，也可用此函数配置\r\n *          如:name 对应 setName("..")\r\n *          参数格式如下\r\n *          config={\r\n *              xx:...,\r\n *              xx:...\r\n *          }\r\n */\r\nfunction setJTopo(config) {\r\n    if (config) {\r\n        //处理一般属性的设置\r\n        if (!this.attr.text&&!config.text) {\r\n            config.text = "not set text";\r\n        }\r\n        this._setAttr(config);\r\n    }\r\n}\r\n//重写源码\r\nfunction reset(node) {\r\n    node.jtopo.paint = jtopoReset.paint;\r\n}\r\n//-\r\n/**\r\n *  获取全局设置\r\n *  @method getDefault\r\n *  @return config {object} 全局配置的克隆对象[只读]，修改该对象不会直接修改全局配置，若要修改全局配置请使用scene.setDefault\r\n *  @example\r\n *          默认全局参数:\r\n *              var DEFAULT = {\r\n                    position: [0, 0],\r\n                    font: {\r\n                        size: 16,\r\n                        type: \'微软雅黑\',\r\n                        color: "255,255,255"\r\n                    },\r\n                    jsonId:"",\r\n                    border: {\r\n                        width: 0,\r\n                        radius: 0,//最大160 最小0\r\n                        color: "255,0,0"\r\n                    },\r\n                    zIndex: 200,//层级(10-999)\r\n                    alpha: 1,\r\n                    text: \'no text here\',\r\n                    useType: QTopo.constant.node.TEXT\r\n                };\r\n */\r\nTextNode.prototype.getDefault = getDefault;\r\n//-\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1RleHQuanM/MzM5ZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrQkFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGtCQUFrQjtBQUM3QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTREO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjM2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIOaWh+acrOiKgueCuVxyXG4gKiBAY2xhc3MgIFRleHROb2RlXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyBbTl0gTm9kZVxyXG4gKiBAcGFyYW0gW2NvbmZpZ10g6YWN572u5Y+C5pWw77yM5peg5Y+C5YiZ5oyJ5YWo5bGA6YWN572u5Yib5bu6XHJcbiAqL1xyXG52YXIgTm9kZSA9IHJlcXVpcmUoXCIuL05vZGUuanNcIik7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29uc3RydWN0b3I6IFRleHROb2RlLFxyXG4gICAgc2V0RGVmYXVsdDogc2V0RGVmYXVsdCxcclxuICAgIGdldERlZmF1bHQ6IGdldERlZmF1bHRcclxufTtcclxuLy8tXHJcbnZhciBERUZBVUxUID0ge1xyXG4gICAgcG9zaXRpb246IFswLCAwXSxcclxuICAgIGZvbnQ6IHtcclxuICAgICAgICBzaXplOiAxNixcclxuICAgICAgICB0eXBlOiAn5b6u6L2v6ZuF6buRJyxcclxuICAgICAgICBjb2xvcjogXCIyNTUsMjU1LDI1NVwiXHJcbiAgICB9LFxyXG4gICAganNvbklkOlwiXCIsXHJcbiAgICBib3JkZXI6IHtcclxuICAgICAgICB3aWR0aDogMCxcclxuICAgICAgICByYWRpdXM6IDAsLy/mnIDlpKcxNjAg5pyA5bCPMFxyXG4gICAgICAgIGNvbG9yOiBcIjI1NSwwLDBcIlxyXG4gICAgfSxcclxuICAgIHpJbmRleDogMjAwLC8v5bGC57qnKDEwLTk5OSlcclxuICAgIGFscGhhOiAxLFxyXG4gICAgdGV4dDogJ25vIHRleHQgaGVyZScsXHJcbiAgICB1c2VUeXBlOiBRVG9wby5jb25zdGFudC5ub2RlLlRFWFRcclxufTtcclxuZnVuY3Rpb24gc2V0RGVmYXVsdChjb25maWcpIHtcclxuICAgIFFUb3BvLnV0aWwuZXh0ZW5kKERFRkFVTFQsIGNvbmZpZyB8fCB7fSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHtcclxuICAgIHJldHVybiBRVG9wby51dGlsLmRlZXBDbG9uZShERUZBVUxUKTtcclxufVxyXG4vLy1cclxuLy8tLS0tXHJcbi8v5pSv5oyB6Ieq5Yqo5o2i6KGMXHJcbnZhciBqdG9wb1Jlc2V0ID0ge1xyXG4gICAgcGFpbnQ6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgLy/oh6rliqjmjaLooYxcclxuICAgICAgICB2YXIgdGV4dHMgPSB0aGlzLnRleHQuc3BsaXQoXCJcXG5cIik7XHJcbiAgICAgICAgYS5iZWdpblBhdGgoKTtcclxuICAgICAgICBhLmZvbnQgPSB0aGlzLmZvbnQ7XHJcbiAgICAgICAgdmFyIGZvbnRXaWR0aCA9IGEubWVhc3VyZVRleHQoXCLnlLBcIikud2lkdGg7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0ZXh0cy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICB2YXIgd2lkdGggPSBhLm1lYXN1cmVUZXh0KHRleHRzW2pdKS53aWR0aDtcclxuICAgICAgICAgICAgaWYgKHdpZHRoID4gdGhpcy53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGV4dHMubGVuZ3RoICogZm9udFdpZHRoO1xyXG4gICAgICAgIGEuc3Ryb2tlU3R5bGUgPSBcInJnYmEoXCIgKyB0aGlzLmZvbnRDb2xvciArIFwiLCBcIiArIHRoaXMuYWxwaGEgKyBcIilcIjtcclxuICAgICAgICBhLmZpbGxTdHlsZSA9IFwicmdiYShcIiArIHRoaXMuZm9udENvbG9yICsgXCIsIFwiICsgdGhpcy5hbHBoYSArIFwiKVwiO1xyXG4gICAgICAgIGlmICh0ZXh0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGEuZmlsbFRleHQodGV4dHNbaV0sIC10aGlzLndpZHRoIC8gMiArIDAuMTUgKiBmb250V2lkdGgsIHRoaXMuaGVpZ2h0IC8gMiArIChpIC0gdGV4dHMubGVuZ3RoICsgMC44NSkgKiBmb250V2lkdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYS5maWxsVGV4dCh0ZXh0cywgLXRoaXMud2lkdGggLyAyICsgMC4wMyAqIGZvbnRXaWR0aCwgdGhpcy5oZWlnaHQgLyAyIC0gMC4xNSAqIGZvbnRXaWR0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGEuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgdGhpcy5wYWludEJvcmRlcihhKTtcclxuICAgICAgICB0aGlzLnBhaW50Q3RybChhKTtcclxuICAgICAgICB0aGlzLnBhaW50QWxhcm1UZXh0KGEpO1xyXG4gICAgfVxyXG59O1xyXG4vLy0tLS1cclxuZnVuY3Rpb24gVGV4dE5vZGUoY29uZmlnKSB7XHJcbiAgICB0aGlzLmF0dHIgPSBRVG9wby51dGlsLmV4dGVuZChnZXREZWZhdWx0KCksIGNvbmZpZyB8fCB7fSk7XHJcbiAgICBOb2RlLmNhbGwodGhpcywgbmV3IEpUb3BvLlRleHROb2RlKCkpO1xyXG4gICAgdGhpcy5zZXQgPSBzZXRKVG9wbztcclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICB0aGlzLnNldCh0aGlzLmF0dHIpO1xyXG4gICAgcmVzZXQodGhpcyk7XHJcbn1cclxuUVRvcG8udXRpbC5pbmhlcml0cyhUZXh0Tm9kZSwgTm9kZSk7XHJcbi8vLVxyXG4vKipcclxuICogIOWFg+e0oOWvueWxnuaAp+eahOe7n+S4gOiuvue9ruWHveaVsO+8jOaOqOiNkOS9v+eUqFxyXG4gKlxyXG4gKiAg5Y+C5pWw5Y+v6K6+572u5LiA6aG55oiW5aSa6aG5LOacquiuvue9rumDqOWIhuWPguiAg+WFqOWxgOmFjee9rlxyXG4gKlxyXG4gKiAg6Iul5Lyg5YWl5Y+C5pWw55qEdGV4dOacqumFjee9ru+8jOWImeaYvuekuuS4uiAgXCJub3Qgc2V0IHRleHRcIlxyXG4gKiAgQG1ldGhvZCBzZXRcclxuICogIEBwYXJhbSBjb25maWdcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOWunumZheWPguaVsOWPguiAg2F0dHLlhoXlsZ7mgKcs5Y+q5Lya5L+u5pS55pyJ5a+55bqUc2V05Ye95pWw55qE5bGe5oCnLOiLpeaWsOWinuWxnuaAp+S4lOa3u+WKoOS6hnNldFhYWOWHveaVsO+8jOS5n+WPr+eUqOatpOWHveaVsOmFjee9rlxyXG4gKiAgICAgICAgICDlpoI6bmFtZSDlr7nlupQgc2V0TmFtZShcIi4uXCIpXHJcbiAqICAgICAgICAgIOWPguaVsOagvOW8j+WmguS4i1xyXG4gKiAgICAgICAgICBjb25maWc9e1xyXG4gKiAgICAgICAgICAgICAgeHg6Li4uLFxyXG4gKiAgICAgICAgICAgICAgeHg6Li4uXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcbmZ1bmN0aW9uIHNldEpUb3BvKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIC8v5aSE55CG5LiA6Iis5bGe5oCn55qE6K6+572uXHJcbiAgICAgICAgaWYgKCF0aGlzLmF0dHIudGV4dCYmIWNvbmZpZy50ZXh0KSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy50ZXh0ID0gXCJub3Qgc2V0IHRleHRcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc2V0QXR0cihjb25maWcpO1xyXG4gICAgfVxyXG59XHJcbi8v6YeN5YaZ5rqQ56CBXHJcbmZ1bmN0aW9uIHJlc2V0KG5vZGUpIHtcclxuICAgIG5vZGUuanRvcG8ucGFpbnQgPSBqdG9wb1Jlc2V0LnBhaW50O1xyXG59XHJcbi8vLVxyXG4vKipcclxuICogIOiOt+WPluWFqOWxgOiuvue9rlxyXG4gKiAgQG1ldGhvZCBnZXREZWZhdWx0XHJcbiAqICBAcmV0dXJuIGNvbmZpZyB7b2JqZWN0fSDlhajlsYDphY3nva7nmoTlhYvpmoblr7nosaFb5Y+q6K+7Xe+8jOS/ruaUueivpeWvueixoeS4jeS8muebtOaOpeS/ruaUueWFqOWxgOmFjee9ru+8jOiLpeimgeS/ruaUueWFqOWxgOmFjee9ruivt+S9v+eUqHNjZW5lLnNldERlZmF1bHRcclxuICogIEBleGFtcGxlXHJcbiAqICAgICAgICAgIOm7mOiupOWFqOWxgOWPguaVsDpcclxuICogICAgICAgICAgICAgIHZhciBERUZBVUxUID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgZm9udDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ+W+rui9r+mbhem7kScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcIjI1NSwyNTUsMjU1XCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGpzb25JZDpcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzOiAwLC8v5pyA5aSnMTYwIOacgOWwjzBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiMjU1LDAsMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDIwMCwvL+Wxgue6pygxMC05OTkpXHJcbiAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ25vIHRleHQgaGVyZScsXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlVHlwZTogUVRvcG8uY29uc3RhbnQubm9kZS5URVhUXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gKi9cclxuVGV4dE5vZGUucHJvdG90eXBlLmdldERlZmF1bHQgPSBnZXREZWZhdWx0O1xyXG4vLy1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL2NvcmUvZWxlbWVudC9ub2RlL1RleHQuanNcbi8vIG1vZHVsZSBpZCA9IDM2XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=')},37:function(module,exports){eval('/**\r\n * @module core\r\n */\r\n/**\r\n * @class Scene\r\n */\r\nvar events = {\r\n    init: function (scene) {\r\n        /**\r\n         * 在图层上双击时\r\n         *\r\n         * 目标是分组,则分组可进行缩放和还原\r\n         *\r\n         * 目标为链路,QTopo.constant.link.DIRECT类型的链路计数大于1时可展开和合并\r\n         * @event dbclick\r\n         */\r\n        scene.on("dbclick", dbClick(scene));\r\n    }\r\n};\r\nfunction dbClick(scene) {\r\n    return function (e, qtopo) {\r\n        toggleGroup(e, qtopo, scene);\r\n        toggleLink(e, qtopo, scene);\r\n    }\r\n}\r\nfunction toggleGroup(e, qtopo, scene) {\r\n    //分组隐藏，显示缩放节点，节点位置根据分组长宽计算\r\n    if (qtopo) {\r\n        if (qtopo.getType() == QTopo.constant.CONTAINER) {\r\n            qtopo.toggle();\r\n        } else if (qtopo.getType() == QTopo.constant.NODE && qtopo.getUseType() == QTopo.constant.CASUAL) {\r\n            //分组显示，隐藏缩放节点，分组新位置根据节点位置和分组长宽计算\r\n            if (qtopo.toggleTo) {\r\n                qtopo.toggleTo.toggle();\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction toggleLink(e, qtopo, scene) {\r\n    if (qtopo && qtopo.getType() == QTopo.constant.LINK && qtopo.attr.expendAble) {\r\n        if (!$.isFunction(qtopo.toggle)) {\r\n            qtopo.openToggle(scene);\r\n        }\r\n        qtopo.toggle();\r\n    }\r\n}\r\nmodule.exports = events;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvZXZlbnRzLmpzP2FmNWMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjM3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgY29yZVxyXG4gKi9cclxuLyoqXHJcbiAqIEBjbGFzcyBTY2VuZVxyXG4gKi9cclxudmFyIGV2ZW50cyA9IHtcclxuICAgIGluaXQ6IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWcqOWbvuWxguS4iuWPjOWHu+aXtlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICog55uu5qCH5piv5YiG57uELOWImeWIhue7hOWPr+i/m+ihjOe8qeaUvuWSjOi/mOWOn1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICog55uu5qCH5Li66ZO+6LevLFFUb3BvLmNvbnN0YW50LmxpbmsuRElSRUNU57G75Z6L55qE6ZO+6Lev6K6h5pWw5aSn5LqOMeaXtuWPr+WxleW8gOWSjOWQiOW5tlxyXG4gICAgICAgICAqIEBldmVudCBkYmNsaWNrXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2NlbmUub24oXCJkYmNsaWNrXCIsIGRiQ2xpY2soc2NlbmUpKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gZGJDbGljayhzY2VuZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlLCBxdG9wbykge1xyXG4gICAgICAgIHRvZ2dsZUdyb3VwKGUsIHF0b3BvLCBzY2VuZSk7XHJcbiAgICAgICAgdG9nZ2xlTGluayhlLCBxdG9wbywgc2NlbmUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUdyb3VwKGUsIHF0b3BvLCBzY2VuZSkge1xyXG4gICAgLy/liIbnu4TpmpDol4/vvIzmmL7npLrnvKnmlL7oioLngrnvvIzoioLngrnkvY3nva7moLnmja7liIbnu4Tplb/lrr3orqHnrpdcclxuICAgIGlmIChxdG9wbykge1xyXG4gICAgICAgIGlmIChxdG9wby5nZXRUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSKSB7XHJcbiAgICAgICAgICAgIHF0b3BvLnRvZ2dsZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXRvcG8uZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50Lk5PREUgJiYgcXRvcG8uZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAvL+WIhue7hOaYvuekuu+8jOmakOiXj+e8qeaUvuiKgueCue+8jOWIhue7hOaWsOS9jee9ruagueaNruiKgueCueS9jee9ruWSjOWIhue7hOmVv+Wuveiuoeeul1xyXG4gICAgICAgICAgICBpZiAocXRvcG8udG9nZ2xlVG8pIHtcclxuICAgICAgICAgICAgICAgIHF0b3BvLnRvZ2dsZVRvLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUxpbmsoZSwgcXRvcG8sIHNjZW5lKSB7XHJcbiAgICBpZiAocXRvcG8gJiYgcXRvcG8uZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkxJTksgJiYgcXRvcG8uYXR0ci5leHBlbmRBYmxlKSB7XHJcbiAgICAgICAgaWYgKCEkLmlzRnVuY3Rpb24ocXRvcG8udG9nZ2xlKSkge1xyXG4gICAgICAgICAgICBxdG9wby5vcGVuVG9nZ2xlKHNjZW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcXRvcG8udG9nZ2xlKCk7XHJcbiAgICB9XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBldmVudHM7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL2V2ZW50cy5qc1xuLy8gbW9kdWxlIGlkID0gMzdcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==')},74:function(module,exports,__webpack_require__){eval('/**\r\n * @module QTopo\r\n */\r\n__webpack_require__(10);\r\nif (typeof jQuery == "undefined") {\r\n    throw new Error("need jquery");\r\n}\r\n/**\r\n * 主入口,window.QTopo\r\n * @class QTopo\r\n * @static\r\n */\r\nvar QTopo = {\r\n    /**\r\n     * 存放当前页面中所初始化的topo实例\r\n     * @property instance {array}\r\n     */\r\n    instance: [],\r\n    /**\r\n     * 一系列工具函数,详细内容参考 QTopo.util\r\n     * @property util {object}\r\n     */\r\n    util: __webpack_require__(11),\r\n    constant: __webpack_require__(8),\r\n    /**\r\n     * 可开启或屏蔽控制台日志,对应用QTopo.util.info以及QTopo.util.error函数输出的日志\r\n     * @property log {object}\r\n     * @param error {boolean} 默认为true,开启\r\n     * @param info {boolean} 默认为true,开启\r\n     */\r\n    log: {\r\n        error: true,\r\n        info: true\r\n    }\r\n};\r\nwindow.QTopo = QTopo;\r\nvar Scene = __webpack_require__(9);\r\n/**\r\n * 初始化Qtopo实例,创建并将其保存在QTopo.instance数组内,实例api参考QTopo.instance\r\n *  @method init\r\n *  @param dom {document} 指定初始化所在的dom,若是数组则自动取第一个\r\n *  @param [config] {object} 配置参数,配置内容为图层scene配置(参考scene配置)\r\n *  @returns [instance] QTopo实例对象，QTopo.instance\r\n *  @example\r\n *      IPOSS = QTopo.init(\r\n *           document.getElementsByClassName("topo_base")[0],\r\n *          {\r\n *              backgroundColor: "#06243e",//基本属性配置背景色\r\n *              path:[] //自定义属性,插入到图层对象scene的额外属性中\r\n *          }\r\n *      );\r\n */\r\nQTopo.init = function (dom, config) {\r\n    dom = dom instanceof Array ? dom[0] : dom;\r\n    var canvas = initCanvas(dom, $(dom).width(), $(dom).height());\r\n    /**\r\n     * QTopo初始化的topo实例,QTopo.init后的返回对象，或是QTopo.instance数组内保存的对象\r\n     * @class QTopo.instance\r\n     * @static\r\n     */\r\n    var QtopoInstance = {\r\n        /**\r\n         * topo实例化的图层对象\r\n         * @property scene {object}\r\n         */\r\n        scene: new Scene(canvas, config),\r\n        setOption: setOption,\r\n        /**\r\n         * topo实例所在dom\r\n         * @property document {document}\r\n         */\r\n        document: dom,\r\n        resize: resize(dom, canvas),\r\n        toJson: toJson\r\n    };\r\n    this.instance.push(QtopoInstance);\r\n    return QtopoInstance;\r\n};\r\nmodule.exports = QTopo;\r\n//---------------------\r\n/**\r\n * 图层绘制主函数\r\n *\r\n * 可以随时使用setOption生成一个或多个元素,或配置告警，也可以一次性全局配置\r\n *\r\n * 相关的全局样式请参考各元素自身的attr属性,或通过 元素的getDefault() / scene.getDefault(type)来获取对应元素的全局样式\r\n *\r\n * 前端绘图过程可以用工具栏和右键菜单绘制完成后,配合实例的toJson函数取得图层数据,(实例通过QTopo.init初始化且保存在QTopo.instance数组内)\r\n *\r\n * 直接将返回对象的option属性传入setOption可复制绘图\r\n *\r\n * 每个元素配置的data数组内成员的属性可以是样式也可以是额外属性,自适应取值配置，过滤的额外属性自动分配到元素的extra属性中保存,可以通过node.val(\'id\')的形式获取\r\n *\r\n * 和样式重名的额外属性可以放在extra中，extra中的属性将默认全部覆盖到元素的extra属性内\r\n *\r\n *  @method setOption\r\n *  @param option {object} 配置属性,参数可以是instance.toJson().option对象\r\n *      @param [option.node] {object} 创建node元素\r\n *          @param [option.node.style] {object} 设定全局的节点样式，未配置样式的节点会采用默认样式\r\n *          @param option.node.data {array} 细则看示例\r\n *      @param [option.container] {object} 创建container元素\r\n *          @param [option.container.style] {object} 设定全局的分组样式，未配置样式的分组会采用默认样式\r\n *          @param option.container.findChildren {string} 通知分组通过什么属性去查找成员\r\n *          @param option.container.data {array} 细则看示例\r\n *      @param [option.link] {object} 创建link元素\r\n *          @param [option.link.style] {object} 设定全局的分组样式，未配置样式的分组会采用默认样式\r\n *          @param option.link.path {array} 通知链接通过什么属性去查找起始点和终点,数组参数可以为1个或2个，当设置为2个时，通过不同属性查找起始点和终点\r\n *          @param option.link.data {array} 细则看示例\r\n *      @param [option.line] {object} 创建line元素\r\n *      @param [option.alarm] {object} 配置告警\r\n *          @param option.alarm.node {string} 通知告警模块如何查找需要设定告警的节点,现只支持节点上的告警\r\n *          @param [option.alarm.animate] {object} 配置告警动画,包含2个属性 ：\r\n *                     1. time:{number}设定间隔时间,单位为毫秒 ,\r\n *                     2. callBack:{function}回调函数,参数为当前处理告警的节点\r\n *          @param option.alarm.data {array} 告警设置,包含3个属性 ：\r\n *                     1. color {string}:告警展示的颜色,255,255,255/#ffffff ,\r\n *                     2. node {string}:对应告警属性下的node为键,此处为值来查找对应的节点 ,\r\n *                     3. [text] {string}:告警显示的文字信息，可不设或为空 ,\r\n *  @param [clear=false] {boolean} 是否清空图层，默认不清除\r\n *  @returns instance\r\n *  QTopo实例自身,用以链式操作\r\n *  @example\r\n *       topo.setOption({\r\n                node: {\r\n                    style:{//全局样式\r\n                        size:[60,60],\r\n                        image: "img/node.png"\r\n                    },\r\n                    data: [{\r\n                            position:[-200,-200],\r\n                            size:[100,100],\r\n                            id:1111,\r\n                            name:"测试1\\nhhhh" //\\n为名称换行\r\n                           },\r\n                           {\r\n                            position:[0,0],\r\n                            size:[100,100],\r\n                            id:2222,\r\n                            name:"测试2\\nhhhh" //\r\n                           }]\r\n                },\r\n                container: {\r\n                    style:{\r\n                        color:"#165782",\r\n                        alpha:0.3,\r\n                        border:{\r\n                            radius:10\r\n                        },\r\n                        namePosition:"top"\r\n                    },\r\n                    findChildren: "id",//这个决定了 每个分组根据data中的数据查找该加入的子,该属性应在node中的value中有配置\r\n                    data: [{\r\n                            size:[400,400],\r\n                            position:[0,0],\r\n                            layout:{\r\n                                type:"fixed"//布局为固定\r\n                            },\r\n                            children: childrenData,\r\n                            toggle:{ //分组切换的节点样式\r\n                                image: "img/node.png"\r\n                            }\r\n                          //  findChildren: "id", 当然也可以针对某个分组单独设置其查找子元素的标记\r\n                            children:["1111","2222"]//findChildren定义为id ，此处就该是对应元素的id属性\r\n                        }]\r\n                },\r\n                link: {\r\n                    style:{\r\n                        color:"#00FFFF"\r\n                    },\r\n                    path: ["id"],   //决定了线的起始节点由什么属性决定,数组长度为1则起始节点按统一属性查找，可分别设不同，0为起始节点属性.1为终点,该属性应在node中的value中有配置\r\n                    data: [{\r\n                                start:1111,//path指明起始点和终点都是找id属性，那此处就是起点的id\r\n                                end:2222,   //终点的id\r\n                                width:10,   //样式配置，详细参考对应元素的属性\r\n                                radius:25,\r\n                                arrow:{\r\n                                    end:true,\r\n                                    start:true,\r\n                                    size:10\r\n                                },\r\n                                extra:{\r\n                                    type:1  //额外属性，因与下述链路类型的名称一致，移直extra内赋值到生成的链路extra上,可通过link.val(\'type\')取到\r\n                                },\r\n                                type:QTopo.constant.link.FLEXIONAL //建立的链路类型\r\n                            }]\r\n                },\r\n                alarm: {\r\n                    node: "alarmId",    //指明节点上对应的查找属性,该属性应在node中的value中有配置,暂只支持节点告警\r\n                    data: [],\r\n                    animate:{   //可设置动画，每个点亮之间延迟多少毫秒，回调函数中能获取到点亮的节点信息\r\n                        time:1000,\r\n                        callBack:function(node){\r\n                            console.info(node)\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n */\r\nfunction setOption(option, clear) {\r\n    option = option || {};\r\n    QTopo.util.info("start set topo: ", option);\r\n    var scene = this.scene;\r\n    if (clear) {\r\n        scene.clear();\r\n    }\r\n    createNode(scene, option.node);\r\n    createContainer(scene, option.container);\r\n    createLink(scene, option.link);\r\n    createLine(scene, option.line);\r\n    drawAlarm(scene, option.alarm);\r\n    QTopo.util.info("set topo complete: ", {\r\n        node: scene.children.node.length,\r\n        link: scene.children.link.length,\r\n        container: scene.children.container.length,\r\n        line: scene.children.line.length\r\n    });\r\n    return this;\r\n}\r\n/**\r\n * 实例自适应大小\r\n *  @method resize\r\n *  @returns instance QTopo实例自身,用以链式操作\r\n *  @example\r\n *      $(window).resize(function () {\r\n *          IPOSS.resize();\r\n *      });\r\n */\r\nfunction resize(dom, canvas) {\r\n    return function () {\r\n        canvas.setAttribute(\'width\', $(dom).width());\r\n        canvas.setAttribute(\'height\', $(dom).height());\r\n        return this;\r\n    }\r\n}\r\n/**\r\n * 当前图层数据转化为json结构\r\n *  @method toJson\r\n *  @returns {object}\r\n *  @example\r\n        var IPOSS=QTopo.instance[0];\r\n        var json=IPOSS.toJson();    //json={\r\n                                    //         init:图层参数,scene对象的参数配置,\r\n                                    //         option:图层内所有对象的属性提取，可直接用于setOption还原,其中jsonId用做每个元素的唯一标识\r\n                                    //      }\r\n        IPOSS.setOption(json.option,true);\r\n */\r\nfunction toJson() {\r\n    var data = this.scene.children;\r\n    var serialized = {\r\n        init: this.scene.toJson(),\r\n        option: {\r\n            node: {\r\n                data: []\r\n            },\r\n            link: {\r\n                data: []\r\n            },\r\n            container: {\r\n                data: []\r\n            },\r\n            line: {\r\n                data: []\r\n            }\r\n        }\r\n    };\r\n    $.each(data, function (name, elements) {\r\n        if ($.isArray(elements)) {\r\n            elements.map(function (element) {\r\n                if (serialized.option[name]) {\r\n                    serialized.option[name].data.push(element.toJson());\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return serialized;\r\n}\r\nfunction initCanvas(dom, width, height) {\r\n    if (width <= 0 || height <= 0) {\r\n        throw new Error("The dom is not exist /not config width and height!");\r\n    }\r\n    dom.style.position = \'relative\';\r\n    dom.style.overflow = \'hidden\';\r\n    var canvas = document.createElement(\'canvas\');\r\n    dom.appendChild(canvas);\r\n    canvas.setAttribute(\'width\', width);\r\n    canvas.setAttribute(\'height\', height);\r\n    canvas.style.position = "absolute";\r\n    canvas.style.top = 0;\r\n    canvas.style.left = 0;\r\n    canvas.style[\'user-select\'] = \'none\';\r\n    canvas.style[\'-webkit-tap-highlight-color\'] = \'rgba(0, 0, 0, 0)\';\r\n    return canvas;\r\n}\r\n\r\nfunction createNode(scene, config) {\r\n    if (config) {\r\n        setDefaults(scene, QTopo.constant.node, config.style);\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, item) {\r\n                var node = scene.createNode(item);\r\n                //额外属性添加\r\n                setExtra(node, item);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n//排除临时元素\r\nfunction notCasual(arr) {\r\n    if (arr.length == 1) {\r\n        return arr[0];\r\n    } else {\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i].getUseType() != QTopo.constant.CASUAL) {\r\n                arr = arr[i];\r\n                return arr;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction createContainer(scene, config) {\r\n    if (config) {\r\n        setDefaults(scene, QTopo.constant.container, config.style);\r\n        makeContainer(scene, config);\r\n    }\r\n}\r\nfunction makeContainer(scene, config) {\r\n    //搜索子的总标记\r\n    var findChild;\r\n    if (config.findChildren) {\r\n        findChild = config.findChildren;\r\n    }\r\n    if ($.isArray(config.data)) {\r\n        //开始构造分组\r\n        $.each(config.data, function (i, item) {\r\n            //无论是否有子元素，分组先创造出来\r\n            var container = scene.createContainer(item);\r\n            //额外属性添加\r\n            setExtra(container, item);\r\n            //确定查找子元素的标记\r\n            var findChild_exact = findChild;\r\n            if (item.findChildren) {\r\n                findChild_exact = item.findChildren;\r\n            }\r\n            makeChildren(scene, container, item, findChild_exact);\r\n        });\r\n    }\r\n}\r\nfunction makeChildren(scene, container, config, findChild) {\r\n    //过滤搜索子类的标记\r\n    findChild = filterTag(findChild);\r\n    if ($.isArray(config.children)) {\r\n        var errorInfo = [];\r\n        $.each(config.children, function (j, children) {\r\n            var child = scene.find(findChild + "=" + children);\r\n            if (child && child.length > 0) {\r\n                $.each(child, function (m, one) {\r\n                    if (one.getUseType() != QTopo.constant.CASUAL) {\r\n                        container.add(one);\r\n                    }\r\n                });\r\n            } else {\r\n                errorInfo.push({\r\n                    index: j,\r\n                    search: findChild + "=" + children\r\n                });\r\n            }\r\n        });\r\n        if (errorInfo.length > 0) {\r\n            QTopo.util.error("some child not found : ", errorInfo);\r\n        }\r\n    }\r\n}\r\nfunction filterTag(tag) {\r\n    if (!tag) {\r\n        tag = \'jsonId\'\r\n    }\r\n    return tag;\r\n}\r\n\r\nfunction createLink(scene, config) {\r\n    if (config) {\r\n        var path = config.path;\r\n        var findStart;\r\n        var findEnd;\r\n        if ($.isArray(path) && path.length > 0) {\r\n            //path为数组，0为起点条件1为终点条件,确定搜索条件,起始点条件可不同\r\n            if (path.length == 1) {\r\n                findEnd = path[0];\r\n                findStart = findEnd;\r\n            } else {\r\n                findStart = path[0];\r\n                findEnd = path[1];\r\n            }\r\n        } else {\r\n            findStart = filterTag(findStart);\r\n            findEnd = filterTag(findEnd);\r\n        }\r\n        //设置默认属性\r\n        setDefaults(scene, QTopo.constant.link, config.style);\r\n        //开始创建\r\n        makeLink(scene, config, findStart, findEnd);\r\n    }\r\n}\r\nfunction makeLink(scene, config, findStart, findEnd) {\r\n    if ($.isArray(config.data)) {\r\n        var errorInfo = [];\r\n        $.each(config.data, function (i, item) {\r\n            if (item) {\r\n                var link;\r\n                //根据确定的条件进行搜索\r\n                var start = notCasual(scene.find(findStart + "=" + item.start));\r\n                var end = notCasual(scene.find(findEnd + "=" + item.end));\r\n                if (start && end) {\r\n                    item.start = start;\r\n                    item.end = end;\r\n                    link = scene.addLink(item);\r\n                    //额外属性添加\r\n                    setExtra(link, item);\r\n                } else {\r\n                    var errorDate = {\r\n                        index: i,\r\n                        data: item\r\n                    };\r\n                    if (!start) {\r\n                        errorDate.missStart = item.start;\r\n                    }\r\n                    if (!end) {\r\n                        errorDate.missEnd = item.end;\r\n                    }\r\n                    errorInfo.push(errorDate);\r\n                }\r\n            } else {\r\n                errorInfo.push({\r\n                    index: i,\r\n                    info: "undefined data"\r\n                });\r\n            }\r\n        });\r\n        if (errorInfo.length > 0) {\r\n            QTopo.util.error("some link invalid : ", errorInfo);\r\n        }\r\n    }\r\n}\r\n//根据配置创建线段\r\nfunction createLine(scene, config) {\r\n    if (config) {\r\n        //设置默认属性\r\n        //设置默认属性\r\n        setDefaults(scene, QTopo.constant.line, config.style);\r\n        //开始创建\r\n        if ($.isArray(config.data)) {\r\n            $.each(config.data, function (i, v) {\r\n                var line = scene.createLine(v);\r\n                //额外属性添加\r\n                setExtra(line, v);\r\n            });\r\n        } else {\r\n            QTopo.util.error("can not draw line,need config \'path\' and \'path\' is Array and not empty,path\'s element need config x y, path used to find start and end");\r\n        }\r\n    }\r\n}\r\n\r\nfunction drawAlarm(scene, config) {\r\n    if (config) {\r\n        if ($.isArray(config.data) && config.node) {\r\n            var alarmData = config.data;\r\n            var alarmNodes = makeAlarmData(scene, alarmData, config);\r\n            QTopo.util.info("告警绘制 :", {\r\n                config: alarmData.length,\r\n                success: alarmNodes.length\r\n            });\r\n            if (config.animate) {\r\n                alarmAnimate(config.animate, alarmNodes);\r\n            } else {\r\n                $.each(alarmNodes, function (i, v) {\r\n                    v.node.set({\r\n                        alarm: v.alarm\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction makeAlarmData(scene, alarmData, config) {\r\n    var alarms = [];\r\n    $.each(alarmData, function (k, v) {\r\n        var node = notCasual(scene.find(config.node + "=" + v["node"], "node"));\r\n        if (node) {\r\n            alarms.push({\r\n                node: node,\r\n                alarm: {\r\n                    show: typeof v.show == "boolean" ? v.show : true,\r\n                    text: v.text,\r\n                    color: v.color,\r\n                    font: v.font\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return alarms;\r\n}\r\nvar animateRuning;\r\nfunction alarmAnimate(animate, alarmNodes) {\r\n    if (animate) {\r\n        if ($.isNumeric(animate.time)) {\r\n            clearAnimat();\r\n            QTopo.util.info("启用告警动画");\r\n            animateRuning = setInterval(function () {\r\n                if (alarmNodes.length > 0) {\r\n                    var data = alarmNodes.pop();\r\n                    data.node.set({\r\n                        alarm: data.alarm\r\n                    });\r\n                    if ($.isFunction(animate.callBack)) {\r\n                        animate.callBack(data.node);\r\n                    }\r\n                } else {\r\n                    QTopo.util.info("告警动画结束");\r\n                    clearAnimat();\r\n                }\r\n            }, parseInt(animate.time));\r\n        }\r\n    }\r\n}\r\nfunction clearAnimat() {\r\n    if (animateRuning) {\r\n        clearInterval(animateRuning);\r\n        animateRuning = "";\r\n    }\r\n}\r\nfunction setExtra(element, data) {\r\n    if (data) {\r\n        $.each(data, function (key, value) {\r\n            if (filterConfig(element, key) && ["start", "end", "children", "toggle", "type", "extra"].indexOf(key) < 0) {\r\n                element.extra[key] = value;\r\n            }\r\n        });\r\n        if (data.extra) {\r\n            $.each(data.extra, function (key, value) {\r\n                if (value) {\r\n                    element.extra[key] = value;\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\nfunction filterConfig(element, key) {\r\n    return element && typeof element.attr[key] == \'undefined\';\r\n}\r\nfunction setDefaults(scene, typeArr, style) {\r\n    if (style) {\r\n        $.each(typeArr, function (i, types) {\r\n            scene.setDefault(types, style);\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL21haW4uanM/ZjkwOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QixxQkFBcUIsUUFBUTtBQUM3QixvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekIscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCLDhCQUE4QixPQUFPO0FBQ3JDLHdDQUF3QyxPQUFPO0FBQy9DLHFDQUFxQyxNQUFNO0FBQzNDLG1DQUFtQyxPQUFPO0FBQzFDLDZDQUE2QyxPQUFPO0FBQ3BELGtEQUFrRCxPQUFPO0FBQ3pELDBDQUEwQyxNQUFNO0FBQ2hELDhCQUE4QixPQUFPO0FBQ3JDLHdDQUF3QyxPQUFPO0FBQy9DLHFDQUFxQyxNQUFNO0FBQzNDLHFDQUFxQyxNQUFNO0FBQzNDLDhCQUE4QixPQUFPO0FBQ3JDLCtCQUErQixPQUFPO0FBQ3RDLHNDQUFzQyxPQUFPO0FBQzdDLDJDQUEyQyxPQUFPO0FBQ2xELGdDQUFnQyxPQUFPO0FBQ3ZDLG9DQUFvQyxTQUFTO0FBQzdDLHNDQUFzQyxNQUFNO0FBQzVDLGlDQUFpQyxPQUFPO0FBQ3hDLGdDQUFnQyxPQUFPO0FBQ3ZDLGtDQUFrQyxPQUFPO0FBQ3pDLDBCQUEwQixRQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0EsNkJBQTZCO0FBQzdCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCx1QkFBdUIsZ0JBQWdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSIsImZpbGUiOiI3NC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIFFUb3BvXHJcbiAqL1xyXG5yZXF1aXJlKFwiLi9jb3JlL2p0b3BvL2p0b3BvLW1pbi5qc1wiKTtcclxuaWYgKHR5cGVvZiBqUXVlcnkgPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwibmVlZCBqcXVlcnlcIik7XHJcbn1cclxuLyoqXHJcbiAqIOS4u+WFpeWPoyx3aW5kb3cuUVRvcG9cclxuICogQGNsYXNzIFFUb3BvXHJcbiAqIEBzdGF0aWNcclxuICovXHJcbnZhciBRVG9wbyA9IHtcclxuICAgIC8qKlxyXG4gICAgICog5a2Y5pS+5b2T5YmN6aG16Z2i5Lit5omA5Yid5aeL5YyW55qEdG9wb+WunuS+i1xyXG4gICAgICogQHByb3BlcnR5IGluc3RhbmNlIHthcnJheX1cclxuICAgICAqL1xyXG4gICAgaW5zdGFuY2U6IFtdLFxyXG4gICAgLyoqXHJcbiAgICAgKiDkuIDns7vliJflt6Xlhbflh73mlbAs6K+m57uG5YaF5a655Y+C6ICDIFFUb3BvLnV0aWxcclxuICAgICAqIEBwcm9wZXJ0eSB1dGlsIHtvYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHV0aWw6IHJlcXVpcmUoJy4vdXRpbC5qcycpLFxyXG4gICAgY29uc3RhbnQ6IHJlcXVpcmUoJy4vY29uc3RhbnQuanMnKSxcclxuICAgIC8qKlxyXG4gICAgICog5Y+v5byA5ZCv5oiW5bGP6JS95o6n5Yi25Y+w5pel5b+XLOWvueW6lOeUqFFUb3BvLnV0aWwuaW5mb+S7peWPilFUb3BvLnV0aWwuZXJyb3Llh73mlbDovpPlh7rnmoTml6Xlv5dcclxuICAgICAqIEBwcm9wZXJ0eSBsb2cge29iamVjdH1cclxuICAgICAqIEBwYXJhbSBlcnJvciB7Ym9vbGVhbn0g6buY6K6k5Li6dHJ1ZSzlvIDlkK9cclxuICAgICAqIEBwYXJhbSBpbmZvIHtib29sZWFufSDpu5jorqTkuLp0cnVlLOW8gOWQr1xyXG4gICAgICovXHJcbiAgICBsb2c6IHtcclxuICAgICAgICBlcnJvcjogdHJ1ZSxcclxuICAgICAgICBpbmZvOiB0cnVlXHJcbiAgICB9XHJcbn07XHJcbndpbmRvdy5RVG9wbyA9IFFUb3BvO1xyXG52YXIgU2NlbmUgPSByZXF1aXJlKCcuL2NvcmUvU2NlbmUuanMnKTtcclxuLyoqXHJcbiAqIOWIneWni+WMllF0b3Bv5a6e5L6LLOWIm+W7uuW5tuWwhuWFtuS/neWtmOWcqFFUb3BvLmluc3RhbmNl5pWw57uE5YaFLOWunuS+i2FwaeWPguiAg1FUb3BvLmluc3RhbmNlXHJcbiAqICBAbWV0aG9kIGluaXRcclxuICogIEBwYXJhbSBkb20ge2RvY3VtZW50fSDmjIflrprliJ3lp4vljJbmiYDlnKjnmoRkb20s6Iul5piv5pWw57uE5YiZ6Ieq5Yqo5Y+W56ys5LiA5LiqXHJcbiAqICBAcGFyYW0gW2NvbmZpZ10ge29iamVjdH0g6YWN572u5Y+C5pWwLOmFjee9ruWGheWuueS4uuWbvuWxgnNjZW5l6YWN572uKOWPguiAg3NjZW5l6YWN572uKVxyXG4gKiAgQHJldHVybnMgW2luc3RhbmNlXSBRVG9wb+WunuS+i+Wvueixoe+8jFFUb3BvLmluc3RhbmNlXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgIElQT1NTID0gUVRvcG8uaW5pdChcclxuICogICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0b3BvX2Jhc2VcIilbMF0sXHJcbiAqICAgICAgICAgIHtcclxuICogICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjMDYyNDNlXCIsLy/ln7rmnKzlsZ7mgKfphY3nva7og4zmma/oibJcclxuICogICAgICAgICAgICAgIHBhdGg6W10gLy/oh6rlrprkuYnlsZ7mgKcs5o+S5YWl5Yiw5Zu+5bGC5a+56LGhc2NlbmXnmoTpop3lpJblsZ7mgKfkuK1cclxuICogICAgICAgICAgfVxyXG4gKiAgICAgICk7XHJcbiAqL1xyXG5RVG9wby5pbml0ID0gZnVuY3Rpb24gKGRvbSwgY29uZmlnKSB7XHJcbiAgICBkb20gPSBkb20gaW5zdGFuY2VvZiBBcnJheSA/IGRvbVswXSA6IGRvbTtcclxuICAgIHZhciBjYW52YXMgPSBpbml0Q2FudmFzKGRvbSwgJChkb20pLndpZHRoKCksICQoZG9tKS5oZWlnaHQoKSk7XHJcbiAgICAvKipcclxuICAgICAqIFFUb3Bv5Yid5aeL5YyW55qEdG9wb+WunuS+iyxRVG9wby5pbml05ZCO55qE6L+U5Zue5a+56LGh77yM5oiW5pivUVRvcG8uaW5zdGFuY2XmlbDnu4TlhoXkv53lrZjnmoTlr7nosaFcclxuICAgICAqIEBjbGFzcyBRVG9wby5pbnN0YW5jZVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICovXHJcbiAgICB2YXIgUXRvcG9JbnN0YW5jZSA9IHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB0b3Bv5a6e5L6L5YyW55qE5Zu+5bGC5a+56LGhXHJcbiAgICAgICAgICogQHByb3BlcnR5IHNjZW5lIHtvYmplY3R9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2NlbmU6IG5ldyBTY2VuZShjYW52YXMsIGNvbmZpZyksXHJcbiAgICAgICAgc2V0T3B0aW9uOiBzZXRPcHRpb24sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogdG9wb+WunuS+i+aJgOWcqGRvbVxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSBkb2N1bWVudCB7ZG9jdW1lbnR9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZG9jdW1lbnQ6IGRvbSxcclxuICAgICAgICByZXNpemU6IHJlc2l6ZShkb20sIGNhbnZhcyksXHJcbiAgICAgICAgdG9Kc29uOiB0b0pzb25cclxuICAgIH07XHJcbiAgICB0aGlzLmluc3RhbmNlLnB1c2goUXRvcG9JbnN0YW5jZSk7XHJcbiAgICByZXR1cm4gUXRvcG9JbnN0YW5jZTtcclxufTtcclxubW9kdWxlLmV4cG9ydHMgPSBRVG9wbztcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLyoqXHJcbiAqIOWbvuWxgue7mOWItuS4u+WHveaVsFxyXG4gKlxyXG4gKiDlj6/ku6Xpmo/ml7bkvb/nlKhzZXRPcHRpb27nlJ/miJDkuIDkuKrmiJblpJrkuKrlhYPntKAs5oiW6YWN572u5ZGK6K2m77yM5Lmf5Y+v5Lul5LiA5qyh5oCn5YWo5bGA6YWN572uXHJcbiAqXHJcbiAqIOebuOWFs+eahOWFqOWxgOagt+W8j+ivt+WPguiAg+WQhOWFg+e0oOiHqui6q+eahGF0dHLlsZ7mgKcs5oiW6YCa6L+HIOWFg+e0oOeahGdldERlZmF1bHQoKSAvIHNjZW5lLmdldERlZmF1bHQodHlwZSnmnaXojrflj5blr7nlupTlhYPntKDnmoTlhajlsYDmoLflvI9cclxuICpcclxuICog5YmN56uv57uY5Zu+6L+H56iL5Y+v5Lul55So5bel5YW35qCP5ZKM5Y+z6ZSu6I+c5Y2V57uY5Yi25a6M5oiQ5ZCOLOmFjeWQiOWunuS+i+eahHRvSnNvbuWHveaVsOWPluW+l+WbvuWxguaVsOaNriwo5a6e5L6L6YCa6L+HUVRvcG8uaW5pdOWIneWni+WMluS4lOS/neWtmOWcqFFUb3BvLmluc3RhbmNl5pWw57uE5YaFKVxyXG4gKlxyXG4gKiDnm7TmjqXlsIbov5Tlm57lr7nosaHnmoRvcHRpb27lsZ7mgKfkvKDlhaVzZXRPcHRpb27lj6/lpI3liLbnu5jlm75cclxuICpcclxuICog5q+P5Liq5YWD57Sg6YWN572u55qEZGF0YeaVsOe7hOWGheaIkOWRmOeahOWxnuaAp+WPr+S7peaYr+agt+W8j+S5n+WPr+S7peaYr+mineWkluWxnuaApyzoh6rpgILlupTlj5blgLzphY3nva7vvIzov4fmu6TnmoTpop3lpJblsZ7mgKfoh6rliqjliIbphY3liLDlhYPntKDnmoRleHRyYeWxnuaAp+S4reS/neWtmCzlj6/ku6XpgJrov4dub2RlLnZhbCgnaWQnKeeahOW9ouW8j+iOt+WPllxyXG4gKlxyXG4gKiDlkozmoLflvI/ph43lkI3nmoTpop3lpJblsZ7mgKflj6/ku6XmlL7lnKhleHRyYeS4re+8jGV4dHJh5Lit55qE5bGe5oCn5bCG6buY6K6k5YWo6YOo6KaG55uW5Yiw5YWD57Sg55qEZXh0cmHlsZ7mgKflhoVcclxuICpcclxuICogIEBtZXRob2Qgc2V0T3B0aW9uXHJcbiAqICBAcGFyYW0gb3B0aW9uIHtvYmplY3R9IOmFjee9ruWxnuaApyzlj4LmlbDlj6/ku6XmmK9pbnN0YW5jZS50b0pzb24oKS5vcHRpb27lr7nosaFcclxuICogICAgICBAcGFyYW0gW29wdGlvbi5ub2RlXSB7b2JqZWN0fSDliJvlu7pub2Rl5YWD57SgXHJcbiAqICAgICAgICAgIEBwYXJhbSBbb3B0aW9uLm5vZGUuc3R5bGVdIHtvYmplY3R9IOiuvuWumuWFqOWxgOeahOiKgueCueagt+W8j++8jOacqumFjee9ruagt+W8j+eahOiKgueCueS8mumHh+eUqOm7mOiupOagt+W8j1xyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLm5vZGUuZGF0YSB7YXJyYXl9IOe7huWImeeci+ekuuS+i1xyXG4gKiAgICAgIEBwYXJhbSBbb3B0aW9uLmNvbnRhaW5lcl0ge29iamVjdH0g5Yib5bu6Y29udGFpbmVy5YWD57SgXHJcbiAqICAgICAgICAgIEBwYXJhbSBbb3B0aW9uLmNvbnRhaW5lci5zdHlsZV0ge29iamVjdH0g6K6+5a6a5YWo5bGA55qE5YiG57uE5qC35byP77yM5pyq6YWN572u5qC35byP55qE5YiG57uE5Lya6YeH55So6buY6K6k5qC35byPXHJcbiAqICAgICAgICAgIEBwYXJhbSBvcHRpb24uY29udGFpbmVyLmZpbmRDaGlsZHJlbiB7c3RyaW5nfSDpgJrnn6XliIbnu4TpgJrov4fku4DkuYjlsZ7mgKfljrvmn6Xmib7miJDlkZhcclxuICogICAgICAgICAgQHBhcmFtIG9wdGlvbi5jb250YWluZXIuZGF0YSB7YXJyYXl9IOe7huWImeeci+ekuuS+i1xyXG4gKiAgICAgIEBwYXJhbSBbb3B0aW9uLmxpbmtdIHtvYmplY3R9IOWIm+W7umxpbmvlhYPntKBcclxuICogICAgICAgICAgQHBhcmFtIFtvcHRpb24ubGluay5zdHlsZV0ge29iamVjdH0g6K6+5a6a5YWo5bGA55qE5YiG57uE5qC35byP77yM5pyq6YWN572u5qC35byP55qE5YiG57uE5Lya6YeH55So6buY6K6k5qC35byPXHJcbiAqICAgICAgICAgIEBwYXJhbSBvcHRpb24ubGluay5wYXRoIHthcnJheX0g6YCa55+l6ZO+5o6l6YCa6L+H5LuA5LmI5bGe5oCn5Y675p+l5om+6LW35aeL54K55ZKM57uI54K5LOaVsOe7hOWPguaVsOWPr+S7peS4ujHkuKrmiJYy5Liq77yM5b2T6K6+572u5Li6MuS4quaXtu+8jOmAmui/h+S4jeWQjOWxnuaAp+afpeaJvui1t+Wni+eCueWSjOe7iOeCuVxyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLmxpbmsuZGF0YSB7YXJyYXl9IOe7huWImeeci+ekuuS+i1xyXG4gKiAgICAgIEBwYXJhbSBbb3B0aW9uLmxpbmVdIHtvYmplY3R9IOWIm+W7umxpbmXlhYPntKBcclxuICogICAgICBAcGFyYW0gW29wdGlvbi5hbGFybV0ge29iamVjdH0g6YWN572u5ZGK6K2mXHJcbiAqICAgICAgICAgIEBwYXJhbSBvcHRpb24uYWxhcm0ubm9kZSB7c3RyaW5nfSDpgJrnn6XlkYrorabmqKHlnZflpoLkvZXmn6Xmib7pnIDopoHorr7lrprlkYrorabnmoToioLngrks546w5Y+q5pSv5oyB6IqC54K55LiK55qE5ZGK6K2mXHJcbiAqICAgICAgICAgIEBwYXJhbSBbb3B0aW9uLmFsYXJtLmFuaW1hdGVdIHtvYmplY3R9IOmFjee9ruWRiuitpuWKqOeUuyzljIXlkKsy5Liq5bGe5oCnIO+8mlxyXG4gKiAgICAgICAgICAgICAgICAgICAgIDEuIHRpbWU6e251bWJlcn3orr7lrprpl7TpmpTml7bpl7Qs5Y2V5L2N5Li65q+r56eSICxcclxuICogICAgICAgICAgICAgICAgICAgICAyLiBjYWxsQmFjazp7ZnVuY3Rpb2595Zue6LCD5Ye95pWwLOWPguaVsOS4uuW9k+WJjeWkhOeQhuWRiuitpueahOiKgueCuVxyXG4gKiAgICAgICAgICBAcGFyYW0gb3B0aW9uLmFsYXJtLmRhdGEge2FycmF5fSDlkYroraborr7nva4s5YyF5ZCrM+S4quWxnuaApyDvvJpcclxuICogICAgICAgICAgICAgICAgICAgICAxLiBjb2xvciB7c3RyaW5nfTrlkYrorablsZXnpLrnmoTpopzoibIsMjU1LDI1NSwyNTUvI2ZmZmZmZiAsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgMi4gbm9kZSB7c3RyaW5nfTrlr7nlupTlkYrorablsZ7mgKfkuIvnmoRub2Rl5Li66ZSuLOatpOWkhOS4uuWAvOadpeafpeaJvuWvueW6lOeahOiKgueCuSAsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgMy4gW3RleHRdIHtzdHJpbmd9OuWRiuitpuaYvuekuueahOaWh+Wtl+S/oeaBr++8jOWPr+S4jeiuvuaIluS4uuepuiAsXHJcbiAqICBAcGFyYW0gW2NsZWFyPWZhbHNlXSB7Ym9vbGVhbn0g5piv5ZCm5riF56m65Zu+5bGC77yM6buY6K6k5LiN5riF6ZmkXHJcbiAqICBAcmV0dXJucyBpbnN0YW5jZVxyXG4gKiAgUVRvcG/lrp7kvovoh6rouqss55So5Lul6ZO+5byP5pON5L2cXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICB0b3BvLnNldE9wdGlvbih7XHJcbiAgICAgICAgICAgICAgICBub2RlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6ey8v5YWo5bGA5qC35byPXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6WzYwLDYwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IFwiaW1nL25vZGUucG5nXCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjpbLTIwMCwtMjAwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6WzEwMCwxMDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6MTExMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6XCLmtYvor5UxXFxuaGhoaFwiIC8vXFxu5Li65ZCN56ew5o2i6KGMXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOlswLDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTpbMTAwLDEwMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoyMjIyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTpcIua1i+ivlTJcXG5oaGhoXCIgLy9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBjb250YWluZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOlwiIzE2NTc4MlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTowLjMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcjp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6MTBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVBvc2l0aW9uOlwidG9wXCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbmRDaGlsZHJlbjogXCJpZFwiLC8v6L+Z5Liq5Yaz5a6a5LqGIOavj+S4quWIhue7hOagueaNrmRhdGHkuK3nmoTmlbDmja7mn6Xmib7or6XliqDlhaXnmoTlrZAs6K+l5bGe5oCn5bqU5Zyobm9kZeS4reeahHZhbHVl5Lit5pyJ6YWN572uXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6WzQwMCw0MDBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246WzAsMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6XCJmaXhlZFwiLy/luIPlsYDkuLrlm7rlrppcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5EYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlOnsgLy/liIbnu4TliIfmjaLnmoToioLngrnmoLflvI9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTogXCJpbWcvbm9kZS5wbmdcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vICBmaW5kQ2hpbGRyZW46IFwiaWRcIiwg5b2T54S25Lmf5Y+v5Lul6ZKI5a+55p+Q5Liq5YiG57uE5Y2V54us6K6+572u5YW25p+l5om+5a2Q5YWD57Sg55qE5qCH6K6wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjpbXCIxMTExXCIsXCIyMjIyXCJdLy9maW5kQ2hpbGRyZW7lrprkuYnkuLppZCDvvIzmraTlpITlsLHor6XmmK/lr7nlupTlhYPntKDnmoRpZOWxnuaAp1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGxpbms6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOlwiIzAwRkZGRlwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBwYXRoOiBbXCJpZFwiXSwgICAvL+WGs+WumuS6hue6v+eahOi1t+Wni+iKgueCueeUseS7gOS5iOWxnuaAp+WGs+WumizmlbDnu4Tplb/luqbkuLox5YiZ6LW35aeL6IqC54K55oyJ57uf5LiA5bGe5oCn5p+l5om+77yM5Y+v5YiG5Yir6K6+5LiN5ZCM77yMMOS4uui1t+Wni+iKgueCueWxnuaApy4x5Li657uI54K5LOivpeWxnuaAp+W6lOWcqG5vZGXkuK3nmoR2YWx1ZeS4reaciemFjee9rlxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6MTExMSwvL3BhdGjmjIfmmI7otbflp4vngrnlkoznu4jngrnpg73mmK/mib5pZOWxnuaAp++8jOmCo+atpOWkhOWwseaYr+i1t+eCueeahGlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOjIyMjIsICAgLy/nu4jngrnnmoRpZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOjEwLCAgIC8v5qC35byP6YWN572u77yM6K+m57uG5Y+C6ICD5a+55bqU5YWD57Sg55qE5bGe5oCnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzOjI1LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycm93OntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOnRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OnRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6MTBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZToxICAvL+mineWkluWxnuaAp++8jOWboOS4juS4i+i/sOmTvui3r+exu+Wei+eahOWQjeensOS4gOiHtO+8jOenu+ebtGV4dHJh5YaF6LWL5YC85Yiw55Sf5oiQ55qE6ZO+6LevZXh0cmHkuIos5Y+v6YCa6L+HbGluay52YWwoJ3R5cGUnKeWPluWIsFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpRVG9wby5jb25zdGFudC5saW5rLkZMRVhJT05BTCAvL+W7uueri+eahOmTvui3r+exu+Wei1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBhbGFybToge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGU6IFwiYWxhcm1JZFwiLCAgICAvL+aMh+aYjuiKgueCueS4iuWvueW6lOeahOafpeaJvuWxnuaApyzor6XlsZ7mgKflupTlnKhub2Rl5Lit55qEdmFsdWXkuK3mnInphY3nva4s5pqC5Y+q5pSv5oyB6IqC54K55ZGK6K2mXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZTp7ICAgLy/lj6/orr7nva7liqjnlLvvvIzmr4/kuKrngrnkuq7kuYvpl7Tlu7bov5/lpJrlsJHmr6vnp5LvvIzlm57osIPlh73mlbDkuK3og73ojrflj5bliLDngrnkuq7nmoToioLngrnkv6Hmga9cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZToxMDAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjazpmdW5jdGlvbihub2RlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhub2RlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gKi9cclxuZnVuY3Rpb24gc2V0T3B0aW9uKG9wdGlvbiwgY2xlYXIpIHtcclxuICAgIG9wdGlvbiA9IG9wdGlvbiB8fCB7fTtcclxuICAgIFFUb3BvLnV0aWwuaW5mbyhcInN0YXJ0IHNldCB0b3BvOiBcIiwgb3B0aW9uKTtcclxuICAgIHZhciBzY2VuZSA9IHRoaXMuc2NlbmU7XHJcbiAgICBpZiAoY2xlYXIpIHtcclxuICAgICAgICBzY2VuZS5jbGVhcigpO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlTm9kZShzY2VuZSwgb3B0aW9uLm5vZGUpO1xyXG4gICAgY3JlYXRlQ29udGFpbmVyKHNjZW5lLCBvcHRpb24uY29udGFpbmVyKTtcclxuICAgIGNyZWF0ZUxpbmsoc2NlbmUsIG9wdGlvbi5saW5rKTtcclxuICAgIGNyZWF0ZUxpbmUoc2NlbmUsIG9wdGlvbi5saW5lKTtcclxuICAgIGRyYXdBbGFybShzY2VuZSwgb3B0aW9uLmFsYXJtKTtcclxuICAgIFFUb3BvLnV0aWwuaW5mbyhcInNldCB0b3BvIGNvbXBsZXRlOiBcIiwge1xyXG4gICAgICAgIG5vZGU6IHNjZW5lLmNoaWxkcmVuLm5vZGUubGVuZ3RoLFxyXG4gICAgICAgIGxpbms6IHNjZW5lLmNoaWxkcmVuLmxpbmsubGVuZ3RoLFxyXG4gICAgICAgIGNvbnRhaW5lcjogc2NlbmUuY2hpbGRyZW4uY29udGFpbmVyLmxlbmd0aCxcclxuICAgICAgICBsaW5lOiBzY2VuZS5jaGlsZHJlbi5saW5lLmxlbmd0aFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcztcclxufVxyXG4vKipcclxuICog5a6e5L6L6Ieq6YCC5bqU5aSn5bCPXHJcbiAqICBAbWV0aG9kIHJlc2l6ZVxyXG4gKiAgQHJldHVybnMgaW5zdGFuY2UgUVRvcG/lrp7kvovoh6rouqss55So5Lul6ZO+5byP5pON5L2cXHJcbiAqICBAZXhhbXBsZVxyXG4gKiAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkge1xyXG4gKiAgICAgICAgICBJUE9TUy5yZXNpemUoKTtcclxuICogICAgICB9KTtcclxuICovXHJcbmZ1bmN0aW9uIHJlc2l6ZShkb20sIGNhbnZhcykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCd3aWR0aCcsICQoZG9tKS53aWR0aCgpKTtcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAkKGRvbSkuaGVpZ2h0KCkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiDlvZPliY3lm77lsYLmlbDmja7ovazljJbkuLpqc29u57uT5p6EXHJcbiAqICBAbWV0aG9kIHRvSnNvblxyXG4gKiAgQHJldHVybnMge29iamVjdH1cclxuICogIEBleGFtcGxlXHJcbiAgICAgICAgdmFyIElQT1NTPVFUb3BvLmluc3RhbmNlWzBdO1xyXG4gICAgICAgIHZhciBqc29uPUlQT1NTLnRvSnNvbigpOyAgICAvL2pzb249e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGluaXQ65Zu+5bGC5Y+C5pWwLHNjZW5l5a+56LGh55qE5Y+C5pWw6YWN572uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIG9wdGlvbjrlm77lsYLlhoXmiYDmnInlr7nosaHnmoTlsZ7mgKfmj5Dlj5bvvIzlj6/nm7TmjqXnlKjkuo5zZXRPcHRpb27ov5jljp8s5YW25LitanNvbklk55So5YGa5q+P5Liq5YWD57Sg55qE5ZSv5LiA5qCH6K+GXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgfVxyXG4gICAgICAgIElQT1NTLnNldE9wdGlvbihqc29uLm9wdGlvbix0cnVlKTtcclxuICovXHJcbmZ1bmN0aW9uIHRvSnNvbigpIHtcclxuICAgIHZhciBkYXRhID0gdGhpcy5zY2VuZS5jaGlsZHJlbjtcclxuICAgIHZhciBzZXJpYWxpemVkID0ge1xyXG4gICAgICAgIGluaXQ6IHRoaXMuc2NlbmUudG9Kc29uKCksXHJcbiAgICAgICAgb3B0aW9uOiB7XHJcbiAgICAgICAgICAgIG5vZGU6IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IFtdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpbms6IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IFtdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbnRhaW5lcjoge1xyXG4gICAgICAgICAgICAgICAgZGF0YTogW11cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGluZToge1xyXG4gICAgICAgICAgICAgICAgZGF0YTogW11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAkLmVhY2goZGF0YSwgZnVuY3Rpb24gKG5hbWUsIGVsZW1lbnRzKSB7XHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShlbGVtZW50cykpIHtcclxuICAgICAgICAgICAgZWxlbWVudHMubWFwKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VyaWFsaXplZC5vcHRpb25bbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXJpYWxpemVkLm9wdGlvbltuYW1lXS5kYXRhLnB1c2goZWxlbWVudC50b0pzb24oKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHNlcmlhbGl6ZWQ7XHJcbn1cclxuZnVuY3Rpb24gaW5pdENhbnZhcyhkb20sIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgIGlmICh3aWR0aCA8PSAwIHx8IGhlaWdodCA8PSAwKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIGRvbSBpcyBub3QgZXhpc3QgL25vdCBjb25maWcgd2lkdGggYW5kIGhlaWdodCFcIik7XHJcbiAgICB9XHJcbiAgICBkb20uc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xyXG4gICAgZG9tLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XHJcbiAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICBkb20uYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgd2lkdGgpO1xyXG4gICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgaGVpZ2h0KTtcclxuICAgIGNhbnZhcy5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcclxuICAgIGNhbnZhcy5zdHlsZS50b3AgPSAwO1xyXG4gICAgY2FudmFzLnN0eWxlLmxlZnQgPSAwO1xyXG4gICAgY2FudmFzLnN0eWxlWyd1c2VyLXNlbGVjdCddID0gJ25vbmUnO1xyXG4gICAgY2FudmFzLnN0eWxlWyctd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3InXSA9ICdyZ2JhKDAsIDAsIDAsIDApJztcclxuICAgIHJldHVybiBjYW52YXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZU5vZGUoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHNldERlZmF1bHRzKHNjZW5lLCBRVG9wby5jb25zdGFudC5ub2RlLCBjb25maWcuc3R5bGUpO1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBub2RlID0gc2NlbmUuY3JlYXRlTm9kZShpdGVtKTtcclxuICAgICAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgICAgICBzZXRFeHRyYShub2RlLCBpdGVtKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vL+aOkumZpOS4tOaXtuWFg+e0oFxyXG5mdW5jdGlvbiBub3RDYXN1YWwoYXJyKSB7XHJcbiAgICBpZiAoYXJyLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyclswXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGFycltpXS5nZXRVc2VUeXBlKCkgIT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICBhcnIgPSBhcnJbaV07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDb250YWluZXIoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIHNldERlZmF1bHRzKHNjZW5lLCBRVG9wby5jb25zdGFudC5jb250YWluZXIsIGNvbmZpZy5zdHlsZSk7XHJcbiAgICAgICAgbWFrZUNvbnRhaW5lcihzY2VuZSwgY29uZmlnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQ29udGFpbmVyKHNjZW5lLCBjb25maWcpIHtcclxuICAgIC8v5pCc57Si5a2Q55qE5oC75qCH6K6wXHJcbiAgICB2YXIgZmluZENoaWxkO1xyXG4gICAgaWYgKGNvbmZpZy5maW5kQ2hpbGRyZW4pIHtcclxuICAgICAgICBmaW5kQ2hpbGQgPSBjb25maWcuZmluZENoaWxkcmVuO1xyXG4gICAgfVxyXG4gICAgaWYgKCQuaXNBcnJheShjb25maWcuZGF0YSkpIHtcclxuICAgICAgICAvL+W8gOWni+aehOmAoOWIhue7hFxyXG4gICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgLy/ml6DorrrmmK/lkKbmnInlrZDlhYPntKDvvIzliIbnu4TlhYjliJvpgKDlh7rmnaVcclxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHNjZW5lLmNyZWF0ZUNvbnRhaW5lcihpdGVtKTtcclxuICAgICAgICAgICAgLy/pop3lpJblsZ7mgKfmt7vliqBcclxuICAgICAgICAgICAgc2V0RXh0cmEoY29udGFpbmVyLCBpdGVtKTtcclxuICAgICAgICAgICAgLy/noa7lrprmn6Xmib7lrZDlhYPntKDnmoTmoIforrBcclxuICAgICAgICAgICAgdmFyIGZpbmRDaGlsZF9leGFjdCA9IGZpbmRDaGlsZDtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uZmluZENoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5kQ2hpbGRfZXhhY3QgPSBpdGVtLmZpbmRDaGlsZHJlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBtYWtlQ2hpbGRyZW4oc2NlbmUsIGNvbnRhaW5lciwgaXRlbSwgZmluZENoaWxkX2V4YWN0KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQ2hpbGRyZW4oc2NlbmUsIGNvbnRhaW5lciwgY29uZmlnLCBmaW5kQ2hpbGQpIHtcclxuICAgIC8v6L+H5ruk5pCc57Si5a2Q57G755qE5qCH6K6wXHJcbiAgICBmaW5kQ2hpbGQgPSBmaWx0ZXJUYWcoZmluZENoaWxkKTtcclxuICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmNoaWxkcmVuKSkge1xyXG4gICAgICAgIHZhciBlcnJvckluZm8gPSBbXTtcclxuICAgICAgICAkLmVhY2goY29uZmlnLmNoaWxkcmVuLCBmdW5jdGlvbiAoaiwgY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gc2NlbmUuZmluZChmaW5kQ2hpbGQgKyBcIj1cIiArIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkICYmIGNoaWxkLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICQuZWFjaChjaGlsZCwgZnVuY3Rpb24gKG0sIG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbmUuZ2V0VXNlVHlwZSgpICE9IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYWRkKG9uZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvckluZm8ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGosXHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoOiBmaW5kQ2hpbGQgKyBcIj1cIiArIGNoaWxkcmVuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChlcnJvckluZm8ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic29tZSBjaGlsZCBub3QgZm91bmQgOiBcIiwgZXJyb3JJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZmlsdGVyVGFnKHRhZykge1xyXG4gICAgaWYgKCF0YWcpIHtcclxuICAgICAgICB0YWcgPSAnanNvbklkJ1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhZztcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlTGluayhzY2VuZSwgY29uZmlnKSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSBjb25maWcucGF0aDtcclxuICAgICAgICB2YXIgZmluZFN0YXJ0O1xyXG4gICAgICAgIHZhciBmaW5kRW5kO1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkocGF0aCkgJiYgcGF0aC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vcGF0aOS4uuaVsOe7hO+8jDDkuLrotbfngrnmnaHku7Yx5Li657uI54K55p2h5Lu2LOehruWumuaQnOe0ouadoeS7tizotbflp4vngrnmnaHku7blj6/kuI3lkIxcclxuICAgICAgICAgICAgaWYgKHBhdGgubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgIGZpbmRFbmQgPSBwYXRoWzBdO1xyXG4gICAgICAgICAgICAgICAgZmluZFN0YXJ0ID0gZmluZEVuZDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZpbmRTdGFydCA9IHBhdGhbMF07XHJcbiAgICAgICAgICAgICAgICBmaW5kRW5kID0gcGF0aFsxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZpbmRTdGFydCA9IGZpbHRlclRhZyhmaW5kU3RhcnQpO1xyXG4gICAgICAgICAgICBmaW5kRW5kID0gZmlsdGVyVGFnKGZpbmRFbmQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+iuvue9rum7mOiupOWxnuaAp1xyXG4gICAgICAgIHNldERlZmF1bHRzKHNjZW5lLCBRVG9wby5jb25zdGFudC5saW5rLCBjb25maWcuc3R5bGUpO1xyXG4gICAgICAgIC8v5byA5aeL5Yib5bu6XHJcbiAgICAgICAgbWFrZUxpbmsoc2NlbmUsIGNvbmZpZywgZmluZFN0YXJ0LCBmaW5kRW5kKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlTGluayhzY2VuZSwgY29uZmlnLCBmaW5kU3RhcnQsIGZpbmRFbmQpIHtcclxuICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgdmFyIGVycm9ySW5mbyA9IFtdO1xyXG4gICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5rO1xyXG4gICAgICAgICAgICAgICAgLy/moLnmja7noa7lrprnmoTmnaHku7bov5vooYzmkJzntKJcclxuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IG5vdENhc3VhbChzY2VuZS5maW5kKGZpbmRTdGFydCArIFwiPVwiICsgaXRlbS5zdGFydCkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IG5vdENhc3VhbChzY2VuZS5maW5kKGZpbmRFbmQgKyBcIj1cIiArIGl0ZW0uZW5kKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgJiYgZW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zdGFydCA9IHN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uZW5kID0gZW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmsgPSBzY2VuZS5hZGRMaW5rKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0RXh0cmEobGluaywgaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvckRhdGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4OiBpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRGF0ZS5taXNzU3RhcnQgPSBpdGVtLnN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvckRhdGUubWlzc0VuZCA9IGl0ZW0uZW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlcnJvckluZm8ucHVzaChlcnJvckRhdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JJbmZvLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4OiBpLFxyXG4gICAgICAgICAgICAgICAgICAgIGluZm86IFwidW5kZWZpbmVkIGRhdGFcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZXJyb3JJbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcInNvbWUgbGluayBpbnZhbGlkIDogXCIsIGVycm9ySW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8v5qC55o2u6YWN572u5Yib5bu657q/5q61XHJcbmZ1bmN0aW9uIGNyZWF0ZUxpbmUoc2NlbmUsIGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgIC8v6K6+572u6buY6K6k5bGe5oCnXHJcbiAgICAgICAgLy/orr7nva7pu5jorqTlsZ7mgKdcclxuICAgICAgICBzZXREZWZhdWx0cyhzY2VuZSwgUVRvcG8uY29uc3RhbnQubGluZSwgY29uZmlnLnN0eWxlKTtcclxuICAgICAgICAvL+W8gOWni+WIm+W7ulxyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoY29uZmlnLmRhdGEpKSB7XHJcbiAgICAgICAgICAgICQuZWFjaChjb25maWcuZGF0YSwgZnVuY3Rpb24gKGksIHYpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gc2NlbmUuY3JlYXRlTGluZSh2KTtcclxuICAgICAgICAgICAgICAgIC8v6aKd5aSW5bGe5oCn5re75YqgXHJcbiAgICAgICAgICAgICAgICBzZXRFeHRyYShsaW5lLCB2KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNhbiBub3QgZHJhdyBsaW5lLG5lZWQgY29uZmlnICdwYXRoJyBhbmQgJ3BhdGgnIGlzIEFycmF5IGFuZCBub3QgZW1wdHkscGF0aCdzIGVsZW1lbnQgbmVlZCBjb25maWcgeCB5LCBwYXRoIHVzZWQgdG8gZmluZCBzdGFydCBhbmQgZW5kXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0FsYXJtKHNjZW5lLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGNvbmZpZy5kYXRhKSAmJiBjb25maWcubm9kZSkge1xyXG4gICAgICAgICAgICB2YXIgYWxhcm1EYXRhID0gY29uZmlnLmRhdGE7XHJcbiAgICAgICAgICAgIHZhciBhbGFybU5vZGVzID0gbWFrZUFsYXJtRGF0YShzY2VuZSwgYWxhcm1EYXRhLCBjb25maWcpO1xyXG4gICAgICAgICAgICBRVG9wby51dGlsLmluZm8oXCLlkYrorabnu5jliLYgOlwiLCB7XHJcbiAgICAgICAgICAgICAgICBjb25maWc6IGFsYXJtRGF0YS5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBhbGFybU5vZGVzLmxlbmd0aFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5hbmltYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBhbGFybUFuaW1hdGUoY29uZmlnLmFuaW1hdGUsIGFsYXJtTm9kZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGFsYXJtTm9kZXMsIGZ1bmN0aW9uIChpLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdi5ub2RlLnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtOiB2LmFsYXJtXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQWxhcm1EYXRhKHNjZW5lLCBhbGFybURhdGEsIGNvbmZpZykge1xyXG4gICAgdmFyIGFsYXJtcyA9IFtdO1xyXG4gICAgJC5lYWNoKGFsYXJtRGF0YSwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IG5vdENhc3VhbChzY2VuZS5maW5kKGNvbmZpZy5ub2RlICsgXCI9XCIgKyB2W1wibm9kZVwiXSwgXCJub2RlXCIpKTtcclxuICAgICAgICBpZiAobm9kZSkge1xyXG4gICAgICAgICAgICBhbGFybXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBub2RlOiBub2RlLFxyXG4gICAgICAgICAgICAgICAgYWxhcm06IHtcclxuICAgICAgICAgICAgICAgICAgICBzaG93OiB0eXBlb2Ygdi5zaG93ID09IFwiYm9vbGVhblwiID8gdi5zaG93IDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB2LnRleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHYuY29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9udDogdi5mb250XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGFsYXJtcztcclxufVxyXG52YXIgYW5pbWF0ZVJ1bmluZztcclxuZnVuY3Rpb24gYWxhcm1BbmltYXRlKGFuaW1hdGUsIGFsYXJtTm9kZXMpIHtcclxuICAgIGlmIChhbmltYXRlKSB7XHJcbiAgICAgICAgaWYgKCQuaXNOdW1lcmljKGFuaW1hdGUudGltZSkpIHtcclxuICAgICAgICAgICAgY2xlYXJBbmltYXQoKTtcclxuICAgICAgICAgICAgUVRvcG8udXRpbC5pbmZvKFwi5ZCv55So5ZGK6K2m5Yqo55S7XCIpO1xyXG4gICAgICAgICAgICBhbmltYXRlUnVuaW5nID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFsYXJtTm9kZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gYWxhcm1Ob2Rlcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUuc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxhcm06IGRhdGEuYWxhcm1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKGFuaW1hdGUuY2FsbEJhY2spKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGUuY2FsbEJhY2soZGF0YS5ub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuaW5mbyhcIuWRiuitpuWKqOeUu+e7k+adn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhckFuaW1hdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBwYXJzZUludChhbmltYXRlLnRpbWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY2xlYXJBbmltYXQoKSB7XHJcbiAgICBpZiAoYW5pbWF0ZVJ1bmluZykge1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwoYW5pbWF0ZVJ1bmluZyk7XHJcbiAgICAgICAgYW5pbWF0ZVJ1bmluZyA9IFwiXCI7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0RXh0cmEoZWxlbWVudCwgZGF0YSkge1xyXG4gICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAkLmVhY2goZGF0YSwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKGZpbHRlckNvbmZpZyhlbGVtZW50LCBrZXkpICYmIFtcInN0YXJ0XCIsIFwiZW5kXCIsIFwiY2hpbGRyZW5cIiwgXCJ0b2dnbGVcIiwgXCJ0eXBlXCIsIFwiZXh0cmFcIl0uaW5kZXhPZihrZXkpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5leHRyYVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZGF0YS5leHRyYSkge1xyXG4gICAgICAgICAgICAkLmVhY2goZGF0YS5leHRyYSwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZXh0cmFba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZmlsdGVyQ29uZmlnKGVsZW1lbnQsIGtleSkge1xyXG4gICAgcmV0dXJuIGVsZW1lbnQgJiYgdHlwZW9mIGVsZW1lbnQuYXR0cltrZXldID09ICd1bmRlZmluZWQnO1xyXG59XHJcbmZ1bmN0aW9uIHNldERlZmF1bHRzKHNjZW5lLCB0eXBlQXJyLCBzdHlsZSkge1xyXG4gICAgaWYgKHN0eWxlKSB7XHJcbiAgICAgICAgJC5lYWNoKHR5cGVBcnIsIGZ1bmN0aW9uIChpLCB0eXBlcykge1xyXG4gICAgICAgICAgICBzY2VuZS5zZXREZWZhdWx0KHR5cGVzLCBzdHlsZSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9kZXZlbG9wL21haW4uanNcbi8vIG1vZHVsZSBpZCA9IDc0XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
},8:function(module,exports){eval('/**\r\n * @module QTopo\r\n */\r\n/**\r\n * @class QTopo\r\n * @static\r\n */\r\n/**\r\n * 定义的通用常量,一般用getType()来区分元素基本类型,getUseType()区分元素具体类型\r\n * @property constant\r\n * @type Object\r\n * @param SCENE {string}\r\n * @param CONTAINER {string}\r\n * @param LINK {string}\r\n * @param LINE {string}\r\n * @param NODE {string}\r\n * @param CASUAL {string} 临时元素，用以元素变换收缩等操作的过渡元素,一般不对其做操作\r\n * @param node.IMAGE {string}\r\n * @param node.TEXT {string}\r\n * @param container.GROUP {string}\r\n * @param link.CURVE {string}\r\n * @param link.DIRECT {string}\r\n * @param link.FLEXIONAL {string}\r\n * @param link.FOLD {string}\r\n * @param line.DIRECT {string}\r\n * @param mode.NORMAL {string}\r\n * @param mode.EDIT {string}\r\n * @param mode.DRAG {string}\r\n * @param mode.SELECT {string}\r\n * @example\r\n *      if(node.getType()==QTopo.constant.NODE){.....}\r\n *      if(node.getUseType()!=QTopo.constant.CASUAL){.....}\r\n *      if(node.getUseType()==QTopo.constant.node.IMAGE){.....}\r\n */\r\nmodule.exports = {\r\n    SCENE:\'10\',\r\n    CONTAINER:"100",\r\n    LINK:"1000",\r\n    LINE:"1100",\r\n    NODE:\'10000\',\r\n    CASUAL:"临时工",//\r\n    node:{\r\n        IMAGE:"10010",\r\n        TEXT:"10001"\r\n    },\r\n    container:{\r\n        GROUP:"101"\r\n    },\r\n    link:{\r\n        CURVE:"1001",\r\n        DIRECT:"1002",\r\n        FLEXIONAL:"1003",\r\n        FOLD:"1004"\r\n    },\r\n    line:{\r\n        DIRECT:"1101"\r\n    },\r\n    mode:{\r\n        NORMAL:"normal",\r\n        EDIT:"edit",\r\n        DRAG:"drag",\r\n        SELECT:"select"\r\n    }\r\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvbnN0YW50LmpzPzhiZDkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixxQkFBcUI7QUFDckIsZ0JBQWdCO0FBQ2hCLGdCQUFnQjtBQUNoQixnQkFBZ0I7QUFDaEIsa0JBQWtCLE9BQU87QUFDekIsc0JBQXNCO0FBQ3RCLHFCQUFxQjtBQUNyQiwyQkFBMkI7QUFDM0Isc0JBQXNCO0FBQ3RCLHVCQUF1QjtBQUN2QiwwQkFBMEI7QUFDMUIscUJBQXFCO0FBQ3JCLHVCQUF1QjtBQUN2Qix1QkFBdUI7QUFDdkIscUJBQXFCO0FBQ3JCLHFCQUFxQjtBQUNyQix1QkFBdUI7QUFDdkI7QUFDQSxnREFBZ0Q7QUFDaEQscURBQXFEO0FBQ3JELHlEQUF5RDtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQG1vZHVsZSBRVG9wb1xyXG4gKi9cclxuLyoqXHJcbiAqIEBjbGFzcyBRVG9wb1xyXG4gKiBAc3RhdGljXHJcbiAqL1xyXG4vKipcclxuICog5a6a5LmJ55qE6YCa55So5bi46YePLOS4gOiIrOeUqGdldFR5cGUoKeadpeWMuuWIhuWFg+e0oOWfuuacrOexu+WeiyxnZXRVc2VUeXBlKCnljLrliIblhYPntKDlhbfkvZPnsbvlnotcclxuICogQHByb3BlcnR5IGNvbnN0YW50XHJcbiAqIEB0eXBlIE9iamVjdFxyXG4gKiBAcGFyYW0gU0NFTkUge3N0cmluZ31cclxuICogQHBhcmFtIENPTlRBSU5FUiB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gTElOSyB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gTElORSB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gTk9ERSB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gQ0FTVUFMIHtzdHJpbmd9IOS4tOaXtuWFg+e0oO+8jOeUqOS7peWFg+e0oOWPmOaNouaUtue8qeetieaTjeS9nOeahOi/h+a4oeWFg+e0oCzkuIDoiKzkuI3lr7nlhbblgZrmk43kvZxcclxuICogQHBhcmFtIG5vZGUuSU1BR0Uge3N0cmluZ31cclxuICogQHBhcmFtIG5vZGUuVEVYVCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gY29udGFpbmVyLkdST1VQIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBsaW5rLkNVUlZFIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBsaW5rLkRJUkVDVCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbGluay5GTEVYSU9OQUwge3N0cmluZ31cclxuICogQHBhcmFtIGxpbmsuRk9MRCB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbGluZS5ESVJFQ1Qge3N0cmluZ31cclxuICogQHBhcmFtIG1vZGUuTk9STUFMIHtzdHJpbmd9XHJcbiAqIEBwYXJhbSBtb2RlLkVESVQge3N0cmluZ31cclxuICogQHBhcmFtIG1vZGUuRFJBRyB7c3RyaW5nfVxyXG4gKiBAcGFyYW0gbW9kZS5TRUxFQ1Qge3N0cmluZ31cclxuICogQGV4YW1wbGVcclxuICogICAgICBpZihub2RlLmdldFR5cGUoKT09UVRvcG8uY29uc3RhbnQuTk9ERSl7Li4uLi59XHJcbiAqICAgICAgaWYobm9kZS5nZXRVc2VUeXBlKCkhPVFUb3BvLmNvbnN0YW50LkNBU1VBTCl7Li4uLi59XHJcbiAqICAgICAgaWYobm9kZS5nZXRVc2VUeXBlKCk9PVFUb3BvLmNvbnN0YW50Lm5vZGUuSU1BR0Upey4uLi4ufVxyXG4gKi9cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBTQ0VORTonMTAnLFxyXG4gICAgQ09OVEFJTkVSOlwiMTAwXCIsXHJcbiAgICBMSU5LOlwiMTAwMFwiLFxyXG4gICAgTElORTpcIjExMDBcIixcclxuICAgIE5PREU6JzEwMDAwJyxcclxuICAgIENBU1VBTDpcIuS4tOaXtuW3pVwiLC8vXHJcbiAgICBub2RlOntcclxuICAgICAgICBJTUFHRTpcIjEwMDEwXCIsXHJcbiAgICAgICAgVEVYVDpcIjEwMDAxXCJcclxuICAgIH0sXHJcbiAgICBjb250YWluZXI6e1xyXG4gICAgICAgIEdST1VQOlwiMTAxXCJcclxuICAgIH0sXHJcbiAgICBsaW5rOntcclxuICAgICAgICBDVVJWRTpcIjEwMDFcIixcclxuICAgICAgICBESVJFQ1Q6XCIxMDAyXCIsXHJcbiAgICAgICAgRkxFWElPTkFMOlwiMTAwM1wiLFxyXG4gICAgICAgIEZPTEQ6XCIxMDA0XCJcclxuICAgIH0sXHJcbiAgICBsaW5lOntcclxuICAgICAgICBESVJFQ1Q6XCIxMTAxXCJcclxuICAgIH0sXHJcbiAgICBtb2RlOntcclxuICAgICAgICBOT1JNQUw6XCJub3JtYWxcIixcclxuICAgICAgICBFRElUOlwiZWRpdFwiLFxyXG4gICAgICAgIERSQUc6XCJkcmFnXCIsXHJcbiAgICAgICAgU0VMRUNUOlwic2VsZWN0XCJcclxuICAgIH1cclxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2RldmVsb3AvY29uc3RhbnQuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sInNvdXJjZVJvb3QiOiIifQ==')},9:function(module,exports,__webpack_require__){eval('/**\r\n * @module core\r\n */\r\n//-\r\nvar Node = {\r\n    Image: __webpack_require__(35),\r\n    Text: __webpack_require__(36)\r\n};\r\nvar Link = {\r\n    Curve: __webpack_require__(31),\r\n    Direct: __webpack_require__(32),\r\n    Flexional: __webpack_require__(33),\r\n    Fold: __webpack_require__(34)\r\n};\r\n\r\nvar Line = {\r\n    Direct: __webpack_require__(29)\r\n};\r\nvar Container = {\r\n    Group: __webpack_require__(28)\r\n};\r\nvar events = __webpack_require__(37);\r\nmodule.exports = Scene;\r\n//-\r\n//画布对象\r\nvar defaults = function () {\r\n    return {\r\n        mode: QTopo.constant.mode.NORMAL,\r\n        backgroundImage: ""\r\n    };\r\n};\r\n/**\r\n * 图层对象\r\n * @class Scene\r\n * @constructor\r\n * @param canvas 绘图所在的canvas标签对象\r\n * @param config 图层的基本设置,参见attr属性\r\n */\r\nfunction Scene(canvas, config) {\r\n    var self = this;\r\n    /**\r\n     * 核心Jtopo对象\r\n     * @property jtopo {Object}\r\n     */\r\n    self.jtopo = new JTopo.Scene();\r\n    self.jtopo.qtopo = self;\r\n    /**\r\n     * 图层中有效记录的元素\r\n     * @property children {object}\r\n     * @param node {array}\r\n     * @param link {array}\r\n     * @param container {array}\r\n     * @param line {array}\r\n     */\r\n    self.children = {\r\n        node: [],\r\n        link: [],\r\n        container: [],\r\n        line: []\r\n    };\r\n    /**\r\n     * 图层的主要属性\r\n     * @property attr {objcet}\r\n     * @param [mode=QTopo.constant.mode.NORMAL],\r\n     * @param [backgroundImage=\'\'],\r\n     * @param [backgroundColor=\'\'],\r\n     */\r\n    self.attr = defaults();\r\n    /**\r\n     * 图层的额外属性\r\n     * @property extra {objcet}\r\n     */\r\n    self.extra = config.extra || {};\r\n    new JTopo.Stage(canvas).add(self.jtopo);\r\n    events.init(self);\r\n    //延时执行\r\n    setTimeout(function () {\r\n        if (config) {\r\n            if (config.backgroundImage) {\r\n                self.setBackgroundImage(config.backgroundImage);\r\n            }\r\n            if (config.backgroundColor) {\r\n                self.setBackgroundColor(config.backgroundColor);\r\n            }\r\n            if (config.mode) {\r\n                self.setMode(config.mode);\r\n            }\r\n        }\r\n    });\r\n}\r\n//-\r\n/**\r\n *  获取图层的基本属性\r\n *  @method get\r\n *  @param key {string} 要获取的属性名\r\n *  @returns {string|object} 属性值\r\n *  @example\r\n *          scene.get(\'mode\')       //"normal"\r\n */\r\nScene.prototype.get = function (key) {\r\n    return this.attr[key];\r\n};\r\n/**\r\n *  获取图层的属性,或添加/修改额外属性\r\n *  @method val\r\n *  @param key {string}\r\n *\r\n *  要操作的属性名,与get不同，该函数会在整个对象中查找与key匹配的属性\r\n *  无论是额外属性还是基本属性又或是Scene.xx属性，只要匹配成功即返回.\r\n *  优先级为 额外属性>基本属性>Scene.xx属性\r\n *\r\n *  用该函数赋予额外属性时，可以直接传入一个对象作为参数\r\n *  该函数会遍历该参数对象将其内容全部覆盖到额外属性上\r\n *\r\n *  @param [value] {string|object} 属性值，若无则函数为获取属性，若有则为修改/添加属性\r\n *  @returns {string|object|void}\r\n *  @example\r\n *\r\n *       赋值操作   1. scene.val(\'pid\',\'12345\')\r\n *                  2. scene.val({\r\n *                          pid:"12345",\r\n *                          path:[]\r\n *                      })\r\n *       取属性操作 scene.val(\'pid\')       //"12345"\r\n *                  scene.val(\'position\') //undefined\r\n *                  scene.val(\'path\')       //[]\r\n *                  scene.val(\'mode\')       //"normal"\r\n */\r\nScene.prototype.val = function (key, value) {\r\n    if (QTopo.util.getClass(key) == \'Object\') {\r\n        var self = this;\r\n        $.each(key, function (name, value) {\r\n            self.extra[name] = value;\r\n        })\r\n    } else {\r\n        if (!value) {\r\n            var result;\r\n            if (this.extra[key]) {\r\n                result = this.extra[key];\r\n            } else if (this.attr[key]) {\r\n                result = this.attr[key];\r\n            } else {\r\n                result = this[key];\r\n            }\r\n            return result;\r\n        } else {\r\n            this.extra[key] = value;\r\n        }\r\n    }\r\n};\r\n/**\r\n *  配置图层中元素全局样式\r\n *  @method setDefault\r\n *  @param type {string} 要配置的元素类型 例：QTopo.constant.node.IMAGE\r\n *  @param config {object} 样式属性，可参考对应的元素attr属性\r\n */\r\nScene.prototype.setDefault = function (type, config) {\r\n    if (config) {\r\n        var constant = QTopo.constant;\r\n        switch (type) {\r\n            case constant.node.IMAGE:\r\n                Node.Image.setDefault(config);\r\n                break;\r\n            case constant.node.TEXT:\r\n                Node.Text.setDefault(config);\r\n                break;\r\n            case constant.link.DIRECT:\r\n                Link.Direct.setDefault(config);\r\n                break;\r\n            case constant.link.CURVE:\r\n                Link.Curve.setDefault(config);\r\n                break;\r\n            case constant.link.FLEXIONAL:\r\n                Link.Flexional.setDefault(config);\r\n                break;\r\n            case constant.link.FOLD:\r\n                Link.Fold.setDefault(config);\r\n                break;\r\n            case constant.line.DIRECT:\r\n                Line.Direct.setDefault(config);\r\n                break;\r\n            case constant.container.GROUP:\r\n                Container.Group.setDefault(config);\r\n                break;\r\n        }\r\n    }\r\n};\r\n/**\r\n *  获取图层中元素全局样式\r\n *  @method getDefault\r\n *  @param type {string} 要配置的元素类型 例：QTopo.constant.node.IMAGE\r\n *  @return {object} 样式属性，可参考对应的元素attr属性\r\n */\r\nScene.prototype.getDefault = function (type) {\r\n    if (type) {\r\n        var result;\r\n        var constant = QTopo.constant;\r\n        switch (type) {\r\n            case constant.node.IMAGE:\r\n                result = Node.Image.getDefault();\r\n                break;\r\n            case constant.node.TEXT:\r\n                result = Node.Text.getDefault();\r\n                break;\r\n            case constant.link.DIRECT:\r\n                result = Link.Direct.getDefault();\r\n                break;\r\n            case constant.link.CURVE:\r\n                result = Link.Curve.getDefault();\r\n                break;\r\n            case constant.link.FLEXIONAL:\r\n                result = Link.Flexional.getDefault();\r\n                break;\r\n            case constant.link.FOLD:\r\n                result = Link.Fold.getDefault();\r\n                break;\r\n            case constant.line.DIRECT:\r\n                result = Line.Direct.getDefault();\r\n                break;\r\n            case constant.container.GROUP:\r\n                result = Container.Group.getDefault();\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n};\r\n/**\r\n *  设置图层背景图片，与setBackgroundColor冲突\r\n *  @method setBackgroundImage\r\n *  @param image {string} 图片url\r\n */\r\nScene.prototype.setBackgroundImage = function (image) {\r\n    this.jtopo.background = image;\r\n    this.attr.background = image;\r\n};\r\n/**\r\n *  设置图层背景颜色，与setBackgroundImage冲突\r\n *  @method setBackgroundColor\r\n *  @param color {string} #xxxxxx/255,255,255\r\n */\r\nScene.prototype.setBackgroundColor = function (color) {\r\n    this.jtopo.backgroundColor = QTopo.util.transHex(color);\r\n    this.jtopo.alpha = 1;\r\n    this.attr.background = QTopo.util.transHex(color);\r\n};\r\n/**\r\n *  设置图层模式\r\n *  @method setMode\r\n *  @param mode {string} 例:QTopo.constant.mode.NORMAL\r\n */\r\nScene.prototype.setMode = function (mode) {\r\n    if (["normal", "edit", "drag", "select"].indexOf(mode) > -1) {\r\n        this.attr.mode = mode;\r\n        this.jtopo.mode = mode;\r\n    } else {\r\n        QTopo.util.error("set wrong mode :", mode);\r\n    }\r\n};\r\n/**\r\n *  图层清空，清除图层内所有元素\r\n *  @method clear\r\n */\r\nScene.prototype.clear = function () {\r\n    QTopo.util.info("scene clear");\r\n    this.children = {\r\n        node: [],\r\n        link: [],\r\n        container: [],\r\n        line: []\r\n    };\r\n    this.jtopo.clear();\r\n};\r\n/**\r\n *  获取类型，常用在右键菜单上对触发对象的识别\r\n *  @method getType\r\n *  @return QTopo.constant.SCENE\r\n */\r\nScene.prototype.getType = function () {\r\n    return QTopo.constant.SCENE;\r\n};\r\n/**\r\n *  获取使用类型，常用在右键菜单上对触发对象的识别\r\n *  @method getUseType\r\n *  @return QTopo.constant.SCENE\r\n */\r\nScene.prototype.getUseType = function () {\r\n    return QTopo.constant.SCENE;\r\n};\r\n/**\r\n *  绑定事件，可用off删除对应事件\r\n *  @method on\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param fn {function} 处理函数\r\n */\r\nScene.prototype.on = function (name, fn) {\r\n    this.jtopo.addEventListener(name, fn);\r\n};\r\n/**\r\n *  删除事件，可删除on绑定的事件\r\n *  @method off\r\n *  @param name {string} 事件名\r\n *\r\n *  click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup\r\n *\r\n *  @param [fn]{function} 处理的函数对象，若无参则删除该事件下所有函数\r\n */\r\nScene.prototype.off = function (name, fn) {\r\n    this.jtopo.removeEventListener(name, fn);\r\n};\r\n/**\r\n *  根据搜索当前图层，查找基本属性或额外属性满足条件的元素\r\n *  @method find\r\n *  @param scan {string} 查询条件,格式为"key=value,key=value",多个条件用,分割\r\n *  @param [type] {string} 可指定元素类型精确查找\r\n *  @return {array} 返回数组，数组成员为满足至少一个条件的元素\r\n */\r\nScene.prototype.find = function (scan, type) {\r\n    var children = this.children;\r\n    var result = [];\r\n    var condition = typeof scan == "string" ? scan.split(",") : [];\r\n    if (condition.length > 0) {\r\n        $.each(condition, function (i, temp) {\r\n            temp = temp.split("=");\r\n            if (temp.length >= 2) {\r\n                //制定了类型，缩小查找范围，未指定则全部遍历\r\n                if (type) {\r\n                    switch (type) {\r\n                        case "node":\r\n                            scanArr(children.node, temp[0], temp[1]);\r\n                            break;\r\n                        case "link":\r\n                            scanArr(children.link, temp[0], temp[1]);\r\n                            break;\r\n                        case "container":\r\n                            scanArr(children.container, temp[0], temp[1]);\r\n                            break;\r\n                        case "line":\r\n                            scanArr(children.line, temp[0], temp[1]);\r\n                            break;\r\n                    }\r\n                } else {\r\n                    $.each(children, function (j, arr) {\r\n                        scanArr(arr, temp[0], temp[1]);\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n    //扫描数组中对象对应的属性是否相等\r\n    function scanArr(arr, key, value) {\r\n        $.each(arr, function (i, item) {\r\n            //只扫描对象的attr和extra中的属性\r\n            if (equal(item.extra, key, value) || equal(item.attr, key, value)) {\r\n                //排除重复的\r\n                if (result.indexOf(item) < 0) {\r\n                    result.push(item);\r\n                }\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    function equal(object, key, value) {\r\n        return object && object[key] && object[key] == value;\r\n    }\r\n};\r\n/**\r\n *  获取当前图层在正常视角下(未放大缩小)最左上角的坐标\r\n *  @method getOrigin\r\n *  @return {object} 包含 x,y属性\r\n */\r\nScene.prototype.getOrigin = function () {\r\n    return {\r\n        x: 0 - this.jtopo.translateX,\r\n        y: 0 - this.jtopo.translateY\r\n    }\r\n};\r\n//-\r\nfunction addJTopo(element) {\r\n    try {\r\n        this.jtopo.add(element.jtopo);\r\n    } catch (e) {\r\n        QTopo.util.error("In Scene, jtopo add error : ", e);\r\n    }\r\n}\r\nfunction removeJTopo(element) {\r\n    try {\r\n        this.jtopo.remove(element.jtopo);\r\n    } catch (e) {\r\n        QTopo.util.error("In Scene, jtopo remove error : ", e);\r\n    }\r\n}\r\n/**\r\n *  根据配置在当前图层上绘制节点\r\n *  @method createNode\r\n *  @param [config] {object}\r\n *\r\n *  无参则根据全局配置绘制QTopo.constant.node.IMAGE对应的节点,\r\n *\r\n *  config.type可指定绘制节点类型\r\n *\r\n *  参考QTopo.contant.node选择可绘制的种类\r\n *  @return {Node|boolean} 创建成功返回节点对象，失败返回false\r\n */\r\nScene.prototype.createNode = function (config) {\r\n    var newNode;\r\n    var constant = QTopo.constant.node;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case constant.TEXT:\r\n            newNode = new Node.Text.constructor(config);\r\n            break;\r\n        default:\r\n            newNode = new Node.Image.constructor(config);\r\n    }\r\n    if (newNode && newNode.jtopo) {\r\n        addJTopo.call(this, newNode);\r\n        this.children.node.push(newNode);\r\n        return newNode;\r\n    } else {\r\n        QTopo.util.error("create Node error", config);\r\n        return false;\r\n    }\r\n};\r\n/**\r\n *  根据配置在两个元素之间绘制新的链接\r\n *  @method createLink\r\n *  @param [config] {object}\r\n *  无参则根据全局配置绘制QTopo.constant.link.DIRECT对应的链接,\r\n *\r\n *  config.type可指定绘制链接类型\r\n *\r\n *  参考QTopo.contant.link选择可绘制的种类\r\n *  @return {Link|boolean} 创建成功返回链接对象，失败返回false\r\n */\r\nScene.prototype.createLink = function (config) {\r\n    var newLink;\r\n    var constant = QTopo.constant.link;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        case constant.CURVE:\r\n            newLink = new Link.Curve.constructor(config);\r\n            break;\r\n        case constant.FLEXIONAL:\r\n            newLink = new Link.Flexional.constructor(config);\r\n            break;\r\n        case constant.FOLD:\r\n            newLink = new Link.Fold.constructor(config);\r\n            break;\r\n        default:\r\n            newLink = new Link.Direct.constructor(config);\r\n    }\r\n    if (newLink && newLink.jtopo) {\r\n        addJTopo.call(this, newLink);\r\n        this.children.link.push(newLink);\r\n        return newLink;\r\n    } else {\r\n        QTopo.util.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\n//--\r\n/**\r\n *  根据配置在两个元素之间创建链接,若两元素已有链接则原链接计数上加1,\r\n *  可操作于有展开功能的链接上，可自适应选择添加新链接或计数+1\r\n *  @method addLink\r\n *  @param config {object} 创建新链接时所依赖的配置，可参考createLink函数\r\n *  @param [fn] {function} 判断两元素间无链接时的可选操作，若无则调用createLink函数建立链接\r\n *  @return {Link|boolean} 创建成功返回链接对象，失败返回false\r\n */\r\nScene.prototype.addLink = function (config, fn) {\r\n    if (config && config.start && config.end) {\r\n        var links = this.linksBetween(config.start, config.end);//按number属性从大到小排列\r\n        if (links.length == 0) {\r\n            if ($.isFunction(fn)) {\r\n                fn();\r\n            } else {\r\n                return this.createLink(config);\r\n            }\r\n        } else {\r\n            //两点之间连线为1则认为是已有链接，超过1则认为是可以展开且已经展开的直线\r\n            var number = 1;\r\n            if ($.isNumeric(config.number)) {\r\n                number = parseInt(config.number);\r\n                if (number < 1) {\r\n                    number = 1;\r\n                }\r\n            }\r\n            if (links.length == 1) {\r\n                links[0].set({\r\n                    number: links[0].attr.number + number\r\n                });\r\n                return links[0];\r\n            } else if (links.length > 1) {\r\n                var parent = links[0].parent;\r\n                if (parent) {\r\n                    parent.attr.number += number;\r\n                    parent.addChild(number);\r\n                }\r\n                return parent;\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n *\r\n *  获取两元素之间所有的链接\r\n *  @method linksBetween\r\n *  @param start {element} 元素，起始无关\r\n *  @param end {element} 元素，起始无关\r\n *  @return {array} 元素间的链接集合，按链接的计数右大到小排列\r\n */\r\nScene.prototype.linksBetween = function (start, end) {\r\n    var result = [];\r\n    var links = start.links;\r\n    //检测两元素间的连线是否已有\r\n    if ($.isArray(links.out)) {\r\n        $.each(links.out, function (i, linkOut) {\r\n            if (linkOut.path.end == end) {\r\n                result.push(linkOut);\r\n            }\r\n        });\r\n    }\r\n    if ($.isArray(links.in)) {\r\n        $.each(links.in, function (j, linkIn) {\r\n            if (linkIn.path.start == end) {\r\n                result.push(linkIn);\r\n            }\r\n        });\r\n    }\r\n    return result.sort(function (a, b) {\r\n        return b.attr.number - a.attr.number;\r\n    });\r\n};\r\n//--\r\n/**\r\n *\r\n *  在图层上绘制不可以移动的线元素\r\n *  @method createLine\r\n *  @param [config] {object} 配置参数,若无则按全局配置创建\r\n *  @return {Line|boolean} 创建成功返回线元素，失败返回false\r\n */\r\nScene.prototype.createLine = function (config) {\r\n    var newLine;\r\n    var constant = QTopo.constant.line;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newLine = new Line.Direct.constructor(config);\r\n    }\r\n    if (newLine && newLine.jtopo) {\r\n        addJTopo.call(this, newLine);\r\n        this.children.line.push(newLine);\r\n        return newLine;\r\n    } else {\r\n        QTopo.util.error("create Link error", config);\r\n        return false;\r\n    }\r\n};\r\n//--\r\n/**\r\n *\r\n *  在图层上绘制分组元素\r\n *  @method createContainer\r\n *  @param [config] {object} 配置参数,若无则按全局配置创建\r\n *  @return {container|boolean} 创建成功返回线元素，失败返回false\r\n */\r\nScene.prototype.createContainer = function (config) {\r\n    var newContainer;\r\n    var constant = QTopo.constant.container;\r\n    config = config || {};\r\n    switch (config.type) {\r\n        default:\r\n            newContainer = new Container.Group.constructor(config);\r\n    }\r\n    if (newContainer && newContainer.jtopo) {\r\n        //分组只加入其本身，切换节点不作数\r\n        var nodeConfig = {};\r\n        if (config.toggle) {\r\n            nodeConfig = config.toggle\r\n        }\r\n        //可选禁用分组切换\r\n        if (!(config.toggle && typeof config.toggle.close == "boolean" && config.toggle.close)) {\r\n            addToggle(this, newContainer, nodeConfig);\r\n        }\r\n        this.children.container.push(newContainer);\r\n        addJTopo.call(this, newContainer);\r\n        return newContainer;\r\n    } else {\r\n        QTopo.util.error("create Container error", config);\r\n        return false;\r\n    }\r\n};\r\nfunction addToggle(scene, container, configToggle) {\r\n    configToggle.useType = QTopo.constant.CASUAL;//标记用途\r\n    container.toggleTo = new Node.Image.constructor(configToggle);\r\n    container.toggleTo.toggleTo = container;//互相索引\r\n    container.toggleTo.hide();//初始隐藏\r\n    addJTopo.call(scene, container.toggleTo);//加入画布\r\n}\r\n//--\r\n//-\r\n/**\r\n *\r\n *  删除图层内元素,元素删除其上的链接也会删除和更新\r\n *  @method remove\r\n *  @param element {element}\r\n */\r\nScene.prototype.remove = function (element) {\r\n    var self = this;\r\n    if (element) {\r\n        if ($.isArray(element)) {\r\n            $.each(element, function (i, item) {\r\n                removeOnce(item);\r\n            });\r\n        } else {\r\n            removeOnce(element);\r\n        }\r\n        function removeOnce(oneElement) {\r\n            if (oneElement.jtopo) {\r\n                switch (oneElement.getType()) {\r\n                    case QTopo.constant.NODE:\r\n                        if (QTopo.util.arrayDelete(self.children.node, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeNode.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.LINK:\r\n                        if (QTopo.util.arrayDelete(self.children.link, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeLink.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.LINE:\r\n                        if (QTopo.util.arrayDelete(self.children.line, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeLine.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                    case QTopo.constant.CONTAINER:\r\n                        if (QTopo.util.arrayDelete(self.children.container, oneElement) || oneElement.getUseType() == QTopo.constant.CASUAL) {\r\n                            removeContainer.call(self, oneElement);\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nfunction upDataLinks(element) {\r\n    var links = element.links;\r\n    if (links) {\r\n        //更新其上连线的另一方的links属性\r\n        while (links.in.length > 0) {\r\n            this.remove(links.in.pop());\r\n        }\r\n        while (links.out.length > 0) {\r\n            this.remove(links.out.pop());\r\n        }\r\n    }\r\n}\r\n//线上删除时候,要更新node和container中的links属性\r\nfunction removeLink(link) {\r\n    try {\r\n        QTopo.util.arrayDelete(link.path.start.links.out, link);\r\n        QTopo.util.arrayDelete(link.path.end.links.in, link);\r\n        removeJTopo.call(this, link);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeLink error", e);\r\n    }\r\n}\r\nfunction removeLine(line) {\r\n    try {\r\n        removeJTopo.call(this, line);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeLine error", e);\r\n    }\r\n}\r\nfunction removeNode(node) {\r\n    //刷新一下现有的线\r\n    try {\r\n        //更新其上线另一头的links属性\r\n        upDataLinks.call(this, node);\r\n        //要更新其父的children属性,父删除子\r\n        if (node.parent && $.isArray(node.parent.children)) {\r\n            node.parent.remove(node);\r\n        }\r\n        //删除分组切换的节点时同时删除其切换的分组\r\n        if (node.toggleTo) {\r\n            //分组若隐藏了,应该展示\r\n            node.toggleTo.toggle();\r\n            this.remove(node.toggleTo);\r\n        }\r\n        removeJTopo.call(this, node);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeNode error", e);\r\n    }\r\n}\r\n//容器删除时,要更与其相连的线的另一端的links属性,要更新其子类的parent属性\r\nfunction removeContainer(container) {\r\n    try {\r\n        //分组若隐藏了,应该展示\r\n        container.toggle(true);\r\n        //更新其上线另一头的links属性\r\n        upDataLinks.call(this, container);\r\n        //更新子元素的Parent属性\r\n        if ($.isArray(container.children) && container.children.length > 0) {\r\n            for (var i = 0; i < container.children.length; i++) {\r\n                container.children[i].parent = null;\r\n            }\r\n        }\r\n        //删除分组同时删除其切换节点\r\n        if (container.toggleTo) {\r\n            this.remove(container.toggleTo);\r\n        }\r\n        removeJTopo.call(this, container);\r\n    } catch (e) {\r\n        QTopo.util.error("Scene removeContainer error", e);\r\n    }\r\n}\r\n//-\r\n/**\r\n *\r\n *  图层信息转化为json\r\n *  @method toJson\r\n *  @return {object}\r\n */\r\nScene.prototype.toJson = function () {\r\n    var json = $.extend({}, this.attr);\r\n    json.extra = $.extend({}, this.extra);\r\n    return json;\r\n};\r\n/**\r\n *\r\n *  判断元素是否在当前图层内\r\n *  @method isChildren\r\n *  @param element {element}\r\n *  @return {boolean}\r\n */\r\nScene.prototype.isChildren = function (element) {\r\n    var result = false;\r\n    if (element.jtopo) {\r\n        $.each(this.children, function (name, arr) {\r\n            if (arr.indexOf(element) > -1) {\r\n                result = true;\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n};\r\n/**\r\n *\r\n * 图层缩放,元素一屏显示\r\n *  @method goCenter\r\n */\r\nScene.prototype.goCenter = function () {\r\n    if (this.jtopo.childs && this.jtopo.childs.length > 0) {\r\n        this.jtopo.stage.centerAndZoom();\r\n    }\r\n};\r\n/**\r\n *\r\n * 图层缩放\r\n *  @method resize\r\n *  @param size {number} 根据比例放大或缩小 参数可 0-1缩小 1-n放大\r\n */\r\nScene.prototype.resize = function (size) {\r\n    if ($.isNumeric(size)) {\r\n        this.jtopo.scaleX = size;\r\n        this.jtopo.scaleY = size;\r\n    }\r\n};\r\n/**\r\n *\r\n * 启用/禁用鼠标缩放\r\n *  @method toggleZoom\r\n */\r\nScene.prototype.toggleZoom = function () {\r\n    if (!this.jtopo.stage.wheelZoom) {\r\n        this.jtopo.stage.wheelZoom = 0.85; // 设置鼠标缩放比例\r\n    } else {\r\n        this.jtopo.stage.wheelZoom = null;\r\n    }\r\n};\r\n/**\r\n *\r\n * 启用/禁用鹰眼\r\n *  @method toggleEagleEye\r\n */\r\nScene.prototype.toggleEagleEye = function () {\r\n    this.jtopo.stage.eagleEye.visible = !this.jtopo.stage.eagleEye.visible;\r\n};\r\n/**\r\n *\r\n * 获取当前图层的png格式图片在新的窗口打开\r\n *  @method getPicture\r\n */\r\nScene.prototype.getPicture = function () {\r\n    //stage.saveImageInfo();\r\n    //在新页面打开图片\r\n    var image = this.jtopo.stage.canvas.toDataURL("image/png");\r\n    var w = window.open(\'about:blank\', \'image from canvas\');\r\n    w.document.write("<img src=\'" + image + "\' alt=\'from canvas\'/>");\r\n    //下载图片\r\n    // here is the most important part because if you dont replace you will get a DOM 18 exception.\r\n    // var image =  stage.canvas.toDataURL("image/png").replace("image/png", "image/octet-stream;Content-Disposition: attachment;filename=foobar.png");\r\n    //var image = stage.canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");\r\n    //window.location.href=image; // it will save locally\r\n};\r\n/**\r\n * 切换元素的层次\r\n * @method toggleZIndex\r\n * @param element 待控制元素\r\n * @param [flag] true为降低false为提升，无参则默认提升，若已提升到最高则降至最低\r\n */\r\nScene.prototype.toggleZIndex = function (element, flag) {\r\n    if (element) {\r\n        var jtopo = element.jtopo;\r\n        var scene = this.jtopo;\r\n        if (jtopo && scene) {\r\n            var map = scene.zIndexMap[jtopo.zIndex];\r\n            var index = map.indexOf(jtopo);\r\n            var todo = true;\r\n            if (typeof flag == \'boolean\') {\r\n                todo = flag;\r\n            } else {\r\n                if (index == map.length - 1) {\r\n                    todo = false;\r\n                }\r\n            }\r\n            if (todo) {\r\n                //提升层次\r\n                map.push(map[index]);\r\n                map.splice(index, 1);\r\n\r\n            } else {\r\n                //降低层次\r\n                map.splice(0, 0, map[index]);\r\n                map.splice(index + 1, 1);\r\n            }\r\n        }\r\n    }\r\n};\r\nvar selectedCatch = {\r\n    jtopo: [],\r\n    qtopo: []\r\n};\r\n/**\r\n * 获取被选中的元素\r\n * @method getSelected\r\n * @return {array} 返回图层中被选中的元素\r\n */\r\nScene.prototype.getSelected = function () {\r\n    var jtopo = this.jtopo.selectedElements;\r\n    if ($.isArray(jtopo)) {\r\n        if (selectedCatch.jtopo != jtopo) {\r\n            selectedCatch.jtopo = jtopo;\r\n            selectedCatch.qtopo = [];\r\n            jtopo.forEach(function (el) {\r\n                if (el.qtopo && el.qtopo.getUseType() != QTopo.constant.CASUAL) {\r\n                    selectedCatch.qtopo.push(el.qtopo);\r\n                }\r\n            });\r\n        }\r\n        return selectedCatch.qtopo;\r\n    } else {\r\n        return [];\r\n    }\r\n};\r\n/**\r\n * 高亮目标隐藏其他\r\n * @method toggleLight\r\n * @param [target] 数组或对象,高亮其相关对象,无参则全部高亮\r\n * @param [flag] 若为true则只高亮传入的对象,不选则只对传入对象相关的对象高亮\r\n */\r\nScene.prototype.toggleLight = function (target, flag) {\r\n    try {\r\n        var alpha = 1;\r\n        var lighting;\r\n        if (target) {\r\n            alpha = 0.1;\r\n            if (flag) {\r\n                if ($.isArray(target)) {\r\n                    lighting = target;\r\n                } else {\r\n                    lighting = [target];\r\n                }\r\n            } else {\r\n                if ($.isArray(target)) {\r\n                    lighting = getConnectionLightings(target);\r\n                } else {\r\n                    lighting = getConnectionLightings([target]);\r\n                }\r\n            }\r\n        }\r\n        totalSetAlpha(this.children.node.concat(this.children.link), alpha);\r\n        totalSetAlpha(lighting, 1);\r\n    } catch (e) {\r\n        QTopo.util.error("scene toggleLight error", e);\r\n    }\r\n    function getConnectionLightings(arr) {\r\n        var lighting = [];\r\n        $.each(arr, function (i, target) {\r\n            if (target.getType() == QTopo.constant.NODE && target.getUseType() != QTopo.constant.CASUAL) {\r\n                var links = target.links;\r\n                QTopo.util.arrayPush(lighting, target);\r\n                if (links) {\r\n                    if ($.isArray(links.out)) {\r\n                        $.each(links.out, function (l, outlink) {\r\n                            QTopo.util.arrayPush(lighting, outlink);\r\n                            QTopo.util.arrayPush(lighting, outlink.path.end);\r\n                        });\r\n                    }\r\n                    if ($.isArray(links.in)) {\r\n                        $.each(links.in, function (n, inlink) {\r\n                            QTopo.util.arrayPush(lighting, inlink);\r\n                            QTopo.util.arrayPush(lighting, inlink.path.start);\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return lighting;\r\n    }\r\n\r\n    function totalSetAlpha(total, alpha) {\r\n        //全部隐藏\r\n        if ($.isArray(total)) {\r\n            $.each(total, function (i, element) {\r\n                element.set({\r\n                    alpha: alpha\r\n                });\r\n            });\r\n        }\r\n    }\r\n};\r\n/**\r\n * 正常尺寸展示，并将视角移动到以参数节点为中心的位置\r\n * @method moveToNode\r\n * @param node 节点对象\r\n */\r\nScene.prototype.moveToNode = function (node) {\r\n    // 查询到的节点居中显示\r\n    if (this.children.node.indexOf(node) > -1) {\r\n        var location = node.jtopo.getCenterLocation();\r\n        this.resize(1);\r\n        this.jtopo.setCenter(location.x, location.y);\r\n        // 闪烁几下\r\n        nodeFlash(node.jtopo, 5);\r\n    }\r\n    function nodeFlash(node, num) {\r\n        if ($.isNumeric(num)) {\r\n            if (num == 0) {\r\n                node.selected = false;\r\n            } else {\r\n                node.selected = !node.selected;\r\n                setTimeout(function () {\r\n                    nodeFlash(node, num - 1);\r\n                }, 300);\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n * 自动布局\r\n * @method autoLayout\r\n * @param config 自动布局配置参数\r\n * @example\r\n *      参数配置:\r\n *          config:{\r\n *              type:\r\n *                  1.\'round\'   无需其他配置\r\n *                  2.\'default\' 需配置行数，列间距，行间距\r\n *              rows:行数\r\n *              rowSpace:行间距\r\n *              columnSpace:列间距\r\n *          }\r\n */\r\nScene.prototype.autoLayout = function (config) {\r\n    if (config && config.type) {\r\n        var needSort = [];\r\n        var jtopos = [];\r\n        this.children.node.forEach(function (v) {\r\n            if (!v.parent) {\r\n                needSort.push(v);\r\n                jtopos.push(v.jtopo);\r\n            }\r\n        });\r\n        switch (config.type) {\r\n            case "round":\r\n                layout_round(this.jtopo, jtopos);\r\n                break;\r\n            case "default":\r\n                layout_default(needSort, parseInt(config.rows), parseInt(config.rowSpace), parseInt(config.columnSpace), this.getOrigin());\r\n                break;\r\n        }\r\n    }\r\n};\r\nfunction layout_round(scene, jtopos) {\r\n    JTopo.layout.circleLayoutNodes(jtopos, {animate: {time: 1000}});\r\n}\r\nfunction layout_default(elements, rows, rowSpace, columnSpace, begin) {\r\n    if ($.isNumeric(rows)) {\r\n        rows = parseInt(rows);\r\n        if (rows < 1) {\r\n            rows = 1;\r\n        }\r\n        $.each(elements.sort(function (a, b) {\r\n            return getDegree(b) - getDegree(a);\r\n        }), function (i, v) {\r\n            //v.setLocation(begin.x + (i % rows) * columnSpace, begin.y);\r\n            move(v, begin.x + (i % rows) * columnSpace, begin.y);\r\n            if ((i + 1) % rows == 0) {\r\n                begin.y += rowSpace;\r\n            }\r\n        });\r\n    }\r\n}\r\n//-------工具函数\r\n//获取节点的度\r\nfunction getDegree(node) {\r\n    var inLinks = node.links.in;\r\n    var outLinks = node.links.out;\r\n    var degree = 0;\r\n    if (inLinks.length == 1) {\r\n        degree += inLinks[0].attr.number;\r\n    } else {\r\n        degree += inLinks.length;\r\n    }\r\n    if (outLinks.length == 1) {\r\n        degree += outLinks[0].attr.number;\r\n    } else {\r\n        degree += outLinks.length;\r\n    }\r\n    return degree;\r\n}\r\n//移动动画\r\nfunction move(node, targetX, targetY) {\r\n    targetX = parseInt(targetX);\r\n    targetY = parseInt(targetY);\r\n    var x = node.attr.position[0];\r\n    var y = node.attr.position[1];\r\n    var partX = parseInt((targetX - x)) / 10;\r\n    var partY = parseInt((targetY - y)) / 10;\r\n    var part = 0;\r\n    var temp = setInterval(function () {\r\n        if (Math.abs(targetX - x) > 1) {\r\n            x += partX;\r\n        }\r\n        if (Math.abs(targetY - y) > 1) {\r\n            y += partY;\r\n        }\r\n        node.setPosition([parseInt(x), parseInt(y)]);\r\n        part++;\r\n        if (Math.abs(targetX - x) <= 1 && Math.abs(targetY - y) <= 1) {\r\n            clearInterval(temp);\r\n        } else if (part >= 10) {\r\n            clearInterval(temp);\r\n        }\r\n    }, 100);\r\n}\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvcmUvU2NlbmUuanM/OWVjOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG9CQUFvQjtBQUNwQixvQkFBb0I7QUFDcEIseUJBQXlCO0FBQ3pCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE9BQU87QUFDdkIsY0FBYyxjQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGNBQWM7QUFDbEMsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEIsbUJBQW1CLE9BQU87QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEIsbUJBQW1CLE9BQU87QUFDMUIsYUFBYSxNQUFNO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxhQUFhO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLE9BQU87QUFDMUIsaUJBQWlCLFNBQVM7QUFDMUIsYUFBYSxhQUFhO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRTtBQUNoRTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsUUFBUTtBQUMxQixnQkFBZ0IsUUFBUTtBQUN4QixhQUFhLE1BQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsT0FBTztBQUM1QixhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLE9BQU87QUFDNUIsYUFBYSxrQkFBa0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRDtBQUNqRDtBQUNBLDRDQUE0QztBQUM1Qyw4QkFBOEI7QUFDOUIsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwrQkFBK0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUIsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpR0FBaUcsZ0NBQWdDO0FBQ2pJO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksTUFBTTtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxVQUFVLFlBQVk7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0wiLCJmaWxlIjoiOS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIGNvcmVcclxuICovXHJcbi8vLVxyXG52YXIgTm9kZSA9IHtcclxuICAgIEltYWdlOiByZXF1aXJlKFwiLi9lbGVtZW50L25vZGUvSW1hZ2UuanNcIiksXHJcbiAgICBUZXh0OiByZXF1aXJlKFwiLi9lbGVtZW50L25vZGUvVGV4dC5qc1wiKVxyXG59O1xyXG52YXIgTGluayA9IHtcclxuICAgIEN1cnZlOiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvQ3VydmUuanNcIiksXHJcbiAgICBEaXJlY3Q6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluay9EaXJlY3QuanNcIiksXHJcbiAgICBGbGV4aW9uYWw6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluay9GbGV4aW9uYWwuanNcIiksXHJcbiAgICBGb2xkOiByZXF1aXJlKFwiLi9lbGVtZW50L2xpbmsvRm9sZC5qc1wiKVxyXG59O1xyXG5cclxudmFyIExpbmUgPSB7XHJcbiAgICBEaXJlY3Q6IHJlcXVpcmUoXCIuL2VsZW1lbnQvbGluZS9EaXJlY3QuanNcIilcclxufTtcclxudmFyIENvbnRhaW5lciA9IHtcclxuICAgIEdyb3VwOiByZXF1aXJlKFwiLi9lbGVtZW50L2NvbnRhaW5lci9Hcm91cC5qc1wiKVxyXG59O1xyXG52YXIgZXZlbnRzID0gcmVxdWlyZShcIi4vZXZlbnRzLmpzXCIpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IFNjZW5lO1xyXG4vLy1cclxuLy/nlLvluIPlr7nosaFcclxudmFyIGRlZmF1bHRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBtb2RlOiBRVG9wby5jb25zdGFudC5tb2RlLk5PUk1BTCxcclxuICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6IFwiXCJcclxuICAgIH07XHJcbn07XHJcbi8qKlxyXG4gKiDlm77lsYLlr7nosaFcclxuICogQGNsYXNzIFNjZW5lXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAcGFyYW0gY2FudmFzIOe7mOWbvuaJgOWcqOeahGNhbnZhc+agh+etvuWvueixoVxyXG4gKiBAcGFyYW0gY29uZmlnIOWbvuWxgueahOWfuuacrOiuvue9rizlj4Lop4FhdHRy5bGe5oCnXHJcbiAqL1xyXG5mdW5jdGlvbiBTY2VuZShjYW52YXMsIGNvbmZpZykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmoLjlv4NKdG9wb+WvueixoVxyXG4gICAgICogQHByb3BlcnR5IGp0b3BvIHtPYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHNlbGYuanRvcG8gPSBuZXcgSlRvcG8uU2NlbmUoKTtcclxuICAgIHNlbGYuanRvcG8ucXRvcG8gPSBzZWxmO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlm77lsYLkuK3mnInmlYjorrDlvZXnmoTlhYPntKBcclxuICAgICAqIEBwcm9wZXJ0eSBjaGlsZHJlbiB7b2JqZWN0fVxyXG4gICAgICogQHBhcmFtIG5vZGUge2FycmF5fVxyXG4gICAgICogQHBhcmFtIGxpbmsge2FycmF5fVxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lciB7YXJyYXl9XHJcbiAgICAgKiBAcGFyYW0gbGluZSB7YXJyYXl9XHJcbiAgICAgKi9cclxuICAgIHNlbGYuY2hpbGRyZW4gPSB7XHJcbiAgICAgICAgbm9kZTogW10sXHJcbiAgICAgICAgbGluazogW10sXHJcbiAgICAgICAgY29udGFpbmVyOiBbXSxcclxuICAgICAgICBsaW5lOiBbXVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Zu+5bGC55qE5Li76KaB5bGe5oCnXHJcbiAgICAgKiBAcHJvcGVydHkgYXR0ciB7b2JqY2V0fVxyXG4gICAgICogQHBhcmFtIFttb2RlPVFUb3BvLmNvbnN0YW50Lm1vZGUuTk9STUFMXSxcclxuICAgICAqIEBwYXJhbSBbYmFja2dyb3VuZEltYWdlPScnXSxcclxuICAgICAqIEBwYXJhbSBbYmFja2dyb3VuZENvbG9yPScnXSxcclxuICAgICAqL1xyXG4gICAgc2VsZi5hdHRyID0gZGVmYXVsdHMoKTtcclxuICAgIC8qKlxyXG4gICAgICog5Zu+5bGC55qE6aKd5aSW5bGe5oCnXHJcbiAgICAgKiBAcHJvcGVydHkgZXh0cmEge29iamNldH1cclxuICAgICAqL1xyXG4gICAgc2VsZi5leHRyYSA9IGNvbmZpZy5leHRyYSB8fCB7fTtcclxuICAgIG5ldyBKVG9wby5TdGFnZShjYW52YXMpLmFkZChzZWxmLmp0b3BvKTtcclxuICAgIGV2ZW50cy5pbml0KHNlbGYpO1xyXG4gICAgLy/lu7bml7bmiafooYxcclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5iYWNrZ3JvdW5kSW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0QmFja2dyb3VuZEltYWdlKGNvbmZpZy5iYWNrZ3JvdW5kSW1hZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb25maWcuYmFja2dyb3VuZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNldEJhY2tncm91bmRDb2xvcihjb25maWcuYmFja2dyb3VuZENvbG9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29uZmlnLm1vZGUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0TW9kZShjb25maWcubW9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4vLy1cclxuLyoqXHJcbiAqICDojrflj5blm77lsYLnmoTln7rmnKzlsZ7mgKdcclxuICogIEBtZXRob2QgZ2V0XHJcbiAqICBAcGFyYW0ga2V5IHtzdHJpbmd9IOimgeiOt+WPlueahOWxnuaAp+WQjVxyXG4gKiAgQHJldHVybnMge3N0cmluZ3xvYmplY3R9IOWxnuaAp+WAvFxyXG4gKiAgQGV4YW1wbGVcclxuICogICAgICAgICAgc2NlbmUuZ2V0KCdtb2RlJykgICAgICAgLy9cIm5vcm1hbFwiXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgcmV0dXJuIHRoaXMuYXR0cltrZXldO1xyXG59O1xyXG4vKipcclxuICogIOiOt+WPluWbvuWxgueahOWxnuaApyzmiJbmt7vliqAv5L+u5pS56aKd5aSW5bGe5oCnXHJcbiAqICBAbWV0aG9kIHZhbFxyXG4gKiAgQHBhcmFtIGtleSB7c3RyaW5nfVxyXG4gKlxyXG4gKiAg6KaB5pON5L2c55qE5bGe5oCn5ZCNLOS4jmdldOS4jeWQjO+8jOivpeWHveaVsOS8muWcqOaVtOS4quWvueixoeS4reafpeaJvuS4jmtleeWMuemFjeeahOWxnuaAp1xyXG4gKiAg5peg6K665piv6aKd5aSW5bGe5oCn6L+Y5piv5Z+65pys5bGe5oCn5Y+I5oiW5pivU2NlbmUueHjlsZ7mgKfvvIzlj6ropoHljLnphY3miJDlip/ljbPov5Tlm54uXHJcbiAqICDkvJjlhYjnuqfkuLog6aKd5aSW5bGe5oCnPuWfuuacrOWxnuaApz5TY2VuZS54eOWxnuaAp1xyXG4gKlxyXG4gKiAg55So6K+l5Ye95pWw6LWL5LqI6aKd5aSW5bGe5oCn5pe277yM5Y+v5Lul55u05o6l5Lyg5YWl5LiA5Liq5a+56LGh5L2c5Li65Y+C5pWwXHJcbiAqICDor6Xlh73mlbDkvJrpgY3ljobor6Xlj4LmlbDlr7nosaHlsIblhbblhoXlrrnlhajpg6jopobnm5bliLDpop3lpJblsZ7mgKfkuIpcclxuICpcclxuICogIEBwYXJhbSBbdmFsdWVdIHtzdHJpbmd8b2JqZWN0fSDlsZ7mgKflgLzvvIzoi6Xml6DliJnlh73mlbDkuLrojrflj5blsZ7mgKfvvIzoi6XmnInliJnkuLrkv67mlLkv5re75Yqg5bGe5oCnXHJcbiAqICBAcmV0dXJucyB7c3RyaW5nfG9iamVjdHx2b2lkfVxyXG4gKiAgQGV4YW1wbGVcclxuICpcclxuICogICAgICAg6LWL5YC85pON5L2cICAgMS4gc2NlbmUudmFsKCdwaWQnLCcxMjM0NScpXHJcbiAqICAgICAgICAgICAgICAgICAgMi4gc2NlbmUudmFsKHtcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHBpZDpcIjEyMzQ1XCIsXHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOltdXHJcbiAqICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAqICAgICAgIOWPluWxnuaAp+aTjeS9nCBzY2VuZS52YWwoJ3BpZCcpICAgICAgIC8vXCIxMjM0NVwiXHJcbiAqICAgICAgICAgICAgICAgICAgc2NlbmUudmFsKCdwb3NpdGlvbicpIC8vdW5kZWZpbmVkXHJcbiAqICAgICAgICAgICAgICAgICAgc2NlbmUudmFsKCdwYXRoJykgICAgICAgLy9bXVxyXG4gKiAgICAgICAgICAgICAgICAgIHNjZW5lLnZhbCgnbW9kZScpICAgICAgIC8vXCJub3JtYWxcIlxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnZhbCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICBpZiAoUVRvcG8udXRpbC5nZXRDbGFzcyhrZXkpID09ICdPYmplY3QnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICQuZWFjaChrZXksIGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBzZWxmLmV4dHJhW25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgfSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5leHRyYVtrZXldKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmV4dHJhW2tleV07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hdHRyW2tleV0pIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuYXR0cltrZXldO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5leHRyYVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogIOmFjee9ruWbvuWxguS4reWFg+e0oOWFqOWxgOagt+W8j1xyXG4gKiAgQG1ldGhvZCBzZXREZWZhdWx0XHJcbiAqICBAcGFyYW0gdHlwZSB7c3RyaW5nfSDopoHphY3nva7nmoTlhYPntKDnsbvlnosg5L6L77yaUVRvcG8uY29uc3RhbnQubm9kZS5JTUFHRVxyXG4gKiAgQHBhcmFtIGNvbmZpZyB7b2JqZWN0fSDmoLflvI/lsZ7mgKfvvIzlj6/lj4LogIPlr7nlupTnmoTlhYPntKBhdHRy5bGe5oCnXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuc2V0RGVmYXVsdCA9IGZ1bmN0aW9uICh0eXBlLCBjb25maWcpIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudDtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLklNQUdFOlxyXG4gICAgICAgICAgICAgICAgTm9kZS5JbWFnZS5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLlRFWFQ6XHJcbiAgICAgICAgICAgICAgICBOb2RlLlRleHQuc2V0RGVmYXVsdChjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5ESVJFQ1Q6XHJcbiAgICAgICAgICAgICAgICBMaW5rLkRpcmVjdC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkNVUlZFOlxyXG4gICAgICAgICAgICAgICAgTGluay5DdXJ2ZS5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkZMRVhJT05BTDpcclxuICAgICAgICAgICAgICAgIExpbmsuRmxleGlvbmFsLnNldERlZmF1bHQoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmxpbmsuRk9MRDpcclxuICAgICAgICAgICAgICAgIExpbmsuRm9sZC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5lLkRJUkVDVDpcclxuICAgICAgICAgICAgICAgIExpbmUuRGlyZWN0LnNldERlZmF1bHQoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmNvbnRhaW5lci5HUk9VUDpcclxuICAgICAgICAgICAgICAgIENvbnRhaW5lci5Hcm91cC5zZXREZWZhdWx0KGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg6I635Y+W5Zu+5bGC5Lit5YWD57Sg5YWo5bGA5qC35byPXHJcbiAqICBAbWV0aG9kIGdldERlZmF1bHRcclxuICogIEBwYXJhbSB0eXBlIHtzdHJpbmd9IOimgemFjee9rueahOWFg+e0oOexu+WeiyDkvovvvJpRVG9wby5jb25zdGFudC5ub2RlLklNQUdFXHJcbiAqICBAcmV0dXJuIHtvYmplY3R9IOagt+W8j+WxnuaAp++8jOWPr+WPguiAg+WvueW6lOeahOWFg+e0oGF0dHLlsZ7mgKdcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nZXREZWZhdWx0ID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgIGlmICh0eXBlKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudDtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLklNQUdFOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTm9kZS5JbWFnZS5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5ub2RlLlRFWFQ6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBOb2RlLlRleHQuZ2V0RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnQubGluay5ESVJFQ1Q6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBMaW5rLkRpcmVjdC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkNVUlZFOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTGluay5DdXJ2ZS5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5rLkZMRVhJT05BTDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IExpbmsuRmxleGlvbmFsLmdldERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmxpbmsuRk9MRDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IExpbmsuRm9sZC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjb25zdGFudC5saW5lLkRJUkVDVDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IExpbmUuRGlyZWN0LmdldERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50LmNvbnRhaW5lci5HUk9VUDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IENvbnRhaW5lci5Hcm91cC5nZXREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDorr7nva7lm77lsYLog4zmma/lm77niYfvvIzkuI5zZXRCYWNrZ3JvdW5kQ29sb3LlhrLnqoFcclxuICogIEBtZXRob2Qgc2V0QmFja2dyb3VuZEltYWdlXHJcbiAqICBAcGFyYW0gaW1hZ2Uge3N0cmluZ30g5Zu+54mHdXJsXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuc2V0QmFja2dyb3VuZEltYWdlID0gZnVuY3Rpb24gKGltYWdlKSB7XHJcbiAgICB0aGlzLmp0b3BvLmJhY2tncm91bmQgPSBpbWFnZTtcclxuICAgIHRoaXMuYXR0ci5iYWNrZ3JvdW5kID0gaW1hZ2U7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5Zu+5bGC6IOM5pmv6aKc6Imy77yM5LiOc2V0QmFja2dyb3VuZEltYWdl5Yay56qBXHJcbiAqICBAbWV0aG9kIHNldEJhY2tncm91bmRDb2xvclxyXG4gKiAgQHBhcmFtIGNvbG9yIHtzdHJpbmd9ICN4eHh4eHgvMjU1LDI1NSwyNTVcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5zZXRCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcclxuICAgIHRoaXMuanRvcG8uYmFja2dyb3VuZENvbG9yID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvcik7XHJcbiAgICB0aGlzLmp0b3BvLmFscGhhID0gMTtcclxuICAgIHRoaXMuYXR0ci5iYWNrZ3JvdW5kID0gUVRvcG8udXRpbC50cmFuc0hleChjb2xvcik7XHJcbn07XHJcbi8qKlxyXG4gKiAg6K6+572u5Zu+5bGC5qih5byPXHJcbiAqICBAbWV0aG9kIHNldE1vZGVcclxuICogIEBwYXJhbSBtb2RlIHtzdHJpbmd9IOS+izpRVG9wby5jb25zdGFudC5tb2RlLk5PUk1BTFxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnNldE1vZGUgPSBmdW5jdGlvbiAobW9kZSkge1xyXG4gICAgaWYgKFtcIm5vcm1hbFwiLCBcImVkaXRcIiwgXCJkcmFnXCIsIFwic2VsZWN0XCJdLmluZGV4T2YobW9kZSkgPiAtMSkge1xyXG4gICAgICAgIHRoaXMuYXR0ci5tb2RlID0gbW9kZTtcclxuICAgICAgICB0aGlzLmp0b3BvLm1vZGUgPSBtb2RlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwic2V0IHdyb25nIG1vZGUgOlwiLCBtb2RlKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDlm77lsYLmuIXnqbrvvIzmuIXpmaTlm77lsYLlhoXmiYDmnInlhYPntKBcclxuICogIEBtZXRob2QgY2xlYXJcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIFFUb3BvLnV0aWwuaW5mbyhcInNjZW5lIGNsZWFyXCIpO1xyXG4gICAgdGhpcy5jaGlsZHJlbiA9IHtcclxuICAgICAgICBub2RlOiBbXSxcclxuICAgICAgICBsaW5rOiBbXSxcclxuICAgICAgICBjb250YWluZXI6IFtdLFxyXG4gICAgICAgIGxpbmU6IFtdXHJcbiAgICB9O1xyXG4gICAgdGhpcy5qdG9wby5jbGVhcigpO1xyXG59O1xyXG4vKipcclxuICogIOiOt+WPluexu+Wei++8jOW4uOeUqOWcqOWPs+mUruiPnOWNleS4iuWvueinpuWPkeWvueixoeeahOivhuWIq1xyXG4gKiAgQG1ldGhvZCBnZXRUeXBlXHJcbiAqICBAcmV0dXJuIFFUb3BvLmNvbnN0YW50LlNDRU5FXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBRVG9wby5jb25zdGFudC5TQ0VORTtcclxufTtcclxuLyoqXHJcbiAqICDojrflj5bkvb/nlKjnsbvlnovvvIzluLjnlKjlnKjlj7PplK7oj5zljZXkuIrlr7nop6blj5Hlr7nosaHnmoTor4bliKtcclxuICogIEBtZXRob2QgZ2V0VXNlVHlwZVxyXG4gKiAgQHJldHVybiBRVG9wby5jb25zdGFudC5TQ0VORVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdldFVzZVR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gUVRvcG8uY29uc3RhbnQuU0NFTkU7XHJcbn07XHJcbi8qKlxyXG4gKiAg57uR5a6a5LqL5Lu277yM5Y+v55Sob2Zm5Yig6Zmk5a+55bqU5LqL5Lu2XHJcbiAqICBAbWV0aG9kIG9uXHJcbiAqICBAcGFyYW0gbmFtZSB7c3RyaW5nfSDkuovku7blkI1cclxuICpcclxuICogIGNsaWNrLGRiY2xpY2ssbW91c2Vkb3duLG1vdXNldXAsbW91c2VvdmVyLG1vdXNlb3V0LG1vdXNlbW92ZSxtb3VzZWRyYWcsbW91c2V3aGVlbCx0b3VjaHN0YXJ0LHRvdWNobW92ZSx0b3VjaGVuZCxrZXlkb3duLGtleXVwXHJcbiAqXHJcbiAqICBAcGFyYW0gZm4ge2Z1bmN0aW9ufSDlpITnkIblh73mlbBcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChuYW1lLCBmbikge1xyXG4gICAgdGhpcy5qdG9wby5hZGRFdmVudExpc3RlbmVyKG5hbWUsIGZuKTtcclxufTtcclxuLyoqXHJcbiAqICDliKDpmaTkuovku7bvvIzlj6/liKDpmaRvbue7keWumueahOS6i+S7tlxyXG4gKiAgQG1ldGhvZCBvZmZcclxuICogIEBwYXJhbSBuYW1lIHtzdHJpbmd9IOS6i+S7tuWQjVxyXG4gKlxyXG4gKiAgY2xpY2ssZGJjbGljayxtb3VzZWRvd24sbW91c2V1cCxtb3VzZW92ZXIsbW91c2VvdXQsbW91c2Vtb3ZlLG1vdXNlZHJhZyxtb3VzZXdoZWVsLHRvdWNoc3RhcnQsdG91Y2htb3ZlLHRvdWNoZW5kLGtleWRvd24sa2V5dXBcclxuICpcclxuICogIEBwYXJhbSBbZm5de2Z1bmN0aW9ufSDlpITnkIbnmoTlh73mlbDlr7nosaHvvIzoi6Xml6Dlj4LliJnliKDpmaTor6Xkuovku7bkuIvmiYDmnInlh73mlbBcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAobmFtZSwgZm4pIHtcclxuICAgIHRoaXMuanRvcG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBmbik7XHJcbn07XHJcbi8qKlxyXG4gKiAg5qC55o2u5pCc57Si5b2T5YmN5Zu+5bGC77yM5p+l5om+5Z+65pys5bGe5oCn5oiW6aKd5aSW5bGe5oCn5ruh6Laz5p2h5Lu255qE5YWD57SgXHJcbiAqICBAbWV0aG9kIGZpbmRcclxuICogIEBwYXJhbSBzY2FuIHtzdHJpbmd9IOafpeivouadoeS7tizmoLzlvI/kuLpcImtleT12YWx1ZSxrZXk9dmFsdWVcIizlpJrkuKrmnaHku7bnlKgs5YiG5YmyXHJcbiAqICBAcGFyYW0gW3R5cGVdIHtzdHJpbmd9IOWPr+aMh+WumuWFg+e0oOexu+Wei+eyvuehruafpeaJvlxyXG4gKiAgQHJldHVybiB7YXJyYXl9IOi/lOWbnuaVsOe7hO+8jOaVsOe7hOaIkOWRmOS4uua7oei2s+iHs+WwkeS4gOS4quadoeS7tueahOWFg+e0oFxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAoc2NhbiwgdHlwZSkge1xyXG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcclxuICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgIHZhciBjb25kaXRpb24gPSB0eXBlb2Ygc2NhbiA9PSBcInN0cmluZ1wiID8gc2Nhbi5zcGxpdChcIixcIikgOiBbXTtcclxuICAgIGlmIChjb25kaXRpb24ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICQuZWFjaChjb25kaXRpb24sIGZ1bmN0aW9uIChpLCB0ZW1wKSB7XHJcbiAgICAgICAgICAgIHRlbXAgPSB0ZW1wLnNwbGl0KFwiPVwiKTtcclxuICAgICAgICAgICAgaWYgKHRlbXAubGVuZ3RoID49IDIpIHtcclxuICAgICAgICAgICAgICAgIC8v5Yi25a6a5LqG57G75Z6L77yM57yp5bCP5p+l5om+6IyD5Zu077yM5pyq5oyH5a6a5YiZ5YWo6YOo6YGN5Y6GXHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm9kZVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5ub2RlLCB0ZW1wWzBdLCB0ZW1wWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibGlua1wiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbkFycihjaGlsZHJlbi5saW5rLCB0ZW1wWzBdLCB0ZW1wWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY29udGFpbmVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGNoaWxkcmVuLmNvbnRhaW5lciwgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxpbmVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYW5BcnIoY2hpbGRyZW4ubGluZSwgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChjaGlsZHJlbiwgZnVuY3Rpb24gKGosIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FuQXJyKGFyciwgdGVtcFswXSwgdGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAvL+aJq+aPj+aVsOe7hOS4reWvueixoeWvueW6lOeahOWxnuaAp+aYr+WQpuebuOetiVxyXG4gICAgZnVuY3Rpb24gc2NhbkFycihhcnIsIGtleSwgdmFsdWUpIHtcclxuICAgICAgICAkLmVhY2goYXJyLCBmdW5jdGlvbiAoaSwgaXRlbSkge1xyXG4gICAgICAgICAgICAvL+WPquaJq+aPj+WvueixoeeahGF0dHLlkoxleHRyYeS4reeahOWxnuaAp1xyXG4gICAgICAgICAgICBpZiAoZXF1YWwoaXRlbS5leHRyYSwga2V5LCB2YWx1ZSkgfHwgZXF1YWwoaXRlbS5hdHRyLCBrZXksIHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgLy/mjpLpmaTph43lpI3nmoRcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuaW5kZXhPZihpdGVtKSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZXF1YWwob2JqZWN0LCBrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIG9iamVjdCAmJiBvYmplY3Rba2V5XSAmJiBvYmplY3Rba2V5XSA9PSB2YWx1ZTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqICDojrflj5blvZPliY3lm77lsYLlnKjmraPluLjop4bop5LkuIso5pyq5pS+5aSn57yp5bCPKeacgOW3puS4iuinkueahOWdkOagh1xyXG4gKiAgQG1ldGhvZCBnZXRPcmlnaW5cclxuICogIEByZXR1cm4ge29iamVjdH0g5YyF5ZCrIHgseeWxnuaAp1xyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmdldE9yaWdpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgeDogMCAtIHRoaXMuanRvcG8udHJhbnNsYXRlWCxcclxuICAgICAgICB5OiAwIC0gdGhpcy5qdG9wby50cmFuc2xhdGVZXHJcbiAgICB9XHJcbn07XHJcbi8vLVxyXG5mdW5jdGlvbiBhZGRKVG9wbyhlbGVtZW50KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHRoaXMuanRvcG8uYWRkKGVsZW1lbnQuanRvcG8pO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJJbiBTY2VuZSwganRvcG8gYWRkIGVycm9yIDogXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlbW92ZUpUb3BvKGVsZW1lbnQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5yZW1vdmUoZWxlbWVudC5qdG9wbyk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcIkluIFNjZW5lLCBqdG9wbyByZW1vdmUgZXJyb3IgOiBcIiwgZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqICDmoLnmja7phY3nva7lnKjlvZPliY3lm77lsYLkuIrnu5jliLboioLngrlcclxuICogIEBtZXRob2QgY3JlYXRlTm9kZVxyXG4gKiAgQHBhcmFtIFtjb25maWddIHtvYmplY3R9XHJcbiAqXHJcbiAqICDml6Dlj4LliJnmoLnmja7lhajlsYDphY3nva7nu5jliLZRVG9wby5jb25zdGFudC5ub2RlLklNQUdF5a+55bqU55qE6IqC54K5LFxyXG4gKlxyXG4gKiAgY29uZmlnLnR5cGXlj6/mjIflrprnu5jliLboioLngrnnsbvlnotcclxuICpcclxuICogIOWPguiAg1FUb3BvLmNvbnRhbnQubm9kZemAieaLqeWPr+e7mOWItueahOenjeexu1xyXG4gKiAgQHJldHVybiB7Tm9kZXxib29sZWFufSDliJvlu7rmiJDlip/ov5Tlm57oioLngrnlr7nosaHvvIzlpLHotKXov5Tlm55mYWxzZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmNyZWF0ZU5vZGUgPSBmdW5jdGlvbiAoY29uZmlnKSB7XHJcbiAgICB2YXIgbmV3Tm9kZTtcclxuICAgIHZhciBjb25zdGFudCA9IFFUb3BvLmNvbnN0YW50Lm5vZGU7XHJcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XHJcbiAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSBjb25zdGFudC5URVhUOlxyXG4gICAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUuVGV4dC5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUuSW1hZ2UuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgIH1cclxuICAgIGlmIChuZXdOb2RlICYmIG5ld05vZGUuanRvcG8pIHtcclxuICAgICAgICBhZGRKVG9wby5jYWxsKHRoaXMsIG5ld05vZGUpO1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4ubm9kZS5wdXNoKG5ld05vZGUpO1xyXG4gICAgICAgIHJldHVybiBuZXdOb2RlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIE5vZGUgZXJyb3JcIiwgY29uZmlnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiAg5qC55o2u6YWN572u5Zyo5Lik5Liq5YWD57Sg5LmL6Ze057uY5Yi25paw55qE6ZO+5o6lXHJcbiAqICBAbWV0aG9kIGNyZWF0ZUxpbmtcclxuICogIEBwYXJhbSBbY29uZmlnXSB7b2JqZWN0fVxyXG4gKiAg5peg5Y+C5YiZ5qC55o2u5YWo5bGA6YWN572u57uY5Yi2UVRvcG8uY29uc3RhbnQubGluay5ESVJFQ1Tlr7nlupTnmoTpk77mjqUsXHJcbiAqXHJcbiAqICBjb25maWcudHlwZeWPr+aMh+Wumue7mOWItumTvuaOpeexu+Wei1xyXG4gKlxyXG4gKiAg5Y+C6ICDUVRvcG8uY29udGFudC5saW5r6YCJ5oup5Y+v57uY5Yi255qE56eN57G7XHJcbiAqICBAcmV0dXJuIHtMaW5rfGJvb2xlYW59IOWIm+W7uuaIkOWKn+i/lOWbnumTvuaOpeWvueixoe+8jOWksei0pei/lOWbnmZhbHNlXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuY3JlYXRlTGluayA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgIHZhciBuZXdMaW5rO1xyXG4gICAgdmFyIGNvbnN0YW50ID0gUVRvcG8uY29uc3RhbnQubGluaztcclxuICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcclxuICAgIHN3aXRjaCAoY29uZmlnLnR5cGUpIHtcclxuICAgICAgICBjYXNlIGNvbnN0YW50LkNVUlZFOlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuQ3VydmUuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBjb25zdGFudC5GTEVYSU9OQUw6XHJcbiAgICAgICAgICAgIG5ld0xpbmsgPSBuZXcgTGluay5GbGV4aW9uYWwuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBjb25zdGFudC5GT0xEOlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuRm9sZC5jb25zdHJ1Y3Rvcihjb25maWcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBuZXdMaW5rID0gbmV3IExpbmsuRGlyZWN0LmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAobmV3TGluayAmJiBuZXdMaW5rLmp0b3BvKSB7XHJcbiAgICAgICAgYWRkSlRvcG8uY2FsbCh0aGlzLCBuZXdMaW5rKTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLmxpbmsucHVzaChuZXdMaW5rKTtcclxuICAgICAgICByZXR1cm4gbmV3TGluaztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNyZWF0ZSBMaW5rIGVycm9yXCIsIGNvbmZpZyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG4vLy0tXHJcbi8qKlxyXG4gKiAg5qC55o2u6YWN572u5Zyo5Lik5Liq5YWD57Sg5LmL6Ze05Yib5bu66ZO+5o6lLOiLpeS4pOWFg+e0oOW3suaciemTvuaOpeWImeWOn+mTvuaOpeiuoeaVsOS4iuWKoDEsXHJcbiAqICDlj6/mk43kvZzkuo7mnInlsZXlvIDlip/og73nmoTpk77mjqXkuIrvvIzlj6/oh6rpgILlupTpgInmi6nmt7vliqDmlrDpk77mjqXmiJborqHmlbArMVxyXG4gKiAgQG1ldGhvZCBhZGRMaW5rXHJcbiAqICBAcGFyYW0gY29uZmlnIHtvYmplY3R9IOWIm+W7uuaWsOmTvuaOpeaXtuaJgOS+nei1lueahOmFjee9ru+8jOWPr+WPguiAg2NyZWF0ZUxpbmvlh73mlbBcclxuICogIEBwYXJhbSBbZm5dIHtmdW5jdGlvbn0g5Yik5pat5Lik5YWD57Sg6Ze05peg6ZO+5o6l5pe255qE5Y+v6YCJ5pON5L2c77yM6Iul5peg5YiZ6LCD55SoY3JlYXRlTGlua+WHveaVsOW7uueri+mTvuaOpVxyXG4gKiAgQHJldHVybiB7TGlua3xib29sZWFufSDliJvlu7rmiJDlip/ov5Tlm57pk77mjqXlr7nosaHvvIzlpLHotKXov5Tlm55mYWxzZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmFkZExpbmsgPSBmdW5jdGlvbiAoY29uZmlnLCBmbikge1xyXG4gICAgaWYgKGNvbmZpZyAmJiBjb25maWcuc3RhcnQgJiYgY29uZmlnLmVuZCkge1xyXG4gICAgICAgIHZhciBsaW5rcyA9IHRoaXMubGlua3NCZXR3ZWVuKGNvbmZpZy5zdGFydCwgY29uZmlnLmVuZCk7Ly/mjIludW1iZXLlsZ7mgKfku47lpKfliLDlsI/mjpLliJdcclxuICAgICAgICBpZiAobGlua3MubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgaWYgKCQuaXNGdW5jdGlvbihmbikpIHtcclxuICAgICAgICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVMaW5rKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL+S4pOeCueS5i+mXtOi/nue6v+S4ujHliJnorqTkuLrmmK/lt7LmnInpk77mjqXvvIzotoXov4cx5YiZ6K6k5Li65piv5Y+v5Lul5bGV5byA5LiU5bey57uP5bGV5byA55qE55u057q/XHJcbiAgICAgICAgICAgIHZhciBudW1iZXIgPSAxO1xyXG4gICAgICAgICAgICBpZiAoJC5pc051bWVyaWMoY29uZmlnLm51bWJlcikpIHtcclxuICAgICAgICAgICAgICAgIG51bWJlciA9IHBhcnNlSW50KGNvbmZpZy5udW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bWJlciA8IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBudW1iZXIgPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsaW5rcy5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgbGlua3NbMF0uc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICBudW1iZXI6IGxpbmtzWzBdLmF0dHIubnVtYmVyICsgbnVtYmVyXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsaW5rc1swXTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5rcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbGlua3NbMF0ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5hdHRyLm51bWJlciArPSBudW1iZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LmFkZENoaWxkKG51bWJlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICpcclxuICogIOiOt+WPluS4pOWFg+e0oOS5i+mXtOaJgOacieeahOmTvuaOpVxyXG4gKiAgQG1ldGhvZCBsaW5rc0JldHdlZW5cclxuICogIEBwYXJhbSBzdGFydCB7ZWxlbWVudH0g5YWD57Sg77yM6LW35aeL5peg5YWzXHJcbiAqICBAcGFyYW0gZW5kIHtlbGVtZW50fSDlhYPntKDvvIzotbflp4vml6DlhbNcclxuICogIEByZXR1cm4ge2FycmF5fSDlhYPntKDpl7TnmoTpk77mjqXpm4blkIjvvIzmjInpk77mjqXnmoTorqHmlbDlj7PlpKfliLDlsI/mjpLliJdcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5saW5rc0JldHdlZW4gPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xyXG4gICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgdmFyIGxpbmtzID0gc3RhcnQubGlua3M7XHJcbiAgICAvL+ajgOa1i+S4pOWFg+e0oOmXtOeahOi/nue6v+aYr+WQpuW3suaciVxyXG4gICAgaWYgKCQuaXNBcnJheShsaW5rcy5vdXQpKSB7XHJcbiAgICAgICAgJC5lYWNoKGxpbmtzLm91dCwgZnVuY3Rpb24gKGksIGxpbmtPdXQpIHtcclxuICAgICAgICAgICAgaWYgKGxpbmtPdXQucGF0aC5lbmQgPT0gZW5kKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChsaW5rT3V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKCQuaXNBcnJheShsaW5rcy5pbikpIHtcclxuICAgICAgICAkLmVhY2gobGlua3MuaW4sIGZ1bmN0aW9uIChqLCBsaW5rSW4pIHtcclxuICAgICAgICAgICAgaWYgKGxpbmtJbi5wYXRoLnN0YXJ0ID09IGVuZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobGlua0luKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIGIuYXR0ci5udW1iZXIgLSBhLmF0dHIubnVtYmVyO1xyXG4gICAgfSk7XHJcbn07XHJcbi8vLS1cclxuLyoqXHJcbiAqXHJcbiAqICDlnKjlm77lsYLkuIrnu5jliLbkuI3lj6/ku6Xnp7vliqjnmoTnur/lhYPntKBcclxuICogIEBtZXRob2QgY3JlYXRlTGluZVxyXG4gKiAgQHBhcmFtIFtjb25maWddIHtvYmplY3R9IOmFjee9ruWPguaVsCzoi6Xml6DliJnmjInlhajlsYDphY3nva7liJvlu7pcclxuICogIEByZXR1cm4ge0xpbmV8Ym9vbGVhbn0g5Yib5bu65oiQ5Yqf6L+U5Zue57q/5YWD57Sg77yM5aSx6LSl6L+U5ZueZmFsc2VcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5jcmVhdGVMaW5lID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgdmFyIG5ld0xpbmU7XHJcbiAgICB2YXIgY29uc3RhbnQgPSBRVG9wby5jb25zdGFudC5saW5lO1xyXG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xyXG4gICAgc3dpdGNoIChjb25maWcudHlwZSkge1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld0xpbmUgPSBuZXcgTGluZS5EaXJlY3QuY29uc3RydWN0b3IoY29uZmlnKTtcclxuICAgIH1cclxuICAgIGlmIChuZXdMaW5lICYmIG5ld0xpbmUuanRvcG8pIHtcclxuICAgICAgICBhZGRKVG9wby5jYWxsKHRoaXMsIG5ld0xpbmUpO1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4ubGluZS5wdXNoKG5ld0xpbmUpO1xyXG4gICAgICAgIHJldHVybiBuZXdMaW5lO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiY3JlYXRlIExpbmsgZXJyb3JcIiwgY29uZmlnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbi8vLS1cclxuLyoqXHJcbiAqXHJcbiAqICDlnKjlm77lsYLkuIrnu5jliLbliIbnu4TlhYPntKBcclxuICogIEBtZXRob2QgY3JlYXRlQ29udGFpbmVyXHJcbiAqICBAcGFyYW0gW2NvbmZpZ10ge29iamVjdH0g6YWN572u5Y+C5pWwLOiLpeaXoOWImeaMieWFqOWxgOmFjee9ruWIm+W7ulxyXG4gKiAgQHJldHVybiB7Y29udGFpbmVyfGJvb2xlYW59IOWIm+W7uuaIkOWKn+i/lOWbnue6v+WFg+e0oO+8jOWksei0pei/lOWbnmZhbHNlXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuY3JlYXRlQ29udGFpbmVyID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgdmFyIG5ld0NvbnRhaW5lcjtcclxuICAgIHZhciBjb25zdGFudCA9IFFUb3BvLmNvbnN0YW50LmNvbnRhaW5lcjtcclxuICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcclxuICAgIHN3aXRjaCAoY29uZmlnLnR5cGUpIHtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBuZXdDb250YWluZXIgPSBuZXcgQ29udGFpbmVyLkdyb3VwLmNvbnN0cnVjdG9yKGNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAobmV3Q29udGFpbmVyICYmIG5ld0NvbnRhaW5lci5qdG9wbykge1xyXG4gICAgICAgIC8v5YiG57uE5Y+q5Yqg5YWl5YW25pys6Lqr77yM5YiH5o2i6IqC54K55LiN5L2c5pWwXHJcbiAgICAgICAgdmFyIG5vZGVDb25maWcgPSB7fTtcclxuICAgICAgICBpZiAoY29uZmlnLnRvZ2dsZSkge1xyXG4gICAgICAgICAgICBub2RlQ29uZmlnID0gY29uZmlnLnRvZ2dsZVxyXG4gICAgICAgIH1cclxuICAgICAgICAvL+WPr+mAieemgeeUqOWIhue7hOWIh+aNolxyXG4gICAgICAgIGlmICghKGNvbmZpZy50b2dnbGUgJiYgdHlwZW9mIGNvbmZpZy50b2dnbGUuY2xvc2UgPT0gXCJib29sZWFuXCIgJiYgY29uZmlnLnRvZ2dsZS5jbG9zZSkpIHtcclxuICAgICAgICAgICAgYWRkVG9nZ2xlKHRoaXMsIG5ld0NvbnRhaW5lciwgbm9kZUNvbmZpZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4uY29udGFpbmVyLnB1c2gobmV3Q29udGFpbmVyKTtcclxuICAgICAgICBhZGRKVG9wby5jYWxsKHRoaXMsIG5ld0NvbnRhaW5lcik7XHJcbiAgICAgICAgcmV0dXJuIG5ld0NvbnRhaW5lcjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcImNyZWF0ZSBDb250YWluZXIgZXJyb3JcIiwgY29uZmlnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIGFkZFRvZ2dsZShzY2VuZSwgY29udGFpbmVyLCBjb25maWdUb2dnbGUpIHtcclxuICAgIGNvbmZpZ1RvZ2dsZS51c2VUeXBlID0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMOy8v5qCH6K6w55So6YCUXHJcbiAgICBjb250YWluZXIudG9nZ2xlVG8gPSBuZXcgTm9kZS5JbWFnZS5jb25zdHJ1Y3Rvcihjb25maWdUb2dnbGUpO1xyXG4gICAgY29udGFpbmVyLnRvZ2dsZVRvLnRvZ2dsZVRvID0gY29udGFpbmVyOy8v5LqS55u457Si5byVXHJcbiAgICBjb250YWluZXIudG9nZ2xlVG8uaGlkZSgpOy8v5Yid5aeL6ZqQ6JePXHJcbiAgICBhZGRKVG9wby5jYWxsKHNjZW5lLCBjb250YWluZXIudG9nZ2xlVG8pOy8v5Yqg5YWl55S75biDXHJcbn1cclxuLy8tLVxyXG4vLy1cclxuLyoqXHJcbiAqXHJcbiAqICDliKDpmaTlm77lsYLlhoXlhYPntKAs5YWD57Sg5Yig6Zmk5YW25LiK55qE6ZO+5o6l5Lmf5Lya5Yig6Zmk5ZKM5pu05pawXHJcbiAqICBAbWV0aG9kIHJlbW92ZVxyXG4gKiAgQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIGlmIChlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCQuaXNBcnJheShlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAkLmVhY2goZWxlbWVudCwgZnVuY3Rpb24gKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZU9uY2UoaXRlbSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlbW92ZU9uY2UoZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZU9uY2Uob25lRWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAob25lRWxlbWVudC5qdG9wbykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChvbmVFbGVtZW50LmdldFR5cGUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuTk9ERTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFFUb3BvLnV0aWwuYXJyYXlEZWxldGUoc2VsZi5jaGlsZHJlbi5ub2RlLCBvbmVFbGVtZW50KSB8fCBvbmVFbGVtZW50LmdldFVzZVR5cGUoKSA9PSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZU5vZGUuY2FsbChzZWxmLCBvbmVFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFFUb3BvLmNvbnN0YW50LkxJTks6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChRVG9wby51dGlsLmFycmF5RGVsZXRlKHNlbGYuY2hpbGRyZW4ubGluaywgb25lRWxlbWVudCkgfHwgb25lRWxlbWVudC5nZXRVc2VUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVMaW5rLmNhbGwoc2VsZiwgb25lRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBRVG9wby5jb25zdGFudC5MSU5FOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoUVRvcG8udXRpbC5hcnJheURlbGV0ZShzZWxmLmNoaWxkcmVuLmxpbmUsIG9uZUVsZW1lbnQpIHx8IG9uZUVsZW1lbnQuZ2V0VXNlVHlwZSgpID09IFFUb3BvLmNvbnN0YW50LkNBU1VBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlTGluZS5jYWxsKHNlbGYsIG9uZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgUVRvcG8uY29uc3RhbnQuQ09OVEFJTkVSOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoUVRvcG8udXRpbC5hcnJheURlbGV0ZShzZWxmLmNoaWxkcmVuLmNvbnRhaW5lciwgb25lRWxlbWVudCkgfHwgb25lRWxlbWVudC5nZXRVc2VUeXBlKCkgPT0gUVRvcG8uY29uc3RhbnQuQ0FTVUFMKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVDb250YWluZXIuY2FsbChzZWxmLCBvbmVFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gdXBEYXRhTGlua3MoZWxlbWVudCkge1xyXG4gICAgdmFyIGxpbmtzID0gZWxlbWVudC5saW5rcztcclxuICAgIGlmIChsaW5rcykge1xyXG4gICAgICAgIC8v5pu05paw5YW25LiK6L+e57q/55qE5Y+m5LiA5pa555qEbGlua3PlsZ7mgKdcclxuICAgICAgICB3aGlsZSAobGlua3MuaW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZShsaW5rcy5pbi5wb3AoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHdoaWxlIChsaW5rcy5vdXQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZShsaW5rcy5vdXQucG9wKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vL+e6v+S4iuWIoOmZpOaXtuWAmSzopoHmm7TmlrBub2Rl5ZKMY29udGFpbmVy5Lit55qEbGlua3PlsZ7mgKdcclxuZnVuY3Rpb24gcmVtb3ZlTGluayhsaW5rKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuYXJyYXlEZWxldGUobGluay5wYXRoLnN0YXJ0LmxpbmtzLm91dCwgbGluayk7XHJcbiAgICAgICAgUVRvcG8udXRpbC5hcnJheURlbGV0ZShsaW5rLnBhdGguZW5kLmxpbmtzLmluLCBsaW5rKTtcclxuICAgICAgICByZW1vdmVKVG9wby5jYWxsKHRoaXMsIGxpbmspO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJTY2VuZSByZW1vdmVMaW5rIGVycm9yXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlbW92ZUxpbmUobGluZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZW1vdmVKVG9wby5jYWxsKHRoaXMsIGxpbmUpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJTY2VuZSByZW1vdmVMaW5lIGVycm9yXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlbW92ZU5vZGUobm9kZSkge1xyXG4gICAgLy/liLfmlrDkuIDkuIvnjrDmnInnmoTnur9cclxuICAgIHRyeSB7XHJcbiAgICAgICAgLy/mm7TmlrDlhbbkuIrnur/lj6bkuIDlpLTnmoRsaW5rc+WxnuaAp1xyXG4gICAgICAgIHVwRGF0YUxpbmtzLmNhbGwodGhpcywgbm9kZSk7XHJcbiAgICAgICAgLy/opoHmm7TmlrDlhbbniLbnmoRjaGlsZHJlbuWxnuaApyzniLbliKDpmaTlrZBcclxuICAgICAgICBpZiAobm9kZS5wYXJlbnQgJiYgJC5pc0FycmF5KG5vZGUucGFyZW50LmNoaWxkcmVuKSkge1xyXG4gICAgICAgICAgICBub2RlLnBhcmVudC5yZW1vdmUobm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5Yig6Zmk5YiG57uE5YiH5o2i55qE6IqC54K55pe25ZCM5pe25Yig6Zmk5YW25YiH5o2i55qE5YiG57uEXHJcbiAgICAgICAgaWYgKG5vZGUudG9nZ2xlVG8pIHtcclxuICAgICAgICAgICAgLy/liIbnu4Toi6XpmpDol4/kuoYs5bqU6K+l5bGV56S6XHJcbiAgICAgICAgICAgIG5vZGUudG9nZ2xlVG8udG9nZ2xlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKG5vZGUudG9nZ2xlVG8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZW1vdmVKVG9wby5jYWxsKHRoaXMsIG5vZGUpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIFFUb3BvLnV0aWwuZXJyb3IoXCJTY2VuZSByZW1vdmVOb2RlIGVycm9yXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbi8v5a655Zmo5Yig6Zmk5pe2LOimgeabtOS4juWFtuebuOi/nueahOe6v+eahOWPpuS4gOerr+eahGxpbmtz5bGe5oCnLOimgeabtOaWsOWFtuWtkOexu+eahHBhcmVudOWxnuaAp1xyXG5mdW5jdGlvbiByZW1vdmVDb250YWluZXIoY29udGFpbmVyKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8v5YiG57uE6Iul6ZqQ6JeP5LqGLOW6lOivpeWxleekulxyXG4gICAgICAgIGNvbnRhaW5lci50b2dnbGUodHJ1ZSk7XHJcbiAgICAgICAgLy/mm7TmlrDlhbbkuIrnur/lj6bkuIDlpLTnmoRsaW5rc+WxnuaAp1xyXG4gICAgICAgIHVwRGF0YUxpbmtzLmNhbGwodGhpcywgY29udGFpbmVyKTtcclxuICAgICAgICAvL+abtOaWsOWtkOWFg+e0oOeahFBhcmVudOWxnuaAp1xyXG4gICAgICAgIGlmICgkLmlzQXJyYXkoY29udGFpbmVyLmNoaWxkcmVuKSAmJiBjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmNoaWxkcmVuW2ldLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy/liKDpmaTliIbnu4TlkIzml7bliKDpmaTlhbbliIfmjaLoioLngrlcclxuICAgICAgICBpZiAoY29udGFpbmVyLnRvZ2dsZVRvKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGNvbnRhaW5lci50b2dnbGVUbyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlbW92ZUpUb3BvLmNhbGwodGhpcywgY29udGFpbmVyKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBRVG9wby51dGlsLmVycm9yKFwiU2NlbmUgcmVtb3ZlQ29udGFpbmVyIGVycm9yXCIsIGUpO1xyXG4gICAgfVxyXG59XHJcbi8vLVxyXG4vKipcclxuICpcclxuICogIOWbvuWxguS/oeaBr+i9rOWMluS4umpzb25cclxuICogIEBtZXRob2QgdG9Kc29uXHJcbiAqICBAcmV0dXJuIHtvYmplY3R9XHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUudG9Kc29uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGpzb24gPSAkLmV4dGVuZCh7fSwgdGhpcy5hdHRyKTtcclxuICAgIGpzb24uZXh0cmEgPSAkLmV4dGVuZCh7fSwgdGhpcy5leHRyYSk7XHJcbiAgICByZXR1cm4ganNvbjtcclxufTtcclxuLyoqXHJcbiAqXHJcbiAqICDliKTmlq3lhYPntKDmmK/lkKblnKjlvZPliY3lm77lsYLlhoVcclxuICogIEBtZXRob2QgaXNDaGlsZHJlblxyXG4gKiAgQHBhcmFtIGVsZW1lbnQge2VsZW1lbnR9XHJcbiAqICBAcmV0dXJuIHtib29sZWFufVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLmlzQ2hpbGRyZW4gPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgaWYgKGVsZW1lbnQuanRvcG8pIHtcclxuICAgICAgICAkLmVhY2godGhpcy5jaGlsZHJlbiwgZnVuY3Rpb24gKG5hbWUsIGFycikge1xyXG4gICAgICAgICAgICBpZiAoYXJyLmluZGV4T2YoZWxlbWVudCkgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufTtcclxuLyoqXHJcbiAqXHJcbiAqIOWbvuWxgue8qeaUvizlhYPntKDkuIDlsY/mmL7npLpcclxuICogIEBtZXRob2QgZ29DZW50ZXJcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5nb0NlbnRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh0aGlzLmp0b3BvLmNoaWxkcyAmJiB0aGlzLmp0b3BvLmNoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdGFnZS5jZW50ZXJBbmRab29tKCk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKlxyXG4gKiDlm77lsYLnvKnmlL5cclxuICogIEBtZXRob2QgcmVzaXplXHJcbiAqICBAcGFyYW0gc2l6ZSB7bnVtYmVyfSDmoLnmja7mr5TkvovmlL7lpKfmiJbnvKnlsI8g5Y+C5pWw5Y+vIDAtMee8qeWwjyAxLW7mlL7lpKdcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbiAoc2l6ZSkge1xyXG4gICAgaWYgKCQuaXNOdW1lcmljKHNpemUpKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zY2FsZVggPSBzaXplO1xyXG4gICAgICAgIHRoaXMuanRvcG8uc2NhbGVZID0gc2l6ZTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqXHJcbiAqIOWQr+eUqC/npoHnlKjpvKDmoIfnvKnmlL5cclxuICogIEBtZXRob2QgdG9nZ2xlWm9vbVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnRvZ2dsZVpvb20gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoIXRoaXMuanRvcG8uc3RhZ2Uud2hlZWxab29tKSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdGFnZS53aGVlbFpvb20gPSAwLjg1OyAvLyDorr7nva7pvKDmoIfnvKnmlL7mr5TkvotcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zdGFnZS53aGVlbFpvb20gPSBudWxsO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICpcclxuICog5ZCv55SoL+emgeeUqOm5sOecvFxyXG4gKiAgQG1ldGhvZCB0b2dnbGVFYWdsZUV5ZVxyXG4gKi9cclxuU2NlbmUucHJvdG90eXBlLnRvZ2dsZUVhZ2xlRXllID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5qdG9wby5zdGFnZS5lYWdsZUV5ZS52aXNpYmxlID0gIXRoaXMuanRvcG8uc3RhZ2UuZWFnbGVFeWUudmlzaWJsZTtcclxufTtcclxuLyoqXHJcbiAqXHJcbiAqIOiOt+WPluW9k+WJjeWbvuWxgueahHBuZ+agvOW8j+WbvueJh+WcqOaWsOeahOeql+WPo+aJk+W8gFxyXG4gKiAgQG1ldGhvZCBnZXRQaWN0dXJlXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ2V0UGljdHVyZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vc3RhZ2Uuc2F2ZUltYWdlSW5mbygpO1xyXG4gICAgLy/lnKjmlrDpobXpnaLmiZPlvIDlm77niYdcclxuICAgIHZhciBpbWFnZSA9IHRoaXMuanRvcG8uc3RhZ2UuY2FudmFzLnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKTtcclxuICAgIHZhciB3ID0gd2luZG93Lm9wZW4oJ2Fib3V0OmJsYW5rJywgJ2ltYWdlIGZyb20gY2FudmFzJyk7XHJcbiAgICB3LmRvY3VtZW50LndyaXRlKFwiPGltZyBzcmM9J1wiICsgaW1hZ2UgKyBcIicgYWx0PSdmcm9tIGNhbnZhcycvPlwiKTtcclxuICAgIC8v5LiL6L295Zu+54mHXHJcbiAgICAvLyBoZXJlIGlzIHRoZSBtb3N0IGltcG9ydGFudCBwYXJ0IGJlY2F1c2UgaWYgeW91IGRvbnQgcmVwbGFjZSB5b3Ugd2lsbCBnZXQgYSBET00gMTggZXhjZXB0aW9uLlxyXG4gICAgLy8gdmFyIGltYWdlID0gIHN0YWdlLmNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIikucmVwbGFjZShcImltYWdlL3BuZ1wiLCBcImltYWdlL29jdGV0LXN0cmVhbTtDb250ZW50LURpc3Bvc2l0aW9uOiBhdHRhY2htZW50O2ZpbGVuYW1lPWZvb2Jhci5wbmdcIik7XHJcbiAgICAvL3ZhciBpbWFnZSA9IHN0YWdlLmNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIikucmVwbGFjZShcImltYWdlL3BuZ1wiLCBcImltYWdlL29jdGV0LXN0cmVhbVwiKTtcclxuICAgIC8vd2luZG93LmxvY2F0aW9uLmhyZWY9aW1hZ2U7IC8vIGl0IHdpbGwgc2F2ZSBsb2NhbGx5XHJcbn07XHJcbi8qKlxyXG4gKiDliIfmjaLlhYPntKDnmoTlsYLmrKFcclxuICogQG1ldGhvZCB0b2dnbGVaSW5kZXhcclxuICogQHBhcmFtIGVsZW1lbnQg5b6F5o6n5Yi25YWD57SgXHJcbiAqIEBwYXJhbSBbZmxhZ10gdHJ1ZeS4uumZjeS9jmZhbHNl5Li65o+Q5Y2H77yM5peg5Y+C5YiZ6buY6K6k5o+Q5Y2H77yM6Iul5bey5o+Q5Y2H5Yiw5pyA6auY5YiZ6ZmN6Iez5pyA5L2OXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUudG9nZ2xlWkluZGV4ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGZsYWcpIHtcclxuICAgIGlmIChlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIGp0b3BvID0gZWxlbWVudC5qdG9wbztcclxuICAgICAgICB2YXIgc2NlbmUgPSB0aGlzLmp0b3BvO1xyXG4gICAgICAgIGlmIChqdG9wbyAmJiBzY2VuZSkge1xyXG4gICAgICAgICAgICB2YXIgbWFwID0gc2NlbmUuekluZGV4TWFwW2p0b3BvLnpJbmRleF07XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IG1hcC5pbmRleE9mKGp0b3BvKTtcclxuICAgICAgICAgICAgdmFyIHRvZG8gPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGZsYWcgPT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgICB0b2RvID0gZmxhZztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PSBtYXAubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvZG8gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodG9kbykge1xyXG4gICAgICAgICAgICAgICAgLy/mj5DljYflsYLmrKFcclxuICAgICAgICAgICAgICAgIG1hcC5wdXNoKG1hcFtpbmRleF0pO1xyXG4gICAgICAgICAgICAgICAgbWFwLnNwbGljZShpbmRleCwgMSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy/pmY3kvY7lsYLmrKFcclxuICAgICAgICAgICAgICAgIG1hcC5zcGxpY2UoMCwgMCwgbWFwW2luZGV4XSk7XHJcbiAgICAgICAgICAgICAgICBtYXAuc3BsaWNlKGluZGV4ICsgMSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbnZhciBzZWxlY3RlZENhdGNoID0ge1xyXG4gICAganRvcG86IFtdLFxyXG4gICAgcXRvcG86IFtdXHJcbn07XHJcbi8qKlxyXG4gKiDojrflj5booqvpgInkuK3nmoTlhYPntKBcclxuICogQG1ldGhvZCBnZXRTZWxlY3RlZFxyXG4gKiBAcmV0dXJuIHthcnJheX0g6L+U5Zue5Zu+5bGC5Lit6KKr6YCJ5Lit55qE5YWD57SgXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUuZ2V0U2VsZWN0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIganRvcG8gPSB0aGlzLmp0b3BvLnNlbGVjdGVkRWxlbWVudHM7XHJcbiAgICBpZiAoJC5pc0FycmF5KGp0b3BvKSkge1xyXG4gICAgICAgIGlmIChzZWxlY3RlZENhdGNoLmp0b3BvICE9IGp0b3BvKSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkQ2F0Y2guanRvcG8gPSBqdG9wbztcclxuICAgICAgICAgICAgc2VsZWN0ZWRDYXRjaC5xdG9wbyA9IFtdO1xyXG4gICAgICAgICAgICBqdG9wby5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsLnF0b3BvICYmIGVsLnF0b3BvLmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENhdGNoLnF0b3BvLnB1c2goZWwucXRvcG8pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkQ2F0Y2gucXRvcG87XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOmrmOS6ruebruagh+makOiXj+WFtuS7llxyXG4gKiBAbWV0aG9kIHRvZ2dsZUxpZ2h0XHJcbiAqIEBwYXJhbSBbdGFyZ2V0XSDmlbDnu4TmiJblr7nosaEs6auY5Lqu5YW255u45YWz5a+56LGhLOaXoOWPguWImeWFqOmDqOmrmOS6rlxyXG4gKiBAcGFyYW0gW2ZsYWddIOiLpeS4unRydWXliJnlj6rpq5jkuq7kvKDlhaXnmoTlr7nosaEs5LiN6YCJ5YiZ5Y+q5a+55Lyg5YWl5a+56LGh55u45YWz55qE5a+56LGh6auY5LquXHJcbiAqL1xyXG5TY2VuZS5wcm90b3R5cGUudG9nZ2xlTGlnaHQgPSBmdW5jdGlvbiAodGFyZ2V0LCBmbGFnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBhbHBoYSA9IDE7XHJcbiAgICAgICAgdmFyIGxpZ2h0aW5nO1xyXG4gICAgICAgIGlmICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgYWxwaGEgPSAwLjE7XHJcbiAgICAgICAgICAgIGlmIChmbGFnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJC5pc0FycmF5KHRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsaWdodGluZyA9IHRhcmdldDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlnaHRpbmcgPSBbdGFyZ2V0XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpZ2h0aW5nID0gZ2V0Q29ubmVjdGlvbkxpZ2h0aW5ncyh0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsaWdodGluZyA9IGdldENvbm5lY3Rpb25MaWdodGluZ3MoW3RhcmdldF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRvdGFsU2V0QWxwaGEodGhpcy5jaGlsZHJlbi5ub2RlLmNvbmNhdCh0aGlzLmNoaWxkcmVuLmxpbmspLCBhbHBoYSk7XHJcbiAgICAgICAgdG90YWxTZXRBbHBoYShsaWdodGluZywgMSk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgUVRvcG8udXRpbC5lcnJvcihcInNjZW5lIHRvZ2dsZUxpZ2h0IGVycm9yXCIsIGUpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0Q29ubmVjdGlvbkxpZ2h0aW5ncyhhcnIpIHtcclxuICAgICAgICB2YXIgbGlnaHRpbmcgPSBbXTtcclxuICAgICAgICAkLmVhY2goYXJyLCBmdW5jdGlvbiAoaSwgdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuZ2V0VHlwZSgpID09IFFUb3BvLmNvbnN0YW50Lk5PREUgJiYgdGFyZ2V0LmdldFVzZVR5cGUoKSAhPSBRVG9wby5jb25zdGFudC5DQVNVQUwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IHRhcmdldC5saW5rcztcclxuICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuYXJyYXlQdXNoKGxpZ2h0aW5nLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxpbmtzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShsaW5rcy5vdXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaChsaW5rcy5vdXQsIGZ1bmN0aW9uIChsLCBvdXRsaW5rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmFycmF5UHVzaChsaWdodGluZywgb3V0bGluayk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRVG9wby51dGlsLmFycmF5UHVzaChsaWdodGluZywgb3V0bGluay5wYXRoLmVuZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0FycmF5KGxpbmtzLmluKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gobGlua3MuaW4sIGZ1bmN0aW9uIChuLCBpbmxpbmspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFFUb3BvLnV0aWwuYXJyYXlQdXNoKGxpZ2h0aW5nLCBpbmxpbmspO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUVRvcG8udXRpbC5hcnJheVB1c2gobGlnaHRpbmcsIGlubGluay5wYXRoLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGxpZ2h0aW5nO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRvdGFsU2V0QWxwaGEodG90YWwsIGFscGhhKSB7XHJcbiAgICAgICAgLy/lhajpg6jpmpDol49cclxuICAgICAgICBpZiAoJC5pc0FycmF5KHRvdGFsKSkge1xyXG4gICAgICAgICAgICAkLmVhY2godG90YWwsIGZ1bmN0aW9uIChpLCBlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxwaGE6IGFscGhhXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICog5q2j5bi45bC65a+45bGV56S677yM5bm25bCG6KeG6KeS56e75Yqo5Yiw5Lul5Y+C5pWw6IqC54K55Li65Lit5b+D55qE5L2N572uXHJcbiAqIEBtZXRob2QgbW92ZVRvTm9kZVxyXG4gKiBAcGFyYW0gbm9kZSDoioLngrnlr7nosaFcclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5tb3ZlVG9Ob2RlID0gZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgIC8vIOafpeivouWIsOeahOiKgueCueWxheS4reaYvuekulxyXG4gICAgaWYgKHRoaXMuY2hpbGRyZW4ubm9kZS5pbmRleE9mKG5vZGUpID4gLTEpIHtcclxuICAgICAgICB2YXIgbG9jYXRpb24gPSBub2RlLmp0b3BvLmdldENlbnRlckxvY2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5yZXNpemUoMSk7XHJcbiAgICAgICAgdGhpcy5qdG9wby5zZXRDZW50ZXIobG9jYXRpb24ueCwgbG9jYXRpb24ueSk7XHJcbiAgICAgICAgLy8g6Zeq54OB5Yeg5LiLXHJcbiAgICAgICAgbm9kZUZsYXNoKG5vZGUuanRvcG8sIDUpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gbm9kZUZsYXNoKG5vZGUsIG51bSkge1xyXG4gICAgICAgIGlmICgkLmlzTnVtZXJpYyhudW0pKSB7XHJcbiAgICAgICAgICAgIGlmIChudW0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5zZWxlY3RlZCA9ICFub2RlLnNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZUZsYXNoKG5vZGUsIG51bSAtIDEpO1xyXG4gICAgICAgICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIOiHquWKqOW4g+WxgFxyXG4gKiBAbWV0aG9kIGF1dG9MYXlvdXRcclxuICogQHBhcmFtIGNvbmZpZyDoh6rliqjluIPlsYDphY3nva7lj4LmlbBcclxuICogQGV4YW1wbGVcclxuICogICAgICDlj4LmlbDphY3nva46XHJcbiAqICAgICAgICAgIGNvbmZpZzp7XHJcbiAqICAgICAgICAgICAgICB0eXBlOlxyXG4gKiAgICAgICAgICAgICAgICAgIDEuJ3JvdW5kJyAgIOaXoOmcgOWFtuS7lumFjee9rlxyXG4gKiAgICAgICAgICAgICAgICAgIDIuJ2RlZmF1bHQnIOmcgOmFjee9ruihjOaVsO+8jOWIl+mXtOi3ne+8jOihjOmXtOi3nVxyXG4gKiAgICAgICAgICAgICAgcm93czrooYzmlbBcclxuICogICAgICAgICAgICAgIHJvd1NwYWNlOuihjOmXtOi3nVxyXG4gKiAgICAgICAgICAgICAgY29sdW1uU3BhY2U65YiX6Ze06LedXHJcbiAqICAgICAgICAgIH1cclxuICovXHJcblNjZW5lLnByb3RvdHlwZS5hdXRvTGF5b3V0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgaWYgKGNvbmZpZyAmJiBjb25maWcudHlwZSkge1xyXG4gICAgICAgIHZhciBuZWVkU29ydCA9IFtdO1xyXG4gICAgICAgIHZhciBqdG9wb3MgPSBbXTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLm5vZGUuZm9yRWFjaChmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICBpZiAoIXYucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICBuZWVkU29ydC5wdXNoKHYpO1xyXG4gICAgICAgICAgICAgICAganRvcG9zLnB1c2godi5qdG9wbyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBzd2l0Y2ggKGNvbmZpZy50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJyb3VuZFwiOlxyXG4gICAgICAgICAgICAgICAgbGF5b3V0X3JvdW5kKHRoaXMuanRvcG8sIGp0b3Bvcyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImRlZmF1bHRcIjpcclxuICAgICAgICAgICAgICAgIGxheW91dF9kZWZhdWx0KG5lZWRTb3J0LCBwYXJzZUludChjb25maWcucm93cyksIHBhcnNlSW50KGNvbmZpZy5yb3dTcGFjZSksIHBhcnNlSW50KGNvbmZpZy5jb2x1bW5TcGFjZSksIHRoaXMuZ2V0T3JpZ2luKCkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBsYXlvdXRfcm91bmQoc2NlbmUsIGp0b3Bvcykge1xyXG4gICAgSlRvcG8ubGF5b3V0LmNpcmNsZUxheW91dE5vZGVzKGp0b3Bvcywge2FuaW1hdGU6IHt0aW1lOiAxMDAwfX0pO1xyXG59XHJcbmZ1bmN0aW9uIGxheW91dF9kZWZhdWx0KGVsZW1lbnRzLCByb3dzLCByb3dTcGFjZSwgY29sdW1uU3BhY2UsIGJlZ2luKSB7XHJcbiAgICBpZiAoJC5pc051bWVyaWMocm93cykpIHtcclxuICAgICAgICByb3dzID0gcGFyc2VJbnQocm93cyk7XHJcbiAgICAgICAgaWYgKHJvd3MgPCAxKSB7XHJcbiAgICAgICAgICAgIHJvd3MgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkLmVhY2goZWxlbWVudHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0RGVncmVlKGIpIC0gZ2V0RGVncmVlKGEpO1xyXG4gICAgICAgIH0pLCBmdW5jdGlvbiAoaSwgdikge1xyXG4gICAgICAgICAgICAvL3Yuc2V0TG9jYXRpb24oYmVnaW4ueCArIChpICUgcm93cykgKiBjb2x1bW5TcGFjZSwgYmVnaW4ueSk7XHJcbiAgICAgICAgICAgIG1vdmUodiwgYmVnaW4ueCArIChpICUgcm93cykgKiBjb2x1bW5TcGFjZSwgYmVnaW4ueSk7XHJcbiAgICAgICAgICAgIGlmICgoaSArIDEpICUgcm93cyA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBiZWdpbi55ICs9IHJvd1NwYWNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLy8tLS0tLS0t5bel5YW35Ye95pWwXHJcbi8v6I635Y+W6IqC54K555qE5bqmXHJcbmZ1bmN0aW9uIGdldERlZ3JlZShub2RlKSB7XHJcbiAgICB2YXIgaW5MaW5rcyA9IG5vZGUubGlua3MuaW47XHJcbiAgICB2YXIgb3V0TGlua3MgPSBub2RlLmxpbmtzLm91dDtcclxuICAgIHZhciBkZWdyZWUgPSAwO1xyXG4gICAgaWYgKGluTGlua3MubGVuZ3RoID09IDEpIHtcclxuICAgICAgICBkZWdyZWUgKz0gaW5MaW5rc1swXS5hdHRyLm51bWJlcjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVncmVlICs9IGluTGlua3MubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgaWYgKG91dExpbmtzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgZGVncmVlICs9IG91dExpbmtzWzBdLmF0dHIubnVtYmVyO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkZWdyZWUgKz0gb3V0TGlua3MubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRlZ3JlZTtcclxufVxyXG4vL+enu+WKqOWKqOeUu1xyXG5mdW5jdGlvbiBtb3ZlKG5vZGUsIHRhcmdldFgsIHRhcmdldFkpIHtcclxuICAgIHRhcmdldFggPSBwYXJzZUludCh0YXJnZXRYKTtcclxuICAgIHRhcmdldFkgPSBwYXJzZUludCh0YXJnZXRZKTtcclxuICAgIHZhciB4ID0gbm9kZS5hdHRyLnBvc2l0aW9uWzBdO1xyXG4gICAgdmFyIHkgPSBub2RlLmF0dHIucG9zaXRpb25bMV07XHJcbiAgICB2YXIgcGFydFggPSBwYXJzZUludCgodGFyZ2V0WCAtIHgpKSAvIDEwO1xyXG4gICAgdmFyIHBhcnRZID0gcGFyc2VJbnQoKHRhcmdldFkgLSB5KSkgLyAxMDtcclxuICAgIHZhciBwYXJ0ID0gMDtcclxuICAgIHZhciB0ZW1wID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChNYXRoLmFicyh0YXJnZXRYIC0geCkgPiAxKSB7XHJcbiAgICAgICAgICAgIHggKz0gcGFydFg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChNYXRoLmFicyh0YXJnZXRZIC0geSkgPiAxKSB7XHJcbiAgICAgICAgICAgIHkgKz0gcGFydFk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5vZGUuc2V0UG9zaXRpb24oW3BhcnNlSW50KHgpLCBwYXJzZUludCh5KV0pO1xyXG4gICAgICAgIHBhcnQrKztcclxuICAgICAgICBpZiAoTWF0aC5hYnModGFyZ2V0WCAtIHgpIDw9IDEgJiYgTWF0aC5hYnModGFyZ2V0WSAtIHkpIDw9IDEpIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZW1wKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhcnQgPj0gMTApIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZW1wKTtcclxuICAgICAgICB9XHJcbiAgICB9LCAxMDApO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZGV2ZWxvcC9jb3JlL1NjZW5lLmpzXG4vLyBtb2R1bGUgaWQgPSA5XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJzb3VyY2VSb290IjoiIn0=');
}});